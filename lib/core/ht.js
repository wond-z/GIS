!function(u,I,i){"use strict";function x(){this.el=[1,0,0,0,1,0,0,0,1]}function L(z){var f={};return{get:function(Z){if(f[Z]!==i)return f[Z];var F;switch(Z){case"WEBGL_depth_texture":F=z.getExtension("WEBGL_depth_texture")||z.getExtension("MOZ_WEBGL_depth_texture")||z.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":F=z.getExtension("EXT_texture_filter_anisotropic")||z.getExtension("MOZ_EXT_texture_filter_anisotropic")||z.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":F=z.getExtension("WEBGL_compressed_texture_s3tc")||z.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||z.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":F=z.getExtension("WEBGL_compressed_texture_pvrtc")||z.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":F=z.getExtension("WEBGL_compressed_texture_etc1");break;default:F=z.getExtension(Z)}return f[Z]=F,F}}}function O(p,Z,H){function U(){if(C!==i)return C;var u=Z.get("EXT_texture_filter_anisotropic");return C=null!==u?p.getParameter(u.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function k(E){if("highp"===E){if(p.getShaderPrecisionFormat(p.VERTEX_SHADER,p.HIGH_FLOAT).precision>0&&p.getShaderPrecisionFormat(p.FRAGMENT_SHADER,p.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return"mediump"===E&&p.getShaderPrecisionFormat(p.VERTEX_SHADER,p.MEDIUM_FLOAT).precision>0&&p.getShaderPrecisionFormat(p.FRAGMENT_SHADER,p.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var C;H=H||{};var v="undefined"!=typeof WebGL2RenderingContext&&p instanceof WebGL2RenderingContext,x=H.precision!==i?H.precision:"highp",T=k(x);T!==x&&(console.warn("WebGL:",x,"not supported, using",T,"instead."),x=T);var o=H.logarithmicDepthBuffer===!0,u=p.getParameter(p.MAX_TEXTURE_IMAGE_UNITS),V=p.getParameter(p.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=p.getParameter(p.MAX_TEXTURE_SIZE),Q=p.getParameter(p.MAX_CUBE_MAP_TEXTURE_SIZE),A=p.getParameter(p.MAX_VERTEX_ATTRIBS),O=p.getParameter(p.MAX_VERTEX_UNIFORM_VECTORS),j=p.getParameter(p.MAX_VARYING_VECTORS),$=p.getParameter(p.MAX_FRAGMENT_UNIFORM_VECTORS),t=V>0,m=v||!!Z.get("OES_texture_float"),s=t&&m,b=v?p.getParameter(p.MAX_SAMPLES):0;return{getMaxAnisotropy:U,getMaxPrecision:k,precision:x,logarithmicDepthBuffer:o,maxTextures:u,maxVertexTextures:V,maxTextureSize:y,maxCubemapSize:Q,maxAttributes:A,maxVertexUniforms:O,maxVaryings:j,maxFragmentUniforms:$,vertexTextures:t,floatFragmentTextures:m,floatVertexTextures:s,maxSamples:b}}var K="ht";if(!u[K]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),u.performance&&u.performance.now||function(){var s=Date.now();u.performance||(u.performance={}),u.performance.now=function(){return Date.now()-s}}();for(var R=Date.now(),x=16,w=["ms","moz","webkit","o"],H=0;H<w.length&&!u.requestAnimationFrame;++H)u.requestAnimationFrame=u[w[H]+"RequestAnimationFrame"],u.cancelAnimationFrame=u[w[H]+"CancelAnimationFrame"]||u[w[H]+"CancelRequestAnimationFrame"];u.requestAnimationFrame||(u.requestAnimationFrame=function(l){var S=Date.now(),G=x+R-S;return 0>G&&(G=0),R=S,u.setTimeout(function(){R=Date.now(),l(performance.now())},G)}),u.cancelAnimationFrame||(u.cancelAnimationFrame=function(V){return u.clearTimeout(V)}),I.assign===i&&(I.assign=function(W){if(W===i||null===W)throw new TypeError("Cannot convert undefined or null to object");for(var s=I(W),c=1;c<arguments.length;c++){var p=arguments[c];if(p!==i&&null!==p)for(var Y in p)I.prototype.hasOwnProperty.call(p,Y)&&(s[Y]=p[Y])}return s})}();var j=u.document,w=null,v=u[K]={},$=u[K+"config"],C=v.Default=$&&$.Default||{},Y=v.Style=$&&$.Style||{},P=v.Attr=$&&$.Attr||{},E=v.Color=$&&$.Color||{},U=v.IsGetter=$&&$.IsGetter||{};!function(){var t=!1;try{var V=I.defineProperty({},"passive",{get:function(){t=!0}});u.addEventListener("test",V,V),u.removeEventListener("test",V,V)}catch(Q){t=!1}C.passiveSupported=t}();var m,M,W,F,c=C.passiveSupported,t=C.eventListenerOptionsFalse=c?{passive:!1,capture:!1}:!1,z=C.eventListenerOptionsTrue=c?{passive:!1,capture:!0}:!0,X=function(M,L,P,g){M.addEventListener(L,P,g?z:t)},q=function(m,k,J,Q){m.removeEventListener(k,J,Q?z:t)},d=Math,J=d.round,p=d.floor,R=d.ceil,Z=d.sqrt,H=d.max,V=d.min,l=d.abs,b=d.cos,g=d.acos,y=d.sin,B=d.pow,G=d.asin,Q=d.PI,e=2*Q,k=Q/2,S=d.tan,T=d.atan2,h=d.random,n=d.log,r=!1,D=!1,a=u.parseInt||global.parseInt,N="2020-06-15",s=u.navigator?u.navigator.platform.indexOf("Win")>-1:!1,o=function(e){return e*e},_=u.setTimeout,f=u.clearTimeout,A=u.location,hf=u.navigator?u.navigator.userAgent.toLowerCase():"",_j=function(Q){return Q.test(hf)},Gb=_j(/msie/),pk=_j(/msie/)||_j(/trident/),Mb=_j(/msie 10/),nc=_j(/edge/),$h=_j(/firefox/),Dk=_j(/mac/),ij=C.isTouchable===i?s?!1:j?"ontouchend"in j:!1:C.isTouchable,fn="default",yj="single",hi="multiple",or="front",Dd="back",Nh="left",He="right",Gh="top",Qc="bottom",Te="center",Wj="eye",rq="middle",Sf="east",xc="west",Lr="north",Dp="none",Ih="px",We="absolute",hl="border",mk="triangle",Ph="rect",gi="circle",Fo="cylinder",Mh="shape",rr="items",Wr="normal",rh="remove",yc="clear",In="width",bc="height",Tf="ingroup",Yp="check",_p="uncheck",cl="radio",Bs="radioOn",bl="radioOff",qc="points",el="values",ks="series",Bi="body",Xf="label",Xp="label2",Mm="note",Ie="note2",vn="icons",Fm="labelFont",Vh="labelColor",_i="labelSelectColor",Tc="note.expanded",vq="note2.expanded",rm="edge.expanded",Gg="edge.points",tp="edge.type",mp="rotation",kl="hidden",bi="visible",Rh="tuv",Hn="no",me="draw",uj="select",ur="currentSubGraph",Pf="selectBackground",Fi="autoMakeVisible",So="autoHideScrollBar",Sj="scrollBarColor",ne="scrollBarSize",Se="indent",Pg="rowHeight",ir="columnLineColor",Od="rowLineColor",rl="columnLineVisible",pe="rowLineVisible",hj="visibleFunc",hb="expandIcon",ef="collapseIcon",di="checkMode",Nm="sortFunc",yd="editable",To="batchEditable",fp="tristate",Fq="asc",co="desc",Zd="position",$b="elevation",$n="children",Qb="translateX",Lp="translateY",sj="dataModel",qp="maxSize",Oc="state",xh="shape3d",Yq="shape3d.resolution",qk="shape3d.visible",rn="shape3d.from.visible",be="shape3d.to.visible",Bh="shape3d.top.visible",Um="shape3d.bottom.visible",Df="repeat.uv.length",zh="serializeValue",Cq="deserializeValue",te="centerUniform",Zf="uniform",uq="rgba(255,255,255,0)",rk="style",vh="attr",we="field",ai="string",Sg="boolean",Sr="color",Zi="int",jd="number",rb="ew-resize",Cg="ns-resize",_q="pointer",dg="auto",so="mousedown",Rg="mousemove",cc="mouseup",fh="mouseout",Of="touchstart",hm="touchmove",ki="touchend",kq="keydown",tr="keyup",Ar=["DOMMouseScroll","mousewheel"],Qi=$h?Ar[0]:Ar[1],Cj=ij?[Of,hm,ki,kq,tr,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[kq,tr,"keypress","input",so,Rg,cc,fh,Qi,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Ml=w,de=w,lp=w,Ip=cc.length,Kh=function(){lp&&(f(lp.timeout),lp=w)},rp=function(){lp&&$k(lp.e,lp.info)};u.addEventListener&&(ij||(X(u,fh,function(){Kh()}),X(u,Qi,function(){yp()})),X(u,tr,function(G){91===G.keyCode?dj={}:delete dj[G.keyCode]},!0),X(u,kq,function(n){dj[n.keyCode]=!0},!0),X(u,"blur",function(){dj={}}));var Zc,Lj,pl,wl=0,Mn=w,kf=function(T,A){var R=_(function(){delete Mn[R],si(Mn)&&(Mn=w),T()},A);return R},Vq=w,Li=w,Pp={},zm={},Pe={},gq={},Vm={},dj={},$o={},Pc={},_h={},ud={},Kg=/.json$/,wr=/^data:image\/svg\+xml/,zl={},Qr=[],af={},iq=w,Si=w,Wf=function(){},mn=function(){throw"Oops!"},Ag=[0,0,0],Be={x:0,y:0,width:0,height:0},Vj=w,ob=w,jo=w,_d=function(n,U){zm[n]=U,U&&U.comps&&!U.uuid&&(U.uuid=v.Math.generateUUID()),fe[n]&&(U.cacheRule=fe[n],delete fe[n])},Ab=function(T){ob&&!T._72O&&(jo||(jo={}),jo[T._72O=Og()]=T),Zc!=w?gs()<.05&&F&&!Lj&&(Md=Kh):Md=tl},qi=function(h,$,b,G){ob||(ob={});var Q=ob[h];if(Q){if(Q.url===$)return;Q.image?(Q.image.onload=Wf,Q.image.onerror=Wf):Q.request&&(Q.request.onload=Wf,Q.request.onerror=Wf)}if(Kg.test($)){var m=new Uc;if(ob[h]={request:m,url:$},$=C.beforeLoadURL($),$.data){var s=C.parse($.data);$j(h,s),C.handleImageLoaded(h,s)}else{m.onload=function(){if(200===this.status||0===this.status){var G=C.parse(m.getResponseText());$j(h,G),C.handleImageLoaded(h,G)}else $j(h,C.handleUnfoundImage(h,$)||w)},m.onerror=function(){$j(h,C.handleUnfoundImage(h,$)||w)};var k={};k.url=encodeURI($),k.sync=!1,m.send(k)}}else{var s=new Image;ob[h]={image:s,url:$},/^data:image/.test($)||($=C.beforeLoadURL($),$=C.appendTimeStamp($),$=encodeURI($),s.crossOrigin=C.crossOrigin),C.convertImageSrc($,function(l){pk&&($.toLowerCase().indexOf(".svg")>0||wr.test($))?(j.body.appendChild(s),s.style.visibility="hidden",s.onload=function(){_(function(){if(b&&(s.width=b),G&&(s.height=G),!s.width||!s.height){var k=s.width||s.clientWidth,L=s.height||s.clientHeight;s.width=k,s.height=L}C.handleImageLoaded(h,s),$j(h,s),j.body.removeChild(s),s.style.visibility=""},180)},s.onerror=function(){$j(h,C.handleUnfoundImage(h,$)||w),j.body.removeChild(s),s.style.visibility=""}):(s.onload=function(){b&&(s.width=b),G&&(s.height=G),C.handleImageLoaded(h,s),$j(h,s)},s.onerror=function(){$j(h,C.handleUnfoundImage(h,$)||w)}),s.src=l})}},$j=function(F,f){if(_d(F,f),delete ob[F],si(ob)&&(ob=w,jo)){for(var Z in jo){var C=jo[Z];C._2O&&C._2O[F]&&(C.deleteTexture(F),delete C._2O[F]),C.invalidateAll&&C.invalidateAll(i,"imageLoaded",F),C.redraw&&C.redraw(),C.iv(),delete C._72O}jo=w}if(f&&jo)for(var Z in jo){var C=jo[Z];C.invalidateAll&&C.invalidateAll(i,"imageLoading",F),C.redraw&&C.redraw(),C.iv()}},Vb=function(){return n=d&&Date,function(){return u.performance&&u.performance.now?u.performance.now():Date.now()}}(),Th=function(G,B,n){return{width:G,height:B,comps:qf(n)?n:[n]}},ff=function(l,g){return{type:gi,rect:[l,g,1.6,1.6],borderWidth:1,borderColor:Pd,gradient:Yc,gradientColor:kd,background:Pd}},_b=function(A,F){return Th(16,16,{type:mk,rect:[4,4,10,8],background:A,rotation:F?1.57:3.14})},Cl=function(d,g){return Th(16,16,{type:mk,rect:[4,4,8,7],background:d,rotation:g?3.14:0})},ym=function(f){var x=f._orientation;return"horizontal"===x||"h"===x},Rr=function(o,m){var n=w||4,X=w||1,c=w||1;0>n?n=0:n>.25&&(n=.25);var H,S,h,G,a,k,g,A=.5,t=[],l=[],F=[],R=e/c,Y=e/X,r=A-n;for(S=0;X>=S;S++)for(G=-Q+S*Y,k=b(G),a=y(G),H=0;c>=H;H++)h=H*R,g=r+n*k,t.push(b(h)*g,a*n,-y(h)*g),(M=[o,m])&&l.push(H/c,1-S/X);for(S=0;X>S;S++){var v=S*(c+1),L=(S+1)*(c+1);for(H=0;c>H;H++)F.push(v+H,L+H+1,L+H,v+H,v+H+1,L+H+1),$e.z=oo.z=[o,m]}},xf=function(w){var X=2,z=0;for(var A in w)A.length===X&&a(A,32)===Ve&&(iq=Si=w[A]),z++;return z},Eb=function(o,T,i,y){return i||(i=ij?5:3,i/=y||1),{x:o-i,y:T-i,width:2*i,height:2*i}},cf=function(n,b,E,G){var A=this;b||(b=ij?5:3,E=20,G=20);var p={x:n,y:b,width:E,height:G};if(E)for(var s=0;E>s;s++)if(3===E)G=20;else for(var K=0;G>K;K++)A=u?u:E;var D={x:Q,y:2*Q};if(gg(p,D)){var d=bc[0]+Gh[0]+yc[1]+Fq.length,l=kl[0]+fp[0]+yc[1]+Bi.length;Ho[Wj]=[A[d],A[l]],A[d]=Mj[Wj],A[l]=Mj[xh]}},Mo=function(V){return(/ble$/.test(V)||/ed$/.test(V)||U[V]?"is":"get")+V.charAt(0).toUpperCase()+V.slice(1)},Mj=function(F){return"set"+F.charAt(0).toUpperCase()+F.slice(1)},tq=function(z){return typeof z===ai||z instanceof String},Vc=function(I){return typeof I===jd},tl=function(C){return typeof C===Sg},as=function(g){return g&&"object"==typeof g},Ad=function(D){return"function"==typeof D},qf=function(Y){return Y instanceof Array},eq=function(D){return D instanceof Pb},_r=function(j){return qf(j)?new Pb(j):j},gr=function(P){return P instanceof ab},kn=function(w){return w instanceof Fb},Xh=function(I){return I instanceof le},eg=function(L,s){if(!(L instanceof v.Group))return!1;if(!s)return L.isExpanded();var T=s.getDataUI(L);return T&&T._88I?!0:!1},dq=function(u){return u instanceof jl},Ri=function(D){return D&&"IFRAME"===D.tagName},ps=function(_){return _==w||C.numberDigits==w?_:parseFloat(_.toFixed(C.numberDigits))},ho=function(u,E,f){var Y,x=E.length;if(f)for(var j=0;f>j;j++)if(3===x)u.push(E[0]),u.push(E[1]),u.push(E[2]);else for(Y=0;x>Y;Y++)u.push(E[Y]);else if(3===x)u.push(E[0]),u.push(E[1]),u.push(E[2]);else for(Y=0;x>Y;Y++)u.push(E[Y])},ig=function(y){return y?as(y)?y:{}:!1},og=function(T,B,D){var V,v=as(T)?T:T.prototype;for(V in B)D&&V in v?v[V]===i&&console.warn("class",v,"has own undefined property",V,", keep exist!"):v[V]=B[V];return T},Dq=function(D,r){if(!("wheelDelta"in r)){var N=r.deltaMode;r.wheelDelta=N===r.DOM_DELTA_PIXEL?-r.deltaY:N===r.DOM_DELTA_LINE?40*-r.deltaY:120*-r.deltaY}D.handle_mousewheel(r)},Gl=function(C){return String.fromCharCode(C)},fs=function(e){for(var K,G=0,L="";G<e.length;G++)K=e[e.length-1-G],"%"===K?K="'":"a"===K?K='"':"]"===K&&(K="\\"),L+=Gl(K.charCodeAt(0)-1);return L},qj=function(f,Y,F){f.superClass.constructor.apply(Y,F)},si=function(P){for(var D in P)return!1;return!0},vi=function(i){return i?0===i.length:!0},bo=function(){var k="";return[_p[0],Od[0],Xf[0]].forEach(function(M){k+=Mj(M).slice(3)}),Zf=j&&j[k]||te,function(L,T){return L===T?!0:L.x===T.x&&L.y===T.y&&L.width===T.width&&L.height===T.height}}(),ll=function(X,E,u){return E>X?E:X>u?u:X},Jn=function(c){return 0>c?-1:c>0?1:0},gs=function(){var C=1e4*y(Ip++);return C-p(C)},Or=function(H,I,b){return Xo(H.x,H.y,I.x,I.y,b.x,b.y,b.x+b.width,b.y,!0)||Xo(H.x,H.y,I.x,I.y,b.x+b.width,b.y,b.x+b.width,b.y+b.height,!0)||Xo(H.x,H.y,I.x,I.y,b.x+b.width,b.y+b.height,b.x,b.y+b.height,!0)||Xo(H.x,H.y,I.x,I.y,b.x,b.y+b.height,b.x,b.y,!0)},Xo=function(z,O,v,f,F,Z,b,$,g){var Y=(b-F)*(O-Z)-($-Z)*(z-F),X=($-Z)*(v-z)-(b-F)*(f-O);if(0!==X){var E=Y/X,_=z+E*(v-z),t=O+E*(f-O);return g&&(_+oc<V(z,v)||_-oc>H(z,v)||_+oc<V(F,b)||_-oc>H(F,b)||t+oc<V(O,f)||t-oc>H(O,f)||t+oc<V(Z,$)||t-oc>H(Z,$))?w:[_,t]}return w},ms=function(n,z,S){if(n&&S)if(z){if(z===rk)return n.getStyle(S);if(z===vh)return n.getAttr(S);if(z===we)return n[S]}else if(S=Mo(S),n[S])return n[S]();return i},Sq=function(U,d,T,j){if(U&&T)if(d){if(d===rk)U.s(T,j);else if(d===vh)U.a(T,j);else if(d===we){var O=U[T];U[T]=j,U.fp("f:"+T,O,j)}}else T=Mj(T),U[T]&&U[T](j)},ip=function(N,m,B){return m&&"top"!==m?"bottom"===m?{x:N.x,y:N.y,width:N.width,height:N.height*B}:"right"===m?{x:N.x,y:N.y,width:N.width*B,height:N.height}:"left"===m?{x:N.x+N.width*(1-B),y:N.y,width:N.width*B,height:N.height}:void 0:{x:N.x,y:N.y+N.height*(1-B),width:N.width,height:N.height*B}},hp=function(O,Z,j,t,u){Z&&sc(O,j,t,1,u,Z)},Fe=function(D,j,V,i){var W=1-D;return W*W*j+2*D*W*V+D*D*i},$e=function(s,c,U,v,J){var m=1-s;return m*m*m*c+3*m*m*s*U+3*m*s*s*v+s*s*s*J},Xq=function(T){var j,p,g,L,D=0;return T.forEach(function(G){if(j=G.length,j>0)for(p=G[0],L=1;j>L;L++)g=G[L],D+=Sp(p,g),p=g}),D},hn=function(r,b,Y){var p="__"+r,S=function(S){Y.disabled||Y["handle_"+r](S)};Y[p]||(Y[p]=S,X(b,r,S))},kg=function(s,p,m){var N="__"+s,L=m[N];L&&(q(p,s,L),delete m[N])},tn=function(L,$){var a="_"+$;L[Mo($)]=function(){return this[a]},L[Mj($)]=function(n){var I=this[a];this[a]=n,this.fp($,I,n)}},ib=function(M){return I.create(M)},op=function(p){if(!p.element){var I,G;(I=p.textField)?G=ep(ee.TextField,I):(I=p.textArea)?G=ep(ee.TextArea,I):(I=p.button)?G=ep(ee.Button,I):(I=p.comboBox)?G=ep(ee.ComboBox,I):(I=p.checkBox)?G=ep(ee.CheckBox,I):(I=p.radioButton)?G=ep(ee.RadioButton,I):(I=p.slider)?G=ep(ee.Slider,I):(I=p.colorPicker)?G=ep(ee.ColorPicker,I):(I=p.image)&&(G=ep(ee.Image,I)),G&&(p.element=G)}},pf=function(s,D){var a=xl(s);return a._ht=D,a},xl=function(n,B){var Y=j.createElement("div"),X=Y.style;return Y.tabIndex=-1,Y.onkeydown=jm,X.msTouchAction=Dp,cs(Y,w,0),ij&&X.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",w),n&&(X.overflow=kl),B&&Pj(B,Y),Y},$f=function(J,T){var H=j.createElement("canvas"),P=H.style;return P.msTouchAction=Dp,T||(P.pointerEvents=Dp),cs(H,w,0),J&&Pj(J,H),H},cs=function(E,$,F){var N=E.style;N.border=$?$+" solid 1px":0,N.outline=0,N.padding=F?"0 "+F+Ih:0,vg(E)},vg=function(g){var x=g.style;x.position=We,x.margin=0,x.setProperty("box-sizing","border-box",w),x.setProperty("-moz-box-sizing","border-box",w)},vf=function(X,k,R,Q){Q||(Q=re),k!=w&&(X.width=k*Q,X.style.width=k+Ih),R!=w&&(X.height=R*Q,X.style.height=R+Ih)},Pj=function(v,A,e){v.appendChild(A),e&&(A.style.position=We)},Ng=function(u,A){A.split||(A+="");for(var B,M=A.split("\n"),o=0,y=M.length,b=0;y>b;b++){var K=Sk(u.font,M[b]);K.width>o&&(o=K.width),B||(B=K.height)}return u.ss=M,{width:o,height:B*y}},Xr=function(a,H,r,S,J,v){var e=H.length;if(1===e)Ii(a,H[0],r,S,J);else for(var K=r.height/e,s={x:r.x,y:r.y,width:r.width,height:K},M=0;M<H.length;M++)v?gb(a,H[M],S,J,s.x,s.y,s.width,s.height,v):Ii(a,H[M],s,S,J),s.y+=K},Ii=function(r,I,M,A,b){r.font=A?A:Eo,r.fillStyle=b?b:Ji,r.textAlign=Te,r.textBaseline=rq;var c,S;M?M.width===i?(c=M.x,S=M.y):(c=M.x+M.width/2,S=M.y+M.height/2):(c=0,S=0),r.fillText(I,J(c),J(S))},Xg=function(G){G.getView&&(G=G.getView());var h=G.offsetWidth||G.scrollWidth;return!h&&G.style.width&&(h=a(G.style.width)),h},um=function(K){K.getView&&(K=K.getView());var D=K.offsetHeight||K.scrollHeight;return!D&&K.style.height&&(D=a(K.style.height)),D},$q=function(u,c,D){var g=c[0].toUpperCase()+c.substring(1,c.length);u["webkit"+g]=D,u["moz"+g]=D,u["ms"+g]=D,u["o"+g]=D,u[c]=D},Wg=function(){var N=function(N){jm(N),N.stopPropagation()},s=function(V){jm(V)},n=ij?[Of]:[kq,so];return function(z,H){var k=xl(),G=k.style;return G.backgroundColor=C.disabledBackground,z&&(G.backgroundImage="url("+z+")",G.backgroundPosition="50% 50%",G.backgroundRepeat="no-repeat no-repeat"),H===!1?n.forEach(function(f){X(k,f,s)}):n.forEach(function(D){X(k,D,N)}),k}}(),Xl=function(k){var U=k.getContext("2d");return U.save(),U.lineCap=gd,U.lineJoin=to,U},Md=function(E,w,m,M){_k(E,w*re,m*re),M*=re,1!==M&&E.scale(M,M)},_k=function(r,K,Z){r.translate(K,Z)},uh=function(H,C){C&&H.rotate(C)},Gn=function(K,g,S){g===i&&(g=1),S===i&&(S=1),(1!==g||1!==S)&&K.scale(g,S)},Wk=!1,Rc=function(t){var x=j.activeElement;if(j.activeElement!==t){x&&x.forceOnblur&&x.forceOnblur();for(var F=[],q=t.parentNode;q;)F.push([q,q.scrollLeft,q.scrollTop]),q=q.parentNode;if(!Wk){var Y=[],B=[];try{for(var U=u.parent,K=u;U!==K;)Y.push([U,U.scrollX,U.scrollY]),K=U,U=u.parent;var R=u.frameElement;if(R)for(var I=R.parentNode;I;)B.push([I,I.scrollLeft,I.scrollTop]),I=I.parentNode}catch(l){Wk=!0}}if(ij)t.focus();else{var O=Je(),z=O.target;t.focus(),z.scrollLeft=O.left,z.scrollTop=O.top}F.forEach(function(j){j[0].scrollLeft=j[1],j[0].scrollTop=j[2]}),Wk||(Y.forEach(function(F){F[0].scrollTo(F[1],F[2])}),B.forEach(function(E){E[0].scrollLeft=E[1],E[0].scrollTop=E[2]}))}},Jg=function(j){return j&&j.getView?j.getView():j},Wp=function(E,c,v,z,W){if(2===arguments.length&&(v=c.y,z=c.width,W=c.height,c=c.x),E.isSelfViewEvent)E.setX(c),E.setY(v),E.setWidth(z),E.setHeight(W);else{var F=Jg(E),D=F.style;if((j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement)!==F)c!==i&&(D.left=c+Ih),v!==i&&(D.top=v+Ih),z!==i&&(D.width=z+Ih),W!==i&&(D.height=W+Ih);else{var n=C.getWindowInfo();D.left=(c=n.left)+Ih,D.top=(v=n.top)+Ih,D.width=(z=n.width)+Ih,D.height=(W=n.height)+Ih}E.endEditing&&!ij&&E.endEditing(),E.redraw&&E.redraw(),E.invalidate&&E.invalidate(),E.onLayouted&&E.onLayouted(c,v,z,W),E.fireViewEvent&&E.fireViewEvent("layout")}},ds=function(I){if(!I.touches)return I;var C=I.touches[0];return C?C:I.changedTouches[0]},nq=function(e){return ij?ds(e).target:e.target},Fc=function(y){C.popup&&C.popup.close(),C.popup=y},Bb=w,Hi=function(f){Bb.handleWindowTouchMove(f)},Sd=function(F){Bb.handleWindowTouchEnd(F),q(u,hm,Hi),q(u,ki,Sd),Bb=w},oh=function(a){Bb.handleWindowMouseMove(a)},wo=function(h){Bb.handleWindowMouseUp(h),q(u,Rg,oh),q(u,cc,wo),Bb=w},vj=function(n){return 1===bs(n)},ed=function(N,f){return f?f.keyCode===N:dj[N]},Bn=function(O){return _n(O)&&ed(65,O)},Po=function($){return ed(46,$)||ed(8,$)},wc=function(m){return function(j){return j?j.keyCode===m:dj[m]}},Ve=573,Hm=[65,83,68,87,37,38,39,40,32,13,27],Fr=wc(Hm[0]),ie=wc(Hm[1]),fm=wc(Hm[2]),Mc=wc(Hm[3]),tg=wc(Hm[4]),Oo=wc(Hm[5]),od=wc(Hm[6]),jn=wc(Hm[7]),Dj=wc(Hm[8]),np=wc(Hm[9]),Gr=wc(Hm[10]),Zp={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Hb=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,17,271],ul=w,oq=w,Qf=function(_,c){ul||(ul=$f()),vf(ul,_,c,1);var v=Xl(ul);return v.clearRect(0,0,_,c),v},Jf=function(){var n,P={};for(var j in u){var M=hi.length;if(j.length==M&&j[0]===hi[2]&&j[1]===Dp[1]&&j[4]===hi[3]&&j[5]===hi[4]&&j.substr(M-2)===Dp[1]+Dp[2]){var x=u[j];for(var Z in x)Z.length===M&&Z.substr(0,3)===He[3]+rh[3]+uj[0]&&Z.substr(M-2)===hi[0]+Mm[3]&&(Ar=x[Z])}}return function(e){var x,Y=P[e];return Y||(n||(n=$f(),vf(n,1,1,1)),x=n.getContext("2d"),x.clearRect(0,0,1,1),sc(x,0,0,1,1,e),Y=x.getImageData(0,0,1,1).data,Y=P[e]=[Y[0],Y[1],Y[2],Y[3]]),Y}}(),_g=function(q){if(!tq(q))return q;var k=Jf(q);return k.CA||(k.CA=[k[0]/255,k[1]/255,k[2]/255,k[3]/255]),k.CA},lo=function(X,l,g,q,e){var z=$f();z.width=g,z.height=q;var G=z.getContext("2d");G.drawImage(X,0,0,g,q);try{for(var F=G.getImageData(0,0,g,q),P=F.data,B=0,L=P.length;L>B;B+=4){var d=P[B+0],u=P[B+1],H=P[B+2],y=P[B+3];"override_a"===e?P[B+3]=255*l[3]:"override_rgb"===e?(P[B+0]=255*l[0],P[B+1]=255*l[1],P[B+2]=255*l[2]):"override"===e?(P[B+0]=255*l[0],P[B+1]=255*l[1],P[B+2]=255*l[2],P[B+3]=255*l[3]):(P[B+0]=l[0]*d,P[B+1]=l[1]*u,P[B+2]=l[2]*H,P[B+3]=l[3]*y)}G.putImageData(F,0,0)}catch(R){return X}return z},Ho=function(k,O,D){return O&&(O="miter"===D?8*O+20:O+1,k&&Cc(k,O)),O},Gi=function(q,P){if(P){var Y=new yk(P),Q=q.width/2,m=q.height/2,B=ye([Y.tf(-Q,-m),Y.tf(Q,-m),Y.tf(Q,m),Y.tf(-Q,m)]);return B.x+=q.x+Q,B.y+=q.y+m,B}return q},ql=function(R,F,O,t,B,n,g,M){t*=Math.PI/180;var A={x:Math.cos(t)*(R.x-g.x)/2+Math.sin(t)*(R.y-g.y)/2,y:-Math.sin(t)*(R.x-g.x)/2+Math.cos(t)*(R.y-g.y)/2},s=Math.pow(A.x,2)/Math.pow(F,2)+Math.pow(A.y,2)/Math.pow(O,2);s>1&&(F*=Math.sqrt(s),O*=Math.sqrt(s));var h=(B==n?-1:1)*Math.sqrt((Math.pow(F,2)*Math.pow(O,2)-Math.pow(F,2)*Math.pow(A.y,2)-Math.pow(O,2)*Math.pow(A.x,2))/(Math.pow(F,2)*Math.pow(A.y,2)+Math.pow(O,2)*Math.pow(A.x,2)));isNaN(h)&&(h=0);var D={x:h*F*A.y/O,y:h*-O*A.x/F},x={x:(R.x+g.x)/2+Math.cos(t)*D.x-Math.sin(t)*D.y,y:(R.y+g.y)/2+Math.sin(t)*D.x+Math.cos(t)*D.y},K=function(k){return Math.sqrt(Math.pow(k[0],2)+Math.pow(k[1],2))},f=function(N,j){return(N[0]*j[0]+N[1]*j[1])/(K(N)*K(j))},j=function(Q,h){return(Q[0]*h[1]<Q[1]*h[0]?-1:1)*Math.acos(f(Q,h))},Y=j([1,0],[(A.x-D.x)/F,(A.y-D.y)/O]),v=[(A.x-D.x)/F,(A.y-D.y)/O],J=[(-A.x-D.x)/F,(-A.y-D.y)/O],c=j(v,J);f(v,J)<=-1&&(c=Math.PI),f(v,J)>=1&&(c=0);var f=F>O?F:O,e=F>O?1:F/O,Q=F>O?O/F:1;if(null==M){var p={x:0,y:0,width:0,height:0};Cc(p,f),p.x*=e,p.width*=e,p.y*=Q,p.height*=Q;var W=new yk(t);return p=ye([W.tf(p.x,p.y),W.tf(p.x+p.width,p.y),W.tf(p.x+p.width,p.y+p.height),W.tf(p.x,p.y+p.height)]),p.x+=x.x,p.y+=x.y,[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}]}M.translate(x.x,x.y),M.rotate(t),M.scale(e,Q),M.arc(0,0,f,Y,Y+c,1-n),M.scale(1/e,1/Q),M.rotate(-t),M.translate(-x.x,-x.y)},Ff=function(k,X){k&&k.beginPath();for(var W,F,Y,$=[],n=function(J){for(var w,d=/(\-{0,1}[\d\.]+)/gi,m=[];w=d.exec(J);)m.push(parseFloat(w[0]));return m},r=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,s={x:0,y:0};W=r.exec(X);){var L=W[0],x=L.substr(0,1);if("M"===x||"m"===x){for(var y=n(L),K=0;K<y.length;K+=2){var v=y[K],q=y[K+1];"m"===x&&(v+=s.x,q+=s.y),k&&k.moveTo(v,q),$.push({x:v,y:q}),s.x=v,s.y=q}F=Y=null}else if("H"===x||"h"===x){for(var y=n(L),K=0;K<y.length;K+=1){var v=y[K];"h"===x&&(v+=s.x),k&&k.lineTo(v,s.y),$.push({x:v,y:s.y}),s.x=v}F=Y=null}else if("C"===x||"c"===x){for(var y=n(L),K=0;K<y.length;K+=6){var e=y[K],c=y[K+1],A=y[K+2],P=y[K+3],v=y[K+4],q=y[K+5];"c"===x&&(e+=s.x,c+=s.y,A+=s.x,P+=s.y,v+=s.x,q+=s.y),k&&k.bezierCurveTo(e,c,A,P,v,q),$.push({x:e,y:c}),$.push({x:A,y:P}),$.push({x:v,y:q}),s.x=v,s.y=q}F=[e,c,A,P,v,q],Y=null}else if("S"===x||"s"===x){for(var y=n(L),K=0;K<y.length;K+=4){var e,c;F?(e=2*F[4]-F[2],c=2*F[5]-F[3]):(e=s.x,c=s.y);var A=y[K],P=y[K+1],v=y[K+2],q=y[K+3];"s"===x&&(A+=s.x,P+=s.y,v+=s.x,q+=s.y),k&&k.bezierCurveTo(e,c,A,P,v,q),$.push({x:e,y:c}),$.push({x:A,y:P}),$.push({x:v,y:q}),s.x=v,s.y=q}F=[e,c,A,P,v,q],Y=null}else if("Q"===x||"q"===x){for(var y=n(L),K=0;K<y.length;K+=4){var e=y[K],c=y[K+1],v=y[K+2],q=y[K+3];"q"===x&&(e+=s.x,c+=s.y,v+=s.x,q+=s.y),k&&k.quadraticCurveTo(e,c,v,q),$.push({x:e,y:c}),$.push({x:v,y:q}),s.x=v,s.y=q}F=null,Y=[e,c,v,q]}else if("T"===x||"t"===x){for(var y=n(L),K=0;K<y.length;K+=2){var e,c;Y?(e=2*Y[2]-Y[0],c=2*Y[3]-Y[1]):(e=s.x,c=s.y);var v=y[K],q=y[K+1];"t"===x&&(v+=s.x,q+=s.y),k&&k.quadraticCurveTo(e,c,v,q),$.push({x:e,y:c}),$.push({x:v,y:q}),s.x=v,s.y=q}F=null,Y=[e,c,v,q]}else if("V"===x||"v"===x){for(var y=n(L),K=0;K<y.length;K+=1){var q=y[K];"v"===x&&(q+=s.y),k&&k.lineTo(s.x,q),$.push({x:s.x,y:q}),s.y=q}F=Y=null}else if("L"===x||"l"===x){for(var y=n(L),K=0;K<y.length;K+=2){var v=y[K],q=y[K+1];"l"===x&&(v+=s.x,q+=s.y),k&&k.lineTo(v,q),$.push({x:v,y:q}),s.x=v,s.y=q}F=Y=null}else if("A"===x||"a"===x){for(var y=n(L),K=0;K<y.length;K+=7){var G=y[K],o=y[K+1],h=y[K+2],m=y[K+3],O=y[K+4],v=y[K+5],q=y[K+6];"a"===x&&(v+=s.x,q+=s.y);var f=ql(s,G,o,h,m,O,{x:v,y:q},k);f&&($=$.concat(f)),s.x=v,s.y=q}F=Y=null}var i=L.substr(L.length-1);("z"===i||"Z"===i)&&k&&k.closePath()}return $},ts=function(M,m){var B,F,V="L"===m[0],Z=m.length;M.save(),V?(M.transform(m[5],m[6],m[7],m[8],m[9],m[10]),B=M.createLinearGradient(m[1],m[2],m[3],m[4]),F=11):(M.transform(m[7],m[8],m[9],m[10],m[11],m[12]),B=M.createRadialGradient(m[1],m[2],m[3],m[4],m[5],m[6]),F=13);for(var J=M.compGray;Z>F;)B.addColorStop(m[F],J?C.toGrayColor(m[F+1]):m[F+1]),F+=2;M.fillStyle=B},oo=function(q,h){var a=q.s("shape.gradient.pack");if(a){for(var J=a.length,Q=new Array(J),R=0;J>R;R++)Q[R]=a[R];var K,k,r,l,U,j,v,H,m,D,t,f,i,E="L"===Q[0];K=E?5:7,k=Q[K],r=Q[K+1],l=Q[K+2],U=Q[K+3],j=Q[K+4],v=Q[K+5],H=h[0],m=h[1],D=h[2],t=h[3],f=h[4],i=h[5],Q[K]=H*k+D*r,Q[K+1]=m*k+t*r,Q[K+2]=H*l+D*U,Q[K+3]=m*l+t*U,Q[K+4]=H*j+D*v+f,Q[K+5]=m*j+t*v+i,q.s("shape.gradient.pack",Q)}},Vr=function(b,A,C,N){var a=!1;if(b.beginPath?b.beginPath():a=!0,eq(A)&&(A=A._as),eq(C)&&(C=C._as),C&&C.length){for(var e,F,v,z,s=0,S=0,j=C.length;j>S;S++)e=C[S],1===e?(F=A[s++],b.moveTo(F.x,a?-F.y:F.y)):2===e?(F=A[s++],b.lineTo(F.x,a?-F.y:F.y)):3===e?(F=A[s++],v=A[s++],b.quadraticCurveTo(F.x,a?-F.y:F.y,v.x,a?-v.y:v.y)):4===e?(F=A[s++],v=A[s++],z=A[s++],b.bezierCurveTo(F.x,a?-F.y:F.y,v.x,a?-v.y:v.y,z.x,a?-z.y:z.y)):5===e&&b.closePath();N&&5!==e&&b.closePath()}else{var g,D,d,x=A.length;if(x>0){for(g=A[0],b.moveTo(g.x,a?-g.y:g.y),D=1;x>D;D++)d=A[D],b.lineTo(d.x,a?-d.y:d.y);N&&b.closePath()}}},mm=function(A,b,r,W){if(eq(A)&&(A=A._as),eq(b)&&(b=b._as),b&&b.length){r=r||uf;for(var T,S,v,X,e,y,D,o,C=[],n=w,x=0,z=0,u=b.length;u>z;z++)if(T=b[z],1===T)C.push(n=[]),n.push(A[x++]);else if(2===T)n.push(A[x++]);else if(3===T){for(S=n[n.length-1],v=A[x++],X=A[x++],y=1;r>y;y++)D=Fe(y/r,S.x,v.x,X.x),o=Fe(y/r,S.y,v.y,X.y),n.push({x:D,y:o,b:!0});n.push(X)}else if(4===T){for(S=n[n.length-1],v=A[x++],X=A[x++],e=A[x++],y=1;r>y;y++)D=$e(y/r,S.x,v.x,X.x,e.x),o=$e(y/r,S.y,v.y,X.y,e.y),n.push({x:D,y:o,b:!0});n.push(e)}else 5===T&&n.push(n[0]);return W&&5!==T&&n&&n.length>2&&n.push(n[0]),C}return W&&A.length>2&&(A=A.slice(),A.push(A[0])),A?[A]:[]},vr=function(b,k,L,Y,W,Z){var h,$,p,j=Jf(k),x=Y,F=j[0],v=j[1],H=j[2];if(L){var X=Jf(L);h=X[0]-F,$=X[1]-v,p=X[2]-H}else h=255-F,$=255-v,p=255-H;for(Z||(Z=Y>10?1:.5,Z=1>W?V(Z/W,2):Z),b.save(),b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=0,b.shadowColor=0;(Y-=Z)>0;){var A=1-Y/x,I=F+h*A,q=v+$*A,M=H+p*A;I=V(R(I),255),q=V(R(q),255),M=V(R(M),255),b.strokeStyle="rgb("+I+","+q+","+M+")",b.lineWidth=Y,b.stroke()}b.restore()},Mq=function(){var O={};return function(I,F){var u=I+"-"+F,X=O[u];if(X)return X;var k,j,J,f=Jf(I);return 0>F?(F=(100+F)/100,k=R(f[0]*F),j=R(f[1]*F),J=R(f[2]*F)):(F/=100,k=f[0],j=f[1],J=f[2],k+=(255-k)*F,j+=(255-j)*F,J+=(255-J)*F,k=V(R(k),255),j=V(R(j),255),J=V(R(J),255)),O[u]="rgb("+k+","+j+","+J+")"}}(),sc=function(N,T,g,q,J,P){P&&(N.fillStyle=P),N.beginPath(),N.rect(T,g,q,J),N.fill()},ld=function(d,N,A,p,K,g,b){d.beginPath(),Qj[N](d,A.x,A.y,A.width,A.height,p,K,g,b)},_l=function(e,s,f,F,i){var O=Qj[f];e.fillStyle=O?O(e,s,F?F:kd,i.x,i.y,i.width,i.height):s},bd=function(R,s,k,M,b,p){try{if(!s.tagName&&s.comps){s._cacheImage_||(s._cacheImage_={});var l;l="override"===M?"colors_override":"override_rgb"===M?"colors_override_rgb":"override_a"===M?"colors_override_a":"colors",s._cacheImage_[l]||(s._cacheImage_[l]={__count__:0});var Q=s._cacheImage_[l][k];Q||(s._cacheImage_[l].__count__>C.imageCacheThreshold&&(s._cacheImage_[l]={__count__:0}),Q=v.Default.toCanvas(s,Xk(s),Dg(s),null,b,p,k,null,M),s._cacheImage_[l][k]=Q,s._cacheImage_[l].__count__++),s=Q}R.fillStyle=R.createPattern(s,"repeat")}catch(o){R.fillStyle="black"}},Ei=function(k,b,M,Z,l,p,O){k.save(),k.translate(b,M),k.scale(1,O/p),k.arc(0,0,p,Z,l),k.restore()},ng=function(J,T,I,i,$,L,M,B){var n,v,g,q,A,k,E,K,F,h,e;if(l($)>2*Q&&($=2*Q),A=R(l($)/(Q/4)),n=$/A,v=-n,g=-i,A>0){k=T+b(i)*L,E=I+y(-i)*M,B?J.lineTo(k,E):J.moveTo(k,E);for(var S=0;A>S;S++)g+=v,q=g-v/2,K=T+b(g)*L,F=I+y(g)*M,h=T+b(q)*(L/b(v/2)),e=I+y(q)*(M/b(v/2)),J.quadraticCurveTo(h,e,K,F)}},Hp=function(Q,l,h,n,S,w,p,m,P){6===arguments.length&&(p=w,m=w,P=w);var s=l+n,U=h+S,T=S>n?2*n:2*S;w=T>w?w:T,p=T>p?p:T,m=T>m?m:T,P=T>P?P:T;var c=.29*P,b=.58*P;Q.moveTo(s,U-P),Q.quadraticCurveTo(s,U-b,s-c,U-c),Q.quadraticCurveTo(s-b,U,s-P,U),c=.29*m,b=.58*m,Q.lineTo(l+m,U),Q.quadraticCurveTo(l+b,U,l+c,U-c),Q.quadraticCurveTo(l,U-b,l,U-m),c=.29*w,b=.58*w,Q.lineTo(l,h+w),Q.quadraticCurveTo(l,h+b,l+c,h+c),Q.quadraticCurveTo(l+b,h,l+w,h),c=.29*p,b=.58*p,Q.lineTo(s-p,h),Q.quadraticCurveTo(s-b,h,s-c,h+c),Q.quadraticCurveTo(s,h+b,s,h+p),Q.lineTo(s,U-P)},Zh=function(R,X,A,Q,v,S,N){X&&(A=J(A),Q=J(Q),N||(N=1),R.fillStyle=X,R.beginPath(),R.rect(A,Q,N,S),R.rect(A,Q,v,N),S-N>0&&R.rect(A,Q+S-N,v,N),v-N>0&&R.rect(A+v-N,Q,N,S),R.fill())},Wn=function(N,K,D,d){var T=d.x,G=d.y,Z=d.width,Y=d.height;if(!(!K||!D||0>=Z||0>=Y)){var E,i=Ro(K),O=_m(K),S=D>0;1===D||-1===D?(N.fillStyle=S?i:O,N.beginPath(),N.rect(T,G,1,Y),N.rect(T,G,Z,1),N.fill(),N.fillStyle=S?O:i,N.beginPath(),N.rect(T,G+Y-1,Z,1),N.rect(T+Z-1,G,1,Y),N.fill()):(D=V(l(D),V(Z/2,Y/2)),E=N.createLinearGradient(T,G,T+D,G),E.addColorStop(0,S?i:O),E.addColorStop(1,K),N.fillStyle=E,N.beginPath(),N.moveTo(T,G),N.lineTo(T+D,G+D),N.lineTo(T+D,G+Y-D),N.lineTo(T,G+Y),N.lineTo(T,G),N.fill(),E=N.createLinearGradient(T,G,T,G+D),E.addColorStop(0,S?i:O),E.addColorStop(1,K),N.fillStyle=E,N.beginPath(),N.moveTo(T,G),N.lineTo(T+D,G+D),N.lineTo(T+Z-D,G+D),N.lineTo(T+Z,G),N.lineTo(T,G),N.fill(),E=N.createLinearGradient(T,G+Y,T,G+Y-D),E.addColorStop(0,S?O:i),E.addColorStop(1,K),N.fillStyle=E,N.beginPath(),N.moveTo(T,G+Y),N.lineTo(T+D,G+Y-D),N.lineTo(T+Z-D,G+Y-D),N.lineTo(T+Z,G+Y),N.lineTo(T,G+Y),N.fill(),E=N.createLinearGradient(T+Z,G,T+Z-D,G),E.addColorStop(0,S?O:i),E.addColorStop(1,K),N.fillStyle=E,N.beginPath(),N.moveTo(T+Z,G),N.lineTo(T+Z-D,G+D),N.lineTo(T+Z-D,G+Y-D),N.lineTo(T+Z,G+Y),N.lineTo(T+Z,G),N.fill())}},Gd=function(P,j,p,V,N,y,R){var b=P.createLinearGradient(V,N,y,R);return b.addColorStop(0,p),b.addColorStop(1,j),b},Ij=function(G,X,g,O,E,Q,w){var x=G.createLinearGradient(O,E,Q,w);return x.addColorStop(0,X),x.addColorStop(.5,g),x.addColorStop(1,X),x},Hl=function(U,y,Y,j,E,c,o){var I=U.createLinearGradient(j,E,c,o);return I.addColorStop(0,y),I.addColorStop(1/3,Y),I.addColorStop(2/3,y),I.addColorStop(1,Y),I},wg=function(m,Z,z,J,e,d,L,b,X){var C=m.createRadialGradient(J+d*b,e+L*X,V(d,L)/24,J+d/2,e+L/2,H(d,L)/2);return C.addColorStop(0,z),C.addColorStop(1,Z),C},pp=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Qj={polygon:function(T,P,O,x,H,u){(u==w||3>u)&&(u=6);for(var p,C,G=V(x,H)/2,_=P+x/2,e=O+H/2,h=0,o=2*Q/u,R=0;u>R;R++)p=_+b(h)*G,C=e+y(h)*G,0===R?T.moveTo(p,C):T.lineTo(p,C),h+=o;
T.closePath()},arc:function(i,t,x,c,N,T,R,g,p){T==w&&(T=Q),R==w&&(R=e),g==w&&(g=!0);var D=t+c/2,J=x+N/2;g&&i.moveTo(D,J),p?Ei(i,D,J,T,R,c/2,N/2):i.arc(D,J,V(c,N)/2,T,R),g&&i.closePath()},rect:function(k,O,y,g,f){k.rect(O,y,g,f)},circle:function(m,z,b,I,d){m.arc(z+I/2,b+d/2,V(I,d)/2,0,e,!0)},oval:function(K,V,$,f,B){Ei(K,V+f/2,$+B/2,0,e,f/2,B/2)},roundRect:function(J,m,f,$,H,k){k==w&&(k=V(V($,H)/4,8)),Hp(J,m,f,$,H,k)},star:function(X,f,u,B,y){var g=2*B,p=2*y,q=f+B/2,v=u+y/2;X.moveTo(q-g/4,v-p/12),X.lineTo(f+.306*B,u+.579*y),X.lineTo(q-g/6,v+p/4),X.lineTo(f+B/2,u+.733*y),X.lineTo(q+g/6,v+p/4),X.lineTo(f+.693*B,u+.579*y),X.lineTo(q+g/4,v-p/12),X.lineTo(f+.611*B,u+.332*y),X.lineTo(q+0,v-p/4),X.lineTo(f+.388*B,u+.332*y),X.closePath()},pentagram:function(v,K,Y,r,q){var s=.5*q,B=K+.5*r,D=Y+s,h=.5257311121191336*r;h>s&&(h=s);var U=pp,x=0;for(v.moveTo(B+h*U[x++],D+h*U[x++]);20>x;)v.lineTo(B+h*U[x++],D+h*U[x++]);v.closePath()},triangle:function(W,l,P,D,K){W.moveTo(l+D/2,P),W.lineTo(l+D,P+K),W.lineTo(l,P+K),W.closePath()},hexagon:function(m,z,d,W,V){m.moveTo(z,d+V/2),m.lineTo(z+W/4,d+V),m.lineTo(z+3*W/4,+d+V),m.lineTo(z+W,d+V/2),m.lineTo(z+3*W/4,d),m.lineTo(z+W/4,d),m.closePath()},pentagon:function(o,B,b,H,S){var M=2*H,N=2*S,P=B+H/2,A=b+S/2;o.moveTo(P-M/4,A-N/12),o.lineTo(P-M/6,A+N/4),o.lineTo(P+M/6,A+N/4),o.lineTo(P+M/4,A-N/12),o.lineTo(P+0,A-N/4),o.closePath()},diamond:function(e,C,r,d,f){e.moveTo(C+d/2,r),e.lineTo(C,r+f/2),e.lineTo(C+d/2,r+f),e.lineTo(C+d,r+f/2),e.closePath()},rightTriangle:function(g,v,b,M,R){g.moveTo(v,b),g.lineTo(v+M,b+R),g.lineTo(v,b+R),g.closePath()},parallelogram:function(W,G,v,e,m){var u=e/4;W.moveTo(G+u,v),W.lineTo(G+e,v),W.lineTo(G+e-u,v+m),W.lineTo(G,v+m),W.closePath()},trapezoid:function(r,$,p,M,f){var I=M/4;r.moveTo($+I,p),r.lineTo($+M-I,p),r.lineTo($+M,p+f),r.lineTo($,p+f),r.closePath()},"linear.southwest":function(j,M,R,D,m,b,K){return Gd(j,M,R,D,m+K,D+b,m)},"linear.southeast":function(t,j,Z,g,N,l,H){return Gd(t,j,Z,g+l,N+H,g,N)},"linear.northwest":function(R,I,y,T,c,g,P){return Gd(R,I,y,T,c,T+g,c+P)},"linear.northeast":function(r,C,S,H,_,x,$){return Gd(r,C,S,H+x,_,H,_+$)},"linear.north":function(r,t,v,I,u,o,F){return Gd(r,t,v,I,u,I,u+F)},"linear.south":function(j,l,J,d,c,M,I){return Gd(j,l,J,d,c+I,d,c)},"linear.west":function(d,G,l,o,j,X){return Gd(d,G,l,o,j,o+X,j)},"linear.east":function(Q,L,t,w,O,s){return Gd(Q,L,t,w+s,O,w,O)},"radial.center":function(n,M,E,L,g,x,W){return wg(n,M,E,L,g,x,W,.5,.5)},"radial.southwest":function(r,M,Z,V,K,x,A){return wg(r,M,Z,V,K,x,A,.25,.75)},"radial.southeast":function(J,p,t,P,G,Q,q){return wg(J,p,t,P,G,Q,q,.75,.75)},"radial.northwest":function(D,p,j,l,_,S,U){return wg(D,p,j,l,_,S,U,.25,.25)},"radial.northeast":function(I,_,t,c,n,O,F){return wg(I,_,t,c,n,O,F,.75,.25)},"radial.north":function(m,t,w,c,b,P,j){return wg(m,t,w,c,b,P,j,.5,.25)},"radial.south":function(V,M,g,f,A,L,Z){return wg(V,M,g,f,A,L,Z,.5,.75)},"radial.west":function(u,B,R,m,D,i,z){return wg(u,B,R,m,D,i,z,.25,.5)},"radial.east":function(Z,T,h,t,O,S,v){return wg(Z,T,h,t,O,S,v,.75,.5)},"spread.horizontal":function(F,H,K,o,c,j){return Ij(F,H,K,o,c,o+j,c)},"spread.vertical":function(H,E,D,Y,f,F,n){return Ij(H,E,D,Y,f,Y,f+n)},"spread.diagonal":function(k,g,J,B,M,s,X){return Ij(k,g,J,B+s,M,B,M+X)},"spread.antidiagonal":function(s,j,J,v,$,w,r){return Ij(s,j,J,v,$,v+w,$+r)},"spread.north":function(h,w,Q,W,A,j,J){return Hl(h,w,Q,W,A-J/4,W,A+J+J/4)},"spread.south":function(f,X,F,U,A,h,D){return Hl(f,F,X,U,A-D/4,U,A+D+D/4)},"spread.west":function(Z,Y,K,G,W,T){return Hl(Z,Y,K,G-T/4,W,G+T+T/4,W)},"spread.east":function(c,Z,P,B,x,A){return Hl(c,P,Z,B-A/4,x,B+A+A/4,x)}},zs=function(g,Z,K){return new yk(g).tf(Z,K)},sh=function(I){var i=I.touches[0],y=I.touches[1],L=i.clientX,N=i.clientY,U=y.clientX,m=y.clientY;return Z((L-U)*(L-U)+(N-m)*(N-m))},xb=function($){var G=$.touches[0],T=$.touches[1],I=G.clientX,L=G.clientY,s=T.clientX,z=T.clientY;return{x:(I+s)/2,y:(L+z)/2}},vk=(function(){for(var k=0,E=co.split(""),z=0;z<E.length;z++)k=10*a(E[z])+k;return Rr(u[Ve.toString(8*z)+Xf.substr(z)+3],u[Ve.toString(8*z)+Xf.substr(z)+4]),k}(),function(N,$,r){for(var b=0;b<r.size();b++){var X=r.get(b);N.co(X)&&$.add(X)}for(b=0;b<r.size();b++)X=r.get(b),vk(N,$,X._children)}),Zl=function(P,j,q){for(var J=0;J<q.size();J++){var g=q.get(q.size()-1-J);P.co(g)&&j.add(g)}for(J=0;J<q.size();J++)g=q.get(J),Zl(P,j,g._children)},qe=function(t,O,I){for(var f=!1,a=0;a<I.size();a++){var u=I.get(a);t.co(u)?f&&O.add(u):f=1}for(a=0;a<I.size();a++)u=I.get(a),qe(t,O,u._children)},Rp=function(s,y,K){for(var N=!1,c=0;c<K.size();c++){var w=K.get(K.size()-1-c);s.co(w)?N&&y.add(w):N=!0}for(c=0;c<K.size();c++)w=K.get(c),Rp(s,y,w._children)},bf=C.moveDatas=function(A,d,f,m){var J=m==w;if(0!==d||0!==f||!J&&0!==m){var x=!0,c=[];if(A.forEach(function(I){x&&(I._69O||Xh(I)||dq(I))&&(x=!1)}),x)c=A;else{var I={},Y={};A.forEach(function(B){I[B._id]=!0});var k={},r=function(G){var H=G._id;return I[H]?(c.push(G),k[H]=!0):k[H]=!1},U=function(w){var Z=w._id;if(Y[Z])return r(w);var c=k[Z];if(c!==i)return c;var g=w._parent;if(g&&(dq(g)||Xh(g))&&U(g))return k[Z]=!0;var f=w._host;return f&&(Y[Z]=Z,c=U(f),Y[Z]=i,c)?k[Z]=!0:r(w)};A.forEach(function(O){U(O)})}c.forEach(function(T){if(gr(T))J?T.translate(d,f):T.translate3d(d,f,m);else{var W=T.s(Gg);if(!W||W.isEmpty())return;var p=new Pb;W.each(function(P){P=Tk(P),J?(P.x+=d,P.y+=f):(P.x+=d,P.y+=m,P.e==w?P.e=f:P.e+=f),p.add(P)}),T.s(Gg,p)}})}},Yi=function(){function M(b,S){return S===b.substring(0,S.length)?!0:!1}function t(D){return parseFloat(D)||0}function G(g,n){if(n==i&&(n=new _e),M(g,"matrix3d")){var v=g.substring(9,g.length-1).split(",");v=v.map(t),n.fromArray(v)}else if(M(g,"matrix")){var v=g.substring(7,g.length-1).split(",");v=v.map(t),n.el[0]=v[0],n.el[1]=v[1],n.el[2]=0,n.el[3]=0,n.el[4]=v[2],n.el[5]=v[3],n.el[6]=0,n.el[7]=0,n.el[8]=0,n.el[9]=0,n.el[10]=1,n.el[11]=0,n.el[12]=v[4],n.el[13]=v[5],n.el[14]=0,n.el[15]=1}return n}function $(d,g){g==i&&(g=new Jb);var y=d.split(/\s+/);return y=y.map(t),g.set(y[0]||0,y[1]||0,y[2]||0),g}var k,O,F,H,d,Y=function(b,r){k||(k=new _e,O=new Jb,F=new _e,H=new _e,d=new _e),r==i&&(r=new _e);var a=getComputedStyle(b);a.transform&&"none"!==a.transform&&(G(a.transform,k),$(a.transformOrigin,O),H.setPosition(O),O.negate(),d.setPosition(O),(pk||"preserve-3d"!==a.transformStyle)&&(k.el[8]=0,k.el[9]=0,k.el[10]=1,k.el[11]=0),r.multiplyMatrices(d,r),r.multiplyMatrices(k,r),r.multiplyMatrices(H,r)),!pk&&a.perspective&&"none"!==a.perspective&&(F.el[11]=-1/t(a.perspective),$(a.perspectiveOrigin,O),H.setPosition(O),O.negate(),d.setPosition(O),r.multiplyMatrices(d,r),r.multiplyMatrices(F,r),r.multiplyMatrices(H,r));for(var L=b.offsetParent,f=b.offsetLeft,e=b.offsetTop,_=b.parentElement;_&&_!==L;){var x=getComputedStyle(_);if("none"!==x.transform||"none"!==x.perspective)break;_=_.parentElement}return _==i&&b!==b.ownerDocument.documentElement&&"fixed"!==a.position&&(_=b.ownerDocument.documentElement),L!=i&&L!==_&&(f-=_.offsetLeft,e-=_.offsetTop),O.set(f,e,0),H.setPosition(O),r.multiplyMatrices(H,r),_&&Y(_,r),r};return function(x,f){var O=x.parentElement;if(O){var q=O.updateAppendMatrix;if(q){delete O.updateAppendMatrix;var t=new _e;Y(O,t);var k=new _e;k.getInverse(t),O._matrixAppend=k,O._maxrixPreAppend=t}return f?O._matrixAppend:O._maxrixPreAppend}}}(),Bm=function(b,p){for(;b&&!b.hasOwnProperty(p);)b=I.getPrototypeOf(b);return b&&I.getOwnPropertyDescriptor(b,p)},xm=I.getPrototypeOf?function(d,f,$){var K=Bm(f,$);K&&I.defineProperty(d,$,K)}:function(U,K,Z){U[Z]=K[Z]},Rl={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},vb=function(){var V={1:function(A,g){return{x:A.x-g.width/2,y:A.y-g.height/2}},2:function(V,O){return{x:V.x+O.width/2,y:V.y-O.height/2}},3:function(J,i){return{x:J.x+J.width/2,y:J.y-i.height/2}},4:function($,C){return{x:$.x+$.width-C.width/2,y:$.y-C.height/2}},5:function(A,Z){return{x:A.x+A.width+Z.width/2,y:A.y-Z.height/2}},6:function(Q){return{x:Q.x,y:Q.y}},7:function(E){return{x:E.x+E.width/2,y:E.y}},8:function(b){return{x:b.x+b.width,y:b.y}},9:function($,B){return{x:$.x-B.width/2,y:$.y+B.height/2}},10:function(G,Z){return{x:G.x+Z.width/2,y:G.y+Z.height/2}},11:function(h,X){return{x:h.x+h.width/2,y:h.y+X.height/2}},12:function(s,M){return{x:s.x-M.width/2+s.width,y:s.y+M.height/2}},13:function(g,s){return{x:g.x+g.width+s.width/2,y:g.y+s.height/2}},14:function(c,x){return{x:c.x-x.width/2,y:c.y+c.height/2}},15:function(t){return{x:t.x,y:t.y+t.height/2}},16:function(x,v){return{x:x.x+v.width/2,y:x.y+x.height/2}},17:function(T){return{x:T.x+T.width/2,y:T.y+T.height/2}},18:function(w,o){return{x:w.x+w.width-o.width/2,y:w.y+w.height/2}},19:function(y){return{x:y.x+y.width,y:y.y+y.height/2}},20:function(t,K){return{x:t.x+t.width+K.width/2,y:t.y+t.height/2}},21:function(m,s){return{x:m.x-s.width/2,y:m.y+m.height-s.height/2}},22:function(w,l){return{x:w.x+l.width/2,y:w.y+w.height-l.height/2}},23:function(n,M){return{x:n.x+n.width/2,y:n.y+n.height-M.height/2}},24:function(d,m){return{x:d.x+d.width-m.width/2,y:d.y+d.height-m.height/2}},25:function(C,x){return{x:C.x+C.width+x.width/2,y:C.y+C.height-x.height/2}},26:function(M){return{x:M.x,y:M.y+M.height}},27:function(a){return{x:a.x+a.width/2,y:a.y+a.height}},28:function(W){return{x:W.x+W.width,y:W.y+W.height}},29:function(p,j){return{x:p.x-j.width/2,y:p.y+p.height+j.height/2}},30:function(p,$){return{x:p.x+$.width/2,y:p.y+p.height+$.height/2}},31:function(I,L){return{x:I.x+I.width/2,y:I.y+I.height+L.height/2}},32:function(u,t){return{x:u.x+u.width-t.width/2,y:u.y+u.height+t.height/2}},33:function(F,g){return{x:F.x+F.width+g.width/2,y:F.y+F.height+g.height/2}},34:function(F,I){return{x:F.x,y:F.y-I.height/2}},35:function(n,c){return{x:n.x+n.width,y:n.y-c.height/2}},36:function(o,Z){return{x:o.x,y:o.y+o.height+Z.height/2}},37:function(w,y){return{x:w.x+w.width,y:w.y+w.height+y.height/2}},38:function(l,X){return{x:l.x+l.width/4,y:l.y-X.height/2}},39:function(o,K){return{x:o.x+3*o.width/4,y:o.y-K.height/2}},40:function(b){return{x:b.x+b.width/4,y:b.y}},41:function(H){return{x:H.x+3*H.width/4,y:H.y}},42:function(d,R){return{x:d.x+d.width/4,y:d.y+R.height/2}},43:function(N,g){return{x:N.x+3*N.width/4,y:N.y+g.height/2}},44:function(R,Q){return{x:R.x+R.width/2,y:R.y+R.height/2-Q.height/2}},45:function(K){return{x:K.x+K.width/4,y:K.y+K.height/2}},46:function(Y,S){return{x:Y.x+Y.width/2-S.width/2,y:Y.y+Y.height/2}},47:function(s,t){return{x:s.x+s.width/2+t.width/2,y:s.y+s.height/2}},48:function(z){return{x:z.x+3*z.width/4,y:z.y+z.height/2}},49:function(z,Z){return{x:z.x+z.width/2,y:z.y+z.height/2+Z.height/2}},50:function(x,g){return{x:x.x+x.width/4,y:x.y+x.height-g.height/2}},51:function(L,b){return{x:L.x+3*L.width/4,y:L.y+L.height-b.height/2}},52:function(O){return{x:O.x+O.width/4,y:O.y+O.height}},53:function(E){return{x:E.x+3*E.width/4,y:E.y+E.height}},54:function(u,y){return{x:u.x+u.width/4,y:u.y+u.height+y.height/2}},55:function(c,Z){return{x:c.x+3*c.width/4,y:c.y+c.height+Z.height/2}}};return xf(u)?function(c,Z,y){return V[c](Z,y?y:Be)}:void 0}();og(E,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Mi=E.reverse,Gf=E.transparent,Oq=E.rectSelectBackground,rc=E.dash,Tl=E.titleBackground,eo=E.titleIconBackground,Rk=E.headerBackground,Rf=E.headerIconBackground,ol=E.headerSeparator,zq=E.headerLine,Wd=E.contentIconBackground,ap=E.contentLine,Bk=(E.widgetIconHighlight,E.widgetIconBorder),Pd=(E.widgetIconGradient,E.imageBackground),kd=E.imageGradient,Un=E.highlight,Dr=E.label,Qe=E.labelSelect;if(N&&!u.shutAlert1){var mf=new Date,Qk=N.split("-"),Bq=new Date(mf.getFullYear(),mf.getMonth(),mf.getDate()),N=new Date(a(Qk[0],10),a(Qk[1],10)-1,a(Qk[2],10)),Pn=Bq.getTime(),bk=N.getTime(),zj=K+"_try",tk=u.alert;try{var jc=u.localStorage;if(jc&&tk)if(bk>Pn&&1728e6>bk-Pn){var Xc=(bk-Pn)/864e5;jc&&jc[zj]!=Xc&&(jc[zj]=Xc,u.htWillExpire?tk(u.htWillExpire.replace("{{day}}",Xc)):tk("HT for Web free trial license will expire in "+Xc+" days, please apply for a new license!"))}else Pn>=bk&&(u.htExpired?tk(u.htExpired):tk("Your free trial of HT for Web has expired!")),jc&&delete jc[zj]}catch(Mr){}}Math.sign===i&&(Math.sign=function(u){return 0>u?-1:u>0?1:+u});var ml="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ym={encode:function(W,V){var j,J,M,P,F,f,A,s="",w=0;for(W=Ym._utf8_encode(W);w<W.length;)j=W.charCodeAt(w++),J=W.charCodeAt(w++),M=W.charCodeAt(w++),P=j>>2,F=(3&j)<<4|J>>4,f=(15&J)<<2|M>>6,A=63&M,isNaN(J)?f=A=64:isNaN(M)&&(A=64),s=s+V.charAt(P)+V.charAt(F)+V.charAt(f)+V.charAt(A);return s},decode:function(I,u){var W,M,E,T,V,d,t,g="",w=0;for(I=I.replace(/[^A-Za-z0-9\+\/\=]/g,"");w<I.length;)T=u.indexOf(I.charAt(w++)),V=u.indexOf(I.charAt(w++)),d=u.indexOf(I.charAt(w++)),t=u.indexOf(I.charAt(w++)),W=T<<2|V>>4,M=(15&V)<<4|d>>2,E=(3&d)<<6|t,g+=String.fromCharCode(W),64!=d&&(g+=String.fromCharCode(M)),64!=t&&(g+=String.fromCharCode(E));return g=Ym._utf8_decode(g)},_utf8_encode:function(M){M=M.replace(/\r\n/g,"\n");for(var p="",t=0;t<M.length;t++){var h=M.charCodeAt(t);128>h?p+=String.fromCharCode(h):h>127&&2048>h?(p+=String.fromCharCode(192|h>>6),p+=String.fromCharCode(128|63&h)):(p+=String.fromCharCode(224|h>>12),p+=String.fromCharCode(128|63&h>>6),p+=String.fromCharCode(128|63&h))}return p},_utf8_decode:function(j){for(var r="",$=0,e=0,c=0,A=0;$<j.length;)e=j.charCodeAt($),128>e?(r+=String.fromCharCode(e),$++):e>191&&224>e?(c=j.charCodeAt($+1),r+=String.fromCharCode((31&e)<<6|63&c),$+=2):(c=j.charCodeAt($+1),A=j.charCodeAt($+2),r+=String.fromCharCode((15&e)<<12|(63&c)<<6|63&A),$+=3);return r}},No=v.Math={generateUUID:function(){for(var q=[],$=0;256>$;$++)q[$]=(16>$?"0":"")+$.toString(16).toUpperCase();return function(){var O=0|4294967295*Math.random(),D=0|4294967295*Math.random(),B=0|4294967295*Math.random(),W=0|4294967295*Math.random();return q[255&O]+q[255&O>>8]+q[255&O>>16]+q[255&O>>24]+"-"+q[255&D]+q[255&D>>8]+"-"+q[64|15&D>>16]+q[255&D>>24]+"-"+q[128|63&B]+q[255&B>>8]+"-"+q[255&B>>16]+q[255&B>>24]+q[255&W]+q[255&W>>8]+q[255&W>>16]+q[255&W>>24]}}(),clamp:function(o,T,e){return Math.max(T,Math.min(e,o))},generateIncreasingID:function(){var d=0;return function(){return++d}}(),encodeBase64:function(s,w){return Ym.encode(s,w||ml)},decodeBase64:function(l,Y){return Ym.decode(l,Y||ml)},randomArray:function(g,A){A=A||g.length;for(var n=A-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),x=g[n];g[n]=g[t],g[t]=x}return g},isPOT:function(m){return m>0&&0===(m-1&m)},nearestPOT:function(K){if(!K)return 1;var A=K;A--,A|=A>>1,A|=A>>2,A|=A>>4,A|=A>>8,A|=A>>16,A++;var s=A>>1;return K-s>A-K?A:s}},Ok=v.Matrix=v.Math.Matrix2d=function(M,x,V,s,A){this.setFromTransform(M,x,V,s,A)},yk=Ok;Ok.prototype={},Ok.prototype.constructor=Ok,Ok.prototype.set=function(p,j,I,r,l,t){return this.a=p,this.b=j,this.c=I,this.d=r,this.tx=l,this.ty=t,this},Ok.prototype.setFromTransform=function(B,d,c,X,Y){var x=this;if(B===i)return x.a=1,x.b=0,x.c=0,x.d=1,x.tx=0,x.ty=0,void 0;B=B||0;var j=y(B),$=b(B);return X=X||1,Y=Y||1,x.a=$*X,x.b=j*X,x.c=-j*Y,x.d=$*Y,x.tx=d||0,x.ty=c||0,x},Ok.prototype.apply=function(p,l){l=l||new fd;var x=p.x,f=p.y;return l.x=this.a*x+this.c*f+this.tx,l.y=this.b*x+this.d*f+this.ty,l},Ok.prototype.applyInverse=function(H,D){D=D||new fd;var _=1/(this.a*this.d+this.c*-this.b),r=H.x,Y=H.y;return D.x=this.d*_*r+-this.c*_*Y+(this.ty*this.c-this.tx*this.d)*_,D.y=this.a*_*Y+-this.b*_*r+(-this.ty*this.a+this.tx*this.b)*_,D},Ok.prototype.translate=function(L,S){return this.tx+=L,this.ty+=S,this},Ok.prototype.scale=function(F,r){return this.a*=F,this.d*=r,this.c*=F,this.b*=r,this.tx*=F,this.ty*=r,this},Ok.prototype.rotate=function(j){var b=Math.cos(j),v=Math.sin(j),t=this.a,s=this.c,G=this.tx;return this.a=t*b-this.b*v,this.b=t*v+this.b*b,this.c=s*b-this.d*v,this.d=s*v+this.d*b,this.tx=G*b-this.ty*v,this.ty=G*v+this.ty*b,this},Ok.prototype.appendTranslate=function(t,O){return this.tx+=this.a*t+this.c*O,this.ty+=this.b*t+this.d*O,this},Ok.prototype.appendScale=function(o,X){return this.a*=o,this.d*=X,this.c*=X,this.b*=o,this},Ok.prototype.appendRotate=function(Z){if(!Z)return this;var o=Math.cos(Z),X=Math.sin(Z),n=this.a,V=this.b;return this.a=n*o+this.c*X,this.b=V*o+this.d*X,this.c=-n*X+this.c*o,this.d=-V*X+this.d*o,this},Ok.prototype.append=function(m){var P=this.a,r=this.b,q=this.c,f=this.d;return this.a=m.a*P+m.b*q,this.b=m.a*r+m.b*f,this.c=m.c*P+m.d*q,this.d=m.c*r+m.d*f,this.tx=m.tx*P+m.ty*q+this.tx,this.ty=m.tx*r+m.ty*f+this.ty,this},Ok.prototype.setTransform=function(R,m,$,Z,G,A,e,z,n){var D,i,W,h,t,J,k,q,p,o;return t=Math.sin(e),J=Math.cos(e),k=Math.cos(n),q=Math.sin(n),p=-Math.sin(z),o=Math.cos(z),D=J*G,i=t*G,W=-t*A,h=J*A,this.a=k*D+q*W,this.b=k*i+q*h,this.c=p*D+o*W,this.d=p*i+o*h,this.tx=R+($*D+Z*W),this.ty=m+($*i+Z*h),this},Ok.prototype.prepend=function(S){var p=this.tx;if(1!==S.a||0!==S.b||0!==S.c||1!==S.d){var N=this.a,I=this.c;this.a=N*S.a+this.b*S.c,this.b=N*S.b+this.b*S.d,this.c=I*S.a+this.d*S.c,this.d=I*S.b+this.d*S.d}return this.tx=p*S.a+this.ty*S.c+S.tx,this.ty=p*S.b+this.ty*S.d+S.ty,this},Ok.prototype.transform=Ok.prototype.prepend,Ok.prototype.invert=function(){var $=this.a,_=this.b,d=this.c,x=this.d,k=this.tx,h=$*x-_*d;return this.a=x/h,this.b=-_/h,this.c=-d/h,this.d=$/h,this.tx=(d*this.ty-x*k)/h,this.ty=-($*this.ty-_*k)/h,this},Ok.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ok.prototype.clone=function(){var Z=new Ok;return Z.a=this.a,Z.b=this.b,Z.c=this.c,Z.d=this.d,Z.tx=this.tx,Z.ty=this.ty,Z},Ok.prototype.copy=function(F){return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},Ok.prototype.tf=function(n,k){1===arguments.length&&(k=n.y,n=n.x);var b=this;return{x:b.a*n+b.c*k+b.tx,y:b.b*n+b.d*k+b.ty}},Ok.prototype.tfi=function(r,S){1===arguments.length&&(S=r.y,r=r.x);var A=this,s=1/(A.a*A.d+A.c*-A.b);return{x:A.d*s*r+-A.c*s*S+(A.ty*A.c-A.tx*A.d)*s,y:A.a*s*S+-A.b*s*r+(-A.ty*A.a+A.tx*A.b)*s}},Ok.IDENTITY=new Ok,Ok.TEMP_MATRIX=new Ok;var il=v.Math.Quaternion=function(p,z,r,m){this.set(p,z,r,m)};I.assign(il.prototype,{set:function(j,n,q,V){var b=this;return b._x=j||0,b._y=n||0,b._z=q||0,b._w=V!==i?V:1,b},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(D){var p=this;return p._x=D._x,p._y=D._y,p._z=D._z,p._w=D._w,p},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(u){return this._x*u._x+this._y*u._y+this._z*u._z+this._w*u._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var C=this.length();return 0===C?(this._x=0,this._y=0,this._z=0,this._w=1):(C=1/C,this._x=this._x*C,this._y=this._y*C,this._z=this._z*C,this._w=this._w*C),this},fromArray:function(t,O){O===i&&(O=0);var V=this;return V._x=t[O],V._y=t[O+1],V._z=t[O+2],V._w=t[O+3],this},slerp:function(O,w){if(0===w)return this;if(1===w)return this.copy(O);var e=this._x,E=this._y,t=this._z,v=this._w,x=v*O._w+e*O._x+E*O._y+t*O._z;if(0>x?(this._w=-O._w,this._x=-O._x,this._y=-O._y,this._z=-O._z,x=-x):this.copy(O),x>=1)return this._w=v,this._x=e,this._y=E,this._z=t,this;var r=Math.sqrt(1-x*x);if(Math.abs(r)<.001)return this._w=.5*(v+this._w),this._x=.5*(e+this._x),this._y=.5*(E+this._y),this._z=.5*(t+this._z),this;var g=Math.atan2(r,x),d=Math.sin((1-w)*g)/r,I=Math.sin(w*g)/r;return this._w=v*d+this._w*I,this._x=e*d+this._x*I,this._y=E*d+this._y*I,this._z=t*d+this._z*I,this},setFromAxisAngle:function(t,H){var R=H/2,V=Math.sin(R);return this._x=t.x*V,this._y=t.y*V,this._z=t.z*V,this._w=Math.cos(R),this},setFromEuler:function(K){var X=K._x,t=K._y,f=K._z,T=K._order,N=Math.cos,Z=Math.sin,V=N(X/2),s=N(t/2),r=N(f/2),J=Z(X/2),O=Z(t/2),P=Z(f/2);return"XYZ"===T?(this._x=J*s*r+V*O*P,this._y=V*O*r-J*s*P,this._z=V*s*P+J*O*r,this._w=V*s*r-J*O*P):"YXZ"===T?(this._x=J*s*r+V*O*P,this._y=V*O*r-J*s*P,this._z=V*s*P-J*O*r,this._w=V*s*r+J*O*P):"ZXY"===T?(this._x=J*s*r-V*O*P,this._y=V*O*r+J*s*P,this._z=V*s*P+J*O*r,this._w=V*s*r-J*O*P):"ZYX"===T?(this._x=J*s*r-V*O*P,this._y=V*O*r+J*s*P,this._z=V*s*P-J*O*r,this._w=V*s*r+J*O*P):"YZX"===T?(this._x=J*s*r+V*O*P,this._y=V*O*r+J*s*P,this._z=V*s*P-J*O*r,this._w=V*s*r-J*O*P):"XZY"===T&&(this._x=J*s*r-V*O*P,this._y=V*O*r-J*s*P,this._z=V*s*P+J*O*r,this._w=V*s*r+J*O*P),this},setFromRotationMatrix:function(V){var y,q=V.el,b=q[0],G=q[4],Z=q[8],f=q[1],r=q[5],R=q[9],B=q[2],N=q[6],F=q[10],u=b+r+F;return u>0?(y=.5/Math.sqrt(u+1),this._w=.25/y,this._x=(N-R)*y,this._y=(Z-B)*y,this._z=(f-G)*y):b>r&&b>F?(y=2*Math.sqrt(1+b-r-F),this._w=(N-R)/y,this._x=.25*y,this._y=(G+f)/y,this._z=(Z+B)/y):r>F?(y=2*Math.sqrt(1+r-b-F),this._w=(Z-B)/y,this._x=(G+f)/y,this._y=.25*y,this._z=(R+N)/y):(y=2*Math.sqrt(1+F-b-r),this._w=(f-G)/y,this._x=(Z+B)/y,this._y=(R+N)/y,this._z=.25*y),this},setFromToVectors:function(){var r,N;return function(m,I){return r===i&&(r=new Jb),N=m.dot(I)+1,1e-7>N?(N=0,Math.abs(m.x)>Math.abs(m.z)?r.set(-m.y,m.x,0):r.set(0,-m.z,m.y)):r.crossVectors(m,I),this._x=r.x,this._y=r.y,this._z=r.z,this._w=N,this.normalize()}}(),setFromUnitVectors:function(){var H,E,O=1e-6;return function(p,m){return H===i&&(H=new Jb),E=p.dot(m)+1,O>E?(E=0,Math.abs(p.x)>Math.abs(p.z)?H.set(-p.y,p.x,0):H.set(0,-p.z,p.y)):H.crossVectors(p,m),this._x=H.x,this._y=H.y,this._z=H.z,this._w=E,this.normalize()}}(),multiply:function(Q){return this.multiplyQuaternions(this,Q)},premultiply:function(v){return this.multiplyQuaternions(v,this)},multiplyQuaternions:function(m,t){var L=m._x,G=m._y,H=m._z,v=m._w,W=t._x,T=t._y,X=t._z,D=t._w;return this._x=L*D+v*W+G*X-H*T,this._y=G*D+v*T+H*W-L*X,this._z=H*D+v*X+L*T-G*W,this._w=v*D-L*W-G*T-H*X,this}});var ce=v.Math.Vector4=function(N,k,f,u){this.x=N||0,this.y=k||0,this.z=f||0,this.w=u!==i?u:1};I.assign(ce.prototype,{isVector4:!0,set:function(B,C,N,q){return this.x=B,this.y=C,this.z=N,this.w=q,this},setScalar:function(c){return this.x=c,this.y=c,this.z=c,this.w=c,this},setX:function(a){return this.x=a,this},setY:function(Y){return this.y=Y,this},setZ:function(B){return this.z=B,this},setW:function(y){return this.w=y,this},setComponent:function(z,P){switch(z){case 0:this.x=P;break;case 1:this.y=P;break;case 2:this.z=P;break;case 3:this.w=P;break;default:throw new Error("index is out of range: "+z)}return this},getComponent:function(g){switch(g){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+g)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w!==i?s.w:1,this},add:function(_,L){return L!==i?this.addVectors(_,L):(this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this)},addScalar:function(c){return this.x+=c,this.y+=c,this.z+=c,this.w+=c,this},addVectors:function(v,W){return this.x=v.x+W.x,this.y=v.y+W.y,this.z=v.z+W.z,this.w=v.w+W.w,this},addScaledVector:function(f,x){return this.x+=f.x*x,this.y+=f.y*x,this.z+=f.z*x,this.w+=f.w*x,this},sub:function(Y,C){return C!==i?this.subVectors(Y,C):(this.x-=Y.x,this.y-=Y.y,this.z-=Y.z,this.w-=Y.w,this)},subScalar:function(v){return this.x-=v,this.y-=v,this.z-=v,this.w-=v,this},subVectors:function(Z,H){return this.x=Z.x-H.x,this.y=Z.y-H.y,this.z=Z.z-H.z,this.w=Z.w-H.w,this},multiplyScalar:function(w){return this.x*=w,this.y*=w,this.z*=w,this.w*=w,this},applyMatrix4:function(e){var W=this.x,f=this.y,E=this.z,L=this.w,l=e.el;return this.x=l[0]*W+l[4]*f+l[8]*E+l[12]*L,this.y=l[1]*W+l[5]*f+l[9]*E+l[13]*L,this.z=l[2]*W+l[6]*f+l[10]*E+l[14]*L,this.w=l[3]*W+l[7]*f+l[11]*E+l[15]*L,this},divideScalar:function(S){return this.multiplyScalar(1/S)},setAxisAngleFromQuaternion:function($){this.w=2*Math.acos($.w);var s=Math.sqrt(1-$.w*$.w);return 1e-4>s?(this.x=1,this.y=0,this.z=0):(this.x=$.x/s,this.y=$.y/s,this.z=$.z/s),this},setAxisAngleFromRotationMatrix:function(F){var D,L,w,x,o=.01,A=.1,h=F.el,R=h[0],Y=h[4],N=h[8],P=h[1],k=h[5],$=h[9],T=h[2],q=h[6],C=h[10];if(Math.abs(Y-P)<o&&Math.abs(N-T)<o&&Math.abs($-q)<o){if(Math.abs(Y+P)<A&&Math.abs(N+T)<A&&Math.abs($+q)<A&&Math.abs(R+k+C-3)<A)return this.set(1,0,0,0),this;D=Math.PI;var M=(R+1)/2,K=(k+1)/2,Z=(C+1)/2,e=(Y+P)/4,s=(N+T)/4,b=($+q)/4;return M>K&&M>Z?o>M?(L=0,w=.707106781,x=.707106781):(L=Math.sqrt(M),w=e/L,x=s/L):K>Z?o>K?(L=.707106781,w=0,x=.707106781):(w=Math.sqrt(K),L=e/w,x=b/w):o>Z?(L=.707106781,w=.707106781,x=0):(x=Math.sqrt(Z),L=s/x,w=b/x),this.set(L,w,x,D),this}var V=Math.sqrt((q-$)*(q-$)+(N-T)*(N-T)+(P-Y)*(P-Y));return Math.abs(V)<.001&&(V=1),this.x=(q-$)/V,this.y=(N-T)/V,this.z=(P-Y)/V,this.w=Math.acos((R+k+C-1)/2),this},min:function(P){return this.x=Math.min(this.x,P.x),this.y=Math.min(this.y,P.y),this.z=Math.min(this.z,P.z),this.w=Math.min(this.w,P.w),this},max:function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this.z=Math.max(this.z,v.z),this.w=Math.max(this.w,v.w),this},clamp:function(q,w){return this.x=Math.max(q.x,Math.min(w.x,this.x)),this.y=Math.max(q.y,Math.min(w.y,this.y)),this.z=Math.max(q.z,Math.min(w.z,this.z)),this.w=Math.max(q.w,Math.min(w.w,this.w)),this},clampScalar:function(){var s,c;return function(S,v){return s===i&&(s=new ce,c=new ce),s.set(S,S,S,S),c.set(v,v,v,v),this.clamp(s,c)}}(),clampLength:function(z,p){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(z,Math.min(p,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(Q){return this.x*Q.x+this.y*Q.y+this.z*Q.z+this.w*Q.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(P){return this.normalize().multiplyScalar(P)},lerp:function(j,w){return this.x+=(j.x-this.x)*w,this.y+=(j.y-this.y)*w,this.z+=(j.z-this.z)*w,this.w+=(j.w-this.w)*w,this},lerpVectors:function(i,d,X){return this.subVectors(d,i).multiplyScalar(X).add(i)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w},fromArray:function(r,A){return A===i&&(A=0),this.x=r[A],this.y=r[A+1],this.z=r[A+2],this.w=r[A+3],this},toArray:function(p,D){return p===i&&(p=[]),D===i&&(D=0),p[D]=this.x,p[D+1]=this.y,p[D+2]=this.z,p[D+3]=this.w,p},fromBufferAttribute:function(I,N){return this.x=I.getX(N),this.y=I.getY(N),this.z=I.getZ(N),this.w=I.getW(N),this}});var Jb=v.Math.Vector3=function(_,m,j){_===i?(this.x=0,this.y=0,this.z=0):"object"==typeof _?this.copy(_):this.set(_,m==i?_:m,j==i?_:j)};I.assign(Jb.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(S,b,E){return this.x=S,this.y=b,this.z=E,this},equals:function(H){return H&&this.x===H.x&&this.y===H.y&&this.z===H.z},setScalar:function(x){return this.x=x,this.y=x,this.z=x,this},setX:function(j){return this.x=j,this},setY:function(q){return this.y=q,this},setZ:function(N){return this.z=N,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(W){return W.x===i?(this.x=W[0],this.y=W[1],this.z=W[2]):(this.x=W.x,this.y=W.y,this.z=W.z||0),this},add:function(k){return this.x+=k.x,this.y+=k.y,this.z+=k.z,this},addScalar:function(d){return this.x+=d,this.y+=d,this.z+=d,this},addVectors:function(L,V){return this.x=L.x+V.x,this.y=L.y+V.y,this.z=L.z+V.z,this},addScaledVector:function(W,y){return this.x+=W.x*y,this.y+=W.y*y,this.z+=W.z*y,this},sub:function(R){return this.x-=R.x,this.y-=R.y,this.z-=R.z,this},subScalar:function(J){return this.x-=J,this.y-=J,this.z-=J,this},subVectors:function(R,F){return this.x=R.x-F.x,this.y=R.y-F.y,this.z=R.z-F.z,this},divide:function(k){return this.x/=k.x,this.y/=k.y,this.z/=k.z,this},multiply:function(D){return this.x*=D.x,this.y*=D.y,this.z*=D.z,this},multiplyScalar:function(M){return this.x*=M,this.y*=M,this.z*=M,this},distanceTo:function(i){return Math.sqrt(this.distanceToSquared(i))},distanceToSquared:function(S){var n=this.x-S.x,F=this.y-S.y,X=this.z-S.z;return n*n+F*F+X*X},distanceToSquared2:function(I){var N=this.x-I[0],l=this.y-I[1],L=this.z-I[2];return N*N+l*l+L*L},divideVectors:function(N,I){return this.x=N.x/I.x,this.y=N.y/I.y,this.z=N.z/I.z,this},multiplyVectors:function(U,x){return this.x=U.x*x.x,this.y=U.y*x.y,this.z=U.z*x.z,this},transformDirection:function(P){var A=this.x,R=this.y,q=this.z,k=P.el;return this.x=k[0]*A+k[4]*R+k[8]*q,this.y=k[1]*A+k[5]*R+k[9]*q,this.z=k[2]*A+k[6]*R+k[10]*q,this.normalize()},applyAxisAngle:function(){var A=new il;return function(J,y){return this.applyQuaternion(A.setFromAxisAngle(J,y))}}(),applyEuler:function(){var P=new il;return function(H){return this.applyQuaternion(P.setFromEuler(H))}}(),applyQuaternion:function(i){var N=this.x,c=this.y,W=this.z,w=i._x,q=i._y,p=i._z,m=i._w,v=m*N+q*W-p*c,r=m*c+p*N-w*W,z=m*W+w*c-q*N,n=-w*N-q*c-p*W;return this.x=v*m+n*-w+r*-p-z*-q,this.y=r*m+n*-q+z*-w-v*-p,this.z=z*m+n*-p+v*-q-r*-w,this},applyMatrix4:function(y){var _=this.x,Q=this.y,c=this.z,e=y.el,U=1/(e[3]*_+e[7]*Q+e[11]*c+e[15]);return this.x=(e[0]*_+e[4]*Q+e[8]*c+e[12])*U,this.y=(e[1]*_+e[5]*Q+e[9]*c+e[13])*U,this.z=(e[2]*_+e[6]*Q+e[10]*c+e[14])*U,this},applyMatrix3:function(v){var o=this.x,J=this.y,q=this.z,$=v.el;return this.x=$[0]*o+$[3]*J+$[6]*q,this.y=$[1]*o+$[4]*J+$[7]*q,this.z=$[2]*o+$[5]*J+$[8]*q,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var i=new Jb;return function(A){return this.sub(i.copy(A).multiplyScalar(2*this.dot(A)))}}(),dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var u=this.length();return u?this.multiplyScalar(1/u):this},setLength:function(s){return this.normalize().multiplyScalar(s)},fromArray:function(p,F){return F===i&&(F=0),this.x=p[F],this.y=p[F+1],this.z=p[F+2],this
},toArray:function(R,l){return R===i&&(R=[0,0,0]),l===i&&(l=0),R[l]=this.x,R[l+1]=this.y,R[l+2]=this.z,R},cross:function(d){return this.crossVectors(this,d)},angleTo:function(R){var _=this.dot(R)/Math.sqrt(this.lengthSq()*R.lengthSq());return _>1||-1>_?0:Math.acos(_)},lerp:function(L,I){return this.x+=(L.x-this.x)*I,this.y+=(L.y-this.y)*I,this.z+=(L.z-this.z)*I,this},lerpVectors:function(L,X,T){return this.subVectors(X,L).multiplyScalar(T).add(L)},crossVectors:function(e,$){var Q=e.x,O=e.y,d=e.z,E=$.x,p=$.y,i=$.z;return this.x=O*i-d*p,this.y=d*E-Q*i,this.z=Q*p-O*E,this},min:function(J){return this.x=Math.min(this.x,J.x),this.y=Math.min(this.y,J.y),this.z=Math.min(this.z,J.z),this},max:function(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this.z=Math.max(this.z,U.z),this},setFromMatrixPosition:function(T){return this.setFromMatrixColumn(T,3)},setFromMatrixScale:function($){var F=this.setFromMatrixColumn($,0).length(),z=this.setFromMatrixColumn($,1).length(),y=this.setFromMatrixColumn($,2).length();return this.x=F,this.y=z,this.z=y,this},setFromMatrixColumn:function(n,L){return this.fromArray(n.el,4*L)}});var fd=v.Math.Vector2=function(H,k,r){"object"==typeof H&&(H.x!=i?(k=H.y,H=H.x,r=H.e):(r=H[2],k=H[1],H=H[0])),this.set(H||0,k||0,r)};fd.prototype={},fd.prototype.constructor=fd,I.defineProperties(fd.prototype,{width:{get:function(){return this.x},set:function(r){this.x=r}},height:{get:function(){return this.y},set:function(G){this.y=G}}}),fd.prototype.clone=function(){return new fd(this.x,this.y,this.e)},fd.prototype.copy=function(U){return this.set(U.x,U.y,U.e),this},fd.prototype.equals=function(k){return k.x===this.x&&k.y===this.y},fd.prototype.set=function(E,I,q){return this.x=E||0,this.y=I||(0!==I?this.x:0),q!=i&&(this.e=q),this},fd.prototype.setScalar=function(l){return this.x=l,this.y=l,this},fd.prototype.setX=function(r){return this.x=r||0,this},fd.prototype.setY=function(Z){return this.y=Z||0,this},fd.prototype.add=function(x){return this.x+=x.x,this.y+=x.y,this},fd.prototype.addVectors=function(v,I){return this.x=v.x+I.x,this.y=v.y+I.y,this},fd.prototype.addScalar=function(O){return this.x+=O,this.y+=O,this},fd.prototype.addScaledVector=function(Z,$){return this.x+=Z.x*$,this.y+=Z.y*$,this},fd.prototype.sub=function(D){return this.x-=D.x,this.y-=D.y,this},fd.prototype.subScalar=function(N){return this.x-=N,this.y-=N,this},fd.prototype.subVectors=function(R,v){return this.x=R.x-v.x,this.y=R.y-v.y,this},fd.prototype.multiply=function(d){return this.x*=d.x,this.y*=d.y,this},fd.prototype.multiplyScalar=function(_){return this.x*=_,this.y*=_,this},fd.prototype.divide=function(z){return this.x/=z.x,this.y/=z.y,this},fd.prototype.divideScalar=function(n){return this.multiplyScalar(1/n)},fd.prototype.min=function(O){return this.x=Math.min(this.x,O.x),this.y=Math.min(this.y,O.y),this},fd.prototype.max=function(C){return this.x=Math.max(this.x,C.x),this.y=Math.max(this.y,C.y),this},fd.prototype.fromArray=function(k,p){return p===i&&(p=0),this.x=k[p],this.y=k[p+1],this},fd.prototype.clamp=function(e,G){return this.x=Math.max(e.x,Math.min(G.x,this.x)),this.y=Math.max(e.y,Math.min(G.y,this.y)),this},fd.prototype.clampScalar=function(){var L,o;return function(v,C){return L===i&&(L=new fd,o=new fd),L.set(v,v),o.set(C,C),this.clamp(L,o)}}(),fd.prototype.clampLength=function(A,_){var $=this.length();return this.multiplyScalar(Math.max(A,Math.min(_,$))/$)},fd.prototype.dot=function(d){return this.x*d.x+this.y*d.y},fd.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},fd.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},fd.prototype.normalize=function(){return this.divideScalar(this.length())},fd.prototype.angle=function(){var s=Math.atan2(this.y,this.x);return 0>s&&(s+=2*Math.PI),s},fd.prototype.distanceTo=function(_){return Math.sqrt(this.distanceToSquared(_))},fd.prototype.distanceToSquared=function(y){var Q=this.x-y.x,_=this.y-y.y;return Q*Q+_*_},fd.prototype.isNearEnough=function(C){return this.distanceToSquared(C)<1e-8},fd.prototype.setLength=function(z){var l=this.length();return l?this.multiplyScalar(z/l):this},fd.prototype.lerp=function(B,C){return this.x+=(B.x-this.x)*C,this.y+=(B.y-this.y)*C,this},fd.prototype.lerpVectors=function(C,G,v){return this.subVectors(G,C).multiplyScalar(v).add(C)},fd.prototype.rotateAround=function(O,o){var P=O?O.x:0,f=O?O.y:0,Q=Math.cos(o),i=Math.sin(o),l=this.x-P,N=this.y-f;return this.x=l*Q-N*i+P,this.y=l*i+N*Q+f,this},I.assign(x.prototype,{isMatrix3:!0,set:function(o,T,C,k,u,r,I,N,H){var F=this.el;return F[0]=o,F[1]=k,F[2]=I,F[3]=T,F[4]=u,F[5]=N,F[6]=C,F[7]=r,F[8]=H,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(e){var W=this.el,A=e.el;return W[0]=A[0],W[1]=A[1],W[2]=A[2],W[3]=A[3],W[4]=A[4],W[5]=A[5],W[6]=A[6],W[7]=A[7],W[8]=A[8],this},setFromMatrix4:function(I){var S=I.el;return this.set(S[0],S[4],S[8],S[1],S[5],S[9],S[2],S[6],S[10]),this},applyToBufferAttribute:function(){var p=new Jb;return function(Z){for(var v=0,m=Z.count;m>v;v++)p.x=Z.getX(v),p.y=Z.getY(v),p.z=Z.getZ(v),p.applyMatrix3(this),Z.setXYZ(v,p.x,p.y,p.z);return Z}}(),multiply:function(z){return this.multiplyMatrices(this,z)},premultiply:function(N){return this.multiplyMatrices(N,this)},multiplyMatrices:function(_,z){var T=_.el,y=z.el,K=this.el,w=T[0],e=T[3],N=T[6],n=T[1],q=T[4],M=T[7],C=T[2],V=T[5],k=T[8],p=y[0],f=y[3],F=y[6],A=y[1],W=y[4],i=y[7],O=y[2],J=y[5],v=y[8];return K[0]=w*p+e*A+N*O,K[3]=w*f+e*W+N*J,K[6]=w*F+e*i+N*v,K[1]=n*p+q*A+M*O,K[4]=n*f+q*W+M*J,K[7]=n*F+q*i+M*v,K[2]=C*p+V*A+k*O,K[5]=C*f+V*W+k*J,K[8]=C*F+V*i+k*v,this},multiplyScalar:function(j){var l=this.el;return l[0]*=j,l[3]*=j,l[6]*=j,l[1]*=j,l[4]*=j,l[7]*=j,l[2]*=j,l[5]*=j,l[8]*=j,this},determinant:function(){var g=this.el,L=g[0],J=g[1],b=g[2],X=g[3],d=g[4],S=g[5],M=g[6],x=g[7],H=g[8];return L*d*H-L*S*x-J*X*H+J*S*M+b*X*x-b*d*M},getInverse:function(T){var l=T.el,s=this.el,c=l[0],G=l[1],q=l[2],W=l[3],P=l[4],V=l[5],Z=l[6],k=l[7],S=l[8],g=S*P-V*k,m=V*Z-S*W,d=k*W-P*Z,e=c*g+G*m+q*d;if(0===e)return this.identity();var p=1/e;return s[0]=g*p,s[1]=(q*k-S*G)*p,s[2]=(V*G-q*P)*p,s[3]=m*p,s[4]=(S*c-q*Z)*p,s[5]=(q*W-V*c)*p,s[6]=d*p,s[7]=(G*Z-k*c)*p,s[8]=(P*c-G*W)*p,this},transpose:function(){var G,A=this.el;return G=A[1],A[1]=A[3],A[3]=G,G=A[2],A[2]=A[6],A[6]=G,G=A[5],A[5]=A[7],A[7]=G,this},getNormalMatrix:function(p){return this.setFromMatrix4(p).getInverse(this).transpose()},transposeIntoArray:function(M){var v=this.el;return M[0]=v[0],M[1]=v[3],M[2]=v[6],M[3]=v[1],M[4]=v[4],M[5]=v[7],M[6]=v[2],M[7]=v[5],M[8]=v[8],this},setUvTransform:function(S,O,n,U,y,k,H){var x=Math.cos(y),W=Math.sin(y);this.set(n*x,n*W,-n*(x*k+W*H)+k+S,-U*W,U*x,-U*(-W*k+x*H)+H+O,0,0,1)},scale:function(q,P){var y=this.el;return y[0]*=q,y[3]*=q,y[6]*=q,y[1]*=P,y[4]*=P,y[7]*=P,this},rotate:function(x){var N=Math.cos(x),P=Math.sin(x),C=this.el,s=C[0],e=C[3],d=C[6],u=C[1],I=C[4],t=C[7];return C[0]=N*s+P*u,C[3]=N*e+P*I,C[6]=N*d+P*t,C[1]=-P*s+N*u,C[4]=-P*e+N*I,C[7]=-P*d+N*t,this},translate:function(n,s){var d=this.el;return d[0]+=n*d[2],d[3]+=n*d[5],d[6]+=n*d[8],d[1]+=s*d[2],d[4]+=s*d[5],d[7]+=s*d[8],this},equals:function(r){for(var Y=this.el,V=r.el,o=0;9>o;o++)if(Y[o]!==V[o])return!1;return!0},fromArray:function(o,v){v===i&&(v=0);for(var V=0;9>V;V++)this.el[V]=o[V+v];return this},toArray:function(t,k){t===i&&(t=[]),k===i&&(k=0);var r=this.el;return t[k]=r[0],t[k+1]=r[1],t[k+2]=r[2],t[k+3]=r[3],t[k+4]=r[4],t[k+5]=r[5],t[k+6]=r[6],t[k+7]=r[7],t[k+8]=r[8],t}});var Cp=v.Math.Plane=function(c,q){this.normal=c!==i?c:new Jb(1,0,0),this.constant=q!==i?q:0};I.assign(Cp.prototype,{set:function(N,i){return this.normal.copy(N),this.constant=i,this},setComponents:function(J,G,j,a){return this.normal.set(J,G,j),this.constant=a,this},setFromNormalAndCoplanarPoint:function(v,f){return this.normal.copy(v),this.constant=-f.dot(this.normal),this},setFromCoplanarPoints:function(){var g=new Jb,x=new Jb;return function(J,I,o){var S=g.subVectors(o,I).cross(x.subVectors(J,I)).normalize();return this.setFromNormalAndCoplanarPoint(S,J),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(p){return this.normal.copy(p.normal),this.constant=p.constant,this},normalize:function(){var V=1/this.normal.length();return this.normal.multiplyScalar(V),this.constant*=V,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(F){return this.normal.dot(F)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(f,Q){return Q===i&&(Q=new Jb),Q.copy(this.normal).multiplyScalar(-this.distanceToPoint(f)).add(f)},intersectLine:function(){var x=new Jb;return function(k,A){A===i&&(A=new Jb);var S=k.delta(x),m=this.normal.dot(S);if(0===m)return 0===this.distanceToPoint(k.start)?A.copy(k.start):i;var t=-(k.start.dot(this.normal)+this.constant)/m;return 0>t||t>1?i:A.copy(S).multiplyScalar(t).add(k.start)}}(),intersectsLine:function(H){var T=this.distanceToPoint(H.start),i=this.distanceToPoint(H.end);return 0>T&&i>0||0>i&&T>0},intersectsBox:function(A){return A.intersectsPlane(this)},intersectsSphere:function(G){return G.intersectsPlane(this)},coplanarPoint:function(p){return p===i&&(p=new Jb),p.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var C=new Jb,T=new x;return function(q,R){var F=R||T.getNormalMatrix(q),v=this.coplanarPoint(C).applyMatrix4(q),A=this.normal.applyMatrix3(F).normalize();return this.constant=-v.dot(A),this}}(),translate:function(Z){return this.constant-=Z.dot(this.normal),this},equals:function(f){return f.normal.equals(this.normal)&&f.constant===this.constant}});var dm=v.Math.Ray=function(N,A){this.origin=N!==i?N.clone():new Jb,this.direction=A!==i?A.clone():new Jb};I.assign(dm.prototype,{set:function(l,n){return this.origin.copy(l),this.direction.copy(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(S){return this.origin.copy(S.origin),this.direction.copy(S.direction),this.maxHitLen=S.maxHitLen,this},at:function(U,k){var K=k||new Jb;return K.copy(this.direction).multiplyScalar(U).add(this.origin)},setMaxHitLength:function(E){this.maxHitLen=E},lookAt:function(N){return this.direction.copy(N).sub(this.origin).normalize(),this},applyMatrix4:function(t){var k=this.maxHitLen;if(k){var u=this.direction.clone().multiplyScalar(k).add(this.origin);u.applyMatrix4(t)}return this.origin.applyMatrix4(t),this.direction.transformDirection(t),k&&(this.maxHitLen=this.origin.distanceTo(u)),this},intersectSphere:function(){var q=new Jb;return function(D,u){q.subVectors(D.center,this.origin);var y=q.dot(this.direction),H=q.dot(q)-y*y,O=D.radius*D.radius;if(H>O)return null;var E=Math.sqrt(O-H),Y=y-E,Z=y+E;return 0>Y&&0>Z?null:0>Y?this.at(Z,u):this.at(Y,u)}}(),intersectEllipsoid:function(){var S=new Jb,Q=new Jb;return function(R,N){S.subVectors(R.center,this.origin),S.divide(R.radius),Q.divideVectors(this.direction,R.radius);var j=Q.lengthSq(),I=S.dot(Q),h=S.dot(S)*j-I*I;if(h>j)return null;var q=Math.sqrt(j-h),f=(I-q)/j,y=(I+q)/j;return 0>f&&0>y?null:0>f?this.at(y,N):this.at(f,N)}}(),intersectBox:function(K,L){var n,$,g,C,o,B,P=1/this.direction.x,_=1/this.direction.y,N=1/this.direction.z,w=this.origin;if(P>=0?(n=(K.min.x-w.x)*P,$=(K.max.x-w.x)*P):(n=(K.max.x-w.x)*P,$=(K.min.x-w.x)*P),_>=0?(g=(K.min.y-w.y)*_,C=(K.max.y-w.y)*_):(g=(K.max.y-w.y)*_,C=(K.min.y-w.y)*_),n>C||g>$)return null;if((g>n||n!==n)&&(n=g),($>C||$!==$)&&($=C),N>=0?(o=(K.min.z-w.z)*N,B=(K.max.z-w.z)*N):(o=(K.max.z-w.z)*N,B=(K.min.z-w.z)*N),n>B||o>$)return null;if((o>n||n!==n)&&(n=o),($>B||$!==$)&&($=B),0>$)return null;var u=n>=0?n:$,k=this.maxHitLen;return k&&u>k?null:this.at(u,L)},intersectTriangle:function(){var T=new Jb,w=new Jb,F=new Jb,U=new Jb;return function(c,f,W,K,L){w.subVectors(f,c),F.subVectors(W,c),U.crossVectors(w,F);var Z,k=this.direction.dot(U);if(k>0){if(K)return null;Z=1}else{if(!(0>k))return null;Z=-1,k=-k}T.subVectors(this.origin,c);var $=Z*this.direction.dot(F.crossVectors(T,F));if(0>$)return null;var X=Z*this.direction.dot(w.cross(T));if(0>X||$+X>k)return null;var H=-Z*T.dot(U);if(0>H)return null;var J=H/k,r=this.maxHitLen;return r&&J>r?null:this.at(J,L)}}()});var hs=v.Math.Box3=function(S,Y){this.min=S!==i?S:new Jb(1/0,1/0,1/0),this.max=Y!==i?Y:new Jb(-1/0,-1/0,-1/0)};I.assign(hs.prototype,{set:function(C,J){return this.min.copy(C),this.max.copy(J),this},setFromArray:function(p){for(var z=1/0,N=1/0,w=1/0,k=-1/0,c=-1/0,o=-1/0,f=0,G=p.length;G>f;f+=3){var S=p[f],H=p[f+1],s=p[f+2];z>S&&(z=S),N>H&&(N=H),w>s&&(w=s),S>k&&(k=S),H>c&&(c=H),s>o&&(o=s)}return this.min.set(z,N,w),this.max.set(k,c,o),this},setFromPoints:function(V){this.makeEmpty();for(var s=0,U=V.length;U>s;s++)this.expandByPoint(V[s]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(P){return P.max.x<this.min.x||P.min.x>this.max.x||P.max.y<this.min.y||P.min.y>this.max.y||P.max.z<this.min.z||P.min.z>this.max.z?!1:!0},copy:function(P){return this.min.copy(P.min),this.max.copy(P.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(H){return this.min.min(H),this.max.max(H),this},expandByBox:function(O){return this.min.min(O.min),this.max.max(O.max),this},applyMatrix4:function(){var N=[new Jb,new Jb,new Jb,new Jb,new Jb,new Jb,new Jb,new Jb];return function(b){return this.isEmpty()?this:(N[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b),N[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b),N[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b),N[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b),N[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b),N[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b),N[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b),N[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b),this.setFromPoints(N),this)}}()});var Ir=v.Math.Sphere=function(P,o){this.center=P!==i?P:new Jb,this.radius=o!==i?o:0};I.assign(Ir.prototype,{set:function(t,W){return this.center.copy(t),this.radius=W,this},setFromPoints:function(){var y=new hs;return function(z,Q){var H=this.center;Q!==i?H.copy(Q):y.setFromPoints(z).getCenter(H);for(var A=0,I=0,e=z.length;e>I;I++)A=Math.max(A,H.distanceToSquared(z[I]));return this.radius=Math.sqrt(A),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(w){return this.center.copy(w.center),this.radius=w.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(J){return J.distanceTo(this.center)-this.radius},intersectsSphere:function(n){var m=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=m*m},intersectsBox:function(r){return r.intersectsSphere(this)},intersectsPlane:function(Z){return Math.abs(Z.distanceToPoint(this.center))<=this.radius},clampPoint:function(k,w){var x=this.center.distanceToSquared(k);return w===i&&(w=new Jb),w.copy(k),x>this.radius*this.radius&&(w.sub(this.center).normalize(),w.multiplyScalar(this.radius).add(this.center)),w},getBoundingBox:function(e){return e===i&&(e=new hs),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(v){return this.center.applyMatrix4(v),this.radius=this.radius*v.getMaxScaleOnAxis(),this},translate:function(W){return this.center.add(W),this},equals:function(r){return r.center.equals(this.center)&&r.radius===this.radius}});var mh=v.Math.Frustum=function(r,Q,j,u,a,s){this.planes=[r!==i?r:new Cp,Q!==i?Q:new Cp,j!==i?j:new Cp,u!==i?u:new Cp,a!==i?a:new Cp,s!==i?s:new Cp]};I.assign(mh.prototype,{set:function(M,H,o,x,R,T){var Z=this.planes;return Z[0].copy(M),Z[1].copy(H),Z[2].copy(o),Z[3].copy(x),Z[4].copy(R),Z[5].copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function(G){for(var r=this.planes,P=0;6>P;P++)r[P].copy(G.planes[P]);return this},setFromMatrix:function(e){var C=this.planes,l=e.el,y=l[0],g=l[1],q=l[2],I=l[3],s=l[4],Q=l[5],K=l[6],B=l[7],D=l[8],Y=l[9],c=l[10],z=l[11],o=l[12],H=l[13],$=l[14],N=l[15];return C[0].setComponents(I-y,B-s,z-D,N-o).normalize(),C[1].setComponents(I+y,B+s,z+D,N+o).normalize(),C[2].setComponents(I+g,B+Q,z+Y,N+H).normalize(),C[3].setComponents(I-g,B-Q,z-Y,N-H).normalize(),C[4].setComponents(I-q,B-K,z-c,N-$).normalize(),C[5].setComponents(I+q,B+K,z+c,N+$).normalize(),this},intersectsObject:function(){var e=new Ir;return function(J){var f=J.geometry;return null===f.boundingSphere&&f.computeBoundingSphere(),e.copy(f.boundingSphere).applyMatrix4(J.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var q=new Ir;return function(B){return q.center.set(0,0,0),q.radius=.7071067811865476,q.applyMatrix4(B.matrixWorld),this.intersectsSphere(q)}}(),intersectsSphere:function(d){for(var V=this.planes,S=d.center,l=-d.radius,G=0;6>G;G++){var U=V[G].distanceToPoint(S);if(l>U)return!1}return!0},intersectsBox:function(){var N=new Jb;return function(x){for(var k=this.planes,l=0;6>l;l++){var n=k[l];if(N.x=n.normal.x>0?x.max.x:x.min.x,N.y=n.normal.y>0?x.max.y:x.min.y,N.z=n.normal.z>0?x.max.z:x.min.z,n.distanceToPoint(N)<0)return!1}return!0}}(),containsPoint:function(Y){for(var d=this.planes,H=0;6>H;H++)if(d[H].distanceToPoint(Y)<0)return!1;return!0}});var _e=v.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};I.assign(_e.prototype,{set:function(n,k,h,L,u,R,J,C,A,s,Y,t,M,W,P,_){var d=this.el;return d[0]=n,d[4]=k,d[8]=h,d[12]=L,d[1]=u,d[5]=R,d[9]=J,d[13]=C,d[2]=A,d[6]=s,d[10]=Y,d[14]=t,d[3]=M,d[7]=W,d[11]=P,d[15]=_,this},clone:function(){return(new _e).fromArray(this.el)},fromArray:function(h,j){j===i&&(j=0);for(var v=this.el,w=0;16>w;w++)v[w]=h[w+j];return this},scale:function(t){var h=this.el,e=t.x,J=t.y,E=t.z;return h[0]*=e,h[4]*=J,h[8]*=E,h[1]*=e,h[5]*=J,h[9]*=E,h[2]*=e,h[6]*=J,h[10]*=E,h[3]*=e,h[7]*=J,h[11]*=E,this},makeRotationFromEuler:function(J){var X=this.el,$=J._x,F=J._y,R=J._z,j=J._order,z=Math.cos($),K=Math.sin($),d=Math.cos(F),a=Math.sin(F),A=Math.cos(R),L=Math.sin(R);if("XYZ"===j){var Y=z*A,m=z*L,x=K*A,B=K*L;X[0]=d*A,X[4]=-d*L,X[8]=a,X[1]=m+x*a,X[5]=Y-B*a,X[9]=-K*d,X[2]=B-Y*a,X[6]=x+m*a,X[10]=z*d}else if("YXZ"===j){var q=d*A,b=d*L,u=a*A,s=a*L;X[0]=q+s*K,X[4]=u*K-b,X[8]=z*a,X[1]=z*L,X[5]=z*A,X[9]=-K,X[2]=b*K-u,X[6]=s+q*K,X[10]=z*d}else if("ZXY"===j){var q=d*A,b=d*L,u=a*A,s=a*L;X[0]=q-s*K,X[4]=-z*L,X[8]=u+b*K,X[1]=b+u*K,X[5]=z*A,X[9]=s-q*K,X[2]=-z*a,X[6]=K,X[10]=z*d}else if("ZYX"===j){var Y=z*A,m=z*L,x=K*A,B=K*L;X[0]=d*A,X[4]=x*a-m,X[8]=Y*a+B,X[1]=d*L,X[5]=B*a+Y,X[9]=m*a-x,X[2]=-a,X[6]=K*d,X[10]=z*d}else if("YZX"===j){var v=z*d,W=z*a,l=K*d,n=K*a;X[0]=d*A,X[4]=n-v*L,X[8]=l*L+W,X[1]=L,X[5]=z*A,X[9]=-K*A,X[2]=-a*A,X[6]=W*L+l,X[10]=v-n*L}else if("XZY"===j){var v=z*d,W=z*a,l=K*d,n=K*a;X[0]=d*A,X[4]=-L,X[8]=a*A,X[1]=v*L+n,X[5]=z*A,X[9]=W*L-l,X[2]=l*L-W,X[6]=K*A,X[10]=n*L+v}return X[3]=0,X[7]=0,X[11]=0,X[12]=0,X[13]=0,X[14]=0,X[15]=1,this},makeRotationFromQuaternion:function(I){var Q=this.el,E=I._x,z=I._y,f=I._z,X=I._w,u=E+E,V=z+z,j=f+f,m=E*u,N=E*V,R=E*j,v=z*V,h=z*j,g=f*j,L=X*u,b=X*V,H=X*j;return Q[0]=1-(v+g),Q[4]=N-H,Q[8]=R+b,Q[1]=N+H,Q[5]=1-(m+g),Q[9]=h-L,Q[2]=R-b,Q[6]=h+L,Q[10]=1-(m+v),Q[3]=0,Q[7]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(T){var Y=this.el,_=T.el,W=_[0],a=_[1],q=_[2],v=_[3],l=_[4],U=_[5],n=_[6],h=_[7],x=_[8],E=_[9],D=_[10],j=_[11],C=_[12],z=_[13],Q=_[14],I=_[15],B=E*Q*h-z*D*h+z*n*j-U*Q*j-E*n*I+U*D*I,r=C*D*h-x*Q*h-C*n*j+l*Q*j+x*n*I-l*D*I,Z=x*z*h-C*E*h+C*U*j-l*z*j-x*U*I+l*E*I,J=C*E*n-x*z*n-C*U*D+l*z*D+x*U*Q-l*E*Q,k=W*B+a*r+q*Z+v*J;if(0===k)return this.identity();var m=1/k;return Y[0]=B*m,Y[1]=(z*D*v-E*Q*v-z*q*j+a*Q*j+E*q*I-a*D*I)*m,Y[2]=(U*Q*v-z*n*v+z*q*h-a*Q*h-U*q*I+a*n*I)*m,Y[3]=(E*n*v-U*D*v-E*q*h+a*D*h+U*q*j-a*n*j)*m,Y[4]=r*m,Y[5]=(x*Q*v-C*D*v+C*q*j-W*Q*j-x*q*I+W*D*I)*m,Y[6]=(C*n*v-l*Q*v-C*q*h+W*Q*h+l*q*I-W*n*I)*m,Y[7]=(l*D*v-x*n*v+x*q*h-W*D*h-l*q*j+W*n*j)*m,Y[8]=Z*m,Y[9]=(C*E*v-x*z*v-C*a*j+W*z*j+x*a*I-W*E*I)*m,Y[10]=(l*z*v-C*U*v+C*a*h-W*z*h-l*a*I+W*U*I)*m,Y[11]=(x*U*v-l*E*v-x*a*h+W*E*h+l*a*j-W*U*j)*m,Y[12]=J*m,Y[13]=(x*z*q-C*E*q+C*a*D-W*z*D-x*a*Q+W*E*Q)*m,Y[14]=(C*U*q-l*z*q-C*a*n+W*z*n+l*a*Q-W*U*Q)*m,Y[15]=(l*E*q-x*U*q+x*a*n-W*E*n-l*a*D+W*U*D)*m,this},makeRotationAxis:function(h,s){var D=Math.cos(s),f=Math.sin(s),H=1-D,U=h.x,Y=h.y,$=h.z,z=H*U,b=H*Y;return this.set(z*U+D,z*Y-f*$,z*$+f*Y,0,z*Y+f*$,b*Y+D,b*$-f*U,0,z*$-f*Y,b*$+f*U,H*$*$+D,0,0,0,0,1),this},multiply:function(v){return this.multiplyMatrices(this,v)},premultiply:function(s){return this.multiplyMatrices(s,this)},multiplyMatrices:function(e,w){var E=e.el,j=w.el,I=this.el,_=E[0],B=E[4],r=E[8],s=E[12],p=E[1],H=E[5],Y=E[9],f=E[13],x=E[2],G=E[6],N=E[10],S=E[14],X=E[3],z=E[7],o=E[11],$=E[15],P=j[0],M=j[4],L=j[8],W=j[12],u=j[1],Q=j[5],F=j[9],T=j[13],h=j[2],d=j[6],C=j[10],A=j[14],K=j[3],i=j[7],l=j[11],k=j[15];return I[0]=_*P+B*u+r*h+s*K,I[4]=_*M+B*Q+r*d+s*i,I[8]=_*L+B*F+r*C+s*l,I[12]=_*W+B*T+r*A+s*k,I[1]=p*P+H*u+Y*h+f*K,I[5]=p*M+H*Q+Y*d+f*i,I[9]=p*L+H*F+Y*C+f*l,I[13]=p*W+H*T+Y*A+f*k,I[2]=x*P+G*u+N*h+S*K,I[6]=x*M+G*Q+N*d+S*i,I[10]=x*L+G*F+N*C+S*l,I[14]=x*W+G*T+N*A+S*k,I[3]=X*P+z*u+o*h+$*K,I[7]=X*M+z*Q+o*d+$*i,I[11]=X*L+z*F+o*C+$*l,I[15]=X*W+z*T+o*A+$*k,this},lookAt:function(){var i=new Jb,E=new Jb,H=new Jb;return function(W,w,G){var D=this.el;return H.subVectors(W,w),0===H.lengthSq()&&(H.z=1),H.normalize(),i.crossVectors(G,H),0===i.lengthSq()&&(1===Math.abs(G.z)?H.x+=1e-4:H.z+=1e-4,H.normalize(),i.crossVectors(G,H)),i.normalize(),E.crossVectors(H,i),D[0]=i.x,D[4]=E.x,D[8]=H.x,D[1]=i.y,D[5]=E.y,D[9]=H.y,D[2]=i.z,D[6]=E.z,D[10]=H.z,this}}(),extractScale:function(){var y;return function(o){y===i&&(y=new Jb),o===i&&(o=new Jb);var R=y.setFromMatrixColumn(this,0).length(),w=y.setFromMatrixColumn(this,1).length(),J=y.setFromMatrixColumn(this,2).length();return o.set(R,w,J),o}}(),extractRotation:function(){var N;return function(j){N===i&&(N=new Jb),j===i&&(j=new _e);var d=this.el,b=j.el,o=1/N.setFromMatrixColumn(j,0).length(),M=1/N.setFromMatrixColumn(j,1).length(),C=1/N.setFromMatrixColumn(j,2).length();return d[0]=b[0]*o,d[1]=b[1]*o,d[2]=b[2]*o,d[4]=b[4]*M,d[5]=b[5]*M,d[6]=b[6]*M,d[8]=b[8]*C,d[9]=b[9]*C,d[10]=b[10]*C,this}}(),multiplyScalar:function(_){var j=this.el;return j[0]*=_,j[4]*=_,j[8]*=_,j[12]*=_,j[1]*=_,j[5]*=_,j[9]*=_,j[13]*=_,j[2]*=_,j[6]*=_,j[10]*=_,j[14]*=_,j[3]*=_,j[7]*=_,j[11]*=_,j[15]*=_,this},getPosition:function(j){return j===i&&(j=new Jb),j.setFromMatrixColumn(this,3)},setPosition:function(U){var K=this.el;return K[12]=U.x,K[13]=U.y,K[14]=U.z,this},toArray:function(o,z){o===i&&(o=[]),z===i&&(z=0);var U=this.el;return o[z]=U[0],o[z+1]=U[1],o[z+2]=U[2],o[z+3]=U[3],o[z+4]=U[4],o[z+5]=U[5],o[z+6]=U[6],o[z+7]=U[7],o[z+8]=U[8],o[z+9]=U[9],o[z+10]=U[10],o[z+11]=U[11],o[z+12]=U[12],o[z+13]=U[13],o[z+14]=U[14],o[z+15]=U[15],o},determinant:function(){var W=this.el,V=W[0],S=W[4],v=W[8],$=W[12],A=W[1],B=W[5],d=W[9],Q=W[13],L=W[2],P=W[6],r=W[10],M=W[14],X=W[3],p=W[7],C=W[11],z=W[15];return X*(+$*d*P-v*Q*P-$*B*r+S*Q*r+v*B*M-S*d*M)+p*(+V*d*M-V*Q*r+$*A*r-v*A*M+v*Q*L-$*d*L)+C*(+V*Q*P-V*B*M-$*A*P+S*A*M+$*B*L-S*Q*L)+z*(-v*B*L-V*d*P+V*B*r+v*A*P-S*A*r+S*d*L)},copy:function(a){var n=this.el,N=a.el;return n[0]=N[0],n[1]=N[1],n[2]=N[2],n[3]=N[3],n[4]=N[4],n[5]=N[5],n[6]=N[6],n[7]=N[7],n[8]=N[8],n[9]=N[9],n[10]=N[10],n[11]=N[11],n[12]=N[12],n[13]=N[13],n[14]=N[14],n[15]=N[15],this},compose:function(U,d,a){var p=this.el,r=d._x,X=d._y,h=d._z,k=d._w,j=r+r,D=X+X,s=h+h,w=r*j,Z=r*D,L=r*s,V=X*D,G=X*s,l=h*s,O=k*j,P=k*D,K=k*s,E=a.x,x=a.y,f=a.z;return p[0]=(1-(V+l))*E,p[1]=(Z+K)*E,p[2]=(L-P)*E,p[3]=0,p[4]=(Z-K)*x,p[5]=(1-(w+l))*x,p[6]=(G+O)*x,p[7]=0,p[8]=(L+P)*f,p[9]=(G-O)*f,p[10]=(1-(w+V))*f,p[11]=0,p[12]=U.x,p[13]=U.y,p[14]=U.z,p[15]=1,this},decompose:function(){var D=new Jb,x=new _e;return function(y,d,C){var j=this.el,e=D.set(j[0],j[1],j[2]).length(),b=D.set(j[4],j[5],j[6]).length(),p=D.set(j[8],j[9],j[10]).length(),B=this.determinant();0>B&&(e=-e),y.x=j[12],y.y=j[13],y.z=j[14],x.copy(this);var i=1/e,L=1/b,E=1/p;return x.el[0]*=i,x.el[1]*=i,x.el[2]*=i,x.el[4]*=L,x.el[5]*=L,x.el[6]*=L,x.el[8]*=E,x.el[9]*=E,x.el[10]*=E,d.setFromRotationMatrix(x),C.x=e,C.y=b,C.z=p,this}}()});var Kj=v.Math.Triangle=function(T,c,q){this.a=T!==i?T:new Jb,this.b=c!==i?c:new Jb,this.c=q!==i?q:new Jb};I.assign(Kj,{barycoordFromPoint:function(){var u=new Jb,S=new Jb,B=new Jb;return function(q,Q,w,e,W){u.subVectors(e,Q),S.subVectors(w,Q),B.subVectors(q,Q);var C=u.dot(u),n=u.dot(S),J=u.dot(B),d=S.dot(S),b=S.dot(B),$=C*d-n*n,R=W||new Jb;if(0===$)return R.set(-2,-1,-1);var j=1/$,Y=(d*J-n*b)*j,M=(C*b-n*J)*j;return R.set(1-Y-M,M,Y)}}()});var Re=v.Math.Euler=function(p,d,g,B,l){this.set(p,d,g,B,l)};Re.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Re.DefaultOrder="XYZ",Re.ReverseOrder=function(i){return i=i[2]+i[1]+i[0],i.toUpperCase()},I.defineProperties(Re.prototype,{x:{get:function(){return this._x},set:function(d){this._x=d,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(M){this._y=M,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Q){this._z=Q,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),I.assign(Re.prototype,{set:function(S,Y,g,W,a){return qf(S)&&(a=g,W=Y,g=S[2],Y=S[1],S=S[0]),W?a&&(W=Re.ReverseOrder(W)):W="ZYX",this._x=S||0,this._y=Y||0,this._z=g||0,this._order=W||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(Q){return this._x=Q._x,this._y=Q._y,this._z=Q._z,this._order=Q._order,this.onChangeCallback(),this},setFromRotationMatrix:function(s,w,N){var O=v.Math.clamp,x=s.el||s,f=x[0],W=x[4],i=x[8],J=x[1],r=x[5],$=x[9],b=x[2],p=x[6],B=x[10];return w=w||this._order,"XYZ"===w?(this._y=Math.asin(O(i,-1,1)),Math.abs(i)<.99999?(this._x=Math.atan2(-$,B),this._z=Math.atan2(-W,f)):(this._x=Math.atan2(p,r),this._z=0)):"YXZ"===w?(this._x=Math.asin(-O($,-1,1)),Math.abs($)<.99999?(this._y=Math.atan2(i,B),this._z=Math.atan2(J,r)):(this._y=Math.atan2(-b,f),this._z=0)):"ZXY"===w?(this._x=Math.asin(O(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-b,B),this._z=Math.atan2(-W,r)):(this._y=0,this._z=Math.atan2(J,f))):"ZYX"===w?(this._y=Math.asin(-O(b,-1,1)),Math.abs(b)<.99999?(this._x=Math.atan2(p,B),this._z=Math.atan2(J,f)):(this._x=0,this._z=Math.atan2(-W,r))):"YZX"===w?(this._z=Math.asin(O(J,-1,1)),Math.abs(J)<.99999?(this._x=Math.atan2(-$,r),this._y=Math.atan2(-b,f)):(this._x=0,this._y=Math.atan2(i,B))):"XZY"===w?(this._z=Math.asin(-O(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(p,r),this._y=Math.atan2(i,f)):(this._x=Math.atan2(-$,B),this._y=0)):console.warn("unsupported order: "+w),this._order=w,N!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var j=new _e;return function(O,X,v){return j.makeRotationFromQuaternion(O),this.setFromRotationMatrix(j,X,v)}}(),setFromVector3:function(E,B){return this.set(E.x,E.y,E.z,B||this._order)},reorder:function(){var a=new il;return function(M){return a.setFromEuler(this),this.setFromQuaternion(a,M)}}(),equals:function(R){return R._x===this._x&&R._y===this._y&&R._z===this._z&&R._order===this._order},fromArray:function(y){return this._x=y[0],this._y=y[1],this._z=y[2],y[3]!==i&&(this._order=y[3]),this.onChangeCallback(),this},toArray:function(v,Y){return v===i&&(v=[]),Y===i&&(Y=0),v[Y]=this._x,v[Y+1]=this._y,v[Y+2]=this._z,v[Y+3]=this._order,v},toVector3:function(s){return s?s.set(this._x,this._y,this._z):new Jb(this._x,this._y,this._z)},onChange:function(v){return this.onChangeCallback=v,this},onChangeCallback:function(){}});var Ib={ms_ac:function(z,j){for(var N=j.ms_ac,l=0;l<N.length;l++)tn(z,N[l])},ms_listener:function(e){e.addListeners=function(){for(var K=this,E=0;E<Cj.length;E++){var l=Cj[E];"wheel"===l&&!K.handle_wheel&&K.handle_mousewheel&&(K.handle_wheel=function(X){Dq(K,X)}),K["handle_"+l]&&hn(l,K.getView(),K)}},e.removeListeners=function(){for(var o=this,y=0;y<Cj.length;y++)o["handle_"+Cj[y]]&&kg(Cj[y],o.getView(),o)}},ms_fire:function(q){q.mp=function(c,k,s){this.addPropertyChangeListener(c,k,s)},q.ump=function(D,s){this.removePropertyChangeListener(D,s)},q.fp=function(j,k,N,Y,S){return this.firePropertyChange(j,k,N,Y,S)},q.addPropertyChangeListener=function(c,A,t){var k=this;k._62I||(k._62I=new ch),k._62I.add(c,A,t)},q.removePropertyChangeListener=function(C,o){this._62I&&this._62I.remove(C,o)},q.firePropertyChange=function(S,M,m,I,G){if(I){if(I(M,m))return!1}else if(M===m)return!1;var h=this,o=G||{};return o.property=S,o.oldValue=M,o.newValue=m,o.source=h,o.data=h,h._62I&&h._62I.fire(o),h.onPropertyChanged&&h.onPropertyChanged(o),!0}},ms_attr:function(U){U.a=function(V,U){var $=this;if(2===arguments.length)$.setAttr(V,U);else{if(!as(V))return $.getAttr(V);for(var M in V)$.setAttr(M,V[M])}return $},U.getAttr=function(A,b){if(b===i&&(b=1),this._attrObject&&A in this._attrObject)return this._attrObject[A];if(this.getImage){var L=this.getImage();if(tq(L)&&(L=zm[L]),as(L)&&"dataBindings"in L)for(var Z=L.dataBindings,e=Z.length-1;e>=0;e--){var r=Z[e];if(r.attr===A){if("defaultValue"in r)return r.defaultValue;break}}}return b?P[A]:i},U.setAttr=function(E,p){var b=this;b._attrObject||(b._attrObject={});var K=b._attrObject[E];p===i?delete b._attrObject[E]:b._attrObject[E]=p,b.fp&&b.fp("a:"+E,K,p)&&b.onAttrChanged&&b.onAttrChanged(E,K,p)},U.getSerializableAttrs=function(){var g,O={};for(g in this._attrObject)O[g]=1;return O}},ms_bnb:function(N){N.getBodyColor=function(r){return r.s("body.color")},N.getBorderColor=function(E){return E.s("border.color")}},_51o:function(J){J.mi=function(Z,m,W){this.addInteractorListener(Z,m,W)},J.umi=function(f,s){this.removeInteractorListener(f,s)},J.fi=function(H){this.fireInteractorEvent(H)},J.addInteractorListener=function(q,N,V){var X=this;X._63I||(X._63I=new ch),X._63I.add(q,N,V)},J.removeInteractorListener=function(V,Z){this._63I&&this._63I.remove(V,Z)},J.fireInteractorEvent=function(F){this._63I&&this._63I.fire(F)},J.setInteractors=function(H){var v=this,e=v._interactors;e&&e.each(function(C){C.tearDown()}),qf(H)&&(H=new Pb(H)),v._interactors=H,H&&H.each(function(Q){Q.setUp()}),v.fp("interactors",e,H),v.invalidateSelection()},J.getInteractors=function(){return this._interactors}},_49o:function(i){i._44O=w,i._45O=w,i.getTopPainters=function(){return this._44O},i.getBottomPainters=function(){return this._45O},i.addTopPainter=function(q){var h=this;h._44O||(h._44O=new Pb),h._44O.contains(q)||(h._44O.add(q),h.redraw&&h.redraw())},i.removeTopPainter=function(z){var F=this;F._44O&&(F._44O.remove(z),F.redraw&&F.redraw())},i.addBottomPainter=function(N){var q=this;q._45O||(q._45O=new Pb),q._45O.contains(N)||(q._45O.add(N),q.redraw&&q.redraw())},i.removeBottomPainter=function(d){var G=this;G._45O&&(G._45O.remove(d),G.redraw&&G.redraw())},i._93db=function(b,P){var c=this;c._45O&&c._45O.each(function(i){i.draw?i.draw(b,P):i.call(c,b,P)})},i._92db=function(q,s){var j=this;j._44O&&j._44O.each(function(V){V.draw?V.draw(q,s):V.call(j,q,s)})}},ms_sm:function(T){T.sm=function(){return this.getSelectionModel()},T.setSelectableFunc=function(a){this.sm().setFilterFunc(a)},T.getSelectableFunc=function(){return this.sm().getFilterFunc()},T.getSelectionModel=function(){var O=this;return O._selectionModel?O._selectionModel:O.dm().sm()},T.isSelectionModelShared=function(){return!this._selectionModel},T.setSelectionModelShared=function(X){var g=this,F=!g._selectionModel,c=g.handleSelectionChange,C=g.dm();F!==X&&(g.invalidateSelection&&g.invalidateSelection(),X?(C.sm().ms(c,g),g._selectionModel.ums(c,g),g._selectionModel.dispose(),g._selectionModel=w):(C.sm().ums(c,g),g._selectionModel=new Ce(C),g._selectionModel.ms(c,g)),g.onSelectionModelSharedChanged(),g.fp("selectionModelShared",F,X))
},T.onSelectionModelSharedChanged=function(){var N=this;N.redraw(),N.invalidateSelection&&N.invalidateSelection()},T.removeSelection=function(){var o=this.dm();o.beginTransaction(),this.sm().toSelection().each(o.remove,o),o.endTransaction()},T.selectAll=function(){var g=this;g.sm().ss(g.dm().toDatas(function(r){return g.isVisible(r)&&g.isSelectable(r)}))},T.isSelected=function(H){return this.sm().co(H)},T.isSelectedById=function(g){var I=this.dm().getDataById(g);return I?this.isSelected(I):!1},T.isSelectable=function(n){return this.sm().isSelectable(n)}},ms_tx:function(I){I._64I=0,I._65O=0,I.isScrollable=function(){return this.getWidth()<this._64I},I._40o=function(){return this.isScrollable()},I.getLogicalPoint=function(Y){return ii(Y,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},I.tx=function(M){return M===i?this.getTranslateX():(this.setTranslateX(M),void 0)},I.getTranslateX=function(){return this._65O},I.setTranslateX=function($){var P=this,L=P.getWidth()-P._64I;L>$&&($=L),$>0&&($=0),$=J($);var z=P._65O;P._65O=$,P.fp(Qb,z,$)}},ms_ty:function(X){X._23Q=0,X._66O=0,X._41o=function(){return this.getHeight()<this._23Q},X.getLogicalPoint=function(Y){return ii(Y,this._canvas||this._view,this.tx?this.tx():0,this.ty())},X.ty=function(B){return B===i?this.getTranslateY():(this.setTranslateY(B),void 0)},X.getTranslateY=function(){return this._66O},X.setTranslateY=function(E){var C=this,O=C.getHeight()-C._23Q;O>E&&(E=O),E>0&&(E=0),E=J(E);var A=C._66O;C._66O=E,C.fp(Lp,A,E)}},ms_txy:function(U){U._65O=0,U._66O=0,U.tx=function(w){return w===i?this.getTranslateX():(this.setTranslateX(w),void 0)},U.ty=function(T){return T===i?this.getTranslateY():(this.setTranslateY(T),void 0)},U.onTranslateEnded=function(){},U.setTranslate=function(p,h,Z){var E=this;if(Z=ig(Z)){E._65I&&E._65I.stop(!0);var o=E.tx(),z=E.ty();Z.action=function(N){E.setTranslate(o+(p-o)*N,z+(h-z)*N)},Z._37o=function(){delete E._66I,delete E._65I,E.onTranslateEnded()},E._66I=1,E._65I=ar(Z)}else E.tx(p),E.ty(h)},U.getTranslateX=function(){return this._65O},U.setTranslateX=function(O){var P=this;O=P.adjustTranslateX(O);var x=P._65O;P._65O=O,P.fp(Qb,x,O)},U.getTranslateY=function(){return this._66O},U.setTranslateY=function(E){var s=this;E=s.adjustTranslateY(E);var d=s._66O;s._66O=E,s.fp(Lp,d,E)},U.adjustTranslateX=function(f){return J(f)},U.adjustTranslateY=function(l){return J(l)},U.translate=function(G,E,r){this.setTranslate(this.tx()+G,this.ty()+E,r)},U.getLogicalPoint=function(i){var T=this;return ii(i,this._canvas||T._view,T.tx(),T.ty())}},ms_dm:function(V){V.dm=function(B){return B?(this.setDataModel(B),void 0):this.getDataModel()},V.getDataModel=function(){return this._dataModel}},ms_lp:function(N){N.lp=function(P){return this.getLogicalPoint(P)}},ms_v:function(f){f._disabled=!1,f.setDisabled=function(N,R){var o=this,T=o._disabled;T!==N&&(T&&(ck(o._63O),delete o._63O),N&&(Pj(o._view,o._63O=Wg(R)),o.iv()),o._disabled=N,o.fp("disabled",T,N))},f.isDisabled=function(){return this._disabled},f.getDisabledDiv=function(){return this._63O},f.getView=function(){return this._view},f.addToDOM=function(U){var A=this,$=A.getView(),B=$.style;U=U||j.body,U.appendChild($),B.left="0",B.right="0",B.top="0",B.bottom="0",X(u,"resize",function(){A.iv()}),A.iv()},f.getWidth=function(){return this._view.clientWidth},f.getHeight=function(){return this._view.clientHeight},f.setWidth=function(C){var o=this;o._view.style.width=C+Ih,o.iv(),o.fp&&o.fp(In,w,C)},f.setHeight=function(I){var K=this;K._view.style.height=I+Ih,K.iv(),K.fp&&K.fp(bc,w,I)},f.setFocus=function(j){var K=this,d=K._currentEditor;return j&&d&&(d.getView&&(d=d.getView()),d.contains(j.target))?!1:(Rc(K._view),K.endEditing&&K.endEditing(),K.fireViewEvent("focus"),!0)},f.iv=function($){this.invalidate($)},f.invalidate=function(i){var f=this;f._68I||(f._68I=1,Ao(f.validate,f,w,i),f.onInvalidated&&f.onInvalidated(),f.fireViewEvent("invalidate"))},f.validate=function(){var Y=this,P=Y._view;if(Y._68I&&(delete Y._68I,P.parentNode))if(0===P.offsetWidth&&0===P.offsetHeight&&Y._67I!==w)Y._67I===i&&(Y._67I=C.reinvalidateCount),Y._67I>0?Y._67I--:Y._67I=w,Y.iv();else{Y.fireViewEvent("beginValidate"),Y.validateImpl(),Y.onValidated&&Y.onValidated(),Y.fireViewEvent("validate");var E=Y._63O;E&&(P.lastChild!==E&&(ck(E),Pj(P,E)),Wp(E,0,0,Y.getWidth(),Y.getHeight())),Ab(Y),lb(Y),Uq(Y)}},f.layout=function(d,H,J,T){1===arguments.length?Wp(this,d):Wp(this,d,H,J,T)},f.addViewListener=function(M,s,X){var z=this;z._67O||(z._67O=new ch),z._67O.add(M,s,X)},f.removeViewListener=function(W,V){this._67O.remove(W,V)},f.fireViewEvent=function(t){var O=this;O._67O&&(tq(t)&&(t={kind:t}),O._67O.fire(t)),C.viewListener&&C.viewListener(O,t)}},ms_tip:function(T){T.setToolTipEnabled=function(q){var g=this;q?ij||g._13o||(g.enableToolTip(),g.fp("toolTipEnabled",!1,!0)):g._13o&&(g.disableToolTip(),g.fp("toolTipEnabled",!0,!1))},T.isToolTipEnabled=function(){return!!this._13o},T.enableToolTip=function(){var j=this;if(!ij&&!j._13o){j._13o=function(b){var F=j.getToolTip(b);F!=w?C.toolTipContinual&&C.isToolTipShowing()?$k(b,F):(yp(),lp={timeout:_(rp,eh),e:b,info:F}):yp()};var M=j.getView();X(M,Rg,j._13o),X(M,"mouseleave",C.hideToolTip)}},T.disableToolTip=function(){var U=this;if(U._13o){var c=U.getView();q(c,Rg,U._13o),q(c,"mouseleave",C.hideToolTip),delete U._13o}},T.getToolTip=function(o){var f=this;if(f.getDataAt){var n=f.getDataAt(o);return n?n.getToolTip():w}return f.getValue?f.getValue():void 0}},_52o:function(B){B._zoom=1,B._29I=Be,B.zoomIn=function(z,i){this.setZoom(this._zoom*$d,z,i)},B.zoomOut=function(X,K){this.setZoom(this._zoom/$d,X,K)},B.zoomReset=function(e,A){this.setZoom(1,e,A)},B.scrollZoomIn=function(b){this.setZoom(this._zoom*er,w,b)},B.scrollZoomOut=function(e){this.setZoom(this._zoom/er,w,e)},B.pinchZoomIn=function(y){this.setZoom(this._zoom*bj,w,y)},B.pinchZoomOut=function(k){this.setZoom(this._zoom/bj,w,k)},B.adjustZoom=function(l){return sm>l?sm:l>yl?yl:l},B.getZoom=function(){return this._zoom},B.setZoom=function(o,c,I){var E=this;if(c=ig(c)){E._14o&&E._14o.stop(!0);var d=E._zoom;c.action=function(f){E._96O(d+(o-d)*f,I)},c._37o=function(){delete E._zooming,delete E._14o,E.onZoomEnded()},E._zooming=1,E._14o=ar(c)}else E._96O(o,I)},B._96O=function(e,c){var G=this;if(e=G.adjustZoom(e),e!==G._zoom){G.validate();var j=G._29I,F=G._zoom;0!==j.width&&0!==j.height&&(c=c?c:{x:j.x+j.width/2,y:j.y+j.height/2},G.tx((c.x-j.x)*F-c.x*e),G.ty((c.y-j.y)*F-c.y*e)),G._zoom=e,G.fp("zoom",F,e)}}},ms_edge:function(t){t._2I=function(e){var m=this;m._44I||(m._44I=new Pb),m._42I||(m._42I=new Pb),m._44I.add(e),m._42I.add(e),m._20I()},t._4I=function(T){var N=this;N._44I||(N._44I=new Pb),N._43I||(N._43I=new Pb),N._44I.add(T),N._43I.add(T),N._20I()},t._16I=function(z){var N=this;N._44I.remove(z),N._42I.remove(z),N._44I.isEmpty()&&delete N._44I,N._42I.isEmpty()&&delete N._42I,N._20I()},t._18I=function(w){var h=this;h._44I.remove(w),h._43I.remove(w),h._44I.isEmpty()&&delete h._44I,h._43I.isEmpty()&&delete h._43I,h._20I()},t._20I=function(){var V=this;if(delete V._45I,!V._44I||V._44I.isEmpty())return delete V._70O,void 0;var C;V._44I.each(function(N){N.isLooped()&&(C||(C={}),C[N._id]||(V._45I||(V._45I=new Pb),V._45I.add(N),C[N._id]=N))}),C?(V._70O=new Pb,V._44I.each(function(T){C[T._id]?"A"===C[T._id]||(C[T._id]="A",V._70O.add(T)):V._70O.add(T)})):V._70O=V._44I},t.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},t.getSourceAgentEdges=function(){return this._46I},t.getTargetAgentEdges=function(){return this._47I},t._1I=function(v){var C=this;C._46I||(C._46I=new Pb),C._48I||(C._48I=new Pb),C._46I.add(v),C._48I.add(v),C._19I()},t._3I=function(d){var f=this;f._47I||(f._47I=new Pb),f._48I||(f._48I=new Pb),f._47I.add(d),f._48I.add(d),f._19I()},t._15I=function(W){var x=this;x._46I.remove(W),x._48I.remove(W),x._46I.isEmpty()&&delete x._46I,x._48I.isEmpty()&&delete x._48I,x._19I()},t._17I=function(y){var a=this;a._47I.remove(y),a._48I.remove(y),a._47I.isEmpty()&&delete a._47I,a._48I.isEmpty()&&delete a._48I,a._19I()},t._19I=function(){var K=this;delete K._49I;var k=K._48I;if(k&&!k.isEmpty()){var g={};k.each(function(M){g[M._id]?K._49I||(K._49I=new Pb):g[M._id]=M}),K._49I?k.each(function(f){g[f._id]&&(K._49I.add(f),delete g[f._id])}):K._49I=k}},t.getLoopedEdges=function(){return this._45I},t.getEdges=function(){return this._70O},t.getAgentEdges=function(){return this._49I},t.getSourceEdges=function(){return this._42I},t.getTargetEdges=function(){return this._43I},t._8I=function(){this._70O&&this._70O.each(function(J){J._7I()})}}};og(C,{numberDigits:5,crossOrigin:"",baseZIndex:i,isTouchable:ij,devicePixelRatio:u.devicePixelRatio?u.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:E.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Bb},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:ij?20:1,animDuration:200,animEasing:function(y){return y*y},labelColor:Dr,labelSelectColor:Qe,labelFont:(ij?"15":"12")+"px arial, sans-serif",widgetIndent:ij?30:20,widgetRowHeight:ij?30:20,widgetHeaderHeight:ij?32:22,widgetTitleHeight:ij?34:24,scrollBarColor:Gf,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:ij?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Or,intersectionLineLine:Xo,isEnter:np,isEsc:Gr,isDelete:Po,isSpace:Dj,isLeft:tg,isUp:Oo,isRight:od,isDown:jn,getTarget:nq,isString:tq,isNumber:Vc,isBoolean:tl,isArray:qf,isSelectAll:Bn,isFunction:Ad,isObject:as,getPropertyValue:ms,setPropertyValue:Sq,addMethod:og,getVersion:function(){return"7.0.7"},isMobile:function(){var G;return function(){return G!==i?G:(G=!1,function(C){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(C)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(C.substr(0,4)))&&(G=!0)}(navigator.userAgent||navigator.vendor||u.opera),G)}}(),createGradient:function(M,B,i,W,b,k,q,d){var J=Qj[B];return J(M,i,W,b,k,q,d)},appendToScreen:function(k){k=k.getView?k.getView():k,(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement||j.body).appendChild(k)},encodeString:function(N){return v.Math.encodeBase64(N,C.encodeStringKey)},decodeString:function(I){return v.Math.decodeBase64(I,C.encodeStringKey)},findView:function(z){var W=function(D,_){var s=_._ht;s&&D.push(s);var R=_.children,P=R.length;if(P)for(var Y=0;P>Y;Y++)W(D,R[Y])},g=[];W(g,j.body);var d=function(v,O){for(var K="2d"===O?yg.GraphView:rj.Graph3dView,J=0,C=v.length;C>J;J++)if(v[J]instanceof K)return g[J];return null};return"all"===z?g:"2d"===z?d(g,"2d"):"3d"===z?d(g,"3d"):d(g,"3d")||d(g,"2d")},toggleFullscreen:function(K){var P=K.getView();if(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement)j.exitFullscreen?j.exitFullscreen():j.msExitFullscreen?j.msExitFullscreen():j.mozCancelFullScreen?j.mozCancelFullScreen():j.webkitExitFullscreen&&j.webkitExitFullscreen();else{var Q=!0;if(K.isSelfViewEvent){var L=K.getX(),w=K.getY(),H=K.getWidth(),p=K.getHeight(),V=P.style.background,e=P.style.backgroundColor;V||e||(P.style.backgroundColor="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var q=setInterval(function(){if(P!==(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement))clearInterval(q),K.setX(L),K.setY(w),K.setWidth(H),K.setHeight(p),K._fullscreen=!1,P.style.oldBackgroundColor=e,K.iv();else{var U=v.Default.getWindowInfo();(Q||U.width!==K.getWidth()||U.height!==K.getHeight())&&(K.setX(U.left),K.setY(U.top),K.setWidth(U.width),K.setHeight(U.height),K._fullscreen=!0,K.iv(),Q=!1)}},500)}else{var f=P.style.left,d=P.style.top,H=P.style.width,p=P.style.height,V=P.style.background,e=P.style.backgroundColor;V||e||(P.style.backgroundColor="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var q=setInterval(function(){if(P!==(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement))clearInterval(q),P.style.left=f,P.style.top=d,P.style.width=H,P.style.height=p,P.style.oldBackgroundColor=e,K.iv();else{var x=v.Default.getWindowInfo();(Q||x.width!==K.getWidth()||x.height!==K.getHeight())&&(Wp(K),Q=!1)}},500)}}},appendTimeStamp:function(v){return v},setCompType:function(I,K){Ad(K)||as(K)?$o[I]=K:Ai(I)},getCompType:function(G){var p=$o[G];return p===i&&Kg.test(G)&&Ai(G),p},getCompTypeMap:function(){return $o},drawCompType:function(w,D,v,x,S,u){w(D,v,x,S,u)},numberListener:function(){var h={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(s){var y=s.keyCode;h[y]||65===y&&C.isCtrlDown(s)||86===y&&C.isCtrlDown(s)||67===y&&C.isCtrlDown(s)||88===y&&C.isCtrlDown(s)||y>=35&&40>=y||(s.shiftKey||48>y||y>57)&&(96>y||y>105)&&s.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(w){var H=w.target.tagName;("DIV"===H||"CANVAS"===H)&&!(C.ignoreKeyCodes.indexOf(w.keyCode)>=0)&&("keydown"!==w.type||tg(w)||od(w)||Oo(w)||jn(w)||Po(w)||65===w.keyCode&&(w.metaKey||w.ctrlKey))&&(w.preventDefault(),w.preventManipulation&&w.preventManipulation())},getWindowInfo:function(){var b=j.documentElement,w=b&&(b.scrollLeft||b.scrollTop)?b:j.body;return{target:w,left:w.scrollLeft,top:w.scrollTop,width:u.innerWidth||w.clientWidth,height:u.innerHeight||w.clientHeight}},isDragging:function(){return!!Bb},isLeftButton:function(d){return ij?!0:0===d.button},isMiddleButton:function(F){return ij?!1:F&&(1===F.button||4&(F.buttons||0))},isRightButton:function(M){return ij?!1:M&&(2===M.button||2&(M.buttons||0))},isInput:function(T){if(!T)return!1;var E=T.tagName;return"INPUT"===E||"TEXTAREA"===E||"SELECT"===E},getTouchCount:function(l){return ij?l.touches.length:1},isDoubleClick:function(){function s(i){i.details=0,i.timeout=null,i.lastPoint=null}var b={};return Vq=new n,Li=Vq.getTime(),function(D){if(D.touches&&D.touches.length>1)return!1;var O=D.button==w?"":D.button,j=D.type+O,V=j+"_isDoubleClick",a=b[j];if(a||(a=b[j]={details:0,timeout:null,lastPoint:null}),D[V]===i){D[V]=!0;var I=Io(D);a.timeout&&(f(a.timeout),a.timeout=null),a.lastPoint&&Sp(a.lastPoint,I)>C.doubleClickRange&&s(a),a.lastPoint=I,a.details++,a.timeout=_(function(){s(this)}.bind(a),500)}return 2===a.details}}(),isShiftDown:function(C){return C?C.shiftKey:dj["16"]},isCtrlDown:function(G){return G?Dk?G.metaKey:G.ctrlKey:Dk?dj["91"]:dj["17"]},getClientPoint:function(D){return ij&&(D=ds(D)),{x:D.clientX,y:D.clientY}},isMouseEvent:function(Q){return Q instanceof MouseEvent||0===Q.type.indexOf("mouse")},getTargetElement:function(L){if(C.isMouseEvent(L)||!j.elementFromPoint)return L.target;var t=Im(L);return j.elementFromPoint(t.x,t.y)},getPagePoint:function(D){return ij&&(D=ds(D)),{x:D.pageX,y:D.pageY}},createObject:function(F,b){var q=new F;for(var W in b){var D=b[W];if(Ad(D))q[W]=D;else if(0===W.indexOf("s:"))q.s(W.substr(2),b[W]);else if(0===W.indexOf("a:"))q.a(W.substr(2),b[W]);else{var t=Mj(W),D=b[W];q[t]?(q[t](D),"setToolTip"===t&&q.enableToolTip&&q.enableToolTip()):q[W]=D}}return q},setImage:function(V,B,n,f){var O=arguments.length;4===O?qi(V,f,B,n):2===O?tq(B)?qi(V,B):_d(V,B):1===O&&qi(V,V)},getImage:function(y,K,J){var O;if(y==w)return w;if(as(y)?O=y:(O=zm[y],y&&O===i&&(ob&&ob[y]||qi(y,y))),K&&O&&O.tagName){var N;N="override"===J?"colors_override":"override_rgb"===J?"colors_override_rgb":"override_a"===J?"colors_override_a":"colors",O[N]||(O[N]={__count__:0});var r=O[N][K];return r||(O[N].__count__>C.imageCacheThreshold&&(O[N]={__count__:0}),r=lo(O,_g(K),O.width,O.height,J),O[N][K]=r,O[N].__count__++),r}return O},isImageComplete:function(f,D,A){var u=Mf(f);if(!u)return!1;if(u.tagName)return u.complete;for(var E,f,O,P=u.comps,s=!0,W=0,U=P.length;U>W;W++)if(E=P[W],O=E.type,"image"===E.type){f=E.name,f&&f.func&&(f=mo(f,D));var V=Tb(f,D,A);if(!V){s=!1;break}}else if(Kg.test(O)&&C.getCompType(O)===i){s=!1,Ai(O);break}return s},getId:function(){var D=1;return function(){return++D}}(),callLater:function(N,U,B,G){var p=function(){N.apply(U,B)};return G?_(p,G):u.requestAnimationFrame(p)},cancelLater:function(F,B){B?f(F):u.cancelAnimationFrame(F)},clone:function(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var S=new Date;return S.setTime(t.getTime()),S}if(t instanceof Array){for(var S=[],c=0,B=t.length;B>c;c++)S[c]=Tk(t[c]);return S}if(t instanceof Pb){for(var S=new Pb,c=0,B=t.length;B>c;c++)S.set(c,Tk(t.get(c)));return S}if(t instanceof ji)return t;if(t instanceof I){var S={};for(var W in t)t.hasOwnProperty(W)&&(S[W]=Tk(t[W]));return S}return t},callWhenLoaded:function(c,P){P=P||100;var A=kf(c,P);Mn||(Mn={}),Mn[A]={tick:A,cb:c,delay:P}},beforeLoadURL:function(U){if(Mn){var A={};for(var n in Mn){var P=Mn[n];f(P.tick);var Z=kf(P.cb,P.delay);A[Z]={tick:Z,delay:P.delay,cb:P.cb}}Mn=A}return C.convertURL?C.convertURL(U):U},convertURL:function(_){return _},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return C.getImage("default_blank")},resizeImagePOT:function(L,v){if(!L||!L.tagName)return L;var e=L.width,y=L.height;if(!e||!y)return L;if(No.isPOT(e)&&No.isPOT(y)&&(!v||e===y))return L;var l,t;v?t=l=No.nearestPOT(Math.min(e,y)):(l=No.nearestPOT(e),t=No.nearestPOT(y));var H=$f(),g=H.getContext("2d");return vf(H,l,t,1),g.drawImage(L,0,0,e,y,0,0,l,t),H},sortFunc:function(F,l){if(F===l)return 0;if(F==w&&l!=w)return 1;if(F!=w&&l==w)return-1;if(F==w&&l==w)return 0;var $,f=typeof F,X=typeof l;return f===ai&&X===ai?$=F.localeCompare(l):f===jd&&X===jd&&($=F-l),$===i&&($=(""+F).localeCompare(""+l)),$>0?1:0>$?-1:0},getClassMap:function(){return Pp},getClass:function(n){if(tq(n)){var l,m=Pp[n];if(!m){l=n.split("."),m=u;for(var N=0;N<l.length;N++)m=m[l[N]];Pp[n]=m}return m}return n},def:function(m,q,A){var l,G,o,N=function(){};if(N.prototype=q.prototype,l=new N,tq(m)){if(Pp[m])throw"'"+m+"' already defined";o=As(m),l.getClassName=function(){return m}}else o=m;if(l.constructor=o,l.getClass=function(){return o},l.getSuperClass=function(){return q},A)for(G in A)Ib[G]&&Ib.hasOwnProperty(G)?Ib[G](l,A):xm(l,A,G);o.prototype=l,o.superClass=q.prototype},startAnim:function(){var d=function(k){k.duration&&(k.startTime=Vb()),k.timeId=Ao(k.tick,w,w,k.interval)};return function(D){return D=Tk(D),D.easing=D.easing||C.animEasing,D.duration||D.frames||(D.duration=C.animDuration),D.t=0,D.duration?D.interval=0:(D.frame=0,D.interval=D.interval||10),D.tick=function(){if(D.duration){var K=(Vb()-D.startTime)/D.duration;if(K>1&&(K=1),D.t=K,D.action(D.easing(K),K),!D.isRunning())return;1===K?D.stop():D._isPaused||(D.timeId=Ao(D.tick))}else{if(D.frame++,K=D.t=D.frame/D.frames,D.action(D.easing(K),K),!D.isRunning())return;D.frame<D.frames?D._isPaused||(D.timeId=Ao(D.tick,w,w,D.interval)):D.stop()}},D.resume=function(){D._isPaused&&(delete D._isPaused,D.duration?D.t<1&&(D.startTime=Vb()-D.duration*D.t,D.timeId=Ao(D.tick)):D.frame<D.frames&&(D.timeId=Ao(D.tick,w,w,D.interval)))},D.pause=function(){ei(D.timeId,!D.duration),D._isPaused=!0},D.isPaused=function(){return this._isPaused},D.stop=function(Q){D.isRunning()&&(ei(D.timeId,!D.duration),delete D.timeId,D.duration?D.t<1&&Q&&(D.t=1,D.action(D.easing(1),1)):D.frame<D.frames&&Q&&(D.frame=D.frames,D.action(D.easing(1),1)),D._37o&&D._37o(),D.finishFunc&&D.finishFunc())},D.isRunning=function(){return D.timeId!=w},D.delay?Ao(d,w,[D],D.delay):d(D),D}}(),getTextSize:function(){var g={},o=j?$f().getContext("2d"):w;return function(H,G){o.font=H?H:Eo;var N=g[o.font];return N||(N=2*o.measureText("e").width+4,g[o.font]=N),{width:o.measureText(G).width+4,height:N}}}(),drawText:function(b,F,m,x,c,r,f,V,A,E){if(F!=w){var O=Sk(m,F),s={};s.y=E&&E!==rq?E===Gh?r+O.height/2:r+V-O.height/2:r+V/2,s.x=A&&A!==Nh?A===He?c+f-O.width/2:c+f/2:c+O.width/2,Ii(b,F,s,m,x)}},getDistance:function(m,X){var d=m.length;return X?3===d?Z(o(m[0]-X[0])+o(m[1]-X[1])+o(m[2]-X[2])):2===d?Z(o(m[0]-X[0])+o(m[1]-X[1])):m.z===i?Z(o(X.x-m.x)+o(X.y-m.y)):Z(o(X.x-m.x)+o(X.y-m.y)+o(X.z-m.z)):3===d?Z(o(m[0])+o(m[1])+o(m[2])):2===d?Z(o(m[0])+o(m[1])):void 0},brighter:function(P,p){return 0>p&&(p=-p),Mq(P,p?p:40)},darker:function(A,J){return J>0&&(J=-J),Mq(A,J?J:-40)},unionPoint:function(E,s){if(!E)return w;if(2===arguments.length)return E&&s?{x:V(E.x,s.x),y:V(E.y,s.y),width:l(E.x-s.x),height:l(E.y-s.y)}:w;var Y=E;if(Y._as&&(Y=Y._as),Y.length===i)return w;var M=Y.length;if(0>=M)return w;for(var y=1,m=Y[0],C={x:m.x,y:m.y,width:0,height:0};M>y;y++){m=Y[y];var T=V(C.x,m.x),c=H(C.x+C.width,m.x),I=V(C.y,m.y),z=H(C.y+C.height,m.y);C.x=T,C.y=I,C.width=c-T,C.height=z-I}return C},unionRect:function(n,F){if(n&&!F)return Tk(n);if(!n&&F)return Tk(F);if(n&&F){var R={x:V(n.x,F.x),y:V(n.y,F.y)};return R.width=H(n.x+n.width,F.x+F.width)-R.x,R.height=H(n.y+n.height,F.y+F.height)-R.y,R}return w},containsPoint:function(c,O,D,e){if(e!=w&&1!==e){var _=c.x+c.width/2,A=c.y+c.height/2;c={x:_-c.width/2*e,y:A-c.height/2*e,width:c.width*e,height:c.height*e}}if(D){var U=c.width/2,k=c.height/2,C=y(-D),o=b(-D),h=O.x-c.x-U,i=O.y-c.y-k;return O={x:o*h-C*i,y:C*h+o*i},gg({x:-U,y:-k,width:c.width,height:c.height},O)}return!(!c||O.x<c.x||O.y<c.y||O.x>c.x+c.width||O.y>c.y+c.height)},containsRect:function(u,M){if(!u||!M)return!1;var x=M.x,v=M.y,h=M.width,X=M.height,d=u.width,e=u.height;if(0>(d|e|h|X))return!1;var o=u.x,z=u.y;if(o>x||z>v)return!1;if(d+=o,h+=x,x>=h){if(d>=o||h>d)return!1}else if(d>=o&&h>d)return!1;if(e+=z,X+=v,v>=X){if(e>=z||X>e)return!1}else if(e>=z&&X>e)return!1;return!0},intersectsRect:function(n,X){if(!n||!X)return!1;var b=X.width,U=X.height,E=n.width,h=n.height;if(0>=E||0>=h||0>=b||0>=U)return!1;var Z=X.x,H=X.y,f=n.x,Q=n.y;return E+=f,h+=Q,b+=Z,U+=H,E>Z&&h>H&&b>f&&U>Q},intersection:function(L,Q){if(!L||!Q)return w;var r=Q.x,b=Q.y,G=L.x,a=L.y,T=r,j=b,V=G,Z=a;return T+=Q.width,j+=Q.height,V+=L.width,Z+=L.height,G>r&&(r=G),a>b&&(b=a),T>V&&(T=V),j>Z&&(j=Z),T-=r,j-=b,0>=T||0>=j?w:{x:r,y:b,width:T,height:j}},grow:function(W,Q,g){g===i&&(g=Q),W.x-=Q,W.y-=g,W.width=W.width+2*Q,W.height=W.height+2*g},getScreenPoint:function(i,K,Q,E,S,Y,d){var A=Q.getBoundingClientRect(),p=i*(Y||1)-Q.scrollLeft+(E||0),l=K*(d||1)-Q.scrollTop+(S||0),M=Yi(Q,!1);if(M){var $=new Jb(p,l,0);return $.applyMatrix4(M),console.log($),{x:$.x,y:$.y}}return{x:p+A.left,y:l+A.top}},getLogicalPoint:function(J,w,$,e,z,d){var W,B,m=w.getBoundingClientRect();J.target?(_n(J)?Dk?dj["91"]=!0:dj["17"]=!0:Dk?dj["91"]=!1:dj["17"]=!1,dj["16"]=Hh(J)?!0:!1,J=ij?ds(J):J,W=J.clientX,B=J.clientY):(W=J.x,B=J.y);var Z=Yi(w,!0);if(Z){var O=new Jb(W,B,0);O.applyMatrix4(Z);do{if(Math.abs(O.z)<=1e-6)break;var I=new Jb(W,B,1);if(I.applyMatrix4(matrix),Math.abs(I.z)<=1e-6){O=I;break}if(I.sub(O),Math.abs(I.z)<=1e-6)break;O.addScaledVector(I,-O.z/I.z)}while(!1);return{x:(O.x+w.scrollLeft-($||0))/(z||1),y:(O.y+w.scrollTop-(e||0))/(d||1)}}return{x:(W-m.left+w.scrollLeft-($||0))/(z||1),y:(B-m.top+w.scrollTop-(e||0))/(d||1)}},removeHTML:function(){var v;return function(E){return E&&E.getView&&(E=E.getView()),E&&E.parentNode?v===E?!0:(v=E,E.parentNode.removeChild(E),v=w,!0):!1}}(),getToolTipDiv:function(){if(!Ml){Ml=xl(),de=xl();var L=Ml.style;C.baseZIndex!=w&&(L.zIndex=a(C.baseZIndex)+3+""),L.whiteSpace="nowrap",L.color=C.toolTipLabelColor,L.background=C.toolTipBackground,L.font=C.toolTipLabelFont,L.padding="5px",L.boxShadow="0px 0px 3px "+C.toolTipShadowColor}return Ml},isToolTipShowing:function(){return Ml&&Ml.parentNode?!0:de&&de.parentNode?!0:!1},hideToolTip:function(){ck(Ml),ck(de),Kh()},showToolTip:function(U,k){if(!U||k==w)return yp(),void 0;C.getToolTipDiv();var X,D;if(k.html?(k=k.html,X=de,ck(Ml)):(X=Ml,ck(de)),D=X.style,X.innerHTML=k,X.parentNode||v.Default.appendToScreen(X),U.target){U=Im(U);var i=Je(),S=U.x,b=U.y,p=ij?60:12;if(ij){var j=X.getBoundingClientRect();D.left=S-j.width/2+Ih,D.top=b-j.height-p<i.top?b+p+Ih:b-j.height-p+Ih}else{D.left=S+p+Ih,D.top=b+p+Ih;var j=X.getBoundingClientRect();j.left+j.width>i.width&&(D.left=S-p-j.width+Ih),j.top+j.height>i.height&&(D.top=b-p-j.height+Ih),j.left<0&&(D.left=S+p+Ih),j.top<0&&(D.top=b+p+Ih)}}else D.left=U.x+Ih,D.top=U.y+Ih;Kh()},startDragging:function(k,p,C){C==i&&(C=!0),k!==Bb&&(Bb?C&&(ij?Bb.handleWindowTouchEnd(p):Bb.handleWindowMouseUp(p)):ij?(X(u,hm,Hi),X(u,ki,Sd)):(X(u,Rg,oh),X(u,cc,wo)),Bb=k)},getImageMap:function(){return zm},toBoundaries:function(o,v,L,_){var O=[];return mm(o,v,L,_).forEach(function(y){var V=[];y.forEach(function(D){V.push(D.x,D.y)}),O.push(V)}),O},getCurrentKeyCodeMap:function(){return dj},drawCenterImage:function(v,O,I,U,t,y,e,E){!t&&y&&y.isSelfViewEvent&&(t=y);var Y=Xk(O,t,y),r=Dg(O,t,y);lh(v,O,J(I-Y/2),J(U-r/2),Y,r,t,y,e,E)},drawStretchImage:function(X,r,T,v,E,O,t,Z,z,$,b,S){!Z&&z&&z.isSelfViewEvent&&(Z=z);var y,i=Xk(r,Z,z,O),j=Dg(r,Z,z,t);"uniform"===T?(y=V(O/i,t/j),i*=y,j*=y,v+=J((O-i)/2),E+=J((t-j)/2),O=i,t=j):"centerUniform"===T&&((i>O||j>t)&&(y=V(O/i,t/j),i*=y,j*=y),v+=J((O-i)/2),E+=J((t-j)/2),O=i,t=j);var K=X.interactiveInfo;if(K){var p;if(p="center"===T?{x:v+O/2-i/2,y:E+t/2-j/2,width:i,height:j}:{x:v,y:E,width:O,height:t},K.rect){var H=K.compInfos,k=H.length;k&&(H[k-1].rect.image=r)}else K.rect=p}if("center"===T){var Y=b!==!1&&(i>O||j>t);Y&&(X.save(),X.beginPath(),X.rect(v,E,O,t),X.clip()),lh(X,r,v+O/2-i/2,E+t/2-j/2,i,j,Z,z,$,S),Y&&X.restore()}else lh(X,r,v,E,O,t,Z,z,$,S)},toCanvas:function(e,b,H,L,I,B,W,V,M){e=Mf(e,W),b=b||Xk(e,I),H=H||Dg(e,I);var N=$f(),K=Xl(N);return V?(vf(N,b,H,V),K.scale(V,V)):vf(N,b,H,1),nd(K,e,L,0,0,b,H,I,B,W,M),e&&e.clampToEdge&&(N.clampToEdge=e.clampToEdge),K.restore(),N},toGrayColor:function(k){if(!k)return k;var h=Jf(k),L=J(.299*h[0]+.587*h[1]+.114*h[2]);return"rgba("+L+","+L+","+L+","+h[3]/255+")"},createGradientImage:function(o,c,b,V){for(var X=["L",0,0,o,0,1,0,0,1,0,0],G=0,S=Math.min(c.length,b.length);S>G;G++)X.push(b[G],c[G]);var Z=v.Default.toCanvas({width:o,height:o,clampToEdge:!0,comps:[{type:"shape",rotation:V||0,points:[0,0,o,0,o,o,0,o],background:"#ffffff",gradientPack:X}]});return Z},createElement:function(W,M,$,f){var n=j.createElement(W);return cs(n,M||E.widgetBorder,2),n.style.font=$?$:Eo,f!=w&&(n.value=f),C.onElementCreated&&C.onElementCreated(n),n},containedInView:function(a,e){var k=Jg(e).getBoundingClientRect();return gg({x:k.left,y:k.top,width:k.width,height:k.height},Io(a))},isIsolating:function(){return wl>0},setIsolating:function(y){y?wl++:wl--},getMSMap:function(){return Ib},stringify:function(q,N,A){var _=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var B=JSON.stringify(q,function(J,l){return"function"==typeof l?"__ht__"+(l.__ht__||l.toString()):Vc(l)?ps(l):l instanceof v.List?"__ht__list"+(l.__ht__list||C.stringify(l._as)):l},N==w?2:N);return Date.prototype.toJSON=_,A&&(B="__ht__encode"+C.encodeString(B)),B},parse:function(m){return tq(m)?"__ht__encode"!=m.substr(0,12)||(m=C.decodeString(m.substr(12)),tq(m))?JSON.parse(m,function(t,v){if(tq(v))if("__ht__function"==v.substr(0,14)){var u=v.indexOf("{")+1,i=v.lastIndexOf("}"),F=v.indexOf("(")+1,O=v.indexOf(")");if(u&&i&&F&&O){var X=new Function(v.substring(F,O),v.substring(u,i));return X.__ht__=v.substr(6),X}}else{if("__ht__date"==v.substr(0,10))return new Date(a(v.substr(10)));if("__ht__list"===v.substr(0,10))return new Pb(C.parse(v.substr(10)))}return v}):m:m},loadJS:function(d,O){O&&d.push(O);var G=d.shift();if(qf(G))d=G.contact(d),C.loadJS(d);else if(Ad(G))G(),C.loadJS(d);else if(tq(G)){var V=j.createElement("script");V.onload=function(){C.loadJS(d)},V.setAttribute("src",G),j.getElementsByTagName("head")[0].appendChild(V)}else d.length&&C.loadJS(d)},toRoundedCorner:function(){function k(C,u,f){C.x=u.x,C.y=u.e||f,C.z=u.y}var t=new Jb,_=new Jb,A=new Jb,I=new Jb;return function(z,l){var Q,R=0;z.getPoints&&(R=z.getElevation(),z=z.getPoints()),Q=z instanceof Pb?z:new Pb(z);var c=Q.size();if(0>=l)return{points:Q};var T=new Pb,K=new Pb,L=Q.get(0);k(t,L,R),T.add(L),K.add(1);for(var r=1;c>r;r++)if(c>r+1){var B=Q.get(r),p=Q.get(r+1);k(_,B,R),k(A,p,R),I.subVectors(t,_).setLength(Math.min(.99*I.length(),l)).add(_),B.e!==i||L.e!==i?T.add({x:I.x,y:I.z,e:I.y}):T.add({x:I.x,y:I.z}),T.add(B),I.subVectors(A,_).setLength(Math.min(.99*I.length(),l)).add(_),B.e!==i||p.e!==i?T.add(L={x:I.x,y:I.z,e:I.y}):T.add(L={x:I.x,y:I.z}),t.copy(I),K.addAll([2,3])}else T.add(Q.get(r)),K.add(2);return{points:T,segments:K}}}(),toColorData:Jf,setCanvas:vf,createDiv:xl,createDisabledDiv:Wg,createView:pf,createCanvas:$f,appendChild:Pj,initContext:Xl,checkLoadingImage:Ab,translateAndScale:Md,layout:Wp,getPosition:vb,drawPoints:Vr,drawRoundRect:Hp,drawBorder:Zh,setFocus:Rc,getter:Mo,setter:Mj,isEmptyObject:si,cameraPriority:function(){var r={skybox:0,main:1e4,top:1e7};return I.seal(I.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return r.skybox},set:function(w){if(w>=r.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");r.skybox=Number(w)}},main:{configurable:!1,enumerable:!1,get:function(){return r.main},set:function(j){if(j<=r.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(j>=r.top)throw new RangeError("Main camera must have lower priority than the top camera.");r.main=Number(j)}},top:{configurable:!1,enumerable:!1,get:function(){return r.top},set:function(D){if(D<=r.main)throw new RangeError("Top camera must have higher priority than the main camera.");r.top=Number(D)}}}))}()},!0),og(U,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Uf=C.disabledOpacity,eh=C.toolTipDelay,re=C.devicePixelRatio,ac=C.autoMakeVisible,se=C.autoHideScrollBar,Yc=C.imageGradient,$k=C.showToolTip,yp=C.hideToolTip,mg=C.dashPattern,gd=C.lineCap,to=C.lineJoin,Ji=C.labelColor,$m=C.labelSelectColor,Eo=C.labelFont,rs=C.widgetIndent,ao=C.widgetRowHeight,kr=C.widgetHeaderHeight,Rm=C.widgetTitleHeight,ui=C.scrollBarColor,sp=C.scrollBarSize,vd=C.scrollBarTimeout,Jh=C.scrollBarMinLength,jk=C.scrollBarInteractiveSize,$d=C.zoomIncrement,er=C.scrollZoomIncrement,bj=C.pinchZoomIncrement,yl=C.zoomMax,sm=C.zoomMin,ep=C.createObject,jm=C.preventDefault,Yb=C.setImage,Mf=C.getImage,Tb=C.isImageComplete,ko=C.drawCenterImage,nd=C.drawStretchImage,Og=C.getId,Ao=C.callLater,ei=C.cancelLater,xr=C.sortFunc,Tk=C.clone,As=C.getClass,ar=C.startAnim,Ro=C.brighter,_m=C.darker,gb=C.drawText,Sk=C.getTextSize,Lg=C.isLeftButton,yi=C.isMiddleButton,Gp=C.isRightButton,bs=C.getTouchCount,Bo=C.isDoubleClick,Hh=C.isShiftDown,_n=C.isCtrlDown,Io=C.getClientPoint,Im=C.getPagePoint,Sp=C.getDistance,ye=C.unionPoint,fj=C.unionRect,gg=C.containsPoint,mb=C.containsRect,qn=C.intersectsRect,lj=C.intersection,Je=C.getWindowInfo,Cc=C.grow,ii=C.getLogicalPoint,ss=C.getScreenPoint,Yl=C.startDragging,ck=C.removeHTML,Hj=C.createElement,uf=C.segmentResolution,Ld=C.shapeResolution,Zn=C.shapeSide,vo=C.def,zc=function(v,b,D){vo(K+"."+v,b,D)
},ad=function(g,L){g.childNodes.forEach(function(J){L(J),ad(J,L)})};og(C,{toolTipLabelColor:Ji,toolTipLabelFont:Eo,toolTipBackground:E.toolTipBackground,toolTipShadowColor:Gf,drawBreakableText:Xr,setDevicePixelRatio:function(A){re=C.devicePixelRatio="number"==typeof A?A:u.devicePixelRatio,ad(j.body,function(Y){var l=Y._ht;l&&l._canvas&&(vf(l._canvas,l.getWidth(),l.getHeight()),l.redraw?l.redraw():l.iv())})}},!0);var oc=1e-6,Kf="undefined"!=typeof Uint16Array?Uint16Array:Array,Ud="undefined"!=typeof Float32Array?Float32Array:Array,jp=function(s,S,$){var M=[s[0]-S[0],s[1]-S[1],s[2]-S[2]];if($){var d=Sp(M);d>0&&(M[0]/=d,M[1]/=d,M[2]/=d)}return M},cm=function(){var Z="charCodeAt",h=2*(2*We.length+1);for(var R in u)if(R===K+Nh[0]+(Ih.length+2)){var q=u[R];if(!q)break;for(var B=q.length,$=0;B>$;$++)if(q[$][Z](0)===h&&q[$+1]!=w&&q[$+1]===Ih[0]&&q[$+2]!=w&&q[$+2][Z](0)===h){for(var E=$+3;B>E;E++)if(q[E][Z](0)===h){if(0==q[E+1])for(var e,d=E+2;B>d;d++){if(q[d][Z](0)===h){0==q[d-1]&&e&&(Gb=e.substr(0,e.length-1));break}e==w?e=q[d]:e+=q[d]}break}break}break}return function($){return[-$[0],-$[1],-$[2]]}}(),xq=function(W,J){return 3===W.length?W[0]*J[0]+W[1]*J[1]+W[2]*J[2]:W[0]*J[0]+W[1]*J[1]},Kr=function(){var n=new Ud(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},fc=Kr(),Ef=function(S){var o=new Ud(16);return o[0]=S[0],o[1]=S[1],o[2]=S[2],o[3]=S[3],o[4]=S[4],o[5]=S[5],o[6]=S[6],o[7]=S[7],o[8]=S[8],o[9]=S[9],o[10]=S[10],o[11]=S[11],o[12]=S[12],o[13]=S[13],o[14]=S[14],o[15]=S[15],o},sb=function(Q,s){return Q[0]=s[0],Q[1]=s[1],Q[2]=s[2],Q[3]=s[3],Q[4]=s[4],Q[5]=s[5],Q[6]=s[6],Q[7]=s[7],Q[8]=s[8],Q[9]=s[9],Q[10]=s[10],Q[11]=s[11],Q[12]=s[12],Q[13]=s[13],Q[14]=s[14],Q[15]=s[15],Q},Wi=function(I){return I[0]=1,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=1,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=1,I[11]=0,I[12]=0,I[13]=0,I[14]=0,I[15]=1,I},Vl=function(c,U){var O=c[0],G=c[1],b=c[2];return c[0]=U[0]*O+U[4]*G+U[8]*b+U[12],c[1]=U[1]*O+U[5]*G+U[9]*b+U[13],c[2]=U[2]*O+U[6]*G+U[10]*b+U[14],c},mj=function(s,y){var c=s[0],U=s[1],R=s[2],f=s[3];return s[0]=y[0]*c+y[4]*U+y[8]*R+y[12]*f,s[1]=y[1]*c+y[5]*U+y[9]*R+y[13]*f,s[2]=y[2]*c+y[6]*U+y[10]*R+y[14]*f,s[3]=y[3]*c+y[7]*U+y[11]*R+y[15]*f,s},$g=function(){var o,c,z,x,G=Gl(Hm[1]+Hm[7]),S=Gl(Hm[0]+Hm[3]-Hm[10]),l=Gl(Hm[8]+2),R=function(){return c=z.charAt(o),o+=1,c},K=function(){var J="";if(c===l)for(;R();){if(c===l)return R(),J;J+=c}else R()},U=function(){for(;c&&" ">=c;)R()},$=function(){var o,k={};if(c===G){if(R(),U(),c===S)return R(),k;for(;c;){if(o=K(),U(),R(),k[o]=x(),U(),c===S)return R(),k;R(),U()}}};return x=function(){switch(U(),c){case G:return $();default:return K()}},function(g){if(F={},g){var d;if(z=g,o=0,c=" ",d=x(),U(),!c)return d}}}(),pm=function(z,l){if(l){var U=y(l),V=b(l),j=z[4],C=z[5],q=z[6],L=z[7],n=z[8],T=z[9],A=z[10],u=z[11];z[4]=j*V+n*U,z[5]=C*V+T*U,z[6]=q*V+A*U,z[7]=L*V+u*U,z[8]=n*V-j*U,z[9]=T*V-C*U,z[10]=A*V-q*U,z[11]=u*V-L*U}},hr=function(s,R){if(R){var M=y(R),L=b(R),A=s[0],_=s[1],r=s[2],W=s[3],m=s[8],S=s[9],C=s[10],T=s[11];s[0]=A*L-m*M,s[1]=_*L-S*M,s[2]=r*L-C*M,s[3]=W*L-T*M,s[8]=A*M+m*L,s[9]=_*M+S*L,s[10]=r*M+C*L,s[11]=W*M+T*L}},Yn=function(Z,N){if(N){var f=y(N),l=b(N),D=Z[0],i=Z[1],L=Z[2],v=Z[3],E=Z[4],O=Z[5],u=Z[6],c=Z[7];Z[0]=D*l+E*f,Z[1]=i*l+O*f,Z[2]=L*l+u*f,Z[3]=v*l+c*f,Z[4]=E*l-D*f,Z[5]=O*l-i*f,Z[6]=u*l-L*f,Z[7]=c*l-v*f}},sf=function(m,G,c){return Xb(w,c===!1?w:m.getFinalScale3d(),m.getFinalRotation3d(),m.getRotationMode(),m.p3(),w,G)},Xb=function(M,o,t,k,e,f,O){return f||(f=Kr()),e&&Hd(f,e),Oh(f,t,k),O&&qo(f,f,O),o&&Ko(f,o),M&&qo(f,f,M),f},Hq=function(c,q,W){q=a(q),W=a(W);var z=this;z.g=c,z._84O=q,z._85O=W,z._70I=!0,z.F=0,z._83O=q+W,z.pen={x:0,y:0}},al="lineDashOffset",zd="setLineDash",ah=function(K){for(var H in K)1===H.length&&(al=K[H]);return H?1:0},jq=function(e,G,N){return vi(G)?e:e[zd]?(e[zd](G),N&&(e.lineDashOffset=N),e):new Hq(e,G[0],G.length>1?G[1]:G[0])},sd=function(C,A){!vi(A)&&C[zd]&&(C[zd](Qr),C.lineDashOffset=0)};if(vo(Hq,I,{_69I:6,moveTo:function(F,v){var r=this,I=r.pen;I.x=F,I.y=v,r.g.moveTo(F,v),r.start||(r.start={x:F,y:v})},lineTo:function(d,O){var V=this,t=V.pen,B=d-t.x,Z=O-t.y,n=T(Z,B),L=b(n),w=y(n),u=V._23O(t.x,t.y,d,O),s=V._85O,l=V._84O,C=V._83O;if(V.F){if(V.F>u)return V._70I?V._72I(d,O):V.moveTo(d,O),V.F-=u,void 0;if(V._70I?V._72I(t.x+L*V.F,t.y+w*V.F):V.moveTo(t.x+L*V.F,t.y+w*V.F),u-=V.F,V.F=0,V._70I=!V._70I,!u)return}var a=p(u/C);if(a){for(var z=L*l,U=w*l,$=L*s,E=w*s,k=0;a>k;k++)V._70I?(V._72I(t.x+z,t.y+U),V.moveTo(t.x+$,t.y+E)):(V.moveTo(t.x+$,t.y+E),V._72I(t.x+z,t.y+U));u-=C*a}V._70I?u>l?(V._72I(t.x+L*l,t.y+w*l),V.moveTo(d,O),V.F=s-(u-l),V._70I=!1):(V._72I(d,O),u===l?(V.F=0,V._70I=!V._70I):(V.F=l-u,V.moveTo(d,O))):u>s?(V.moveTo(t.x+L*s,t.y+w*s),V._72I(d,O),V.F=l-(u-s),V._70I=!0):(V.moveTo(d,O),u===s?(V.F=0,V._70I=!V._70I):V.F=s-u)},quadraticCurveTo:function(A,X,B,b){var E,N=this,w=N.pen,T=w.x,P=w.y,f=N._22O(T,P,A,X,B,b),j=0,U=0,h=N._85O,F=N._84O;if(N.F){if(N.F>f)return N._70I?N._71I(A,X,B,b):N.moveTo(B,b),N.F-=f,void 0;if(j=N.F/f,E=N._20O(T,P,A,X,B,b,j),N._70I?N._71I(E[2],E[3],E[4],E[5]):N.moveTo(E[4],E[5]),N.F=0,N._70I=!N._70I,!f)return}var n=f-f*j,G=p(n/N._83O),Y=F/f,_=h/f;if(G)for(var L=0;G>L;L++)N._70I?(U=j+Y,E=N._21O(T,P,A,X,B,b,j,U),N._71I(E[2],E[3],E[4],E[5]),j=U,U=j+_,E=N._21O(T,P,A,X,B,b,j,U),N.moveTo(E[4],E[5])):(U=j+_,E=N._21O(T,P,A,X,B,b,j,U),N.moveTo(E[4],E[5]),j=U,U=j+Y,E=N._21O(T,P,A,X,B,b,j,U),N._71I(E[2],E[3],E[4],E[5])),j=U;n=f-f*j,N._70I?n>F?(U=j+Y,E=N._21O(T,P,A,X,B,b,j,U),N._71I(E[2],E[3],E[4],E[5]),N.moveTo(B,b),N.F=h-(n-F),N._70I=!1):(E=N._19O(T,P,A,X,B,b,j),N._71I(E[2],E[3],E[4],E[5]),f===F?(N.F=0,N._70I=!N._70I):(N.F=F-n,N.moveTo(B,b))):n>h?(U=j+_,E=N._21O(T,P,A,X,B,b,j,U),N.moveTo(E[4],E[5]),E=N._19O(T,P,A,X,B,b,U),N._71I(E[2],E[3],E[4],E[5]),N.F=F-(n-h),N._70I=!0):(N.moveTo(B,b),n===h?(N.F=0,N._70I=!N._70I):N.F=h-n)},bezierCurveTo:function(){var T=arguments;this.pen={x:T[4],y:T[5]},this.g.bezierCurveTo(T[0],T[1],T[2],T[3],T[4],T[5])},arc:function(R,N,Z,v,q,g){g||(v=-v,q=-q),ng(this,R,N,v,q-v,Z,Z,!1)},rect:function(D,Y,s,o){var f=this;f.pen={x:D,y:Y},f.moveTo(D,Y),f.lineTo(D,Y+o),f.lineTo(D+s,Y+o),f.lineTo(D+s,Y),f.lineTo(D,Y)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(m,J,T,w){var u=T-m,s=w-J;return Z(u*u+s*s)},_22O:function(N,C,M,F,y,o,l){for(var $,h,V,S,k,J,z,W=0,Y=N,I=C,w=l>0?l:this._69I,O=1;w>=O;O++)V=O/w,S=1-V,k=S*S,J=2*V*S,z=V*V,$=k*N+J*M+z*y,h=k*C+J*F+z*o,W+=this._23O(Y,I,$,h),Y=$,I=h;return W},_21O:function(A,t,X,I,F,Y,P,k){var U=this;if(0===P)return U._20O(A,t,X,I,F,Y,k);if(1===k)return U._19O(A,t,X,I,F,Y,P);var n=U._20O(A,t,X,I,F,Y,k);return n.push(P/k),U._19O.apply(U,n)},_20O:function(H,c,X,k,W,m,j){if(1!==j){var f=X+(W-X)*j,t=k+(m-k)*j;X=H+(X-H)*j,k=c+(k-c)*j,W=X+(f-X)*j,m=k+(t-k)*j}return[H,c,X,k,W,m]},_19O:function(k,C,j,P,s,u,y){if(1!==y){var l=k+(j-k)*y,o=C+(P-C)*y;j+=(s-j)*y,P+=(u-P)*y,k=l+(j-l)*y,C=o+(P-o)*y}return[k,C,j,P,s,u]},_72I:function(C,T){var I=this.pen;(C!==I.x||T!==I.y)&&(I.x=C,I.y=T,this.g.lineTo(C,T))},_71I:function(Q,I,J,$){var y=this.pen;(Q!==J||I!==$||J!==y.x||$!==y.y)&&(y.x=J,y.y=$,this.g.quadraticCurveTo(Q,I,J,$))}}),r&&A){var hh=A.toString();D=hh.indexOf(kl.substr(0,2))>0&&hh.indexOf(Gh+Gh.substr(1,1))>1||hh.indexOf(we.substr(0,2)+kl.substr(2,2)+Nh[0]+kl[4])>1?!0:!1}var Pr=w,Eg=w,lb=C.checkLoadingCompType=function(O){Pr&&!O._72O&&(Eg||(Eg={}),Eg[O._72O=Og()]=O)},Ai=function(f,m){if(m||(m=f),m&&(Pr||(Pr={}),!Pr[f])){var c=new Uc;if(Pr[m]={request:c,url:m},m=C.beforeLoadURL(m),m.data){var E=C.parse(m.data);mr(f,E),C.handleCompTypeLoaded(f,E)}else{c.onload=function(){if(200===this.status||0===this.status){var t=C.parse(c.getResponseText());mr(f,t),C.handleCompTypeLoaded(f,t)}else mr(f,w)},c.onerror=function(){mr(f,w)};var H={};H.url=encodeURI(m),H.sync=!1,c.send(H)}}},mr=function(H,P){if($o[H]=P,delete Pr[H],si(Pr)&&(Pr=w,Eg)){for(var M in Eg){var O=Eg[M];O.invalidateAll&&O.invalidateAll(i,"compTypeLoaded",H),O.redraw&&O.redraw(),O.iv(),delete O._72O}Eg=w}if(P&&Eg)for(var M in Eg){var O=Eg[M];O.invalidateAll&&O.invalidateAll(i,"compTypeLoading",H),O.redraw&&O.redraw(),O.iv()}},Qn=E.chart,xe="",uo=!0,Np=C.compStack=[],gj=/^style@/,Vf=/^attr@/,pn=/^field@/,of={x:.5,y:.5},Ui=function(){uo=!0},Co=function(){return uo},Xk=function(F,B,H,I){if(!F)return 0;if(mo(F.fitSize,B,H)&&I)return I;var g=mo(F.width,B,H);return null==g?20:g},Dg=function(q,C,S,K){if(!q)return 0;if(mo(q.fitSize,C,S)&&K)return K;var Y=mo(q.height,C,S);return null==Y?20:Y},mo=function(k,q,f){if(!k||!k.func)return k;var l,e=k.func,m=k.value;return l=Ad(e)?f&&f.vectorDataBindingDisabled&&!k.isSafeFunc?m:e(q,f):q instanceof ji||(v.ui?q instanceof v.ui.View:0)?Vf.test(e)?q.a(xe+e.slice(5)):gj.test(e)?q.s(xe+e.slice(6)):pn.test(e)?q[e.slice(6)]:q[e]?q[e](f):m:m,m!==i&&l==w?m:l},lh=C.drawImage=function(){var c,L,A,N,l,M,G=function(U,K){U.getValue&&U.getValue.compType===K||(U.getValue=function(y){var X=Q(U,y);if(X===i&&K.properties){var P=K.properties[y];P&&(X=P.defaultValue)}return X},U.getColor=function(X){return h(U.getValue(X))},U.getValue.compType=K)},Q=function(C,n,Z){var D,f=!1;if(C.prefix&&L instanceof ji){var U=L.a(xe+n);U!==i&&(f=!0,D=U)}return D===i&&(D=C[n]),D&&D.func&&(f=!0,D=mo(D,L,A)),Z&&(D=Z(D),f||(C[n]=D)),D},h=function(m,u){var E;if(E=u?Q(m,u):m,c&&c.compGray&&E)return C.toGrayColor(E);if(l&&E){if("override"===M)return l;if("override_rgb"===M){var F=_g(l);return E=Jf(E),"rgba("+J(255*F[0])+","+J(255*F[1])+","+J(255*F[2])+","+E[3]/255+")"}if("override_a"===M){var F=_g(l);return E=Jf(E),"rgba("+E[0]+","+E[1]+","+E[2]+","+F[3]+")"}var F=_g(l);return E=Jf(E),"rgba("+J(E[0]*F[0])+","+J(E[1]*F[1])+","+J(E[2]*F[2])+","+E[3]/255*F[3]+")"}return E},k=function(Q){if(qf(Q)){for(var e=new Pb,T=Q.length,H=0;T>H;H+=2)e.add({x:Q[H],y:Q[H+1]});Q=e}return Q},D=function($){var u=Q($,"anchorX"),n=Q($,"anchorY");if(u!==i||n!==i)return{x:u===i?of.x:u,y:n===i?of.y:n};var H=Q($,"type"),P=Q($,"name");if("image"!==H||!P)return of;var m=Mf(P);return m&&m.anchorX!==i&&m.anchorY!==i?{x:m.anchorX,y:m.anchorY}:of},x=function(d,T){var Z=Q(d,Ph),w=D(d);if(qf(Z)){var i=Z.length,Y=Q(d,"relative"),q=T.width,f=T.height;if(4===i)Z={x:Z[0],y:Z[1],width:Z[2],height:Z[3]},Y&&(Z.x*=q,Z.y*=f,Z.width*=q,Z.height*=f);else if(3===i){var y=Z[0];Z={width:Z[1],height:Z[2]},Y&&(Z.width*=q,Z.height*=f),"object"==typeof y?y.length&&(y={x:y[0],y:y[1]}):y=vb(y,T,Z),Z.x=y.x-Z.width*w.x,Z.y=y.y-Z.height*w.y}Z.x+=Q(d,"offsetX")||0,Z.y+=Q(d,"offsetY")||0,!Y&&T.fitSize&&(Z=j(d,Z,T))}return Z},j=function(H,S,Y){if(S){var V,A,r,s={x:S.x,y:S.y,width:S.width,height:S.height},p=D(H),X=Q(H,"layoutH"),k=Q(H,"layoutV"),E=1,o=1,y=0,f=0,N=1,n=1;switch(X){case"left":break;case"right":s.x+=Y.width-Y.rw;break;case"center":s.x+=.5*(Y.width-Y.rw);break;case"scale":case"leftright":default:V=Q(H,mp)||0,V&&(y=Math.abs(f=Math.sin(V)),N=Math.abs(n=Math.cos(V))),"leftright"!==X?(E+=N*(Y.widthScale-1),o+=y*(Y.widthScale-1)):(E+=s.width?N*(Y.width-Y.rw)/s.width:0,o+=s.height?y*(Y.width-Y.rw)/s.height:0,A=-Math.min(-p.x*n+p.y*f,-p.x*n-(1-p.y)*f,(1-p.x)*n+p.y*f,(1-p.x)*n-(1-p.y)*f))}switch(k){case"top":break;case"bottom":s.y+=Y.height-Y.rh;break;case"center":s.y+=.5*(Y.height-Y.rh);break;case"scale":case"topbottom":default:V==w&&(V=Q(H,mp),V&&(y=Math.abs(f=Math.sin(V)),N=Math.abs(n=Math.cos(V)))),"topbottom"!==k?(E+=y*(Y.heightScale-1),o+=N*(Y.heightScale-1)):(E+=s.width?y*(Y.height-Y.rh)/s.width:0,o+=s.height?N*(Y.height-Y.rh)/s.height:0,r=-Math.min(-p.x*f-p.y*n,-p.x*f+(1-p.y)*n,(1-p.x)*f-p.y*n,(1-p.x)*f+(1-p.y)*n))}return(1!==E||1!==o)&&("scale"!==X&&X?"leftright"===X&&(s.x+=s.width*(1-E)*p.x+A*(Y.width-Y.rw)):s.x+=s.x*(Y.widthScale-1)+p.x*s.width*(Y.widthScale-E),"scale"!==k&&k?"topbottom"===k&&(s.y+=s.height*(1-o)*p.y+r*(Y.height-Y.rh)):s.y+=s.y*(Y.heightScale-1)+p.y*s.height*(Y.heightScale-o),s.width*=E,s.height*=o),s.width<0&&(s.width=0),s.height<0&&(s.height=0),s}},p=function(L){return qf(L)?new Pb(L):L},g=function(n,d,T,L,O,w,a){var m=c.interactiveInfo,H=n.transform;if(H)return c.save(),c.setTransform(H.a,H.b,H.c,H.d,H.tx,H.ty),m&&m.compInfos.push({comp:n,rect:d,matrix:H.clone(),prefix:xe}),!0;O===i&&(O=1),w===i&&(w=1);var R=Q(n,"clipPercentage"),X=bo(T,d);if(X&&!L&&1===O&&1===w&&!(1>R))return m&&m.compInfos.push({comp:n,rect:d,matrix:m.matrix.clone(),prefix:xe}),!1;a=a||of;var o=d.x+d.width*a.x,v=d.y+d.height*a.y,z=T.x+T.width*a.x,A=T.y+T.height*a.y,Z=T.width?O*(d.width/T.width):1,B=T.height?w*(d.height/T.height):1;if(c.save(),m&&(m.matrix.appendTranslate(o,v).appendRotate(L).appendScale(Z,B).appendTranslate(-z,-A),m.compInfos.push({comp:n,rect:d,matrix:m.matrix.clone()})),_k(c,o,v),uh(c,L||0),Gn(c,Z,B),_k(c,-z,-A),1>R){0>R&&(R=0);var N=ip(T,Q(n,"clipDirection"),R);c.beginPath(),c.rect(N.x,N.y,N.width,N.height),c.clip()}return!0},F=function(){c.restore()},n=function(R,E,W){var z=Q(R,"path"),v=Q(R,mp),C=Q(R,"scaleX"),S=Q(R,"scaleY"),b=D(R),L=w,s=Ff(null,z);if(W||(W=R.unionRect,W||(W=ye(s),R.path.func||(R.unionRect=W)),L=W),W){L||(L=R.unionRect,L||(L=ye(s),R.path.func||(R.unionRect=L)));var J=g(R,W,L,v,C,S,b),n=Q(R,"borderPattern"),T=jq(c,n),G=h(R,"background"),k=h(R,"borderColor"),t=Q(R,"borderWidth"),U=Q(R,"gradient"),Y=h(R,"gradientColor"),m=Q(R,"border3d"),o=h(R,"border3dColor"),M=Q(R,"border3dAccuracy"),r=c.lineJoin,P=c.lineCap;c.lineJoin=Q(R,"borderJoin")||to,c.lineCap=Q(R,"borderCap")||gd,G?(_l(c,G,U,Y,L),Ff(c,z),c.fill(),T!==c&&Ff(c,z)):Ff(c,z);var y=Q(R,"borderWidthAbsolute");if(y&&(c.save(),c.setTransform(1,0,0,1,0,0)),t&&k&&(c.lineWidth=t,c.strokeStyle=k,c.stroke(),m&&vr(c,k,o,t,N,M)),sd(c,n),Q(R,"dash")){var O=Q(R,"dashWidth")||t;if(O>0){n=Q(R,"dashPattern")||mg;var T=jq(c,n,Q(R,"dashOffset")),Z=h(R,"dashColor")||h(rc);T!==c&&Ff(c,z),c.strokeStyle=Z,c.lineWidth=O,c.stroke(),Q(R,"dash3d")&&vr(c,Z,h(R,"dash3dColor"),O,N,Q(R,"dash3dAccuracy")),sd(c,n)}}y&&c.restore(),E===Ph&&Wn(c,G,Q(R,"depth"),L),c.lineJoin=r,c.lineCap=P,J&&F()}},I=function(s,J,S,q){var X=Q(s,qc,k),$=Q(s,mp),u=D(s);if(X&&q.fitSize){var n=new Pb,o=ye(X),B=j(s,o,q),d=o.x+u.x*o.width,W=o.y+u.y*o.height,e=B.x+u.x*B.width,C=B.y+u.y*B.height,Z=o.width?B.width/o.width:1,I=o.height?B.height/o.height:1;X.each(function(h){n.add({x:e+(h.x-d)*Z,y:C+(h.y-W)*I})}),X=n,s.unionRect=null}var b=Q(s,"scaleX"),y=Q(s,"scaleY"),r=J===Mh,O=w;if(!S&&r&&(S=s.unionRect,S||(S=ye(X),s.points.func||(s.unionRect=S)),O=S),S){r?O||(O=s.unionRect,O||(O=ye(X),s.points.func||(s.unionRect=O))):O=S;var P,t,H,U,a=g(s,S,O,$,b,y,u),E=Q(s,"borderPattern"),i=jq(c,E),Y=h(s,"background"),R=Mf(Q(s,"repeatImage"),l,M),K=Q(s,"gradientPack"),v=h(s,"borderColor"),_=Q(s,"borderWidth"),T=Q(s,"segments",p),f=Q(s,"gradient"),G=h(s,"gradientColor"),V=Q(s,"border3d"),z=h(s,"border3dColor"),m=Q(s,"border3dAccuracy"),x=Q(s,"closePath"),Cg=Q(s,"fillRule")||"nonzero",Hh=c.lineJoin,Jb=c.lineCap;if(c.lineJoin=Q(s,"borderJoin")||to,c.lineCap=Q(s,"borderCap")||gd,r)if(Y||R||K){var mk=Q(s,"fillClipPercentage");if(1>mk){0>mk&&(mk=0);var Jh=ip(O,Q(s,"fillClipDirection"),mk);c.save(),c.beginPath(),c.rect(Jh.x,Jh.y,Jh.width,Jh.height),c.clip()}Vr(c,X,T,x),K?ts(c,K):R?bd(c,R,l,M,L,A):_l(c,Y,f,G,O),c.fill(Cg),1>mk&&c.restore(),K&&c.restore(),i!==c&&Vr(i,X,T,x)}else Vr(i,X,T,x);else if("roundRect"===J?P=Q(s,"cornerRadius"):"polygon"===J?P=Q(s,"polygonSide"):"arc"===J&&(P=Q(s,"arcFrom"),t=Q(s,"arcTo"),H=Q(s,"arcClose"),U=Q(s,"arcOval")),Y||R||K){var mk=Q(s,"fillClipPercentage");if(1>mk){0>mk&&(mk=0);var Jh=ip(O,Q(s,"fillClipDirection"),mk);c.save(),c.beginPath(),c.rect(Jh.x,Jh.y,Jh.width,Jh.height),c.clip()}ld(c,J,O,P,t,H,U),K?ts(c,K):R?bd(c,R,l,M,L,A):_l(c,Y,f,G,O),c.fill(Cg),1>mk&&c.restore(),K&&c.restore(),c!==i&&ld(i,J,O,P,t,H,U)}else ld(i,J,O,P,t,H,U);var sn=Q(s,"borderWidthAbsolute");if(sn&&(c.save(),c.setTransform(1,0,0,1,0,0)),_&&v&&(c.lineWidth=_,c.strokeStyle=v,c.stroke(),V&&vr(c,v,z,_,N,m)),sd(c,E),Q(s,"dash")){var hk=Q(s,"dashWidth")||_;if(hk>0){E=Q(s,"dashPattern")||mg;var i=jq(c,E,Q(s,"dashOffset")),xb=h(s,"dashColor")||h(rc);i!==c&&(r?Vr(i,X,T,x):ld(i,J,O,P,t,H,U)),c.strokeStyle=xb,c.lineWidth=hk,c.stroke(),Q(s,"dash3d")&&vr(c,xb,h(s,"dash3dColor"),hk,N,Q(s,"dash3dAccuracy")),sd(c,E)}}sn&&c.restore(),J===Ph&&Wn(c,Y,Q(s,"depth"),O),c.lineJoin=Hh,c.lineCap=Jb,a&&F()}},$=function(T,v){var N=l||Q(T,Sr),S=M||Q(T,"blendMode"),R=Q(T,"name"),n=Mf(R,N,S);n?nd(c,n,Q(T,"stretch"),v.x,v.y,v.width,v.height,L,A,N,null,S):uo=!1},Z=function(e,s){var X=Q(e,"text");X!=w&&gb(c,X,Q(e,"font"),h(e,Sr),s.x,s.y,s.width,s.height,Q(e,"align"),Q(e,"vAlign"))},U=function(O,H){Zh(c,h(O,Sr),H.x,H.y,H.width,H.height,Q(O,"width"))},z=function(M,Z){var C=Q(M,el),_=0;if(C&&(C.forEach(function(n){_+=n}),_>0)){for(var f=Q(M,"colors")||Qn,z=Q(M,"startAngle")||0,g=Q(M,"hollow"),m=Q(M,Xf),I=Q(M,Fm),q=Q(M,Vh),D=m?new Pb:w,j=Z.x,G=Z.y,U=Z.width,d=Z.height,K=j+U/2,H=G+d/2,i=V(U,d)/2,F=0,n=0;n<C.length;n++){var u=C[n],P=e*u/_,r=z+P;if(c.fillStyle=f[F++],F===f.length&&(F=0),c.beginPath(),g){var h=K+b(z)*i/2,k=H+y(z)*i/2,A=K+b(r)*i,R=H+y(r)*i;c.moveTo(h,k),c.arc(K,H,i/2,z,r,!1),c.lineTo(A,R),c.arc(K,H,i,r,z,!0)}else c.moveTo(K,H),c.arc(K,H,i,r,z,!0);D&&(P=(z+r)/2,D.add({text:Ad(m)?m(u,n,_,L):u,x:K+.75*b(P)*i,y:H+.75*y(P)*i})),c.closePath(),c.fill(),z=r}D&&D.each(function($){gb(c,$.text,I,q,$.x,$.y,0,0,Te)})}},d=function(E,D){var d=Q(E,ks);if(d&&d.length>0){var q=d.length,S=Q(E,Xf),u=Q(E,Fm),f=Q(E,Vh),T=S?new Pb:w,O=Q(E,"minValue")||0,o=Q(E,"maxValue");if(o==w&&(o=0,d.forEach(function(W){Q(W,el).forEach(function(y){o=H(o,y)})})),O===o)return;for(var z=D.height/(o-O),U=D.y+o*z,Z=Q(d[0],el).length,k=D.width/(3*Z+1),y=2*k/q,g=0,G=0;q>G;G++)for(var R=d[G],a=Q(R,Sr),A=Q(R,"colors"),l=Q(R,el),m=0;Z>m;m++){A?c.fillStyle=A[m]:a?c.fillStyle=a:(c.fillStyle=Qn[g++],g===Qn.length&&(g=0));var V=l[m],s=V*z,W=D.x+(1+3*m)*k+G*y;if(sc(c,W,U-s,y,s),T){var i=Ad(S)?S(V,m,R,L):V,Y=Sk(u,i).height;T.add({x:W,y:U-s-Y,width:y,height:Y,text:i})}}T&&T.each(function(t){gb(c,t.text,u,f,t.x,t.y,t.width,t.height,Te)})}},S=function(E,j){var k=Q(E,ks);if(k&&k.length>0){var M=k.length,O=Q(k[0],el).length,g=j.width/(3*O+1),D=0,Z=Q(E,"maxValue"),N=Q(E,Xf),R=Q(E,Fm),h=Q(E,Vh),U=N?new Pb:w;if(Z==w){Z=0;for(var B=0;O>B;B++){for(var C=0,y=0;M>y;y++)C+=Q(k[y],el)[B];Z=H(Z,C)}}if(Z>0){for(var B=0;O>B;B++)for(var o=j.y+j.height,y=0;M>y;y++){var p=k[y],I=Q(p,Sr),G=Q(p,el)[B],T=G/Z*j.height;I?c.fillStyle=I:(c.fillStyle=Qn[D++],D===Qn.length&&(D=0)),o-=T;var X={x:j.x+(1+3*B)*g,y:o,width:2*g,height:T};sc(c,X.x,X.y,X.width,X.height),U&&(X.text=Ad(N)?N(G,B,p,L):G,U.add(X))}U&&U.each(function(W){gb(c,W.text,R,h,W.x,W.y,W.width,W.height,Te)})}}},P=function(C,x){var R=Q(C,ks);if(R&&R.length>0){for(var q=R.length,H=Q(R[0],el).length,j=x.width/(3*H+1),B=0,I=Q(C,Xf),U=Q(C,Fm),J=Q(C,Vh),f=I?new Pb:w,V=0;H>V;V++){for(var Z=0,O=0;q>O;O++)Z+=Q(R[O],el)[V];if(Z>0){var Y=x.y+x.height;for(O=0;q>O;O++){var K=R[O],S=Q(K,Sr),l=Q(K,el)[V],P=l/Z*x.height;S?c.fillStyle=S:(c.fillStyle=Qn[B++],B===Qn.length&&(B=0)),Y-=P;var M={x:x.x+(1+3*V)*j,y:Y,width:2*j,height:P};sc(c,M.x,M.y,M.width,M.height),f&&(M.text=Ad(I)?I(l,V,K,L):l,f.add(M))}}}f&&f.each(function(u){gb(c,u.text,U,J,u.x,u.y,u.width,u.height,Te)})}},K=function(D,X){var b=Q(D,ks);if(b&&b.length>0){var A=b.length,P=Q(D,"minValue")||0,E=Q(D,"maxValue");if(E==w&&(E=0,b.forEach(function(Y){Q(Y,el).forEach(function(c){E=H(E,c)})})),P===E)return;for(var m=X.height/(E-P),n=X.y+E*m,J=Q(b[0],el).length,s=X.width/(3*J+1),o=0,q=Q(D,"lineWidth")||2,j=Q(D,"line3d"),U=Q(D,"linePoint"),x=Q(D,Xf),R=Q(D,Fm),S=Q(D,Vh),k=0;A>k;k++){var O=b[k],y=Q(O,Sr),r=Q(O,el);y?c.strokeStyle=y:(y=c.strokeStyle=Qn[o++],o===Qn.length&&(o=0)),c.beginPath();for(var l=0;J>l;l++){var G=X.x+(2+3*l)*s,B=n-r[l]*m;0===l?c.moveTo(G,B):c.lineTo(G,B)}if(c.lineWidth=q,c.stroke(),j&&vr(c,y,w,q,N),U||x){var i,T=q/2+2;for(l=0;J>l;l++){var _=r[l];if(G=X.x+(2+3*l)*s,B=n-_*m,Ad(U)?U(c,G,B,y,l,O,L):U&&(c.fillStyle=y,c.beginPath(),c.arc(G,B,T,0,e,!0),c.fill()),Ad(x)?i=x(_,l,O,L):x&&(i=_),i){var Z=Sk(R,i).height,K=c.shadowBlur;if(K){var p=c.shadowOffsetX,V=c.shadowOffsetY,u=c.shadowColor;c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.shadowColor=w}gb(c,i,R,S,G,B-Z-T+2,0,Z,Te),K&&(c.shadowOffsetX=p,c.shadowOffsetY=V,c.shadowBlur=K,c.shadowColor=u)}}}}}},a=function(P){c=P[0],L=P[1],A=P[2],N=P[3],l=P[4],M=P[5]},t=function(){return[c,L,A,N,l,M]},E=function(U,r){var c;A&&A.getState?c=A.getState(L):(c=L instanceof ji?L.s(Oc):null,(c===i||null===c)&&(c=Q(U,Oc)));var K=Q(r,Oc);return K!==i&&null!==K&&K!==c?!1:Q(r,bi)},q={border:U,image:$,text:Z,pieChart:z,columnChart:d,stackedColumnChart:S,percentageColumnChart:P,lineChart:K};return function(U,V,d,m,P,o,W,K,f,$){if(V&&P&&o){var r=t();c=U,L=W,A=K,!L&&A&&A.isSelfViewEvent&&(L=A),N=A?A._zoom?A._zoom:1:1,l=f,M=$;var z=P,R=o;if(Uk()){var y,J,_;0===c[qp]?Uk[0]&&(y=!0):y=!0,c.texureImage2D?Uk[1]&&(J=!0):J=!0,c.texureImage3D?Uk[2]&&(_=!0):_=!0,y&&J&&_&&(z=d,R=m)}if(V.tagName)return tq(Gb)&&!u[Gb]||c.drawImage(V,z,R,P,o),a(r),void 0;if(Q(V,"visible")===!1)return a(r),void 0;l||(l=mo(V.color,L,A)),$||(M=mo(V.blendMode,L,A)),tq(Gb)&&!u[Gb]&&(P=z,o=R);var j=Xk(V,L,A,P),X=Dg(V,L,A,o),s={x:0,y:0,width:j,height:X,fitSize:Q(V,"fitSize")},T=Q(V,"clip"),B=Q(V,"opacity");if(s.fitSize){var e=s.rw=mo(V.width,L,A)||20;s.widthScale=j/e;var v=s.rh=mo(V.height,L,A)||20;s.heightScale=X/v}if(c.save(),c.interactiveInfo){var H=c.interactiveInfo.matrix,Y=H.clone();H.appendTranslate(z,R).appendScale(P/j,o/X)}_k(c,z,R),(j!==P||X!==o)&&c.scale(P/j,o/X),T&&(Ad(T)?T(c,j,X,L,A,V):(c.beginPath(),c.rect(0,0,j,X),c.clip())),B!=w&&(c.globalAlpha*=B),Q(V,"comps").forEach(function(T){if(T.prefix){var $=xe,H=mo(T.prefix,L,A);H&&(xe=xe+H+".")}if(E(V,T)===!1)return T.prefix&&(xe=$),void 0;if(Np.splice(0,0,T),c.interactiveInfo)var M=c.interactiveInfo.matrix.clone();var J=Q(T,"opacity"),Y=Q(T,"shadow"),e=Q(T,"type"),P=x(T,s);if(J!=w){var t=c.globalAlpha;c.globalAlpha*=J}if(Y){var y=c.shadowOffsetX,z=c.shadowOffsetY,S=c.shadowBlur,l=c.shadowColor,b=Q(T,"shadowOffsetX"),j=Q(T,"shadowOffsetY"),O=Q(T,"shadowBlur"),d=h(T,"shadowColor");c.shadowOffsetX=(b==w?3:b)*N,c.shadowOffsetY=(j==w?3:j)*N,c.shadowBlur=(O==w?6:O)*N,c.shadowColor=d||h(Un)}if("save"===e)c.save();else if("endClip"===e||"restore"===e)c.restore();else if("clip"===e)c.save(),Vr(c,Q(T,"points",k),Q(T,"segments",p),!0),c.clip();else if(Qj[e])P=P||{x:0,y:0,width:s.width,height:s.height},I(T,e,P,s);else if(e===Mh)I(T,e,P,s);else if("SVGPath"===e)n(T,e,P);else{P=P||{x:0,y:0,width:s.width,height:s.height};var B=Q(T,mp),u=Q(T,"scaleX"),o=Q(T,"scaleY"),Z=D(T),R=g(T,P,P,B,u,o,Z);if(Ad(e))G(T,e),C.drawCompType(e,c,P,T,L,A);else if(C.getCompType(e)){var K=C.getCompType(e),W=K.func||K;G(T,K),C.drawCompType(W,c,P,T,L,A)}else q[e]?q[e](T,P):C.getCompType(e)===i&&Kg.test(e)&&Ai(e);R&&F()}Y&&(c.shadowOffsetX=y,c.shadowOffsetY=z,c.shadowBlur=S,c.shadowColor=l),J!=w&&(c.globalAlpha=t),c.interactiveInfo&&(c.interactiveInfo.matrix=M),T.prefix&&(xe=$),Np.splice(0,1)}),c.interactiveInfo&&(c.interactiveInfo.matrix=Y),c.restore(),a(r)}}}();C.getCurrentComp=function(){return Np[0]},C.getParentComp=function(){return Np[1]},C.getInternal=function(){return{isEnter:np,isEsc:Gr,isSpace:Dj,isLeft:tg,isUp:Oo,isRight:od,isDown:jn,addMethod:og,superCall:qj,toPointsArray:mm,translateAndScale:Md,appendArray:ho,createWorldMatrix:Xb,vec3TransformMat4:Vl,setCanvas:vf,createDiv:xl,createView:pf,createCanvas:$f,createImage:Th,initContext:Xl,layout:Wp,fillRect:sc,Mat:yk,drawBorder:Zh,isString:tq,setBorder:cs,getPropertyValue:ms,setPropertyValue:Sq,drawVerticalLine:hp,draw3DRect:Wn,getPinchDist:sh,isSameRect:bo,getPosition:vb,intersectionLineRect:Or,getNodeRect:je,getEdgeAgentPosition:Zr,getEdgeHostPosition:Yk,getImageWidth:Xk,getImageHeight:Dg,initItemElement:op,drawPoints:Vr,createG2:jq,closePopup:Fc,isH:ym,createAnim:ig,createNormalMatrix:cr,createNormals:Dh,toFloatArray:wn,glMV:Bf,batchShape:wf,createNodeMatrix:sf,getFaceInfo:Ee,transformAppend:zg,drawFaceInfo:Ck,to3dPointsArray:is,setGLDebugMode:function(j){fo=j},cube:function(){return{vs:rg,is:cj,uv:Wc}},ui:function(){return{DataUI:vl,NodeUI:dp,EdgeUI:ge,GroupUI:Hg,ShapeUI:ub,GridUI:Ik,Data3dUI:kp,Node3dUI:ve,Shape3dUI:Yh}},getInternalVersion:function(){return"U2FsdGVkX19sV9yTsI/ETKxu1XFjuo4wykPrUG8OHVY="},getDragger:function(){return Bb},addMSMap:function(Z){og(Ib,Z)},k:m,addEventListener:X,removeEventListener:q}},function(j){function T(E,C){E!=w&&(C==w&&ai!=typeof E?this._54O(E,256):this._54O(E,C))}function A(){return new T(w)}function X(Q,c,R,o,y,Z){for(;--Z>=0;){var N=c*this[Q++]+R[o]+y;y=p(N/67108864),R[o++]=67108863&N}return y}function v($,D,i,p,h,N){for(var s=32767&D,K=D>>15;--N>=0;){var y=32767&this[$],q=this[$++]>>15,G=K*y+q*s;y=s*y+((32767&G)<<15)+i[p]+(1073741823&h),h=(y>>>30)+(G>>>15)+K*q+(h>>>30),i[p++]=1073741823&y}return h}function t(b,d,z,a,L,w){for(var i=16383&d,m=d>>14;--w>=0;){var D=16383&this[b],f=this[b++]>>14,T=m*D+f*i;D=i*D+((16383&T)<<14)+z[a]+L,L=(D>>28)+(T>>14)+m*f,z[a++]=268435455&D}return L}function F(N){return Li.charAt(N)}function P(l,A){var X=Mb[l.charCodeAt(A)];return X==w?-1:X}function C(z){for(var F=this.t-1;F>=0;--F)z[F]=this[F];z.t=this.t,z.s=this.s}function U(C){this.t=1,this.s=0>C?-1:0,C>0?this[0]=C:-1>C?this[0]=C+this.DV:this.t=0}function z(w){var p=A();return p._58O(w),p}function n(K,x){var w,b=this;if(16==x)w=4;else if(8==x)w=3;else if(256==x)w=8;else if(2==x)w=1;else if(32==x)w=5;else{if(4!=x)return b.fromRadix(K,x),void 0;w=2}b.t=0,b.s=0;for(var S=K.length,m=!1,R=0;--S>=0;){var A=8==w?255&K[S]:P(K,S);0>A?"-"==K.charAt(S)&&(m=!0):(m=!1,0==R?b[b.t++]=A:R+w>b.DB?(b[b.t-1]|=(A&(1<<b.DB-R)-1)<<R,b[b.t++]=A>>b.DB-R):b[b.t-1]|=A<<R,R+=w,R>=b.DB&&(R-=b.DB))}8==w&&0!=(128&K[0])&&(b.s=-1,R>0&&(b[b.t-1]|=(1<<b.DB-R)-1<<R)),b._57O(),m&&T.ZERO._78O(b,b)}function c(){for(var T=this,Q=T.s&T.DM;T.t>0&&T[T.t-1]==Q;)--T.t}function N(k){var r=this;if(r.s<0)return"-"+r._85O()[Kh](k);var l;if(16==k)l=4;else if(8==k)l=3;else if(2==k)l=1;else if(32==k)l=5;else{if(4!=k)return r.toRadix(k);l=2}var e,H=(1<<l)-1,J=!1,m="",V=r.t,Q=r.DB-V*r.DB%l;if(V-->0)for(Q<r.DB&&(e=r[V]>>Q)>0&&(J=!0,m=F(e));V>=0;)l>Q?(e=(r[V]&(1<<Q)-1)<<l-Q,e|=r[--V]>>(Q+=r.DB-l)):(e=r[V]>>(Q-=l)&H,0>=Q&&(Q+=r.DB,--V)),e>0&&(J=!0),J&&(m+=F(e));return J?m:"0"}function g(){var Y=A();return T.ZERO._78O(this,Y),Y}function I(){return this.s<0?this._85O():this}function L(k){var e=this,S=e.s-k.s;if(0!=S)return S;var b=e.t;if(S=b-k.t,0!=S)return e.s<0?-S:S;for(;--b>=0;)if(0!=(S=e[b]-k[b]))return S;return 0}function l(O){var T,f=1;return 0!=(T=O>>>16)&&(O=T,f+=16),0!=(T=O>>8)&&(O=T,f+=8),0!=(T=O>>4)&&(O=T,f+=4),0!=(T=O>>2)&&(O=T,f+=2),0!=(T=O>>1)&&(O=T,f+=1),f}function r(){var G=this;return G.t<=0?0:G.DB*(G.t-1)+l(G[G.t-1]^G.s&G.DM)}function Y(_,i){var E;for(E=this.t-1;E>=0;--E)i[E+_]=this[E];for(E=_-1;E>=0;--E)i[E]=0;i.t=this.t+_,i.s=this.s}function u(F,i){for(var U=F;U<this.t;++U)i[U-F]=this[U];i.t=H(this.t-F,0),i.s=this.s}function M(o,n){var g,v=this,e=o%v.DB,H=v.DB-e,f=(1<<H)-1,c=p(o/v.DB),A=v.s<<e&v.DM;for(g=v.t-1;g>=0;--g)n[g+c+1]=v[g]>>H|A,A=(v[g]&f)<<e;for(g=c-1;g>=0;--g)n[g]=0;n[c]=A,n.t=v.t+c+1,n.s=v.s,n._57O()}function k(O,R){var a=this;R.s=a.s;var n=p(O/a.DB);if(n>=a.t)return R.t=0,void 0;var T=O%a.DB,B=a.DB-T,g=(1<<T)-1;R[0]=a[n]>>T;for(var t=n+1;t<a.t;++t)R[t-n-1]|=(a[t]&g)<<B,R[t-n]=a[t]>>T;T>0&&(R[a.t-n-1]|=(a.s&g)<<B),R.t=a.t-n,R._57O()}function i(x,f){for(var Z=this,D=0,c=0,M=V(x.t,Z.t);M>D;)c+=Z[D]-x[D],f[D++]=c&Z.DM,c>>=Z.DB;if(x.t<Z.t){for(c-=x.s;D<Z.t;)c+=Z[D],f[D++]=c&Z.DM,c>>=Z.DB;c+=Z.s}else{for(c+=Z.s;D<x.t;)c-=x[D],f[D++]=c&Z.DM,c>>=Z.DB;c-=x.s}f.s=0>c?-1:0,-1>c?f[D++]=Z.DV+c:c>0&&(f[D++]=c),f.t=D,f._57O()}function J(M,q){var X=this.abs(),h=M.abs(),o=X.t;for(q.t=o+h.t;--o>=0;)q[o]=0;for(o=0;o<h.t;++o)q[o+X.t]=X.am(0,h[o],q,o,0,X.t);q.s=0,q._57O(),this.s!=M.s&&T.ZERO._78O(q,q)}function f(G){for(var i=this.abs(),w=G.t=2*i.t;--w>=0;)G[w]=0;for(w=0;w<i.t-1;++w){var f=i.am(w,i[w],G,2*w,0,1);(G[w+i.t]+=i.am(w+1,2*i[w],G,2*w+1,f,i.t-w-1))>=i.DV&&(G[w+i.t]-=i.DV,G[w+i.t+1]=1)}G.t>0&&(G[G.t-1]+=i.am(w,i[w],G,2*w,0,1)),G.s=0,G._57O()}function x(j,Q,K){var m=j.abs(),c=this;if(!(m.t<=0)){var V=c.abs();if(V.t<m.t)return Q!=w&&Q._58O(0),K!=w&&c._77O(K),void 0;K==w&&(K=A());var s=A(),o=c.s,L=j.s,N=c.DB-l(m[m.t-1]);N>0?(m._44O(N,s),V._44O(N,K)):(m._77O(s),V._77O(K));var J=s.t,f=s[J-1];if(0!=f){var n=f*(1<<c.F1)+(J>1?s[J-2]>>c.F2:0),e=c.FV/n,q=(1<<c.F1)/n,D=1<<c.F2,y=K.t,Y=y-J,g=Q==w?A():Q;for(s._59O(Y,g),K._52O(g)>=0&&(K[K.t++]=1,K._78O(g,K)),T.ONE._59O(J,g),g._78O(s,s);s.t<J;)s[s.t++]=0;for(;--Y>=0;){var x=K[--y]==f?c.DM:p(K[y]*e+(K[y-1]+D)*q);if((K[y]+=s.am(0,x,K,Y,0,J))<x)for(s._59O(Y,g),K._78O(g,K);K[y]<--x;)K._78O(g,K)}Q!=w&&(K._45O(J,Q),o!=L&&T.ZERO._78O(Q,Q)),K.t=J,K._57O(),N>0&&K._46O(N,K),0>o&&T.ZERO._78O(K,K)}}}function G(L){var $=A();return this.abs()._49O(L,w,$),this.s<0&&$._52O(T.ZERO)>0&&L._78O($,$),$}function Q(s){this.m=s}function q(a){return a.s<0||a._52O(this.m)>=0?a.mod(this.m):a}function s(p){return p}function $(O){O._49O(this.m,w,O)}function O(C,R,t){C._47O(R,t),this._74O(t)}function S(r,U){r._48O(U),this._74O(U)}function E(){if(this.t<1)return 0;var o=this[0];if(0==(1&o))return 0;var V=3&o;return V=15&V*(2-(15&o)*V),V=255&V*(2-(255&o)*V),V=65535&V*(2-(65535&(65535&o)*V)),V=V*(2-o*V%this.DV)%this.DV,V>0?this.DV-V:-V}function D($){var C=this;C.m=$,C.mp=$._50O(),C.mpl=32767&C.mp,C.mph=C.mp>>15,C.um=(1<<$.DB-15)-1,C.mt2=2*$.t}function d(X){var a=A();return X.abs()._59O(this.m.t,a),a._49O(this.m,w,a),X.s<0&&a._52O(T.ZERO)>0&&this.m._78O(a,a),a}function o(Y){var I=A();return Y._77O(I),this._74O(I),I}function _(h){for(var O=this;h.t<=O.mt2;)h[h.t++]=0;for(var x=0;x<O.m.t;++x){var d=32767&h[x],V=d*O.mpl+((d*O.mph+(h[x]>>15)*O.mpl&O.um)<<15)&h.DM;for(d=x+O.m.t,h[d]+=O.m.am(0,V,h,x,0,O.m.t);h[d]>=h.DV;)h[d]-=h.DV,h[++d]++}h._57O(),h._45O(O.m.t,h),h._52O(O.m)>=0&&h._78O(O.m,h)}function Eb(k,v){k._48O(v),this._74O(v)}function Up(i,x,Z){i._47O(x,Z),this._74O(Z)}function be(){return 0==(this.t>0?1&this[0]:this.s)}function Xk(H,a){if(H>4294967295||1>H)return T.ONE;var w=A(),G=A(),I=a._73O(this),z=l(H)-1;for(I._77O(w);--z>=0;)if(a._76O(w,G),(H&1<<z)>0)a._75O(G,I,w);else{var e=w;w=G,G=e}return a.revert(w)}function uo(F,N){var B;return B=256>F||N._51O()?new Q(N):new D(N),this.exp(F,B)}function sf(){var e=this;if(e.s<0){if(1==e.t)return e[0]-e.DV;if(0==e.t)return-1}else{if(1==e.t)return e[0];if(0==e.t)return 0}return(e[1]&(1<<32-e.DB)-1)<<e.DB|e[0]}function we(I,_){return new T(I,_)}function cg(){var C=this;C.n=w,C.e=0,C.d=w,C.p=w,C.q=w,C.dmp1=w,C.dmq1=w,C._10A=w}function il(h){return h._53O(this.e,this.n)}function ih(w){var $,k,L,a="",E=0;for($=0;$<w.length&&w.charAt($)!=Kc;++$)L=li.indexOf(w.charAt($)),0>L||(0==E?(a+=F(L>>2),k=3&L,E=1):1==E?(a+=F(k<<2|L>>4),k=15&L,E=2):2==E?(a+=F(k),a+=F(L>>2),k=3&L,E=3):(a+=F(k<<2|L>>4),a+=F(15&L),E=0));return 1==E&&(a+=F(k<<2)),a}function Pd(O){var q=O.split(""),N=ih(O);return q.forEach(function(i){var u=i.length;u>0&&N&&(Zc+=a(i))}),N}function Fm(z,o){var B=gk._4O.Util._56O(z,"ss"),j={},G=0;return j.v=B==o,j.t=1,j.s=0>G?-1:0,Lj=j.v,G>0?j[0]=G:-1>G?j[0]=G+j.DV:j.t=0,[B,j]}function _d(D){var C=38,v=D.substring(0,C);if(v&&30==v.indexOf("05000420")){var N=["ss",D.substring(C)];return N}return[]}function ho(r,a){a=a.replace(Oo,""),a=a.replace(/[ \n]+/g,"");var i=we(a,16);if(i._55O()>this.n._55O())return 0;var A=this._37O(i),m=A[Kh](16).replace(/^1f+00/,""),Z=_d(m);if(0==Z.length)return!1;for(var n,P,N,L=.5,l=Zn,j=[0,.5,.75,.875,.9375],g=[],S=[],C=[],E=e/l,p=Z[1],u=Fm(r,p)[0],I=0,J=0;I<j.length;I++){var B=0===I%2?0:.5;for(n=0;l>=n;n++)P=(n+B)*E,N=1-j[I],g.push(b(P)*L*N,-L+2*j[I]*L,-y(P)*L*N),S.push((n+B)/l,N)}for(I=0;I<j.length-1;I++){var D=I*(l+1),W=(I+1)*(l+1);for(n=0;l>n;n++)C.push(D+n,W+n+1,W+n,D+n,D+n+1,W+n+1)}return C.forEach(function(H){J+=H}),p==u&&J>10}var Fl,Ld=0xdeadbeefcafe,$m=15715070==(16777215&Ld),Kh="toString",aj="",rn="nat",mi=function(){};W=j["D"+11182[Kh](B(2,5))];var yb=T.prototype;Hn+=xc.substr(0,1);var Kd=j.navigator?j.navigator.appName:"";$m&&"Microsoft Internet Explorer"==Kd?(yb.am=v,Fl=30):$m&&"Netscape"!=Kd?(yb.am=X,Fl=26):(yb.am=t,Fl=28),yb.DB=Fl,yb.DM=(1<<Fl)-1,yb.DV=1<<Fl;
var hm=52;yb.FV=B(2,hm),yb.F1=hm-Fl,yb.F2=2*Fl-hm;var ah,fi,Li="0123456789abcdefghijklmnopqrstuvwxyz",Mb=[],Tr=function(Z){return String.fromCharCode(Z)};for(ah="0".charCodeAt(0),fi=0;9>=fi;++fi)Mb[ah++]=fi;for(ah="a".charCodeAt(0),fi=10;36>fi;++fi)Mb[ah++]=fi;for(ah="A".charCodeAt(0),fi=10;36>fi;++fi)Mb[ah++]=fi;var Kb=Q.prototype;Kb._73O=q,Kb.revert=s,Kb._74O=$,Kb._75O=O,Kb._76O=S;var vd=D.prototype;vd._73O=d,vd.revert=o,vd._74O=_,vd._75O=Up,vd._76O=Eb,yb._77O=C,yb._58O=U,yb._54O=n,yb._57O=c,yb._59O=Y,yb._45O=u,yb._44O=M,yb._46O=k,yb._78O=i,yb._47O=J,yb._48O=f,yb._49O=x,yb._50O=E,yb._51O=be,yb.exp=Xk,yb.toString=N,yb._85O=g,yb.abs=I,yb._52O=L,yb._55O=r,yb.mod=G,yb._53O=uo,T.ZERO=z(0),T.ONE=z(1),yb._86O=sf;var Fi=function(m,p){var h=this;h.isPublic=!0,typeof m!==ai?(h.n=m,h.e=p):m!=w&&p!=w&&m.length>0&&p.length>0&&(h.n=we(m,16),h.e=a(p,16))};oq=function(){var T,e,b=Pd(Pe),H=b.substr(0,4),k=b.substr(4,2),h=b.substr(6,2),Q=1,L=!Q,r=m,a=[],v=Cg.charAt(7);if(W&&(W[Kh]().indexOf(rn)<0||W[Hn][Kh]().indexOf(rn)<0||!b?T=w:(b=new W(H-0,k-Q,h-0),e=b.setHours(9),W[Hn]()>e?T=oo[v]:L=!0)),b&&T&&T[0]&&T[R(.5)]&&r){var S=$g(T[0]),X=$g(T[1]);for(var J in X)a.push(J);var A,I=0,p=S[a[I]],s=X[a[I++]],O=X[a[I++]],l=X[a[I++]],t=X[a[I++]],f=X[a[I++]],_=X[a[I++]],Y=S[a[I]],N=X[a[I++]],x=kq._27O(r);if(p===s&&x&&N){A=s+O+l+t+f+_;var K=!_||_===Ar;if(!K&&_)for(var o,g=0,U=_.length;U>g;g++)_[g]===hj[I]?o===Ar?K=!0:o[0]===_i[5]&&Ar&&Ar.indexOf(o.substr(1))>=0?K=!0:o=w:(o==w?o=_[g]:o+=_[g],g===U-1&&(o===Ar?K=!0:o[0]===_i[5]&&Ar&&Ar.indexOf(o.substr(1))>=0&&(K=!0)));A&&x._31O(A,N)&&x._31O(p,Y)&&K&&(!f||W[Hn]()<f)&&(L=!0)}}return L||(ld=vi),v};var Gc=cg.prototype;Gc._37O=il,Gc._38O=Fi;var li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kc="=",pb=25,Bg=10,Pe="ICAGFQ==",Ol=Ol||function(o,B){var L={},Z=L._7A={},D=Z._6A=function(){function t(){}return{_80O:function(d){t.prototype=this;var A=new t;return d&&A._5A(d),A.hasOwnProperty("_82O")||(A._82O=function(){A.$super._82O.apply(this,arguments)}),A._82O.prototype=A,A.$super=this,A},_3A:function(){var O=this._80O();return O._82O.apply(O,arguments),O},_82O:function(){},_5A:function(p){for(var $ in p)p.hasOwnProperty($)&&(this[$]=p[$]);p.hasOwnProperty(Kh)&&(this.toString=p.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),j=Z._39O=D._80O({_82O:function(Q,i){Q=this._84O=Q||[],this._65O=i!=B?i:4*Q.length},toString:function(n){return(n||T).stringify(this)},_89O:function(q){var P=this._84O,E=q._84O,V=this._65O,H=q._65O;if(this._57O(),V%4)for(var x=0;H>x;x++){var F=255&E[x>>>2]>>>24-8*(x%4);P[V+x>>>2]|=F<<24-8*((V+x)%4)}else if(E.length>65535)for(var x=0;H>x;x+=4)P[V+x>>>2]=E[x>>>2];else P.push.apply(P,E);return this._65O+=H,this},_57O:function(){var c=this._84O,n=this._65O;c[n>>>2]&=4294967295<<32-8*(n%4),c.length=R(n/4)},_88O:function(){var b=D._88O.call(this);return b._84O=this._84O.slice(0),b},_87O:function(S){for(var b=[],M=0;S>M;M+=4)b.push(0|4294967296*h);return new j._82O(b,S)}}),S=L._2A={},T=S._69O={stringify:function(q){var m,R=q._84O,M=q._65O,g=[];for(m=0;M>m;m++){var L=255&R[m>>>2]>>>24-8*(m%4);g.push((L>>>4).toString(16)),g.push((15&L).toString(16))}return g.join("")},_68O:function(V){for(var b=V.length,t=[],T=0;b>T;T+=2)t[T>>>3]|=a(V.substr(T,2),16)<<24-4*(T%8);return new j._82O(t,b/2)}},t=S._8A={stringify:function(a){var b,L=a._84O,C=a._65O,c=[];for(b=0;C>b;b++){var x=255&L[b>>>2]>>>24-8*(b%4);c.push(Tr(x))}return c.join("")},_68O:function($){var Z,s=$.length,L=[];for(Z=0;s>Z;Z++)L[Z>>>2]|=(255&$.charCodeAt(Z))<<24-8*(Z%4);return new j._82O(L,s)}},r=S._9A={stringify:function(K){try{return decodeURIComponent(escape(t.stringify(K)))}catch(q){throw new Error("")}},_68O:function(O){return t._68O(unescape(encodeURIComponent(O)))}},x=Z._32O=D._80O({_1A:function(){this._83O=new j._82O,this._23O=0},_33O:function(X){typeof X==ai&&(X=r._68O(X)),this._83O._89O(X),this._23O+=X._65O},_25O:function(u){var S=this._83O,i=S._84O,n=S._65O,q=this._79O,a=4*q,r=n/a;r=u?R(r):H((0|r)-this._22O,0);var I=r*q,D=V(4*I,n);if(I){for(var x=0;I>x;x+=q)this._20O(i,x);var U=i.splice(0,I);S._65O-=D}return new j._82O(U,D)},_88O:function(){var c=D._88O.call(this);return c._83O=this._83O._88O(),c},_22O:0});Z._66O=x._80O({cfg:D._80O(),_82O:function(m){this.cfg=this.cfg._80O(m),this._1A()},_1A:function(){x._1A.call(this),this._34O()},_81O:function(e){return this._33O(e),this._25O(),this},_72O:function(P){P&&this._33O(P);var Q=this._21O();return Q},_79O:16,_26O:function(V){return function(D,Z){return new V._82O(Z)._72O(D)}},_19O:function(G){return function(U,n){return new w._71O._82O(G,n)._72O(U)}}});var w=L._67O={};return L}();!function(){var i=Ol,N=i._7A,t=N._39O,D=N._66O,l=i._67O,z=[],K=[];!function(){function L(D){for(var I=Z(D),k=2;I>=k;k++)if(!(D%k))return!1;return!0}function X(R){return 0|4294967296*(R-(0|R))}for(var m=2,D=0;64>D;)L(m)&&(8>D&&(z[D]=X(B(m,.5))),K[D]=X(B(m,1/3)),D++),m++}();var c=[],m=l._41O=D._80O({_34O:function(){this._64O=new t._82O(z.slice(0))},_20O:function(D,w){for(var V=this._64O._84O,b=V[0],y=V[1],H=V[2],_=V[3],k=V[4],z=V[5],Y=V[6],O=V[7],Q=0;64>Q;Q++){if(16>Q)c[Q]=0|D[w+Q];else{var T=c[Q-15],v=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,t=c[Q-2],N=(t<<15|t>>>17)^(t<<13|t>>>19)^t>>>10;c[Q]=v+c[Q-7]+N+c[Q-16]}var Z=k&z^~k&Y,s=b&y^b&H^y&H,n=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),$=(k<<26|k>>>6)^(k<<21|k>>>11)^(k<<7|k>>>25),A=O+$+Z+K[Q]+c[Q],r=n+s;O=Y,Y=z,z=k,k=0|_+A,_=H,H=y,y=b,b=0|A+r}V[0]=0|V[0]+b,V[1]=0|V[1]+y,V[2]=0|V[2]+H,V[3]=0|V[3]+_,V[4]=0|V[4]+k,V[5]=0|V[5]+z,V[6]=0|V[6]+Y,V[7]=0|V[7]+O},_21O:function(){var a=this._83O,C=a._84O,O=8*this._23O,o=8*a._65O;return C[o>>>5]|=128<<24-o%32,C[(o+64>>>9<<4)+14]=p(O/4294967296),C[(o+64>>>9<<4)+15]=O,a._65O=4*C.length,this._25O(),this._64O},_88O:function(){var X=D._88O.call(this);return X._64O=this._64O._88O(),X}});i._41O=D._26O(m),i._42O=D._19O(m)}();var Oo=new RegExp("");Oo.compile("[^0-9a-f]","gi"),cg._28O=-1,cg._29O=-2,Gc._31O=ho,Gc._63O=ho,cg._43O=-2;var bf=new function(){var R=this;R._5O=function(Z,p){if("8"!=Z.substring(p+2,p+3))return 1;var J=a(Z.substring(p+3,p+4));return 0==J?-1:J>0&&10>J?J+1:-2},R._13O=function(G,A){var w=R._5O(G,A);return 1>w?"":G.substring(A+2,A+2+2*w)},R._12O=function(e,P){var X=R._13O(e,P);if(""==X)return-1;var g;return g=a(X.substring(0,1))<8?new T(X,16):new T(X.substring(2),16),g._86O()},R._6O=function(O,N){var S=R._5O(O,N);return 0>S?S:N+2*(S+1)},R._11O=function(A,L){var Q=R._6O(A,L),P=R._12O(A,L);return A.substring(Q,Q+2*P)},R._10O=function(t,T){var J=R._6O(t,T),E=R._12O(t,T);return J+2*E},R._7O=function(L,N){var n=[],X=R._6O(L,N);n.push(X);for(var p=R._12O(L,N),t=X,m=0;;){var U=R._10O(L,t);if(U==w||U-X>=2*p)break;if(m>=200)break;n.push(U),t=U,m++}return n}};if(bf._90O=Tr(Bg+24),bf._91O=K+Tr(Bg*Bg+8),gk==w||!gk)var gk={};gk._4O!=w&&gk._4O||(gk._4O={});var wh=gk._4O;gk._4O.Util=new function(){var Z=this;Z._56O=function(F){var W=new gk._4O._3O;return W._30O(F)},Z._4A=function(h){var O=new gk._4O._3O;return O._36O(h)},Z._11A=function(Y){var H=new wh._3O;return H._30O(Y)}},gk._4O._3O=function(){var n=this;n._8O=function(s,b){if("ss"==s&&"cj"==b){try{n.md=Ol._67O._41O._3A()}catch(t){mi(aj)}n._24O=function(B){n.md._81O(B)},n._35O=function(p){var N=Ol._2A._69O._68O(p);n.md._81O(N)},n._60O=function(){var g=n.md._72O();return g[Kh](Ol._2A._69O)},n._30O=function($){return n._24O($),n._60O()},n._36O=function(J){return n._35O(J),n._60O()}}},n._24O=function(){mi(aj)},n._35O=function(){mi(aj)},n._60O=function(){mi(aj)},n._30O=function(){mi(aj)},n._36O=function(){mi(aj)},n._8O("ss","cj")},pl=function(E){var M=$e[zh[7]],b=1,w=!1;if(Hb.a!=$e[jd])return Hb.a;if(Hb.forEach(function(F){b*=F}),E>b){if(M&&M[1]&&M[0]){var y=M[0],m=M[1];m=m.split(bf._90O),y=y.split(bf._90O);var d=m[3],G=y[3],k=m[7],t=m[11],Z=m[15],Y=m[19],B=m[23],f=m[27],h=y[7],P=d+k+t+Z+Y+B,$=B?!1:!0,J=G===d;if(B){var A=B&&B.split(Mj("firefox")[3]);if(A)for(var H=0;H<A.length;H++){var z=A[H];if(z[0]===So[8]&&(z=z.substring(1)),Zf.indexOf(z)>=0){$=!0;break}}}w=J&&Vj()(G,h)&&Vj()(P,f)&&$&&(!Y||Y>E)}w||(vl.prototype._42=rp)}else w=!0;return Hb.a=w,w},pb=String.fromCharCode(pb+20);var od=function(G){return G=G.replace(Oo,aj),G=G.replace(/[ \n]+/g,aj)},Jl="30",Gf="06",Ao="02",Mc="03",Tn=we,gq=/^1f+00/,kq=function(){var U;return U={_18O:function(j){var Y=j,v=Y.replace(/\s+/g,""),V=ih(v);return V},_14O:function(V){var e=this._18O(V),f=this._15O(e);return f},_15O:function(N){var P=this._17O(N);if("2a864886f70d010101"==P._61O){var O=this._16O(P.key),Y=new cg;return Y._38O(O.n,O.e),Y}mi(aj)},_16O:function(o){var Q={};o.substr(0,2)!=Jl&&mi(aj);var H=bf._7O(o,0);return 2!=H.length&&mi(aj),o.substr(H[0],2)!=Ao&&mi(aj),Q.n=bf._11O(o,H[0]),o.substr(H[1],2)!=Ao&&mi(aj),Q.e=bf._11O(o,H[1]),Q},_17O:function(q){var H={};H._40O=w;var x=bf._7O(q,0);2!=x.length&&mi(aj);var O=x[0];q.substr(O,2)!=Jl&&mi(aj);var F=bf._7O(q,O);return 2!=F.length&&mi(aj),q.substr(F[0],2)!=Gf&&mi(aj),H._61O=bf._11O(q,F[0]),q.substr(F[1],2)==Gf?H._40O=bf._11O(q,F[1]):q.substr(F[1],2)==Jl&&(H._40O={},H._40O.p=bf._70O(q,F[1],[0],Ao),H._40O.q=bf._70O(q,F[1],[1],Ao),H._40O.g=bf._70O(q,F[1],[2],Ao)),q.substr(x[1],2)!=Mc&&mi(aj),H.key=bf._11O(q,x[1]).substr(2),H}},U._17O?U:w}(),wk=kq._27O=function(h){return kq._14O(h)};Vj=function(){return function(M,o){if(M&&o){o=od(o);var S=Tn(o,B(2,4)),i=this;if(!i||!i.n||S._55O()>i.n._55O())return 0;var y=i._37O(S),L=y[Kh](B(2,4)).replace(gq,""),v=_d(L);if(0==v.length)return!1;var U=v[0],q=v[1],n=function(K){return gk._4O.Util._56O(K,U)},Y=n(M);return q==Y}}.bind(wk(m))};var ke,vk;return function(){var h=ef.length-hb.length;if(h>0)for(var P=0;h>P;P++)ke=wh.Util,vk=od}(),zl=function(n,Z){Z=vk(Z);var s=wk(al),L=Ih.length,j=2*L,N=Tn(Z,B(L,j)),T=s,J=!0;if(T){var h=T[Dp[0]];h&&N._55O()<=h._55O()&&(J=!1)}if(J)return 0;var S=T._37O(N),p=S[Kh](B(L,j)).replace(gq,""),l=_d(p);if(0==l.length)return!1;var d=l[0],O=l[1],e=ke._11A(n,d);return O==e},kq}(u,I),og(C,{load:function(){var E={},D=function(f){return f?"c_"+(f.sync?"1":"0")+"_"+(f.post?"1":"0")+"_"+(f.responseType||"H")+"_"+(f.mimeType||"H")+"_"+(f.data?JSON.stringify(f.data):"H"):""};return function(Y,i,H){var O,$=E[Y],j=D(H);return $&&(O=$[j])?(O.push(i),void 0):(E[Y]||($=E[Y]={count:0}),O=$[j]=[i],$.count++,C.xhrLoad(Y,function(e){delete $[j],$.count--,$.count||delete E[Y],O.forEach(function(v){v(e)})},H),void 0)}}(),asyncEach:function(T,o,z){"function"!=typeof z&&(z=Function.prototype);var O=new Array(T.length),l=0,w=!1;T.forEach(function(Q,M){o(Q,function(o,Y){return w?void 0:o?(w=!0,z(null)):(O[M]=Y,l++,l===T.length?z(O):void 0)})})},xhrLoad:function(b,Z,E){var D=!1;qf(b)||(D=!0,b=[b]),E=E||{};var N=E.sync,K=null,m=E.method||"GET";return E.post&&(m="POST"),E.method=m,C.asyncEach(b,function(X,J){var q=new Uc;X=C.beforeLoadURL(X),X.data?J(null,X.data):(E.url=encodeURI(X),E.responseType?q.setResponseType(E.responseType):q.setOverrideMimeType(E.mimeType||"text/plain"),q.onload=function(){200===this.status||0===this.status?J(null,q.getResponseText()):J(!0)},q.onerror=function(){J(!0)},q.send(E))},function(W){var C="function"==typeof Z;(C||N)&&(K=D&&W?W[0]:W,C&&Z(K))}),N?K:void 0}});var Pb=v.List=function(){this._as=[];var X,P,L=arguments.length;if(1===L){var x=arguments[0];if(eq(x)&&(x=x._as),qf(x))for(P=x.length,X=0;P>X;X++)this._as.push(x[X]);else x!=w&&this._as.push(x)}else if(L>1)for(X=0;L>X;X++)this._as.push(arguments[X])};zc("List",I,{forEach:function(i,W){this.each(i,W)},push:function(){for(var p=0;p<arguments.length;p++)this.add(arguments[p])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(I,b){return b===i?this._as.push(I):this._as.splice(b,0,I)},addAll:function(A){eq(A)&&(A=A._as),qf(A)?ho(this._as,A):this._as.push(A)},get:function($){return this._as[$]},slice:function(B,s){return new Pb(this._as.slice(B,s))},remove:function(j){var E=this._as.indexOf(j);return E>=0&&E<this._as.length&&this.removeAt(E),E},removeAt:function(j){return this._as.splice(j,1)[0]},set:function(Y,S){return this._as[Y]=S},clear:function(){return this._as.splice(0,this._as.length)},contains:function(x){return this._as.indexOf(x)>=0},indexOf:function(Q){return this._as.indexOf(Q)},each:function(U,l){for(var C=0,$=this._as.length;$>C;C++){var E=this._as[C];l?U.call(l,E,C,this):U(E,C,this)}},reverseEach:function(W,n){for(var Y=this._as.length-1;Y>=0;Y--){var H=this._as[Y];n?W.call(n,H):W(H)}},getArray:function(){return this._as},toArray:function(z,m){if(z){for(var o,Z=[],q=0,j=this._as.length;j>q;q++)o=this._as[q],m?z.call(m,o)&&Z.push(o):z(o)&&Z.push(o);return Z}return this._as.concat()},toList:function(D,v){if(D){for(var T,j=new Pb,F=0,E=this._as.length;E>F;F++)T=this._as[F],v?D.call(v,T)&&j.add(T):D(T)&&j.add(T);return j}return new Pb(this)},reverse:function(){this._as.reverse()},sort:function(S){return this._as.sort(S?S:xr),this},toString:function(){return this._as.toString()}}),I.defineProperties(Pb.prototype,{length:{get:function(){return this._as.length},set:function(m){this._as.length=m}}});var Hk=new Pb;og(Hk,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Wf,each:Wf,reverseEach:Wf,toArray:function(){return[]},toList:function(){return new Pb},add:mn,addAll:mn,set:mn,remove:mn,removeAt:mn,clear:mn});var ch=v.Notifier=function(){this._f=0};zc("Notifier",I,{contains:function(A,B){if(this._ls)for(var y,J=0,u=this._ls.size();u>J;J++)if(y=this._ls.get(J),A===y.l&&B===y.s)return!0;return!1},add:function(z,A,e){var S=this,k={l:z,s:A,a:e};S._ls||(S._ls=new Pb),S._f?(S._as||(S._as=new Pb),S._as.add(k)):k.a?S._ls.add(k,0):S._ls.add(k)},remove:function(e,k){var R=this;R._ls&&(R._f?(R._rs||(R._rs=new Pb),R._rs.add({l:e,s:k})):R._remove(e,k))},_remove:function(t,W){for(var R,m=this._ls,_=0,O=m.size();O>_;_++)if(R=m.get(_),R.l===t&&R.s===W)return m.removeAt(_),void 0},fire:function(i){var w=this,X=w._ls;if(w._b=1e4,X){++w._f;try{for(var d,o=0,y=X.size();y>o;o++)d=X.get(o),d.s?d.l.call(d.s,i):d.l(i)}catch(i){_(function(){throw i})}finally{if(--w._f)return;if(w._rs){for(y=w._rs.size(),o=0;y>o;o++)d=w._rs.get(o),w._remove(d.l,d.s);delete w._rs}if(w._as){for(y=w._as.size(),o=0;y>o;o++)d=w._as.get(o),d.a?X.add(d,0):X.add(d);delete w._as}}}}});var ji=v.Data=function(){this._id=Og()};zc("Data",I,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:w,_parent:w,_children:Hk,_childMap:w,_styleMap:w,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return w},_22Q:function(){return w},s:function(R,g){var k=this;if(2===arguments.length)k.setStyle(R,g);else{if(!as(R))return k.getStyle(R);for(var M in R)k.setStyle(M,R[M])}return k},fp:function(S,R,K,z,$){return this.firePropertyChange(S,R,K,z,$)},firePropertyChange:function(G,i,f,T,V){if(T){if(T(i,f))return!1}else if(i===f)return!1;var L=this,z=V||{};return z.property=G,z.oldValue=i,z.newValue=f,z.data=L,L._dataModel&&L._dataModel.handleDataPropertyChange(z),L.onPropertyChanged(z),!0},onPropertyChanged:function(y){var x=this,p=x._parent,h=y.property;if(Xh(p)){var z=x.s(Tf),q="s:ingroup"===h;(z&&Wq[h]||h===q)&&p._81I(),(z||q)&&p.fp("childChange",!0,!1)}dq(p)&&Wq[h]&&p.updateFromChildren()},_21I:function(m){var h=this;if(m&&h._dataModel)throw"Remove data from dataModel before adding";h._dataModel=m},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var w=0,z=this._children.toArray(),W=z.length;W>w;w++)z[w].removeFromDataModel()},getId:function(){return this._id},setId:function(a){this._id=a},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(o,Y){return this._children.toList(o,Y)},eachChild:function(d,E){this._children.each(d,E)},addChild:function(J,D){var l=this;J!==l&&(l._children===Hk&&(l._children=new Pb,l._childMap={}),D>=0||(D=l._children.size()),l._childMap[J._id]||l.isDescendantOf(J)||(J._parent&&J._parent.removeChild(J),(0>D||D>l._children.size())&&(D=l._children.size()),l._children.add(J,D),l._childMap[J._id]=J,J.setParent(l),l.onChildAdded(J,D),l.fp($n,w,J)))},onChildAdded:function(){},removeChild:function(G){var J=this;if(J._childMap&&J._childMap[G._id]){var T=J._children.remove(G);delete J._childMap[G._id],J.fp($n,G,w),G.setParent(w,T),J.onChildRemoved(G,T)}},onChildRemoved:function(){},getChildAt:function(V){return this._children.get(V)},clearChildren:function(){var l=this;if(!l._children.isEmpty())for(var $=0,i=l._children.toArray(),j=i.length;j>$;$++)l.removeChild(i[$])},getParent:function(){return this._parent},setParent:function(M,J){var T=this;if(!(T._73I||T._parent===M||T===M||M&&M.isDescendantOf(T))){var O,z=T._parent;T._parent=M,T._73I=1,z?(J==w&&(J=z.getChildren().indexOf(T)),z.removeChild(T)):T._dataModel&&J==w&&(J=T._dataModel.getRoots().indexOf(T)),M&&(M.addChild(T),O=M.getChildren().indexOf(T)),delete T._73I,T.fp("parent",z,M,i,{oldIndex:J,newIndex:O}),T.onParentChanged(z,M)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(O){return O?this.isDescendantOf(O)||O.isDescendantOf(this):!1},isParentOf:function(b){return b&&this._childMap?!!this._childMap[b._id]:!1},isDescendantOf:function(w){if(!w||w.isEmpty())return!1;for(var $=this._parent;$;){if(w===$)return!0;$=$._parent}return!1},getStyle:function(W,z){z===i&&(z=1);var N=this._styleMap?this._styleMap[W]:i;return N===i&&z?Y[W]:N},setStyle:function(P,v){var a=this;a._styleMap||(a._styleMap={});var N=a._styleMap[P];v===i?delete a._styleMap[P]:a._styleMap[P]=v,a.fp("s:"+P,N,v)&&a.onStyleChanged(P,N,v)},onStyleChanged:function(){},iv:function(N){this.invalidate(N)},invalidate:function(R){this.fp(R||"*",!1,!0)},toString:function(){var J=this;return J._displayName||J._name||J._tag||J._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(A,k){var M=this,K=M.s(vn);K||M.s(vn,K={}),k?K[A]=k:delete K[A],M.fp(vn,w,K)},removeStyleIcon:function(a){var m=this.s(vn);if(m){var G=m[a];delete m[a],this.fp(vn,w,m)}return G},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var x,I={};for(x in this._styleMap)I[x]=1;return I},getCurrentPrefix:function(){return this._interactPrefix||xe},ca:function(W,p){var q=this.getCurrentPrefix();return W=q+W,2===arguments.length?this.a(W,p):this.a(W)}});var Ln=v.DataModel=function(){var B=this;B._datas=new Pb,B._dataMap={},B._roots=new Pb,B._rootMap={},B._fsDataMap={},B._78O={},B._reflectorMap={},B._36I=new ch,B._35I=new ch,B._serializeNotifier=new ch,B._selectionModel=new Ce(B);var V=B._29Q=[],s=B._scheduleCallback=function(){for(var O=Date.now(),S=0;S<V.length;S++){var R=V[S];R.enabled&&O-R.lastTime>R.interval&&(R.beforeAction&&R.beforeAction(),R.action&&B.each(function(c){R.action(c)}),R.afterAction&&R.afterAction(),R.lastTime=O)}V.length&&(B._30Q=u.requestAnimationFrame(s))}};zc("DataModel",I,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:i,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:i,_init:i,_envmap:i,_postProcessingData:i,sm:function(){return this.getSelectionModel()},mm:function(i,R,p){this.addDataModelChangeListener(i,R,p)},umm:function(l,p){this.removeDataModelChangeListener(l,p)},md:function(v,D,R){this.addDataPropertyChangeListener(v,D,R)},umd:function(x,K){this.removeDataPropertyChangeListener(x,K)},mh:function(y,E,K){this.addHierarchyChangeListener(y,E,K)},umh:function(B,k){this.removeHierarchyChangeListener(B,k)},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(u){return this._dataMap[u]},removeDataById:function(y){this.remove(this.getDataById(y))},toDatas:function(s,b){return this._datas.toList(s,b)},each:function(N,u){this._datas.each(N,u)},getDataByTag:function(v){return this._78O[v]},getTagMap:function(){return this._78O},removeDataByTag:function(R){this.remove(this.getDataByTag(R))},add:function(u,r,C){var s=this,e=u._id,x=u._tag,T=s._roots;if(s._dataMap[e])throw"'"+e+"' already exists";x!=w&&(s._78O[x]=u),s._dataMap[e]=u,C>=0?s._datas.add(u,C):s._datas.add(u),u._parent||(s._rootMap[e]=u,r>=0?T.add(u,r):T.add(u)),u.s("fullscreen")!==i&&(s._fsDataMap[e]=u),u.s("shape3d.reflector")&&(s._reflectorMap[e]=u),u._21I(s),s.onAdded(u),s._36I.fire({kind:"add",data:u,rootsIndex:r,datasIndex:C})},onAdded:function(){},remove:function(T,D){if(T){var a=this,V=T._id,r=D&&D.keepStructure,N=D&&D.keepChildren,O=T.getTag();if(T._dataModel===a){this.beginTransaction(),r?a._removingData||(a._removingData=T):a.prepareRemove(T),N||T.toChildren().each(function(X){a.remove(X,D)},a),r?a._removingData===T&&(T._parent&&T._parent.removeChild(T),delete a._removingData):T._parent&&T._parent.removeChild(T);var g=a._datas.remove(T);delete a._dataMap[V],O!=w&&delete a._78O[O];var G;a._rootMap[V]&&(delete a._rootMap[V],G=a._roots.remove(T)),a._fsDataMap[V]&&delete a._fsDataMap[V],a._reflectorMap[V]&&delete a._reflectorMap[V],T._21I(w),a.onRemoved(T),a._36I.fire({kind:rh,data:T,rootsIndex:G,datasIndex:g}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var B=this;if(B._datas.size()){var Q=B._historyManager?this.toJSON():i;B._datas.toArray().forEach(function(b){b._21I(w)}),B._datas.clear(),B._dataMap={},B._roots.clear(),B._rootMap={},B._fsDataMap={},B._reflectorMap={},B._78O={},B._36I.fire({kind:yc,json:Q})}},contains:function(E){return E&&E._dataModel===this},handleDataPropertyChange:function(O){var L=this,X=O.data,z=O.property;if("parent"===z){var M=X._id,K=L._rootMap,h=L._roots;X._parent?K[M]&&(delete K[M],h.remove(X)):K[M]||(K[M]=X,h.add(X))}else if("tag"===z){var r=O.oldValue,v=O.newValue,H=L._78O;r!=w&&delete H[r],v!=w&&(H[v]=X)}else if("s:fullscreen"===z){var M=X._id,D=L._fsDataMap;O.oldValue!=w&&delete D[M],O.newValue!=w&&(D[M]=X)}else if("s:shape3d.reflector"===z){var M=X._id,I=L._reflectorMap;O.oldValue&&delete I[M],O.newValue&&(I[M]=X)}this.onDataPropertyChanged(X,O),this._35I.fire(O)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(j,q,z){this._36I.add(j,q,z)},removeDataModelChangeListener:function(h,M){this._36I.remove(h,M)},addSerializeListener:function(Q,I,L){this._serializeNotifier.add(Q,I,L)},removeSerializeListener:function(L,X){this._serializeNotifier.remove(L,X)},fireSerializeEvent:function(x){this._serializeNotifier.fire(x)},addDataPropertyChangeListener:function(d,S,K){this._35I.add(d,S,K)},removeDataPropertyChangeListener:function($,W){this._35I.remove($,W)},_38I:function(E,$,P){this._37I&&this._37I.fire({data:E,oldIndex:$,newIndex:P})},addHierarchyChangeListener:function($,U,_){this._37I||(this._37I=new ch),this._37I.add($,U,_)},removeHierarchyChangeListener:function(r,O){this._37I.remove(r,O)},getSiblings:function(B){var V=B._parent;return V?V._children:this._roots},eachByHierarchical:function(f,M,a){if(M)return this._eachByHierarchical(f,M,a);for(var u=0,E=this._roots,U=E.size();U>u;u++)if(this._eachByHierarchical(f,E.get(u),a)===!1)return!1;return!0},_eachByHierarchical:function(U,q,y){if(y){if(U.call(y,q)===!1)return!1}else if(U(q)===!1)return!1;for(var V=q.size(),K=0;V>K;K++)if(this._eachByHierarchical(U,q.getChildAt(K),y)===!1)return!1;return!0},reverseEachByHierarchical:function(R,G,z){if(G)return this._reverseEachByHierarchical(R,G,z);for(var X=this._roots,U=X.size(),x=U-1;x>=0;x--)if(this._reverseEachByHierarchical(R,X.get(x),z)===!1)return!1;return!0},_reverseEachByHierarchical:function(_,Z,I){for(var K=Z.size(),X=K-1;X>=0;X--)if(this._reverseEachByHierarchical(_,Z.getChildAt(X),I)===!1)return!1;if(I){if(_.call(I,Z)===!1)return!1}else if(_(Z)===!1)return!1;return!0},eachByDepthFirst:function(b,U,Y){if(U)return this._11I(b,U,Y);for(var l=0,m=this._roots,Q=m.size();Q>l;l++)if(this._11I(b,m.get(l),Y)===!1)return!1;return!0},_11I:function(G,x,F){for(var y=x.size(),w=0;y>w;w++)if(this._11I(G,x.getChildAt(w),F)===!1)return!1;if(F){if(G.call(F,x)===!1)return!1}else if(G(x)===!1)return!1;return!0},eachByBreadthFirst:function(Y,s,Z){var j=new Pb;for(s?j.add(s):this._roots.each(j.add,j);j.size()>0;)if(s=j.removeAt(0),s.eachChild(j.add,j),Z){if(Y.call(Z,s)===!1)return!1}else if(Y(s)===!1)return!1;return!0},moveTo:function(x,q){var V=this.getSiblings(x),$=V.indexOf(x);$===q||0>$||q>=0&&q<=V.size()&&(V.remove(x),q>V.size()&&q--,V.add(x,q),this._38I(x,$,q))},moveUp:function(f){this.moveTo(f,this.getSiblings(f).indexOf(f)-1)},moveDown:function(v){this.moveTo(v,this.getSiblings(v).indexOf(v)+1)},moveToTop:function(Y){this.moveTo(Y,0)},moveToBottom:function(N){this.moveTo(N,this.getSiblings(N).size())},moveSelectionUp:function(t){this.beginTransaction(),t||(t=this.sm());var R=new Pb;qe(t,R,this._roots),R.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(x){this.beginTransaction(),x||(x=this.sm());var e=new Pb;Rp(x,e,this._roots),e.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(E){this.beginTransaction(),E||(E=this.sm());var g=new Pb;Zl(E,g,this._roots),g.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(z){this.beginTransaction(),z||(z=this.sm());var p=new Pb;vk(z,p,this._roots),p.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(W,s,C){var T=this.getDatas();null==C&&(C=T.indexOf(W)),C===s||0>C||s>=0&&s<=T.size()&&(T.remove(W),s>T.size()&&s--,T.add(W,s),this._76I(W,C,s))},bringForward:function(o){this.moveToIndex(o,this.getDatas().indexOf(o)+1)},bringToFront:function(M){this.moveToIndex(M,this.size())},sendBackward:function(i){this.moveToIndex(i,this.getDatas().indexOf(i)-1)},sendToBack:function(V){this.moveToIndex(V,0)},bringSelectionForward:function(l){this.beginTransaction(),l||(l=this.sm());for(var q=new Pb,u=this.getDatas(),C=!1,N=0;N<u.size();N++){var j=u.get(u.size()-1-N);l.contains(j)?C&&q.add(j):C=!0}q.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(Y){this.beginTransaction(),Y||(Y=this.sm());for(var p=new Pb,E=this.getDatas(),R=0;R<E.size();R++){var e=E.get(R);Y.contains(e)&&p.add(e)}p.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(D){this.beginTransaction(),D||(D=this.sm());for(var O=new Pb,J=this.getDatas(),C=!1,X=0;X<J.size();X++){var h=J.get(X);D.contains(h)?C&&O.add(h):C=!0}O.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(m){this.beginTransaction(),m||(m=this.sm());for(var K=new Pb,z=this.getDatas(),D=0;D<z.size();D++){var p=z.get(z.size()-1-D);m.contains(p)&&K.add(p)}K.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(J){var o=this;o.removeScheduleTask(J),J.enabled==w&&(J.enabled=!0),J.interval==w&&(J.interval=10),J.lastTime=Date.now(),o._29Q.push(J),o._30Q==w&&(o._30Q=u.requestAnimationFrame(o._scheduleCallback))},removeScheduleTask:function($){var V=this,o=V._29Q,f=o.indexOf($);f>=0&&o.splice(f,1),o.length||V._30Q==w||(u.cancelAnimationFrame(V._30Q),delete V._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(F){this._historyManager||new v.HistoryManager(this),null!=F&&this._historyManager.setMaxHistoryCount(F),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(G){this._historyManager&&this._historyManager.undo(G)},redo:function(n){this._historyManager&&this._historyManager.redo(n)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(P){this._historyManager&&this._historyManager.addHistory(P)},onHistoryManagerChanged:function(){}});var Ce=v.SelectionModel=function(Z){var K=this;K._68O=hi,K._map={},K._73O=new Pb,K._74I=new ch,K._21I(Z)};zc("SelectionModel",I,{ms_fire:1,ms_dm:1,ms:function(b,h,d){this.addSelectionChangeListener(b,h,d)},ums:function(o,i){this.removeSelectionChangeListener(o,i)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===yj},co:function(j){return this._map[j._id]!=w},ss:function(A){this.setSelection(A)},as:function(C){this.appendSelection(C)},rs:function(d){this.removeSelection(d)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(u){var O=this;if(O._68O!==u&&(u===Dp||u===yj||u===hi)){O.cs();var I=O._68O;O._68O=u,O.fp("selectionMode",I,u)}},_21I:function(J){var $=this,z=$._dataModel;z!==J&&(z&&($.cs(),z.umm($.handleDataModelChange,$)),$._dataModel=J,J.mm($.handleDataModelChange,$,!0),$.fp(sj,z,J))},dispose:function(){var H=this;H.cs(),H._dataModel.umm(H.handleDataModelChange,H)},handleDataModelChange:function(J){var _=this;if(J.kind===rh){var r=J.data;_.co(r)&&(_._73O.remove(r),delete _._map[r._id],_._75I(rh,new Pb(r)))}else J.kind===yc&&_.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(s){var J=this;if(J._filterFunc!==s){J.cs();var K=J._filterFunc;J._filterFunc=s,J.fp("filterFunc",K,J._filterFunc)}},_75I:function(w,u,q,b){q&&(this._73O.each(function(t){b[t._id]?q.remove(t):q.add(t)}),u=q.toList()),this._74I.fire({kind:w,datas:new Pb(u)})},addSelectionChangeListener:function(X,o,O){this._74I.add(X,o,O)},removeSelectionChangeListener:function(U,W){this._74I.remove(U,W)},_97O:function(y,o){for(var z,S=this,g=0,R=new Pb(y);g<R.size();g++)z=R.get(g),(S._filterFunc&&!S._filterFunc(z)||o&&S.co(z)||!o&&!S.co(z)||!S._dataModel.contains(z))&&(R.removeAt(g),g--);return R},appendSelection:function(B){var X=this;if(X._68O!==Dp){var m,g,s=X._73O,F=X._97O(B,!0);F.isEmpty()||(X.sg()&&(m=new Pb(s),g=X._map,s.clear(),X._map={},F=new Pb(F.get(F.size()-1))),F.each(function(I){s.add(I),X._map[I._id]=I}),X._75I("append",F,m,g))}},removeSelection:function(J){var E=this,e=E._97O(J),q=0,y=e.size();if(0!==y){for(;y>q;q++){var u=e.get(q);E._73O.remove(u),delete E._map[u._id]}E._75I(rh,e)}},toSelection:function(B,G){return this._73O.toList(B,G)},getSelection:function(){return this._73O},each:function(o,X){this._73O.each(o,X)},setSelection:function(J){var q=this,P=q._73O;if(q._68O!==Dp&&!(P.isEmpty()&&!J||1===P.size()&&q.ld()===J)){var H=new Pb(P),x=q._map;P.clear(),q._map={};var h=q._97O(J,!0);q.sg()&&h.size()>1&&(h=new Pb(h.get(h.size()-1))),h.each(function(v){P.add(v),q._map[v._id]=v}),q._75I("set",w,H,x)}},clearSelection:function(){var o=this,C=o._73O;if(C.size()>0){var K=C.toList();C.clear(),o._map={},o._75I(yc,K)}},selectAll:function(){var C=this;if(C._68O!==Dp){var r,B,Q=C._dataModel.toDatas();if(C._filterFunc)for(r=0;r<Q.size();r++)B=Q.get(r),C._filterFunc(B)||(Q.removeAt(r),r--);var Z=C._73O,J=new Pb(Z),M=C._map;Z.clear(),C._map={},C.sg()&&Q.size()>1&&(Q=new Pb(Q.get(Q.size()-1)));var k=Q.size();for(r=0;k>r;r++)B=Q.get(r),Z.add(B),C._map[B._id]=B;C._75I("all",w,J,M)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(C){return this._map[C._id]!=w},getLastData:function(){var M=this._73O;return M.size()>0?M.get(M.size()-1):w},getFirstData:function(){var p=this._73O;return p.size()>0?p.get(0):w
},isSelectable:function(h){var C=this;return h&&C._68O!==Dp?C._filterFunc?C._filterFunc(h):!0:!1},getTopSelection:function(){var B=this,z=new Pb;return B._73O.each(function(c){for(var O=c.getParent();O;){if(B.contains(O)){c=w;break}O=O.parent}c&&z.add(c)}),z}});var je=function(){return cf(0),function(m,H){var F;if(eg(H)){var G=m.getDataUI(H);G&&G._88I&&(F=G._88I.rect)}return F?F:H.getRect()}}();og(C,{edgeGroupAgentFunc:w,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:E.rectSelectBorder,graphViewRectSelectBackground:Oq,graphViewEditPointSize:ij?17:7,graphViewEditPointBorderColor:E.editPointBorder,graphViewEditPointBackground:E.editPointBackground,setEdgeType:function(c,C,z){Pc[c]=C,ud[c]=z},getEdgeType:function(j){return Pc[j]},getEdgeTypeMap:function(){return Pc},getNodeRect:je},!0),og(Y,{"layout.h":i,"layout.v":i,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":i,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:i,ingroup:!0,"body.color":i,"2d.gray":!1,fullscreen:i,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:i,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Un,"select.width":1,"select.padding":2,"select.type":Ph,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":i,"border.width":2,"border.padding":2,"border.type":Ph,label:i,"label.font":i,"label.color":Ji,"label.background":i,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":i,"label.max":i,"label.opacity":i,"label.scale":1,"label.align":i,"label.selectable":!0,label2:i,"label2.font":i,"label2.color":Ji,"label2.background":i,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":i,"label2.max":i,"label2.opacity":i,"label2.scale":1,"label2.align":i,"label2.selectable":!0,note:i,"note.expanded":!0,"note.font":i,"note.color":$m,"note.background":Un,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":i,"note.toggleable":!0,"note.border.width":1,"note.border.color":i,"note.opacity":i,"note.scale":1,"note.align":i,note2:i,"note2.expanded":!0,"note2.font":i,"note2.color":$m,"note2.background":Un,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":i,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":i,"note2.opacity":i,"note2.scale":1,"note2.align":i,"group.type":i,"group.image":i,"group.image.stretch":"fill","group.repeat.image":i,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":i,"group.title.color":$m,"group.title.background":E.groupTitleBackground,"group.title.align":Nh,"group.title.orientation":Gh,"group.background":E.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":i,"group.border.color":Pd,"group.border.radius":0,"group.border.cap":gd,"group.border.join":to,"group.splitLine":!1,"group.gradient":w,"group.gradient.color":"#FFF",shape:i,"shape.background":Pd,"shape.repeat.image":i,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Pd,"shape.border.3d":!1,"shape.border.3d.color":i,"shape.border.3d.accuracy":i,"shape.border.cap":gd,"shape.border.join":to,"shape.border.pattern":i,"shape.gradient":w,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":mg,"shape.dash.offset":0,"shape.dash.color":rc,"shape.dash.width":i,"shape.dash.3d":!1,"shape.dash.3d.color":i,"shape.dash.3d.accuracy":i,"shape.polygon.side":6,"shape.arc.from":Q,"shape.arc.to":e,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":i,"shape.gradient.pack":i,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":i,"shape.foreground.gradient":w,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":i,"autolayout.hgap":i,"autolayout.vgap":i,"edge.type":i,"edge.points":i,"edge.segments":i,"edge.color":Pd,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":i,"edge.3d.accuracy":i,"edge.cap":gd,"edge.join":to,"edge.source.position":17,"edge.source.anchor.x":i,"edge.source.anchor.y":i,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":i,"edge.target.anchor.y":i,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":i,"edge.dash":!1,"edge.dash.pattern":mg,"edge.dash.offset":0,"edge.dash.color":rc,"edge.dash.width":i,"edge.dash.3d":!1,"edge.dash.3d.color":i,"edge.dash.3d.accuracy":i,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":i,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":i,"grid.column.percents":i,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":E.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":E.gridCellBorderColor,"grid.block":i,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":E.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Ji,"text.font":Eo,"text.shadow":!1,"text.shadow.color":Un,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:i},!0),og(Ln,{_76I:function(d,E,I){this._39I&&this._39I.fire({data:d,oldIndex:E,newIndex:I})},addIndexChangeListener:function(V,b,q){var F=this;F._39I||(F._39I=new ch),F._39I.add(V,b,q)},removeIndexChangeListener:function(p,P){this._39I.remove(p,P)},prepareRemove:function(l){kn(l)&&(l.setSource(w),l.setTarget(w)),l._70O&&l._70O.toList().each(this.remove,this),l._69O&&l._69O.toList().each(function(v){v.setHost(w)}),l._host&&l.setHost(w)},onAdded:function(o){this.isAutoAdjustIndex()&&this.adjustIndex(o)},onDataPropertyChanged:function(O,z){wp[z.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(O)},isAdjustable:function(B){return gr(B)||kn(B)},isAdjustedToBottom:function(N){return Xh(N)?N.isExpanded()&&Fp(N):!1},adjustIndex:function(z){var L=this;this.isHierarchicalRendering()||(L.isAdjustedToBottom(z)?(L.sendToBottom(z),z.eachChild(L.adjustIndex,L)):L.sendToTop(z))},sendToTop:function(q){var k=this;if(k.contains(q)&&k.isAdjustable(q)){var K=k._datas;if(q!==K.get(k.size()-1)){var v=K.indexOf(q);K.removeAt(v),K.add(q),k._76I(q,v,k.size()-1)}if(kn(q)){var t=q._40I;t&&!k.isAdjustedToBottom(t)&&k.sendToTop(t),t=q._41I,t&&!k.isAdjustedToBottom(t)&&k.sendToTop(t)}q._69O&&q._69O.each(function(r){r.isRelatedTo(q)||gr(q)&&r.isLoopedHostOn(q)||k.sendToTop(r)}),q.ISubGraph||(!Xh(q)||q.isExpanded())&&q._adjustChildrenToTop&&q.eachChild(function(B){kn(B)||k.sendToTop(B)})}},sendToBottom:function(R,h){var I=this;if(R!==h&&I.contains(R)&&I.isAdjustable(R)&&(!h||I.contains(h))){var V=I._datas,w=V.remove(R),g=h?I._datas.indexOf(h):0;if(V.add(R,g),w!==g){I._76I(R,w,g);var T=R._parent;!T||T.ISubGraph||kn(T)||I.sendToBottom(R._parent,R)}}}}),og(Ib,{ms_edit:function(A){A._46O=function(p){var f=this,e=f.gv.dm(),g=f._index,I=f._89I,k=f._node,P=f._shape,y=f._edge,d=f._77I;k&&I?(this.fi({kind:"endEditRect",event:p,data:k,direction:I}),e.endTransaction()):P&&g>=0?(f.fi({kind:"endEditPoint",event:p,data:P,index:g}),e.endTransaction()):y&&g>=0?(f.fi({kind:"endEditPoint",event:p,data:y,index:g}),e.endTransaction()):d&&(f.fi({kind:"endEditRotation",event:p,data:d}),e.endTransaction())},A._78I=function(E){var G=this;G.autoScroll(E);var N=G.gv.lp(E),u=G._index,J=G._89I,O=G._node,p=G._shape,v=G._edge,$=G._77I;if(O&&J)G._80O(N),G.fi({kind:"betweenEditRect",event:E,data:O,direction:J});else if(p&&u>=0)N.e=p.getPoints().get(u).e,p.setPoint(u,N),G.fi({kind:"betweenEditPoint",event:E,data:p,index:u});else if(v&&u>=0){var U=v.s(Gg);N.e=U.get(u).e,U.set(u,N),v.fp(Gg,w,U),G.fi({kind:"betweenEditPoint",event:E,data:v,index:u})}else if($){var V=$.p(),A=$.getScale(),t=k+T(N.y-V.y,N.x-V.x);A.y<0&&(t+=Q),l(t)<.04&&(t=0),$.setRotation(t),G.fi({kind:"betweenEditRotation",event:E,data:$})}},A._80O=function(W){var m=this,D=m._node,M=m._rect,K=M.x,t=M.y,H=M.width,h=M.height,N=m._89I,E=m._anchor,Q=m._matrix,W=Q.tfi(W);"northwest"===N?M=ye(W,{x:K+H,y:t+h}):N===Lr?M=ye({x:K,y:W.y},{x:K+H,y:t+h}):"northeast"===N?M=ye({x:K,y:W.y},{x:W.x,y:t+h}):N===xc?M=ye({x:W.x,y:t},{x:K+H,y:t+h}):N===Sf?M=ye({x:K,y:t},{x:W.x,y:t+h}):"southwest"===N?M=ye({x:W.x,y:t},{x:K+H,y:W.y}):"south"===N?M=ye({x:K,y:t},{x:K+H,y:W.y}):"southeast"===N&&(M=ye({x:K,y:t},W)),D.setPosition(Q.tf(M.x+M.width*E.x,M.y+M.height*E.y)),D.setWidth(M.width),D.setHeight(M.height)},A._80I=function(u,l,_,c){var i=this,U=i.gv._zoom,G=(i.gv.getEditPointSize()+2)/U;return gg({x:l-G/2,y:_-G/2,width:G,height:G},u)?(i._89I!==c&&(i._89I=c),!0):!1},A._79I=function(p,a,Y){var S=this,R=S.gv,z=a?R.getDataUI(a):w,B=z?z._55O:w;if(B){var x,N,f,k,F=R._zoom,E=(R.getEditPointSize()+2)/F,g=R.lp(p);if(gr(a)){if(B._56O&&gr(a)&&(N=B._98o,gg({x:N.x-E/2,y:N.y-E/2,width:E,height:E},g)))return S._77I=a,Y&&S.fi({kind:"beginEditRotation",event:p,data:a}),S.setCursor("crosshair"),!0;if(B._43O&&a instanceof bn)for(f=a.getPoints(),x=f.size()-1;x>=0;x--)if(N=f.get(x),gg({x:N.x-E/2,y:N.y-E/2,width:E,height:E},g))return S._index=x,S._shape=a,Y&&S.fi({kind:"beginEditPoint",event:p,data:a,index:x}),S.setCursor("crosshair"),!0;if(B._42O)for(var C=a.getEditControlPoints(),_=["northwest",-1,-1,xc,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Sf,1,0,"northeast",1,-1,Lr,0,-1],x=0,k=C.length;k>x;x++){var P=_[3*x],t=C[x];if(S._80I(g,t.x,t.y,P)){S._node=a;var h=a.getWidth(),r=a.getHeight(),V=a.getAnchor();S._rect={x:-h*V.x,y:-r*V.y,width:h,height:r},S._anchor=V,S._matrix=a.getMatrix();var M=a.getRotation(),Q=b(M),W=y(M),m=_[3*x+1]*Jn(a.getScale().x),q=_[3*x+2]*Jn(a.getScale().y),K=Math.atan2(-W*m-Q*q,Q*m-W*q),e=(Math.round(K/(Math.PI/4))+8)%8,o=[rb,"nesw-resize",Cg,"nwse-resize",rb,"nesw-resize",Cg,"nwse-resize"][e];return S.setCursor(o),Y&&S.fi({kind:"beginEditRect",event:p,data:a,direction:S._89I}),!0}}}if(B._43O&&kn(a)&&a.s(tp)===qc&&(f=a.s(Gg)))for(x=f.size()-1;x>=0;x--)if(N=f.get(x),gg({x:N.x-E/2,y:N.y-E/2,width:E,height:E},g))return S._index=x,S._edge=a,Y&&S.fi({kind:"beginEditPoint",event:p,data:a,index:x}),S.setCursor("crosshair"),!0}return!1}},ms_gv:function(f){f._currentSubGraph=w,f._fpsInfo={time:0,fps:0,frames:0},f.upSubGraph=function(){this.setCurrentSubGraph(Fl(this._currentSubGraph))},f.isVisible=function(n){var l=this;if(Fl(n)!==l._currentSubGraph)return!1;if(kn(n)){var S=n._40I,a=n._41I;if(!S||!a)return!1;if(!(n.s("edge.independent")||l.isVisible(S)&&l.isVisible(a)))return!1;if(n.isEdgeGroupHidden())return!1}else for(var p=n._parent;p&&!p.ISubGraph;){if(Xh(p)&&(!p.isExpanded()||!l.isVisible(p)))return!1;p=p._parent}if(n._parent instanceof jl&&!l.isVisible(n._parent))return!1;if(n._refGraph instanceof Do&&!l.isVisible(n._refGraph))return!1;if(l instanceof Pl){if(!n.s("3d.visible"))return!1}else{var g=l.getLayersInfo();if(g){var O=g[n._layer];if(O&&O.visible===!1)return!1}if(!n.s("2d.visible"))return!1}return l._visibleFunc?l._visibleFunc(n):!0},f.handleSelectionChange=function(Y){var $=this;Y.datas.each(function(k){$.invalidateData(k);var t=k._parent;Xh(t)&&gr(k)&&k.s(Tf)&&($.invalidateData(t),t._49I&&t._49I.each(function(E){$.invalidateData(E)}))}),$.onSelectionChanged(Y)},f.onSelectionChanged=function(z){var S=this,F=S.sm();if(1===F.size()&&("set"===z.kind||"append"===z.kind)){var v=F.ld();S.isAutoMakeVisible()&&S.makeVisible(v),S.adjustIndex&&S._dataModel.isAutoAdjustIndex()&&S.adjustIndex(v)}},f.makeVisible=function(j){if(j){var z=this,a=z.getDataUI?z.getDataUI(j):z.getData3dUI(j);if(a){var M=j,R=Fl(j);for(R!==z._currentSubGraph&&z.setCurrentSubGraph(R);(M=M._parent)&&M!==R;)Xh(M)&&M.setExpanded(!0);z._23I=j,z.iv()}}},f.getLabel=function(Q){var N=Q.getStyle(Xf);return N===i?Q.getName():N},f.getLabelBackground=function(q){return q.getStyle("label.background")},f.getLabelColor=function(f){return f.getStyle("label.color")},f.getLabel2=function(G){return G.getStyle("label2")},f.getLabel2Background=function(S){return S.getStyle("label2.background")},f.getLabel2Color=function(V){return V.getStyle("label2.color")},f.getNote=function(B){return B.getStyle(Mm)},f.getNoteBackground=function(f){return f.getStyle("note.background")},f.getNote2=function(Z){return Z.getStyle(Ie)},f.getNote2Background=function(l){return l.getStyle("note2.background")},f.handleClick=function(k,N,O){var I=this;N?(I.fi({kind:"clickData",event:k,data:N,part:O}),I.onDataClicked(N,k)):(I.fi({kind:"clickBackground",event:k}),I.onBackgroundClicked(k))},f.handleDoubleClick=function(N,D,h){var c=this;Lg(N)&&(D?(c.fi({kind:"doubleClickData",event:N,data:D,part:h}),c.onDataDoubleClicked(D,N,h),c.checkDoubleClickOnNote(N,D,h)||c.checkDoubleClickOnRotation&&c.checkDoubleClickOnRotation(N,D,h)||(kn(D)?c.onEdgeDoubleClicked(D,N,h):D.ISubGraph?c.onSubGraphDoubleClicked(D,N,h):Xh(D)?c.onGroupDoubleClicked(D,N,h):D.IDoorWindow?c.onDoorWindowDoubleClicked(D,N,h):D.ICSGBox&&c.onCSGBoxDoubleClicked(D,N,h))):(c.fi({kind:"doubleClickBackground",event:N}),c.onBackgroundDoubleClicked(N)))},f.onSubGraphDoubleClicked=function(h){this.setCurrentSubGraph(h)},f.onEdgeDoubleClicked=function(c,z){c.ISubGraph&&!_n(z)?this.setCurrentSubGraph(c):c.s("edge.toggleable")&&c.toggle()},f._39Q=function(R){return this.isInteractive(R)?this.preventDefaultWhenInteractive(R):!1},f.preventDefaultWhenInteractive=function(h){return h.s("preventDefaultWhenInteractive")},f.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},f.onDoorWindowDoubleClicked=function(A){A.s("dw.toggleable")&&A.toggle(!0)},f.onCSGBoxDoubleClicked=function(x,Y){var T=this;if(T instanceof Pl){var X=T.getHitFaceInfo(Y);X&&X.face&&x.s(X.face+".toggleable")&&x.toggleFace(X.face,!0)}},f.onBackgroundClicked=function(){},f.onBackgroundDoubleClicked=function(){this.upSubGraph()},f.onDataClicked=function(){},f.onDataDoubleClicked=function(){},f.onAutoLayoutEnded=function(){},f.onMoveEnded=function(){},f.onPanEnded=function(){},f.onPinchEnded=function(){},f.onRectSelectEnded=function(){},f.onZoomEnded=function(){},f.serialize=function(n){return this.dm().serialize(n)},f.toJSON=function(){return this.dm().toJSON()},f.deserialize=function(n,K){var C=this;K=K instanceof ji?{rootParent:K}:tl(K)?{setId:K}:Ad(K)?{finishFunc:K}:K||{},K.view=C;var S=C.dm(),I=K.finishFunc;return K.finishFunc=function(){I&&I.apply(K,arguments),tl(S.a("zoomable"))&&C.setZoomable&&C.setZoomable(S.a("zoomable")),tl(S.a("pannable"))&&C.setPannable&&C.setPannable(S.a("pannable")),tl(S.a("rectSelectable"))&&C.setRectSelectable&&C.setRectSelectable(S.a("rectSelectable")),S.a("fitContent")===!0&&C.fitContent&&C.fitContent(!0,0)},S.deserialize(n,K.rootParent,K)},f.showDebugTip=function(){var T=this,E=T._debugDiv;if(!E){E=T._debugDiv=j.createElement("div"),E.style.position="absolute",E.style.overflow="hidden",E.style.backgroundColor="white",E.style.color="black";var G=T.getView();T._79O?G.insertBefore(E,T._79O):G.appendChild(E);var o=function(){T.redraw();var q=T._canvas,_="FPS : "+T._fpsInfo.fps+"<br/>"+"Datas : "+T.dm().getDatas().length+(q?"<br/>Size : "+q.width+" * "+q.height:""),e=T.getDebugTip();e&&(_+="<br/>------<br/>"+e),E.innerHTML=_,T._isDebugging&&requestAnimationFrame(o)};requestAnimationFrame(o),T._isDebugging=!0}},f.hideDebugTip=function(){var j=this,G=j._debugDiv;G&&(delete j._debugDiv,j.getView().removeChild(G),j._isDebugging=!1)},f.updateDOMAppendMatrix=function(){var z=this.getView();z&&(z.updateAppendMatrix=!0)},f.countFrame=function(){if(this._isDebugging){var J=Date.now(),l=this._fpsInfo;J-l.time>1e3?(l.fps=Math.round(1e5*(l.frames+1)/(J-l.time))/100,l.time=J,l.frames=0):l.frames++}}},ms_icons:function(g){g.getRotation=function(i){return i==w?0:i},g._15O=function(){var H=this,k=H.s(vn);if(k){var Y=H,u=H.data||H._data,f=H._38o={icons:k,rects:{}};for(var z in k){var d=k[z],n=mo(d.shape3d,u,Y);if(!(mo(d.visible,u,Y)===!1||mo(d.for3d,u,Y)&&!H.I3d||n&&!H.I3d)){var p=n?[n]:mo(d.names,u,Y),J=p?p.length:0,P=mo(d.position,u,Y)||3,a=mo(d.offsetX,u,Y)||0,i=mo(d.offsetY,u,Y)||0,E=mo(d.direction,u,Y)||Sf,S=mo(d.gap,u,Y),U=S!=w?S:1,W=mo(d.rotation,u,Y),j=mo(d.keepOrien,u,Y),b=mo(d.rotationFixed,u,Y)?W:H.getRotation(W,j,P),x=w,t=f.rects[z]=new Array(J);t.rotation=b;for(var M=0;J>M;M++){var c,X,Z,V,I=p[M];if(n)Z=0,V=0;else{var e=Mf(I);Z=mo(d.width,u,Y),V=mo(d.height,u,Y),Z==w&&(Z=Xk(e,u)),V==w&&(V=Dg(e,u))}if(x?E===Sf?a+=Z/2:E===xc?a-=Z/2:E===Lr?i-=V/2:i+=V/2:x={width:Z,height:V},H.I3d){var m=-Z/2,Q=-V/2;X={width:Z,height:V,mat:H._16O(mo(d.autorotate,u,Y),P,x,mo(d.face,u,Y)||or,mo(d.t3,u,Y),mo(d.r3,u,Y),mo(d.rotationMode,u,Y),a,i),vs:new Ud([m,-Q,0,m,-Q-V,0,m+Z,-Q-V,0,m+Z,-Q,0])}}else c=H.getPosition(P,a,i,x,mo(d.positionFixed,u,Y)),X={x:c.x-Z/2,y:c.y-V/2,width:Z,height:V},H._68o(X,b);t[M]=X,E===Sf?a+=Z/2+U:E===xc?a-=Z/2+U:E===Lr?i-=V/2+U:i+=V/2+U}}}}}}});var Cd={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Nl={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Uh={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},wp={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Wq={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Ak={"edge.type":1,"edge.group":1},Jp={rotation:1,rotationX:1,rotationZ:1},lg={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},jh={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ti={shape:1,thickness:1,position:1,anchor:1,scale:1},Fl=function(N){if(!N)return w;if(kn(N)){var a=N._40I,q=N._41I;if(!a||!q)return w;var z=Fl(a),m=Fl(q);return z===m?z:w}for(var x=N._parent;kn(x)&&!x.ISubGraph;)x=x._parent;return x?x.ISubGraph?x:Fl(x):w},$l=function(F,V,I,d){var f=V.getStyle(I)*d;f&&Cc(F,f),f=V.getStyle(I+".left")*d,f&&(F.x-=f,F.width+=f),f=V.getStyle(I+".right")*d,f&&(F.width+=f),f=V.getStyle(I+".top")*d,f&&(F.y-=f,F.height+=f),f=V.getStyle(I+".bottom")*d,f&&(F.height+=f),F.width<0&&(F.width=-F.width,F.x-=F.width),F.height<0&&(F.height=-F.height,F.y-=F.height)},Fp=function(v){for(var q,i=0,s=v.size();s>i;i++)if(q=v.getChildAt(i),gr(q)&&Fp(q))return!0;return v.hasAgentEdges()},vs=function(F){if(!F)return w;for(var T=F._parent;Xh(T);){if(!Xh(T._parent))return T.isExpanded()?F:T;T.isExpanded()||(F=T),T=T._parent}return F},Mg=function(e,H){if(!e||!H)return w;var l,t,r,p=Fl(e),N=Fl(H);if(p!==N){for(;N&&p!==N;)N=Fl(N);if(p===N)return e;l=new Pb,l.add(e,0);for(var Y=e._parent;gr(Y)&&!H.isDescendantOf(Y);)l.add(Y,0),Y=Y._parent;for(r=l.size(),t=0;r>t;t++){var X=l.get(t);if(Xh(X)&&!X.isExpanded())return X;if(X.ISubGraph)return X}return e}return e},Nn=function(r){if(r.isLooped())return r._source;var B=vs(r._source),H=vs(r._target);return B===H?r._source:Mg(B,H)},ag=function(d){if(d.isLooped())return d._target;var R=vs(d._source),J=vs(d._target);return R===J?d._target:Mg(J,R)},Yk=function(M,B,_){"target"!==_&&(_="source");var c="target"===_?B.getTargetAgent():B.getSourceAgent(),r="edge."+_+".";if(kn(c)){var a=M.getDataUI(c);a._79o();var W=B.s(r+"index");if(W!==i){var Z=Yf(a);return Z[Math.max(0,Math.min(W,Z.length-1))]}var p=B.s(r+"percent")||0;p=Math.max(0,Math.min(p,1));var x=Cn(a);return Lm(x,100*p)}return Zr(M,c,B.s(r+"position"),B.s(r+"offset.x"),B.s(r+"offset.y"),B.s(r+"anchor.x"),B.s(r+"anchor.y"))},Zr=function(x,d,W,D,A,l,S){if(!d)return w;var Q,$=d.getRotation?d.getRotation():0;if(l!==i||S!==i){l=l===i?.5:l,S=S===i?.5:S;var n=d.getScale();if($&&!eg(d,x)||n.x<0||n.y<0){var E=d.getPosition(),c=d.getWidth(),t=d.getHeight(),m=d.getAnchor(),s=new yk($,E.x,E.y,n.x,n.y);W=s.tf((l-m.x)*c,(S-m.y)*t)}else Q=je(x,d),W={x:Q.x+l*Q.width,y:Q.y+S*Q.height}}else W=vb(W,je(x,d));if($){var F=b($),r=y($),h=D*F-A*r;A=D*r+A*F,D=h}return W.x+=D,W.y+=A,W},Gc=function(i,B){if(!i||!B)return w;var V,p,Z,D,n,j;if(i===B){if(D=i.getLoopedEdges(),!D)return w;D=new Pb(D)}else{if(n=i.getAgentEdges(),j=B.getAgentEdges(),!n||!j)return w;for(p=n.size(),V=0;p>V;V++)Z=n.get(V),j.contains(Z)&&(D||(D=new Pb),D.add(Z))}if(D)for(V=0;V<D.size();V++)Z=D.get(V),Z.getStyle(tp)===qc&&(Z._22I(w),D.removeAt(V),V--);return D},Ki=function(F,J){var U=Gc(F,J);if(U&&!U.isEmpty()){if(1===U.size())return U.get(0)._22I(w),void 0;var W=new Pb,t=new Pb;U.each(function(Q){var h=Q.s("edge.group");W.contains(h)||W.add(h)}),W.sort(),W.each(function(D){t.add(new v.EdgeGroup(U.toList(function(g){return D===g.s("edge.group")}),t))}),t.each(function(W){W.each(function(l){l._22I(W)})})}},cp=function(e,K,r){var S=e._canvas;e._zoom;var v=ii(K,S),B=ii(r,S);return{x:v.x-B.x,y:v.y-B.y}},Wo=function(J,g){if(g){var o=g.rect,$=g.color,Z=g.rotation,u=g.labelWidth,T=g.background,E=g.opacity,v=g.scale,m=v!=w&&1!==v;if(E!=w){var G=J.globalAlpha;J.globalAlpha*=E}if(Z||m){J.save();var Q=o.x+o.width/2,A=o.y+o.height/2;_k(J,Q,A),Z&&uh(J,Z),m&&J.scale(v,v),_k(J,-Q,-A)}if(T&&sc(J,o.x,o.y,o.width,o.height,T),u){var n=o.width,V=J.createLinearGradient(o.x,o.y,o.x+n,o.y);V.addColorStop(0,$),V.addColorStop(.9,$),V.addColorStop(1,uq),$=V,o.width=u}Xr(J,g.ss,o,g.font,$,g.align),u&&(o.width=n),(Z||m)&&J.restore(),E!=w&&(J.globalAlpha=G)}},Xe=function(r,T){if(T){var z=T.rect,O=z.x,P=z.y,m=z.width,C=z.height,a=T.background,R=T.backgroundImage,M=T.borderWidth,N=T.borderColor,B=T.labelWidth,s=T.opacity,i=T.scale,F=i!=w&&1!==i;if(s!=w){var o=r.globalAlpha;r.globalAlpha*=s}if(F){r.save();var $=z.x+z.width/2,A=z.y+z.height/2;_k(r,$,A),r.scale(i,i),_k(r,-$,-A)}if(T.expanded){var _=V(8,m/4),y=P+C-8;if(r.fillStyle=a,r.beginPath(),r.moveTo(O,P),r.lineTo(O,y),r.lineTo(O+m/2,y),r.lineTo(O+m/2,P+C),r.lineTo(O+m/2+_,y),r.lineTo(O+m,y),r.lineTo(O+m,P),r.closePath(),r.fill(),M&&(r.lineWidth=M,r.lineJoin="round",r.lineCap="round",N?(r.strokeStyle=N,r.stroke()):(r.strokeStyle=_m(a),r.beginPath(),r.moveTo(O+m,P),r.lineTo(O+m,y),r.lineTo(O+m/2+_,y),r.lineTo(O+m/2,P+C),r.stroke(),r.strokeStyle=Ro(a),r.beginPath(),r.moveTo(O+m,P),r.lineTo(O,P),r.lineTo(O,y),r.lineTo(O+m/2,y),r.lineTo(O+m/2,P+C),r.stroke())),R)nd(r,Mf(R),te,z.x,z.y,z.width,z.height-8,T.data,T.view);else{if(z.height-=8,a=T.color,B){var c=m,I=r.createLinearGradient(O,P,O+c,P);I.addColorStop(0,a),I.addColorStop(.9,a),I.addColorStop(1,uq),a=I,z.width=B}Xr(r,T.ss,z,T.font,a,T.align),B&&(z.width=c),z.height+=8}}else if(T.icon)lh(r,Mf(T.icon),O,P,m,C,T.data,T.view);else{var u=m/2;M&&(r.lineWidth=M,r.lineJoin="round",r.lineCap="round",r.strokeStyle=N?N:_m(a),r.beginPath(),r.arc(O+u,P+u,u,k,1.6*Q,!0),r.moveTo(O+u,P+C),r.lineTo(O+m-u/5,P+u),r.stroke(),r.strokeStyle=N?N:Ro(a),r.beginPath(),r.arc(O+u,P+u,u,1.6*Q,k,!0),r.moveTo(O+u,P+C),r.lineTo(O+u/5,P+u),r.stroke()),r.fillStyle=a,r.beginPath(),r.arc(O+u,P+u,u,0,e,!0),r.moveTo(O+u,P+C),r.lineTo(O+m-u/5,P+u),r.lineTo(O+u/5,P+u),r.closePath(),r.fill(),r.fillStyle=T.color,r.beginPath(),r.arc(O+u,P+u,u/3,0,e,!0),r.fill()}F&&r.restore(),s!=w&&(r.globalAlpha=o)}},wd=function(e,l){return l>2*e?e:l/2},Up=function(G,X,v,Y){if(!G||!X)return 0;var A=T(X.y-G.y,X.x-G.x);return v||(A=X.x<G.x?A+Q:A),A+Y},xd=function(Y,R,Q,p,z,A,y){y&&(Y.x>R.x||Y.x===R.x&&Y.y>R.y)&&(Q=Rl[Q],z=-z);var b=vb(Q,{x:0,y:0,width:Sp(Y,R),height:0},A);return b.x+=p,b.y+=z,b=new yk(T(R.y-Y.y,R.x-Y.x)).tf(b),b.x+=Y.x,b.y+=Y.y,b},Fh=function(l,g,F,X,c){if(l._19Q=!0,!F.getEdgeGroup())return X?F.s("edge.gap"):0;if(kn(F.getSourceAgent())||kn(F.getTargetAgent()))return 0;var i,h=0,U=0,I=0;if(F.getEdgeGroup().getSiblings().each(function(j){j.each(function(P){if(g.isVisible(P)&&P.s(tp)==c){var n=P.s("edge.gap");i?(U+=I/2+n/2,I=n):(i=P,I=n),P===F&&(h=U)}})}),X)return U-h+I;var $=h-U/2;return i&&F._40I!==i._40I&&(l._19Q=!1),$},Ol=function(){var O=function(j){var z=[];return j.forEach(function(V){z.push({x:V.x,y:V.y}),z.push({x:V.x+V.width,y:V.y+V.height}),z.push({x:V.x+V.width,y:V.y}),z.push({x:V.x,y:V.y+V.height})}),z};return function(I,B,d){if("oval"===I){var v=0,S=d.height/d.width,T=S*S,p=d.x+d.width/2,g=d.y+d.height/2,l=O(B);l.forEach(function(n){var D=n.x-p,t=n.y-g,I=D*D+t*t/T;I>v&&(v=I)}),v=Z(v);var z=S*v;return{x:p-v,y:g-z,width:2*v,height:2*z}}if("circle"===I){var A=0,p=d.x+d.width/2,g=d.y+d.height/2,l=O(B);return l.forEach(function(e){var R=e.x-p,_=e.y-g,l=R*R+_*_;l>A&&(A=l)}),A=Z(A),{x:p-A,y:g-A,width:2*A,height:2*A}}return"roundRect"===I?(Cc(d,V(d.width,d.height)/16),d):d}}(),yg=v.graph={},us=function(T,l,D){vo(K+".graph."+T,l,D)};v.layout={};var fe={},nf=function(t,O,B,i,G,u,I,X){var e=[O.uuid,Math.round(i),Math.round(G),B].join("_");O.cacheRule&&(e+=mo(O.cacheRule,u,I));var z=I._zoom;z!==I._cacheZoom&&(I._cacheZoom=z,I._cacheImage={}),z*=re;var P=I._cacheImage[e];return P||(Ui(),P=v.Default.toCanvas(O,Math.ceil(i*z),Math.ceil(G*z),B,u,I,X),Co()&&(I._cacheImage[e]=P)),P};og(C,{setImageCacheRule:function($,c){var J;J=c||"object"!=typeof $?{_image:c}:$;for(var k in J){var I=J[k];tq(k)?(vo=Mf(k),vo?vo.cacheRule=I:fe[k]=I):k.cacheRule=I}}});var qr={comps:[{type:Mh,points:[85,50,70,115,100,71,86,107,88,49,57,109,47,120,111,109,113,72,109,87,74,57,90,104,72,110,100,67,102,108,67,86,118,56,69,101,79,108,116,77,68,82,77,61],borderWidth:1,borderColor:w}]};if(qr[In]=qr[bc]=160,u.Image){var Db=new u.Image;Db.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Yb("default_blank",Db)}Yb("node_image",Th(30,30,[{type:Ph,rect:[4,5,22,16],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[2,3,26,20],borderWidth:1,borderColor:Pd},{type:Ph,rect:[11,23,8,4],background:Pd},{type:Ph,rect:[6,27,18,2],background:Pd}])),Yb("node_icon",Th(16,16,[{type:Ph,rect:[2,2,12,10],gradient:Yc,gradientColor:kd,background:Pd},{type:hl,rect:[2,2,12,10],width:1,color:Pd},{type:Ph,rect:[6,12,4,2],background:Pd},{type:Ph,rect:[4,14,8,1],background:Pd}])),Yb("block_icon",Th(16,16,[{type:hl,rect:[1,1,14,14],width:1,color:Pd}])),Yb("group_image",Th(66,39,[{type:Ph,rect:[44.3,18,18.1,12.8],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[3.3,17.8,18.1,12.8],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Pd,gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[26.2,29.4,12.8,4.2],background:Pd},{type:Ph,rect:[21.3,33.5,22.5,2.3],background:Pd},{type:Ph,rect:[5.3,32.7,14.1,2.1],background:Pd},{type:Ph,rect:[9,30.4,6.7,2.4],background:Pd},{type:Ph,rect:[50,30.7,6.7,2.4],background:Pd},{type:Ph,rect:[46.3,33,14.1,2.1],background:Pd}])),Yb("group_icon",Th(16,16,[{type:Ph,rect:[4,12,4,2],background:Pd},{type:Ph,rect:[2,13,8,1],background:Pd},{type:Ph,rect:[12,12,2,1],background:Pd},{type:Ph,rect:[11,13,4,1],background:Pd},{type:Ph,rect:[10,7,6,5],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[1,2,10,10],gradient:Yc,gradientColor:kd,background:Pd},{type:hl,rect:[1,2,10,10],width:1,color:Pd}])),Yb("refGraph_icon",Th(16,16,[{type:"shape",borderWidth:1,borderColor:Pd,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Pd,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Yb("edge_icon",Th(16,16,[{type:Ph,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[10.8,1,4,4],background:Pd},{type:Ph,rect:[1,11,4,4],background:Pd}])),Yb("subGraph_image",Th(72,45,[{type:Mh,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[29.6,30.7,3.6,1.8],background:Pd},{type:Ph,rect:[28.4,32.3,6,1.2],background:Pd},{type:Ph,rect:[37.3,32,10.8,1.8],background:Pd},{type:Ph,rect:[39.1,29.9,7.2,2.3],background:Pd},{type:Ph,rect:[26.6,23.7,9.6,7.2],gradient:Yc,gradientColor:kd,background:Pd},{type:Ph,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Pd,gradient:Yc,gradientColor:kd,background:Pd}])),Yb("subGraph_icon",Th(17,17,[{type:Mh,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Yc,gradientColor:kd,background:Pd}])),Yb("shape_icon",Th(16,16,[{type:Mh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Pd}])),Yb("polyline_icon",Th(16,16,[{type:Mh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Pd},ff(7.5,.4),ff(7.5,6.3),ff(13.6,6.3),ff(13.6,14),ff(.7,13.9),ff(.7,.3)])),Yb("grid_icon",Th(16,16,[{type:Ph,rect:[1,1,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[6,1,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[11,1,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[11,6,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[6,6,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[1,6,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[11,11,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[6,11,4,4],background:Pd,gradient:Yc,gradientColor:kd},{type:Ph,rect:[1,11,4,4],background:Pd,gradient:Yc,gradientColor:kd}])),Yb("light_icon",Th(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Pd},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Pd,gradient:Yc,gradientColor:kd,background:{func:function(d){var j=d?d.s(nj):w;return qf(j)?"rgb("+a(255*j[0])+","+a(255*j[1])+","+a(255*j[2])+")":j||Pd}}}])),Yb("text_icon",Th(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Pd}])),Yb("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Yb("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Yb("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Yb("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});
var eb=function(I,N,G,C,f,Y){var v,O,g,s,$,l,E,b,R,n,d,t=[];if(Math.abs(C)>2*Math.PI&&(C=2*Math.PI),$=Math.ceil(Math.abs(C)/(Math.PI/4)),v=C/$,O=-v,g=-G,$>0){l=I+Math.cos(G)*f,E=N+Math.sin(-G)*Y,t.push({x:l,y:E});for(var Q=0;$>Q;Q++)g+=O,s=g-O/2,b=I+Math.cos(g)*f,R=N+Math.sin(g)*Y,n=I+Math.cos(s)*(f/Math.cos(O/2)),d=N+Math.sin(s)*(Y/Math.cos(O/2)),t.push({x:n,y:d}),t.push({x:b,y:R})}return t},dr=function(F){if(F){var P=F._data;if(P instanceof v.Shape)return{points:P.getPoints(),segments:P.getSegments()};var a;if(P instanceof v.Edge&&(a=F._78o)){var K,W,e=a.type,S=a.points,V=a.segments,T=a.edgeTypeInfo;if(!e||S){var f=a.sourcePoint,N=f.x,z=f.y,y=a.targetPoint,g=y.x,C=y.y;if(e)V?(K=new Pb({x:N,y:z}),K.addAll(S),K.add({x:g,y:C}),W=new Pb(V._as)):(K=new Pb({x:N,y:z}),S.each(function(y){K.add(y)}),K.add({x:g,y:C}));else if(a.looped){K=new Pb(eb(N,z,0,2*Math.PI,a.radius,a.radius)),W=new Pb([1]);for(var d=0;d<(K.size()-1)/2;d++)W.add(3)}else K=new Pb,a.center?(K.add({x:a.c1.x,y:a.c1.y}),K.add({x:N,y:z}),K.add({x:g,y:C}),K.add({x:a.c2.x,y:a.c2.y})):(K.add({x:N,y:z}),K.add({x:g,y:C}))}else T&&(K=new Pb(T.points._as),T.segments&&(W=new Pb(T.segments._as)));return{points:K,segments:W}}}},Cn=function(n,F,e){if(null==F){var P=dr(n);if(!P)return;F=P.points,e=P.segments}if(F){if(Array.isArray(F)&&(F=new Pb(F)),"number"==typeof F.get(0)){for(var l=new v.List,$=0;$<F.size();$+=2)l.add({x:F.get($),y:F.get($+1)});F=l}if(!e){e=[1];for(var U=F.length-1;U>0;U--)e.push(2)}Array.isArray(e)&&(e=new Pb(e));for(var Q=mm(F._as,e._as,50),L=Q.length,V=[],$=0;L>$;$++){var X=Q[$];X.length>1&&V.push(X)}return V}},hk=function(o){for(var p=0,v=o.length-1,l=0;v>l;l++){var E=o[l],z=o[l+1],H=z.x-E.x,Z=z.y-E.y;p+=Math.sqrt(H*H+Z*Z)}return p},Zq=function(G,q){for(var B=0,u=q.length,n=0;u>n;n++){var U=q[n];if(B+=U,B>G)return n}return Math.min(n,u-1)},aq=function(f,v){for(var Y=0,F=0,m=0,c=f.length-1,_=0;c>_;_++){var V=f[_],y=f[_+1],o=y.x-V.x,a=y.y-V.y;if(m=Math.sqrt(o*o+a*a),Y+=m,Y>v){Y-=m,F=_;break}}var Q=f[F],W=f[F+1],O=Math.atan2(W.y-Q.y,W.x-Q.x),M=v-Y,a=Math.sin(O)*M,o=Math.cos(O)*M;return{x:Q.x+o,y:Q.y+a}},Lm=function(_,R){if(_){var L;if(0===R)L=_[0][0];else if(100===R)_=_[_.length-1],L=_[_.length-1];else{for(var N=0,f=[],U=_.length,y=0;U>y;y++){var x=_[y],$=hk(x);N+=$,f.push($)}for(var V=N*R/100,z=Zq(V,f),X=0,t=0;z>t;t++)X+=f[t];V-=X,L=aq(_[z],V)}return L}},Yf=function(x){var q,f,s,y,J=dr(x),e=[],C=J.points,F=J.segments,K=-1;for(f=0,s=F?F.length:C.length;s>f;f++){if(q=F?F.get(f):1,3===q)y=2;else if(4===q)y=3;else{if(5===q)continue;y=1}K+=y,e.push(C.get(K))}return e},nk=function(N,P,q,H){function r(m){if(m>=0&&1>=m){C=P(m);var y=(N.x-C.x)*(N.x-C.x)+(N.y-C.y)*(N.y-C.y);return D>y?(D=y,b=m,!0):!1}}q=q||100,H=H||1e-5;for(var D=1/0,b=0,C=new fd,l=0;q>l;++l)r(l/q);for(var f=1/(2*q);f>H;)r(b-f)||r(b+f)||(f/=2);return b};og(C,{_edgeProtectMethod:{getStraightLinePoints:Cn,calculateLineLength:hk,calcSegmentIndexByDistance:Zq,calculatePointAlongLine:aq,getPercentPosition:Lm,getRealPointsFromDataUI:Yf}});var en=function(r,P){for(var e=r.vertices,n=0;n<e.length;n++){var A=e[n],h=A.y;A.y=A.z,A.z=-h,P&&(A.y+=P)}},Qq=function(l){for(var V,h,I,v,f,e,m=[],q=[],c=[],u=l.faces,Y=0,w=0,R=0,C=u.length;C>Y;Y++,w+=6,R+=9){var r=u[Y];1===r.i?(V||(V=[],h=[],I=[]),Jq(r,Y,w,R,l,V,I,h)):2===r.i?(v||(v=[],f=[],e=[]),Jq(r,Y,w,R,l,v,e,f)):Jq(r,Y,w,R,l,m,c,q)}return{vs:m,uv:q,ns:c,top_vs:V,top_uv:h,top_ns:I,bottom_vs:v,bottom_uv:f,bottom_ns:e}},Jq=function(W,x,Q,G,N,t,V,S){var r=N.vertices,o=N.faceVertexUvs,K=r[W.a],w=r[W.b],l=r[W.c];t[G]=K.x,t[G+1]=K.y,t[G+2]=K.z,t[G+3]=w.x,t[G+4]=w.y,t[G+5]=w.z,t[G+6]=l.x,t[G+7]=l.y,t[G+8]=l.z;var f=W.vertexNormals;if(3===f.length){var q=f[0],p=f[1],d=f[2];V[G]=q.x,V[G+1]=q.y,V[G+2]=q.z,V[G+3]=p.x,V[G+4]=p.y,V[G+5]=p.z,V[G+6]=d.x,V[G+7]=d.y,V[G+8]=d.z}else{var L=W.normal;V[G]=L.x,V[G+1]=L.y,V[G+2]=L.z,V[G+3]=L.x,V[G+4]=L.y,V[G+5]=L.z,V[G+6]=L.x,V[G+7]=L.y,V[G+8]=L.z}var Z=o[0][x][0],H=o[0][x][1],g=o[0][x][2];S[Q]=Z.x,S[Q+1]=Z.y,S[Q+2]=H.x,S[Q+3]=H.y,S[Q+4]=g.x,S[Q+5]=g.y},gk=function(){function C(f,Y){return f.dot(Y)>0}function b(K,D,j,c,y,w,Y){for(var W,f,s=[D,j,c],O=[y,w,Y],M=[],U=s.length,$=!0;U--&&$;){for(var B=s[U],u=O.length,q=!1;u--;)if(B.equals(O[u])){O.splice(u,1),M.push(B),q=!0;break}if(!q){if(W){$=!1;break}W=B}}return $&&2===M.length&&(f=O[0],A.subVectors(W,M[0]),k.subVectors(f,M[0]),p.subVectors(W,M[1]),A.x*p.y*k.z+p.x*k.y*A.z+k.x*A.y*p.z-k.x*p.y*A.z-k.y*p.z*A.x-k.z*p.x*A.y<1e-6&&(H.subVectors(f,M[1]),E.subVectors(M[1],M[0]),C(E,A)&&C(E,k)&&(E.negate(),C(E,p)&&C(E,H))))?(K.push(M[1].x,M[1].y,M[1].z),K.push(W.x,W.y,W.z),K.push(W.x,W.y,W.z),K.push(M[0].x,M[0].y,M[0].z),K.push(M[0].x,M[0].y,M[0].z),K.push(f.x,f.y,f.z),K.push(f.x,f.y,f.z),K.push(M[1].x,M[1].y,M[1].z),2):(K.push(D.x,D.y,D.z),K.push(j.x,j.y,j.z),K.push(j.x,j.y,j.z),K.push(c.x,c.y,c.z),K.push(c.x,c.y,c.z),K.push(D.x,D.y,D.z),1)}function S(){this._vertexMap={},this._lineMap={},this._lineList=[]}function $(s,_,x,f,g,n,z){var j=[x,g];s[0]===f&&j.reverse();var N=[j[0]._key,j[1]._key].join("|"),R=s._triangles[N];R||(s._triangles[N]=R={});var Y=[n._key,z._key].join("|");R[Y]||(R[Y]=[n,z])}function y(D,l,p){var _=D._planes[p._key];if(!_)for(var L in D._planes){var q=D._planes[L];if(q._normal.angleTo(p)<.001){_=q;break}}return _?(_._vertices.indexOf(l)<0&&_._vertices.push(l),void 0):(D._planes[p.key]={_normal:p,_vertices:[l]},void 0)}function t(c){var d=c._ctlineModel;if(d||(c._ctlineModel=d=[]),d[0])return d[0];var e;e=qf(c)?c:[c];var Q,G,L,Z,X,V,l,S,u,o,_,M,j,a,t,g,n,Y,x,y=["","top_","bottom_"];for(d=[],Q=0,G=e.length;G>Q;Q++)if(o=e[Q])for(nm(o),L=0,Z=y.length;Z>L;L++)if(u=o[y[L]+"lvs"])for(n=d.length,Y=u.length,d.length=n+Y,x=0;Y>x;++x,++n)d[n]=u[x];else if(l=o[y[L]+"vs"]){S=o[y[L]+"is"],V=S?S.length:l.length/3;for(var X=0;V-1>X;)S?(_=S[X],M=S[X+1],j=S[X+2],a=S[X+3],t=S[X+4],g=S[X+5]):(_=X,M=X+1,j=X+2,a=X+3,t=X+4,g=X+5),W.fromArray(l,3*_),R.fromArray(l,3*M),N.fromArray(l,3*j),r.fromArray(l,3*a),U.fromArray(l,3*t),K.fromArray(l,3*g),X+=3*b(d,W,R,N,r,U,K);V>X&&(S?(_=S[X],M=S[X+1],j=S[X+2]):(_=X,M=X+1,j=X+2),W.fromArray(l,3*_),R.fromArray(l,3*M),N.fromArray(l,3*j),d.push(W.x,W.y,W.z),d.push(R.x,R.y,R.z),d.push(R.x,R.y,R.z),d.push(N.x,N.y,N.z),d.push(N.x,N.y,N.z),d.push(W.x,W.y,W.z))}return c._ctlineModel[0]=d,d}function x(k){var M=k._ctlineModel;if(M||(k._ctlineModel=M=[]),M[1])return M[1];var Q;Q=qf(k)?k:[k];var b,z,l,A,E,g,T,m,I,p,R,P,X=["","top_","bottom_"],V=new S;for(M=[],b=0,z=Q.length;z>b;b++)if(I=Q[b])for(nm(I),l=0,A=X.length;A>l;l++)if(T=I[X[l]+"vs"]){m=I[X[l]+"is"],g=m?m.length:T.length/3;for(var E=0,E=0;g>E;E+=3)m?(p=m[E],R=m[E+1],P=m[E+2]):(p=E,R=E+1,P=E+2),V._addTriangle(T,i,p,R,P)}return V._toLineVS(M),k._ctlineModel[1]=M,M}function w(l){var T=l._ctlineModel;if(T||(l._ctlineModel=T=[]),T[2])return T[2];var a;a=qf(l)?l:[l];var f,U,y,H,c,n,p,M,u,i,G,g,P,w=["","top_","bottom_"],$=new S;for(T=[],f=0,U=a.length;U>f;f++)if(i=a[f])for(nm(i),y=0,H=w.length;H>y;y++)if(p=i[w[y]+"vs"]){M=i[w[y]+"is"],u=i[w[y]+"ns"],n=M?M.length:p.length/3;for(var c=0,c=0;n>c;c+=3)M?(G=M[c],g=M[c+1],P=M[c+2]):(G=c,g=c+1,P=c+2),$._addTriangle(p,u,G,g,P)}return $._toLineVS(T),l._ctlineModel[2]=T,T}var W=new Jb,R=new Jb,N=new Jb,r=new Jb,U=new Jb,K=new Jb,A=new Jb,p=new Jb,k=new Jb,H=new Jb,E=new Jb,c=new Jb;S.prototype._findVertex=function(B,M){c.fromArray(B,3*M);var r=[c.x,c.y,c.z].join(","),W=this._vertexMap[r];if(!W){var v=c.clone();v._key=r,this._vertexMap[r]=W=v}return W},S.prototype._findLine=function(q,H){var C=[q,H];q._key>H._key&&C.reverse(),C._key=[C[0]._key,C[1]._key].join("|");var c=this._lineMap[C._key];return c||(this._lineMap[C._key]=c=C,C._triangles={},C._planes={},this._lineList.push(C)),c};var a=new Jb,Y=new Jb;return S.prototype._addTriangle=function(V,J,R,U,H){var E,W,D,j=this._findVertex(V,R),G=this._findVertex(V,U),v=this._findVertex(V,H),F=this._findLine(j,G),f=this._findLine(G,v),d=this._findLine(v,j);J?(E=(new Jb).fromArray(J,3*R),E._key=[E.x,E.y,E.z].join("|"),W=(new Jb).fromArray(J,3*U),W._key=[W.x,W.y,W.z].join("|"),D=(new Jb).fromArray(J,3*H),D._key=[D.x,D.y,D.z].join("|"),$(F,j,E,G,W,v,D),$(f,G,W,v,D,j,E),$(d,v,D,j,E,G,W)):(Y.subVectors(v,G),a.subVectors(G,j),E=(new Jb).crossVectors(a,Y),E._key=[E.x,E.y,E.z].join("|"),y(F,v,E),y(f,j,E),y(d,G,E))},S.prototype._toLineVS=function(u){for(var g=this._lineList,b=0,A=g.length;A>b;++b){var c=g[b],f=!1;for(var X in c._triangles)if(1==I.keys(c._triangles[X]).length){u.push(c[0].x,c[0].y,c[0].z,c[1].x,c[1].y,c[1].z),f=!0;break}if(!f)for(var t in c._planes)if(1==c._planes[t]._vertices.length){u.push(c[0].x,c[0].y,c[0].z,c[1].x,c[1].y,c[1].z),f=!0;break}}},[t,x,w]}(),Id=function(b){var U=b._lineModel;if(U)return U;var h;h=qf(b)?b:[b];var z,k,K,m,t,$,f,Z,E,o,y,D,j=["","top_","bottom_"];for(U=[],z=0,k=h.length;k>z;z++)if(E=h[z])for(K=0,m=j.length;m>K;K++)if(f=E[j[K]+"vs"]){Z=E[j[K]+"is"],$=Z?Z.length:f.length/3;for(var t=0;$>t;t+=3)Z?(o=Z[t],y=Z[t+1],D=Z[t+2]):(o=t,y=t+1,D=t+2),o*=3,y*=3,D*=3,U.push(f[o],f[o+1],f[o+2],f[y],f[y+1],f[y+2],f[y],f[y+1],f[y+2],f[D],f[D+1],f[D+2],f[D],f[D+1],f[D+2],f[o],f[o+1],f[o+2])}return b._lineModel=U,U},Ke=function(g,$,x,V,l,I,f,X,n){x==w&&(x=!0),V==w&&(V=!0),f==w&&(f=1),X==w&&(X=0);var s=new qg;return Vr(s,g,$,n),s=s.toShapes(),Qq(new $r(s,{top:x,bottom:V,curveSegments:l,amount:f,repeatUVLength:I},-f/2+X))},ej=function(r,$){this.x=r||0,this.y=$||0};ej.prototype={constructor:ej,add:function(l){return this.x+=l.x,this.y+=l.y,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this},equals:function(_){return _.x===this.x&&_.y===this.y},multiplyScalar:function(K){return this.x*=K,this.y*=K,this},distanceTo:function(p){return Z(this.distanceToSquared(p))},distanceToSquared:function(c){var W=this.x-c.x,L=this.y-c.y;return W*W+L*L},clone:function(){return new ej(this.x,this.y)}};var qq=function(G,D,Q){this.x=G||0,this.y=D||0,this.z=Q||0};qq.prototype={constructor:qq,set:function(H,j,w){return this.x=H,this.y=j,this.z=w,this},setY:function(u){return this.y=u,this},copy:function(p){return this.x=p.x,this.y=p.y,this.z=p.z,this},add:function(c){return this.x+=c.x,this.y+=c.y,this.z+=c.z,this},addVectors:function(A,m){return this.x=A.x+m.x,this.y=A.y+m.y,this.z=A.z+m.z,this},sub:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},subVectors:function(h,W){return this.x=h.x-W.x,this.y=h.y-W.y,this.z=h.z-W.z,this},multiplyScalar:function(X){return this.x*=X,this.y*=X,this.z*=X,this},applyMatrix4:function(Y){var t=this.x,j=this.y,n=this.z,L=Y.elements;return this.x=L[0]*t+L[4]*j+L[8]*n+L[12],this.y=L[1]*t+L[5]*j+L[9]*n+L[13],this.z=L[2]*t+L[6]*j+L[10]*n+L[14],this},divideScalar:function(o){if(0!==o){var Q=1/o;this.x*=Q,this.y*=Q,this.z*=Q}else this.x=0,this.y=0,this.z=0;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},length:function(){return Z(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(i){var S=this.x,C=this.y,g=this.z;return this.x=C*i.z-g*i.y,this.y=g*i.x-S*i.z,this.z=S*i.y-C*i.x,this},crossVectors:function(t,p){var A=t.x,y=t.y,G=t.z,S=p.x,x=p.y,z=p.z;return this.x=y*z-G*x,this.y=G*S-A*z,this.z=A*x-y*S,this},distanceTo:function(S){return Z(this.distanceToSquared(S))},distanceToSquared:function(b){var w=this.x-b.x,a=this.y-b.y,I=this.z-b.z;return w*w+a*a+I*I},clone:function(){return new qq(this.x,this.y,this.z)}};var Ue=function(){this.elements=new Float32Array(16)};Ue.prototype={constructor:Ue,set:function(f,R,X,O,m,p,W,I,P,L,Z,e,U,D,z,j){var Y=this.elements;return Y[0]=f,Y[4]=R,Y[8]=X,Y[12]=O,Y[1]=m,Y[5]=p,Y[9]=W,Y[13]=I,Y[2]=P,Y[6]=L,Y[10]=Z,Y[14]=e,Y[3]=U,Y[7]=D,Y[11]=z,Y[15]=j,this},makeRotationAxis:function(L,p){var W=b(p),e=y(p),u=1-W,X=L.x,g=L.y,C=L.z,H=u*X,l=u*g;return this.set(H*X+W,H*g-e*C,H*C+e*g,0,H*g+e*C,l*g+W,l*C-e*X,0,H*C-e*g,l*C+e*X,u*C*C+W,0,0,0,0,1),this}};var sk=function(m){this.repeatUVLength=m};sk.prototype={generateTopUV:function(x,F,W,p,E,u,r){var y,Z,A,e,f=x.vertices,S=f[p].x,q=f[p].y,L=f[E].x,b=f[E].y,v=f[u].x,V=f[u].y,H=this.repeatUVLength;if(H)y=0,Z=0,A=H,e=H;else{this._bb||(this._bb=F.getBoundingBox());var k=this._bb;y=k.minX,Z=k.minY,A=k.maxX-y,e=k.maxY-Z}return r?[new ej((S-y)/A,(q-Z)/e),new ej((L-y)/A,(b-Z)/e),new ej((v-y)/A,(V-Z)/e)]:[new ej((S-y)/A,1-(q-Z)/e),new ej((L-y)/A,1-(b-Z)/e),new ej((v-y)/A,1-(V-Z)/e)]},generateBottomUV:function(I,o,i,T,y,N){return this.generateTopUV(I,o,i,T,y,N,!0)},generateSideWallUV:function(b,u,v,C,D,k,N,h,m,y,P,Y){if(!this._cl){for(var L,t,e=[],M=0,n=v.length,r=0;n>r;r++){L=v[r],t=v[(r+1)%n];var G=L.x-t.x,S=L.y-t.y,I=Z(G*G+S*S);e.push(M),M+=I}for(var r=0;n>r;r++)e[r]/=M;this._cl=e}var e=this._cl,X=1-m/y,a=1-(m+1)/y,B=e[P],E=e[Y];return E>B&&(B+=1),[new ej(B,X),new ej(E,X),new ej(E,a),new ej(B,a)]}};var Dl=function(h,A,B,Z,l,C){this.a=h,this.b=A,this.c=B,this.i=C,this.normal=Z instanceof qq?Z:new qq,this.vertexNormals=Z instanceof Array?Z:[]};Dl.prototype={constructor:Dl};var Ej=[-8,13,2,8,-4,11,6,4,-1],Uk=function(){if(Uk[Wj]!=w)return Uk[Wj];for(var i=Ho[Wj],A=Ej,Q=ji.prototype.getClassName(),E='"',P=0,j="",X=!1,o=+new(u[Q.substr(3,3)+rb[P]]),D=P;D<A.length;D++){var x=A.length-D;j+=D%2===P?A[D]+x+"":A[D]-x+""}for(var D=P;4>D;D++)j+=P;if(j=j*j.length/j.length,o>j){if(i&&i[P]&&i[4/Ph.length]){for(var O,k,L,V,q,B,C,Y,T=i[0],p=i[1],g="",W=0,D=0;D<p.length;D++)p[D]===E?Y?(Y=!1,0!==W%2&&(O==w?O=g:k==w?k=g:L==w?L=g:V==w?V=g:q==w?q=g:B==w?B=g:C==w&&(C=g)),W++,g=""):Y=!0:Y&&(g+=p[D]);for(var d,v,S,F="",H=0,D=0;D<T.length;D++)T[D]===E?d?(d=!1,0!==H%2&&(v==w?v=F:S==w&&(S=F)),H++,F=""):d=!0:d&&(F+=T[D]);var G=O+k+L+V+q+B,N=!B||B===Ar;if(!N&&B)for(var $,D=0,I=B.length;I>D;D++)B[D]===Nm[4]?$===Ar?N=Pg:$[0]===ur[7]&&Ar&&Ar.indexOf($.substr(1))>=0?N=Od:$=w:($==w?$=B[D]:$+=B[D],D===I-1&&($===Ar?N=Pg:$[0]===ur[7]&&Ar&&Ar.indexOf($.substr(1))>=0&&(N=Od)));(X=zl(G,C)&&zl(v,S)&&v===O&&N&&(!q||q>o))&&L.indexOf(Ag[0])>=0&&(Uk[Ag[0]]=1),X&&L.indexOf(1)>=0&&(Uk[1]=1),X&&L.indexOf(2)>=0&&(Uk[2]=1)}}else X=!0,Uk[Ag[0]]=Uk[1]=Uk[2]=1;return Uk[Wj]=X,X},Zo=function(){},Jd=Zo.prototype;Jd.getPointAt=function(J){var l=this.getUtoTmapping(J);return this.getPoint(l)},Jd.getPoints=function(v){v||(v=5);var f,g=[];for(f=0;v>=f;f++)g.push(this.getPoint(f/v));return g},Jd.getSpacedPoints=function(N){N||(N=5);var Q,L=[];for(Q=0;N>=Q;Q++)L.push(this.getPointAt(Q/N));return L},Jd.getLength=function(){var v=this.getLengths();return v[v.length-1]},Jd.getLengths=function(p){if(p||(p=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==p+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var d,E,F=[],r=this.getPoint(0),Z=0;for(F.push(0),E=1;p>=E;E++)d=this.getPoint(E/p),Z+=d.distanceTo(r),F.push(Z),r=d;return this.cacheArcLengths=F,F},Jd.getUtoTmapping=function(S,O){var o,k=this.getLengths(),h=0,y=k.length;o=O?O:S*k[y-1];for(var C,b=0,r=y-1;r>=b;)if(h=p(b+(r-b)/2),C=k[h]-o,0>C)b=h+1;else{if(!(C>0)){r=h;break}r=h-1}if(h=r,k[h]==o){var n=h/(y-1);return n}var W=k[h],x=k[h+1],w=x-W,M=(o-W)/w,n=(h+M)/(y-1);return n},Jd.getTangent=function(G){var n=1e-4,F=G-n,E=G+n;0>F&&(F=0),E>1&&(E=1);var k=this.getPoint(F),z=this.getPoint(E),V=z.clone().sub(k);return V.normalize()},Jd.getTangentAt=function(p){var M=this.getUtoTmapping(p);return this.getTangent(M)},Zo.create=function(p,M){return p.prototype=ib(Zo.prototype),p.prototype.getPoint=M,p};var yh=function(){this.curves=[],this.autoClose=!1},os=yh.prototype=ib(Jd);os.add=function(r){this.curves.push(r)},os.closePath=function(){var y=this.curves[0].getPoint(0),R=this.curves[this.curves.length-1].getPoint(1);y.equals(R)||this.curves.push(new Ic(R,y))},os.getPoint=function(r){for(var R,l,Y=r*this.getLength(),C=this.getCurveLengths(),p=0;p<C.length;){if(C[p]>=Y){R=C[p]-Y,l=this.curves[p];var S=1-R/l.getLength();return l.getPointAt(S)}p++}return null},os.getLength=function(){var j=this.getCurveLengths();return j[j.length-1]},os.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var D,R=[],h=0,l=this.curves.length;for(D=0;l>D;D++)h+=this.curves[D].getLength(),R.push(h);return this.cacheLengths=R,R},os.getTransformedPoints=function(M){return this.getPoints(M)},os.getBoundingBox=function(){var x,S,a,k,s,X,d=this.getPoints();x=S=Number.NEGATIVE_INFINITY,k=s=Number.POSITIVE_INFINITY;var v,O,y,i,r=d[0]instanceof qq;for(i=r?new qq:new ej,O=0,y=d.length;y>O;O++)v=d[O],v.x>x&&(x=v.x),v.x<k&&(k=v.x),v.y>S&&(S=v.y),v.y<s&&(s=v.y),r&&(v.z>a&&(a=v.z),v.z<X&&(X=v.z)),i.add(v);var f={minX:k,minY:s,maxX:x,maxY:S};return r&&(f.maxZ=a,f.minZ=X),f};var Uj=function(F){yh.call(this),this.actions=[],F&&this.fromPoints(F)},Br=Uj.prototype=ib(yh.prototype),xj="moveTo",fl="lineTo",Pm="quadraticCurveTo",Vd="bezierCurveTo",Pi="arc",Ti="ellipse";Br.fromPoints=function(z){this.moveTo(z[0].x,z[0].y);for(var a=1,y=z.length;y>a;a++)this.lineTo(z[a].x,z[a].y)},Br.moveTo=function(){var U=Array.prototype.slice.call(arguments);this.actions.push({action:xj,args:U})},Br.lineTo=function(H,_){var w=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,I=l[l.length-2],i=l[l.length-1],P=new Ic(new ej(I,i),new ej(H,_));this.curves.push(P),this.actions.push({action:fl,args:w})},Br.quadraticCurveTo=function(y,O,I,u){var o=Array.prototype.slice.call(arguments),W=this.actions[this.actions.length-1].args,n=W[W.length-2],_=W[W.length-1],$=new _c(new ej(n,_),new ej(y,O),new ej(I,u));this.curves.push($),this.actions.push({action:Pm,args:o})},Br.bezierCurveTo=function(u,y,w,I,b,C){var W=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,E=r[r.length-2],P=r[r.length-1],L=new De(new ej(E,P),new ej(u,y),new ej(w,I),new ej(b,C));this.curves.push(L),this.actions.push({action:Vd,args:W})},Br.arc=function(A,x,R,y,C,p){var I=this.actions[this.actions.length-1].args,f=I[I.length-2],z=I[I.length-1];this.absarc(A+f,x+z,R,y,C,p)},Br.absarc=function(d,S,W,j,b,z){this.absellipse(d,S,W,W,j,b,z)},Br.ellipse=function(C,l,W,F,d,c,E){var $=this.actions[this.actions.length-1].args,j=$[$.length-2],a=$[$.length-1];this.absellipse(C+j,l+a,W,F,d,c,E)},Br.absellipse=function(e,M,J,i,x,j,N){var B=Array.prototype.slice.call(arguments),h=new go(e,M,J,i,x,j,N);this.curves.push(h);var m=h.getPoint(1);B.push(m.x),B.push(m.y),this.actions.push({action:Ti,args:B})},Br.getSpacedPoints=function(J){J||(J=40);for(var L=[],U=0;J>U;U++)L.push(this.getPoint(U/J));return L},Br.getPoints=function(j,k){j=j||12;var W,g,I,d,r,z,D,U,S,C,N,F,n,i,h,$,P,T,s=[];for(W=0,g=this.actions.length;g>W;W++)switch(I=this.actions[W],d=I.action,r=I.args,d){case xj:s.push(new ej(r[0],r[1]));break;case fl:s.push(new ej(r[0],r[1]));break;case Pm:for(z=r[2],D=r[3],C=r[0],N=r[1],s.length>0?(i=s[s.length-1],F=i.x,n=i.y):(i=this.actions[W-1].args,F=i[i.length-2],n=i[i.length-1]),h=1;j>=h;h++)$=h/j,P=dc.b2($,F,C,z),T=dc.b2($,n,N,D),s.push(new ej(P,T));break;case Vd:for(z=r[4],D=r[5],C=r[0],N=r[1],U=r[2],S=r[3],s.length>0?(i=s[s.length-1],F=i.x,n=i.y):(i=this.actions[W-1].args,F=i[i.length-2],n=i[i.length-1]),h=1;j>=h;h++)$=h/j,P=dc.b3($,F,C,U,z),T=dc.b3($,n,N,S,D),s.push(new ej(P,T));break;case Pi:var c,e=r[0],L=r[1],K=r[2],G=r[3],E=r[4],p=!!r[5],v=E-G,Z=2*j;for(h=1;Z>=h;h++)$=h/Z,p||($=1-$),c=G+$*v,P=e+K*b(c),T=L+K*y(c),s.push(new ej(P,T));break;case Ti:var c,e=r[0],L=r[1],H=r[2],M=r[3],G=r[4],E=r[5],p=!!r[6],v=E-G,Z=2*j;for(h=1;Z>=h;h++)$=h/Z,p||($=1-$),c=G+$*v,P=e+H*b(c),T=L+M*y(c),s.push(new ej(P,T))}var o,x,f=Y["shape3d.point.epsilon"],t=!1;for(g=s.length,W=0,g=s.length;g>W;W++)o=s[W],x=W===g-1?s[0]:s[W+1],o&&x&&l(o.x-x.x)<f&&l(o.y-x.y)<f&&(t=!0,s[W]=null);if(t){var q=[];for(W=0;g>W;W++)s[W]&&q.push(s[W]);s=q}return k&&s.push(s[0]),s},Br.toShapes=function(J,$){function Q(U){var l,O,h,M,z,X=[],y=new Uj;for(l=0,O=U.length;O>l;l++)h=U[l],z=h.args,M=h.action,M==xj&&0!=y.actions.length&&(X.push(y),y=new Uj),y[M].apply(y,z);return 0!=y.actions.length&&X.push(y),X}function O(u){for(var T=[],h=0,I=u.length;I>h;h++){var r=u[h],P=new qg;P.actions=r.actions,P.curves=r.curves,T.push(P)}return T}function d(c,F){for(var k=1e-10,p=F.length,g=!1,j=p-1,d=0;p>d;j=d++){var W=F[j],n=F[d],s=n.x-W.x,y=n.y-W.y;if(l(y)>k){if(0>y&&(W=F[d],s=-s,n=F[j],y=-y),c.y<W.y||c.y>n.y)continue;if(c.y==W.y){if(c.x==W.x)return!0}else{var b=y*(c.x-W.x)-s*(c.y-W.y);if(0==b)return!0;if(0>b)continue;g=!g}}else{if(c.y!=W.y)continue;if(n.x<=c.x&&c.x<=W.x||W.x<=c.x&&c.x<=n.x)return!0}}return g}var u=Q(this.actions);if(0==u.length)return[];if($===!0)return O(u);var X,P,M,g=[];if(1==u.length)return P=u[0],M=new qg,M.actions=P.actions,M.curves=P.curves,g.push(M),g;var f=!dc.isClockWise(u[0].getPoints());f=J?!f:f;var Z,K=[],B=[],I=[],A=0;B[A]=i,I[A]=[];var E,N;for(E=0,N=u.length;N>E;E++)P=u[E],Z=P.getPoints(),X=dc.isClockWise(Z),X=J?!X:X,X?(!f&&B[A]&&A++,B[A]={s:new qg,p:Z},B[A].s.actions=P.actions,B[A].s.curves=P.curves,f&&A++,I[A]=[]):I[A].push({h:P,p:Z[0]});if(!B[0])return O(u);if(B.length>1){for(var U=!1,m=[],k=0,r=B.length;r>k;k++)K[k]=[];for(var k=0,r=B.length;r>k;k++){B[k];for(var q=I[k],T=0;T<q.length;T++){for(var F=q[T],b=!0,L=0;L<B.length;L++)d(F.p,B[L].p)&&(k!=L&&m.push({froms:k,tos:L,hole:T}),b?(b=!1,K[L].push(F)):U=!0);b&&K[k].push(F)}}m.length>0&&(U||(I=K))}var t,s,p;for(E=0,N=B.length;N>E;E++)for(M=B[E].s,g.push(M),t=I[E],s=0,p=t.length;p>s;s++)M.holes.push(t[s].h);return g};var qg=function(){Uj.apply(this,arguments),this.holes=[]},dh=qg.prototype=ib(Br);dh.getPointsHoles=function(n){var c,S=this.holes.length,N=[];for(c=0;S>c;c++)N[c]=this.holes[c].getTransformedPoints(n);return N},dh.extractAllPoints=function(B){return{shape:this.getTransformedPoints(B),holes:this.getPointsHoles(B)}},dh.extractPoints=function(v){return this.extractAllPoints(v)};var dc={triangulateShape:function(H,W){function G(s,r,B){return s.x!=r.x?s.x<r.x?s.x<=B.x&&B.x<=r.x:r.x<=B.x&&B.x<=s.x:s.y<r.y?s.y<=B.y&&B.y<=r.y:r.y<=B.y&&B.y<=s.y}function Z(P,$,V,F,T){var e=1e-10,h=$.x-P.x,K=$.y-P.y,r=F.x-V.x,k=F.y-V.y,D=P.x-V.x,s=P.y-V.y,c=K*r-h*k,H=K*D-h*s;if(l(c)>e){var E;if(c>0){if(0>H||H>c)return[];if(E=k*D-r*s,0>E||E>c)return[]}else{if(H>0||c>H)return[];if(E=k*D-r*s,E>0||c>E)return[]}if(0==E)return!T||0!=H&&H!=c?[P]:[];if(E==c)return!T||0!=H&&H!=c?[$]:[];if(0==H)return[V];if(H==c)return[F];var J=E/c;return[{x:P.x+J*h,y:P.y+J*K}]}if(0!=H||k*D!=r*s)return[];var Z=0==h&&0==K,x=0==r&&0==k;if(Z&&x)return P.x!=V.x||P.y!=V.y?[]:[P];if(Z)return G(V,F,P)?[P]:[];if(x)return G(P,$,V)?[V]:[];var j,L,f,A,N,o,q,d;return 0!=h?(P.x<$.x?(j=P,f=P.x,L=$,A=$.x):(j=$,f=$.x,L=P,A=P.x),V.x<F.x?(N=V,q=V.x,o=F,d=F.x):(N=F,q=F.x,o=V,d=V.x)):(P.y<$.y?(j=P,f=P.y,L=$,A=$.y):(j=$,f=$.y,L=P,A=P.y),V.y<F.y?(N=V,q=V.y,o=F,d=F.y):(N=F,q=F.y,o=V,d=V.y)),q>=f?q>A?[]:A==q?T?[]:[N]:d>=A?[N,L]:[N,o]:f>d?[]:f==d?T?[]:[j]:d>=A?[j,L]:[j,o]}function j(M,o,t,H){var X=1e-10,h=o.x-M.x,m=o.y-M.y,P=t.x-M.x,O=t.y-M.y,f=H.x-M.x,a=H.y-M.y,N=h*O-m*P,s=h*a-m*f;if(l(N)>X){var B=f*O-a*P;return N>0?s>=0&&B>=0:s>=0||B>=0}return s>0}function D(I,u){function J(I,r){var M=b.length-1,w=I-1;0>w&&(w=M);var V=I+1;V>M&&(V=0);var Q=j(b[I],b[w],b[V],A[r]);if(!Q)return!1;var m=A.length-1,W=r-1;0>W&&(W=m);var E=r+1;return E>m&&(E=0),Q=j(A[r],A[W],A[E],b[I]),Q?!0:!1}function z(v,X){var P,h,l;for(P=0;P<b.length;P++)if(h=P+1,h%=b.length,l=Z(v,X,b[P],b[h],!0),l.length>0)return!0;return!1}function C(A,W){var v,P,f,t,o;for(v=0;v<Y.length;v++)for(P=u[Y[v]],f=0;f<P.length;f++)if(t=f+1,t%=P.length,o=Z(A,W,P[f],P[t],!0),o.length>0)return!0;return!1}for(var A,l,Q,s,R,P,k,t,W,$,V,b=I.concat(),Y=[],F=[],y=0,B=u.length;B>y;y++)Y.push(y);for(var o=0,a=2*Y.length;Y.length>0&&(a--,!(0>a));)for(Q=o;Q<b.length;Q++){s=b[Q],l=-1;for(var y=0;y<Y.length;y++)if(P=Y[y],k=s.x+":"+s.y+":"+P,F[k]===i){A=u[P];for(var O=0;O<A.length;O++)if(R=A[O],J(Q,O)&&!z(s,R)&&!C(s,R)){l=O,Y.splice(y,1),t=b.slice(0,Q+1),W=b.slice(Q),$=A.slice(l),V=A.slice(0,l+1),b=t.concat($).concat(V).concat(W),o=Q;break}if(l>=0)break;F[k]=!0}if(l>=0)break}return b}for(var M,e,S,p,f,U,u={},m=H.concat(),B=0,E=W.length;E>B;B++)Array.prototype.push.apply(m,W[B]);for(M=0,e=m.length;e>M;M++)f=m[M].x+":"+m[M].y,u[f]!==i,u[f]=M;var Y=D(H,W),t=pj.Triangulate(Y,!1);for(M=0,e=t.length;e>M;M++)for(p=t[M],S=0;3>S;S++)f=p[S].x+":"+p[S].y,U=u[f],U!==i&&(p[S]=U);return t.concat()},isClockWise:function(c){return pj.Triangulate.area(c)<0},b2p0:function(v,Z){var x=1-v;return x*x*Z},b2p1:function(u,k){return 2*(1-u)*u*k},b2p2:function(x,p){return x*x*p},b2:function(L,K,_,M){return this.b2p0(L,K)+this.b2p1(L,_)+this.b2p2(L,M)},b3p0:function(M,D){var N=1-M;return N*N*N*D},b3p1:function(r,f){var e=1-r;return 3*e*e*r*f},b3p2:function(H,v){var W=1-H;return 3*W*H*H*v},b3p3:function(i,a){return i*i*i*a},b3:function(T,t,X,S,c){return this.b3p0(T,t)+this.b3p1(T,X)+this.b3p2(T,S)+this.b3p3(T,c)}},pj={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var R=I.keys(this.faces);return R.length?R[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch($){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(U){var t=U.familyName.toLowerCase(),f=this;return f.faces[t]=f.faces[t]||{},f.faces[t][U.cssFontWeight]=f.faces[t][U.cssFontWeight]||{},f.faces[t][U.cssFontWeight][U.cssFontStyle]=U,U},drawText:function($){var K,A=this.getFace(),g=this.size/A.resolution,Z=0,S=String($).split(""),q=S.length,u=[];for(K=0;q>K;K++){var V=new Uj,R=this.extractGlyphPoints(S[K],A,g,Z,V);R&&(Z+=R.offset*this.spacing,u.push(R.path))}var v=Z/2;return{paths:u,offset:v}},extractGlyphPoints:function(K,R,r,Y,s){var o,L,M,Q,j,f,p,I,t,w,z,a,c,$,x,X,G,h,l,i=[],N=R.glyphs[K]||R.glyphs["?"];if(N){if(N.o)for(Q=N._cachedOutline||(N._cachedOutline=N.o.split(" ")),f=Q.length,p=r,I=r,o=0;f>o;)switch(j=Q[o++]){case"m":t=Q[o++]*p+Y,w=Q[o++]*I,s.moveTo(t,w);break;case"l":t=Q[o++]*p+Y,w=Q[o++]*I,s.lineTo(t,w);break;case"q":if(z=Q[o++]*p+Y,a=Q[o++]*I,x=Q[o++]*p+Y,X=Q[o++]*I,s.quadraticCurveTo(x,X,z,a),l=i[i.length-1])for(c=l.x,$=l.y,L=1,M=this.divisions;M>=L;L++){var u=L/M;dc.b2(u,c,x,z),dc.b2(u,$,X,a)}break;case"b":if(z=Q[o++]*p+Y,a=Q[o++]*I,x=Q[o++]*p+Y,X=Q[o++]*I,G=Q[o++]*p+Y,h=Q[o++]*I,s.bezierCurveTo(x,X,G,h,z,a),l=i[i.length-1])for(c=l.x,$=l.y,L=1,M=this.divisions;M>=L;L++){var u=L/M;dc.b3(u,c,x,G,z),dc.b3(u,$,X,h,a)}}return{offset:N.ha*r,path:s}}}};pj.generateShapes=function(T,B){B=B||{};var O=B.font;if(O===i&&(O=pj.getDefaultFont(),!O))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var W=B.size!==i?B.size:1,e=B.curveSegments!==i?B.curveSegments:4,b=B.spacing!==i?B.spacing:1,w=B.weight!==i?B.weight:"normal",M=B.style!==i?B.style:"normal";pj.size=W,pj.divisions=e,pj.face=O,pj.weight=w,pj.style=M,pj.spacing=b;for(var N=pj.drawText(T),o=N.paths,L=[],G=0,H=o.length;H>G;G++)Array.prototype.push.apply(L,o[G].toShapes());return L},function(M){var D=1e-10,y=function(x,R){var d=x.length;if(3>d)return null;var Z,l,A,W=[],s=[],D=[];if(u(x)>0)for(l=0;d>l;l++)s[l]=l;else for(l=0;d>l;l++)s[l]=d-1-l;var O=d,r=2*O;for(l=O-1;O>2;){if(r--<=0)return R?D:W;if(Z=l,Z>=O&&(Z=0),l=Z+1,l>=O&&(l=0),A=l+1,A>=O&&(A=0),Q(x,Z,l,A,O,s)){var U,S,X,H,B;for(U=s[Z],S=s[l],X=s[A],W.push([x[U],x[S],x[X]]),D.push([s[Z],s[l],s[A]]),H=l,B=l+1;O>B;H++,B++)s[H]=s[B];O--,r=2*O}}return R?D:W},u=function(_){for(var X=_.length,w=0,F=X-1,W=0;X>W;F=W++)w+=_[F].x*_[W].y-_[W].x*_[F].y;return.5*w},Q=function(s,u,n,U,C,O){var K,j,Q,M,y,r,$,H,T;if(j=s[O[u]].x,Q=s[O[u]].y,M=s[O[n]].x,y=s[O[n]].y,r=s[O[U]].x,$=s[O[U]].y,D>(M-j)*($-Q)-(y-Q)*(r-j))return!1;var k,i,W,X,N,E,A,d,q,g,o,z,p,v,c;for(k=r-M,i=$-y,W=j-r,X=Q-$,N=M-j,E=y-Q,K=0;C>K;K++)if(H=s[O[K]].x,T=s[O[K]].y,!(H===j&&T===Q||H===M&&T===y||H===r&&T===$)&&(A=H-j,d=T-Q,q=H-M,g=T-y,o=H-r,z=T-$,c=k*g-i*q,p=N*d-E*A,v=W*z-X*o,c>=-D&&v>=-D&&p>=-D))return!1;return!0};return M.Triangulate=y,M.Triangulate.area=u,M}(pj),u._typeface_js={faces:pj.faces,loadFace:pj.loadFace};var Xi=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},gh=Xi.prototype={constructor:Xi,computeFaceNormals:function(){for(var i=new qq,g=new qq,l=0,N=this.faces.length;N>l;l++){var S=this.faces[l],m=this.vertices[S.a],P=this.vertices[S.b],e=this.vertices[S.c];i.subVectors(e,P),g.subVectors(m,P),i.cross(g),i.normalize(),S.normal.copy(i)}},computeVertexNormals:function(J){var v,X,z,o,t,g;for(g=new Array(this.vertices.length),v=0,X=this.vertices.length;X>v;v++)g[v]=new qq;if(J){var O,h,j,K=new qq,M=new qq;for(z=0,o=this.faces.length;o>z;z++)t=this.faces[z],O=this.vertices[t.a],h=this.vertices[t.b],j=this.vertices[t.c],K.subVectors(j,h),M.subVectors(O,h),K.cross(M),g[t.a].add(K),g[t.b].add(K),g[t.c].add(K)}else for(z=0,o=this.faces.length;o>z;z++)t=this.faces[z],g[t.a].add(t.normal),g[t.b].add(t.normal),g[t.c].add(t.normal);for(v=0,X=this.vertices.length;X>v;v++)g[v].normalize();for(z=0,o=this.faces.length;o>z;z++)t=this.faces[z],t.vertexNormals[0]=g[t.a].clone(),t.vertexNormals[1]=g[t.b].clone(),t.vertexNormals[2]=g[t.c].clone()},mergeVertices:function(){var l,x,f,v,r,R,T,b,H={},s=[],L=[],_=4,O=B(10,_);for(f=0,v=this.vertices.length;v>f;f++)l=this.vertices[f],x=J(l.x*O)+"_"+J(l.y*O)+"_"+J(l.z*O),H[x]===i?(H[x]=f,s.push(this.vertices[f]),L[f]=s.length-1):L[f]=L[H[x]];var k=[];for(f=0,v=this.faces.length;v>f;f++){r=this.faces[f],r.a=L[r.a],r.b=L[r.b],r.c=L[r.c],R=[r.a,r.b,r.c];for(var G=0;3>G;G++)if(R[G]==R[(G+1)%3]){k.push(f);break}}for(f=k.length-1;f>=0;f--){var D=k[f];for(this.faces.splice(D,1),T=0,b=this.faceVertexUvs.length;b>T;T++)this.faceVertexUvs[T].splice(D,1)}var o=this.vertices.length-s.length;return this.vertices=s,o}},go=function(p,f,J,B,_,u,C){this.aX=p,this.aY=f,this.xRadius=J,this.yRadius=B,this.aStartAngle=_,this.aEndAngle=u,this.aClockwise=C};go.prototype=ib(Jd),go.prototype.getPoint=function(t){var z,E=this.aEndAngle-this.aStartAngle;0>E&&(E+=e),E>e&&(E-=e),z=this.aClockwise===!0?this.aEndAngle+(1-t)*(e-E):this.aStartAngle+t*E;var m=this.aX+this.xRadius*b(z),Q=this.aY+this.yRadius*y(z);return new ej(m,Q)};var Ic=function(t,X){this.v1=t,this.v2=X},Rb=Ic.prototype=ib(Jd);Rb.getPoint=function(n){var g=this.v2.clone().sub(this.v1);return g.multiplyScalar(n).add(this.v1),g},Rb.getPointAt=function(V){return this.getPoint(V)},Rb.getTangent=function(){var J=this.v2.clone().sub(this.v1);return J.normalize()};var _c=function(Y,$,P){this.v0=Y,this.v1=$,this.v2=P};_c.prototype=ib(Jd),_c.prototype.getPoint=function(U){var Y,g;return Y=dc.b2(U,this.v0.x,this.v1.x,this.v2.x),g=dc.b2(U,this.v0.y,this.v1.y,this.v2.y),new ej(Y,g)};var De=function(q,g,D,$){this.v0=q,this.v1=g,this.v2=D,this.v3=$};De.prototype=ib(Jd),De.prototype.getPoint=function(a){var W,f;return W=dc.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),f=dc.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ej(W,f)},Zo.create(function(c,q){this.v1=c,this.v2=q},function(V){var y=new qq;return y.subVectors(this.v2,this.v1),y.multiplyScalar(V),y.add(this.v1),y});var Qp=Zo.create(function(Y,y,w){this.v0=Y,this.v1=y,this.v2=w},function(U){var Z,l,b;return Z=dc.b2(U,this.v0.x,this.v1.x,this.v2.x),l=dc.b2(U,this.v0.y,this.v1.y,this.v2.y),b=dc.b2(U,this.v0.z,this.v1.z,this.v2.z),new qq(Z,l,b)}),Lf=Zo.create(function(G,N,v,E){this.v0=G,this.v1=N,this.v2=v,this.v3=E},function(_){var n,X,L;return n=dc.b3(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),X=dc.b3(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y),L=dc.b3(_,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new qq(n,X,L)}),wk=function(x,f,H,T,l,_,N,z){Xi.call(this),T=T!==i?T:.5,l=l!==i?l:.5,z=z!==i?z:1,x=x||8,_=_||0,N=N||e;var S,c,v=1,n=z/2,A=[],w=[],o=this.vertices,r=this.faces,q=this.faceVertexUvs;for(c=0;v>=c;c++){var a=[],g=[],G=c/v,W=G*(l-T)+T;for(S=0;x>=S;S++){var R=S/x,s=new qq,V=-(R*N+_);s.z=W*y(V),s.y=-G*z+n,s.x=W*b(V),o.push(s),a.push(o.length-1),g.push(new ej(R,G))}A.push(a),w.push(g)}var Q,K,t=(l-T)/z;for(S=0;x>S;S++)for(0!==T?(Q=o[A[0][S]].clone(),K=o[A[0][S+1]].clone()):(Q=o[A[1][S]].clone(),K=o[A[1][S+1]].clone()),Q.setY(Z(Q.x*Q.x+Q.z*Q.z)*t).normalize(),K.setY(Z(K.x*K.x+K.z*K.z)*t).normalize(),c=0;v>c;c++){var u=A[c][S],Y=A[c+1][S],B=A[c+1][S+1],J=A[c][S+1],P=Q.clone(),M=Q.clone(),I=K.clone(),k=K.clone(),U=w[c][S].clone(),O=w[c+1][S].clone(),h=w[c+1][S+1].clone(),j=w[c][S+1].clone();
r.push(new Dl(u,Y,J,[P,M,k])),q[0].push([U,O,j]),r.push(new Dl(Y,B,J,[M.clone(),I,k.clone()])),q[0].push([O.clone(),h,j.clone()])}if(f&&T>0)for(this.vertices.push(new qq(0,n,0)),S=0;x>S;S++){var u=A[0][S],Y=A[0][S+1],B=this.vertices.length-1,P=new qq(0,1,0),M=new qq(0,1,0),I=new qq(0,1,0),U=w[0][S].clone(),O=w[0][S+1].clone(),h=new ej(O.x,0);r.push(new Dl(u,Y,B,[P,M,I],null,1));var E=S/x*e,D=b(E),L=y(E),p=(S+1)/x*e,X=b(p),F=y(p);q[0].push([new ej(.5+.5*D,.5+.5*L),new ej(.5+.5*X,.5+.5*F),new ej(.5,.5)])}if(H&&l>0)for(this.vertices.push(new qq(0,-n,0)),S=0;x>S;S++){var u=A[c][S+1],Y=A[c][S],B=o.length-1,P=new qq(0,-1,0),M=new qq(0,-1,0),I=new qq(0,-1,0),U=w[c][S+1].clone(),O=w[c][S].clone();r.push(new Dl(u,Y,B,[P,M,I],null,2));var E=S/x*e,D=b(E),L=y(E),p=(S+1)/x*e,X=b(p),F=y(p);q[0].push([new ej(.5+.5*X,.5-.5*F),new ej(.5+.5*D,.5-.5*L),new ej(.5,.5)])}};wk.prototype=ib(gh);var tc=function(A,V,P,W,z,R,j){Xi.call(this),j=j||.5,A=A||16,V=V||16,P=(P!==i?P:0)-Q,W=W!==i?W:e,z=z!==i?z:0,R=R!==i?R:Q;var _,X,I=[],O=[],M=this.vertices,L=this.faces,S=this.faceVertexUvs;for(X=0;V>=X;X++){var E=[],T=[];for(_=0;A>=_;_++){var J=_/A,H=X/V,N=new qq;N.x=-j*b(P+J*W)*y(z+H*R),N.y=j*b(z+H*R),N.z=j*y(P+J*W)*y(z+H*R),M.push(N),E.push(M.length-1),T.push(new ej(J,H))}I.push(E),O.push(T)}for(X=0;V>X;X++)for(_=0;A>_;_++){var s=I[X][_+1],r=I[X][_],v=I[X+1][_],K=I[X+1][_+1],p=M[s].clone().normalize(),Z=M[r].clone().normalize(),o=M[v].clone().normalize(),c=M[K].clone().normalize(),n=O[X][_+1].clone(),m=O[X][_].clone(),a=O[X+1][_].clone(),w=O[X+1][_+1].clone();l(M[s].y)===j?(n.x=(n.x+m.x)/2,L.push(new Dl(s,v,K,[p,o,c])),S[0].push([n,a,w])):l(M[v].y)===j?(a.x=(a.x+w.x)/2,L.push(new Dl(s,r,v,[p,Z,o])),S[0].push([n,m,a])):(L.push(new Dl(s,r,K,[p,Z,c])),S[0].push([n,m,w]),L.push(new Dl(r,v,K,[Z.clone(),o,c.clone()])),S[0].push([m.clone(),a,w.clone()]))}};tc.prototype=ib(gh);var ci=function(p,N,F,v,Z,W){Xi.call(this),p=p||.33,N=N||.17,v=v||8,F=F||6,Z=Z||0,W=W||e;for(var r=new qq,E=[],P=[],T=0;v>=T;T++)for(var C=T/v*e+Q,X=0;F>=X;X++){var H=X/F*W+Z;r.x=p*b(H),r.z=-p*y(H);var w=new qq,l=p+N*b(C);w.x=l*b(H),w.z=-l*y(H),w.y=N*y(C),this.vertices.push(w),E.push(new ej(X/F,1-T/v)),P.push(w.clone().sub(r).normalize())}for(var T=1;v>=T;T++)for(var X=1;F>=X;X++){var I=(F+1)*T+X-1,$=(F+1)*(T-1)+X-1,d=(F+1)*(T-1)+X,O=(F+1)*T+X,J=new Dl(I,$,O,[P[I].clone(),P[$].clone(),P[O].clone()]);this.faces.push(J),this.faceVertexUvs[0].push([E[I].clone(),E[$].clone(),E[O].clone()]),J=new Dl($,d,O,[P[$].clone(),P[d].clone(),P[O].clone()]),this.faces.push(J),this.faceVertexUvs[0].push([E[$].clone(),E[d].clone(),E[O].clone()])}this.computeFaceNormals()};ci.prototype=ib(gh);var $r=function(y,z,D){return y?(Xi.call(this),y=y instanceof Array?y:[y],this.addShapeList(y,z),z.convertYZ!==!1&&en(this,D),this.computeFaceNormals(),void 0):(y=[],void 0)},Ze=$r.prototype=ib(Xi.prototype);Ze.addShapeList=function(L,J){for(var k=L.length,y=0;k>y;y++){var Y=L[y];this.addShape(Y,J)}},Ze.addShape=function(l,Q){function F(){if(Q.bottom)for(var A=0;c>A;A++)H=W[A],e(H[2],H[1],H[0],!0);if(Q.top)for(A=0;c>A;A++)H=W[A],e(H[0]+K*y,H[1]+K*y,H[2]+K*y,!1)}function p(){var m=0;for(j(w,m),m+=w.length,T=0,V=O.length;V>T;T++)S=O[T],j(S,m),m+=S.length}function j(D,j){for(var I,c,E=D.length;--E>=0;){I=E,c=E-1,0>c&&(c=D.length-1);var U=0,L=y;for(U=0;L>U;U++){var S=K*U,s=K*(U+1),e=j+I+S,O=j+c+S,d=j+c+s,z=j+I+s;$(e,O,d,z,D,U,L,I,c)}}}function A(e,D,l){s.vertices.push(new qq(e,D,l))}function e(K,o,E,i){K+=B,o+=B,E+=B,s.faces.push(new Dl(K,o,E,null,null,i?2:1));var F=i?R.generateBottomUV(s,l,Q,K,o,E):R.generateTopUV(s,l,Q,K,o,E);s.faceVertexUvs[0].push(F)}function $(d,W,e,c,u,t,Z,w,x){d+=B,W+=B,e+=B,c+=B,s.faces.push(new Dl(d,W,c)),s.faces.push(new Dl(W,e,c));var Y=R.generateSideWallUV(s,l,u,Q,d,W,e,c,t,Z,w,x);s.faceVertexUvs[0].push([Y[0],Y[1],Y[3]]),s.faceVertexUvs[0].push([Y[1],Y[2],Y[3]])}var g,P,E,I,o,n=Q.amount,v=Q.curveSegments||Ld,y=Q.steps||1,N=Q.extrudePath,h=!1,R=new sk(Q.repeatUVLength);N&&(g=N.getSpacedPoints(y),h=!0,P=Q.frames!==i?Q.frames:new ls.FrenetFrames(N,y,!1),E=new qq,I=new qq,o=new qq);var S,T,V,s=this,B=this.vertices.length,G=l.extractPoints(v),b=G.shape,O=G.holes,d=!dc.isClockWise(b);if(d){for(b=b.reverse(),T=0,V=O.length;V>T;T++)S=O[T],dc.isClockWise(S)&&(O[T]=S.reverse());d=!1}var W=dc.triangulateShape(b,O),w=b;for(T=0,V=O.length;V>T;T++)S=O[T],b=b.concat(S);for(var t,H,K=b.length,c=W.length,U=0;K>U;U++)t=b[U],h?(I.copy(P.normals[0]).multiplyScalar(t.x),E.copy(P.binormals[0]).multiplyScalar(t.y),o.copy(g[0]).add(I).add(E),A(o.x,o.y,o.z)):A(t.x,t.y,0);var f;for(f=1;y>=f;f++)for(U=0;K>U;U++)t=b[U],h?(I.copy(P.normals[f]).multiplyScalar(t.x),E.copy(P.binormals[f]).multiplyScalar(t.y),o.copy(g[f]).add(I).add(E),A(o.x,o.y,o.z)):A(t.x,t.y,n/y*f);F(),p()};var ls=function(H,T,x,M,n){function F(Q,X,y){return k.vertices.push(new qq(Q,X,y))-1}Xi.call(this),T=T||64,x=x||1,M=M||8,n=n||!1;var O,X,m,r,w,d,f,D,C,E,K,Z,h,p,o,J,S,B,_,W,z=[],k=this,g=T+1,U=new qq,c=new ls.FrenetFrames(H,T,n),Y=c.tangents,N=c.normals,G=c.binormals;for(this.tangents=Y,this.normals=N,this.binormals=G,C=0;g>C;C++)for(z[C]=[],r=C/(g-1),D=H.getPointAt(r),O=Y[C],X=N[C],m=G[C],E=0;M>E;E++)w=E/M*e,d=-x*b(w),f=x*y(w),U.copy(D),U.x+=d*X.x+f*m.x,U.y+=d*X.y+f*m.y,U.z+=d*X.z+f*m.z,z[C][E]=F(U.x,U.y,U.z);for(C=0;T>C;C++)for(E=0;M>E;E++)K=n?(C+1)%T:C+1,Z=(E+1)%M,h=z[C][E],p=z[K][E],o=z[K][Z],J=z[C][Z],S=new ej(C/T,E/M),B=new ej((C+1)/T,E/M),_=new ej((C+1)/T,(E+1)/M),W=new ej(C/T,(E+1)/M),this.faces.push(new Dl(h,p,J)),this.faceVertexUvs[0].push([S,B,W]),this.faces.push(new Dl(p,o,J)),this.faceVertexUvs[0].push([B.clone(),_,W.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};ls.prototype=ib(gh),ls.FrenetFrames=function(I,A,p){function z(){R[0]=new qq,w[0]=new qq,S=Number.MAX_VALUE,H=l(s[0].x),Q=l(s[0].y),Z=l(s[0].z),S>=H&&(S=H,d.set(1,0,0)),S>=Q&&(S=Q,d.set(0,1,0)),S>=Z&&d.set(0,0,1),L.crossVectors(s[0],d).normalize(),R[0].crossVectors(s[0],L),w[0].crossVectors(s[0],R[0])}var u,S,H,Q,Z,D,U,d=new qq,s=[],R=[],w=[],L=new qq,F=new Ue,K=A+1,i=1e-4;for(this.tangents=s,this.normals=R,this.binormals=w,D=0;K>D;D++)U=D/(K-1),s[D]=I.getTangentAt(U),s[D].normalize();for(z(),D=1;K>D;D++)R[D]=R[D-1].clone(),w[D]=w[D-1].clone(),L.crossVectors(s[D-1],s[D]),L.length()>i&&(L.normalize(),u=g(ll(s[D-1].dot(s[D]),-1,1)),R[D].applyMatrix4(F.makeRotationAxis(L,u))),w[D].crossVectors(s[D],R[D]);if(p)for(u=g(ll(R[0].dot(R[K-1]),-1,1)),u/=K-1,s[0].dot(L.crossVectors(R[0],R[K-1]))>0&&(u=-u),D=1;K>D;D++)R[D].applyMatrix4(F.makeRotationAxis(s[D],u*D)),w[D].crossVectors(s[D],R[D])};var Jl=function(B,g,X,L){Xi.call(this),g=g||18,X=X||0,L=L==w?e:L;for(var o=1/(B.length-1),R=1/g,t=0,H=g;H>=t;t++)for(var V=X+t*R*L,m=b(V),O=y(V),M=0,A=B.length;A>M;M++){var N=B[M],s=new qq;s.x=m*N.x-O*N.y,s.y=O*N.x+m*N.y,s.z=N.z,this.vertices.push(s)}for(var E=B.length,t=0,H=g;H>t;t++)for(var M=0,A=B.length-1;A>M;M++){var J=M+E*t,k=J,T=J+E,m=J+1+E,D=J+1,W=t*R,P=M*o,Z=W+R,x=P+o;this.faces.push(new Dl(k,D,T)),this.faceVertexUvs[0].push([new ej(W,P),new ej(W,x),new ej(Z,P)]),this.faces.push(new Dl(T,D,m)),this.faceVertexUvs[0].push([new ej(Z,P),new ej(W,x),new ej(Z,x)])}this.mergeVertices(),en(this),this.computeFaceNormals(),this.computeVertexNormals()};Jl.prototype=ib(gh);var wq=function(R,M){M=M||{};var n=pj.generateShapes(R,M);M.amount=M.amount!==i?M.amount:.5,M.convertYZ=!1,M.fill!==!1&&(M.bottom=!0,M.top=!0),$r.call(this,n,M)};wq.prototype=ib(Ze);var ab=v.Node=function(){qj(ab,this)},Qm={X:pm,Y:hr,Z:Yn},Tj={X:0,Y:1,Z:2},Rq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},pg="xzy",Oh=function(J,f,T){if(f){var j=f[0],t=f[1],s=f[2];"xzy"===T?(hr(J,t),Yn(J,s),pm(J,j)):"xyz"===T?(Yn(J,s),hr(J,t),pm(J,j)):"yxz"===T?(Yn(J,s),pm(J,j),hr(J,t)):"yzx"===T?(pm(J,j),Yn(J,s),hr(J,t)):"zxy"===T?(hr(J,t),pm(J,j),Yn(J,s)):"zyx"===T?(pm(J,j),hr(J,t),Yn(J,s)):(hr(J,t),Yn(J,s),pm(J,j))}};zc("Node",ji,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:pg,_64O:0,_rotationX:0,_53O:0,_host:w,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return dp},_22Q:function(){return ve},getX:function(){return this.p().x},setX:function(o){this.p(o,this.p().y)},getY:function(){return this.p().y},setY:function(D){this.p(this.p().x,D)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(y){this.setAnchor(y,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(L){this.setAnchor(this.getAnchor().x,L)},getScaleX:function(){return this.getScale().x},setScaleX:function(E){this.setScale(E,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(n){this.setScale(this.getScale().x,n)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(I,m){Vl(I,Xb(w,w,this.r3(),this.getRotationMode())),this.translate3d(I[0]*m,I[1]*m,I[2]*m)},translateFront:function(l){this.translate3dBy([0,0,1],l)},translateBack:function(u){this.translate3dBy([0,0,-1],u)},translateLeft:function(n){this.translate3dBy([-1,0,0],n)},translateRight:function(C){this.translate3dBy([1,0,0],C)},translateTop:function(o){this.translate3dBy([0,1,0],o)},translateBottom:function(K){this.translate3dBy([0,-1,0],K)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(n,g,C){1===arguments.length&&(g=n[1],C=n[2],n=n[0]),this.p(n,C),this.setElevation(g)},translate3d:function(j,f,O){1===arguments.length&&(f=j[1],O=j[2],j=j[0]),this.translate(j,O),this.setElevation(this._54O+f)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,j,G){1===arguments.length&&(j=c[1],G=c[2],c=c[0]),this.setSize(c,G),this.setTall(j)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(R,M,K){1===arguments.length&&(M=R[1],K=R[2],R=R[0]),this.setRotationX(R),this.setRotation(-M),this.setRotationZ(K)},setRotationY:function(s){this.setRotation(-s)},getRotationY:function(){return-this._64O},lookAtDirection:function(R,V){V=V||or;var h=this,O=Sp(R);V===or?(h.r3([-G(R[1]/O),-T(R[2],R[0])+k,0]),h.setRotationMode("xzy")):V===He?(h.r3(0,-T(R[2],R[0]),G(R[1]/O)),h.setRotationMode("zyx")):V===Nh?(h.r3(0,-T(R[2],R[0])+Q,-G(R[1]/O)),h.setRotationMode("zyx")):V===Gh?(h.r3([-G(R[1]/O)+k,-T(R[2],R[0])+k,0]),h.setRotationMode("xzy")):V===Qc&&(h.r3([-G(R[1]/O)-k,-T(R[2],R[0])+k,0]),h.setRotationMode("xzy")),V===Dd&&(h.r3([-G(R[1]/O)+Q,-T(R[2],R[0])+k,Q]),h.setRotationMode("zxy"))},lookAt:function(u,Q){return this.lookAtDirection(jp(u,this.p3()),Q)},lookAtX:function(){var i=new Jb,d=new Jb,y=new Jb,G=new _e,A=new _e,e=new Re;return function(S,_){var j=sf(this);if(G.fromArray(j),y.copy(this.p3()),i.copy(S).sub(y),!(i.lengthSq()<1e-6)){i.normalize(),_===or?d.set(0,0,1):_===Dd?d.set(0,0,-1):_===Nh?d.set(-1,0,0):_===He?d.set(1,0,0):_===Gh?d.set(0,1,0):_===Qc&&d.set(0,-1,0),d.applyMatrix4(G).sub(y).normalize();var P=Math.acos(i.dot(d));if(P){var C=i.clone().cross(d);C.lengthSq()<1e-6&&(_===Gh||_===Qc?C.set(0,0,1).applyMatrix4(G).sub(y):C.set(0,1,0).applyMatrix4(G).sub(y)),C.normalize(),e.set(this.r3(),this.getRotationMode(),!0),G.makeRotationFromEuler(e),A.makeRotationAxis(C,-P),e.setFromRotationMatrix(A.multiply(G)),this.r3([e.x,e.y,e.z])}}}}(),getHost:function(){return this._host},setHost:function(y){var M=this;if(M!==y&&M._host!==y){var S=M._host;S&&S._removeAttach(M),M._host=y,M._host&&M._host._addAttach(M),M.fp("host",S,y),M.onHostChanged(S,y)}},getAttaches:function(){return this._69O},_addAttach:function(v){var V=this;V._69O||(V._69O=new Pb),V._69O.add(v),V.fp("attaches",w,v)},_removeAttach:function(C){var X=this;X._69O.remove(C),X._69O.isEmpty()&&delete X._69O,X.fp("attaches",C,w)},getImage:function(){if(this._pendingCheckImageJSON){var M=C.getImage(this._image);M&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Do&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(S){var F=this,A=F._image,m=F.getWidth(),y=F.getHeight();F._image=S,F.fp("image",A,S)&&(null!=S&&(as(S)||tq(S)&&/\.json$/i.test(S))&&(this._pendingCheckImageJSON=!0),F.fp(In,m,F.getWidth()),F.fp(bc,y,F.getHeight()))},getElevation:function(){return this._54O},setElevation:function(I){var W=this;if(!W._50O){W._50O=1;var h=W._54O;W._54O=I,W.fp($b,h,I),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(M){var g=this;if(!g._49O){g._49O=1;var $=g._64O;g._64O=M,g.fp(mp,$,M),delete g._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(B){var H=this;if(!H._51O){H._51O=1;var f=H._rotationX;H._rotationX=B,H.fp("rotationX",f,B),delete H._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(v){var M=this;if(!M._52O){M._52O=1;var J=M._53O;M._53O=v,M.fp("rotationZ",J,v),delete M._52O}},getPosition:function(){return this._position},setPosition:function(D,_){var U=this;if(!U._50I){U._50I=1;var j;if(j=2===arguments.length?{x:D,y:_}:D,j.x!==U._position.x||j.y!==U._position.y){var T=U._position;U._position=j,U.fp(Zd,T,j)}delete U._50I}},translate:function(Z,I){var J=this._position;this.p(J.x+Z,J.y+I)},getWidth:function(){var W=this;if(W._width>=0)return W._width;var k=W.getStyle("shape3d");if(k){var U=Yg(k);if(U&&U.rawS3)return U.rawS3[0];if("billboard"===k||"plane"===k){var F=Mf(W.getStyle("shape3d.image"));return F?Xk(F,W):20}}var F=Mf(W._image);return F?Xk(F,W):20},setWidth:function(R){var U=this,s=U._width;U._width=R,U.fp(In,s,R)},getHeight:function(){var D=this;if(D._height>=0)return D._height;var h=D.getStyle("shape3d");if(h){var n=Yg(h);if(n&&n.rawS3)return n.rawS3[2];if("plane"===h){var e=Mf(D.getStyle("shape3d.image"));return e?Dg(e,D):20}if("billboard"===h)return 2}var e=Mf(D._image);return e?Dg(e,D):20},setHeight:function(Z){var b=this,C=b._height;b._height=Z,b.fp(bc,C,Z)},getTall:function(){var s=this;if(s._tall>=0)return s._tall;var D=s.getStyle("shape3d");if(D){var o=Yg(D);if(o&&o.rawS3)return o.rawS3[1];if("billboard"===D){var p=Mf(s.getStyle("shape3d.image"));return p?Dg(p,s):20}if("plane"===D)return 2}return 20},setTall:function(J){var A=this,S=A._tall;A._tall=J,A.fp("tall",S,J)},setSize:function(g,t){var Y=this;2===arguments.length?(Y.setWidth(g),Y.setHeight(t)):(Y.setWidth(g.width),Y.setHeight(g.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(m,K,e,U,X){var s=this,j=s.getAnchor(),L=s.getScale();arguments.length<=2&&(X=K,K=m.y,e=m.width,U=m.height,m=m.x);var r=X&&L.x<0?1-j.x:j.x,n=X&&L.y<0?1-j.y:j.y;s.p(m+e*r,K+U*n),X&&(e/=Math.abs(L.x),U/=Math.abs(L.y)),s.setWidth(e),s.setHeight(U)},getMatrix:function(){var r=this,M=r._64O,l=r._position,k=r.getScale();return new yk(M,l.x,l.y,k.x,k.y)},getAnchorRect:function(){var f=this,N=f.getWidth(),V=f.getHeight(),a=f.getAnchor();return{x:-N*a.x,y:-V*a.y,width:N,height:V}},toLocal:function(T){return this.getMatrix().tfi(T)},toGlobal:function(Z){return this.getMatrix().tf(Z)},getAttachPosition:function(){var l=new yk;return function(S,F,b,i){b=b||0,i=i||0;var E=this,C=E.getAnchor(),e=E._64O,V=E._position,Q=E.getScale();return l.setFromTransform(e,V.x,V.y).tf({x:b+Q.x*E.getWidth()*(S-C.x),y:i+Q.y*E.getHeight()*(F-C.y)})}}(),isInRect:function(e){e=this.toLocal(e);var D=this.getWidth(),C=this.getHeight();return e.x+=D*this.getAnchorX(),e.y+=C*this.getAnchorY(),!(e.x<0||e.y<0||e.x>D||e.y>C)},getRect:function(){var R=this,Y=R.getWidth(),L=R.getHeight(),A=R.getAnchor(),T={x:-Y*A.x,y:-L*A.y,width:Y,height:L},H=R.getMatrix();return T=ye([H.tf(T.x,T.y),H.tf(T.x+T.width,T.y),H.tf(T.x+T.width,T.y+T.height),H.tf(T.x,T.y+T.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var v=this,U=v.getAnchor(),Z=v._anchorElevation;return{x:U.x,y:Z,z:U.y}},setAnchorElevation:function(I){var M=this,D=M._anchorElevation;return D!==I?(M._anchorElevation=I,M.fp("anchorElevation",D,I),!0):!1},setAnchor3d:function(k,M,c,u){var A,W=this;"number"==typeof k?A={x:k,y:M,z:c}:(A=k.length?{x:k[0],y:k[1],z:k[2]}:k,u=M);var Q=W.getDataModel();Q&&Q.beginTransaction();var K=W.getAnchor3d(),G=W.setAnchor(A.x,A.z);if(W.setAnchorElevation(A.y)&&(G=!0),G&&u&&!wl){W.getAnchor3d();var H=sf(W),m=Vl([A.x-K.x,A.y-K.y,A.z-K.z],H);W.p3(m)}return Q&&Q.endTransaction(),G},getAnchor:function(){var G=this;if(G.hasOwnProperty("_anchor"))return G._anchor;var Q=Mf(G._image);return Q&&Q.anchorX!==i?{x:Q.anchorX,y:Q.anchorY}:G._anchor},setAnchor:function($,S,q){var i,B=this;"number"==typeof $?i={x:$,y:S}:(i=$.length?{x:$[0],y:$[1]}:$,q=S);var k=B.getAnchor();if(k.x!==i.x||k.y!==i.y){var s=B.getDataModel();if(s&&s.beginTransaction(),B._anchor=i,B.fp("anchor",k,i),q&&!wl){var T=B.getPosition(),L=B.getSize(),Z=B.getRotation(),H=B.getScale(),J=-L.width*(k.x-i.x)*H.x,h=-L.height*(k.y-i.y)*H.y,v=y(Z),I=b(Z);B.setPosition(T.x+I*J-v*h,T.y+v*J+I*h)}return s&&s.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(C,k){var B,a=this;B=2===arguments.length?{x:C,y:k}:C;var D=a.getScale();(D.x!==B.x||D.y!==B.y)&&(a._scale=B,a.fp("scale",D,B))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var V=this,C=V._scaleTall,a=V.getScale();return[a.x,C,a.y]},getFinalScale3d:function(){var N=this,q=N.s3(),w=N._dynamicScale3d,u=N.getScale3d();return q&&(u[0]*=q[0],u[1]*=q[1],u[2]*=q[2]),w&&(u[0]*=w[0],u[1]*=w[1],u[2]*=w[2]),u},getFinalRotation3d:function(){var G=this;return G._dynamicRotation||G.r3()},setScaleTall:function(N){var D=this,b=D._scaleTall;b!==N&&(D._scaleTall=N,D.fp("scaleTall",b,N))},setScale3d:function(Z,q,j){var e,z=this;e="number"==typeof Z?{x:Z,y:q,z:j}:Z.length?{x:Z[0],y:Z[1],z:Z[2]}:Z,z.setScaleTall(e.y),z.setScale(e.x,e.z)},getCorners:function(r,e){r==w&&(r=0),e==w&&(e=r);var g=this,B=g.getAnchor(),u=g.getWidth(),k=g.getHeight(),N=-u*B.x-r,b=-k*B.y-e,G=u+2*r,y=k+2*e,Z=g.getMatrix();return[Z.tf(N,b),Z.tf(N,b+y),Z.tf(N+G,b+y),Z.tf(N+G,b)]},getEditControlPoints:function(x,O,g){O==w&&(O=0),g==w&&(g=O);var K=this,J=K.getAnchor(),_=K.getWidth(),B=K.getHeight(),Q=-_*J.x-O,Y=-B*J.y-g,T=_+2*O,F=B+2*g;if(x)return[{x:Q,y:Y},{x:Q,y:0},{x:Q,y:Y+F},{x:0,y:Y+F},{x:Q+T,y:Y+F},{x:Q+T,y:0},{x:Q+T,y:Y},{x:0,y:Y}];var G=K.getMatrix();return[G.tf(Q,Y),G.tf(Q,0),G.tf(Q,Y+F),G.tf(0,Y+F),G.tf(Q+T,Y+F),G.tf(Q+T,0),G.tf(Q+T,Y),G.tf(0,Y)]},rotateAt:function(Y,k,m){var Q=this,d=Q._position,F=Q._64O,M=new yk(F,d.x,d.y).tf(Y,k),j=Z(Y*Y+k*k),l=T(d.y-M.y,d.x-M.x)+m;Q.setRotation(F+m),Q.p(M.x+j*b(l),M.y+j*y(l))},onParentChanged:function(){ab.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var H={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(V){H[V]=!0}),function(k){var B=this;ab.superClass.onPropertyChanged.call(B,k),H[k.property]&&!B._layoutUpdating&&B.updateLayoutParameters(null,k.property),B._69O&&B._69O.each(function(x){x.handleHostPropertyChange(k)}),B._49I&&B._49I.each(function(Y){Y.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(X){this.updateAttach(X)},onStyleChanged:function(Q){ab.superClass.onStyleChanged.apply(this,arguments),jh[Q]&&this.updateAttach()},updateAttach:function(f){var L=this;return wl?(L.updateLayoutParameters(),void 0):(L._51I||(L._51I=1,L._71O(f),delete L._51I),void 0)},_71O:function(A){var l,H,Q,u,e,y,t=this,p=t._host,s=A?A.property:w,B=A?A.oldValue:w,S=A?A.newValue:w;if(p instanceof v.Grid){if(s===$b)t.setElevation(t._54O+S-B);else if(!A||lg[s]){if(l=t.s("attach.row.index"),H=t.s("attach.column.index"),Q=p.getCellRect(l,H),!Q)return;u=t.s("attach.row.span"),e=t.s("attach.column.span"),(1!==u||1!==e)&&(Q=fj(Q,p.getCellRect(l+u-1,H+e-1))),$l(Q,t,"attach.padding",1),t.setRect(Q)}}else if(p instanceof bn&&(y=t.s("attach.index"))>=0&&(!A||ti[s])){var j=t.s("attach.thickness");j!=w&&t.setHeight(p.getThickness()*j);var z=t.s("attach.offset"),f=p.getPoints(),W=f.size();if(W>y){var n=f.get(y),O=W===y+1?f.get(0):f.get(y+1),I=[O.x-n.x,O.y-n.y],M=Sp(I);if(M){t.s("attach.offset.relative")&&(z*=M),t.s("attach.offset.opposite")&&(z=M-z);var k={x:n.x+I[0]/M*z,y:n.y+I[1]/M*z},P=t.s("attach.gap");P&&(t.s("attach.gap.relative")&&(P*=p.getThickness()),k=kk(w,k,O,P)),t.p(k),t.setRotation(T(I[1],I[0]))}}}else A&&(s===Zd?t.translate(S.x-B.x,S.y-B.y):s===$b?t.setElevation(t._54O+S-B):Jp[s]?t._11Q(p,s,S-B):("anchor"===s||"width"===s||"height"===s||"scale"===s)&&t.layout(p))},_11Q:function(){var R=new v.Math.Euler,J=v.Math.Euler.ReverseOrder,L=new v.Math.Vector2,y=new v.Math.Vector2;return function(b,w,I){var f=this,Y=b.p3(),u=b.r3(),t=f.p3(),Q=f.r3();if(w===mp&&(w="rotationY",I=-I),(w===mp||"rotationY"===w)&&0===Q[0]&&0===Q[2]&&0===u[0]&&0===u[2]&&0===t[1]&&0===Y[1])return f.setRotation(-Q[1]-I),L.set(t[0],t[2]).rotateAround(y.set(Y[0],Y[2]),-I),f.p(L.x,L.y),void 0;var T=Rq[b.getRotationMode()],l=T[0],F=T[1],M=T[2],x=Qm[l],K=Qm[F],N=Qm[M],n=Kr();w===mp+l?(N(n,u[Tj[M]]),K(n,u[Tj[F]]),x(n,I),K(n,-u[Tj[F]]),N(n,-u[Tj[M]])):w===mp+F?(N(n,u[Tj[M]]),K(n,I),N(n,-u[Tj[M]])):w===mp+M&&N(n,I);var r=jp(t,Y);Vl(r,n),f.p3(Y[0]+r[0],Y[1]+r[1],Y[2]+r[2]);var q=f.getRotationMode();Oh(n,f.r3(),q),R.setFromRotationMatrix(n,J(q)),f.r3([R.x,R.y,R.z])}}(),isHostOn:function(S){var k=this;if(k._host&&S&&S._69O)for(var J={},p=k._host;p&&p!==k&&!J[p._id];){if(p===S)return!0;J[p._id]=p,p=p._host}return!1},isLoopedHostOn:function(J){return this.isHostOn(J)&&J.isHostOn(this)},getScaledSize:function(){var $=this.getSize(),E=this.getScale();return $.width*=Math.abs(E.x),$.height*=Math.abs(E.y),$},layout:function(r){if(r=r||this.getHost()){var z=this,g=z.s("layout.h")||"center",B=z.s("layout.v")||"center";if("center"!==g||"center"!==B){var q=new v.Math.Vector2,h=r.getPosition(),f=r.getAnchor(),S=r.getScaledSize();z.getPosition();var H,V,R,C,E,$=1,o=1;switch(z._layoutUpdating=!0,g){case"left":q.setX(z._layoutHValue-f.x*S.width);break;case"right":q.setX((1-f.x)*S.width-z._layoutHValue);break;case"leftright":H=S.width-z._layoutHValue[2],R=z.getRotation()-r.getRotation(),C=Math.abs(Math.sin(R)),E=Math.abs(Math.cos(R)),$+=E*H/z._layoutHValue[3],o+=C*H/z._layoutHValue[4],q.setX(z._layoutHValue[1]+(z._layoutHValue[5]-f.x)*S.width);break;case"center":q.setX((.5-f.x)*S.width-z._layoutHValue);break;case"scale":R=z.getRotation()-r.getRotation(),C=Math.abs(Math.sin(R)),E=Math.abs(Math.cos(R)),q.setX((.5-f.x)*S.width-z._layoutHValue[1]*S.width/z._layoutHValue[0]),V=S.width/z._layoutHValue[2]-1,$+=E*V,o+=C*V}switch(B){case"top":q.setY(z._layoutVValue-f.y*S.height);break;case"bottom":q.setY((1-f.y)*S.height-z._layoutVValue);break;case"topbottom":R||(R=z.getRotation()-r.getRotation(),C=Math.abs(Math.sin(R)),E=Math.abs(Math.cos(R))),H=S.height-z._layoutVValue[2],$+=C*H/z._layoutVValue[3],o+=E*H/z._layoutVValue[4],q.setY(z._layoutVValue[1]+(z._layoutVValue[5]-f.y)*S.height);break;case"center":q.setY((.5-f.y)*S.height-z._layoutVValue);break;case"scale":R||(R=z.getRotation()-r.getRotation(),C=Math.abs(Math.sin(R)),E=Math.abs(Math.cos(R))),q.setY((.5-f.y)*S.height-z._layoutVValue[1]*S.height/z._layoutVValue[0]),V=S.height/z._layoutVValue[2]-1,$+=C*V,o+=E*V}if("leftright"===g||"scale"===g||"topbottom"===B||"scale"===B){var K=this.getScale(),a=Math.abs(K.x),k=Math.abs(K.y);"leftright"===g||"scale"===g?z.setSize(z._layoutHValue[3]*$/a,z._layoutHValue[4]*o/k):z.setSize(z._layoutVValue[3]*$/a,z._layoutVValue[4]*o/k)}q.rotateAround(null,r.getRotation()),this.setPosition(q.x+h.x,q.y+h.y),z._layoutUpdating=i}}},updateLayoutParameters:function(G,l){if(G=G||this.getHost()){var u=this,j=u.s("layout.h"),b=u.s("layout.v");if(j||b){var A,V,x,f,S,E,i=new v.Math.Vector2,Q=G.getPosition(),Z=G.getAnchor(),I=G.getScaledSize(),C=u.getPosition(),F=u.getScaledSize();switch(i.set(C.x-Q.x,C.y-Q.y),i.rotateAround(null,-G.getRotation()),j){case"left":u._layoutHValue=i.x+Z.x*I.width;break;case"right":u._layoutHValue=-i.x+(1-Z.x)*I.width;break;case"center":u._layoutHValue=-i.x+(.5-Z.x)*I.width;break;case"leftright":case"scale":"scale"===j?A=-i.x+(.5-Z.x)*I.width:(V=u.getAnchor(),x=u.getRotation()-G.getRotation(),f=Math.cos(x),S=Math.sin(x),E=-Math.min(-V.x*f+V.y*S,-V.x*f-(1-V.y)*S,(1-V.x)*f+V.y*S,(1-V.x)*f-(1-V.y)*S),A=i.x-(E-Z.x)*I.width),"position"===l&&"object"==typeof u._layoutHValue?(u._layoutHValue[0]=I.width,u._layoutHValue[1]=A):u._layoutHValue=[I.width,A,I.width,F.width,F.height,E]}switch(b){case"top":u._layoutVValue=i.y+Z.y*I.height;break;case"bottom":u._layoutVValue=-i.y+(1-Z.y)*I.height;break;case"center":u._layoutVValue=-i.y+(.5-Z.y)*I.height;break;case"topbottom":case"scale":"scale"===b?A=-i.y+(.5-Z.y)*I.height:(x||(V=u.getAnchor(),x=u.getRotation()-G.getRotation(),f=Math.cos(x),S=Math.sin(x)),E=-Math.min(-V.x*S-V.y*f,-V.x*S+(1-V.y)*f,(1-V.x)*S-V.y*f,(1-V.x)*S+(1-V.y)*f),A=i.y-(E-Z.y)*I.height),"position"===l&&"object"==typeof u._layoutVValue?(u._layoutVValue[0]=I.height,u._layoutVValue[1]=A):u._layoutVValue=[I.height,A,I.height,F.width,F.height,E]}}}},getSerializableProperties:function(){var $=ab.superClass.getSerializableProperties.call(this);return og($,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),$}});var Fb=v.Edge=function(S,n){var X=this;qj(Fb,X),X.setSource(S),X.setTarget(n)};zc("Edge",ji,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return ge},_22Q:function(){return Xn},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(O){if(O===this)return!1;if(gr(O))return!0;for(var V,l,e,T,E,W=[this],D=-1,o=0;o>D;)if(D++,V=W[D],l=V._44I)for(l=l.getArray(),T=0,E=l.length;E>T;T++)if(e=l[T],kn(e)&&!(W.indexOf(e)>=0)){if(e===O)return!1;W.push(e),o++}return!0},setSource:function(h){var L=this;if(L._source!==h&&L.canSetSourceTarget(h)){var n=L._source;L._source=h,n&&n._16I(L),h&&h._2I(L),L._7I(),L.fp("source",n,h)}},setTarget:function(G){var F=this;if(F._target!==G&&F.canSetSourceTarget(G)){var K=F._target;F._target=G,K&&K._18I(F),G&&G._4I(F),F._7I(),F.fp("target",K,G)}},isLooped:function(){var z=this;return z._source===z._target&&gr(z._source)&&gr(z._target)},onPropertyChanged:function(){var q=this;q._49I&&q._49I.each(function(e){e.fp("agentChange",!0,!1)})},_7I:function(){var M,a=this,I=Nn(a);a._40I!==I&&(M=this._40I,M&&M._15I(a),a._40I=I,I&&I._1I(a),a.fp("sourceAgent",M,I),Ki(M,a._41I),Ki(I,a._41I));var H=ag(a);a._41I!==H&&(M=a._41I,M&&M._17I(a),a._41I=H,H&&H._3I(a),a.fp("targetAgent",M,H),Ki(M,a._40I),Ki(H,a._40I))},_22I:function(o){this._52I=o,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var w=this;return w._52I&&w._52I.get(0)!==w&&!w.getStyle(rm)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var Y=this,C=Y._52I;return C&&!Y.getStyle(rm)&&C.size()>1&&Y===C.get(0)},toggle:function(){var g=this._52I,c=!this.s(rm);g&&g.size()>1&&(g.each(function(G){G.s(rm,c)}),g.getSiblings().each(function(P){P!==g&&P.each(function(v){v.fp("edgeGroup",w,P)})}))},setStyle:function(E,G){(E===Gg||"edge.segments"===E)&&(G=_r(G)),Fb.superClass.setStyle.call(this,E,G)},onStyleChanged:function(q){Fb.superClass.onStyleChanged.apply(this,arguments),Ak[q]&&Ki(this._41I,this._40I)},getSerializableProperties:function(){var S=Fb.superClass.getSerializableProperties.call(this);return og(S,{source:1,target:1}),S}});var le=v.Group=function(){qj(le,this)};zc("Group",ab,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Hg},onChildAdded:function(){le.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){le.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var M=this;if(!M._54I&&!wl){var h=M.getChildrenRect();h&&(M._53I=1,M.p(vb(M.s("group.position"),h,M.getSize())),delete M._53I)}},getChildrenRect:function(){var D,B=this;return B.eachChild(function(H){gr(H)&&(D=fj(D,B.getChildRect(H)))}),D},getChildRect:function(L){var p;return gr(L)&&L.s(Tf)&&(Xh(L)&&L.isExpanded()&&L.eachChild(function(c){p=fj(p,L.getChildRect(c))}),!p&&L.getRect&&(p=L.getRect())),p},setPosition:function(R,Z){var h=this;if(!h._54I){var J;J=2===arguments.length?{x:R,y:Z}:R,wl||h._53I||(h._54I=1,bf(h._children,J.x-h._position.x,J.y-h._position.y),delete h._54I),le.superClass.setPosition.call(this,J)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(O){var F=this;if(F._57O!==O){var R=F._57O;F._57O=O,F.fp("expanded",R,F._57O),F._fireInvalidateDeep(),F._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(N){Xh(N)?N._fireInvalidateDeep():N.iv()})},_8I:function(){le.superClass._8I.call(this),this.eachChild(function(T){gr(T)&&T._8I()})},onStyleChanged:function(C){le.superClass.onStyleChanged.apply(this,arguments),"group.position"===C&&this._81I()},getSerializableProperties:function(){var F=le.superClass.getSerializableProperties.call(this);return F.expanded=1,F}});var jl=v.Block=function(){qj(jl,this)};zc("Block",ab,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Ed},onChildAdded:function(){jl.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){jl.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var K=this;if(!wl&&!K._updatingToChildren&&K._syncSize&&!K._freezeSyncFromChildren){var I,j,o,z,k,$=[],m=K.getRotation();if(K.eachChild(function(X){gr(X)&&$.push.apply($,X.getCorners())}),$.length){K._updatingFromChildren=1;var r=b(-m),A=y(-m),P=1/0,B=-1/0,U=1/0,Y=-1/0;for(z=0,k=$.length;k>z;z++)o=$[z],I=o.x,j=o.y,o.x=r*I-A*j,o.y=A*I+r*j,P=V(P,o.x),B=H(B,o.x),U=V(U,o.y),Y=H(Y,o.y);var f=K.getScale();K.setSize(l((B-P)/f.x),l((Y-U)/f.y));var x;f.x<0&&(x=P,P=B,B=x),f.y<0&&(x=U,U=Y,Y=x),r=b(m),A=y(m);var G=K.getAnchor();I=P+(B-P)*G.x,j=U+(Y-U)*G.y,K.setPosition(r*I-A*j,A*I+r*j),delete K._updatingFromChildren}}},setPosition:function(I,R){var y=this;if(!y._updatingToChildren){var s;s=2===arguments.length?{x:I,y:R}:I,wl||y._updatingFromChildren||(y._updatingToChildren=1,bf(y._children,s.x-y._position.x,s.y-y._position.y),delete y._updatingToChildren),jl.superClass.setPosition.call(this,s)}},setWidth:function(J){return this.setSize(J,this.getHeight())},setHeight:function(p){return this.setSize(this.getWidth(),p)},setSize:function(b,C){1>b&&(b=1),1>C&&(C=1);var P=this;if(!P._updatingToChildren){2!==arguments.length&&(C=b.height,b=b.width);var J=P.getWidth(),A=P.getHeight();if(b!==J&&jl.superClass.setWidth.call(P,b),C!==A&&jl.superClass.setHeight.call(P,C),!wl&&!P._updatingFromChildren){P._updatingToChildren=1;var x=b/J,T=C/A;P._adjustChildScaleOrSize(x,T,"size"),delete P._updatingToChildren,P.updateFromChildren()}}},_adjustChildScaleOrSize:function(Z,j,z){var V=this;if(V._syncSize){var K=V.getPosition(),h=V.getRotation();V.getScale(),V.eachChild(function(B){if(gr(B)){var M=B.getPosition(),a=B.getRotation(),R=B.getWidth(),E=B.getHeight(),C=B.getScale(),U=C.x*R,t=C.y*E,q=new yk(a,M.x,M.y,U,t);q.translate(-K.x,-K.y),q.rotate(-h),a=T(q.b*Math.sign(U),q.a*Math.sign(U)),q.scale(Z,j);var X,W,s,Q=b(a);if(Math.abs(Q)<.001?(X=y(a),W=q.b/X,s=-q.c/X):(W=q.a/Q,s=q.d/Q),"scale"===z)B.setScale(W/R,s/E);
else if("size"===z){var p=W/C.x,V=s/C.y;B.setScale(Jn(W)*Math.abs(C.x),Jn(s)*Math.abs(C.y)),B instanceof v.Shape?(B.setWidthForce(Math.max(Math.abs(p),1e-5)),B.setHeightForce(Math.max(Math.abs(V),1e-5))):B.setSize(Math.max(.01,Math.abs(p)),Math.max(.01,Math.abs(V)))}q.rotate(h),q.translate(K.x,K.y),B.setPosition(q.tx,q.ty)}})}},_calcChangeFactor:function(v,a,X,i){var s,$,b,M;return s=l(v),$=l(X),b=s>$?s/$:$/s,s=l(a),$=l(i),M=s>$?s/$:$/s,H(b,M)},setAnchor:function(){var H=this;if(!H._updatingToChildren){var Z=H.getAnchor();if(jl.superClass.setAnchor.apply(H,arguments),!wl&&!H._updatingFromChildren&&H._syncSize){H._updatingToChildren=1;var K=H.getAnchor();H.getPosition();var x=H.getSize(),w=H.getScale(),T=H.getRotation(),C=-x.width*w.x*(Z.x-K.x),L=-x.height*w.y*(Z.y-K.y),n=y(T),W=b(T),i=W*C-n*L,g=n*C+W*L;H.eachChild(function(x){if(gr(x)){var o=x.getPosition();x.setPosition(o.x-i,o.y-g)}}),delete H._updatingToChildren}}},setRotation:function(B){var z=this;if(!z._updatingToChildren){var y=z.getRotation();if(jl.superClass.setRotation.apply(z,arguments),!wl&&!z._updatingFromChildren){z._updatingToChildren=1;var U=z.getPosition(),d=B-y;z.eachChild(function(A){if(gr(A)){var c=A.getMatrix();c.translate(-U.x,-U.y),c.rotate(d),c.translate(U.x,U.y);var i=Math.sign(A.getScale().x);A.setRotation(T(c.b*i,c.a*i)),A.setPosition(c.tx,c.ty)}}),delete z._updatingToChildren}}},setScale:function(v,f){var x=this;if(!x._updatingToChildren){null==f&&(f=v.y,v=v.x);var Z=x.getScale();if(l(v)<.01&&(v=.01*(Jn(v)||Jn(Z.x))),l(f)<.01&&(f=.01*(Jn(f)||Jn(Z.y))),jl.superClass.setScale.call(x,v,f),!wl&&!x._updatingFromChildren){x._updatingToChildren=1;var g=v/Z.x,P=f/Z.y;x._adjustChildScaleOrSize(g,P,"size"),delete x._updatingToChildren,x.updateFromChildren()}}},getSerializableProperties:function(){var z=jl.superClass.getSerializableProperties.call(this);return z.clickThroughEnabled=1,z.syncSize=1,z}});var Jc=v.Grid=function(){qj(v.Grid,this)};zc("Grid",ab,{IRotatable:!1,_icon:"grid_icon",_image:w,getUIClass:function(){return Ik},setRotation:function(){},getCellRect:function(b,R){var c=this,V=c.s("grid.row.count"),E=c.s("grid.column.count");if(0>=V||0>=E||0>b||b>=V||0>R||R>=E)return w;var h,P,C,f=c.getRect(),x=c.s("grid.row.percents"),m=c.s("grid.column.percents");if($l(f,c,"grid.border",-1),x&&x._as&&(x=x._as),m&&m._as&&(m=m._as),x&&x.length===V){for(C=0,h=0;b>h;h++)C+=f.height*x[h];f.y+=C,f.height=f.height*x[b]}else f.height=f.height/V,f.y+=f.height*b;if(m&&m.length===E){for(P=0,h=0;R>h;h++)P+=f.width*m[h];f.x+=P,f.width=f.width*m[R]}else f.width=f.width/E,f.x+=f.width*R;return Cc(f,-c.s("grid.gap")),f}});var lk=v.Text=function(){qj(lk,this),this.setSize(100,50),this.s("text","TEXT")};zc("Text",ab,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Fd},setWidth:function(I){I||(I=.001),lk.superClass.setWidth.call(this,I)},setHeight:function(u){u||(u=.001),lk.superClass.setHeight.call(this,u)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Yb("__text__",{width:{value:100,isSafeFunc:!0,func:function(H){return H._width}},height:{value:50,isSafeFunc:!0,func:function(n){return n._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var bn=v.Shape=function(){qj(bn,this),this._59O=new Pb};bn.__de__=qr,zc("Shape",ab,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return ub},_22Q:function(){return Yh},getLength:function(U){return Xq(mm(this._59O,this._58O,U,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var N=this._58O;return N?new Pb(N._as.slice(0)):N},setSegments:function(U){var G=this._58O;U=U?qf(U)?new Pb(U.slice(0)):new Pb(U._as.slice(0)):null,(G&&U&&G._as.join(",")!==U._as.join(",")||G!==U)&&(this._58O=U,this.fp("segments",G,U))},getPoints:function(){return this._59O},toPoints:function(){var x=this._59O;return new Pb(x._as.slice(0))},setPoints:function(T,C){var q=this,Y=q._59O;T=T?qf(T)?new Pb(T.slice(0)):new Pb(T._as.slice(0)):new Pb;var p,P,V,O,R,B;C&&(p=q.getPosition(),B=new yk(q.getRotation(),0,0,q.getScale().x,q.getScale().y)),(Y&&T&&Y._as.join(",")!==T._as.join(",")||Y!==T)&&(q._59O=T,q.fs(),q.fp("points",Y,T)),C&&(P=q.getPosition(),V=P.x-p.x,O=P.y-p.y,R=B.tf(V,O),q.setPosition(P.x-V+R.x,P.y-O+R.y))},addPoint:function(F,L,h){var D=this.toPoints();D.add(F,L),this.setPoints(D,h)},setPoint:function(j,z,J){var G=this.toPoints();G.set(j,z),this.setPoints(G,J)},removePointAt:function(l){var M=this.toPoints();M.removeAt(l),this.setPoints(M)},setWidthForce:function(l){var R=this;if(!R._55I&&!wl&&R.getWidth()){R._55I=1;var C=R._position.x,K=l/R.getWidth(),e=R.toPoints(),c=new Pb;1!==K&&(e.each(function(E){c.add({x:(E.x-C)*K+C,y:E.y,e:E.e})}),R.setPoints(c),oo(R,[K,0,0,1,C*(1-K),0]),R.fs()),delete R._55I}bn.superClass.setWidth.call(R,l)},setWidth:function(o){return this.setWidthForce(1>o?1:o)},setHeightForce:function(Y){var H=this;if(!H._55I&&!wl&&H.getHeight()){H._55I=1;var $=H._position.y,S=Y/H.getHeight(),f=H.toPoints(),K=new Pb;1!==S&&(f.each(function(o){K.add({x:o.x,y:(o.y-$)*S+$,e:o.e})}),H.setPoints(K),oo(H,[1,0,0,S,0,$*(1-S)]),H.fs()),delete H._55I}bn.superClass.setHeight.call(H,Y)},setHeight:function(L){return this.setHeightForce(1>L?1:L)},setAnchorElevation:function(h){var E=this;E._55I=!0;var $=E._updatingAnchor3d,v=!wl&&!$;if(v){var L,i=h,X=E.getAnchorElevation(),f=E.getTall();L=f*(X-i),0!==L&&E.shiftPointsElevation(L)}var m=bn.superClass.setAnchorElevation.apply(E,arguments);return $||delete E._55I,m},getShapeElevation:function(){var K=this,r=K._54O;return r-(K.getTall()||0)*(K._anchorElevation-.5)},setAnchor3d:function(z,i,T,M){var k,R=this;"number"==typeof z?k={x:z,y:i,z:T}:(k=z.length?{x:z[0],y:z[1],z:z[2]}:z,M=i),R._55I=!0,R._updatingAnchor3d=!0;var f=R.getDataModel();if(f&&f.beginTransaction(),!wl){var N=R.getAnchor3d(),g=R.getSize(),x=R.getTall(),u=g.width*(N.x-k.x),w=g.height*(N.z-k.z),X=x*(N.y-k.y);M||R.shiftPoints(u,w,X);var s=R.p3()}var C=bn.superClass.setAnchor3d.apply(R,arguments);if(!wl&&M){var h=R.p3();R.shiftPoints(h[0]-s[0]+u,h[2]-s[2]+w,h[1]-s[1]+X)}return f&&f.endTransaction(),delete R._updatingAnchor3d,delete R._55I,C},setAnchor:function(J,M,W){var I=this;I._55I=!0;var P=I._updatingAnchor3d,K=!wl&&!P;if(K){var _,O,g;"number"==typeof J?g={x:J,y:M}:(g=J.length?{x:J[0],y:J[1]}:J,W=M);var i=I.getAnchor(),b=I.getSize();_=b.width*(i.x-g.x),O=b.height*(i.y-g.y),W||I.shiftPoints(_,O);var h=I.getPosition()}var t=bn.superClass.setAnchor.apply(I,arguments);if(K){var n=I.getPosition();W&&I.shiftPoints(n.x-h.x+_,n.y-h.y+O)}return P||delete I._55I,t},shiftPoints:function(o,x,L){if(o||x||L){var Z=this,j=Z.getElevation()||0,R=Z.toPoints(),e=new Pb;R.each(function($){var l=$.e;L&&(l=(l==w?j:l)+L),e.add({x:$.x+o,y:$.y+x,e:l})}),Z.setPoints(e),Z.fs()}},shiftPointsElevation:function(d){return this.shiftPoints(0,0,d)},setPosition:function(c,b){var O,W=this;if(!W._28Q){if(W._28Q=1,!W._55I&&!wl){O=2===arguments.length?{x:c,y:b}:c;var d=O.x-W._position.x,P=O.y-W._position.y;if(0===d&&0===P)return delete W._28Q,void 0;W._55I=1,W.shiftPoints(d,P),oo(W,[1,0,0,1,d,P]),delete W._55I}bn.superClass.setPosition.apply(W,arguments),delete W._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var A=this;if(2!==A._59O.size())return!1;var G=A._58O;return G?2===G.size()&&1===G.get(0)&&2===G.get(1)?!0:!1:!0},fireShapeChange:function(){var B=this;if(!B._55I&&!wl){var t=ye(B._59O);t&&(B._55I=1,B.setRect(t),delete B._55I)}B.fp(Mh,!1,!0)},getSerializableProperties:function(){var f=bn.superClass.getSerializableProperties.call(this);return f.segments=1,f.points=1,f.thickness=1,f.closePath=1,f}});var ns=v.Polyline=function(){qj(ns,this),this.s({"shape.background":null,"shape.border.width":2})};zc("Polyline",bn,{_icon:"polyline_icon",_22Q:function(){return Mp},getUIClass:function(){return yr},setClosePath:function(){},setTall:function(s){var e=this,X=e.getDataModel();if(X&&X.beginTransaction(),!e._55I&&!e._24Q&&!wl&&e.getTall()){e._24Q=1;var Y=e._54O,I=s/e.getTall();if(1!==I){var j=e.toPoints(),m=new Pb;j.each(function(B){m.add({x:B.x,y:B.y,e:B.e==w?B.e:(B.e-Y)*I+Y})}),e.setPoints(m),e.fs()}delete e._24Q}ns.superClass.setTall.call(e,s),X&&X.endTransaction()},setElevation:function(r){var b=this,n=b.getDataModel();if(n&&n.beginTransaction(),!b._55I&&!b._24Q&&!wl){b._24Q=1;var e=r-b._54O;0!==e&&b.shiftPointsElevation(e),delete b._24Q}ns.superClass.setElevation.apply(b,arguments),n&&n.endTransaction()},fireShapeChange:function(){var l=this,k=l._59O;if(!l._55I&&!l._24Q&&!wl){var p=k.size();if(p){var B=1,v=k.get(0),U=l._54O;v.e==w&&(v.e=U);for(var N=v.e,P=0;p>B;B++){v=k.get(B),v.e==w&&(v.e=U);var s=V(N,v.e),O=H(N+P,v.e);N=s,P=O-s}l._24Q=1,l.setTall(P),l.setElevation(N+P*l._anchorElevation),delete l._24Q}}ns.superClass.fireShapeChange.apply(l,arguments)}});var jj=v.SubGraph=function(){qj(jj,this)};zc("SubGraph",ab,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){jj.superClass._8I.call(this),this.eachChild(function(K){gr(K)&&K._8I()})}}),C.loadingRefGraph=0;var Do=v.RefGraph=function(){qj(Do,this)};zc("RefGraph",jl,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(E){var B=this._ref;this._ref=E,this.fp("ref",B,E),this.updateRef()},_21I:function(){Do.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var f=this;if(C.loadingRefGraph++,f.clearChildrenFromDataModel(),C.loadingRefGraph--,f._ref&&f._dataModel){f._xhrLoadHandler&&(f._xhrLoadHandler.cancel=!0);var S=wl,u=f._xhrLoadHandler=function(h){if(h&&f._dataModel){C.loadingRefGraph++;var a=f._pendingUpdateInfo={needToRestore:S};S&&(a.position=f.p(),a.width=f.getWidth(),a.height=f.getHeight(),a.rotation=f.getRotation(),a.anchor=f.getAnchor(),a.scale=f.getScale()),f.p(0,0),f.setAnchor(.5,.5),f.setRotation(0),f.setScale(1,1);var E=C.parse(h),j=f._dataModel.deserialize(E,f,{justDatas:!0});j.each(function(G){G._refGraph=f}),f.checkPendingUpdateInfo(),C.loadingRefGraph--,C.handleRefGraphLoaded(f,j,E)}};u.xhrLoadCalled=!1,C.load(f._ref,function(W){u.cancel||(u.xhrLoadCalled?u(W):Ao(function(){u(W)}))}),u.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var t=this,L=t._pendingUpdateInfo;if(!L)return t.onPendingUpdated&&(C.loadingRefGraph++,t.onPendingUpdated(),C.loadingRefGraph--),void 0;var n=!0;this.eachChild(function(b){(b._pendingCheckImageJSON||b._pendingUpdateInfo)&&(n=!1)}),n&&(C.loadingRefGraph++,t._pendingUpdateInfo=null,t.updateFromChildren(),L.needToRestore&&(t.setSize(L.width,L.height),t.setAnchor(L.anchor),t.setRotation(L.rotation),t.setScale(L.scale),t.p(L.position)),this.getParent()instanceof Do&&this.getParent().checkPendingUpdateInfo(),t.onPendingUpdated&&t.onPendingUpdated(),C.loadingRefGraph--)},getSerializableProperties:function(){var h=Do.superClass.getSerializableProperties.call(this);return h.ref=1,h}}),v.EdgeGroup=function(W,t){this._70O=W,this._siblings=t;for(var q,J,U=0,$=W.size(),R=Y[rm];$>U;U++)if(q=W.get(U).getStyle(rm,!1),q!=w){R=q;break}R==w&&(R=!0);var o=C.edgeGroupAgentFunc;for(o&&(J=o(W),J&&J!==W.get(0)&&(W.remove(J),W.add(J,0))),U=0;$>U;U++)W.get(U).s(rm,R)},zc("EdgeGroup",I,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(Y){return this._70O.get(Y)},indexOf:function(v){return this._70O.indexOf(v)},each:function(w,o){this._70O.each(w,o)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(e,T){this._siblings.each(function(W){W._70O.each(e,T)})}});var Gm=function(r,C,U){var Z=_h[r]={type:r,action:C};if(U)for(var O in U)Z[O]=U[O]};og(C,{setConnectAction:Gm,getConnectAction:function(g,o){if(!o){if(!g)return null;o=g.getCurrentConnectActionType()}return _h[o]},doConnectAction:function(j,A,n,m){m=m||j.getCurrentConnectActionType();var z=_h[m];if(!z)return!1;var L=z.action;return L?(A instanceof em.Group?j.sm().getSelection().each(function($){L.call(null,j,$,n)}):L.call(null,j,A,n),!0):!1},doDeleteConnectionAction:function(X,b,t){t=t||X.getCurrentConnectActionType();var d=_h[t];if(!d||!d.delete)return!1;var G=d.delete.action;return G?(b instanceof em.Group?X.sm().getSelection().each(function(_){G.call(null,X,_)}):G.call(null,X,b),!0):!1}});var qm=v.JSONSerializer=function(T,c){this.dm=this._dataModel=T,this._hierarchical=C.forceHierarchicalSerialization?!0:c==w?T.isHierarchicalRendering():c};zc("JSONSerializer",I,{ms_ac:["hierarchical"],serialize:function(R){return C.stringify(this.toJSON(),R)},toJSON:function(){var p=this,b=p.dm,H=b.getRoots(),y=p.json={v:C.getVersion(),p:{},a:{},d:[]},m=b.getSerializableAttrs();b.getInit()&&(y.init=b.getInit()),b.getName()&&(y.p.name=b.getName()),b.getBackground()&&(y.p.background=b.getBackground()),b.getLayers()&&(y.p.layers=b.getLayers()),b.getEnvmap()&&(y.p.envmap=b.getEnvmap()),y.p.autoAdjustIndex=b.isAutoAdjustIndex(),y.p.hierarchicalRendering=b.isHierarchicalRendering();for(var e in m){var g=b.a(e);g!==i&&p[zh](e,g,y.a)}return si(y.a)&&delete y.a,p._hierarchical?H.each(p.serializeData,this):b.each(function(x){p.serializeData(x)}),b.fireSerializeEvent({type:"serialize",json:y}),b.getPostProcessingData()&&(y.p.postProcessingData=b.getPostProcessingData()),y},isSerializable:function(){return!0},getProperties:function(D){return D.getSerializableProperties()},getStyles:function(x){return x.getSerializableStyles()},getAttrs:function(l){return l.getSerializableAttrs()},serializeData:function(x){var Y=this;if(Y.isSerializable(x)&&!x._refGraph){var s,n,k,X,r=As(x.getClassName())||x.getClass(),A=new r,U={c:x.getClassName(),i:x.getId(),p:{},s:{},a:{}};Y.json.d.push(U),s=Y.getProperties(x);for(n in s)if(/^_/.test(n)){if(k=x[n],!("_width"!==n&&"_height"!==n||k!=w&&-1!==k)){var T;((x.s("layout.h")||x.s("layout.v"))&&x.getHost()||x instanceof v.Node&&(T=x.getParent())&&T instanceof v.Block||x.s("fullscreen"))&&(k=x[n]="_width"===n?x.getWidth():x.getHeight())}k!==A[n]&&Y[zh](n.substr(1),k,U.p)}else X=Mo(n),x[X]&&(k=x[X](),k!==A[X]()&&Y[zh](n,k,U.p));s=Y.getStyles(x);for(n in s)k=x.s(n),k!==A.s(n)&&Y[zh](n,k,U.s);s=Y.getAttrs(x);for(n in s)k=x.a(n),k!==A.a(n)&&Y[zh](n,k,U.a);si(U.p)&&delete U.p,si(U.s)&&delete U.s,si(U.a)&&delete U.a}Y._hierarchical&&x.getChildren().each(Y.serializeData,Y)},serializeValue:function(z,V,Z){eq(V)?V={__a:V._as}:V instanceof ji&&(V={__i:V.getId()}),Z[z]=V},deserialize:function(S,g,k){var n=this;return tq(S)&&/.json$/.test(S)?(C.xhrLoad(S,function(B){n.deserializeImpl(B,g,k)}),void 0):n.deserializeImpl(S,g,k)},deserializeImpl:function(X,G,j){var N=this,p=N.dm;j=tl(j)?{setId:j}:Ad(j)?{finishFunc:j}:j||{},X=N.json=tq(X)?C.parse(X):X,X.a&&X.a.onPreDeserialize&&!j.disableOnPreDeserialize&&X.a.onPreDeserialize(X,p,j.view),p.beginTransaction(),wl++,N._82I={};var d=new Pb,l=new Pb,f=0,R=X.d.length;if(j.justDatas||(Ad(X.init)&&X.init(p),p.setInit(X.init)),!j.justDatas){for(var L in X.a)p.a(L,N[Cq](X.a[L]));for(var F in X.p)p[Mj(F)](X.p[F])}for(;R>f;f++){var D=X.d[f],s=As(D.c),k=new s,P=D.i;j.setId&&P!=w&&(k._id=P),N._82I[P]=k,d.add(k),l.add(D)}for(f=0;R>f;f++)N.deserializeData(d.get(f),l.get(f));return d.each(function(a){G&&!a.getParent()&&a.setParent(G),p.add(a)}),p.fireSerializeEvent({type:"deserialize",json:X}),wl--,p.endTransaction(),X.a&&X.a.onPostDeserialize&&!j.disableOnPostDeserialize&&X.a.onPostDeserialize(X,p,j.view,d),j.finishFunc&&j.finishFunc(X,p,j.view,d),d},deserializeData:function(n,e){for(var P in e.p)n[Mj(P)](this[Cq](e.p[P]));for(P in e.s)n.s(P,this[Cq](e.s[P]));for(P in e.a)n.a(P,this[Cq](e.a[P]))},deserializeValue:function(U){if(as(U)){var W=U.__i;if(W!=w)return this._82I[W];if(W=U.__a,qf(W))return new Pb(W)}return U}}),og(Ln,{serialize:function(X,H){return new qm(this,H).serialize(X)},toJSON:function(J){return new qm(this,J).toJSON()},deserialize:function(t,k,P){return new qm(this).deserialize(t,k,P)}});var Wm=v.OverlappingBox=function(g){this.gv=g,this.boxes={}};zc("OverlappingBox",I,{clear:function(){var T,r,R=this.boxes;for(T in R)r=R[T],r.length=0},isOverlapping:function(W,I){var t,w,b=this,G=b.boxes,Z=G[W];Z?(t=Z.rects,w=Z.length):Z=G[W]={rects:t=[],length:w=0};var V,S,I;for(V=0;w>V;V++)if(S=t[V],S.x<I.x+I.w&&S.x+S.w>I.x&&S.y<I.y+I.h&&S.h+S.y>I.y)return!0;return t.length<=w?(t.push(I),Z.length++):t[Z.length++]=I,!1}}),og(C,{fetch:function(n,R){var S="GET",Q=!1,x=null,U="";R&&(S=R.method||"GET",Q=R.sync,U=R.url,x=R.data||null),n.open(S,U,!Q),R.responseType?n.responseType=R.responseType:R.overrideMimeType&&n.overrideMimeType&&n.overrideMimeType(R.overrideMimeType),n.send(x)},convertImageSrc:function(t,h){h&&"function"==typeof h||(h=function(){}),h(t)}});var Uc=v.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};zc("Request",I,{_responseType:null,_overrideMimeType:"text/plain",send:function($){var F=this._xhr,Z=this.onload,o=this.onerror;this.getResponseType()?$.responseType=this.getResponseType():this.getOverrideMimeType()&&($.overrideMimeType=this.getOverrideMimeType()),F.onload=Z,F.onerror=o,C.fetch(F,$)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(N){this._responseType=N},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(d){this._overrideMimeType=d},getResponseText:function(){var R=this._xhr;return R.response||R.responseText}}),yg.GraphView=function(f){var o=this;o._24I={},o._34I=new Pb,o._25I={},o._56I={},o._view=pf(1,o),o._canvas=$f(o._view),o.dm(f?f:new Ln),this._coreInteractor=new nh(this),o.setEditable(!1),o.setScrollBarVisible(C.graphViewScrollBarVisible)},us("GraphView",I,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Sj,ne,Fi,So,"resettable","editInteractor",ur,"zoomable","pannable","rectSelectable","autoScrollZone",hj,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:C.graphViewZoomable,_resettable:C.graphViewResettable,_pannable:C.graphViewPannable,_rectSelectable:C.graphViewRectSelectable,_autoScrollZone:C.graphViewAutoScrollZone,_rectSelectBackground:C.graphViewRectSelectBackground,_rectSelectBorderColor:C.graphViewRectSelectBorderColor,_editPointSize:C.graphViewEditPointSize,_editPointBorderColor:C.graphViewEditPointBorderColor,_editPointBackground:C.graphViewEditPointBackground,_scrollBarColor:ui,_scrollBarSize:sp,_autoHideScrollBar:se,_autoMakeVisible:ac,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(z){this._dataModel.setLayers(z)},setEditable:function(e){var T=this,g=T.__interactorMap__;if(!g){var d=yg.XEditInteractor;g=T.__interactorMap__={scrollBar:new Qh(T),select:new Tm(T),edit:d?new d(T):new tb(T),text:new Ci(T),move:new ok(T),"default":new Il(T),touch:new ik(T,{editable:!1})}}e?(T._uieditable=!0,T.setInteractors([g.scrollBar,g.select,g.edit,g.text,g.move,g.default,g.touch])):(T._uieditable=!1,T.setInteractors([g.scrollBar,g.select,g.move,g.default,g.touch]))},getCanvas:function(){return this._canvas},_33I:function(f){var G=f.getUIClass();return G?new G(this,f):w},getDataUI:function(p){var v=this,A=v._25I[p._id];return A===i&&(A=v._33I(p),v._25I[p._id]=A),A},getNodeRect:function(z){return C.getNodeRect(this,z)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(U){var Z=this.getDataUI(U);return Z?(Z._79o(),Z._78o):null},getEdgeSourcePosition:function(I){var E=this,W=E.getDataUI(I),N=W.s,s=W._data._40I;return Zr(E,s,N("edge.source.position"),N("edge.source.offset.x"),N("edge.source.offset.y"),N("edge.source.anchor.x"),N("edge.source.anchor.y"))},getEdgeTargetPosition:function(P){var s=this,v=s.getDataUI(P),A=v.s,V=v._data._41I;return Zr(s,V,A("edge.target.position"),A("edge.target.offset.x"),A("edge.target.offset.y"),A("edge.target.anchor.x"),A("edge.target.anchor.y"))},invalidateAll:function(H){var w=this;if(H){for(var x in w._25I){var c=w._25I[x];c&&c.dispose()}w._25I={},w._56I={},w._24I={},w._34I.clear(),w.redraw()}else w.dm().each(function(O){w.invalidateData(O)})},invalidateSelection:function(){var X=this;X.sm().each(function(q){X.invalidateData(q)})},invalidateData:function(j){var s=this;s._24I[j._id]=j,s._21Q(j),s.iv()},_21Q:function(i){var e=this,s=e._24I;if(kn(i)&&ud[i.s(tp)]){var t=i.getSourceAgent();t&&t.getAgentEdges().each(function(J){s[J._id]=J}),t=i.getTargetAgent(),t&&t.getAgentEdges().each(function(c){s[c._id]=c}),e.iv()}},redraw:function(f){var C=this;C._32I||(f?C._34I.add(f):(C._32I=1,C._34I.clear()),C.iv())},each:function(l,v){var I,C,n,N=0,k=this.getLayers(),W=this._dataModel,U=W._datas._as,M=U.length;if(k){for(var P=k.length;P>N;N++)if(n=k[N],as(n)&&(n=n.name),W.isHierarchicalRendering()){var f=function(C){return C._layer===n?v?l.call(v,C):l(C):void 0};if(this._dataModel.eachByHierarchical(f)===!1)return}else for(var K=0;M>K;K++)if(I=U[K],I._layer===n&&(C=v?l.call(v,I):l(I),C===!1))return}else if(W.isHierarchicalRendering())this._dataModel.eachByHierarchical(l,null,v);else for(;M>N;N++)if(I=U[N],C=v?l.call(v,I):l(I),C===!1)return},reverseEach:function(i,s){var w,m,g,z,O=this._dataModel,X=O._layers,k=O._datas._as,F=k.length;if(X){for(w=X.length-1;w>=0;w--)if(z=X[w],as(z)&&(z=z.name),O.isHierarchicalRendering()){var I=function(L){return L._layer===z?s?i.call(s,L):i(L):void 0};if(O.reverseEachByHierarchical(I)===!1)return}else for(var W=F-1;W>=0;W--)if(m=k[W],m._layer===z&&(g=s?i.call(s,m):i(m),g===!1))return}else if(O.isHierarchicalRendering())O.reverseEachByHierarchical(i,null,s);else for(w=F-1;w>=0;w--)if(m=k[w],g=s?i.call(s,m):i(m),g===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var g=this,C=g._84I;if(!C){var d=this.dm().a("width"),B=this.dm().a("height");d>0&&B>0?g._84I={x:0,y:0,width:d,height:B}:(g.each(function(v){g.isVisible(v)&&(C=fj(C,g.getDataUIBounds(v)))}),g._84I=C?C:Be)}return g._84I},getScrollRect:function(){return fj(this.getContentRect(),this._29I)},makeCenter:function(c,$,u){var k=this;if(!k.getWidth()||!k.getHeight())return u||Ao(k.makeCenter,k,[c,$,!0],500),void 0;k.makeVisible(c),k.validate();var Z=k.getDataUIBounds(c);if(Z){var t=k.getWidth(),J=k.getHeight(),e=Z.x+Z.width/2,V=Z.y+Z.height/2,z=-e*k._zoom+t/2,Q=-V*k._zoom+J/2;k.setTranslate(z,Q,$)}},fitData:function($,e,K,X,T){var o=this;if(!o.getWidth()||!o.getHeight())return T||Ao(o.fitData,o,[$,e,K,X,!0],500),void 0;var m=function(){o.makeVisible($),o.validate();var L=o.getDataUIBounds($);L&&(L=Tk(L),Cc(L,K==w?20:K),o.fitRect(L,e,X))};e?C.callWhenLoaded(m):m()},fitContent:function(i,d,h,q){var x=this;if(!x.getWidth()||!x.getHeight())return q||Ao(x.fitContent,x,[i,d,h,!0],500),void 0;var j=function(){x.validate();var L=Tk(x.getContentRect());Cc(L,d==w?20:d),x.fitRect(L,i,h)};i?C.callWhenLoaded(j):j()},fitRect:function(P,L,i){var v=this,j=v.getWidth(),o=v.getHeight(),t=P.x+P.width/2,m=P.y+P.height/2,g=V(j/P.width,o/P.height),B=v._zoom,M=-t*B+j/2,H=-m*B+o/2;0===g||isNaN(g)||(i&&(g=V(1,g)),L?(v._65I&&(delete v._65I.finishFunc,v._65I.stop(!0)),v._14o&&v._14o.stop(!0),v.setTranslate(M,H,{finishFunc:function(){v.setZoom(g,L)}})):(v.setTranslate(M,H),v.setZoom(g)))},toCanvas:function(U,d){d=d||this._zoom,this.validateImpl();var R=this,n=R.getContentRect();n.width||(n.width=10),n.height||(n.height=10);var m=$f(),s=n.x*d,P=n.y*d,X=n.width*d,h=n.height*d;vf(m,X,h,1);var W=Xl(m);return U=U||this._dataModel.getBackground(),U&&sc(W,0,0,X,h,U),_k(W,-s,-P),W.scale(d,d),R._42(W),W.restore(),m},toDataURL:function(d,D,V){return this.toCanvas(d,V).toDataURL(D||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(g,z){var I=this,r=I.dm().getBackground();if(r){var b=I.dm().a("width"),w=I.dm().a("height");b>0&&w>0&&sc(g,0,0,b,w,r)}var A=I.__htmlOrderList,m=[];if(I._93db(g,z),I.each(function(U){var C=I.getDataUI(U);if(C){var Q=I._56I[U._id],c=C._htmlView;if(Q){var R=C._79o();if(c=C._htmlView,v.HtmlNode&&U instanceof v.HtmlNode)C._42(g);else{var K=I.getViewRect(),_=c&&c.layoutHTML;!z||qn(z,R)?(_&&(c.layoutHTML(),C.__outerLayout&&delete C.__outerLayout),C._42(g)):qn(K,R)||!_||C.__outerLayout||(c.layoutHTML(),C.__outerLayout=!0)}}c&&(m.push(c),c.getView&&(c=c.getView()),c.style.display=Q?"block":Dp)}}),A&&m.length>0){var u=!1;if(A.length!==m.length)u=!0;else for(var t=0;t<m.length;t++)if(m[t]!==A[t]){u=!0;break}u&&(m.forEach(function(N){N.autoAdjustIndex!==!1&&I.appendHTML(N,!0)}),this.__htmlOrderList=m)}else this.__htmlOrderList=m;I._92db(g,z)},validateImpl:function(){this.tryUpdateRootData();var g,T,w,S,z,Q=this,L=Q.tx(),F=Q.ty(),m=Q._zoom,t=Q._canvas,U=this.getWidth(),h=this.getHeight(),l=Q._29I,J={x:-L/m,y:-F/m,width:U/m,height:h/m},I={},y=Q._34I,v=Q._24I,V=Q._32I,P=Q._23I;Q._24I={},(U!==t.clientWidth||h!==t.clientHeight)&&(vf(t,U,h),V=1),V||bo(J,l)||(V=1),Q._29I=J,Q.each(function(C){T=C._id;var u=I[T]=Q.isVisible(C);u!==Q._56I[T]&&(v[T]=C,w=Q.getDataUI(v[T]),w&&w._84o(u),Q._84o(C,u))},Q);for(T in v)w=Q.getDataUI(v[T]),w&&(!V&&Q._56I[T]&&(z=w._79o(),z&&y.add(z)),w.invalidate()),Q._83I=1;if(Q._56I=I,!V)for(T in v)I[T]&&(w=Q.getDataUI(v[T]),w&&(z=w._79o(),z&&y.add(z)));if(V?S=J:(y.each(function(F){qn(J,F)&&(S=fj(S,F))}),S&&(Cc(S,H(1,1/m)),S.x=p(S.x*m)/m,S.y=p(S.y*m)/m,S.width=R(S.width*m)/m,S.height=R(S.height*m)/m,S=lj(J,S))),Q._74O=S,S){g=Xl(t);var q=S.x,_=S.y,c=S.width,G=S.height;q=Math.floor((q*m+L)*re),_=Math.floor((_*m+F)*re),c=Math.ceil(c*m*re)+1,G=Math.ceil(G*m*re)+1,V||(S.x=(q/re-L)/m,S.y=(_/re-F)/m,S.width=c/re/m,S.height=G/re/m),g.beginPath(),g.rect(q,_,c,G),g.clip(),g.clearRect(q,_,c,G),Md(g,L,F,m),Q._42(g,S),g.restore(),delete Q._74O}if(y.clear(),delete Q._32I,P&&U>0&&h>0){var w=Q.getDataUI(P);if(w){var z=w._79o(),d=Q._29I,N=d.x,K=d.y,u=d.width,k=d.height,m=Q._zoom;z&&!qn(z,d)&&(z.x+z.width<N&&Q.tx(-z.x*m),z.x>N+u&&Q.tx(-(z.x+z.width-u)*m),z.y+z.height<K&&Q.ty(-z.y*m),z.y>K+k&&Q.ty(-(z.y+z.height-k)*m))}delete Q._23I}Q._83I&&(delete Q._83I,delete Q._84I),Q._98O(),Q.countFrame(),si(Q._24I)||Ao(Q.iv,Q)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var z,D=this.getFullscreenDatas();for(var L in D)z=D[L],this.scaleRootData(z);this._rootDataUpdating=!1}},scaleRootData:function(g){var X=g.s("fullscreen");if("uniform"===X||"fill"===X){g.getRotation()&&g.setRotation(0);var E=g.s("fullscreen.gap")||0,F=this.getWidth(),K=this.getHeight();if(F&&K){var i,N,n,e=F-2*E,A=K-2*E,q=g.getAnchor(),t=g.getScaledSize(),C=t.width,c=t.height,d=g.s("fullscreen.lock");if(d)return"uniform"===X?e/A>C/c?(i=A/c,C=c*e/A):(i=e/C,c=C*A/e):"v"===d?(i=A/c,C=e/i,g.getWidth()!==C&&g.setWidth(C)):(i=e/C,c=A/i,g.getHeight()!==c&&g.setHeight(c)),this.setZoom(i),N=E-(g.getX()-q.x*C)*i,n=E-(g.getY()-q.y*c)*i,N!==this.tx()&&this.tx(N),n!==this.ty()&&this.ty(n),void 0;N=this.tx(),n=this.ty(),i=this._zoom;var v={x:(-N+E)/i,y:(-n+E)/i,width:e/i,height:A/i};if("uniform"===X){var z=C/c,b=Math.min(v.width,v.height*z),M=b/z;v.x+=.5*(v.width-b),v.y+=.5*(v.height-M),v.width=b,v.height=M}e=v.width/g.getScaleX(),A=v.height/g.getScaleY(),(g.getWidth()!=e||g.getHeight()!==A)&&g.setSize(e,A);var $=v.x+q.x*v.width,s=v.y+q.y*v.height,L=g.getPosition();($!==L.x||s!==L.y)&&g.setPosition($,s)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(C){var G=this;C!==G.isScrollBarVisible()&&(C?(Pj(G._view,G._79O=xl()),Pj(G._79O,G._27I=xl()),Pj(G._79O,G._28I=xl())):(ck(G._79O),delete G._79O,delete G._27I,delete G._28I),G.fp("scrollBarVisible",!C,C))},getDebugTip:function(){return""},showScrollBar:function(){var X=this;X._79O&&(X._85I||(_(function(){X._86I()},vd),X.iv()),X._85I=new Date)},_86I:function(){var R=this;if(R._85I){var c=new Date,L=c.getTime();L-R._85I.getTime()>=vd?(delete R._85I,R.iv()):_(function(){R._86I()},vd)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var K=this,v=this._27I,S=this._28I;if(K._79O){if(K._autoHideScrollBar&&!K._85I)return v.style.visibility=kl,S.style.visibility=kl,void 0;var Y=K.getScrollBarColor(),N=K._zoom,F=K.getScrollBarSize(),b=K.getViewRect(),h=K.getScrollRect(),V=b.height*N,z=h.height*N,R=b.width*N-F-2,x=V*((b.y-h.y)*N/z),C=V*(V/z),H=v.style;z-.5>V?(Jh>C&&(x=x+C/2-Jh/2,0>x&&(x=0),x+Jh>V&&(x=V-Jh),C=Jh),Wp(v,R,x,F,C),H.visibility=bi,H.background=Y,H.borderRadius=F/2+Ih):H.visibility=kl;var j=b.width*N,w=h.width*N,x=b.height*N-F-2,R=j*((b.x-h.x)*N/w),$=j*(j/w),H=S.style;w-.5>j?(Jh>$&&(R=R+$/2-Jh/2,0>R&&(R=0),R+Jh>j&&(R=j-Jh),$=Jh),Wp(S,R,x,$,F),H.visibility=bi,H.background=Y,H.borderRadius=F/2+Ih):H.visibility=kl}},setDataModel:function(r){var W=this,R=W._dataModel,a=W._selectionModel;R!==r&&(R&&(R.ump(W.handleDataModelPropertyChange,W),R.umm(W.handleDataModelChange,W),R.umd(W.handleDataPropertyChange,W),R.removeIndexChangeListener(W._75O,W),R.removeHierarchyChangeListener(W.handleHierarchyChange,W),a||R.sm().ums(W.handleSelectionChange,W)),W._dataModel=r,r.mp(W.handleDataModelPropertyChange,W),r.mm(W.handleDataModelChange,W),r.md(W.handleDataPropertyChange,W),r.addIndexChangeListener(W._75O,W),r.addHierarchyChangeListener(W.handleHierarchyChange,W),a?a._21I(r):r.sm().ms(W.handleSelectionChange,W),W.invalidateAll(!0),W.fp(sj,R,r),W.updateBackground())},getLayersInfo:function(){if(this._layersInfo===i){var m=this.getLayers();m?(this._layersInfo={},m.forEach(function(y){var E=as(y)?y.name:y;this._layersInfo[E]=y},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(U,J,K){var e,O,r=this,I=r.getDataUI(U),X=Cn(I),B=nk(J,function(m){return Lm(X,100*m)},100,.001),_=Lm(X,100*B);if(!K){var g=Yf(I),S=new fd(_.x,_.y),A=49/(r._zoom*r._zoom);for(e=0,O=g.length;O>e;e++)if(S.distanceToSquared(g[e])<A)return{index:e,point:g[e],distance:Math.sqrt((g[e].x-J.x)*(g[e].x-J.x)+(g[e].y-J.y)*(g[e].y-J.y))}}return{percent:B,point:_,distance:Math.sqrt((_.x-J.x)*(_.x-J.x)+(_.y-J.y)*(_.y-J.y))}},calculateAttachPoint:function(){var J=new fd,g=new fd,B=new fd;return function(j,T){var f=this.getAttachPoints(j);if(!f||!f.length)return null;B.set(T.x,T.y);for(var i,c,d,U,k=1/0,O=0,y=f.length;y>O;O++)d=f[O],g.x=d.x,g.y=d.y,J.x=d.offsetX||0,J.y=d.offsetY||0,U=Zr(this,j,0,J.x,J.y,g.x,g.y),c=B.distanceToSquared(U),k>c&&(i=O,k=c);k=Math.sqrt(k);var a=this.getAttachStyle(j);if("close"===a){var w=j.s("attach.close.threshold")/this._zoom;if(k>w)return null}return{index:i,distance:k,info:f[i]}}}(),getAttachPoints:function($){var y=$.s("attach.points");if(y)return y;var f=Mf($._image);return f?mo(f.attachPoints,$,this)||null:void 0},getAttachStyle:function(i){var e=i.s("attach.style");if(e)return e;var O=Mf(i._image);return O?mo(O.attachStyle,i,this)||"close":void 0},updateLayers:function(){this._layersInfo=i,this.invalidateSelection(),this.redraw()},updateBackground:function(){var e=this.dm().a("width"),g=this.dm().a("height");this._canvas.style.background=e>0&&g>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(g){if("background"===g.property){var Y=this._canvas.style.background,O=g.newValue||"";this.updateBackground(),this.fp("canvasBackground",Y,O),this.redraw()}else"a:width"===g.property||"a:height"===g.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===g.property?this.updateLayers():"hierarchicalRendering"===g.property&&this.redraw()},handleDataPropertyChange:function(e){this.dm().isHierarchicalRendering()&&"parent"===e.property&&e.data.hasChildren()&&this.redraw(),this.invalidateData(e.data)
},onPropertyChanged:function(m){var K=this,n=m.property;if(K.redraw(),"zoom"===n){var $=K.sm().getSelection();$.size()&&$.each(function(U){U.invalidate()})}else"dataModel"===n&&(K._83I=1);Uh[n]?K.showScrollBar():n===ur&&K.onCurrentSubGraphChanged(m)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(m){var G=this,K=m.kind,R=m.data;if(G._83I=1,"add"===K)G.invalidateData(R),kn(R)&&R.getEdgeGroup()&&R.getEdgeGroup().eachSiblingEdge(G.invalidateData,G);else if(K===rh){G._21Q(R);var V=R._id,O=G._25I[V];if(O){if(G._56I[V]){var f=O._79o();f&&G.redraw(f)}O.dispose(),delete G._25I[V],delete G._24I[V],delete G._56I[V]}R===G._currentSubGraph&&G.setCurrentSubGraph(w)}else K===yc&&(G.invalidateAll(!0),G.setCurrentSubGraph(w))},_75O:function(y){this.invalidateData(y.data)},handleHierarchyChange:function(T){this.dm().isHierarchicalRendering()&&T.data.hasChildren()&&this.redraw(),this.invalidateData(T.data)},adjustIndex:function(P){var Z=this;if(Z.isVisible(P)){Z.dm().beginTransaction();for(var h=P;h._parent&&Z.isVisible(h._parent);)h=h._parent;h&&h!==P&&Z._dataModel.adjustIndex(h),Z._dataModel.adjustIndex(P),Z.dm().endTransaction()}},getImage:function(B){return B.getImage?B.getImage():i},getSelectWidth:function(A){var O=Mf(this.getImage(A));return O&&mo(O.disableSelectedBorder,A,this)?0:A.s("select.width")},getSelectColor:function(R){return R.s("select.color")},isSelectable:function(e,r){if(this.isSelected(e))return!0;if(!r&&e.getParent()instanceof jl&&this.isSelectable(e.getParent(),!0)&&e.getParent().isSyncSize())return!1;var A=this.getLayersInfo();if(A){var B=A[e._layer];if(B&&B.selectable===!1)return!1}return e.s("2d.selectable")&&this.sm().isSelectable(e)},isMovable:function(X){var g=this;if(kn(X)&&X.getStyle(tp)!==qc)return!1;var j=this.getLayersInfo();if(j){var z=j[X._layer];if(z&&z.movable===!1)return!1}return X.s("2d.movable")?g._movableFunc?g._movableFunc(X):!0:!1},isEditable:function(j){var I=this;if(v._uiSerializing)return I._uieditable;if(!I._editInteractor||!I.isSelected(j))return!1;if(Xh(j)){var Z=I.getDataUI(j);if(!Z||Z._88I)return!1}if(kn(j)&&j.getStyle(tp)!==qc)return!1;var p=this.getLayersInfo();if(p){var H=p[j._layer];if(H&&H.editable===!1)return!1}return j.s("2d.editable")?I._editableFunc?I._editableFunc(j):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function($){return gr($)&&0!==$.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc($):!0},isRectEditable:function(a){return this._rectEditableFunc?this._rectEditableFunc(a):!0},isAnchorEditable:function(U){return this._anchorEditableFunc?this._anchorEditableFunc(U):!0},isRotationEditable:function(R){return R.setRotation&&R.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(R):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(q){var e=q.getAnchor(),p=q.getScale(),r=this._zoom,G=zs(q.getRotation(),0,-q.getHeight()*p.y*e.y-(p.y<0?-1:1)*(ij?32:16)/r),x=q.p();return G.x+=x.x,G.y+=x.y,G},getLogicalPoint:function(Q){var O=this;return ii(Q,O._canvas,O.tx(),O.ty(),O._zoom,O._zoom)},getScreenPoint:function(z,V){var R,k=this;return"object"==typeof z?z.x!==i?(R=z.x,V=z.y):(R=z[0],V=z[1]):R=z,ss(R,V,k._canvas,k.tx(),k.ty(),k._zoom,k._zoom)},getSelectedDataAt:function(I){var n=this;return this.getDataAt(I,function(w){return n.isSelected(w)})},getDataInfoAt:function(p,o,h){var L,V=this.lp(p),T=this.getDataAt(V,o,h);if(T){var J=this.getDataUI(T);L={data:T,ui:J,point:V};var k=J._38o;if(k){var D=k.icons;for(var Z in D){var Y=D[Z],x=k.rects[Z];if(x)for(var E=mo(Y.names,T,this),n=E?E.length:0,e=x.rotation,A=n-1;A>=0;A--){var F=E[A],u=x[A];if(gg(u,V,e))return L.part="icons",L.name=Z,L.icon=F,L.rect=u,L.index=A,L.rotation=e,L}}}if(this.isNoteVisible(T)){if(J.note2Info&&gg(J.note2Info.clickRect,V,w,J.note2Info.scale))return L.part="note2",L;if(J.noteInfo&&gg(J.noteInfo.clickRect,V,w,J.noteInfo.scale))return L.part="note",L}if(this.isLabelVisible(T)){if(J.label2Info&&gg(J.label2Info.rect,V,J.label2Info.rotation,J.label2Info.scale))return L.part="label2",L;if(J.labelInfo&&gg(J.labelInfo.rect,V,J.labelInfo.rotation,J.labelInfo.scale))return L.part="label",L}if(T.isInRect&&T.isInRect(V))return L.part="body",L}return L},getDataAt:function(p,C,Z){p.target&&(p=this.lp(p));var j,L=this._zoom;return this.reverseEach(function(I){return(C?C(I):this.isSelectable(I))&&this.rectIntersects(I,Eb(p.x,p.y,Z,L))?(j=I,!1):void 0},this),j},getIconInfoAt:function(Z,B){var X=this;if(Z.target&&(Z=X.lp(Z)),B||(B=X.getDataAt(Z)),B){var h=X.getDataUI(B);if(h&&h._38o){var N,G=h._38o,s=new Pb;for(N in G.icons)s.add(N);for(var r=s.size()-1;r>=0;r--){N=s.get(r);for(var v=G.rects[N],x=v.rotation,R=v.length-1;R>=0;R--){var H=v[R],$=H.width,A=H.height,g={x:Z.x-H.x-$/2,y:Z.y-H.y-A/2};x!=w&&(g=zs(-x,g.x,g.y));var H={x:-$/2,y:-A/2,width:$,height:A};if(gg(H,g))return{key:N,index:R,name:G.icons[N].names[R],rect:v[R],point:Z,rotation:x,relativeRect:H,relativePoint:g,data:B}}}}}return w},getDatasInRect:function(X,C,j){j===i&&(j=1);var R=this,$=new Pb;return R.reverseEach(function(M){j&&!R.isSelectable(M)||(C?R.rectIntersects(M,X):R.rectContains(M,X))&&$.add(M)}),$},moveSelection:function(Y,c){var N=this;N.dm().beginTransaction(),bf(N.sm().toSelection(N.isMovable,N),Y,c),N.dm().endTransaction()},moveDatas:function(G,o,D){var W=this;W.dm().beginTransaction(),G instanceof Pb||(G=new Pb(G)),bf(G,o,D),W.dm().endTransaction()},getDataUIBounds:function(E){var L=this.getDataUI(E);return L?L._79o():w},drawData:function(Z,S,X){var o=this.getDataUI(S);if(o){var R=o._79o();(!X||qn(X,R))&&(o._42(Z),S instanceof v.Block&&S.eachChild(function(S){this.drawData(Z,S,X)},this))}},getBoundsForGroup:function(F){return F.s(Tf)?this.getDataUIBounds(F):w},isPixelPerfect:function(p){return p.s("pixelPerfect")},rectIntersects:function(b,H){this.validate();var W=w;if(this._56I[b._id]){var s=this._25I[b._id];if(s){var o=s._79o();if(mb(H,o))W=!0;else if((H=lj(H,o))&&(s.rectIntersects&&(W=s.rectIntersects(H)),W==w)){if(!this.isPixelPerfect(b))return!0;var D=H.x,O=H.y,N=H.width,v=H.height,c=this._zoom,U=C.hitMaxArea,M=N*v*c*c;if(M>U){var e=Math.sqrt(U/M);c*=e}N*=c,v*=c,2>N&&(N=2),2>v&&(v=2),D*=c,O*=c;var t=Qf(N,v);_k(t,-D,-O),t.scale(c,c),this._drawForChecking=!0,this.drawData(t,b,H),this._drawForChecking=!1;try{for(var p=0,z=t.getImageData(0,0,N,v).data;p<z.length;p+=4)if(0!==z[p+3]){W=!0;break}t.restore()}catch(R){ul=w,W=!1}}}}return W?!0:!1},rectContains:function(l,O){if(this._56I[l._id]){var I=this._25I[l._id];if(I)return mb(O,I._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(t){if(!C.isInput(t.target)){var h=this,S=h._focusData,n=S&&h._25I[S._id],y=0,d=h._dataModel._datas;if(!(S&&S._enabled&&S._editable&&n&&n.onKeyDown&&n.onKeyDown(t)===!0))if(9===t.keyCode&&(S&&(y=d.indexOf(S),Hh(t)?-1===--y&&(y=0):++y===d.size()&&(y=0)),h._focusData=S=d.get(y),h.sm().setSelection(S)),Bn(t)?h.selectAll():Dj(t)&&h.isResettable()&&h.reset(),h.sm().isEmpty()){if(h._editing)return;var L=h.tx(),U=h.ty(),W=!1,H=Hh()?100:10;tg(t)&&(L-=H,W=!0),Oo(t)&&(U-=H,W=!0),od(t)&&(L+=H,W=!0),jn(t)&&(U+=H,W=!0),W&&h.setTranslate(L,U)}else{Po(t)&&h.handleDelete(t);var $=Hh()?10:1;tg(t)&&(h.moveSelection(-$,0),h.fi({kind:"moveLeft"})),Oo(t)&&(h.moveSelection(0,-$),h.fi({kind:"moveUp"})),od(t)&&(h.moveSelection($,0),h.fi({kind:"moveRight"})),jn(t)&&(h.moveSelection(0,$),h.fi({kind:"moveDown"}))}}},handleScroll:function(v,P){if(jm(v),this.isZoomable()){if(!this.getEditInteractor()){var x=this.getDataAt(v);if(x){var T=Mf(this.getImage(x));if(T&&mo(T.scrollable,x,this))return}}var k=this.lp(v);P>0?this.scrollZoomIn(k):0>P&&this.scrollZoomOut(k)}},handlePinch:function(j,Z,k){this.isZoomable()&&(Z>k?this.pinchZoomIn(j):this.pinchZoomOut(j))},checkDoubleClickOnNote:function(R,P){var d=this,f=d.lp(R),I=d.getDataUI(P),l=I.note2Info;return l&&P.s("note2.toggleable")&&gg(l.clickRect,f)?(P.s(vq,!P.s(vq)),d.fi({kind:"toggleNote2",event:R,data:P}),!0):(l=I.noteInfo,l&&P.s("note.toggleable")&&gg(l.clickRect,f)?(P.s(Tc,!P.s(Tc)),d.fi({kind:"toggleNote",event:R,data:P}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Q,p){var E=this,v=E.getAutoScrollZone(),D=v/E.getZoom(),S=v/4,T=E._29I,s=E.lp(Q),d={x:E.tx(),y:E.ty()};return s&&v>0&&T&&(s.x-T.x<D?E.translate(S,0):T.x+T.width-s.x<D&&E.translate(-S,0),s.y-T.y<D?E.translate(0,S):T.y+T.height-s.y<D&&E.translate(0,-S)),d.x=E.tx()-d.x,d.y=E.ty()-d.y,p&&(p.x+=d.x,p.y+=d.y),d},getMoveMode:function(Z,E){var w=E.s("2d.move.mode");return w?w:dj["88"]?"x":dj["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(Z,W,t){var L=this;return"currentSubGraph"===W?{__i:Z.getId()}:t.serializeProperty(Z,W,L)},deserializeProperty:function(V,h,J){var U=this;if("currentSubGraph"===h){var $=U.dm(),j=$.__idMap;return j[V.__i]}return J.deserializeProperty(V,h,U)},setDefaultCursor:function(y,C){this._defaultCursor=y,C!==!1&&this.setCursor(y)},setCursor:function(b){"default"===b&&(b=this._defaultCursor||b);var G=this.getView().style;G.cursor=b,G.cursor="-webkit-"+b,G.cursor="-moz-"+b},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(T){return T===w||C.getConnectAction(null,T)?(this._currentActionType=T,this.redraw(),!0):!1},getEditStyle:function(y){var K=this.getEditInteractor();return K?K.getStyle(y):i},setEditStyle:function(B,k,v){var E=this.getEditInteractor();return E?(E.setStyle(B,k,v),!0):!1},isConnectActionVisible:function(T){var Z=C.getConnectAction(this);if(!Z)return!1;var f=Z.visible;return Ad(f)&&(f=f(this,T)),f},isInteractive:function(x){var m=Mf(this.getImage(x));return m&&mo(m.interactive,x,this)?!0:x.s("interactive")},appendHTML:function(f,j){var R=this.getView();if(!(j||f&&f.parentNode!==R))return!1;var m=f.getView&&f.getView();if(!j&&m&&m.parentNode===R)return!1;(f.getView||f.isSelfViewEvent)&&(f=f.getView());var S=this.getEditInteractor();return S&&S._canvas?R.insertBefore(f,S._canvas):this.isScrollBarVisible()?R.insertBefore(f,this.getView().lastChild):Pj(R,f),!0},_layoutHTMLImpl:function(d,W,B){if(arguments.length>1){var s,f=this,$=f._zoom;if(W.getView&&(s=W,W=W.getView()),W.style.position="absolute",B){var C=d.getRect();Wp(s||W,f.tx()+C.x*$,f.ty()+C.y*$,C.width*$,C.height*$)}else{var J=new Ok,C=d.getAnchorRect(),P=d.getPosition(),A=d.getScale(),k=W.style;Wp(s||W,C),J.appendTranslate(f.tx(),f.ty()),J.appendScale($,$),J.append(new Ok(d.getRotation(),P.x,P.y,A.x,A.y)),$q(k,"transform","matrix("+J.a.toFixed(5)+", "+J.b.toFixed(5)+", "+J.c.toFixed(5)+",\n    "+J.d.toFixed(5)+", "+J.tx.toFixed(5)+", "+J.ty.toFixed(5)+")"),$q(k,"transformOrigin",(-C.x).toFixed(5)+"px "+(-C.y).toFixed(5)+"px"),W.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(y){return y instanceof lk?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(i){var N="state",_=i.s(N);if(_)return _;var t=Mf(i._image);return t?mo(t[N],i,this)||null:void 0}}),I.defineProperties(yg.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(k){this._layoutHTML=k}}});var vl=function(m,M){var Z=this;Z.gv=m,Z.s=function(_){return M.getStyle(_)},Z._data=M,Z._87I=new Pb};vo(vl,I,{_6I:w,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var G=this,H=G.gv.isSelected(G._data);return!H||G.isShadowed()?0:G.gv.getSelectWidth(G._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(z){var h=this._data,d=this.gv.getBodyColor(h);return d?d:z?h.getStyle(z):w},_2Q:function(Q){return this.s(Q)},_1Q:function(i,U,M,u){var h=this.s,$=h("2d.gray"),c=h(U+".dash.color");if($&&(c=C.toGrayColor(c)),i.strokeStyle=c,i.lineWidth=M,i.stroke(),h(U+".dash.3d")){var d=h(U+".dash.3d.color");vr(i,c,$?C.toGrayColor(d):d,M,this.gv._zoom,h(U+".dash.3d.accuracy"))}sd(i,u)},invalidate:function(){this._6I=w},_79o:function(){var G=this;if(!G._6I){var t=G._data,x=G.gv;G.labelInfo=G.label2Info=G.noteInfo=G.note2Info=G._38o=w,G._87I.clear(),G.interactiveInfo=x.isInteractive(t)?{}:w,G._3O(),G._55O=x.isEditable(t)?{_42O:x.isRectEditable(t),_43O:x.isPointEditable(t),_56O:x.isRotationEditable(t)}:w,G._6I=G._81o()}return G._6I},_3O:function(){},getPosition:function(){return Be},_68o:function(b,C){b&&this._87I.add(Gi(b,C))},_81o:function(){var B=this,F=B.s;B._24O(Xf,"getLabel"),B._24O(Xp,"getLabel2"),B._26O(Mm,"getNote"),B._26O(Ie,"getNote2"),B._15O(),B._55O&&B._48O();var a;if(B._87I.each(function(o){a=fj(a,o)}),a&&B.isShadowed()){var Z=Tk(a);Z.x+=F("shadow.offset.x"),Z.y+=F("shadow.offset.y"),Cc(Z,F("shadow.blur")),a=fj(a,Z)}return B._87I.clear(),a},_42:function(A){var R=this,l=R._data,m=R.gv,B=R.s,_=B("opacity"),c=this.isShadowed();if(c){var F=A.shadowOffsetX,b=A.shadowOffsetY,p=A.shadowBlur,Q=A.shadowColor,e=m.getZoom();A.shadowOffsetX=B("shadow.offset.x")*e,A.shadowOffsetY=B("shadow.offset.y")*e,A.shadowBlur=B("shadow.blur")*e,A.shadowColor=R.getSelectColor()}if(_!=w){var i=A.globalAlpha;A.globalAlpha=_}R._80o(A),m.isLabelVisible(l)&&((!m._drawForChecking||B("label.selectable"))&&Wo(A,R.labelInfo),(!m._drawForChecking||B("label2.selectable"))&&Wo(A,R.label2Info)),m.isNoteVisible(l)&&(Xe(A,R.noteInfo),Xe(A,R.note2Info)),R._99O(A),_!=w&&(A.globalAlpha=i),c&&(A.shadowOffsetX=F,A.shadowOffsetY=b,A.shadowBlur=p,A.shadowColor=Q)},_80o:function(){},_47O:function(){},_24O:function(f,S){var l=this,c=l._data,N=l.gv,d=l.s,I=N[S](c);if(I!=w){var x=d(f+".scale"),G=d(f+".max"),k=d(f+".position"),D=l[f+"Info"]={label:I,scale:x,color:N[S+"Color"](c),font:d(f+".font"),opacity:d(f+".opacity"),align:d(f+".align"),rotation:l.getRotation(d(f+".rotation"),!1,k),background:N[S+"Background"](c)},b=Ng(D,I);G>0&&G<b.width&&(D.labelWidth=b.width,b.width=G),1!==x&&(b.width*=x,b.height*=x);var g=l.getPosition(k,d(f+".offset.x"),d(f+".offset.y"),b,d(f+".position.fixed"));if(b.x=g.x-b.width/2,b.y=g.y-b.height/2,l._68o(D.rect=b,D.rotation),1!==x){var O=b.width/x,X=b.height/x;D.rect={x:g.x-O/2,y:g.y-X/2,width:O,height:X}}}},_26O:function(e,B){var X=this,A=X.gv,q=X._data,g=X.s,o=A[B](q);if(o!=w){var S,E,v=g(e+".scale"),h=X[e+"Info"]={note:o,scale:v,data:q,view:A,expanded:g(e+".expanded"),font:g(e+".font"),color:g(e+".color"),opacity:g(e+".opacity"),align:g(e+".align"),icon:g(e+".icon"),backgroundImage:g(e+".backgroundImage"),borderWidth:g(e+".border.width"),borderColor:g(e+".border.color"),background:A[B+"Background"](q)},G=X.getPosition(g(e+".position"),g(e+".offset.x"),g(e+".offset.y")),f=G.x,L=G.y;if(h.expanded){var U,s=g(e+".max"),$=g(e+".backgroundImage");$?($=Mf($),U={width:Xk($,q),height:Dg($,q)}):U=Ng(h,o),U.width+=6,U.height+=2,s>0&&s<U.width&&(h.labelWidth=U.width,U.width=s),S=U.width,E=U.height+8,h.clickRect={x:f-S*v/2,y:L-E*v,width:S*v,height:E*v*U.height/E}}else{var D=g(e+".icon");D?(D=Mf(D),S=Xk(D,q),E=Dg(D,q)):(S=12,E=18),h.clickRect={x:f-S*v/2,y:L-E*v,width:S*v,height:E*v}}h.rect={x:f-S/2,y:L-E*v/2-E/2,width:S,height:E};var z=R(h.borderWidth/2)*v;X._68o({x:f-S*v/2-z,y:L-E*v-z,width:S*v+2*z,height:E*v+2*z})}},_48O:function(){},_99O:function(J){var S=this,q=S._38o;if(q){var A=S.gv,P=S._data,B=q.icons,u=S.interactiveInfo;u&&(u._38o={});for(var v in B){var K=B[v],k=q.rects[v];if(k){u&&(u._38o[v]=[]);var T=mo(K.opacity,P,A),$=mo(K.names,P,A),l=$?$.length:0,i=k.rotation;if(T!=w){var E=J.globalAlpha;J.globalAlpha*=T}for(var e=0;l>e;e++){var D=$[e],z=Mf(D),U=k[e];if(i){var n=U.x+U.width/2,I=U.y+U.height/2;J.save(),_k(J,n,I),uh(J,i),_k(J,-n,-I)}u&&u._38o[v].push(J.interactiveInfo={compInfos:[],matrix:i?new Ok(i,n,I).appendTranslate(-n,-I):new Ok}),nd(J,z,mo(K.stretch,P,A),U.x,U.y,U.width,U.height,S._data,S.gv),J.interactiveInfo=w,i&&J.restore()}T!=w&&(J.globalAlpha=E)}}}}});var dp=function(D,q){qj(dp,this,[D,q])};vo(dp,vl,{_checkEmptyRect:!0,_40O:function(j,t){var F=this,I=F.s,J=j.rect;(j.borderColor=F.gv.getBorderColor(F._data))&&(j.borderType=I("border.type"),j.borderWidth=I("border.width"),j.borderPadding=I("border.padding"),t=H(t,j.borderPadding+j.borderWidth/2));var d=F._data.getScale(),Z=H(1,H(l(d.x),l(d.y)));if(j.selectWidth=F.getSelectWidth()){var K=F.gv._zoom;j.selectType=I("select.type"),j._97o=F.getSelectColor(),j.selectPadding=I("select.padding"),t=H(t,(j.selectPadding+j.selectWidth/2/K)/Z)}t>0&&(t*=Z,J=Tk(J),Cc(J,t)),F._68o(J)},_39O:function(u,W){var L,y=this,J=W.rect;if(W.borderWidth>0&&(L=W.borderPadding,u.strokeStyle=W.borderColor,u.lineWidth=W.borderWidth,ld(u,W.borderType,{x:J.x-L,y:J.y-L,width:J.width+2*L,height:J.height+2*L}),u.stroke()),W.selectWidth>0){var z=y.gv._zoom;if(L=W.selectPadding,u.strokeStyle=W._97o,u.lineWidth=W.selectWidth/z,W.rotation!=w){u.save(),u.translate(W.position.x,W.position.y),u.rotate(W.rotation);var c=y._data,h=c.getWidth(),P=c.getHeight(),B=W.scale,T=W.anchor;J={x:B.x*-h*T.x,y:B.y*-P*T.y,width:B.x*h,height:B.y*P}}ld(u,W.selectType,{x:J.x-L,y:J.y-L,width:J.width+2*L,height:J.height+2*L}),W.rotation!=w&&u.restore(),u.stroke()}},dispose:function(){var G=this,w=G._htmlView;dp.superClass._3O.call(G),w&&(w.onHTMLRemoved&&w.onHTMLRemoved(),ck(w))},_3O:function(){var m=this,k=m.s,e=m._data,p=m.gv,i=e.getStyle(Mh),I=m.getBodyColor(),X=m._83o=i?{shape:i,_53o:m.getBodyColor("shape.background"),_27Q:Mf(k("shape.repeat.image"),I),shapeGradientPack:k("shape.gradient.pack"),_54o:k("shape.border.width"),_55o:k("shape.border.color"),_56o:k("shape.border.3d"),_57o:k("shape.border.3d.color"),_58o:k("shape.border.3d.accuracy"),shapeGradient:k("shape.gradient"),_59o:k("shape.gradient.color"),_60o:k("shape.border.pattern"),_61o:k("shape.border.cap"),_62o:k("shape.border.join"),shapeForeground:k("shape.foreground"),bodyColor:I,gray:k("2d.gray")}:{img:Mf(p.getImage(e),I),bodyColor:I,gray:k("2d.gray"),stretch:k("image.stretch")};if(r&&!D);else{var y,c=X.img;c&&c.renderHTML?(m._htmlInfo&&m._htmlInfo.img!==c&&(m._htmlInfo=w),m._htmlInfo||(m._htmlInfo={img:c,cache:{}}),y=c.renderHTML(e,p,m._htmlInfo.cache)):m._htmlInfo=w,m._htmlView&&m._htmlView!==y&&(m._htmlView.onHTMLRemoved&&m._htmlView.onHTMLRemoved(),ck(m._htmlView.getView?m._htmlView.getView():m._htmlView)),(m._htmlView=y)&&p.appendHTML(y)&&(y.onHTMLAddedSync&&y.onHTMLAddedSync(),y.onHTMLAdded&&Ao(y.onHTMLAdded)),X.rect=e.getRect(),X.position=e.p(),X.scale=e.getScale(),X.anchor=e.getAnchor(),X.rotation=e.getRotation(),i===Ph&&(X._63o=k("shape.depth"));var M=0;if(i)M=Ho(w,X._54o/2,X._62o),m.s("shape.dash")&&(M=H(M,(m.s("shape.dash.width")||X._54o)/2));else if(c&&c.boundExtend)if(M=mo(c.boundExtend,e,p),c.boundExtendAbsolute){var d=e.getScale();M/=p._zoom*H(1,H(l(d.x),l(d.y)))}else if(!mo(c.fitSize,e,p)){var u=mo(c.width,e,p),n=mo(c.height,e,p);M*=H(e.getWidth()/u,e.getHeight()/n)}m._40O(X,M);var b=k("clip.percentage");if(1>b&&(0>b&&(b=0),X.clipRect=ip(e.getAnchorRect(),k("clip.direction"),b)),i){var L=k("shape.fill.clip.percentage");1>L&&(0>L&&(L=0),X.shapeClipRect=ip(e.getAnchorRect(),k("shape.fill.clip.direction"),L));var V=k("shape.foreground.clip.percentage");1>V&&(0>V&&(V=0),X.shapeForegroundClipRect=ip(e.getAnchorRect(),k("shape.foreground.clip.direction"),V))}}},getPosition:function(l,x,J,b){var A=vb(l,this._83o.rect,b);return A.x+=x,A.y+=J,A},_80o:function(A){var q=this,x=q.s,Q=q.gv,O=q._data,u=q._83o,Y=u.rect,G=u.position,o=u.rotation,J=u.anchor,b=u.scale,I=u.shape,m=u.clipRect;if(!q._checkEmptyRect||Y.width>0&&Y.height>0){var v=O.getSize();if(v.x=-v.width*J.x,v.y=-v.height*J.y,A.save(),_k(A,G.x,G.y),uh(A,o),Gn(A,b.x,b.y),m&&(A.beginPath(),A.rect(m.x,m.y,m.width,m.height),A.clip()),Q._drawForChecking&&u.img&&mo(u.img.pixelPerfect,O,Q)===!1)sc(A,v.x,v.y,v.width,v.height,"#888888");else if(q.freeDraw)q.freeDraw(A,v,u);else if(I){var f,R,M,B,s=u._60o,h=jq(A,s),K=u._27Q,$=u._54o,F=u.shapeGradientPack,c=u.gray,y=A.lineJoin,e=A.lineCap,N=function(P){return c?C.toGrayColor(P):P};"roundRect"===I?f=x("shape.corner.radius"):"polygon"===I?f=x("shape.polygon.side"):"arc"===I&&(f=x("shape.arc.from"),R=x("shape.arc.to"),M=x("shape.arc.close"),B=x("shape.arc.oval")),A.lineJoin=u._62o,A.lineCap=u._61o;var S=N(u._53o);if(S||K||F){var L=u.shapeClipRect;L&&(A.save(),A.beginPath(),A.rect(L.x,L.y,L.width,L.height),A.clip()),ld(A,I,v,f,R,M,B),F?ts(A,F):K?bd(A,K,N(u.bodyColor),null,O,Q):_l(A,S,u.shapeGradient,N(u._59o),v),A.fill(),L&&A.restore(),F&&A.restore(),A!==h&&ld(h,I,v,f,R,M,B)}else ld(h,I,v,f,R,M,B);var W=u.shapeForeground;if(W){A.save();var d=u.shapeForegroundClipRect;d&&(A.beginPath(),A.rect(d.x,d.y,d.width,d.height),A.clip()),ld(A,I,v,f,R,M,B),_l(A,W,x("shape.foreground.gradient"),N(x("shape.foreground.gradient.color")),v),A.fill(),A.restore()}if($>0){var P=x("shape.border.width.absolute");P&&(A.save(),A.setTransform(1,0,0,1,0,0)),A.lineWidth=$;var t=N(u._55o);A.strokeStyle=t,A.stroke(),P&&A.restore(),u._56o&&vr(A,t,N(u._57o),$,Q._zoom,u._58o)}if(sd(A,s),x("shape.dash")){var E=x("shape.dash.width")||$;if(E>0){s=x("shape.dash.pattern");var h=jq(A,s,q._2Q("shape.dash.offset"));h!==A&&ld(h,I,v,f,R,M,B),q._1Q(A,"shape",E,s)}}Wn(A,S,u._63o,v),A.lineJoin=y,A.lineCap=e}else{var X=q.interactiveInfo;X&&(A.interactiveInfo=X.bodyInfo={compInfos:[],matrix:new Ok(o,G.x,G.y,b.x,b.y)}),u.gray&&(A.compGray=!0);var j=u.img;j&&j.cacheRule!=w&&(j=nf(A,j,u.stretch,v.width,v.height,O,Q,u.bodyColor)),nd(A,j,u.stretch,v.x,v.y,v.width,v.height,O,Q,u.bodyColor),A.compGray=!1,A.interactiveInfo=w}A.restore()}q._39O(A,u)},_48O:function(){},_47O:function(){}});var ge=function(K,a){qj(ge,this,[K,a])},Tp=function(K,i,T,u){var H=Sp(K,i);return T=u?V(T,H):wd(T,H),H?T/=H:T=0,{x:K.x+(i.x-K.x)*T,y:K.y+(i.y-K.y)*T}};vo(ge,vl,{_3O:function(){var f,O=this,W=O._data,A=O.gv,P=O.s,l=P(tp),p=W.isLooped(),G=P("edge.width"),D=P("edge.center"),V=P("edge.offset"),c=A.getBorderColor(W),Y=c?P("border.width"):0,e=O.getSelectWidth(),x=W._40I,R=W._41I,J=O._78o=x&&R?{looped:p,type:l,width:G,center:D,color:O.getBodyColor("edge.color"),borderColor:c,borderWidth:Y,_97o:e?O.getSelectColor():w,selectWidth:e,pattern:P("edge.pattern"),cap:P("edge.cap"),join:P("edge.join"),is3d:P("edge.3d"),_67o:P("edge.3d.color"),_66o:P("edge.3d.accuracy"),gray:P("2d.gray")}:w;if(J){var d=C.getEdgeType(l);if(d){var y=d(W,Fh(O,A,W,p,l),A,O._19Q);y.points&&y.points.size()>1?(J.edgeTypeInfo=y,f=ye(J.edgeTypeInfo.points)):y[me]&&y.rect&&(J.edgeTypeInfo=y,f=y.rect)}else{var g=P("edge.source.anchor.x"),b=P("edge.source.anchor.y"),m=P("edge.target.anchor.x"),t=P("edge.target.anchor.y"),N=Yk(A,W,"source"),I=Yk(A,W,"target");if(l===qc){var r=J.points=P(Gg)||Hk,u=r.size();J.segments=P("edge.segments");var M=g!==i||b!==i||kn(x),X=m!==i||t!==i||kn(R);if(!D)if(V)M||(N=Tp(N,u?r.get(0):I,V,u)),X||(I=Tp(I,u?r.get(u-1):N,V,u));else{var s;M||(s=Or(N,u?r.get(0):I,je(A,x)),s&&(N={x:s[0],y:s[1]})),X||(s=Or(u?r.get(u-1):N,I,je(A,R)),s&&(I={x:s[0],y:s[1]}))}f=fj(ye(J.points),ye(N,I))}else{var U=Fh(O,A,W,p,l);if(O._19Q||(U=-U),p)N=Tk(N),N.x=A.getNodeRect(x).x,J.radius=U,f={x:N.x-U,y:N.y-U,width:2*U,height:2*U};else{var F=Sp(N,I),o=wd(V,F),E={x:o,y:U},S={x:F-o,y:U},L=T(I.y-N.y,I.x-N.x),$=J.mat=new yk(L);if(J.orienAngle=L,J.angle=I.x<N.x?L+Q:L,J.rect={x:E.x,y:E.y,width:S.x-E.x,height:0},J.origin=N,E=$.tf(E),E.x+=N.x,E.y+=N.y,S=$.tf(S),S.x+=N.x,S.y+=N.y,D){var Z={x:F,y:0};Z=$.tf(Z),Z.x+=N.x,Z.y+=N.y,f=ye([N,E,S,Z]),J.c1=N,J.c2=Z}else f=ye(E,S);N=E,I=S}}J.sourcePoint=N,J.targetPoint=I,W._lastSourcePoint=N,W._lastTargetPoint=I}var q=0;P("edge.dash")&&(q=P("edge.dash.width")||G);var B="square"===J.cap?.71:.5;Ho(f,H(q*B,G*B+Y+e),J.join),O._68o(f)}},getRotation:function(u,j,i){u=u||0;var S=this._78o;if(S){var z,A=S.angle,E=S.points,k=S.edgeTypeInfo;if(A!=w)return j?S.orienAngle+u:A+u;if(k&&k[me])return k.getRotation?k.getRotation(this,u,j,i):0;if(k&&k.points){var b=k.points;return z=b.size(),Nl[i]?z&&0===z%2?Up(b.get(z/2-1),b.get(z/2),j,u):u:Cd[i]?Up(b.get(0),b.get(1),j,u):Up(b.get(z-2),b.get(z-1),j,u)}if(E)return z=E.size(),Nl[i]?z&&0===z%2?Up(E.get(z/2-1),E.get(z/2),j,u):u:Cd[i]?Up(S.sourcePoint,z?E.get(0):S.targetPoint,j,u):Up(z?E.get(z-1):S.sourcePoint,S.targetPoint,j,u)}return u},getPosition:function(w,R,u,H,s){var v=this._78o;if(v){var n,y=v.type,i=v.points,x=v.edgeTypeInfo,m=v.sourcePoint,W=v.targetPoint;if(!y)return v.looped?{x:m.x-v.radius+R,y:m.y+u}:(s&&m&&W&&(m.x>W.x||m.x===W.x&&m.y>W.y)&&(w=Rl[w],u=-u),n=vb(w,v.rect,H),n.x+=R,n.y+=u,n=v.mat.tf(n),n.x+=v.origin.x,n.y+=v.origin.y,n);if(x&&x[me])return x.getPosition?x.getPosition(this,w,R,u,H,s):{x:(m.x+W.x)/2,y:(m.y+W.y)/2};if(i){var n,o=i.size();if(Nl[w]){if(o){var P=o%2;if(0===P)return xd(i.get(o/2-1),i.get(o/2),w,R,u,H,s);n=i.get((o-P)/2)}else n={x:(m.x+W.x)/2,y:(m.y+W.y)/2};return n=vb(w,{x:n.x,y:n.y,width:0,height:0},H),n.x+=R,n.y+=u,n}return Cd[w]?xd(m,o?i.get(0):W,w,R,u,H,s):xd(o?i.get(o-1):m,W,w,R,u,H,s)}if(x){var J=x.points,o=J.size();if(Nl[w]){var P=o%2;return 0===P?xd(J.get(o/2-1),J.get(o/2),w,R,u,H,s):(n=J.get((o-P)/2),n=vb(w,{x:n.x,y:n.y,width:0,height:0},H),n.x+=R,n.y+=u,n)}return Cd[w]?xd(J.get(0),J.get(1),w,R,u,H,s):xd(J.get(o-2),J.get(o-1),w,R,u,H,s)}}return Be},_42:function(A){this._78o&&ge.superClass._42.call(this,A)},drawPath:function(q,B){q.beginPath();var t=B.type,u=B.points,Y=B.segments,r=B.edgeTypeInfo;if(!t||u){var R=B.sourcePoint,T=R.x,Q=R.y,V=B.targetPoint,i=V.x,_=V.y;if(t)if(Y){var n=new Pb({x:T,y:Q});n.addAll(u),n.add({x:i,y:_}),Vr(q,n,Y)}else q.moveTo(T,Q),u.each(function(X){q.lineTo(X.x,X.y)}),q.lineTo(i,_);else B.looped?q.arc(T,Q,B.radius,0,e,!0):B.center?(q.moveTo(B.c1.x,B.c1.y),q.lineTo(T,Q),q.lineTo(i,_),q.lineTo(B.c2.x,B.c2.y)):(q.moveTo(T,Q),q.lineTo(i,_))}else r&&(r.points?Vr(q,r.points,r.segments):r[me]&&r[me](q,r))},_80o:function(M){var k=this,Y=k.s,D=k._78o,d=D.width,w=D.selectWidth,R=D.borderWidth,L=M.lineJoin,o=M.lineCap,U=D.gray,f=D.pattern;M.lineJoin=D.join,M.lineCap=D.cap,k.drawPath(jq(M,f),D);var N=Y("edge.width.absolute");N&&(M.save(),M.setTransform(1,0,0,1,0,0)),w&&(M.strokeStyle=D._97o,M.lineWidth=d+2*(R+w),M.stroke()),R&&(M.strokeStyle=U?C.toGrayColor(D.borderColor):D.borderColor,M.lineWidth=d+2*R,M.stroke());var A=U?C.toGrayColor(D.color):D.color,y=U?C.toGrayColor(D._67o):D._67o;if(M.strokeStyle=A,M.lineWidth=d,M.stroke(),D.is3d&&vr(M,A,y,d,k.gv._zoom,D._66o),sd(M,f),Y("edge.dash")){f=Y("edge.dash.pattern");var $=jq(M,f,k._2Q("edge.dash.offset"));$!==M&&k.drawPath($,D),k._1Q(M,"edge",Y("edge.dash.width")||d,f)}N&&M.restore(),M.lineJoin=L,M.lineCap=o},_48O:function(){},_47O:function(){}});var Hg=function($,A){qj(Hg,this,[$,A])};vo(Hg,dp,{_3O:function(){var r,v,U=this,R=U.s,H=U._data,f=U.gv;if(U._88I=w,H.isExpanded()&&H.eachChild(function(V){if(gr(V)){var x=f.getBoundsForGroup(V);x&&(v||(v=[]),v.push(x),r=fj(r,x))}}),r){var x=f.getLabel(H),z=R("group.type");r=Ol(z,v,r),$l(r,H,"group.padding",1);var M=U._88I={type:z,rect:r,_64o:r};if(!z&&x!=w){var O,G=U.labelInfo={label:x,color:R("group.title.color"),font:R("group.title.font"),align:R("group.title.align")},y=Ng(G,x),t=y.width,h=y.height,$=R("group.title.align"),Z=R("group.title.orientation");if((Z===Gh||Z===Qc)&&t>r.width?r.width=t:(Z===Nh||Z===He)&&t>r.height&&(r.height=t),G.rect={y:r.y-h,width:y.width,height:h},O=$===Nh?r.x:$===He?r.x+r.width-t:r.x+r.width/2-t/2,G.rect.x=O,Z===Qc)M.titleRect={x:r.x,y:r.y+r.height,width:r.width,height:h},M.rect={x:r.x,y:r.y,width:r.width,height:r.height+h},G.rect={x:O,y:r.y+r.height,width:t,height:h};else if(Z===Nh){var l=M.titleRect={x:r.x-h,y:r.y,width:h,height:r.height};M.rect={x:r.x-h,y:r.y,width:r.width+h,height:r.height},G.rect={x:l.x+h/2-r.height/2,y:l.y+r.height/2-h/2,width:r.height,height:h},G.rotation=-Math.PI/2}else if(Z===He){var l=M.titleRect={x:r.x+r.width,y:r.y,width:h,height:r.height};M.rect={x:r.x,y:r.y,width:r.width+h,height:r.height},G.rect={x:l.x+h/2-r.height/2,y:l.y+r.height/2-h/2,width:r.height,height:h},G.rotation=Math.PI/2}else M.titleRect={x:r.x,y:r.y-h,width:r.width,height:h+1},M.rect={x:r.x,y:r.y-h,width:r.width,height:r.height+h}}U._40O(M,R("group.border.width")/2)}else Hg.superClass._3O.call(U)},getPosition:function(z,d,Z,$){var S=this._88I;if(S){var j=vb(z,S.rect,$);return j.x+=d,j.y+=Z,j}return Hg.superClass.getPosition.apply(this,arguments)},_24O:function(Q,W){var t=this._88I;(!t||t.type||"label2"===Q)&&Hg.superClass._24O.call(this,Q,W)},_80o:function(z){var q=this,i=q._88I;if(i){var h=q._data,J=q.s,$=q.gv,r=i.type,T=i.rect,p=i._64o,Y=i.titleRect,Q=q.getBodyColor(),k=Mf(J("group.image"),Q),l=J("group.image.stretch"),_=q.getBodyColor("group.background"),E=Mf(J("group.repeat.image"),Q),K=J("group.gradient.pack"),v=J("group.gradient"),f=J("group.gradient.color"),y=J("group.border.width"),N=J("group.border.color"),b=J("group.border.pattern"),G=J("group.title.orientation"),R=J("group.depth");if(r){var O=z.lineJoin,t=z.lineCap;if(z.lineJoin=J("group.border.join"),z.lineCap=J("group.border.cap"),k){if(z.save(),ld(z,r,T),z.clip(),nd(z,k,l,T.x,T.y,T.width,T.height,h,$,Q),z.restore(),y>0){var d=jq(z,b);ld(d,r,T),z.lineWidth=y,z.strokeStyle=N,z.stroke(),sd(z,b)}}else{var d=jq(z,b);_||E||K?(ld(z,r,T),K?ts(z,K):E?bd(z,E,Q,null,h,$):_l(z,_,v,f,T),z.fill(),K&&z.restore(),z!==d&&ld(d,r,T)):ld(d,r,T),y>0&&(z.lineWidth=y,z.strokeStyle=J("group.border.color"),z.stroke()),sd(z,b),r===Ph&&Wn(z,_,R,T)}z.lineJoin=O,z.lineCap=t}else{var x=J("group.title.background"),L=J("group.border.radius");if(k)nd(z,k,l,p.x,p.y,p.width,p.height,h,$,q.getBodyColor());else if(_||E)if(E?bd(z,E,Q,null,h,$):_l(z,_,v,f,p),0===y)ld(z,Ph,p),z.fill(),Wn(z,_,R,p);else{switch(z.beginPath(),G){case Qc:Hp(z,p.x,p.y,p.width,p.height,L,L,0,0);break;case Nh:Hp(z,p.x,p.y,p.width,p.height,0,L,0,L);break;case He:Hp(z,p.x,p.y,p.width,p.height,L,0,L,0);break;case Gh:Hp(z,p.x,p.y,p.width,p.height,0,0,L,L)}z.fill()}if(Y&&x)if(0===y)sc(z,Y.x,Y.y,Y.width,Y.height,x),Wn(z,x,R,Y);else{switch(z.beginPath(),z.fillStyle=x,G){case Qc:Hp(z,Y.x,Y.y,Y.width,Y.height,0,0,L,L);break;case Nh:Hp(z,Y.x,Y.y,Y.width,Y.height,L,0,L,0);break;case He:Hp(z,Y.x,Y.y,Y.width,Y.height,0,L,0,L);break;case Gh:Hp(z,Y.x,Y.y,Y.width,Y.height,L,L,0,0)}z.fill()}if(y>0){var d=jq(z,b);if(ld(d,"roundRect",T,L),z.lineWidth=y,z.strokeStyle=N,Y&&J("group.splitLine")){var j=Y.x,g=Y.y,I=Y.width,Z=Y.height;G===Qc?(z.moveTo(j,g),z.lineTo(j+I,g)):G===Nh?(z.moveTo(j+I,g),z.lineTo(j+I,g+Z)):G===He?(z.moveTo(j,g),z.lineTo(j,g+Z)):(z.moveTo(j,g+Z),z.lineTo(j+I,g+Z))}z.stroke(),sd(z,b)}}q._39O(z,i)}else Hg.superClass._80o.call(q,z)}});var Ed=function(O,m){qj(Ed,this,[O,m])};vo(Ed,dp,{_80o:function(p){this._39O(p,this._83o)}});var ub=function(g,E){qj(ub,this,[g,E])};vo(ub,dp,{_3O:function(){var T=this,K=T._data,p=T.s,z=T.gv,n=K.getPoints(),Q=z.getBorderColor(K),J=Q?p("border.width"):0,A=T.getSelectWidth(),i=p("shape.border.width"),u=K.getRect(),C=K.getAnchorRect(),G=z.getBodyColor(K),y=T._99o=n.isEmpty()?w:{rect:u,rotation:K.getRotation(),fillRule:p("shape.fill.rule"),scale:K.getScale(),position:K.p(),points:n,segments:K.getSegments(),bodyColor:G,borderColor:Q,borderWidth:J,_94o:p("shape.border.3d"),_95o:p("shape.border.3d.color"),_96o:p("shape.border.3d.accuracy"),_97o:A?T.getSelectColor():w,selectWidth:A,_53o:p("shape.background"),_27Q:Mf(p("shape.repeat.image"),G),shapeGradientPack:p("shape.gradient.pack"),_54o:i,_55o:p("shape.border.color"),shapeGradient:p("shape.gradient"),_59o:p("shape.gradient.color"),_60o:p("shape.border.pattern"),_61o:p("shape.border.cap"),_62o:p("shape.border.join"),shapeForeground:p("shape.foreground"),gray:p("2d.gray")};
if(y){C.x+=y.position.x,C.y+=y.position.y,y.gradientRect=C;var m=K.getScale(),c=H(1,H(l(m.x),l(m.y)));p("shape.dash")&&p("shape.dash.width")>i&&(i=p("shape.dash.width"));var V,q=p("shape.border.width.absolute");V=q?(i+J+A)/T.gv._zoom/c:i*("square"===y._61o?.71:.5)+J+A/T.gv._zoom/c,V&&(V*=c,u=Tk(u),Ho(u,V,y._62o)),T._68o(u);var U=p("clip.percentage");1>U&&(0>U&&(U=0),y.clipRect=ip(K.getAnchorRect(),p("clip.direction"),U));var t=p("shape.fill.clip.percentage");1>t&&(0>t&&(t=0),y.shapeClipRect=ip(K.getAnchorRect(),p("shape.fill.clip.direction"),t));var k=p("shape.foreground.clip.percentage");1>k&&(0>k&&(k=0),y.shapeForegroundClipRect=ip(K.getAnchorRect(),p("shape.foreground.clip.direction"),k))}},getPosition:function(G,P,X,z){var c=this._99o;if(c){var v=vb(G,c.rect,z);return v.x+=P,v.y+=X,v}return Be},_42:function(K){this._99o&&ub.superClass._42.call(this,K)},_80o:function(L){var q,D=this,b=D.s,H=D._99o,O=H.position,R=H.scale,o=H.rotation,w=H.borderWidth,G=H.selectWidth/D.gv._zoom,y=H._27Q,n=H.shapeGradientPack,h=H._54o,Y=H.clipRect,g=H.shapeClipRect,J=H.points,E=H.segments,F=D._data.isClosePath(),l=H.fillRule,X=H.gray,Z=function(u){return X?C.toGrayColor(u):u},N=Z(H._53o),s=N||y||n;L.save(),_k(L,O.x,O.y),uh(L,o),Gn(L,R.x,R.y),Y&&(L.beginPath(),L.rect(Y.x,Y.y,Y.width,Y.height),L.clip()),s&&g&&(L.save(),L.beginPath(),L.rect(g.x,g.y,g.width,g.height),L.clip()),_k(L,-O.x,-O.y);var d=H._60o,W=jq(L,d),M=L.lineJoin,A=L.lineCap;L.lineJoin=H._62o,L.lineCap=H._61o;var P=Z(H.bodyColor);s?(Vr(L,J,E,F),n?ts(L,n):y?bd(L,y,P,null,D._data,D.gv):(q=P?P:N,_l(L,q,H.shapeGradient,Z(H._59o),H.gradientRect)),L.fill(l),g&&(L.restore(),_k(L,-O.x,-O.y)),n&&L.restore(),W!==L&&Vr(W,J,E,F)):Vr(W,J,E,F);var v=H.shapeForeground;if(v){L.save();var $=H.shapeForegroundClipRect;$&&(_k(L,O.x,O.y),L.beginPath(),L.rect($.x,$.y,$.width,$.height),L.clip(),_k(L,-O.x,-O.y)),Vr(L,J,E,F),_l(L,v,b("shape.foreground.gradient"),Z(b("shape.foreground.gradient.color")),H.gradientRect),L.fill(l),L.restore()}var e=b("shape.border.width.absolute");if(e&&(L.save(),L.setTransform(1,0,0,1,0,0)),G&&(L.strokeStyle=H._97o,L.lineWidth=h+2*(w+G),L.stroke()),w&&(L.strokeStyle=Z(H.borderColor),L.lineWidth=h+2*w,L.stroke()),h&&(q=Z(H._55o),!N&&P&&(q=P),L.strokeStyle=q,L.lineWidth=h,L.stroke(),H._94o&&vr(L,q,Z(H._95o),h,D.gv._zoom,H._96o)),sd(L,d),b("shape.dash")){var c=b("shape.dash.width")||h;if(c>0){d=b("shape.dash.pattern");var W=jq(L,d,D._2Q("shape.dash.offset"));W!==L&&Vr(W,J,E,F),D._1Q(L,"shape",c,d)}}e&&L.restore(),L.lineJoin=M,L.lineCap=A,L.restore()},_48O:function(){},_47O:function(){}});var yr=function(w,Y){qj(yr,this,[w,Y])};vo(yr,ub,{getRotation:function(W,P,y){W=W||0;var G=this._data.getPoints(),$=G.size();return $>1?Nl[y]?$&&0===$%2?Up(G.get($/2-1),G.get($/2),P,W):W:Cd[y]?Up(G.get(0),G.get(1),P,W):Up(G.get($-2),G.get($-1),P,W):W},getPosition:function(m,v,o,Z,Y){var Q=this._data.getPoints(),H=Q.size();if(H>1){if(Nl[m]){var f=H%2;if(0===f)return xd(Q.get(H/2-1),Q.get(H/2),m,v,o,Z,Y);var C=Q.get((H-f)/2),B={x:C.x,y:C.y,width:0,height:0};return C=vb(m,B,Z),C.x+=v,C.y+=o,C}return Cd[m]?xd(Q.get(0),Q.get(1),m,v,o,Z,Y):xd(Q.get(H-2),Q.get(H-1),m,v,o,Z,Y)}return Be}});var Ik=function(P,g){qj(Ik,this,[P,g])};vo(Ik,dp,{_3O:function(){var D=this;Ik.superClass._3O.call(D);var K=D.s,r=D._83o;D._82o=r.img||r.shape?w:{background:D.getBodyColor("grid.background"),depth:K("grid.depth"),rect:r.rect,_88o:K("grid.cell.depth"),cellBorderColor:K("grid.cell.border.color"),_89o:K("grid.row.count"),_90o:K("grid.column.count"),block:K("grid.block"),_91o:K("grid.block.color"),_92o:K("grid.block.padding"),_93o:K("grid.block.width")}},_80o:function(X){var b=this,g=b._82o;if(!g)return Ik.superClass._80o.call(b,X),void 0;var Q,m,c=b._data,E=g.background,f=g.rect,D=g.block,s=g._91o,N=g._92o,Z=g._93o,S=g._88o,h=g.cellBorderColor,J=g._89o,$=g._90o;if(E)if(sc(X,f.x,f.y,f.width,f.height,E),Wn(X,E,g.depth,f),S)for(Q=0;J>Q;Q++)for(m=0;$>m;m++)f=c.getCellRect(Q,m),f&&Wn(X,E,S,f);else if(h){for(X.beginPath(),Q=0;J>Q;Q++)for(m=0;$>m;m++)f=c.getCellRect(Q,m),f&&X.rect(f.x,f.y,f.width,f.height);X.strokeStyle=h,X.lineWidth=1,X.stroke()}if("h"===D)for(Q=0;J>Q;Q++)f=fj(c.getCellRect(Q,0),c.getCellRect(Q,$-1)),Cc(f,N),Zh(X,s,f.x,f.y,f.width,f.height,Z);else if("v"===D)for(m=0;$>m;m++)f=fj(c.getCellRect(0,m),c.getCellRect(J-1,m)),Cc(f,N),Zh(X,s,f.x,f.y,f.width,f.height,Z);b._39O(X,b._83o)}});var Fd=function(M,C){qj(Fd,this,[M,C])};vo(Fd,dp,{_checkEmptyRect:!1,_81o:function(){var m=this._data,y=Fd.superClass._81o.call(this),X=m.s("text");if(X!=w){var t,V,k=m.s("text.font"),S=m.s("text.align"),_=m.s("text.vAlign"),v=Sk(k,X),i=v.width,q=v.height,g=m.getAnchor(),b=m.getWidth(),J=m.getHeight();"left"===S?t=-b*g.x:"center"===S?t=-b*g.x+(b-i)/2:"right"===S&&(t=b*(1-g.x)-v.width),"top"===_?V=-J*g.y:"middle"===_?V=-J*g.y+(J-q)/2:"bottom"===_&&(V=J*(1-g.y)-v.height);var E,h=m.getMatrix();if(E=ye([h.tf(t,V),h.tf(t+i,V),h.tf(t+i,V+q),h.tf(t,V+q)]),y=fj(y,E),y&&m.s("text.shadow")){var L=Tk(y);L.x+=m.s("text.shadow.offset.x"),L.y+=m.s("text.shadow.offset.y"),Cc(L,m.s("text.shadow.blur")),y=fj(y,L)}}return y}});var wm=yg.Interactor=function(x){this.gv=this._graphView=x};us("Interactor",I,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(G){this.gv.fi(G)},setCursor:function(w){ij||this.gv.setCursor(w)},startDragging:function(m){var T=this;T._lastClientPoint=Io(m),T._lastLogicalPoint=T.gv.lp(m),Yl(T,m)},clearDragging:function(){var g=this;g._lastClientPoint=g._lastLogicalPoint=g._logicalPoint=w},autoScroll:function(H){return this.gv.autoScroll(H,this._lastClientPoint)}});var Af=w,vm=function(Q){Af.handleWindowTouchMove(Q)},Yr=function(n){Af.handleWindowTouchEnd(n),q(u,hm,vm),q(u,ki,Yr),Af=w},xn=function(_){Af.handleWindowMouseMove(_)},Ne=function(d){Af.handleWindowMouseUp(d),q(u,Rg,xn),q(u,cc,Ne),Af=w},po=function(R,J){R!==Af&&(Af?ij?Af.handleWindowTouchEnd(J):Af.handleWindowMouseUp(J):ij?(X(u,hm,vm),X(u,ki,Yr)):(X(u,Rg,xn),X(u,cc,Ne)),Af=R)},nh=function(j){var m=this;m.gv=j,m._is2d=j instanceof yg.GraphView,m._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Qi,"wheel"].forEach(function(J){m.addListener(J)}),m.initImageResource()};vo(nh,wm,{enableVR:function(N){var C=this;if(!!C._vrEnable!==N)if(C._vrEnable=N,N)C.gv.vr.mp(C.onVRControllerChange,C);else if(C.gv.vr.ump(C.onVRControllerChange,C),C._vrRayPolyline){var h=C.gv.dm();h.remove(C._vrRayPolyline),h.remove(C._vrRayHitPoint),C._vrRayPolyline=i,C._vrRayHitPoint=i}},onVRControllerChange:function(U){var O=this,L=U.property,A=U.newValue,Y=O.gv.vr.getController(A.id),K=Y.getRay();K&&("gamepad.button.trigger"===L?"down"===A._62O?O.handle_mousedown(K):O.handleWindowMouseUp(K):"gamepad.pose"===L&&(O.handle_mousemove(K),O.handleWindowMouseMove(K)))},drawVRRay:function(S,E,X){var e,r=this,I=r.gv,i=r._vrRayPolyline,B=!1;if(i)e=r._vrRayHitPoint;else{var $=I.dm();r._vrRayPolyline=i=new v.Polyline,r._vrRayHitPoint=e=new v.Node,e.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),e.setAnchor3d(.5,.5,.499);var W=.2/I.vr.measureOflength;e.s3(W,W,W),i.s("intersect",!1),e.s("intersect",!1),$.add(i),$.add(e),B=!0}if(E){var q=X.world,Z=X.worldNormal,Q=q.x,U=q.y,H=q.z;i.s("shape.border.color","red"),i.setPoints([{x:S.origin.x,y:S.origin.z,e:S.origin.y},{x:Q,y:H,e:U}]),e.s("3d.visible",!0),e.p3(Q,U,H),e.lookAtDirection([Z.x,Z.y,Z.z],"front")}else{i.s("shape.border.color","blue");var g=new v.Math.Vector3;g.copy(S.direction).setLength(1e3/r.gv.vr.measureOflength).add(S.origin),i.setPoints([{x:S.origin.x,y:S.origin.z,e:S.origin.y},{x:g.x,y:g.z,e:g.y}]),e.s("3d.visible",!1)}I.fi({kind:"vrRayIntersect",ray:S,data:E,intersect:X,polyline:i,hitNode:e,begin:B})},setPreventEventDefault:function(m,h){var E=this,$=E._eventListeners[m];$?$._prevent=h:E._eventListeners[m]=$={_removal:i,_prevent:h}},removeListener:function(O){var z=this,U=z._eventListeners[O];U&&U._removal&&(U._removal(),U._removal=i)},addListener:function(O){var N=this,G=N._eventListeners[O];if(G||(N._eventListeners[O]=G={_removal:i,_prevent:!0}),!G||!G._removal){var d=function(K){G._prevent&&C.preventDefault(K),N.disabled||("wheel"===O?Dq(N,K):N["handle_"+O](K))};X(N.gv.getView(),O,d),G._removal=function(){q(N.gv.getView(),O,d)}}},handleWindowTouchMove:function(d){this.handleWindowMouseMove(d)},handleWindowMouseMove:function(n){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",n):(this.handleDownInfo("onBeginDrag",n),this.isDragging=!0))},handleWindowTouchEnd:function(o){this.handleWindowMouseUp(o)},handleWindowMouseUp:function(X){if(this.isDragging&&(this.handleDownInfo("onEndDrag",X),this.isDragging=!1),this.downInfo){var v=this.handle("onUp",X);if(v&&v.data===this.downInfo.data){this.handleMissingUp(X);var m=this,u=2===X.button?"onContextMenu":"onClick";if(!m._dbclickTimer)return m._dbclickTimer=_(function(){delete m._dbclickTimer,m.handleClick(X,u,v),this.downInfo=w},C.clickDelay),void 0;f(m._dbclickTimer),delete m._dbclickTimer,u="onDoubleClick",m.handleClick(X,u,v)}else this.handleDownInfo("onUp",X);this.downInfo=w}},handle_mouseleave:function(T){var g=this,G=g.gv,y=g.currentInfo?g.currentInfo.data:w;if(y){y.s("onLeave")&&y.s("onLeave")(T,y,G),g.fire("data","onLeave",T,y);var z=g.currentInfo?g.currentInfo.hits:w;if(z)for(var F in z)g.handleLeave(T,F);g.currentInfo=w}},handle_mousewheel:function(D){D.scrollDelta=D.wheelDelta/40,this.handle("onScroll",D)},handle_DOMMouseScroll:function(C){C.scrollDelta=2===C.axis?-C.detail:0,this.handle("onScroll",C)},handle_touchstart:function(T){this.handle_mousedown(T)},handle_touchmove:function(L){this.handle("onMove",L)},handle_mousedown:function(u){this.isDragging&&(this.handleDownInfo("onEndDrag",u),this.isDragging=!1),this.downInfo=this.handle("onDown",u),this.downInfo&&po(this,u)},handle_mousemove:function(M){var P=this,G=P.gv;P._hoverTimer&&(f(P._hoverTimer),delete P._hoverTimer);var H,I,n,U=P.handle("onMove",M),u=this.currentInfo?this.currentInfo.data:w,x=this.currentInfo?this.currentInfo.hits:w;if(U&&(I=U.data,n=U.hits,P._hoverTimer=_(function(){f(P._hoverTimer),delete P._hoverTimer,P.handle("onHover",M,U)},G.getHoverDelay()||C.hoverDelay)),I!==u){if(u&&(u.s("onLeave")&&u.s("onLeave")(M,u,G),this.fire("data","onLeave",M,u)),I&&(I.s("onEnter")&&I.s("onEnter")(M,I,G),this.fire("data","onEnter",M,I)),x)for(H in x)this.handleLeave(M,H);if(n)for(H in n){var y=n[H],p=I._interactPrefix=y.prefix,t=p&&I.a(p+"onEnter")||y.target.onEnter;t&&t.call(y.target,M,I,G,y.point,y.width,y.height),this.fire(y.type,"onEnter",y.event,y.data,y.image,y.comp,y.point,y),I._interactPrefix=null}}else{if(x)for(H in x)n&&n[H]||this.handleLeave(M,H);if(n)for(H in n)if(!x||!x[H]){var y=n[H],p=I._interactPrefix=y.prefix,t=p&&I.a(p+"onEnter")||y.target.onEnter;t&&t.call(y.target,M,I,G,y.point,y.width,y.height),this.fire(y.type,"onEnter",y.event,y.data,y.image,y.comp,y.point,y),I._interactPrefix=null}}this.currentInfo=U},handle:function(i,_,C){var R,y=this,x=y.gv;if(y._is2d){if(C=C||x.getDataInfoAt(_),!C||!x.isInteractive(C.data))return;if(R=C.ui.interactiveInfo){var L,T=C.data;if(T.s(i)&&T.s(i)(_,T,x),this.fire("data",i,_,T),"body"===C.part&&R.bodyInfo)L="body",C.hits=this.handleImage(L,x.getImage(T),i,_,T,C.point,R.bodyInfo);else if("icons"===C.part&&R._38o){var a=R._38o[C.name];a&&a[C.index]&&(L="icons|"+C.name+"|"+C.index,C.hits=this.handleImage(L,C.icon,i,_,T,C.point,a[C.index]))}}return C}var T,m;if(!C)if(_&&_ instanceof v.Math.Ray){var N=x.vr.intersectWorld(_);if(T=N.data,m=N.intersect,y.drawVRRay(_,T,m),!T)return;var Q=x.getData3dUI(T);if(R=Q.interactiveInfo,!R)return;C={data:T,part:m.part,ui:Q}}else{if(C=x.getDataInfoAt(_),!C)return;C&&(C={data:C.data,part:C.part})}if(x.isInteractive(C.data)){if(!m){T=C.data;var Q=x.getData3dUI(T);if(C.ui=Q,R=Q.interactiveInfo,!R)return C;if(m=x.intersectObject(_,T),!m)return}T.s(i)&&T.s(i)(_,T,x),this.fire("data",i,_,T);var r,e=m.part;return"body"!==e&&(r=T.s(e+".image")||T.s("shape3d."+e+".image")),r||(r=T.s("all.image")||T.s("shape3d.image")),R="object"==typeof r?R[r.uuid]:R[r],R&&R.bodyInfo?(C.part="body",C.interactiveInfo=R,C.point=m.uv.multiply({x:R.bodyInfo.rect.width,y:R.bodyInfo.rect.height}),C.image=r,C.hits=this.handleImage("body",r,i,_,T,C.point,R.bodyInfo),C):C}},_handleLeaveOrMissing:function(G,v,Z){var t="leave"===G?this.currentInfo:this.downInfo;if(t){var g=t.interactiveInfo||t.ui.interactiveInfo;if(g){var A,J,s=t.data;if(this._is2d){if(J=this.gv.lp(v),"body"===t.part&&g.bodyInfo)A="body","leave"===G?this.handleLeaveImage(Z,A,this.gv.getImage(s),v,s,J,g.bodyInfo):this.handleMissingUpImage(A,this.gv.getImage(s),v,s,J,g.bodyInfo);else if("icons"===t.part&&g._38o){var L=g._38o[t.name];L&&L[t.index]&&(A="icons|"+t.name+"|"+t.index,"leave"===G?this.handleLeaveImage(Z,A,t.icon,v,s,J,L[t.index]):this.handleMissingUpImage(A,t.icon,v,s,J,L[t.index]))}}else{if(!g.bodyInfo)return;var n=this.gv.intersectObject(v,s);J=n?n.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===G?this.handleLeaveImage(Z,"body",t.image,v,s,J,g.bodyInfo):this.handleMissingUpImage("body",t.image,v,s,J,g.bodyInfo)}}}},handleClick:function(m,q,T){var H=this,W=this.downInfo;if(W&&T){var k,P=T.interactiveInfo||T.ui.interactiveInfo,L=T.data,F=this.gv;if(L.s(q)&&L.s(q)(m,L,F),H.fire("data",q,m,L),P)if(this._is2d){if(W.part===T.part){var X=F.lp(m);"body"===T.part&&P.bodyInfo&&(k="body",this.handleClickImage(k,F.getImage(L),q,m,L,X,P.bodyInfo,T))}}else{if(!P.bodyInfo)return;var v=F.intersectObject(m,L);if(!v)return;X=v.uv.multiply({x:P.bodyInfo.rect.width,y:P.bodyInfo.rect.height}),this.handleClickImage("body",W.image,q,m,L,X,P.bodyInfo,T)}}},handleDownInfo:function(H,Y){if(this.downInfo){var G=this.downInfo,l=this.gv,L=G.interactiveInfo||G.ui.interactiveInfo;if(L){var v,s=G.data;if(s.s(H)&&s.s(H)(Y,s,l),this.fire("data",H,Y,s),this._is2d){var o=l.lp(Y);if("body"===G.part&&L.bodyInfo)v="body",this.handleDownInfoImage(v,l.getImage(s),H,Y,s,o,L.bodyInfo);else if("icons"===G.part&&L._38o){var E=L._38o[G.name];E&&E[G.index]&&(v="icons|"+G.name+"|"+G.index,this.handleDownInfoImage(v,G.icon,H,Y,s,o,E[G.index]))}}else{if(!L.bodyInfo)return;var u=l.intersectObject(Y,s);if(!u)return;o=u.uv.multiply({x:L.bodyInfo.rect.width,y:L.bodyInfo.rect.height}),this.handleDownInfoImage("body",G.image,H,Y,s,o,L.bodyInfo)}}}},fire:function(F,s,y,M,$,Q,m,C){this.gv.fi({kind:s,type:F,event:y,data:M,image:$,comp:Q,view:this.gv,point:m,width:C?C.width:i,height:C?C.height:i})},handleImage:function(h,l,R,b,k,$,K){var X={};if(l&&(l=Mf(l))){var t=this.gv,V=K.rect,G=this.convertPoint($,K);G.inRect&&(l[R]&&l[R](b,k,t,G,V.width,V.height),this.fire("image",R,b,k,l,i,G,V),X[h+"|image"]={target:l,type:"image",image:l,data:k,event:b,point:G,width:V.width,height:V.height});for(var C=K.compInfos,o=l,y=C.length-1;y>=0;y--){var O=C[y],n=O.comp;if(G=this.convertPoint($,O,o,n,t,k),G.inRect){V=O.rect;var J=k._interactPrefix=O.prefix,E=J&&k.a(J+R)||n[R];E&&E.call(n,b,k,t,G,V.width,V.height),this.fire("comp",R,b,k,l,n,G,V),(l=V.image)&&(l[R]&&l[R](b,k,t,G,V.width,V.height),this.fire("image",R,b,k,l,i,G,V)),k._interactPrefix=null,X[h+"|"+y]={target:n,type:"comp",comp:n,image:l,data:k,event:b,point:G,width:V.width,height:V.height,prefix:J},l&&(X[h+"|"+y+"|image"]={target:l,type:"image",image:l,data:k,event:b,point:G,width:V.width,height:V.height,prefix:J})}}}return X},handleLeave:function(B,e){return this._handleLeaveOrMissing("leave",B,e)},handleMissingUp:function(z){return this._handleLeaveOrMissing("missing",z)},handleLeaveImage:function(l,X,x,b,v,c,Z){if(x&&(x=Mf(x))){var h=this.gv,a=Z.rect,R=this.convertPoint(c,Z);l===X+"|image"&&(x.onLeave&&x.onLeave(b,v,h,R,a.width,a.height),this.fire("image","onLeave",b,v,x,i,R,a));for(var D=Z.compInfos,k=x,y=D.length-1;y>=0;y--){var F=D[y],g=F.comp;R=this.convertPoint(c,F,k,g,h,v),a=F.rect;var w=v._interactPrefix=F.prefix;if(l===X+"|"+y){var U=w&&v.a(w+"onLeave")||g.onLeave;U&&U.call(g,b,v,h,R,a.width,a.height),this.fire("comp","onLeave",b,v,x,g,R,a)}(x=a.image)&&l===X+"|"+y+"|image"&&(x.onLeave&&x.onLeave(b,v,h,R,a.width,a.height),this.fire("image","onLeave",b,v,x,i,R,a)),v._interactPrefix=null}}},handleMissingUpImage:function(j,W,h,s,w,o){var Y="onUp",x=this.downInfo.hits;if(x&&W&&(W=Mf(W))){var k=this.gv,d=o.rect,S=this.convertPoint(w,o);!S.inRect&&x[j+"|image"]&&(W[Y]&&W[Y](h,s,k,S,d.width,d.height),this.fire("image",Y,h,s,W,i,S,d));for(var B=o.compInfos,f=W,l=B.length-1;l>=0;l--){var E=B[l],G=E.comp;if(S=this.convertPoint(w,E,f,G,k,s),!S.inRect){d=E.rect;var K=s._interactPrefix=E.prefix;if(x[j+"|"+l]){var y=K&&s.a(K+Y)||G[Y];y&&y.call(G,h,s,k,S,d.width,d.height),this.fire("comp",Y,h,s,W,G,S,d)}(W=d.image)&&x[j+"|"+l+"|image"]&&(W[Y]&&W[Y](h,s,k,S,d.width,d.height),this.fire("image",Y,h,s,W,i,S,d)),s._interactPrefix=null}}}},handleDownInfoImage:function(E,Y,M,T,Z,G,y){var J=this.downInfo.hits;if(J&&Y&&(Y=Mf(Y))){var P=this.gv,e=y.rect,A=this.convertPoint(G,y);J[E+"|image"]&&(Y[M]&&Y[M](T,Z,P,A,e.width,e.height),this.fire("image",M,T,Z,Y,i,A,e));for(var B=y.compInfos,F=Y,g=B.length-1;g>=0;g--){var o=B[g],r=o.comp;A=this.convertPoint(G,o,F,r,P,Z),e=o.rect;var I=Z._interactPrefix=o.prefix;if(J[E+"|"+g]){var L=I&&Z.a(I+M)||r[M];L&&L.call(r,T,Z,P,A,e.width,e.height),this.fire("comp",M,T,Z,Y,r,A,e)}(Y=e.image)&&J[E+"|"+g+"|image"]&&(Y[M]&&Y[M](T,Z,P,A,e.width,e.height),this.fire("image",M,T,Z,Y,i,A,e)),Z._interactPrefix=null}}},handleClickImage:function(y,l,E,A,T,F,I,e){var s=this.downInfo.hits,n=e.hits;if(s&&l&&(l=Mf(l))){var K=this.gv,u=I.rect,U=this.convertPoint(F,I);s[y+"|image"]&&(l[E]&&l[E](A,T,K,U,u.width,u.height),this.fire("image",E,A,T,l,i,U,u));for(var G=I.compInfos,D=l,J=G.length-1;J>=0;J--){var C=G[J],Z=C.comp;U=this.convertPoint(F,C,D,Z,K,T),u=C.rect;var S=T._interactPrefix=C.prefix;if(s[y+"|"+J]&&n[y+"|"+J]){var h=S&&T.a(S+E)||Z[E];h&&h.call(Z,A,T,K,U,u.width,u.height),this.fire("comp",E,A,T,l,Z,U,u)}(l=u.image)&&s[y+"|"+J+"|image"]&&(l[E]&&l[E](A,T,K,U,u.width,u.height),this.fire("image",E,A,T,l,i,U,u)),T._interactPrefix=null}}},initImageResource:function(){C.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(v,u,V,t,H,B){var D=u.rect,d=u.matrix.applyInverse(v).sub(D),k=d.x>=0&&d.y>=0&&d.x<=D.width&&d.y<=D.height;if(!k)return d;if(t&&mo(t.pixelPerfect,B,H)){var D,O=1;this._is2d?(O=H.getZoom(),D=Eb(v.x,v.y,i,O)):D=Eb(v.x,v.y);var I=!1,X=D.x,n=D.y,T=D.width,R=D.height,o=C.hitMaxArea,A=T*R*O*O;if(A>o){var Y=Math.sqrt(o/A);O*=Y}T*=O,R*=O,2>T&&(T=2),2>R&&(R=2),X*=O,n*=O;var c=Qf(T,R),e=new Ok(0,-X,-n,O,O);e.append(u.matrix),H._drawForChecking=!0,t.transform=e;var r=V.comps;V.comps=[t],lh(c,V,0,0,T,R,B,self),V.comps=r,delete t.transform,H._drawForChecking=!1;try{for(var K=0,W=c.getImageData(0,0,T,R).data;K<W.length;K+=4)if(0!==W[K+3]){I=!0;break}c.restore()}catch(E){ul=w,I=!1}d.inRect=I}else d.inRect=!0;return d}});var Il=yg.DefaultInteractor=function(r){qj(Il,this,[r])};us("DefaultInteractor",wm,{handle_mousedown:function(X){jm(X);var J=this,n=J.gv,r=n.getDataAt(X);if(n.setFocus(X)&&!n._editing&&!n._scrolling){Bo(X)?n.handleDoubleClick(X,r):n.handleClick(X,r);var D=yi(X);!Dj()&&!D&&r&&(n.isMovable(r)||n._39Q(r))||!n.isPannable()||!Lg(X)&&!D||_n(X)||(J._tx=n.tx(),J._ty=n.ty(),J.startDragging(X))}},handleWindowMouseUp:function(u){var C=this,p=C.gv;p._panning&&(delete p._panning,p.onPanEnded(),C.fi({kind:"endPan",event:u})),delete C._tx,delete C._ty,C.clearDragging()},handle_mousemove:function(W){var I=this,u=I.gv;I._hoverTimer&&(f(I._hoverTimer),delete I._hoverTimer),I._hoverTimer=_(function(){I.fi({kind:"hover",event:W}),f(I._hoverTimer),delete I._hoverTimer},u.getHoverDelay()||C.hoverDelay)},handle_touchmove:function(r){this.handle_mousemove(r)},handleWindowMouseMove:function(n){var U=this,g=U.gv;U.fi({kind:g._panning?"betweenPan":"beginPan",event:n}),g._panning=1;var j=cp(g,n,U._lastClientPoint);g.setTranslate(U._tx+j.x,U._ty+j.y)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta)},handle_DOMMouseScroll:function(h){2===h.axis&&this.gv.handleScroll(h,-h.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)}});var Tm=yg.SelectInteractor=function(V){qj(Tm,this,[V])};us("SelectInteractor",wm,{_42:function(){var z=this,Y=z.gv,B=Y.getZoom(),p=z.mark,Z=z.div;Z||(Z=z.div=xl(),Pj(z.getView(),Z));var j={};j.x=p.x*B+Y.tx(),j.y=p.y*B+Y.ty(),j.width=p.width*B,j.height=p.height*B,Wp(Z,j),this.intersects()?(Z.style.border="",Z.style.background=Y.getRectSelectBackground()):(Z.style.background="",Z.style.border="1px solid "+Y.getRectSelectBorderColor())},handle_mousedown:function(X){var j=this,y=j.gv;if(j._57I=w,j.pendingClickThrough=w,!(y._editing||y._scrolling||Dj()||yi(X))){var o=y.getDataAt(X),p=y.sm();o?_n(X)?p.co(o)?p.rs(o):p.as(o):p.co(o)?o instanceof jl&&o.isClickThroughEnabled()&&Lg(X)&&(j.pendingClickThrough=Io(X)):p.ss(o):_n(X)||!y.isPannable()?Lg(X)&&(_n(X)||p.cs(),y.isRectSelectable()&&(j.startDragging(X),y._77O=1)):Lg(X)&&(j._57I=Io(X))}},handle_mouseup:function(Y){var e=this,x=e.gv,H=e._57I;if(H&&(Sp(H,Io(Y))<=1&&x.sm().cs(),e._57I=w),e.pendingClickThrough){if(Sp(e.pendingClickThrough,Io(Y))<=1){var C=x.getDataAt(Y);if(C instanceof jl&&C.isClickThroughEnabled()){var D=x.getDataAt(Y,function(t){var h=t.getParent()===C&&x.isSelectable(t,!0);return h});D&&(Y.clickThrough=!0,x.sm().ss(D))}}e.pendingClickThrough=w}},handleWindowMouseUp:function(L){this.clear(L)},handleWindowMouseMove:function(r){var I=this,U=I.gv;I._logicalPoint=U.lp(r),I.mark?(I.fi({kind:"betweenRectSelect",event:r}),U.isPannable()&&I.autoScroll(r),I.redraw()):I.fi({kind:"beginRectSelect",event:r}),I.mark=ye(I._lastLogicalPoint,I._logicalPoint),I.redraw()},intersects:function(){var E=this,B=E._lastLogicalPoint,t=E._logicalPoint;return B.x>t.x||B.y>t.y},clear:function(f){var q=this,D=q.gv,y=q.mark;if(q._57I=w,q.pendingClickThrough=w,q._lastLogicalPoint){if(y){if(0!==y.width&&0!==y.height){var v=D.getDatasInRect(y,q.intersects());if(!v.isEmpty()){var z=D.sm(),e=z.toSelection();v.each(function(E){z.co(E)?e.remove(E):e.add(E)}),z.ss(e)}}ck(q.div),delete q.div,delete q.mark,q.redraw(),q.fi({kind:"endRectSelect",event:f}),D.onRectSelectEnded()}q.clearDragging(),delete D._77O}},redraw:function(){var G=this;G._draw||(G._draw=1,_(function(){G.mark&&G._42(),delete G._draw},16))}});var ok=yg.MoveInteractor=function(P){qj(ok,this,[P])};us("MoveInteractor",wm,{handle_mousedown:function(H){var S=this,Z=S.gv;if(Lg(H)&&!Z._editing&&!Z._scrolling&&!Dj()){var c=Z.getSelectedDataAt(H);!c||Z._39Q(c)&&!Z.isMovable(c)?Z._focusData=w:(S._data=c,Z.handleMouseDown&&Z.handleMouseDown(H,c),S.startDragging(H),Z.isMovable(c)&&(Z._moving=1))}},handleWindowMouseUp:function(k){var D=this,A=D.gv;A.handleMouseUp&&A.handleMouseUp(k,D._data),D.clear(k)},handleWindowMouseMove:function(C){var w=this,L=w._data,y=w.gv;if((!y._93O||!y._93O(C,L))&&y._moving){w._logicalPoint||w.fi({kind:"prepareMove",event:C});var c=w._logicalPoint?"betweenMove":"beginMove",j={kind:c,event:C},U=w._logicalPoint=y.lp(C);"beginMove"!==c||w._alreadyBeginTransaction||(w._alreadyBeginTransaction=!0,y.getDataModel().beginTransaction());var N=w._calcShift(c,C),m=N.x,H=N.y,Q=w.gv.getMoveMode(C,L);Q&&("x"===Q?H=0:"y"===Q?m=0:"xy"!==Q&&(m=H=0)),y.moveSelection(m,H),w._lastLogicalPoint=U,w.autoScroll(C),w.fi(j)}},_calcShift:function(){var G=this,$=G._logicalPoint,b=G._lastLogicalPoint,s=$.x-b.x,Z=$.y-b.y;return{x:s,y:Z}},clear:function(E){var e=this,D=e.gv;e._lastLogicalPoint&&(e._lastLogicalPoint=e._data=D._moving=w,e._logicalPoint&&(e.fi({kind:"endMove",event:E}),D.onMoveEnded()),e.clearDragging()),e._alreadyBeginTransaction&&(e._alreadyBeginTransaction=!1,D.getDataModel().endTransaction())}});var Ci=yg.TextEditInteractor=function(B){qj(Ci,this,[B]),this.init()};us("TextEditInteractor",wm,{init:function(){var $=this,t=this.input=j.createElement("input"),Y=t.style;t.text="text",Y.border="1px solid #d8d8d8",Y.position="absolute",Y.padding="2px 3px",Y.outline="none",Y.marginLeft="-90px",Y.marginTop="-16px",Y.backgroundColor="rgba(255,255,255, 0.9)",Y.fontSize="14px",Y.width="180px",Y.height="32px",Y.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Y.textAlign="center",Y.boxSizing="border-box",X(t,"keyup",function(w){np(w)&&$.endTextEdit()}),X(t,"focus",function(){t.select()});var e=this.textarea=j.createElement("textarea"),h=this.wrap=j.createElement("div");h.appendChild(e),Y=e.style,Y.margin=0,Y.padding="4px",Y.overflow="hidden",Y.boxSizing="border-box",Y.position="absolute",Y.outline="none",Y.backgroundColor="transparent",Y.resize="none",Y.textAlign="center",Y.fontSize="14px",Y.border="none",Y.borderWidth=0,Y.width="100%",Y.top="50%",Y=h.style,Y.boxSizing="border-box",Y.margin=0,Y.padding=0,Y.position="absolute",Y.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Y.border="1px solid #d8d8d8",Y.backgroundColor="rgba(255,255,255, 0.9)",Y.width="180px",Y.marginLeft="-90px",X(e,"keydown",function(L){return(Hh()||_n())&&np(L)?($.endTextEdit(),void 0):($.calculateTextareaHeight(String.fromCharCode(L.keyCode)),void 0)}),X(e,"focus",function(){e.select()});var H=function(J){J.stopPropagation()};X(t,"mousedown",H),X(t,"touchstart",H),X(e,"mousedown",H),X(e,"touchstart",H),$.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],$.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",$.handleWindowClick=function(I){var z=$._editingDOM;if(z){var k=z.getBoundingClientRect(),n=Io(I);gg(k,n)||$.endTextEdit()}}},handle_mousedown:function(H){var T=this,S=T.gv;if(Bo(H)&&!S._editing){var X=S.getDataAt(H);if(X){var W=S.getTextEditInfo(X);W&&(this._editInfo=W,this._editTarget=X,S._editing=!0,W.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var r=this,s=r.gv,T=r._editTarget,G=r.getTargetValue(),p=r.textarea,K=r.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===G||G===i)&&(G=""),p.value=G,r._editingDOM=p,s.getView().appendChild(K),this.layoutHTML(K,T),this.calculateTextareaHeight(),_(function(){p.focus(),X(u,"mousedown",r.handleWindowClick),X(u,"touchstart",r.handleWindowClick)},10)},handleTextEdit:function(){var T=this,$=T.gv,r=T._editTarget,V=T.getTargetValue(),Z=T.input;(null===V||V===i)&&(V=""),Z.value=V,T._editingDOM=Z,$.getView().appendChild(Z),this.layoutHTML(Z,r),_(function(){Z.focus(),X(u,"mousedown",T.handleWindowClick),X(u,"touchstart",T.handleWindowClick)},10)},layoutHTML:function(A,f){var T=this.gv,N=T.getZoom();if(f instanceof v.Node){var Q=f.getRect();A.style.left=(Q.x+Q.width/2)*N+T.tx()+"px",A.style.top=(Q.y+Q.height/2)*N+T.ty()+"px"}else if(f instanceof v.Edge){var G=T.getDataUI(f),Q=G._6I;A.style.left=(Q.x+Q.width/2)*N+T.tx()+"px",A.style.top=(Q.y+Q.height/2)*N+T.ty()+"px"}},endTextEdit:function(){var z=this,v=z._editInfo.isMultiline?z.wrap:z.input,y=z._editInfo.isMultiline?z.textarea:z.input;z.setTargetValue(y.value),z.gv.getView().removeChild(v),z.gv._editing=!1,delete z._editingDOM,q(u,"mousedown",z.handlelick),q(u,"touchstart",z.handleWindowClick)},setTargetValue:function(B){var L=this,t=L._editTarget,k=L._editInfo,X=k.accessType,_=k.name;if(_&&X||(X="p",_="name"),"p"===X){var R=v.Default.setter(_);t[R](B)}else"a"===X?t.a(_,B):t.s(_,B)},getTargetValue:function(){var w=this,P=w._editTarget,G=w._editInfo,n=G.accessType,r=G.name;if(r&&n||(n="p",r="name"),"p"===n){var q=v.Default.getter(r);return P[q]()}return"a"===n?P.a(r):P.s(r)},createHiddenTextarea:function(){this.hiddenTextarea=j.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(v,k){if(k&&this.computedStyleCache)return this.computedStyleCache;var O=this,t=u.getComputedStyle(v),z=t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),M=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),Q=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),B=O.SIZING_STYLE.map(function(c){return c+":"+t.getPropertyValue(c)}).join(";"),D={sizingStyle:B,paddingSize:M,borderSize:Q,boxSizing:z};return k&&(this.computedStyleCache=D),D},calculateTextareaHeight:function(E){E=E||"";var K=this,f=K.textarea,m=K.hiddenTextarea,F=K.wrap,U=32,v=K.calculateHTMLStyle(f,!1),x=v.paddingSize,P=v.borderSize,p=v.boxSizing,h=v.sizingStyle;m.setAttribute("style",h+";"+K.HIDDEN_TEXTAREA_STYLE),m.value=f.value+E;var i=m.scrollHeight;"border-box"===p?i+=P:"content-box"===p&&(i-=x),f.style.height=i+"px",f.style.marginTop=0-.5*i+"px",F.style.height=Math.max(i,U)+"px",F.style.marginTop=i*-.5+"px"}});var Qh=yg.ScrollBarInteractor=function(U){qj(Qh,this,[U])};us("ScrollBarInteractor",wm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(_){var X=this.gv.getViewRect();return this._41o()&&(X.x+X.width-this.gv.lp(_).x)*this.gv.getZoom()<jk},isH:function(i){var X=this.gv.getViewRect();return this._40o()&&(X.y+X.height-this.gv.lp(i).y)*this.gv.getZoom()<jk},handle_mousemove:function(w){this.handle_touchmove(w)},handle_touchmove:function(y){if(!Bb&&Lg(y)&&this.gv.isScrollBarVisible()){var z=this,u=z.isV(y),c=z.isH(y);(u||c)&&z.gv.showScrollBar(),z.gv._scrolling=u||c}},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(I){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=w,this.fi({kind:"endScroll",event:I})},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(o){var f=this;if(f.gv.setFocus(o),jm(o),f.handle_touchmove(o),!(bs(o)>1)&&f.gv._scrolling&&f.gv.isScrollBarVisible()){f._cp=Io(o),f._tx=f.gv.tx(),f._ty=f.gv.ty();var c=f.isV(o);f._state=c?"vScroll":"hScroll",Yl(f,o),f.fi({kind:"beginScroll",event:o})}},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(a){var C=Io(a),Y=this.gv.getViewRect(),p=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-C.y)*p.height/Y.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-C.x)*p.width/Y.width),this.fi({kind:"betweenScroll",event:a})}});var ik=yg.TouchInteractor=function(t,p){p=p||{},p.selectable===i&&(p.selectable=!0),p.movable===i&&(p.movable=!0),p.pannable===i&&(p.pannable=!0),p.pinchable===i&&(p.pinchable=!0),p.editable===i&&(p.editable=!0),this.params=p,qj(ik,this,[t])};us("TouchInteractor",wm,{ms_edit:1,setUp:function(){var c=this;ik.superClass.setUp.call(c),ij&&c.params.editable&&c.gv.setEditInteractor(c)},tearDown:function(){var i=this;ik.superClass.tearDown.call(i),ij&&i.params.editable&&i.gv.setEditInteractor(w)},clear:function(Q){var j=this,u=j.gv;u._moving&&(j.fi({kind:"endMove",event:Q}),delete u._moving,u.onMoveEnded(),u.dm().endTransaction()),u._panning&&(j.fi({kind:"endPan",event:Q}),delete u._panning,u.onPanEnded()),u._pinching&&(j.fi({kind:"endPinch",event:Q}),delete u._pinching,u.onPinchEnded()),u._editing&&(j._46O(Q),j._77I=j._node=j._edge=j._shape=j._rect=j._89I=j._index=u._editing=w),j._moving=j._panning=j._pinching=j._editing=j._57I=j._data=j._beginHistory=w,j.clearDragging()
},handle_touchstart:function(D){var r=this;if(!r.gv._editing){jm(D),r._57I=w;var p=r.params,T=r.gv,o=T.sm(),V=T.getDataAt(D),Z=bs(D);if(1===Z){if(Bo(D))return T.handleDoubleClick(D,V),void 0;T.handleClick(D,V),V&&(T.handleMouseDown&&T.handleMouseDown(D,V),r._data=V),p.selectable||(V=w),V&&(o.co(V)||o.ss(V),p.editable&&T.isEditable(V)&&r._79I(D,V,!0)?(r._editing=1,r.startDragging(D)):p.movable&&T.isMovable(V)&&(r._moving=1,r.startDragging(D))),V&&T.isMovable(V)||(r._57I=Io(D),p.pannable&&T.isPannable()&&(r._panning=1,r.startDragging(D),r._translate={x:T.tx(),y:T.ty()}))}else if(p.pinchable&&2===Z){if(V&&T._39Q(V))return;r._pinching=1,r.startDragging(D);var f=T.getView(),e=T.getZoom(),u=f.getBoundingClientRect(),z=D.touches[0],_=D.touches[1],v={x:(z.clientX+_.clientX)/2-u.left,y:(z.clientY+_.clientY)/2-u.top};v.x-=T.tx(),v.y-=T.ty(),v.x/=e,v.y/=e,r._p=v,r._d=sh(D)}}},handle_touchend:function(W){var f=this,H=f.gv,Q=f._57I,M=f._data;Q&&(Sp(Q,Io(W))<=1&&!H.getDataAt(W)&&H.sm().cs(),f._57I=w),M&&H.handleMouseUp&&H.handleMouseUp(W,M)},handleWindowTouchEnd:function(f){this.clear(f)},handleWindowTouchMove:function(E){var R=this,s=R.gv,p=bs(E);if(1===p){if(R._editing&&(R._beginHistory||(R._beginHistory=1,s.dm().beginTransaction()),s._editing=1,R._78I(E)),R._moving)R._beginHistory||(R._beginHistory=1,s.dm().beginTransaction()),R.handleMove(E);else if(R._panning){var w=Io(E),b=cp(s,w,R._lastClientPoint);s.setTranslate(R._translate.x+b.x,R._translate.y+b.y),R.fi({kind:s._panning?"betweenPan":"beginPan",event:E}),s._panning=1}}else if(2===p&&R._pinching){var A=sh(E);s.handlePinch(R._p,A,R._d),R._d=A,R.fi({kind:s._pinching?"betweenPinch":"beginPinch",event:E}),s._pinching=1}},handleMove:function(w){var s=this,J=s.gv,n=J.lp(w);J._93O&&J._93O(w,s._data)||(J.moveSelection(n.x-s._lastLogicalPoint.x,n.y-s._lastLogicalPoint.y),s._lastLogicalPoint=n,s.autoScroll(w),s.fi({kind:J._moving?"betweenMove":"beginMove",event:w}),J._moving=1)}});var v=u.ht,em=v.graph._editor={Math:v.Math,Guide:{}};em.getStyle=function(e){var f,T=em.StyleMap;return T&&(f=T[e],f!==i)?f:em.DefaultStyleMap[e]},em.setStyle=function(R,W){var o=em.StyleMap;o||(o=em.StyleMap={}),o[R]=W},em.inEdit=function(C){return C._inXEdit===!0},em.startEdit=function(t){t._inXEdit=!0,em.Inject.doInject(t)},em._46O=function(m){m._inXEdit=!1,em.Inject.undoInject(m)},em.toScreenPosition=function(Q,R){var v=Q.tx(),x=Q.ty(),X=Q._zoom;return new em.Math.Vector2(R.x*X+v,R.y*X+x)},em.checkHit=function(Q,B,R){return Q.distanceTo(B)<R?!0:!1},em.toWorldPosition=function(x,C){var e=x.tx(),l=x.ty(),y=x._zoom;return{x:(C.x-e)/y,y:(C.y-l)/y}},em.setAntialias=function(i,Z){for(var h,f=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],G=0,z=f.length;z>G&&(h=f[G],!(h in i));G++);i[h],i[h]=Z},em.getTargetCornersOnScreen=function(r,t){if(!t)return null;var e,R=[];if(eg(t,r)){var J=je(r,t);e=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}]}else{if(!t.getCorners)return null;e=t.getCorners()}return e.forEach(function(I){var s=em.toScreenPosition(r,I);R.push(s.x,s.y)}),R},em.log=function(){};var Ur=em.Inject={_modules:[]};Ur.registAsModule=function(d,X){var r={},Z={};for(var z in d){var E=X.prototype[z];r[z]=E}d.getBackup=function(a){return r[a]},d.getBackups=function(){return r},Z.doInject=function(){for(var Y in d)"getBackup"!==Y&&(X.prototype[Y]=d[Y])},Z.undoInject=function(){for(var S in d)"getBackup"!==S&&(X.prototype[S]=r[S])},Ur._modules.push(Z)},Ur.doInject=function(p){for(var O,B=Ur._modules,H=0,P=B.length;P>H;H++)O=B[H],O.doInject(p)},Ur.undoInject=function(g){for(var i,Z=Ur._modules,p=0,R=Z.length;R>p;p++)i=Z[p],i.undoInject(g)};var wm=v.graph.EditInteractor=function(o){var N=this,H=j.createElement("canvas");H.className="editCanvas",H.style.position="absolute",N._styleMap={},N._canvas=H,N._context=H.getContext("2d"),wm.superClass.constructor.call(N,o),this._editDetail=!1,em.setAntialias(N._context,!1),N._subModules=[new em.Anchor(N),new em.RotateX(N),new em.MoveDummy(N),new em.Rect(N),new em.Curve(N),new em.MoveHelper(N)],N._gridGuide=new em.Guide.Grid(N),N._rectGuide=new em.Guide.Rect(N),N._hoverGuide=new em.Guide.Hover(N)},tb=wm;v.Default.def(wm,v.graph.Interactor,{ms_edit:1,ms_fire:1}),I.defineProperties(wm.prototype,{editDetail:{get:function(){var p=!!this._editDetail;return p},set:function(k){var L=this,E=L._editDetail;E!==k&&(L._editDetail=k,L.gv._editing=k,L.fp("editDetail",E,k),L.fp("pointsEditingMode",E,k),L.fi({kind:k?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(I){(!this._editDetail||I)&&(this.gv._editing=I,I||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(i){this._editing=i,this.gvEditing=i}},pointsEditingMode:{get:function(){return this.editDetail},set:function(Q){var h=this;h.editDetail!==Q&&(Q?h._tryEnterEditDetailMode():h._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var I=this._gridEnabled;if(!I)return!1;var z=this.gv;return z?!0:!0},set:function(x){x!==this._gridEnabled&&(this._gridEnabled=x,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(G){G!==this._agEnabled&&(this._agEnabled=G,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),wm.prototype.getSubModule=function(o){var R,Y,T,n=this._subModules;for(Y=0,T=n.length;T>Y;Y++)if(R=n[Y],R.catalog===o)return R},wm.prototype.invokeSubModule=function(l,p){var b=this,t=b._subModules;if(t)for(var B,N,E,u=Array.prototype.slice.call(arguments,2),O=0,g=t.length;g>O;O++)if(B=t[O],N=B[l],N&&(E=N.apply(B,u),E!=i&&p))return B},wm.prototype.invokeSubModuleInverse=function(n,E){var z=this,P=z._subModules;if(P)for(var W,R,v,G=Array.prototype.slice.call(arguments,2),m=P.length-1;m>=0;m--)if(W=P[m],R=W[n],R&&(v=R.apply(W,G),v!=i&&E))return W},wm.prototype.setUp=function(){em.log("setUp");var j=this,Q=j.gv,x=Q.getView(),d=j._canvas;wm.superClass.setUp.call(j),Q.setEditInteractor(j),Q._79O?x.insertBefore(d,Q._79O):x.appendChild(d),em.startEdit(Q),j.invokeSubModule("setUp"),Q.dm().mm(j._onDataModelChanged,j),Q.dm().md(j._onDataPropertyChanged,j)},wm.prototype.tearDown=function(){em.log("tearDown");var d=this,z=d.gv,l=z.getView();d._resetCustomCursorStyle(),wm.superClass.tearDown.call(d),z.dm().umm(d._onDataModelChanged,d),z.dm().umd(d._onDataPropertyChanged,d),z.setEditInteractor(null),l.removeChild(d._canvas),d._drawTimer&&(f(d._drawTimer),d._drawTimer=null),em._46O(z),d.invokeSubModule("tearDown")},wm.prototype._onDataModelChanged=function(I){var p=this;("clear"===I.kind||"remove"===I.kind&&p.editDetail&&I.data===p.getSubModule("Curve").target)&&(p.editDetail=!1,p._42())},wm.prototype._onDataPropertyChanged=function(i){var d=this;if(d.editDetail){var f=d.getSubModule("Curve"),P=i.data;P===f.target&&(P._writing||f._handleDataChanged(i))}},wm.prototype.clear=function(){em.log("clear")},wm.prototype.redraw=function(){this._42()},wm.prototype._42=function(){var F=this;F._drawTimer||(F._drawTimer=_(function(){F._drawTimer=null,F.drawImpl()},0))},wm.prototype.drawImpl=function(){var P;for(P in{_42:!0})break;return function(){var N=this,H=N._canvas,A=N.gv,o=A.getWidth(),j=A.getHeight(),Z=N._context,S=v.Default.getInternal(),g=u.devicePixelRatio;(H.width!==o||H.height!==j)&&S.setCanvas(H,o,j,g),Z.clearRect(0,0,H.width,H.height);var L=N._getValidSelection();Z.save(),Z.scale(g,g),N._gridGuide._42(),N.invokeSubModuleInverse(P,!1,Z,A,L),N._rectGuide._42(),N._hoverGuide._42(),Z.restore()}}(),wm.prototype._getValidSelection=function(){var u=this,H=u.gv,F=H.sm().getSelection(),U=[];return F.each(function(K){H.isVisible(K)&&H.isEditable(K)&&U.push(K)}),U},wm.prototype.handle_touchmove=function(L){return this.handle_mousemove(L)},wm.prototype.handle_mousemove=function(L){if(!v.Default.isDragging()){var p=this;if((p.editDetail||!Dj()&&!yi(L))&&!p.gv._externalEditing)if(p.gvEditing=!1,p._checkEdit(L))p.gvEditing=!0;else{if(!p.getStyle("hoverGuideVisible"))return;p.hoverData=p.gv.getDataAt(L),p._42()}}},wm.prototype.handle_touchstart=function(z){return this.handle_mousedown(z)},wm.prototype.handle_mousedown=function(O){jm(O);var C=this;if((C.editDetail||!Dj()&&!yi(O))&&!C.gv._externalEditing){if(Bo(O)&&!O.clickThrough){if(C.editDetail){if(C._tryQuitEditDetailMode(O))return}else if(C._tryEnterEditDetailMode())return;C.gv.dm().beginTransaction();var K=C.invokeSubModule("handleDoubleClick",!0,O);if(C.gv.dm().endTransaction(),K)return}var i=C._checkEdit(O);i&&(C._downPosition=C._getLogicalPoint(O),C.gv.dm().beginTransaction(),i.startEdit(C,O),C.editing=!0)}},wm.prototype._checkEdit=function(s){var f=this,F=f.gv,R=f._getLogicalPoint(s),T=f.invokeSubModule("check",!0,F,s,R)||null;return f._editMod=T,T},wm.prototype.handleWindowTouchMove=function(w){return this.handleWindowMouseMove(w)},wm.prototype.handleWindowMouseMove=function(f){var F=this,P=F._downPosition;if(P){var h=F._getLogicalPoint(f);if(h.distanceTo(P)<F.getStyle("moveSensitivity"))return;delete F._downPosition}var $=F._editMod;$&&$.handleEdit(F.gv,f)},wm.prototype._getLogicalPoint=function(T){var B=this,C=v.Default.getLogicalPoint(T,B._canvas);return new em.Math.Vector2(C)},wm.prototype.handleWindowTouchEnd=function(Q){return this.handleWindowMouseUp(Q)},wm.prototype.handleWindowMouseUp=function(){var b;for(b in{_46O:!0})break;return function(S){var m=this;m.editing=!1,m.setCursor("default"),m.invokeSubModule(b,!1,S),m._42(),m.gv.dm().endTransaction()}}(),wm.prototype.handle_mousewheel=function(i){var l=this;jm(i),l.invokeSubModule("preHandleScroll",!0)||l.gv.handleScroll(i,i.wheelDelta)},wm.prototype.handleDelete=function(){var G=this;if(!G.editDetail){G.gv.dm().beginTransaction();var F=G.invokeSubModule("handleNormalStateDelete",!0);return G.gv.dm().endTransaction(),F||G.gv.removeSelection(),void 0}G.gv.dm().beginTransaction(),G.invokeSubModule("handleDelete",!0),G.gv.dm().endTransaction(),G._42()},wm.prototype.handle_keydown=function(O){var h=this;if((O.metaKey||O.ctrlKey)&&h._42(),Dj(O)&&!h.editing)return h.gvEditing=!1,h.setCursor("default"),h._42(),void 0;var u=np(O);return h.editDetail?((u||Gr(O))&&(h.editDetail=!1,h._42()),h.gv.dm().beginTransaction(),h.invokeSubModule("handle_keydown",!0,O),h.gv.dm().endTransaction(),void 0):(h.gv.dm().beginTransaction(),h.invokeSubModule("handleNormalStateKeyDown",!0,O),h.gv.dm().endTransaction(),u&&h._tryEnterEditDetailMode(),void 0)},wm.prototype.handle_keyup=function(z){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,z),this.gv.dm().endTransaction()},wm.prototype._tryEnterEditDetailMode=function(){var U=this;return!U.editDetail&&U.invokeSubModule("canEnterEditDetailMode",!0)&&1===U._getValidSelection().length?(U.editDetail=!0,U._42(),!0):void 0},wm.prototype._tryQuitEditDetailMode=function(v){var Q=this;return Q.editDetail?!v||Q.invokeSubModule("canQuitEditDetailMode",!0,v)?(Q.editDetail=!1,Q._42(),!0):!1:!1},wm.prototype.setStyle=function(h,P,Y){var U=this;Y?em.setStyle(h,P):U._styleMap[h]=P,"baseColor"===h&&(Wh=P),U.fp("styleChanged",null,{key:h,value:P,base:Y}),U._42()},wm.prototype.getStyle=function(t){var $=this,w=$._styleMap[t];return w!==i?w:em.getStyle(t)},wm.prototype.setCursor=function(p){this._resetCustomCursorStyle(),v.graph.EditInteractor.superClass.setCursor.call(this,p)},wm.prototype._resetCustomCursorStyle=function(){var o=this;if(o._customStyle){var P=this.gv.getView();P.classList&&P.classList.remove&&P.classList.remove(o._customStyle),o._customStyle=null}},wm.prototype._setRotateCursor=function(j){var C=this,t=C._cursorFactory;t||(t=C._cursorFactory=new em.CursorFactory(C));var F=t.getRotateCursor(j),J=C.gv.getView();C._resetCustomCursorStyle(),C._customStyle=F,J.classList&&J.classList.add&&J.classList.add(F)};var he=em.Group=function(e){var X=this;X._entities=e,X._64O=0,X._position={x:0,y:0},X._scale={x:1,y:1},X._anchor={x:.5,y:.5},X._anchor2={x:.5,y:.5}};he.prototype={},he.prototype.constructor=he;var Gk=null;he.findOrCreateGroup=function(J){if(Gk&&Gk.checkIsMe(J))return Gk;var u=new em.Group(J);return u.getKeyOb()?(Gk=u,u):void 0},he.prototype.checkIsMe=function(B){var o=this._entities;if(o.length!==B.length)return!1;var H,z={},p=B.length;for(H=0;p>H;H++)z[B[H]._id]=!0;for(H=0;p>H;H++)if(!z[o[H]._id])return!1;return!0},he.prototype.getRotation=function(){return this._64O},he.prototype.getPosition=function(){return this._position},he.prototype.getAnchor=function(){return this._anchor},he.prototype.getWidth=function(){return this._width},he.prototype.getScale=function(){return this._scale},he.prototype.getSize=function(){return{width:this._width,height:this._height}},he.prototype.getHeight=function(){return this._height},he.prototype.getKeyOb=function(){for(var n=this._entities,Z=n.length-1;Z>=0;Z--){var m=n[Z];if(this.isNode(m))return m}},he.prototype.getAnchor2=function(){var o=this,F=o.rotateCenter;if(F)return F;var J=o.getKeyOb();if(!J)return o._anchor;var U=o._anchor2,t=J.getMatrix();return t.tf({x:J.getWidth()*(U.x-J.getAnchor().x),y:J.getHeight()*(U.y-J.getAnchor().y)})},he.prototype.setAnchor2=function(E,K){var Q=this,b=Q.getKeyOb();if(b){var P,w=b.getMatrix();P="number"==typeof E?{x:E,y:K}:E;var g=w.tfi(P);Q._anchor2={x:b.getAnchor().x+g.x/b.getWidth(),y:b.getAnchor().y+g.y/b.getHeight()}}},he.prototype.setRotation=function(){},he.prototype.beginRotate=function(L){this.rotateCenter=L.pos,this.rotateMode=L.groupRotateMode},he.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},he.prototype.addRotation=function(w,z,d){return"batch"===z?this._addRotationInBatchMode(w,d):"block"===z?this._addRotationInBlockMode(w,d):void 0},he.prototype._addRotationInBlockMode=function(Y,C){var m=this,i=m.rotateCenter||m.getPosition();m._entities.forEach(function(L){if(m.isNode(L)&&(!C||C(L))){var y=L.getMatrix();y.translate(-i.x,-i.y),y.rotate(Y),y.translate(i.x,i.y);var s=Math.sign(L.getScale().x);L.setRotation(T(y.b*s,y.a*s)),L.setPosition(y.tx,y.ty)}})},he.prototype._addRotationInBatchMode=function(p){var W=this,j=W._anchor2;W._entities.forEach(function(g){if(W.isNode(g)&&(!filter||filter(g))){var O=g.getAnchor(),n=g.getMatrix(),v=n.tf({x:g.getWidth()*(j.x-O.x),y:g.getHeight()*(j.y-O.y)}),C=new em.Math.Matrix2d;C.set(n.a,n.b,n.c,n.d,n.tx,n.ty),C.translate(-v.x,-v.y),C.rotate(p),C.translate(v.x,v.y);var N=Math.sign(g.getScale().x);g.setRotation(T(C.b*N,C.a*N)),g.setPosition(C.tx,C.ty)}})},he.prototype.setPosition=function(y){var r,C,G,F,X=this,c=X._position,d=y.x-c.x,w=y.y-c.y,v=X._entities;for(C=0,G=v.length;G>C;C++)r=v[C],gr(r)&&(F=r.getPosition(),r.setPosition(F.x+d,F.y+w));X._position=y},he.prototype.setScale=function(x,j){var L=this,Z=x/L._scale.x,R=j/L._scale.y;L._adjustChildScaleOrSize(Z,R,"size"),L._scale={x:x,y:j}},he.prototype.getRect=function(){var C=this,f=C._position,$=C._width,c=C._height;return{x:f.x-$/2,y:f.y-c/2,width:$,height:c}},he.prototype.setSize=function(Z,Y){var j=this,Z=Math.max(1,Z),Y=Math.max(1,Y),N=Z/j._width,T=Y/j._height;j._adjustChildScaleOrSize(N,T,"size"),j._width=Z,j._height=Y},he.prototype._adjustChildScaleOrSize=function(X,O,b){var j,v,x,L,P,c,I,W,f,M,y,H,E,N,q=this,k=q._position,_=q._entities,t=new em.Math.Matrix2d;for(v=0,x=_.length;x>v;v++)if(j=_[v],q.isNode(j)){if(L=j.getPosition(),P=j.getRotation(),c=j.getWidth(),I=j.getHeight(),W=j.getScale(),y=W.x*c,H=W.y*I,t.identity().scale(y,H).rotate(P).translate(L.x,L.y).translate(-k.x,-k.y).rotate(-q._64O),P=T(t.b*Math.sign(y),t.a*Math.sign(y)),t.scale(X,O),f=Math.cos(P),M=Math.sin(P),Math.abs(f)<.001?(E=t.b/M,N=-t.c/M):(E=t.a/f,N=t.d/f),"scale"===b)j.setScale(E/c,N/I);else if("size"===b){var z=E/W.x,s=N/W.y;j.setScale(Jn(E)*Math.abs(W.x),Jn(N)*Math.abs(W.y)),j.setSize(Math.max(.1,Math.abs(z)),Math.max(.1,Math.abs(s)))}t.rotate(q._64O).translate(k.x,k.y),j.setPosition(t.tx,t.ty)}},he.prototype.getMatrix=function(){var u=this,S=u._position,j=v.Default.getInternal(),b=u._scale;return new j.Mat(u._64O,S.x,S.y,b.x,b.y)},he.prototype.toGlobal=function(e){return this.getMatrix().tf(e)},he.prototype.getCorners=function(){var R=this,W=R._width,P=R._height,F=R._anchor,c=-W*F.x,a=-P*F.y,L=R.getMatrix();return[L.tf(c,a),L.tf(c,a+P),L.tf(c+W,a+P),L.tf(c+W,a)]},he.prototype.calcInfo=function(){var o,J,w,v,U,x,c=this,z=[],m=c._entities,O=c._64O;for(v=0,U=m.length;U>v;v++)x=m[v],c.isNode(x)&&x.getCorners&&z.push.apply(z,x.getCorners());if(z.length){var t=Math.cos(-O),p=Math.sin(-O),l=1/0,y=-1/0,E=1/0,S=-1/0;for(v=0,U=z.length;U>v;v++)w=z[v],o=w.x,J=w.y,w.x=t*o-p*J,w.y=p*o+t*J,l=Math.min(l,w.x),y=Math.max(y,w.x),E=Math.min(E,w.y),S=Math.max(S,w.y);c._width=(y-l)/c._scale.x,c._height=(S-E)/c._scale.y,t=Math.cos(O),p=Math.sin(O);var g=c._anchor;o=l+(y-l)*g.x,J=E+(S-E)*g.y,c._position={x:t*o-p*J,y:p*o+t*J}}},he.prototype.isNode=function(q){return gr(q)?eg(q)?!1:!0:!1},he.prototype._42=function(u,d,b){var a,M,v,G,i,B,w,z,X=this,W=X._entities,J=X.rotateMode;for("batch"===J&&(z=X.getKeyOb()),a=0,M=W.length;M>a;a++)v=W[a],X.isNode(v)&&(B=v.getRect(),G=em.toScreenPosition(b,{x:B.x,y:B.y}),i=em.toScreenPosition(b,{x:B.x+B.width,y:B.y+B.height}),w={min:G,max:i},v===z&&(w.isKeyOb=!0),em.Icons.DrawIcon(u,d,em.Icons.GroupSubEntityRect,w))};var Jr=em.CurveActiving=function(V,b){this._curve=V,this._interactor=V._interactor;for(var E in b)this[E]=b[E]};Jr.prototype={},Jr.prototype.constructor=Jr,I.defineProperties(Jr.prototype,{point:{get:function(){return this._point},set:function(Q){var A=this;A._point=Q,A.editingCtrl||A._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(G){var N=this;N._pairs=G,N.editingCtrl&&N._firePointChange()}}}),Jr.prototype._firePointChange=function(){var L=this,z=L.getCurrentEditingPoint(),q=L._interactor;if(!z)return q.fi({kind:"selectPoint"}),void 0;var P=this._curve.target;if(P){var b=em.getDataMatrix(P).invert(),N=z.e;z=b.apply(em.toWorldPosition(q.gv,z)),z.e=N;var A=L._lastFirePoint;A&&Math.abs(z.x-A.x)<1e-5&&Math.abs(z.y-A.y)<1e-5&&(z.e==i&&A.e==i||Math.abs(z.e-A.e)<1e-5)||(L._lastFirePoint=z,q.fi({kind:"selectPoint",x:z.x,y:z.y,e:z.e}))}},Jr.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Jr.prototype.getCurrentEditingPoint=function(){var T=this,c=T.editingCtrl;if(c){var f=T.pairs;if(f){var L=f[c.pairId],y=L[c.type];if(y)return y}}return T._point};var ih=em.CursorFactory=function(K){var l=this;l._interactor=K,l._rotateCursorStyles={}};ih.prototype={},ih.prototype.constructor=ih,ih.prototype.getRotateCursor=function(C){var E=this;0>C&&(C+=2*Math.PI);var t=E._interactor,I=t.getStyle("rotateCursorSize"),L=t.getStyle("rotateCursorRound"),G=Math.round(180*(C/Math.PI)/L);G*L>=360&&(G=0);var D=E._rotateCursorStyles,H="htCustomRotateStyle_"+I+"_"+L+"_"+G;return D[H]||(E._produceRotateCursor(H,I,L,G),D[H]=!0),H},ih.prototype._produceRotateCursor=function(Y,V,$,H){var L=this;L._interactor;var n=L._canvas;n||(n=L._canvas=j.createElement("canvas")),n.width=n.height=V*devicePixelRatio,n.style.width=n.style.height=V+" px";var u=n.getContext("2d");em.setAntialias(u,!1),u.scale(devicePixelRatio,devicePixelRatio);var l,U,N,Z,Q,x=Math.round(V/2),G=""+x+" "+x+",auto !important;",S=4;l=Math.PI/180*H*$,u.clearRect(0,0,V,V),u.save(),u.scale(V/32,V/32),u.translate(16,15),u.rotate(l+Math.PI/2),u.beginPath(),u.moveTo(-8,0),u.lineTo(-8,S),u.lineTo(-8+S,S),u.moveTo(8,0),u.lineTo(8,S),u.lineTo(8-S,S),u.moveTo(-8,S),u.quadraticCurveTo(0,-6,8,S),u.restore(),u.lineCap="round",u.lineJoin="miter",u.strokeStyle="white",u.lineWidth=4,u.stroke(),u.strokeStyle="black",u.lineWidth=2,u.stroke(),U=JSON.stringify(n.toDataURL()),Z="cursor:url("+U+")"+G,1!==devicePixelRatio&&(N='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+V+'px" height="'+V+'px"><image xlink:href='+U+' width="'+V+'" height="'+V+'"/></svg>',Z+="cursor:url(data:image/svg+xml;base64,"+btoa(N)+")"+G,Z+="cursor:-webkit-image-set(url("+U+")"+devicePixelRatio+"x,url("+U+")1x)"+G),Q=j.createElement("style"),Q.textContent="body."+Y+" *, ."+Y+"{"+Z+"}",j.head.appendChild(Q)};var Jc=em.Guide.Grid=function(I){var L=this;L._interactor=I,L._alignmentGuideId=0,L._xAlignmentGuide=[],L._yAlignmentGuide=[]};Jc.prototype={},Jc.prototype.constructor=Jc,I.defineProperties(Jc.prototype,{gridBlockSize:{get:function(){var $=this;return $._gridBlockSize||$._interactor.getStyle("gridBlockSize")},set:function(R){this._gridBlockSize=R,this._interactor._42()}},gridThickLinesEvery:{get:function(){var o=this;return o._gridThickLinesEvery||o._interactor.getStyle("gridThickLinesEvery")},set:function(I){this._gridThickLinesEvery=I,this._interactor._42()}},gridEnabled:{get:function(){var k=this,W=k._interactor;return W.gridEnabled&&k.isValidGrid()}}}),Jc.prototype._42=function(){var L=this,K=L._interactor;L.gridEnabled&&L.drawGrid(),K.alignmentGuideEnabled&&L.drawAlignmentGuide()},Jc.prototype.makeMatrix=function(){var f=this,G=f._interactor.getStyle("gridAngle"),C=f._interactor.getStyle("gridRotation"),l=new em.Math.Matrix2d,h=Math.sin(G),Q=Math.cos(G);return l.set(1,0,Q,h,0,0),l.rotate(C),l},Jc.prototype.isValidGrid=function(){var X=this,C=Math.PI,u=X._interactor,g=u.gv;if(g._zoom<u.getStyle("gridZoomThreshold"))return!1;var D=u.getStyle("gridAngle"),S=Math.abs(180*(D%C/C)),F=1-1e-8;return F>S||S>180-F?!1:!0},Jc.prototype.drawAlignmentGuide=function(){var w=this,n=w._interactor,c=n.gv,k=n._canvas,Q=n._context,d=k.width,i=k.height,m=c.tx(),G=c.ty(),O=c._zoom;Q.beginPath(),Q.strokeStyle=n.getStyle("gridAlignmentGuideColor"),Q.lineWidth=1,w._xAlignmentGuide.forEach(function(W){var J=W.p*O+m;Q.moveTo(J,0),Q.lineTo(J,i)}),w._yAlignmentGuide.forEach(function(w){var $=w.p*O+G;Q.moveTo(0,$),Q.lineTo(d,$)}),Q.stroke()},Jc.prototype.drawGrid=function(){function D(o,y,x,j){var i=em.toScreenPosition(g,v.apply({x:o,y:y})),h=em.toScreenPosition(g,v.apply({x:x,y:j}));m.moveTo(i.x,i.y),m.lineTo(h.x,h.y)}var x=this,B=x._interactor,X=x.gridBlockSize,N=x.gridThickLinesEvery,h=B.getStyle("gridThickColor"),l=B.getStyle("gridLightColor"),g=B.gv,C=B._canvas,m=B._context,Q=C.width,n=C.height,v=x.makeMatrix(),P=v.applyInverse(em.toWorldPosition(g,{x:0,y:0})),z=v.applyInverse(em.toWorldPosition(g,{x:Q,y:0})),d=v.applyInverse(em.toWorldPosition(g,{x:0,y:n})),i=v.applyInverse(em.toWorldPosition(g,{x:Q,y:n})),o=Math.min(P.x,z.x,d.x,i.x),b=Math.max(P.x,z.x,d.x,i.x),U=Math.min(P.y,z.y,d.y,i.y),q=Math.max(P.y,z.y,d.y,i.y);Q=b-o,n=q-U;var S=Math.ceil(o/X),e=Math.floor(b/X),H=Math.ceil(U/X),L=Math.floor(q/X);g.tx(),g.ty(),g._zoom;var J,c,M;for(m.save(),m.lineWidth=1,m.beginPath(),m.strokeStyle=h,M=Math.ceil(S/N)*N;e>=M;M+=N)J=M*X,D(J,U,J,q);for(M=Math.ceil(H/N)*N;L>=M;M+=N)c=M*X,D(o,c,b,c);for(m.stroke(),m.beginPath(),m.strokeStyle=l,M=S;e>=M;M++)0!==M%N&&(J=M*X,D(J,U,J,q));for(M=H;L>=M;M++)0!==M%N&&(c=M*X,D(o,c,b,c));m.stroke(),m.restore()},Jc.prototype.getAlignmentGuides=function(){var U=this;return{x:U._xAlignmentGuide,y:U._yAlignmentGuide}},Jc.prototype.addAlignmentGuide=function(i,d,J){var z=this,k="x"===i?z._xAlignmentGuide:z._yAlignmentGuide,J=J?J:++z._alignmentGuideId,h={p:d,id:J};if(k.length){var W=z._findClosestAlignmentGuide(h.p,k);W.dis<0?k.splice(W.index+1,0,h):k.splice(W.index,0,h)}else k.push(h);return z._interactor._42(),J},Jc.prototype.findClosest=function(F,n,j){var X=this,z=X._interactor,H=z.gv;j&&(F=em.toWorldPosition(H,F));var h,t,A,V=1/0,_=1/0,o=F.x,O=F.y;if(X.gridEnabled){var U=X.gridBlockSize,l=X.makeMatrix(),P=l.applyInverse(F);P=l.apply({x:Math.round(P.x/U)*U,y:Math.round(P.y/U)*U}),V=P.x-o,_=P.y-O,A=!0}if(z.alignmentGuideEnabled&&(h=X._findClosestAlignmentGuide(o,X._xAlignmentGuide).dis,t=X._findClosestAlignmentGuide(O,X._yAlignmentGuide).dis,Math.abs(h)<Math.abs(V)&&(V=h,A=!0),Math.abs(t)<Math.abs(_)&&(_=t,A=!0)),A){A=!1;var W=H._zoom,c=z.getStyle("smartGuideThreshold")/W,a={};if(Math.abs(V)<c&&"y"!==n&&(a.x=j?V*W:V,A=!0),Math.abs(_)<c&&"x"!==n&&(a.y=j?_*W:_,A=!0),A)return a}},Jc.prototype._findClosestAlignmentGuide=function(T,k){if(!k.length)return{dis:1/0};for(var _,G=0,n=k.length-1;n-G>1;)_=Math.floor((G+n)/2),k[_].p<T?G=_:n=_;var u=k[G].p-T,S=k[n].p-T;return Math.abs(u)<=Math.abs(S)?{line:k[G],dis:u,index:G}:{line:k[n],dis:S,index:n}},Jc.prototype.removeAllAlignmentGuide=function(F){var O=this;"y"!==F&&(O._xAlignmentGuide=[]),"x"!==F&&(O._yAlignmentGuide=[]),O._interactor._42()},Jc.prototype.removeAlignmentGuide=function(W){for(var D,E,c,r=this,n=r._xAlignmentGuide,l=0;2>l;l++)for(n=0===l?r._xAlignmentGuide:r._yAlignmentGuide,D=0,E=n.length;E>D;D++)if(c=n[D],c.id===W)return n.splice(D,1),r._interactor._42(),{axis:0===l?"x":"y",position:c.p};return!1},Jc.prototype.adjustAlignmentGuide=function(D,w){var S=this,c=S.removeAlignmentGuide(D);return c?(S.addAlignmentGuide(c.axis,w,D),!0):!1};var sl=em.Guide.Rect=function(k){var d=this;d._interactor=k};sl.prototype={},sl.prototype.constructor=sl,sl.prototype.gatherRects=function(){var S,o,d,B,r=this,L=r._interactor.gv,H=[],n=[],y={x:H,y:n},Q={},P=L.getDataModel(),q=P.a("width"),I=P.a("height");q&&I&&(S=0,o=0,d=q,B=I,H.push({node:P,type:0,p:S},{node:P,type:1,p:S+d/2},{node:P,type:2,p:S+d}),n.push({node:P,type:0,p:o},{node:P,type:1,p:o+B/2},{node:P,type:2,p:o+B}),Q[P._id||0]={x:S,y:o,width:d,height:B}),P.each(function(Z){if(gr(Z)&&!L.isSelected(Z)&&L.isVisible(Z)&&L.isValidGuideLineSource(Z)){var E=!1;if(L.sm().getSelection().each(function(h){E||(Z.isHostOn(h)?E=!0:Z.isDescendantOf(h)&&(E=!0))}),!E){var O=Z.getRect();S=O.x,o=O.y,d=O.width,B=O.height,H.push({node:Z,type:0,p:S},{node:Z,type:1,p:S+d/2},{node:Z,type:2,p:S+d}),n.push({node:Z,type:0,p:o},{node:Z,type:1,p:o+B/2},{node:Z,type:2,p:o+B}),Q[Z._id]=O}}}),H.sort(function(j,I){return j.p-I.p}),n.sort(function(y,I){return y.p-I.p}),r._grid=y,r._87I=Q},sl.prototype.gatherLines=function(u,X,f){var z,J,Y,H,P,A,m,V,$,N,s,M,E=this,T=[E.findClosest({x:u.x,y:u.y},X),E.findClosest({x:u.x+u.w/2,y:u.y+u.h/2},X),E.findClosest({x:u.x+u.w,y:u.y+u.h},X)],F={},p=E._87I;f=f||255;var b,I;for(E._guideLine=[],z=0;2>z;z++)for(F={},0===z?(H="y",V=u.x,$=V+u.w):(H="x",V=u.y,$=V+u.h),J=0;3>J;J++)P=T[J],P&&isFinite(P[H])&&(b=1<<3*z+J,f&b&&(A=P[H+"Line"],m=A.node,I=m._id||0,F[I]||(F[I]=!0,M=p[I],"y"===H?(N=M.x,s=M.x+M.width):(N=M.y,s=M.y+M.height),Y=A.p,E._guideLine.push({type:H,a:V,b:$,c:N,d:s,p:Y,center:1===A.type}))))},sl.prototype._binarySearchClosest=function(K,e){if(!e.length)return{dis:1/0};for(var q,Q=0,m=e.length-1;m-Q>1;)q=Math.floor((Q+m)/2),e[q].p<K?Q=q:m=q;var d=e[Q].p-K,_=e[m].p-K;return Math.abs(d)<=Math.abs(_)?{line:e[Q],dis:d}:{line:e[m],dis:_}},sl.prototype.findClosest=function(Y,n,t){var X=this,V=X._interactor,k=V.gv,o=X._grid;t&&(Y=em.toWorldPosition(k,Y));var D,O=X._binarySearchClosest(Y.x,o.x),j=X._binarySearchClosest(Y.y,o.y),S=O.dis,H=j.dis,C=k._zoom,y=V.getStyle("smartGuideThreshold")/C,v={};return Math.abs(S)<y&&"y"!==n&&(v.x=t?S*C:S,v.xLine=O.line,D=!0),Math.abs(H)<y&&"x"!==n&&(v.y=t?H*C:H,v.yLine=j.line,D=!0),D?v:void 0},sl.prototype._42=function(){var S=this,W=S._guideLine;if(W&&!v.Default.isCtrlDown()){var d=S._interactor;if(d.getStyle("guideLineVisible")){var K,k,y,P,s,m,Y,A,u,f,r,e,g,i,_,N,t,D=d.gv,V=d._context,j=D.tx(),E=D.ty(),z=D._zoom,M=d.getStyle("guideLineTextSpacing");for(K=0,k=W.length;k>K;K++)y=W[K],A=y.type,u=y.p,f=y.a,r=y.b,e=y.c,g=y.d,i=Math.min(f,e),_=Math.max(r,g),"x"===A?(P=u*z+j,s=i*z+E,m=P,Y=_*z+E):(P=i*z+j,s=u*z+E,m=_*z+j,Y=s),em.Icons.DrawIcon(d,V,em.Icons.MoveLineGuide,{rect:[P,s,m,Y],center:y.center}),g>=f&&r>=e||(i=f>g?g:r,_=f>g?f:e,t=_-i,"x"===A?(y.center2center||(P-=M,m=P),s=i*z+E,Y=_*z+E,N=em.Icons.MoveLineGuideDistanceV):"y"===A&&(y.center2center||(s-=M,Y=s),P=i*z+j,m=_*z+j,N=em.Icons.MoveLineGuideDistanceH),em.Icons.DrawIcon(d,V,N,{x0:P,y0:s,x1:m,y1:Y,dis:t}))}}},sl.prototype.clear=function(){this._guideLine=null};var js=em.Guide.Hover=function(z){var C=this;C._interactor=z};js.prototype={},js.prototype.constructor=js,I.defineProperties(js.prototype,{}),js.prototype._42=function(){var t=this._interactor;if(t.getStyle("hoverGuideVisible")&&!t.gvEditing){var m=t.hoverData,k=t.gv;if(!gr(m)||k.isSelected(m))return t.hoverData=null,void 0;var A=je(k,m),P=em.toScreenPosition(k,{x:A.x,y:A.y}),F=em.toScreenPosition(k,{x:A.x+A.width,y:A.y+A.height});em.Icons.DrawIcon(t,t._context,em.Icons.HoverDataRect,{min:P,max:F,color:t.getStyle("hoverGuideColor")||t.getStyle("baseColor")})}},em.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var gl=em.Icons={},If=1e4,Nd=null,Wh=em.DefaultStyleMap.baseColor,Nk="rgb(183,232,135)",tm="rgb(255,204,153)",om=6;v.Default.setImage("Icons.RectPoint",{width:om,height:om,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Wh}},rect:[0,0,om,om]}]}),gl.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var K=gl.GroupSubEntityRect.data;if(!K)return[];var c=K.min,o=K.max;return[c.x,c.y,c.x,o.y,o.x,o.y,o.x,c.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return gl.GroupSubEntityRect.data.isKeyOb?Wh:Wh}}}]};var Tg=4;gl.HoverDataRect={comps:[{type:"shape",points:{func:function(){var D=gl.HoverDataRect.data;if(!D)return[];var h=D.min,e=D.max,V=Tg;return h.x-=V,h.y-=V,e.x+=V,e.y+=V,[h.x,h.y,h.x,e.y,e.x,e.y,e.x,h.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return gl.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},gl.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[gl.Line.data.P1.x,gl.Line.data.P1.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[gl.Line.data.P2.x,gl.Line.data.P2.y],om,om]}}}]},gl.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return gl.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},gl.Rect={comps:[{type:"shape",points:{func:function(){var v=gl.Rect.data;if(!v)return[];var U=v.LT,i=v.LB,_=v.RB,C=v.RT;return[U.x,U.y,i.x,i.y,_.x,_.y,C.x,C.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Wh}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},rect:{func:function(){return[[gl.Rect.data.LT.x,gl.Rect.data.LT.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},rect:{func:function(){return[[gl.Rect.data.LB.x,gl.Rect.data.LB.y],om,om]
}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},rect:{func:function(){return[[gl.Rect.data.RB.x,gl.Rect.data.RB.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},rect:{func:function(){return[[gl.Rect.data.RT.x,gl.Rect.data.RT.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},visible:{func:function(){return gl.Rect.data.L?!0:!1}},rect:{func:function(){return[[gl.Rect.data.L.x,gl.Rect.data.L.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},visible:{func:function(){return gl.Rect.data.R?!0:!1}},rect:{func:function(){return[[gl.Rect.data.R.x,gl.Rect.data.R.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},visible:{func:function(){return gl.Rect.data.T?!0:!1}},rect:{func:function(){return[[gl.Rect.data.T.x,gl.Rect.data.T.y],om,om]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return gl.Rect.data.rotation}},visible:{func:function(){return gl.Rect.data.B?!0:!1}},rect:{func:function(){return[[gl.Rect.data.B.x,gl.Rect.data.B.y],om,om]}}}]};var Oj=16;v.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Wh}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Wh}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),gl.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[gl.Anchor.data.POS.x,gl.Anchor.data.POS.y],Oj,Oj]}}}]},gl.TipShiftX=12,gl.TipShiftY=12;var df=[8,28];gl.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[gl.TipHelper.data.helperPos.x,gl.TipHelper.data.helperPos.y,df[0]*gl.TipHelper.data.size,df[1]]}},background:{func:function(){return Nd.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return gl.TipHelper.data.text}},rect:{func:function(){return[gl.TipHelper.data.helperPos.x,gl.TipHelper.data.helperPos.y,df[0]*gl.TipHelper.data.size,df[1]]}},color:{func:function(){return Nd.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var xs=7;gl.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!gl.ShapePoint.data.dynamicVisible}},rect:{func:function(){var n=gl.ShapePoint.data.point,T=gl.ShapePoint.data.size||xs;return[n,T+10,T+10]}},background:{func:function(){var u=Date.now(),Y=gl.ShapePoint.data.dynamicPeriod||1500,Q=Math.sin(u%Y/Y*Math.PI);return"rgba(27,124,22,"+.5*Q+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var v=gl.ShapePoint.data.point,w=gl.ShapePoint.data.size||xs;return[v,w,w]}},background:{func:function(){var h=gl.ShapePoint.data.isEnd;return h?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return gl.ShapePoint.data.color||Wh}}},{type:"rect",visible:{func:function(){return!!gl.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Wh}},rect:{func:function(){var z=5;return[gl.ShapePoint.data.point,z,z]}}}]},gl.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!gl.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return gl.ShapeBgCurve.data.P}},segments:{func:function(){return gl.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var c=Date.now(),W=gl.ShapeBgCurve.data.dynamicPeriod||1500,q=Math.sin(c%W/W*Math.PI);return"rgba(27,124,22,"+.3*q+")"}}},{type:"shape",points:{func:function(){return gl.ShapeBgCurve.data.P}},segments:{func:function(){return gl.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return gl.ShapeBgCurve.data.color||Wh}}}]};var sq=8;gl.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var r=gl.ShapeHighlighPoint.data;return[[r.x,r.y],sq,sq]}},background:{func:function(){return Nd.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Me=10;gl.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var x=gl.ShapeHighlighRealPoint.data;return[[x.x,x.y],Me,Me]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Wh}}}]};var nl=8;gl.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var r=gl.ShapeHighlighCtrlPoint.data,J=r.x,$=r.y,w=nl/2;return[J-w,$-w,J-w,$+w,J+w,$+w,J+w,$-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Nd.getStyle("shapeCtrlPointBorderColor")||Wh}}}]};var aj=3;gl.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return gl.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:aj,borderColor:{func:function(){return Nd.getStyle("curveHighlightColor")}}}]},gl.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return gl.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},gl.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return gl.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return gl.MoveLineGuide.data.center?Nk:tm}}}]};var Oi=5;gl.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var K=gl.MoveLineGuideDistanceH.data,p=K.x0,j=K.y0;return[p,j-Oi,p,j+Oi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tm},{type:"shape",points:{func:function(){var $=gl.MoveLineGuideDistanceH.data,x=$.x1,n=$.y1;return[x,n-Oi,x,n+Oi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tm},{type:"text",text:{func:function(){return Math.round(gl.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var O=gl.MoveLineGuideDistanceH.data;return[[(O.x0+O.x1)/2,O.y0-10],20,20]}},color:tm,font:"12px Arial",align:"center"}]},gl.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var a=gl.MoveLineGuideDistanceV.data,O=a.x0,M=a.y0;return[O-Oi,M,O+Oi,M]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tm},{type:"shape",points:{func:function(){var B=gl.MoveLineGuideDistanceV.data,s=B.x1,l=B.y1;return[s-Oi,l,s+Oi,l]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tm},{type:"text",text:{func:function(){return Math.round(gl.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var t=gl.MoveLineGuideDistanceV.data;return[[t.x0-10,(t.y0+t.y1)/2],20,20]}},color:tm,font:"12px Arial",align:"center"}]},v.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),gl.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var p=gl.EdgeElevationGuide.data,$=p.x,O=p.y,L=Nd.getStyle("curveElevationIntersectSize"),R=Nd.getStyle("curveElevationGuideShift");return $+=R[0],O+=R[1],[$-L,O-L,2*L,2*L]}}}]},v.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),v.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),gl.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return gl.ConnectGuide.data.rotation}},rect:{func:function(){var m=gl.ConnectGuide.data.connect;m.x,m.y;var U=Nd.getStyle("connectGuideIntersectSize");return[[m.x,m.y],2*U,2*U]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var v=gl.ConnectGuide.data.cursorPos||gl.ConnectGuide.data.connect,c=Nd.getStyle("connectGuideIntersectSize");return[[v.x,v.y],2*c-2,2*c-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var m=gl.ConnectGuide.data.connect,h=gl.ConnectGuide.data.cursorPos||m;return[m.x,m.y,m.x+.5*(h.x-m.x),m.y,h.x+.5*(m.x-h.x),h.y,h.x,h.y]}}}]},v.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),v.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),gl.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var J=gl.ConnectGuideGarbage.data.hover;return J?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var M=gl.ConnectGuideGarbage.data,f=Nd.getStyle("connectGuideGarbageIntersectsize");return M.hover&&(f+=5),[[M.x,M.y],2*f,2*f]}}}]};var am=6;gl.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return gl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var w=gl.ShapeActivingCtrl.data;return[w.point.x,w.point.y,w.c1.x,w.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Wh}}},{type:"shape",visible:{func:function(){return gl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var I=gl.ShapeActivingCtrl.data;return[I.point.x,I.point.y,I.c2.x,I.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Wh}}},{type:"shape",visible:{func:function(){return gl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var E=gl.ShapeActivingCtrl.data.c1,Q=E.x,s=E.y,T=am/2;return"c1"===gl.ShapeActivingCtrl.data.hl&&(T+=.5),[Q-T,s-T,Q-T,s+T,Q+T,s+T,Q+T,s-T]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===gl.ShapeActivingCtrl.data.hl?Nd.getStyle("shapeCtrlPointHighlightBorder")||Wh:Nd.getStyle("shapeCtrlPointBorderColor")||Wh}}},{type:"shape",visible:{func:function(){return gl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var r=gl.ShapeActivingCtrl.data.c2,D=r.x,x=r.y,m=am/2;return"c2"===gl.ShapeActivingCtrl.data.hl&&(m+=.5),[D-m,x-m,D-m,x+m,D+m,x+m,D+m,x-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===gl.ShapeActivingCtrl.data.hl?Nd.getStyle("shapeCtrlPointHighlightBorder")||Wh:Nd.getStyle("shapeCtrlPointBorderColor")||Wh}}}]},gl.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Wh}},rect:{func:function(){return[[gl.RoundPoint.data.x,gl.RoundPoint.data.y],om,om]}}}]},gl.AttachPoint={comps:[{type:"rect",background:{func:function(){return gl.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Wh}},rect:{func:function(){var a=gl.AttachPoint.data.isAttach?om+4:om;return[[gl.AttachPoint.data.x,gl.AttachPoint.data.y],a,a]}}}]},gl.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return gl.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return gl.SimpleRect.data.color||Wh}},rect:{func:function(){var f=gl.SimpleRect.data;return[f.x,f.y,f.width,f.height]}}}]},v.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),gl.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var g=gl.MoveDummy.data;return[[g.pos.x,g.pos.y],2*g.size,2*g.size]}}}]},em.Icons.DrawIcon=function(Z,Q,P,g){P.width=P.height=If,P.data=g,Nd=Z,v.Default.drawImage(Q,P,0,0,If,If)},em.Icons.MapPoints=function(Z,d){for(var j=0,m=Z.length;m>j;j++)Z[j]/=d},em.roundTo=function(M,v,n){var S=Math.abs(M%v);return n>S||n>v-S?v*Math.round(M/v):M},em.toFixed=function(S){return Math.round(100*S)/100},em.getDataMatrix=function(Q){if(Q instanceof v.Shape){var i=new v.Math.Matrix2d,Y=Q.getPosition();return i.translate(-Y.x,-Y.y).scale(Q.getScale().x,Q.getScale().y).rotate(Q.getRotation()).translate(Y.x,Y.y),i}return Q.getMatrix?Q.getMatrix():new v.Math.Matrix2d};var Nr=em.Math.Curve=function(){this._curves=[]};Nr.prototype={},Nr.prototype.constructor=Nr,Nr.prototype.createFromHtShape=function($,_,x){_ instanceof v.List&&(_=_.toArray());var t,U,z,c,q,F,u,w=this,n=null,I=null,P=0,G=em.Math.Vector2,o=em.Math.CubicBezier,S=function(r){return new G($[r],$[r+1],x?x[r/2]:i)};for(U=0,z=_.length;z>U;U++){switch(c=_[U],q=null,c){case 1:I=S(P),n=I,P+=2;break;case 2:t=S(P),P+=2,q=new o(I,I.clone(),t.clone(),t),I=t;break;case 3:F=S(P),t=S(P+2),P+=4,q=new o(I,F.clone().sub(I).multiplyScalar(2/3).add(I),F.clone().sub(t).multiplyScalar(2/3).add(t),t),I=t;break;case 4:F=S(P),u=S(P+2),t=S(P+4),P+=6,q=new o(I,F,u,t),I=t;break;case 5:if(!n)break;q=new o(I,I.clone(),n.clone(),n),I=null,n=null}q&&(q._index=w._curves.length,w._curves.push(q))}},Nr.prototype.checkPoint=function(C,c){var R,J,N,r,v,m=this,M=m._curves;for(R=0,J=M.length;J>R;R++)if(r=M[R],v=r.intersectRect(C,c,c),v.length)return N=0,v.forEach(function(u){N+=u.t}),N/=v.length,C=r.getPointAt(N),C.t=N,{bezier:r,intersection:C}},Nr.prototype.insertKnot=function(f,e){var r=f.insertKnot(e),j=this,E=j._curves;E.splice(f._index,1,r[0],r[1])},Nr.prototype._isCloseEnough=function(b,N){return Math.abs(b.x-N.x)<1e-6&&Math.abs(b.y-N.y)<1e-6},Nr.prototype._isSamePoint=function(t,p){return t===p},Nr.prototype.moveRealPoint=function(F,X){var z=this,H=z._curves,O=X.clone().sub(F);H.forEach(function($){var i=$._p1;$._p2,$._p3;var P=$._p4;z._isSamePoint(i,F)&&($._p2.add(O),$._p1=X),z._isSamePoint(P,F)&&($._p3.add(O),$._p4=X)})},Nr.prototype.moveCtrlDueToRealPointMovement=function(f,K){var a=this,U=a._curves,i=function(I){I.add(K),I.e&&K.e&&(I.e+=K.e)};U.forEach(function(O){var e=O._p1;O._p2,O._p3;var U=O._p4;a._isSamePoint(e,f)&&i(O._p2),a._isSamePoint(U,f)&&i(O._p3)})},Nr.prototype.moveCtrlPoint=function(r,I,R){var L=r[R];if(L){L.e!==i&&(I.e=L.e);var q=this,K=q._curves;I.clone().sub(L),K.forEach(function(r){var l;"c2"===R?l="_p2":"c1"===R&&(l="_p3"),q._isSamePoint(r[l],L)&&(r[l]=I)}),r[R]=I}},Nr.prototype.deleteRealPoint=function(J,G){var B,E,p,b,m,I,Z,T=this,$=T._curves,H={},V=[],F=em.Math.CubicBezier;for(E=0,p=$.length;p>E;E++)B=$[E],b=B._p1,m=B._p2,I=B._p3,Z=B._p4,(H[E]||!T._isSamePoint(b,J))&&(T._isSamePoint(Z,J)?p>E+1&&T._isSamePoint($[E+1]._p1,J)&&(G||V.push(new F(b,m,$[E+1]._p3,$[E+1]._p4))):V.push(B));T._curves=V},Nr.prototype.findPairs=function(i,k){var H,C,D,Z,x,P,d,G,g=this,R=g._curves,y={},A=[];for(C=0,D=R.length;D>C;C++)H=R[C],Z=H._p1,x=H._p2,P=H._p3,d=H._p4,!y[C]&&g._isSamePoint(Z,i)&&(k?A.push({point:Z,r2:d}):A.push({point:Z,c2:x})),g._isSamePoint(d,i)&&(G=k?{point:d,r1:Z}:{point:d,c1:P},D>C+1&&g._isSamePoint(R[C+1]._p1,i)&&(k?G.r2=R[C+1]._p4:G.c2=R[C+1]._p2,y[C+1]=!0),A.push(G));return A},Nr.prototype.toHtShape=function(){var n=this,y=n._curves,u=[],J=[],e={x:1/0,y:1/0};return y.forEach(function(z){var E=z._p1,x=z._p2,A=z._p3,k=z._p4;return n._isCloseEnough(E,e)||(u.push(1),J.push(E.clone())),e=k,n._isCloseEnough(E,x)&&n._isCloseEnough(A,k)?(u.push(2),J.push(k.clone()),void 0):(u.push(4),J.push(x.clone(),A.clone(),k.clone()),void 0)}),{segments:u,points:J}};var bb=em.Math.CubicBezier=function(p,c,d,G){var V=this;V._id=em.Math.CubicBezier._globalId++,V._p1=p,V._p2=c,V._p3=d,V._p4=G};bb._globalId=1,bb.prototype={},bb.prototype.constructor=bb,bb.prototype.toString=function(){return this._id},bb.prototype.intersectRect=function(i,J,G){var K=J/2,l=G/2,g=i.x,F=i.y,E=em.Math.Vector2,q=new E(-K+g,-l+F),k=new E(K+g,l+F),d=new E(k.x,q.y),W=new E(q.x,k.y),A=this,U=A.intersectLine(q,d),R=A.intersectLine(d,k),b=A.intersectLine(k,W),t=A.intersectLine(W,q),a=U.concat(R).concat(b).concat(t);return a},bb.prototype.intersectLine=function(B,d){var n,k,h,$,a,G,X,s,q,S,V,T,L,C=this,z=B.clone().min(d),H=B.clone().max(d);$=C._p1,a=C._p2,G=C._p3,X=C._p4,n=$.clone().multiplyScalar(-1),k=a.clone().multiplyScalar(3),h=G.clone().multiplyScalar(-3),V=n.add(k).add(h).add(X),n=$.clone().multiplyScalar(3),k=a.clone().multiplyScalar(-6),h=G.clone().multiplyScalar(3),S=n.add(k).add(h),n=$.clone().multiplyScalar(-3),k=a.clone().multiplyScalar(3),q=n.add(k),s=$.clone(),L=new em.Math.Vector2(B.y-d.y,d.x-B.x),T=B.x*d.y-d.x*B.y;for(var U=C.getRoots(L.dot(V),L.dot(S),L.dot(q),L.dot(s)+T),Y=new Array,F=0,J=U.length;J>F;F++){var i=U[F];if(!(0>i||i>1)){var v=$.clone().lerp(a,i),M=a.clone().lerp(G,i),K=G.clone().lerp(X,i),u=v.lerp(M,i),N=M.lerp(K,i),R=u.lerp(N,i);R.t=i,B.x==d.x?z.y<=R.y&&R.y<=H.y&&Y.push(R):B.y==d.y?z.x<=R.x&&R.x<=H.x&&Y.push(R):R.x>=z.x&&R.y>=z.y&&R.x<=H.x&&R.y<=H.y&&Y.push(R)}}return Y},bb.prototype.solveTForPoint=function(T){var n,g,I,A,k=this;n=k._p1.x-T.x,g=k._p2.x-T.x,I=k._p3.x-T.x,A=k._p4.x-T.x;for(var G=k.getRoots(A-3*I+3*g-n,3*I-6*g+3*n,3*g-3*n,n),p=i,t=1/0,f=0,E=G.length;E>f;f++){var V=G[f];if(!(0>V||V>1)){var z=k._p1.clone().lerp(k._p2,V),F=k._p2.clone().lerp(k._p3,V),C=k._p3.clone().lerp(k._p4,V),d=z.lerp(F,V),J=F.lerp(C,V),e=d.lerp(J,V);e.t=V;var y=Math.abs(e.y-T.y);t>y&&(t=y,p=e)}}return p},bb.prototype.getPointAt=function(S){var Q=this,s=Q._p1,b=Q._p2,h=Q._p3,Y=Q._p4,V=s.clone().lerp(b,S),r=b.clone().lerp(h,S),G=h.clone().lerp(Y,S),m=V.lerp(r,S),T=r.lerp(G,S);return m.lerp(T,S)},bb.prototype.getRoots=function(R,r,u,J){var p,q,o,S,t,D=new Array;if(Math.abs(R)<1e-6){var p=r,q=u/p,o=J/p,S=q*q-4*o;if(S>0){var t=Math.sqrt(S);D.push(.5*(-q+t)),D.push(.5*(-q-t))}else 0==S&&D.push(.5*-q)}r/=R,u/=R,J/=R,p=(3*u-r*r)/3,q=(2*r*r*r-9*u*r+27*J)/27;var s=r/3,A=q*q/4+p*p*p/27,Z=q/2;if(Math.abs(A)<=1e-6&&(A=0),A>0){var W,c,t=Math.sqrt(A);W=-Z+t,c=W>=0?Math.pow(W,1/3):-Math.pow(-W,1/3),W=-Z-t,W>=0?c+=Math.pow(W,1/3):c-=Math.pow(-W,1/3),D.push(c-s)}else if(0>A){var n=Math.sqrt(-p/3),B=Math.atan2(Math.sqrt(-A),-Z)/3,j=Math.cos(B),C=Math.sin(B),w=Math.sqrt(3);D.push(2*n*j-s),D.push(-n*(j+w*C)-s),D.push(-n*(j-w*C)-s)}else{var W;W=Z>=0?-Math.pow(Z,1/3):Math.pow(-Z,1/3),D.push(2*W-s),D.push(-W-s)}return D},bb.prototype._70I=function(){var A=this;return A._p1.distanceToSquared(A._p2)<1e-10&&A._p3.distanceToSquared(A._p4)<1e-10},bb.prototype.insertKnot=function(L){var F=this,M=F._p1,X=F._p2,P=F._p3,o=F._p4,z=M.clone().lerp(X,L),d=X.clone().lerp(P,L),V=P.clone().lerp(o,L),A=z.clone().lerp(d,L),h=d.clone().lerp(V,L),J=A.clone().lerp(h,L);return F._70I()?(M.clone().lerp(o,L),[new em.Math.CubicBezier(M,M.clone(),J.clone(),J),new em.Math.CubicBezier(J,J.clone(),o.clone(),o)]):[new em.Math.CubicBezier(M,z,A,J),new em.Math.CubicBezier(J,h,V,o)]};var ge=v.Default.getInternal().ui().EdgeUI,lm={_47O:function(T){var F=this,e=lm.getBackups()._47O;em.inEdit(F.gv)||e.call(F,T)}};em.Inject.registAsModule(lm,ge);var dp=v.Default.getInternal().ui().NodeUI,Ap={_47O:function(m){var y=this,v=Ap.getBackups()._47O;em.inEdit(y.gv)||v.call(y,m)},getSelectWidth:function(){var N=this,j=N.gv,e=N._data;if(j.isEditable(e)&&em.inEdit(j))return 0;var L=Ap.getBackup("getSelectWidth");return L.call(N)}};em.Inject.registAsModule(Ap,dp);var Kq=v.graph.GraphView,Vg={_editPointSize:function(){var r=v.Default.isTouchable,h=em.getStyle("pointSize");return h[r?0:1]}(),isPointEditable:function(W){var z=this;if(em.inEdit(z))return z._pointEditableFunc?z._pointEditableFunc(W):!0;var M=Vg.getBackup("isPointEditable");M.call(z,W)},isEditable:function(t){var Y,O=this,W=Vg.getBackup("isEditable");if(Y=t instanceof em.Group?!0:W.call(O,t),!em.inEdit(O))return Y;if(!(t instanceof v.Edge))return Y;if(!t.s("2d.editable"))return!1;var Z=O.getEditableFunc();return Z?Z(t):!0},_42:function(x,$){var A=this,Z=Vg.getBackups()._42;if(Z.call(A,x,$),em.inEdit(A)){var Y=A.getEditInteractor();Y.drawImpl()}}};em.Inject.registAsModule(Vg,Kq);var ub=v.Default.getInternal().ui().ShapeUI,Kb={_47O:function(e){var F=this,U=Kb.getBackups()._47O;em.inEdit(F.gv)||U.call(F,e)}};em.Inject.registAsModule(Kb,ub);var Il=v.graph.DefaultInteractor,Ek={handle_mousewheel:function(H){var m=this,G=Ek.getBackup("handle_mousewheel");em.inEdit(m.gv)||G.call(m,H)}};em.Inject.registAsModule(Ek,Il);var ok=v.graph.MoveInteractor,Ll={_calcShift:function(c,M){var R=this,q=Ll.getBackup("_calcShift"),j=R.gv;if(!em.inEdit(j))return q.call(R,c,M);var s=j.getEditInteractor(),H=s.getSubModule("Move").calcShift(c,M,R);return H||q.call(R,c,M)},clear:function(i){var n=this,s=Ll.getBackup("clear");s.call(n,i);var h=n.gv;if(em.inEdit(h)){var o=h.getEditInteractor();o.getSubModule("Move").clear(i)}}};em.Inject.registAsModule(Ll,ok);var sl=em.Rect=function(t){this.catalog="Rect",this._interactor=t};sl.prototype={},sl.prototype.constructor=sl,sl.prototype.gatherInfo=function(L,V){var y=this;if(1===V.length){var t=V[0];return t instanceof v.Shape&&t._70I()?y.gatherLine(L,t):eg(t,L)?!1:y.gatherSingleTarget(L,t)}return V.length>1?y.gatherMultiTargets(L,V):!1},sl.prototype.gatherSingleTarget=function(S,z){if(z.getCorners){var Q,X=this,e=X.info;X.target=z,Q=X.screenInfo={};var N=z.getCorners();e.LT=new em.Math.Vector2(N[0]),e.LB=new em.Math.Vector2(N[1]),e.RB=new em.Math.Vector2(N[2]),e.RT=new em.Math.Vector2(N[3]),e.T=e.LT.clone().add(e.RT).divideScalar(2),e.B=e.LB.clone().add(e.RB).divideScalar(2),e.L=e.LT.clone().add(e.LB).divideScalar(2),e.R=e.RT.clone().add(e.RB).divideScalar(2);for(var B in e)Q[B]=em.toScreenPosition(S,e[B]);var H=X._interactor,A=H.getStyle("checkSize"),d=function(Y,m,e){var g=m.clone().sub(Y).setLength(-A),D=e.clone().sub(Y).setLength(-A),V=g.add(D).add(Y);return V};return Q.rotLT=d(Q.LT,Q.RT,Q.LB),Q.rotLB=d(Q.LB,Q.LT,Q.RB),Q.rotRB=d(Q.RB,Q.LB,Q.RT),Q.rotRT=d(Q.RT,Q.LT,Q.RB),Q.rotT=Q.rotLT.clone().add(Q.rotRT).divideScalar(2),Q.rotB=Q.rotLB.clone().add(Q.rotRB).divideScalar(2),Q.rotL=Q.rotLT.clone().add(Q.rotLB).divideScalar(2),Q.rotR=Q.rotRT.clone().add(Q.rotRB).divideScalar(2),Q.rotation=z.getRotation(),X.gatherConnectInfo(),!0}},sl.prototype.gatherConnectInfo=function(){var x=this,Y=x.target,l=x._interactor,e=x.screenInfo,D=l.gv;if(D.isConnectActionVisible(Y)&&l.getStyle("connectGuideVisible")){var $;Y.s&&($=Y.s("connectGuideShift")),$||($=l.getStyle("connectGuideShift"));var N=Y.getAnchor(),m=Y.getSize(),z=Y.toGlobal({x:m.width*($[0]-N.x),y:m.height*($[1]-N.y)});z=em.toScreenPosition(D,z),e.P1?z.add(e.P2.clone().sub(e.P1).setLength($[2])):(z.add(e.RT.clone().sub(e.LT).setLength($[2])),z.add(e.LB.clone().sub(e.LT).setLength($[3]))),e.connect=z}},sl.prototype.gatherMultiTargets=function($,A){var c=em.Group.findOrCreateGroup(A);if(!c)return!1;var T=this;return T.editing&&"rotate"!==T.editing.mode||c.calcInfo(),T.gatherSingleTarget($,c)},sl.prototype.gatherLine=function(e,R){this.target=R;var Z=this.screenInfo={},F=R.getPoints(),T=em.getDataMatrix(R);return Z.P1=em.toScreenPosition(e,T.apply(F.get(0))),Z.P2=em.toScreenPosition(e,T.apply(F.get(1))),this.gatherConnectInfo(),!0},sl.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],sl.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],sl.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],sl.prototype.check=function(T,m,X){if(v.Default.isLeftButton(m)){var M=this;if(M.editing=null,M.tipInfo=null,M.screenInfo){var e=M.target,q=T.isEditable(e),N=M.screenInfo;if(q&&N.connect){var E=M._checkConnect(X);if(E)return E}if(N.P1)return M._checkLine(X);var r,i,P,W=null,K=M._interactor,d=K.getStyle("checkSize");if(q&&T.isRectEditable(e))for(i=0;i<em.Rect.ResizeKeys.length;i++)if(P=em.Rect.ResizeKeys[i],em.checkHit(X,N[P],d)){W=P,r="resize";break}if(!W&&q&&T.isRotationEditable(e)&&!K.getStyle("rotateAsClock")){var o=K.getStyle("rotateCheckSize");for(i=0;i<em.Rect.RotateKeys.length;i++)if(P=em.Rect.RotateKeys[i],em.checkHit(X,N[P],o)){W=P,r="rotate";break}}if(!W)return K.setCursor("default"),void 0;if("rotate"===r){var l,A=T.lp(m);if(e instanceof em.Group){var f=K.getStyle("groupRotateModeKey");"string"==typeof f&&(f=[f]);for(var L=!1,Y=0,w=f.length;w>Y;Y++)if(m[f[Y]]){L=!0;break}var O=K.getStyle("groupRotateModeDefault");l=L?"batch"===O?"block":"batch":O}var b="batch"===l?e.getAnchor2():e.getPosition(),I=Math.atan2(A.y-b.y,A.x-b.x);K._setRotateCursor(I),M.editing={mode:r,key:W,pos:b,flipY:e.getScale().y<0,rotation:e.getRotation(),hitRot:I},l&&(M.editing.groupRotateMode=l)}else{var D=em.Rect.ResizeKeys.indexOf(W),Q=em.Rect.ResizeDirection[D],U=Math.cos(e.getRotation()),F=Math.sin(e.getRotation()),R=Q.x*Math.sign(e.getScale().x),_=Q.y*Math.sign(e.getScale().y),u=Math.atan2(-F*R-U*_,U*R-F*_),g=(Math.round(u/(Math.PI/4))+8)%8,J=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][g];this._interactor.setCursor(J);var H=e.getWidth(),z=e.getHeight(),s=e.getAnchor();M.editing={mode:r,key:W,rect:{x:-H*s.x,y:-z*s.y,width:H,height:z},anchor:s,matrix:e.getMatrix()}}return W}}},sl.prototype._checkLine=function(c){var j=this;j.screenInfo;var z,l=j._interactor.getStyle("checkSize");if(em.checkHit(c,j.screenInfo.P1,l))z="P1";else{if(!em.checkHit(c,j.screenInfo.P2,l))return this._interactor.setCursor("default"),void 0;z="P2"}return j.editing={mode:"line",key:z},z},sl.prototype._checkConnect=function(O){var h=this,B=h.screenInfo,P=h._interactor,J=P.getStyle("connectGuideIntersectSize"),z=B.connect,Y=O.x,Q=z.x;if(Q>Y&&J>Q-Y&&Math.abs(z.y-O.y)<J||Y>=Q&&em.checkHit(O,z,J)){var E="connect",s=C.getConnectAction(P.gv);if(h.editing={mode:E},s&&s.delete)if(h.target instanceof em.Group){var n=!0;P.gv.sm().getSelection().each(function(e){s.delete.visible.call(null,P.gv,e)||(n=!1)}),h.editing.hasDeleteAction=n}else s.delete.visible.call(null,P.gv,h.target)&&(h.editing.hasDeleteAction=!0);return P.setCursor("default"),E}},sl.prototype._fireEditEvent=function(b,h){var U=this._interactor,Z=this.editing;if(Z){var j=Z.mode;j="rotate"===j?"Rotation":"connect"===j?"Connection":"resize"===j?"Rect":j[0].toUpperCase()+j.slice(1),U.fi({kind:b+"Edit"+j,event:h})}},sl.prototype.startEdit=function(H,S){H.startDragging(S);var q=this;q._interactor.fi({kind:"prepareEdit",event:S});var C=q.editing,h=q.target;if(C){if(q._fireEditEvent("begin",S),"rotate"===C.mode)return C.groupRotateMode&&h.beginRotate(C),void 0;if("connect"!==C.mode)("line"===C.mode||h&&0===h.getRotation())&&(q._inSmartGuide=!0,q._interactor.rectGuide.gatherRects());else if(C.hasDeleteAction){var z=H.gv,N=q._interactor.getStyle("connectGuideGarbageShift");C.garbageInfo={x:z.getWidth()*N[0]+N[2],y:z.getHeight()*N[1]+N[3],size:q._interactor.getStyle("connectGuideGarbageIntersectsize")},H._42()}}},sl.prototype._46O=function(D){var X,F,x=this,y=x.editing,c=x.target;if(y){if("connect"===y.mode&&!y.canceled&&!y.deleted)try{y.garbageInfo&&y.garbageInfo.hover?C.doDeleteConnectionAction(x._interactor.gv,c):C.doConnectAction(x._interactor.gv,c,y.target)}catch(q){console.error(q)}F=y.freezeFlag,X=x.editing.groupRotateMode,x._fireEditEvent("end",D),x.editing=null}x.tipInfo=null,x._inSmartGuide&&(x._interactor.rectGuide.clear(),x._inSmartGuide=!1),X&&c&&c.endRotate(),c instanceof v.Block&&(F===i?delete c._freezeSyncFromChildren:c._freezeSyncFromChildren=F,c.updateFromChildren())},sl.prototype.handleNormalStateDelete=function(){var V=this,E=V.editing;if(E&&"connect"===E.mode&&!E.canceled&&!E.deleted){if(E.garbageInfo){try{C.doDeleteConnectionAction(V._interactor.gv,V.target)}catch(j){console.error(j)}E.garbageInfo=null
}return E.cursorPos=null,E.targetCorners=null,E.deleted=!0,V._interactor._42(),!0}},sl.prototype.handleNormalStateKeyDown=function(f){var l=this,k=l.editing;return!k||"connect"!==k.mode||k.canceled||k.deleted?void 0:v.Default.isEsc(f)?(k.cursorPos=null,k.targetCorners=null,k.canceled=!0,l._interactor._42(),!0):void 0},sl.prototype.handleEdit=function(N,B){var m=this,x=m.editing;if(x){var q,j,a,S,o,Z=m.target,H=x.key,L=x.mode,Y=N.lp(B),d=m._interactor;if("connect"===L){if(x.canceled)return;if(x.deleted)return;x.cursorPos=d._getLogicalPoint(B);var O=x.garbageInfo;return O&&em.checkHit(x.cursorPos,O,O.size)?(O.hover=!0,x.target=null,x.targetCorners=null):(O&&(O.hover=!1),x.target=N.getDataAt(Y,function(G){return N.isSelectable(G)?gr(G)?!0:!1:!1})||null,x.targetCorners=em.getTargetCornersOnScreen(N,x.target)),d._42(),void 0}if("rotate"===L){var l,U,F=x.pos,u=Math.atan2(Y.y-F.y,Y.x-F.x);if(x.groupRotateMode?U=u-x.hitRot:(l=u-x.hitRot,U=x.rotation+l),U%=2*Math.PI,0>U&&(U+=2*Math.PI),!v.Default.isCtrlDown(B)){var R,$;Hh(B)?(R=d.getStyle("shiftRotateRound"),$=R/2):(R=d.getStyle("rotateRound"),$=d.getStyle("rotateSensitivity")),U=em.roundTo(U,R,$)}x.groupRotateMode?(l=U-(x.lastRotation||0),0!==l&&(Z.addRotation(l,x.groupRotateMode,function(a){return N.isRotationEditable(a)}),x.lastRotation=U)):Z.setRotation(U),d._setRotateCursor(u),U>Math.PI&&(U-=2*Math.PI);var C=180*(U/Math.PI);C=C.toFixed(2),q=""+C+"°"}else if("resize"===L){var n=x.rect;a=n.x,S=n.y;var T,i=n.width,c=n.height,w=x.anchor,P=x.matrix,G=Z.s&&Z.s("keepAspectRatio")||d.getStyle("keepAspectRatio");Hh(B)&&(G=!G);var V=m._unionPointMode1,K=m._unionPointMode2;if(m._inSmartGuide&&!v.Default.isCtrlDown(B)&&!G){var X;"L"===H||"R"===H?X="x":("T"===H||"B"===H)&&(X="y"),m._adsorbedToClosest(Y,X),o=!0}T=P.tfi(Y);var W;"LT"===H?(n=V(T,{x:a+i,y:S+c},i,c,G),W=9):"T"===H?(n=K({x:a,y:T.y},{x:a+i,y:S+c},i,c,G,"v"),W=1):"RT"===H?(n=V(T,{x:a,y:S+c},i,c,G),W=33):"L"===H?(n=K({x:T.x,y:S},{x:a+i,y:S+c},i,c,G,"h"),W=8):"R"===H?(n=K({x:a,y:S},{x:T.x,y:S+c},i,c,G,"h"),W=32):"LB"===H?(n=V(T,{x:a+i,y:S},i,c,G),W=12):"B"===H?(n=K({x:a,y:S},{x:a+i,y:T.y},i,c,G,"v"),W=4):"RB"===H&&(n=V(T,{x:a,y:S},i,c,G),W=36);var I=P.tf(n.x+n.width*w.x,n.y+n.height*w.y);Z instanceof v.Block&&(x.hasOwnProperty("freezeFlag")||(x.freezeFlag=Z._freezeSyncFromChildren,Z._freezeSyncFromChildren=!0)),Z.setPosition(I),Z.setSize(n.width,n.height),o&&(j=Z.getRect(),d.rectGuide.gatherLines({node:Z,x:j.x,y:j.y,w:j.width,h:j.height},X,W)),q=""+Math.round(n.width)+" * "+Math.round(n.height)}else if("line"===L){if(Hh(B)){var E=Z.getPoints(),k="P1"===H?E.get(1):E.get(0),D={x:Y.x-k.x,y:Y.y-k.y},M=d.getStyle("shiftLineRotateRound"),h=m._shiftDirList;if(!h||m._shiftRotateRound!==M){m._shiftRotateRound=M,m._shiftDirList=h=[];for(var p=0;p<Math.PI;p+=M)h.push({x:y(p),y:b(p)})}for(var A,g=0,z=0,s=h.length;s>z;z++){var r=h[z],J=r.x*D.x+r.y*D.y;Math.abs(J)>Math.abs(g)&&(g=J,A=r)}Y={x:k.x+A.x*g,y:k.y+A.y*g},d.rectGuide.clear()}else m._inSmartGuide&&!v.Default.isCtrlDown(B)&&(m._adsorbedToClosest(Y),o=!0);var _=em.getDataMatrix(Z).applyInverse(Y);Z.setPoint("P1"===H?0:1,_,!0);var f=Z.getPoints(),t=f.get(0),Q=f.get(1);a=t.x-Q.x,S=t.y-Q.y,q=" "+Math.round(Math.sqrt(a*a+S*S))+" ",o&&(j=Z.getRect(),d.rectGuide.gatherLines({node:Z,x:j.x,y:j.y,w:j.width,h:j.height}))}if(q){var e=v.Default.getLogicalPoint(B,d._canvas);e.x+=em.Icons.TipShiftX,e.y+=em.Icons.TipShiftY,m.tipInfo={helperPos:e,text:q,size:q.length}}m._fireEditEvent("between",B)}},sl.prototype._unionPointMode1=function(g,c,Q,K,W){if(W&&Q&&K){var r=g.x-c.x,G=g.y-c.y;Math.abs(r*K)<Math.abs(G*Q)?(G=Math.sign(G)*Math.abs(r*K/Q),g.y=c.y+G):(r=Math.sign(r)*Math.abs(G*Q/K),g.x=c.x+r)}return v.Default.unionPoint(g,c)},sl.prototype._unionPointMode2=function(h,M,j,Q,W,o){var e=v.Default.unionPoint(h,M);if(W&&j&&Q){var q;"v"===o?(q=e.x+e.width/2,e.width=j*e.height/Q,e.x=q-e.width/2):(q=e.y+e.height/2,e.height=Q*e.width/j,e.y=q-e.height/2)}return e},sl.prototype._adsorbedToClosest=function(t,G){var V=this,S=V._interactor,J=S.rectGuide.findClosest(t,G),v=S.gridGuide.findClosest(t,G),C=1/0,y=1/0;J&&(isFinite(J.x)&&(C=J.x),isFinite(J.y)&&(y=J.y)),v&&(isFinite(v.x)&&Math.abs(v.x)<Math.abs(C)&&(C=v.x),isFinite(v.y)&&Math.abs(v.y)<Math.abs(y)&&(y=v.y)),isFinite(C)&&(t.x+=C),isFinite(y)&&(t.y+=y)},sl.prototype._42=function(n,p,h){var L=this;L.info={},L.screenInfo=null;var x=L._interactor;if(!x.editDetail&&L.gatherInfo(p,h)){var r=L.editing,J=r?r.groupRotateMode:null,s=L.screenInfo;if("block"!==J){if(s.P1?em.Icons.DrawIcon(x,n,em.Icons.Line,s):em.Icons.DrawIcon(x,n,em.Icons.Rect,s),s.connect&&(em.Icons.DrawIcon(x,n,em.Icons.ConnectGuide,{rotation:s.rotation,connect:s.connect,cursorPos:r?r.cursorPos:null}),r)){if(r.targetCorners){for(var i={x:1/0,y:1/0},I={x:-1/0,y:-1/0},D=0,b=r.targetCorners.length;b>D;D+=2)i.x=Math.min(i.x,r.targetCorners[D]),I.x=Math.max(I.x,r.targetCorners[D]),i.y=Math.min(i.y,r.targetCorners[D+1]),I.y=Math.max(I.y,r.targetCorners[D+1]);em.Icons.DrawIcon(x,n,em.Icons.HoverDataRect,{min:i,max:I,color:x.getStyle("hoverGuideColor")||x.getStyle("baseColor")})}r.garbageInfo&&em.Icons.DrawIcon(x,n,em.Icons.ConnectGuideGarbage,r.garbageInfo)}L.tipInfo&&em.Icons.DrawIcon(x,n,em.Icons.TipHelper,L.tipInfo)}L.target instanceof em.Group&&L.target._42(x,n,p)}};var ze=em.Anchor=function(n){this.catalog="Anchor",this._interactor=n};ze.prototype={},ze.prototype.constructor=ze,ze.prototype.gatherInfo=function(o,r){var Y=this;if(1===r.length){var h=r[0];if(!h.getAnchor)return;if(h instanceof v.Shape&&h._70I())return;if(eg(h,o))return;return Y.gatherSingleTarget(o,r[0])}return r.length>1?Y.gatherMultiTargets(o,r):!1},ze.prototype.gatherSingleTarget=function(O,G){var E=this;return E.info.POS=G.getPosition(),E.screenInfo.POS=em.toScreenPosition(O,E.info.POS),E.target=G,!0},ze.prototype.gatherMultiTargets=function(F,c){var s=this,G=em.Group.findOrCreateGroup(c);return G?(s.screenInfo.POS=em.toScreenPosition(F,G.getAnchor2()),s.target=G,!0):!1},ze.prototype.isVisible=function(){var e=this,I=e._interactor;if(I.getStyle("anchorVisible")===!1)return!1;var n=e.target;if(n){if(this.editing)return!0;var s=n.getAnchor(),X=I.getStyle("anchorOutsideVisibleThreshold");if(s.x<-X||s.x>1+X||s.y<-X||s.y>1+X)return!0;var u=n.getSize(),C=n.getScale(),B=Math.min(Math.abs(u.width*C.x),Math.abs(u.height*C.y));if(B*I.gv._zoom<I.getStyle("anchorHideThreshold"))return!1}return!0},ze.prototype.check=function(B,C,F){if(v.Default.isLeftButton(C)){var L=this,M=L._interactor;if(L.isVisible()&&M.getStyle("anchorMovable")!==!1){L.editing=null,L.tipInfo=null;var e=L.target;if(e&&B.isAnchorEditable(e)&&B.isEditable(e)){var h;if(L.screenInfo&&(h=L.screenInfo.POS)&&em.checkHit(F,new em.Math.Vector2(h),M.getStyle("checkSize"))){if(e instanceof em.Group)return L.editing={},!0;var X=e.getWidth(),s=e.getHeight(),b=e.getAnchor();return L.editing={rect:{x:-X*b.x,y:-s*b.y,width:X,height:s},anchor:b,matrix:e.getMatrix()},!0}}}}},ze.prototype.startEdit=function(j,B){j.startDragging(B),j.fi({kind:"beginEditAnchor",event:B})},ze.prototype._46O=function(J){var M=this;M.editing&&(M.editing=null,M._interactor.fi({kind:"endEditAnchor",event:J})),M.tipInfo=null},ze.prototype.handleEdit=function(J,k){var j=this,W=j.target;if(W){var q=j.editing;if(q){var E=J.lp(k),i=j._interactor;if(W instanceof em.Group)return W.setAnchor2(E),i._42(),void 0;var L=q.matrix,o=L.tfi(E),z=q.rect,F=(o.x-z.x)/z.width,A=(o.y-z.y)/z.height;if(!v.Default.isCtrlDown(k)){var Z=i.getStyle("anchorRound"),I=i.getStyle("anchorSensitivity");F=em.roundTo(F,Z,I),A=em.roundTo(A,Z,I)}W.setAnchor(F,A,!0);var n=v.Default.getLogicalPoint(k,i._canvas);n.x+=em.Icons.TipShiftX,n.y+=em.Icons.TipShiftY;var V=""+F.toFixed(2)+", "+A.toFixed(2);j.tipInfo={helperPos:n,text:V,size:V.length},i.fi({kind:"betweenEditAnchor",event:k})}}},ze.prototype._42=function(r,K,v){var S=this;S.info={},S.screenInfo={};var N=S._interactor;N.editDetail||S.gatherInfo(K,v)&&S.isVisible()&&(em.Icons.DrawIcon(N,r,em.Icons.Anchor,S.screenInfo),S.tipInfo&&em.Icons.DrawIcon(N,r,em.Icons.TipHelper,S.tipInfo))};var Tr=em.MoveDummy=function(K){this.catalog="MoveDummy",this._interactor=K};Tr.prototype={},Tr.prototype.constructor=Tr,Tr.prototype.gatherInfo=function(){var N=this,R=this._interactor.getSubModule("Rect");if(R){var M=R.screenInfo;if(M){var G=N._interactor,Z=N.getMovableTarget(R.target);if(Z){var q=G.getStyle("moveDummyThreshold");if(q!==!1){var J=M.LT||M.P1,X=M.RT||M.P2,Y=M.LB||J;if(J){var x=M.P1,u=Math.min(J.distanceTo(Y),J.distanceTo(X));if(!(q!==!0&&u>q)){var j=G.getStyle("moveDummyPosition"),B=X.clone().sub(J),C=Y.clone().sub(J),s=j[2],O=j[3];if(x){var A=G.getStyle("moveDummyLineExtraShift");A&&(s+=A[0],O+=A[1])}var d=J.clone().add(B.clone().multiplyScalar(j[0])).add(B.setLength(s)).add(C.clone().multiplyScalar(j[1])).add(C.setLength(O));return N.screenInfo.pos=d,N.screenInfo.size=G.getStyle("moveDummySensitivity"),!0}}}}}}},Tr.prototype.getMovableTarget=function(F){var $=this._interactor.gv;if(gr(F)){if($.isMovable(F))return F}else if(F instanceof em.Group)for(var j=F._entities,E=j.length-1;E>=0;E--){var x=j[E];if(gr(x)&&$.isMovable(x))return x}return null},Tr.prototype.getMoveInteractor=function(){for(var s,e,Z,V=this._interactor.gv,h=V.getInteractors(),s=0,e=h.length;e>s;s++)if(Z=h.get(s),Z instanceof ok)return Z},Tr.prototype.startEdit=function(F,$){F.startDragging($);var k=this.getMoveInteractor();if(k){var H=this.selectedTarget,N=F.gv;N._moving=1,k._data=H,N.handleMouseDown&&N.handleMouseDown($,H)}},Tr.prototype._46O=function(j){var p=this,V=p.getMoveInteractor();V&&(V.handleWindowMouseUp(j),p.selectedTarget=null)},Tr.prototype.handleEdit=function(Q,h){var u=this.getMoveInteractor();u&&u.handleWindowMouseMove(h)},Tr.prototype.check=function(Z,S,U){if(this.selectedTarget=null,v.Default.isLeftButton(S)&&!Z._scrolling&&!Dj()){var t=this;if(t.screenInfo){var y=t.screenInfo.pos;if(y&&!(U.distanceTo(y)>t.screenInfo.size)){var $=t._interactor;return t.selectedTarget=t.getMovableTarget($.getSubModule("Rect").target),$.setCursor("default"),!0}}}},Tr.prototype._42=function(l,j,I){var A=this;A.screenInfo={};var F=A._interactor;F.editDetail||A.gatherInfo(j,I)&&(!F.editing||A.selectedTarget)&&em.Icons.DrawIcon(F,l,em.Icons.MoveDummy,A.screenInfo)};var Sn=em.RotateX=function(D){this.catalog="RotateX",this._interactor=D};Sn.prototype={},Sn.prototype.constructor=Sn,Sn.prototype.gatherInfo=function(U,y){var b=this;if(1===y.length){var Q=y[0];return Q instanceof v.Shape&&Q._70I()||eg(Q,U)?!1:b.gatherSingleTarget(U,Q)}return y.length>1?b.gatherMultiTargets(U,y):!1},Sn.prototype.gatherSingleTarget=function(){var l=new v.Math.Vector2,S=new v.Math.Vector2,d=new v.Math.Vector2,U=new v.Math.Vector2,b=function(v,r){var C=v.x-r.x,F=v.y-r.y;return C*C+F*F};return function(x,q){if(q.getCorners){var H=this,u=q.getCorners(),r=15,o=q.getPosition();l.copy(u[0]),d.copy(u[1]),U.copy(u[3]),S.copy(l).add(U).divideScalar(2).add(l.sub(d).setLength(r/x.getZoom()));var h=Math.max(b(o,u[0]),b(o,u[1]),b(o,u[2]),b(o,u[3]));return H.info.POS=S.clone(),H.screenInfo.POS=em.toScreenPosition(x,H.info.POS),H.screenInfo.LEN=Math.sqrt(h)*x.getZoom()+r,H.screenInfo.CENTER=em.toScreenPosition(x,o),H.target=q,!0}}}(),Sn.prototype.gatherMultiTargets=function(Y,p){var N=this,g=em.Group.findOrCreateGroup(p);if(!g)return!1;var N=this;return N.gatherSingleTarget(Y,g)},Sn.prototype.isVisible=function(){var u=this._interactor;if(!u.getStyle("rotateAsClock"))return!1;var A=this.target;if(!A)return!0;var V=u.gv;return V.isEditable(A)&&V.isRotationEditable(A)?!0:!1},Sn.prototype.check=function(_,I,E){var C=this,D=C._checkImpl(_,I,E);return(D||C._clockPainted)&&C._interactor._42(),D},Sn.prototype._checkImpl=function(R,M,j){if(v.Default.isLeftButton(M)){var P=this;P.editing=null,P.tipInfo=null;var C;if(P.screenInfo&&(C=P.screenInfo.POS)&&P.isVisible()){var T=P._interactor;if(em.checkHit(j,C,T.getStyle("checkSize"))){var d=P.target,b=R.lp(M),H=d.getPosition(),m=Math.atan2(b.y-H.y,b.x-H.x);return T._setRotateCursor(m),P.editing={pos:H,rotation:d.getRotation(),hitRot:m,groupRotateMode:"block",screenInfo:{CENTER:P.screenInfo.CENTER,LEN:P.screenInfo.LEN}},!0}}}},Sn.prototype.startEdit=function(Y,s){Y.startDragging(s),Y.fi({kind:"beginEditRotation",event:s}),this.target instanceof em.Group&&this.target.beginRotate(this.editing)},Sn.prototype._46O=function(l){var A=this;A.editing&&(A.editing=null,A._interactor.fi({kind:"endEditRotation",event:l})),A.target instanceof em.Group&&A.target.endRotate(),A.tipInfo=null},Sn.prototype.handleEdit=function(h,J){var Y=this,k=Y.editing;if(k){var G,L,l=Y.target,r=h.lp(J),R=Y._interactor,Z=k.pos,U=Math.atan2(r.y-Z.y,r.x-Z.x),e=l instanceof em.Group;if(e?L=U-k.hitRot:(G=U-k.hitRot,L=k.rotation+G),L%=2*Math.PI,0>L&&(L+=2*Math.PI),!v.Default.isCtrlDown(J)){var X,D;Hh(J)?(X=R.getStyle("shiftRotateRound"),D=X/2):(X=R.getStyle("rotateRound"),D=R.getStyle("rotateSensitivity")),L=em.roundTo(L,X,D)}e?(G=L-(k.lastRotation||0),0!==G&&(l.addRotation(G,k.groupRotateMode,function(D){return h.isRotationEditable(D)}),k.lastRotation=L)):l.setRotation(L),R._setRotateCursor(U),L>Math.PI&&(L-=2*Math.PI);var m=180*(L/Math.PI),t=""+m.toFixed(2)+"°",B=v.Default.getLogicalPoint(J,R._canvas);B.x+=em.Icons.TipShiftX,B.y+=em.Icons.TipShiftY,Y.tipInfo={helperPos:B,text:t,size:t.length},R.fi({kind:"betweenEditRotation",event:J})}},Sn.prototype._42=function(i,b,d){var f=this;f._clockPainted=!1,f.info={},f.screenInfo={};var U=f._interactor;U.editDetail||f.gatherInfo(b,d)&&f.isVisible()&&(em.Icons.DrawIcon(U,i,em.Icons.RoundPoint,f.screenInfo.POS),f.tipInfo&&em.Icons.DrawIcon(U,i,em.Icons.TipHelper,f.tipInfo),f.editing&&f.drawClock(i))},Sn.prototype.drawClock=function($){$.save();var M=this;M._clockPainted=!0;var t=M.editing||{},i=t.screenInfo||M.screenInfo,a=i.LEN,p=a+8,C=a+18;$.save(),$.translate(i.CENTER.x,i.CENTER.y),$.beginPath(),$.strokeStyle="rgb(150, 150, 150)";for(var n,E,I,h,l,K=0;360>K;K++)n=K*Math.PI/180,0===K%5&&(E=b(n)*a,I=y(n)*a,h=b(n)*p,l=y(n)*p,$.moveTo(E,I),$.lineTo(h,l)),0===K%45&&(E=b(n)*a,I=y(n)*a,h=b(n)*C,l=y(n)*C,$.moveTo(E,I),$.lineTo(h,l));$.stroke(),$.rotate(-k);var Y=t.lastRotation||M.target.getRotation();$.beginPath(),$.fillStyle="rgba(255, 0, 0, 0.1)",$.strokeStyle="rgb(157, 157, 157)",$.moveTo(0,0),$.arc(0,0,C,0,Y,!1),$.fill(),$.beginPath(),$.moveTo(0+C,0),$.arc(0,0,C,0,Y,!1),$.stroke(),$.restore()};var Nr=em.Curve=function(g){this.catalog="Curve",this._interactor=g};Nr.prototype={},Nr.prototype.constructor=Nr,I.defineProperties(Nr.prototype,{activing:{get:function(){return this._activing},set:function(g){var J=this;if(g)J._activing=new em.CurveActiving(this,g);else{var Q=J._activing;Q&&Q.dispose(),J._activing=null}}}}),Nr.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Nr.prototype.setUp=function(){var D=this,Q=D._interactor;Q&&Q.gv.mp(D._onGraphviewPropertyChanged,D)},Nr.prototype._onGraphviewPropertyChanged=function(D){("zoom"===D.property||"translateX"===D.property||"translateY"===D.property)&&this._handleDataChanged()},Nr.prototype.tearDown=function(){var D=this,P=D._interactor;P&&P.gv.ump(D._onGraphviewPropertyChanged,D)},Nr.prototype.canEnterEditDetailMode=function(){var G=this,U=G._interactor,r=U._getValidSelection();if(1===r.length){var Y=r[0],Z=Y instanceof v.Edge;if(Y instanceof v.Shape||Z){if(Z){var u=Y.s("edge.type");if(u&&"points"!==u)return}var m=U.gv;if(m.isPointEditable(Y)&&m.isEditable(Y))return G.target=Y,!0}}},Nr.prototype.canQuitEditDetailMode=function(o){var S=this,e=S._interactor._getLogicalPoint(o);return S._checkEditRealPoint(e)?void 0:S._interactor.gv.getDataAt(o)!==S.target?!0:void 0},Nr.prototype.preHandleScroll=function(){var X=this.editing;return X&&X.inEdit?!0:void 0},Nr.prototype.getCurrentSelectintStatus=function(){var p=this;if(p.activing&&!p.activing.selections){if(p.activing.status!=i)return p.activing.status;var k=function($){var b=p.activing.status;p.activing.status=$,p._interactor.fp("shapePointStatus",b,$)},F=em.Curve.PointType,q=p.activing.point,N=p.activing.pairs;if(!N||1!==N.length)return k(F.Mirrored);var O=N[0],t=O.c1&&O.c1.isNearEnough(q),R=O.c2&&O.c2.isNearEnough(q);if(!O.c1||!O.c2)return t||R?k(F.Straight):k(F.Disconnected);if(t&&R)return k(F.Straight);if(t||R)return k(F.Asymmetric);var r=O.c1.clone().sub(q),g=O.c2.clone().sub(q);return Math.abs(r.x*g.y-r.y*g.x)>1e-5||r.x*g.x>0?k(F.Disconnected):Math.abs(r.length()-g.length())>1e-5?k(F.Asymmetric):k(F.Mirrored)}},Nr.prototype.handle_keydown=function(p){var E=this;if(E._interactor.editDetail){var o=em.Curve.PointType;"1"===p.key?E._setCurrentSelectionStatus(o.Straight):"2"===p.key?E._setCurrentSelectionStatus(o.Mirrored):"3"===p.key?E._setCurrentSelectionStatus(o.Disconnected):"4"===p.key&&E._setCurrentSelectionStatus(o.Asymmetric)}},Nr.prototype.setCurrentSelectionStatus=function(F){var N=this,t=N._interactor;if(t){var T=t.gv;T.dm().beginTransaction(),this._setCurrentSelectionStatus(F),T.dm().endTransaction()}},Nr.prototype._setCurrentSelectionStatus=function(Q){var a=this,q=a.activing;if(q){var R=a.getCurrentSelectintStatus();if(null!==R&&R!==Q){q.status=Q;var H=a.activing.point,Y=a.activing.pairs;if(Y&&1===Y.length){var $=Y[0],z=a.screenInfo.curve,G=em.Curve.PointType,p=a._interactor,P=function(){a._writeToHt(),p.fp("shapePointStatus",R,Q),a.check(p.gv,null,new em.Math.Vector2(p._lastLogicalPoint))};if(Q===G.Straight)return z.moveCtrlPoint($,H,"c1"),z.moveCtrlPoint($,H,"c2"),P(),void 0;if(R===G.Straight){var Z=z.findPairs(H,!0),h=Z[0],E=h.r1||H,f=h.r2||H,o=f.clone().sub(E).multiplyScalar(.25);return z.moveCtrlPoint($,H.clone().sub(o),"c1"),z.moveCtrlPoint($,H.clone().add(o),"c2"),P(),void 0}var b=$.c1,_=$.c2;if(b&&_){if(Q===G.Mirrored)return z.moveCtrlPoint($,H.clone().multiplyScalar(2).sub(_),"c1"),P(),void 0;if(Q===G.Asymmetric&&R===G.Disconnected){var N=b.clone().sub(H).length(),o=H.clone().sub(_).setLength(N).add(H);return z.moveCtrlPoint($,o,"c1"),P(),void 0}}q._firePointChange(),p.fp("shapePointStatus",R,Q),a.check(p.gv,null,new em.Math.Vector2(p._lastLogicalPoint))}}}},Nr.prototype._handleDataChanged=function(){var $="points,segments,shape,position,rotation,scale".split(",");return function(Q){var s=this;if(s.screenInfo&&s.target){if(Q&&$.indexOf(Q.property)<0)return;var W=s._interactor;s.gatherSingleTarget(W.gv,s.target,!0),s.check(W.gv,null,new em.Math.Vector2(W._lastLogicalPoint)),W._42()}}}(),Nr.prototype.gatherSingleTarget=function(d,J,m){var C,u,L=this;L.screenInfo&&L.screenInfo.curve&&(u=L.screenInfo.curve._curves);var n=L.editing;C=n?L.screenInfo:L.screenInfo={};var q,o,R=J instanceof v.Edge;R?(q=J.s("edge.segments"),o=J.s("edge.points")||new v.List):(q=J._58O,o=J._59O),C.S=q;var e,V=C.P=[],F=em.getDataMatrix(J);if(J instanceof v.Polyline||J instanceof v.Edge&&L._interactor.getStyle("edgeElevationEditable"))e=J.getElevation&&J.getElevation()||0,C.E=[];else{var N=!1;o.each(function(I){I.e!==i&&(N=!0)}),N&&(C.E=[])}if(o.each(function(E){C.E&&C.E.push(E.e||e),E=F.apply(E);var m=em.toScreenPosition(d,E);V.push(m.x,m.y)}),R){var O=V.length,D=em.toScreenPosition(d,J._lastSourcePoint||(O?{x:V[0],y:V[1]}:{x:0,y:0})),l=em.toScreenPosition(d,J._lastTargetPoint||(O?{x:V[O-2],y:V[O-1]}:{x:0,y:0}));V.splice(0,0,D.x,D.y),V.push(l.x,l.y),C.E&&(C.E.splice(0,0,"head"),C.E.push("tail"))}if(!C.S||!C.S.size()){C.S=new v.List,C.S.add(1);for(var x=0;x<V.length/2-1;x++)C.S.add(2)}if((!n||m)&&L.convertToCubicBezier(u),L.activing&&(m||!L.editing||"realPoint"===L.editing.type)){var P=C.curve.findPairs(L.activing.point);L.activing.pairs=P}R&&"points"!==J.s("edge.type")&&L._writeToHt()},Nr.prototype._convertToNewPoint=function(v,t,p,l){var N,g,L;for(N=0,g=t.length;g>N;N++){if(L=t[N],L._p1.isNearEnough(v)&&(!l||l.indexOf(L._p1)<0))return L._p1;if(L._p4.isNearEnough(v)&&(!l||l.indexOf(L._p4)<0))return L._p4}if(p)for(N=0,g=Math.min(p.length,g);g>N;N++){if(L=p[N],L._p1===v&&(!l||l.indexOf(t[N]._p1)<0))return t[N]._p1;if(L._p4===v&&(!l||l.indexOf(t[N]._p4)<0))return t[N]._p4}},Nr.prototype.convertToCubicBezier=function(D){var N,b,m=this,B=new em.Math.Curve,z=m.screenInfo;if(B.createFromHtShape(z.P,z.S,z.E),z.curve=B,m.activing){var u=B._curves;N=m.activing.point,b=m._convertToNewPoint(N,u,D);var Z=[];if(b&&(m.activing.point=b,Z.push(b)),m.activing.selections){var M=-1,k=m.activing.selections;k.forEach(function(h){M++,b=m._convertToNewPoint(h,u,D,Z),b&&(k[M]=b,Z.push(b))})}}},Nr.prototype.check=function(y,Z,g){if(!Z||Lg(Z)||yi(Z)){var L=this;if(L._interactor.setCursor("default"),L.editing=null,L.highlight=null,L.tipInfo=null,L.edgeEditResult=null,L.screenInfo){if(Dj()||yi(Z))return L._interactor._42(),!0;if(L._checkEditCtrlPoint(g))return L._interactor._42(),!0;if(L._checkEditRealPoint(g))return L._interactor._42(),!0;if(L._checkEditElevation(g))return L._interactor._42(),!0;var A=L.screenInfo.curve,e=A.checkPoint(g,L._interactor.getStyle("curveIntersectSize"));if(e){var X=L.highlight={};X.type="insertKnot",X.bezier=e.bezier,X.point=e.intersection}return L._interactor._42(),!0}}},Nr.prototype._checkEditRealPoint=function(x){var Y,n,W,C,N,g,q=this,A=q.screenInfo.curve._curves,z=q._interactor.getStyle("curvePointIntersectSize"),B=1/0;for(z*=z,W=0,C=A.length;C>W;W++)Y=A[W],N=Y._p1,g=x.distanceToSquared(N),B>g&&(B=g,n=N),N=Y._p4,g=x.distanceToSquared(N),B>g&&(B=g,n=N);if(B>z)return!1;var X=q.highlight={};return X.type="changeRealPoint",X.point=n,q.editing={type:"realPoint",point:n,shiftGuide:{point:n.clone(),dir:"x",limit:0}},q._interactor.setCursor("crosshair"),!0},Nr.prototype._checkEditElevation=function(q){var F=this;if(!F._interactor.getStyle("curveElevationVisible"))return!1;var H=F.activing;if(!H)return!1;var s=H.getCurrentEditingPoint();if(!s)return!1;var I=F._interactor,b=I.getStyle("curveElevationGuideShift"),e=I.getStyle("curveElevationIntersectSize"),A=q.distanceToSquared({x:s.x+b[0],y:s.y+b[1]});if(!(A>e*e)){var R=F.highlight={};R.type="elevation";var y=new em.Math.Vector2(q.x,q.y,s.e);return F.editing={type:"elevation",startPoint:y},F._interactor.setCursor("crosshair"),!0}},Nr.prototype._checkEditCtrlPoint=function(q){var k=this;if(k.activing&&!k.activing.selections){var B=k.getCurrentSelectintStatus();if(B!==em.Curve.PointType.Straight){var a=k.activing.pairs;if(a){var p=k._interactor.getStyle("curvePointIntersectSize");p*=p;var N,c,v,K,T,L,s,Y,F,h=1/0;for(s=0,F=a.length;F>s;s++)for(K=a[s],Y=0;2>Y;Y++)T=0===Y?"c1":"c2",K[T]&&(L=q.distanceToSquared(K[T]),h>L&&(h=L,N=K,c=s,v=T));if(h>p)return!1;k.activing.hlpair=N,k.activing.hltype=v;var e=k.highlight={};return e.type="changeCtrlPoint",e.point=N[v],k.editing={type:"ctrlPoint",pair:N,pairId:c,ctrlType:v,direction:N[v].clone().sub(k.activing.point).normalize()},k._interactor.setCursor("crosshair"),!0}}}},Nr.prototype.startEdit=function(Z,X){Z.startDragging(X);var B=this;B.highlight&&"insertKnot"===B.highlight.type&&(B.insertKnot(),B.gatherSingleTarget(B._interactor.gv,B.target),B.activing=null,B._checkEditRealPoint(B._interactor._getLogicalPoint(X)));var g=B._activing;if(g){var w=B.editing?B.editing.type:null;"ctrlPoint"===w?g.editingCtrl={pairId:B.editing.pairId,type:g.hltype}:"realPoint"===w&&(g.editingCtrl=!1)}var U=B.highlight,x=v.Default.isCtrlDown(X);if(!U||Dj()||yi(X)){var P=B._interactor.gv;if(!P.setFocus(X)||P._scrolling)return;return x?B._multiSelect={startPoint:P.lp(X)}:P.isPannable()&&(Lg(X)||yi(X))&&(B._pan={tx:P.tx(),ty:P.ty()},Z.fi({kind:"beginPan",event:X})),void 0}if("changeRealPoint"===U.type){var e,o=B.activing?B.activing.point:null,T=B.activing?B.activing.selections:null;if(x&&B.activing)o===U.point?(T?(B.activing={point:T[0]},T.length>1&&(T.splice(0,1),B.activing.selections=T)):B.activing=null,B.editing=null):T&&(e=T.indexOf(U.point))>=0?(T.length>1?T.splice(e,1):delete B.activing.selections,B.editing=null):T?(T.push(o),B.activing={point:U.point,selections:T}):B.activing={point:U.point,selections:[o]};else if(T)o===U.point||((e=T.indexOf(U.point))>=0?(T.splice(e,1,o),B.activing={point:U.point,selections:T}):B.activing={point:U.point});else{var t;o===U.point&&(t=B.activing.status),B.activing={point:U.point},t&&(B.activing.status=t)}Z.fi({kind:"beginEditPoint",event:X})}},Nr.prototype.insertKnot=function(){var t=this,U=t.highlight,X=t.screenInfo.curve;X.insertKnot(U.bezier,U.point.t),t._writeToHt()},Nr.prototype._writeToHt=function(){var N,A,t,T,h=this,L=h.screenInfo.curve,H=L.toHtShape(),R=H.points,X=[],q=H.segments,z=h._interactor.gv,E=h.target,w=E instanceof v.Edge,Q=em.getDataMatrix(E).invert();T=E instanceof v.Polyline||E instanceof v.Edge&&h._interactor.getStyle("edgeElevationEditable"),T&&(t=E.getElevation&&E.getElevation()||0);for(var x=0,Z=R.length;Z>x;x++)N=R[x],A=em.toWorldPosition(z,N),A=Q.apply(A),N.e!=i&&N.e!==t&&(A.e=N.e),X.push(A);if(E._writing=!0,w){E.s("edge.type","points"),E.setStyle("edge.segments",q),E.setStyle("edge.points",X.slice(1,X.length-1)),E.setStyle("edge.source.offset.x",0),E.setStyle("edge.source.offset.y",0),E.setStyle("edge.target.offset.x",0),E.setStyle("edge.target.offset.y",0);var $=h._nextChangeEdgeHost;delete h._nextChangeEdgeHost,$&&("source"===$.type?E.setSource($.host):E.setTarget($.host)),h._writeEdgeHostAnchor("source",X[0]),h._writeEdgeHostAnchor("target",X[X.length-1])}else X.length?(E.setSegments(q),E.setPoints(X,!0)):E.removeFromDataModel();delete E._writing},Nr.prototype._writeEdgeHostAnchor=function(m,z){var y=this,c=y.target,P=y._calcHostAnchor(c,m,z);P.index!==i?(c.setStyle("edge."+m+".index",P.index),c.setStyle("edge."+m+".percent",i),c.setStyle("edge."+m+".anchor.x",i),c.setStyle("edge."+m+".anchor.y",i)):P.percent!==i?(c.setStyle("edge."+m+".percent",P.percent),c.setStyle("edge."+m+".index",i),c.setStyle("edge."+m+".anchor.x",i),c.setStyle("edge."+m+".anchor.y",i)):(c.s("edge."+m+".anchor.x",P.x),c.s("edge."+m+".anchor.y",P.y),P.offsetX||P.offsetY?(c.s("edge."+m+".offset.x",P.offsetX),c.s("edge."+m+".offset.y",P.offsetY)):(c.s("edge."+m+".offset.x",0),c.s("edge."+m+".offset.y",0)))},Nr.prototype._calcHostAnchor=function(f,K,z,e){e||(e="source"===K?f.getSource():f.getTarget());var H=this._interactor.gv,s=H.calculateAttachPoint(e,z);if(s)return s.info;if(kn(e)){var p=H.calculateEdgePosition(e,z);return p}var q=e.getRotation(),r=e.getAnchor();eg(e,H)&&(q=0);var k=e.getScale();if(q||k.x<0||k.y<0){var M=e.getMatrix(),w=M.tfi(z),j=e.getSize();return{x:w.x/j.width+r.x,y:w.y/j.height+r.y}}var P=je(H,e),u={x:(z.x-P.x)/P.width,y:(z.y-P.y)/P.height};return u},Nr.prototype._handlePanning=function(s){var A=this,Y=A._pan;if(Y){Y.started=!0;var x=A._interactor,h=x.gv,u=x._lastClientPoint,W=Io(s),X=cp(h,W,u);h.setTranslate(Y.tx+X.x,Y.ty+X.y),A.gatherSingleTarget(x.gv,A.target),x._42(),x.fi({kind:"betweenPan",event:s})}},Nr.prototype.handleEdit=function(Z,o){var F=this,f=F.editing;if(F._pan)return F._handlePanning(o),void 0;if(F._multiSelect)return F._multiSelect.endPoint=Z.lp(o),F._interactor.redraw(),void 0;if(f){f.inEdit=!0;var H,m,D,C=F._interactor._getLogicalPoint(o),p=v.Default.isCtrlDown(o),t=v.Default.isShiftDown(o),c=f.type,L=F.activing;if(F._guideInfo=null,"ctrlPoint"===c&&t){var e=F.editing.direction.clone();H=L.point;var I=e.dot(C.clone().sub(H));C=e.setLength(I).add(H)}else if("ctrlPoint"===c||"realPoint"===c){var e;if("realPoint"===c&&t){var A=F.editing.shiftGuide;m=A.point;var V=Math.abs(C.x-m.x),Q=Math.abs(C.y-m.y);V>Q&&V>A.limit&&"y"===A.dir&&(A.dir="x"),Q>V&&Q>A.limit&&"x"===A.dir&&(A.dir="y"),e=A.dir,"x"===e?(C.y=m.y,A.limit=Math.max(A.limit,V)):"y"===e&&(C.x=m.x,A.limit=Math.max(A.limit,Q))}var N=F._isEditEdgeSourceTarget();if(N){var X=F._editEdgeSourceTarget(N,C,p);X&&(F.edgeEditResult=X,D=X.tipText)}else if(!p){var M=F._guidingToEdit(C,e),b="realPoint"===c?F._interactor.gridGuide.findClosest(C,e,!0):null,J=1/0,U=1/0;b&&(b.x&&(J=b.x),b.y&&(U=b.y));var n=!1;M&&(M.xList&&(Math.abs(M.x)<=Math.abs(J)?(n=!0,J=M.x):delete M.xList),M.yList&&(Math.abs(M.y)<=Math.abs(U)?(n=!0,U=M.y):delete M.yList),n&&(F._guideInfo=M)),isFinite(J)&&(C.x+=J),isFinite(U)&&(C.y+=U),n&&(M.v=C)}}var q=F.screenInfo.curve;if("realPoint"===f.type){H=f.point,H.e!==i&&(C.e=H.e),q.moveRealPoint(H,C),f.point=C,F.highlight.point=C;var z=L.status,x=L.selections;if(F.activing={point:C,status:z},x){var $=C.clone().sub(H),l=0;x.forEach(function(L){var T=L.clone().add($);q.moveRealPoint(L,T),x[l++]=T}),F.activing.selections=x}}else if("ctrlPoint"===f.type){var R=L.pairs,y=R[f.pairId];q.moveCtrlPoint(y,C,f.ctrlType);var h=L.status,P=em.Curve.PointType;if((h===P.Mirrored||h===P.Asymmetric)&&y.c1&&y.c2){var H=new em.Math.Vector2(L.point),j="c1"===f.ctrlType?"c2":"c1";if(h===em.Curve.PointType.Mirrored)q.moveCtrlPoint(y,H.clone().multiplyScalar(2).sub(C),j);else if(h===P.Asymmetric){var I=y[j].clone().sub(H).length(),K=H.clone().sub(y[f.ctrlType]).setLength(I).add(H);isNaN(K.x)||q.moveCtrlPoint(y,K,j)}}L._firePointChange()}else if("elevation"===f.type){m=f.startPoint;var O=m.e+(m.y-C.y)/Z._zoom;F._setCurrentPointImpl("e",O),L._firePointChange(),D="E: "+em.toFixed(O)}var B=v.Default.getLogicalPoint(o,F._interactor._canvas);if(B.x+=em.Icons.TipShiftX,B.y+=em.Icons.TipShiftY,!D){var T=em.toWorldPosition(Z,C);D=""+em.toFixed(T.x)+", "+em.toFixed(T.y)}F.tipInfo={helperPos:B,text:D,size:D.length},F._writeToHt(),F._interactor.fi({kind:"betweenEditPoint",event:o})}},Nr.prototype._setCurrentPointImpl=function(m,d){var l=this,j=l._activing;if(!j)return!1;var g=l.target;if(!g)return!1;var R=j.getCurrentEditingPoint();if(!R)return!1;var Z=j.editingCtrl;if(!Z)var r=R.clone();if("e"===m)R.e=d;else{var H;if("x"===m||"y"===m){var L=j._lastFirePoint;H="x"===m?{x:d,y:L?L.y:0}:{x:L?L.x:0,y:d}}else"object"==typeof m?(H=m,m.e!==i&&(R.e=m.e)):(H={x:arguments[0],y:arguments[1]},arguments[2]!==i&&(R.e=arguments[2]));var K=em.getDataMatrix(g);H=em.toScreenPosition(l._interactor.gv,K.apply(H)),R.x=H.x,R.y=H.y}if(!Z){var A=r.multiplyScalar(-1).add(R);R.e&&r.e&&(A.e=R.e-r.e),l.screenInfo.curve.moveCtrlDueToRealPointMovement(R,A)}return!0},Nr.prototype.setCurrentPoint=function(v,T){return this._setCurrentPointImpl(v,T)?(this._writeToHt(),!0):!1},Nr.prototype._isEditEdgeSourceTarget=function(){var q=this,Q=q.target;if(!(Q instanceof v.Edge))return!1;var Y=q.editing.point,M=q.screenInfo.curve._curves;return Y===M[0]._p1?"source":Y===M[M.length-1]._p4?"target":!1},Nr.prototype._editEdgeSourceTarget=function(X,x,n){var A,t=this,E=t.target;if(A="source"===X?E.getSource():E.getTarget()){var M,H=t._interactor.gv,f=em.toWorldPosition(H,x),l=t._calcHostAnchor(E,X,f,A);if(M=l.index!==i||l.percent!==i?l.distance*H.getZoom()>t._interactor.getStyle("edgeHostEdgeMaxDistance"):t._interactor.getStyle("edgeHostDetectPerFrame")?!0:l.x<0||l.x>1||l.y<0||l.y>1?!0:!1){var y=H.getDataAt(f,function(K){return H.isSelectable(K)?H.isSourceTargetEditable(E,K,X)?E.canSetSourceTarget(K,X)?!0:!1:!1:!1});if(y){var L=t._calcHostAnchor(E,X,f,y);A=y,t._nextChangeEdgeHost={type:X,host:y},l=L}}var _,b,Y;if(n||l.x===i)(l.percent!==i||l.index!==i)&&(b=l.point);else{var D=t._interactor.getStyle("anchorRound"),k=t._interactor.getStyle("anchorSensitivity");_=H.calculateAttachPoint(A,f),_?l=_.info:(l.x=em.roundTo(l.x,D,k),l.y=em.roundTo(l.y,D,k)),b=Zr(H,A,0,l.offsetX||0,l.offsetY||0,l.x,l.y)}b&&(Y=em.toScreenPosition(H,b),x.x=Y.x,x.y=Y.y),t._edgeHostGuideInfo={corners:em.getTargetCornersOnScreen(H,A),attach:_?_.index:-1,host:A};var S;return l.percent!==i?S="percent: "+l.percent.toFixed(2):l.index!==i?S="index: "+l.index:(S=""+l.x.toFixed(2)+", "+l.y.toFixed(2),(l.offsetX||l.offsetY)&&(S+=" offset: "+l.offsetX.toFixed(2)+", "+l.offsetY.toFixed(2))),{host:A,anchor:l,tipText:S}}},Nr.prototype._guidingToEdit=function(q,m){var v,T,$=this;if(v=$.screenInfo.curve){T=v._curves;var J,A,s,y,f,u,N,I,Q=1/0,r=1/0,k=[];for($.editing&&"realPoint"===$.editing.type&&(I=$.editing.point),f=0,u=2*T.length;u>f;f++)N=T[Math.floor(f/2)][f%2?"_p4":"_p1"],k.indexOf(N)>=0||(k.push(N),I&&I===N||(s=N.x-q.x,y=N.y-q.y,Math.abs(s)<Math.abs(Q)?(Q=s,J=[N]):s===Q&&J.push(N),Math.abs(y)<Math.abs(r)?(r=y,A=[N]):y===r&&A.push(N)));var G=$._interactor.getStyle("smartGuideThreshold");if((Math.abs(Q)>G||"y"===m)&&(J=null),(Math.abs(r)>G||"x"===m)&&(A=null),J||A){var W=!1,E={};
if(J&&(W=!0,E.xList=J,E.x=Q),A&&(W=!0,E.yList=A,E.y=r),W)return E}}},Nr.prototype._46O=function(O){var J=this;J.editing&&(J.editing=null,J._interactor.fi({kind:"endEditPoint",event:O})),J._guideInfo=null,J._edgeHostGuideInfo=null,J._pan&&(J._pan=null,J._interactor.fi({kind:"endPan",event:O})),J._multiSelect&&(J._handleMultiSelect(J._multiSelect),J._multiSelect=null),J.tipInfo=null,J.edgeEditResult=null},Nr.prototype._handleMultiSelect=function(V){if(V.startPoint&&V.endPoint){var Z,k,M,o,W,_=this,K=_._interactor,B=K.gv,R=em.toScreenPosition(B,V.startPoint),S=em.toScreenPosition(B,V.endPoint),A=v.Default.unionPoint(R,S),Y=_.screenInfo.curve._curves,f=[],e=function(F){F.x>=A.x&&F.y>=A.y&&F.x<=A.x+A.width&&F.y<=A.y+A.height&&f.indexOf(F)<0&&f.push(F)};for(Z=0,k=Y.length;k>Z;Z++)W=Y[Z],e(W._p1),e(W._p4);if(f.length){var D=_.activing||{},w=D.selections||[];for(D.point&&w.push(D.point),Z=0,k=w.length;k>Z;Z++)M=w[Z],o=f.indexOf(M),o>=0?f[o]=i:f.push(M);var Q=f;for(f=[],Z=0,k=Q.length;k>Z;Z++)Q[Z]&&f.push(Q[Z]);k=f.length,0===k?_.activing=null:1===k?_.activing={point:f[0]}:(M=f[k-1],_.activing={point:M,selections:f.splice(0,k-1)}),K.redraw()}}},Nr.prototype._canDeletePoint=function(w,h){var $=this.target;if(!($ instanceof v.Edge))return!0;var a=w._curves[0],n=w._curves[w._curves.length-1];return a._p1===h||n._p4===h?!1:!0},Nr.prototype.handleDelete=function(){var C=this;if(C.activing&&C.screenInfo){var V=v.Default.isShiftDown(),l=C.screenInfo.curve;C._canDeletePoint(l,C.activing.point)&&l.deleteRealPoint(C.activing.point,V),C.activing.selections&&C.activing.selections.forEach(function(w){C._canDeletePoint(l,w)&&l.deleteRealPoint(w,V)}),C.activing=null,delete C.editing,delete C.tipInfo,delete C.edgeEditResult,delete C._pan,delete C._multiSelect,C._writeToHt(),C._interactor.fp("deleteShapePoint",!1,!0)}},Nr.prototype.handleDoubleClick=function(p){var X=this,O=X._interactor._getLogicalPoint(p);if(X.screenInfo&&X._checkEditRealPoint(O)){var C=X.getCurrentSelectintStatus(),i=em.Curve.PointType;return C=C===i.Mirrored?i.Straight:i.Mirrored,X._setCurrentSelectionStatus(C),X._interactor._42(),!0}},Nr.prototype._drawHighlight=function(Y){var o=this,d=o.highlight;if(d){var f=d.bezier,c=o._interactor;f&&em.Icons.DrawIcon(c,Y,em.Icons.ShapeHighlightCurve,[f._p1.x,f._p1.y,f._p2.x,f._p2.y,f._p3.x,f._p3.y,f._p4.x,f._p4.y]);var s=d.point;s&&"insertKnot"===d.type&&em.Icons.DrawIcon(c,Y,em.Icons.ShapeHighlighPoint,s)}},Nr.prototype._drawGuide=function(E){var T=this,j=T._guideInfo;if(j){var A,m,q,L,X=j.v;for(A=0;2>A;A++)if(L=0===A?j.xList:j.yList)for(m=0,q=L.length;q>m;m++)em.Icons.DrawIcon(T._interactor,E,em.Icons.ShapeGuideLine,[X.x,X.y,L[m].x,L[m].y])}},Nr.prototype._drawCurrentPoint=function(I){var v=this;if(v.activing){var t=v.activing,f=v.getCurrentSelectintStatus(),o=v._interactor;if(f!==em.Curve.PointType.Straight){var q=t.pairs;t.hlpair,t.hltype;var T=t.selections,L=t.editingCtrl;if(q&&!T){var M,g,B;for(g=0,B=q.length;B>g;g++)M=q[g],L&&g===L.pairId&&M[L.type]?em.Icons.DrawIcon(o,I,em.Icons.ShapeActivingCtrl,{point:M.point,c1:M.c1,c2:M.c2,hl:L.type}):em.Icons.DrawIcon(o,I,em.Icons.ShapeActivingCtrl,M)}}em.Icons.DrawIcon(o,I,em.Icons.ShapeHighlighRealPoint,v.activing.point),T&&T.forEach(function(y){em.Icons.DrawIcon(o,I,em.Icons.ShapeHighlighRealPoint,y)})}},Nr.prototype.clear=function(){var d=this;d.editing=null,d._guideInfo=null,d.activing=null,d.highlight=null},Nr.prototype._42=function(B){var D=this;D.info={},D.editing||(D.screenInfo=null);var Y=D._interactor;if(!Y.editDetail)return D.clear(),void 0;var f=Y.gv;if(!D.target||!f.isSelected(D.target)||!f.isVisible(D.target))return Y.editDetail=!1,D.clear(),void 0;if(D.gatherSingleTarget(f,D.target),em.Icons.DrawIcon(Y,B,em.Icons.ShapeBgCurve,D.screenInfo),D._drawHighlight(B),D._drawCurrentPoint(B),D._getRealPoint().forEach(function(I){em.Icons.DrawIcon(Y,B,em.Icons.ShapePoint,I)}),D._drawGuide(B),D.tipInfo&&em.Icons.DrawIcon(Y,B,em.Icons.TipHelper,D.tipInfo),D._edgeHostGuideInfo){em.Icons.DrawIcon(Y,B,em.Icons.NodeHoverGuide,D._edgeHostGuideInfo.corners);var l=D._edgeHostGuideInfo.host;if(l){var o=f.getAttachPoints(l);if(o&&o.length)for(var s=0,x=o.length;x>s;s++){var N=o[s],i=Zr(f,l,0,N.offsetX||0,N.offsetY||0,N.x,N.y);i=em.toScreenPosition(f,i),i.isAttach=D._edgeHostGuideInfo.attach===s,em.Icons.DrawIcon(Y,B,em.Icons.AttachPoint,i)}}}if(D._interactor.getStyle("curveElevationVisible")&&(D.target instanceof v.Polyline||D.target instanceof v.Edge&&D._interactor.getStyle("edgeElevationEditable"))&&D.activing){var H=D.activing.getCurrentEditingPoint();H&&"string"!=typeof H.e&&em.Icons.DrawIcon(Y,B,em.Icons.EdgeElevationGuide,H)}if(D.edgeEditResult&&D._drawEdgeHostHighlight(B,D.edgeEditResult.host,D.edgeEditResult.anchor),D._multiSelect&&D._multiSelect.endPoint){var E=v.Default.unionPoint(em.toScreenPosition(f,D._multiSelect.startPoint),em.toScreenPosition(f,D._multiSelect.endPoint));E.color=f.getRectSelectBorderColor(),B.save(),B.setTransform(1,0,0,1,0,0);var m=u.devicePixelRatio,y=E.borderWidth=Math.round(m);y/=2,E.x=Math.round(E.x*m)+y,E.y=Math.round(E.y*m)+y,E.width=Math.round(E.width*m),E.height=Math.round(E.height*m),em.Icons.DrawIcon(Y,B,em.Icons.SimpleRect,E),B.restore()}},Nr.prototype._drawEdgeHostHighlight=function(C,O,U){this.drawEdgeHostHighlight(C,O,U),this._interactor.redraw()},Nr.prototype.drawEdgeHostHighlight=function(B,w,F){if(kn(w)){var b,m,V,X,K=this,v=K._interactor,D=v.gv,k=D.getDataUI(w),R=dr(k),s=[];for(V=0,X=R.points.length;X>V;V++)m=em.toScreenPosition(D,R.points.get(V)),s.push(m.x,m.y);R.segments&&(b=R.segments.toArray());var c=v.getStyle("edgeHostHighlighPeriod"),I=v.getStyle("edgeHostEdgeHighlighColor");em.Icons.DrawIcon(v,B,em.Icons.ShapeBgCurve,{P:s,S:b,color:I,dynamicVisible:F.index===i,dynamicPeriod:c}),I=v.getStyle("edgeHostPointHighlighColor");var H=Yf(k);for(V=0,X=H.length;X>V;V++){var y=H[V],e=em.toScreenPosition(D,y);em.Icons.DrawIcon(v,B,em.Icons.ShapePoint,{point:{x:e.x,y:e.y},color:I,size:12,dynamicVisible:V===F.index,dynamicPeriod:c})}}},Nr.prototype._getRealPoint=function(){var T,b=this.screenInfo,J=b.P,H=b.S,B=-1,R=[],v=-1,N=H.length;return H.each(function(S){v++;var j=1;if(3===S)j=2;else if(4===S)j=3;else if(5===S)return;B+=j,T=v+1>=N?!0:1===H.get(v+1)?!0:!1,R.push({point:{x:J[2*B],y:J[2*B+1]},segmentIndex:v,pointIndex:B,isEnd:T})}),R},Nr.prototype.getEditingPointsInfo=function(Z){var B=this,Q=B.activing;if(!Q)return!1;var a=Q.point;if(!a)return!1;var U=this._getRealPoint(),F=[{screen:a}];Q.selections&&Q.selections.forEach(function(G){F.push({screen:G})});var R,W,l=U.length;return F.forEach(function(L){for(R=0;l>R;R++)if(W=U[R],L.screen.isNearEnough(W.point)){L.segmentIndex=W.segmentIndex,L.pointIndex=W.pointIndex,L.point=B.target.getPoints().get(W.pointIndex);break}}),Z&&F.sort(function(A,v){return A.segmentIndex-v.segmentIndex}),F};var kh=em.MoveHelper=function(W){var z=this;z.catalog="Move",z._interactor=W};kh.prototype={},kh.prototype.constructor=kh,kh.prototype.calcShift=function(g,U,Z){var _,x,F=this,m=F._interactor.gv,J=m.lp(U);if("beginMove"===g&&F._gatherGridInfo(Z._lastLogicalPoint||J),_=F._target){var j=_.downPosition;if(j){var u=F._interactor.getStyle("moveSensitivity")/m._zoom;if(j.distanceTo(J)<u)return{x:0,y:0};delete _.downPosition}var W;x=v.Default.isShiftDown(U),x&&(J=F._dealShiftDown(J),W=_.shiftGuide.dir);var T,N=_.rawPos={x:_.pos.x+J.x-_.lp.x,y:_.pos.y+J.y-_.lp.y};if(v.Default.isCtrlDown(U)){if(T=F._calcShiftByAddon(),F._target.node instanceof em.Group){var M=F._target.node;M._position.x+=T.x,M._position.y+=T.y}return T}for(var w,i=_.x+N.x,Q=_.y+N.y,f={x:i,y:Q},E={x:i+_.w/2,y:Q+_.h/2},P={x:i+_.w,y:Q+_.h},k=F._interactor.rectGuide,O=F._interactor.gridGuide,L=[k.findClosest(f,W),k.findClosest(E,W),k.findClosest(P,W),O.findClosest(f,W),O.findClosest(E,W),O.findClosest(P,W)],h=1/0,K=1/0,p=0,q=L.length;q>p;p++)w=L[p],w&&(i=w.x,Q=w.y,isFinite(i)&&Math.abs(i)<Math.abs(h)&&(h=i),isFinite(Q)&&Math.abs(Q)<Math.abs(K)&&(K=Q));if(isFinite(h)||(h=0),isFinite(K)||(K=0),T=F._calcShiftByAddon(h,K),F._target.node instanceof em.Group){var M=F._target.node;M._position.x+=T.x,M._position.y+=T.y}var t=_.node;if(!eg(t,m)){var X=N.x+h,o=N.y+K;F._interactor.rectGuide.gatherLines({node:t,x:_.x+X,y:_.y+o,w:_.w,h:_.h},W)}return T}},kh.prototype._calcShiftByAddon=function(y,f){var i=this._target,d=i.rawPos,Z=i.node.getPosition();return y=y||0,f=f||0,{x:d.x-Z.x+y,y:d.y-Z.y+f}},kh.prototype._dealShiftDown=function(x){var V=this,E=V._target.shiftGuide,Q=V._target.lp,U=Math.abs(x.x-Q.x),r=Math.abs(x.y-Q.y);U>r&&U>E.limit&&"y"===E.dir&&(E.dir="x"),r>U&&r>E.limit&&"x"===E.dir&&(E.dir="y");var P=E.dir;return"x"===P?(x.y=Q.y,E.limit=Math.max(E.limit,U)):"y"===P&&(x.x=Q.x,E.limit=Math.max(E.limit,r)),x},kh.prototype._gatherGridInfo=function(E){var m,f=this,S=f._interactor,V=S._getValidSelection();if(V.length){if(1===V.length){if(m=V[0],!m.getRect)return f._target=null,void 0}else if(m=em.Group.findOrCreateGroup(V),!m)return f._target=null,void 0}else{var V=S.gv.sm().getSelection();if(V.length&&(m=V.get(0),!m.getRect))return f._target=null,void 0}var P=m.getPosition(),$=m.getRect();f._target={node:m,x:$.x-P.x,y:$.y-P.y,w:$.width,h:$.height,lp:{x:E.x,y:E.y},pos:{x:P.x,y:P.y},shiftGuide:{dir:"x",limit:0},downPosition:new em.Math.Vector2(E)},S.rectGuide.gatherRects()},kh.prototype.clear=function(){var F=this;F._interactor.rectGuide.clear(),F._interactor._42()};var Qo="directional",yf="point",Bd="spot",nj="light.color",hc={},Pk=function(U,L){tq(L)&&Kg.test(L)?Jm(U,L):as(L)&&L.modelType?Vn(U,L):gq[U]=L},bh=function(j){return j},Yg=function(Z){Z=C.convertShape3dModelName(Z);var M;if(as(Z)){if(Z.modelType){if(Z.uuid){if(M=gq[Z.uuid])return M}else Z.uuid=v.Math.generateUUID();return Vn(Z.uuid,Z),i}return Z}return M=gq[Z],Z&&M===i&&Kg.test(Z)&&(Yo&&Yo[Z]||Jm(Z,Z)),M},Er=function(N,D){N.frameStack?N.frameStack.push(D):N.frameStack=[D],N.bindFramebuffer(N.FRAMEBUFFER,D)},Sh=function(W){var i=W.frameStack;if(i){if(i.pop(),i.length)return W.bindFramebuffer(W.FRAMEBUFFER,i[i.length-1]),void 0;W.frameStack=null}W.bindFramebuffer(W.FRAMEBUFFER,null)};og(C,{graph3dViewAttributes:w,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:Q/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Oq,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:Q,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:Q/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:Pk,getShape3dModel:Yg,convertShape3dModelName:bh,getShape3dModelMap:function(){return gq},getCachedShape3dModelMap:function(){return Vm},createMatrix:function(F,Y){qf(F)||(F=[F]);for(var u=F.length-1;u>=0;u--){var r=F[u];Y=Xb(r.mat,r.s3,r.r3,r.rotationMode,r.t3,Y)}return Y},transformVec:function(X,x){return Vl(X,x)},glBindFrame:Er,glUnbindFrame:Sh,createBoxModel:function(){return{vs:rg,ns:Nj,uv:Wc,is:cj}},createRoundRectModel:function(G,y){return Pq.roundRect(G,y)},createStarModel:function(Z,L){return Pq.star(Z,L)},createRectModel:function(k,w){return Pq.rect(k,w)},createTriangleModel:function(E,V){return Pq.triangle(E,V)},createRightTriangleModel:function(F,u){return Pq.rightTriangle(F,u)},createParallelogramModel:function(f,W){return Pq.parallelogram(f,W)},createTrapezoidModel:function(E,s){return Pq.trapezoid(E,s)},createSmoothSphereModel:function(l,q,Z,t,R,c,J){return Qq(new tc(l,q,Z,t,R,c,J))},createSphereModel:function(p,n,h,V,T,m,G){return p?Aq(p,n,h,V,T,m,G):C.createSmoothSphereModel()},createSmoothConeModel:function(c,r,G,m,j){return On(c,r,G,m,j)},createConeModel:function(t,A,Z,a,E,_){return t?td(t,A,Z,a,E,_):On(_)},createSmoothCylinderModel:function(_,B,W,$,h,q,w,z){return Qq(new wk(_,B,W,$,h,q,w,z))},createCylinderModel:function(o,e,Y,c,f,K,W,h){return o?ri(o,e,Y,c,f,K,W,h):pc(K,W)},createSmoothTorusModel:function(n,A,w,k,e,x){return Qq(new ci(n,A,w,k,e,x))},createTorusModel:function(w,p,u,Q,d,S,I,c){return w?Kk(w,p,u,Q,d,S,I,c):cd(S,I)},createExtrusionModel:function(f,T,_,r,q,G,A,y){return gc(f,T,_,r,q,G,A,y)},createSmoothRingModel:function(B,p,L,i,S,h){for(var k=[],A=0;A<B.length-1;A+=2)k.push({x:B[A],y:B[A+1]});for(B=mm(k,p,L)[0],k=[],A=0;A<B.length;A++){var D=B[A];k.push(new qq(D.x,0,D.y))}return Qq(new Jl(k,h,i,S))},createTextGeometry:function(U,c){return Qq(new wq(U,c))},loadFontFace:function(P,$){C.xhrLoad(P,function(d){if(!d)return $();var A;try{A=JSON.parse(d)}catch(x){A=JSON.parse(d.substring(65,d.length-2))}pj.loadFace(A),$&&$(A.familyName.toLowerCase())},$?null:{sync:!0})},createRingModel:function(k,l,p,T,Q,f,E,I,M,X){for(var m=[],F=0;F<k.length-1;F+=2)m.push({x:k[F],y:k[F+1]});f=f||C.shapeSide,E=E||0,I=I||f;var d,V,$,P,O,J,j,Y,W,v,F,Z,u,B,x,s,t,G,U=[],S=[],h=M?[]:w,H=M?[]:w,r=X?[]:w,A=X?[]:w,N=T?[]:w,R=T?[]:w,i=Q?[]:w,D=Q?[]:w,k=mm(m,l,p),q=Xq(k),K=0,o=2*Math.PI/f;return k.forEach(function(g){if($=g.length,$>1){if(P=g[0],T)for(J=P.x,Y=P.y,F=E;I>F;F++)Z=F+1,u=F*o,B=Z*o,x=b(u),s=y(u),t=b(B),G=y(B),N.push(x*J,Y,-s*J,t*J,Y,-G*J,0,Y,0),R.push(.5-.5*x,.5-.5*s,.5-.5*t,.5-.5*G,.5,.5);for(v=0;$>v;v++){for(O=g[v],J=P.x,j=O.x,Y=P.y,W=O.y,d=K/q,K+=Sp(P,O),V=K/q,F=E;I>F;F++)Z=F+1,u=F*o,B=Z*o,x=b(u),s=y(u),t=b(B),G=y(B),U.push(x*j,W,-s*j,t*j,W,-G*j,x*J,Y,-s*J,t*j,W,-G*j,t*J,Y,-G*J,x*J,Y,-s*J),S.push(F/f,V,Z/f,V,F/f,d,Z/f,V,Z/f,d,F/f,d),M&&F===E&&(h.push(0,Y,0,0,W,0,x*j,W,-s*j,x*j,W,-s*j,x*J,Y,-s*J,0,Y,0),H.push(0,.5-Y,0,.5-W,2*j,.5-W,2*j,.5-W,2*J,.5-Y,0,.5-Y)),X&&Z===I&&(r.push(0,Y,0,t*j,W,-G*j,0,W,0,t*j,W,-G*j,0,Y,0,t*J,Y,-G*J),A.push(1,.5-Y,1-2*j,.5-W,1,.5-W,1-2*j,.5-W,1,.5-Y,1-2*J,.5-Y));P=O}if(Q)for(J=P.x,Y=P.y,F=E;I>F;F++)Z=F+1,u=F*o,B=Z*o,x=b(u),s=y(u),t=b(B),G=y(B),i.push(t*J,Y,-G*J,x*J,Y,-s*J,0,Y,0),D.push(.5-.5*t,.5+.5*G,.5-.5*x,.5+.5*s,.5,.5)}}),{vs:U,uv:S,bottom_vs:i,bottom_uv:D,top_vs:N,top_uv:R,from_vs:h,from_uv:H,to_vs:r,to_uv:A}}},!0),og(Y,{"3d.move.mode":i,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percent":1,"shape.border.gradient.color":i,"edge.gradient.color":i,"edge.source.t3":i,"edge.target.t3":i,"light.type":yf,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":Q/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Un,"wf.short":!1,"wf.mat":i,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:i,"transparent.mask":!1,brightness:i,"select.brightness":.7,"repeat.uv.length":i,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":i,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":or,"label.t3":i,"label.r3":i,"label.texture.scale":2,"label.rotationMode":pg,"label.light":!1,"label.blend":i,"label.reverse.flip":!1,"label.reverse.color":Mi,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":or,"label2.t3":i,"label2.r3":i,"label2.texture.scale":2,"label2.rotationMode":pg,"label2.light":!1,"label2.blend":i,"label2.reverse.flip":!1,"label2.reverse.color":Mi,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":or,"note.t3":i,"note.r3":i,"note.texture.scale":2,"note.rotationMode":pg,"note.light":!1,"note.blend":i,"note.reverse.flip":!1,"note.reverse.color":Mi,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":or,"note2.t3":i,"note2.r3":i,"note2.texture.scale":2,"note2.rotationMode":pg,"note2.light":!1,"note2.blend":i,"note2.reverse.flip":!1,"note2.reverse.color":Mi,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:i,"shape3d.color":Pd,"shape3d.top.color":i,"shape3d.bottom.color":i,"shape3d.from.color":i,"shape3d.to.color":i,"shape3d.image":i,"shape3d.top.image":i,"shape3d.bottom.image":i,"shape3d.from.image":i,"shape3d.to.image":i,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":i,"shape3d.side.to":i,"shape3d.smooth":i,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":i,"shape3d.opacity":i,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Mi,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":i,"shape3d.uv.scale":i,"shape3d.top.uv.offset":i,"shape3d.top.uv.scale":i,"shape3d.bottom.uv.offset":i,"shape3d.bottom.uv.scale":i,"shape3d.from.uv.offset":i,"shape3d.from.uv.scale":i,"shape3d.to.uv.offset":i,"shape3d.to.uv.scale":i,"shape3d.top.cap":i,"shape3d.bottom.cap":i,"shape3d.start.angle":0,"shape3d.sweep.angle":e,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"texture.mipmap.max":i,"texture.filter":i,"texture.filter.min":i,"texture.filter.mag":i,"all.light":!0,"all.visible":!0,"all.color":Pd,"all.image":i,"all.blend":i,"all.opacity":i,"all.reverse.flip":!1,"all.reverse.color":Mi,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":i,"all.uv.offset":i,"all.uv.scale":i,"all.discard.selectable":!0,mat:i,"left.mat":i,"right.mat":i,"top.mat":i,"bottom.mat":i,"front.mat":i,"back.mat":i},!0);var fo,Bl=!1,ae=[0,0,0,0],fr={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Nh,2:He,3:Gh,4:Qc,5:or,6:Dd}},Cf=function(G,N,b,x){if(N.getFaceVisible(G,b)){Bf(N,sf(G,N.getFaceMat(G,b)||N.getMat(G)));var C=N._26I;N.getFaceReverseCull(G,b)?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),Vi(C,N._prg.uFixPickReverseColor,fr[b]),Nq(C),Sl(C,x,6),xp(C),$i(N)}},Nb=function(v){return v instanceof Sb},lc=function(W){return[W.x,W.e||0,W.y]},dk=function(C,d,T){for(var d=_g(d),r=d[0],A=d[1],u=d[2];T--;)C.push(r,A,u)},Bg=function(N,C,b){for(var C=_g(C),V=C[0],g=C[1],y=C[2],Q=C[3];b--;)N.push(V,g,y,Q)},zg=function(w,Z,F){if(Z)for(var j,P,S,a=Z[0],Q=Z[1],k=Z[2],r=Z[4],g=Z[5],U=Z[6],y=Z[8],O=Z[9],q=Z[10],_=Z[12],h=Z[13],A=Z[14],W=F.length,M=0,M=0;W>M;M+=3)j=F[M],P=F[M+1],S=F[M+2],w.push(a*j+r*P+y*S+_,Q*j+g*P+O*S+h,k*j+U*P+q*S+A);else ho(w,F)},Eh=function(A,u){var P=u.s("light.intensity"),F=_g(u.s(nj)),B=F[0],q=F[1],M=F[2];1!==P&&(B*=P,q*=P,M*=P),A.push(B,q,M,u.s("light.disabled")?1:0)},on=function(B,s,H){Vi(s,H.uHeadlightRange,B._headlightRange),Vi(s,H.uHeadlightAmbientIntensity,B._headlightAmbientIntensity);var N=B._headlightIntensity,e=_g(B._headlightColor);1!==N&&(e=[e[0]*N,e[1]*N,e[2]*N]),Vi(s,H.uHeadlightColor,[e[0],e[1],e[2],B._headlightDisabled?1:0]);var P=B._59O,x=B._spots,E=B._dirs;if(P.length){var U=[],m=[],g=[];P.forEach(function(i){Eh(U,i),ho(m,B._transformPointToViewSpace(i.p3())),g.push(i.s("light.range"))}),s.uniform4fv(H.uPointColor,U),s.uniform1fv(H.uPointRange,g),s.uniform3fv(H.uPointPosition,m)}if(x.length){var u=[],y=[],C=[],o=[],A=[],q=[];x.forEach(function(H){Eh(u,H),ho(y,B._transformPointToViewSpace(H.p3())),ho(A,B._transformDirectionToViewSpace(H.p3(),H.s("light.center"))),C.push(H.s("light.range")),o.push(b(H.s("light.angle")/2)),q.push(H.s("light.exponent"))}),s.uniform4fv(H.uSpotColor,u),s.uniform1fv(H.uSpotRange,C),s.uniform1fv(H.uSpotAngle,o),s.uniform1fv(H.uSpotExponent,q),s.uniform3fv(H.uSpotPosition,y),s.uniform3fv(H.uSpotDirection,A)}if(E.length){var Z=[],v=[];E.forEach(function(F){Eh(Z,F),ho(v,B._transformDirectionToViewSpace(F.p3()))}),s.uniform4fv(H.uDirColor,Z),s.uniform3fv(H.uDirDirection,v)}},Lk=function($){return Math.max(C.graph3dViewMinPhi+oc,Math.min(C.graph3dViewMaxPhi-oc,$))},Ep=function(){return.05+h()/2},ph=function(_,A,W,X){var g,d=_.getEye();return _.isOrtho()?(g=jp(_.getCenter(),d),g[0]+=X[0],g[1]+=X[1],g[2]+=X[2]):g=d,Zm(A,W,X,g)},Zm=function(e,Q,X,d){var V=xq(e,Q),_=jp(d,X,!0),R=xq(_,Q);if(l(R)<oc)return w;var q=(V-xq(X,Q))/R;return[X[0]+_[0]*q,X[1]+_[1]*q,X[2]+_[2]*q]},Jk=function(N,G){return{x:2*N.x-G.x,y:2*N.y-G.y}},kk=function($,U,w,W){var E,l;if(!$)return E=T(U.y-w.y,w.x-U.x),{x:U.x+W*y(E),y:U.y+W*b(E)};if(!w)return E=T($.y-U.y,U.x-$.x),{x:U.x+W*y(E),y:U.y+W*b(E)};var q=jp([$.x,$.y,0],[U.x,U.y,0],!0),C=jp([w.x,w.y,0],[U.x,U.y,0],!0),p=-(q[0]+C[0])/2,t=-(q[1]+C[1])/2,R=Z(p*p+t*t);if(oc>R)return E=T($.y-U.y,U.x-$.x),{x:U.x+W*y(E),y:U.y+W*b(E)};var e=$.x-U.x,P=$.y-U.y,S=w.x-U.x,i=w.y-U.y,k=Z(e*e+P*P),z=Z(S*S+i*i);E=g(xq(q,C))/2,l=q[1]*C[0]-q[0]*C[1]>0?-1:1,p/=R,t/=R;var K=W/y(E),L=H(k,z)/b(E);R=Math.min(K,L);var c={x:U.x+l*R*p,y:U.y+l*R*t};return w.b&&K>z/b(E)&&(c.adjust=!0),c},id=function(f){var J=f[1],e=f[2],d=f[3],I=f[6],L=f[7],u=f[11];f[1]=f[4],f[2]=f[8],f[3]=f[12],f[4]=J,f[6]=f[9],f[7]=f[13],f[8]=e,f[9]=I,f[11]=f[14],f[12]=d,f[13]=L,f[14]=u},vp=function(h){var C=h[0],f=h[1],J=h[2],V=h[3],a=h[4],e=h[5],g=h[6],p=h[7],i=h[8],M=h[9],D=h[10],Q=h[11],Y=h[12],z=h[13],U=h[14],T=h[15],l=C*e-f*a,r=C*g-J*a,c=C*p-V*a,E=f*g-J*e,G=f*p-V*e,W=J*p-V*g,x=i*z-M*Y,O=i*U-D*Y,$=i*T-Q*Y,X=M*U-D*z,F=M*T-Q*z,u=D*T-Q*U,d=l*u-r*F+c*X+E*$-G*O+W*x;return d?(d=1/d,h[0]=(e*u-g*F+p*X)*d,h[1]=(J*F-f*u-V*X)*d,h[2]=(z*W-U*G+T*E)*d,h[3]=(D*G-M*W-Q*E)*d,h[4]=(g*$-a*u-p*O)*d,h[5]=(C*u-J*$+V*O)*d,h[6]=(U*c-Y*W-T*r)*d,h[7]=(i*W-D*c+Q*r)*d,h[8]=(a*F-e*$+p*x)*d,h[9]=(f*$-C*F-V*x)*d,h[10]=(Y*G-z*c+T*l)*d,h[11]=(M*c-i*G-Q*l)*d,h[12]=(e*O-a*X-g*x)*d,h[13]=(C*X-f*O+J*x)*d,h[14]=(z*r-Y*E-U*l)*d,h[15]=(i*E-M*r+D*l)*d,void 0):w},Hd=function(q,E){if(E){var L=E[0],T=E[1],b=E[2];q[12]=q[0]*L+q[4]*T+q[8]*b+q[12],q[13]=q[1]*L+q[5]*T+q[9]*b+q[13],q[14]=q[2]*L+q[6]*T+q[10]*b+q[14],q[15]=q[3]*L+q[7]*T+q[11]*b+q[15]}},Ko=function(v,w){if(w){var $=w[0],o=w[1],O=w[2];v[0]=v[0]*$,v[1]=v[1]*$,v[2]=v[2]*$,v[3]=v[3]*$,v[4]=v[4]*o,v[5]=v[5]*o,v[6]=v[6]*o,v[7]=v[7]*o,v[8]=v[8]*O,v[9]=v[9]*O,v[10]=v[10]*O,v[11]=v[11]*O}},qo=function(G,j,w){var y=j[0],P=j[1],J=j[2],F=j[3],V=j[4],k=j[5],R=j[6],c=j[7],n=j[8],E=j[9],I=j[10],e=j[11],L=j[12],l=j[13],K=j[14],B=j[15],Z=w[0],i=w[1],S=w[2],M=w[3];return G[0]=Z*y+i*V+S*n+M*L,G[1]=Z*P+i*k+S*E+M*l,G[2]=Z*J+i*R+S*I+M*K,G[3]=Z*F+i*c+S*e+M*B,Z=w[4],i=w[5],S=w[6],M=w[7],G[4]=Z*y+i*V+S*n+M*L,G[5]=Z*P+i*k+S*E+M*l,G[6]=Z*J+i*R+S*I+M*K,G[7]=Z*F+i*c+S*e+M*B,Z=w[8],i=w[9],S=w[10],M=w[11],G[8]=Z*y+i*V+S*n+M*L,G[9]=Z*P+i*k+S*E+M*l,G[10]=Z*J+i*R+S*I+M*K,G[11]=Z*F+i*c+S*e+M*B,Z=w[12],i=w[13],S=w[14],M=w[15],G[12]=Z*y+i*V+S*n+M*L,G[13]=Z*P+i*k+S*E+M*l,G[14]=Z*J+i*R+S*I+M*K,G[15]=Z*F+i*c+S*e+M*B,G},xo=function(o,b,A,X){var p,d,U,P,D,y,n,r,x,h,M=b[0],G=b[1],u=b[2],s=X[0],t=X[1],C=X[2],I=A[0],q=A[1],_=A[2];return l(M-I)<oc&&l(G-q)<oc&&l(u-_)<oc?Wi(o):(n=M-I,r=G-q,x=u-_,h=1/Z(n*n+r*r+x*x),n*=h,r*=h,x*=h,p=t*x-C*r,d=C*n-s*x,U=s*r-t*n,h=Z(p*p+d*d+U*U),h?(h=1/h,p*=h,d*=h,U*=h):(p=0,d=0,U=0),P=r*U-x*d,D=x*p-n*U,y=n*d-r*p,h=Z(P*P+D*D+y*y),h?(h=1/h,P*=h,D*=h,y*=h):(P=0,D=0,y=0),o[0]=p,o[1]=P,o[2]=n,o[3]=0,o[4]=d,o[5]=D,o[6]=r,o[7]=0,o[8]=U,o[9]=y,o[10]=x,o[11]=0,o[12]=-(p*M+d*G+U*u),o[13]=-(P*M+D*G+y*u),o[14]=-(n*M+r*G+x*u),o[15]=1,o)},wi=function(C,V,f,p,R){var H=1/S(V/2),z=1/(p-R);return C[0]=H/f,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=H,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=(R+p)*z,C[11]=-1,C[12]=0,C[13]=0,C[14]=2*R*p*z,C[15]=0,C},Fn=function(f,F,D,H,R,W,Y){var S=1/(F-D),i=1/(H-R),n=1/(W-Y);return f[0]=-2*S,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*i,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*n,f[11]=0,f[12]=(F+D)*S,f[13]=(R+H)*i,f[14]=(Y+W)*n,f[15]=1,f},Xm=function(b,q){var W=q[0],x=q[1],r=q[2],o=q[3],m=W*W+x*x+r*r+o*o,N=m?1/m:0;return b[0]=-W*N,b[1]=-x*N,b[2]=-r*N,b[3]=o*N,b},fg=function(a,n){var j=n[0]+n[5]+n[10],L=0;return j>0?(L=2*Math.sqrt(j+1),a[3]=.25*L,a[0]=(n[6]-n[9])/L,a[1]=(n[8]-n[2])/L,a[2]=(n[1]-n[4])/L):n[0]>n[5]&n[0]>n[10]?(L=2*Math.sqrt(1+n[0]-n[5]-n[10]),a[3]=(n[6]-n[9])/L,a[0]=.25*L,a[1]=(n[1]+n[4])/L,a[2]=(n[8]+n[2])/L):n[5]>n[10]?(L=2*Math.sqrt(1+n[5]-n[0]-n[10]),a[3]=(n[8]-n[2])/L,a[0]=(n[1]+n[4])/L,a[1]=.25*L,a[2]=(n[6]+n[9])/L):(L=2*Math.sqrt(1+n[10]-n[0]-n[5]),a[3]=(n[1]-n[4])/L,a[0]=(n[8]+n[2])/L,a[1]=(n[6]+n[9])/L,a[2]=.25*L),a},Nc=function($,n,p){var _=n[0],l=n[1],g=n[2],K=n[3],M=_+_,W=l+l,o=g+g,Y=_*M,T=_*W,X=_*o,i=l*W,A=l*o,d=g*o,D=K*M,m=K*W,x=K*o;return $[0]=1-(i+d),$[1]=T+x,$[2]=X-m,$[3]=0,$[4]=T-x,$[5]=1-(Y+d),$[6]=A+D,$[7]=0,$[8]=X+m,$[9]=A-D,$[10]=1-(Y+i),$[11]=0,$[12]=p[0],$[13]=p[1],$[14]=p[2],$[15]=1,$},Zk=function(Y,g){if(Y.vr.enable){var F=Y.vr.getViewMatrix(g);if(F)return F}return xo(g?g:Kr(),Y._eye,Y._center,Y._up)},br=function(P,W){if(P.vr.enable){var w=P.vr.getProjectMatrix();if(w)return w}if(!W&&P._computedProjectMatrix)return Ef(P._computedProjectMatrix);var y=P.getAspect(),L=P._near,a=P._far,E=Kr();if(P._ortho){var u=P._orthoWidth/2,A=u/y;Fn(E,-u,u,-A,A,L,a)}else wi(E,P._fovy,y,L,a);return E},Dh=function(N,T){if(!N)return w;var A=0,k=1,u=2,q=[],F=0,K=N.length,y=K/3;if(T){for(;K>F;F++)q[F]=0;for(F=0;F<T.length;F+=3){var R=[],b=[],r=[];R[A]=N[3*T[F+1]+A]-N[3*T[F]+A],R[k]=N[3*T[F+1]+k]-N[3*T[F]+k],R[u]=N[3*T[F+1]+u]-N[3*T[F]+u],b[A]=N[3*T[F+2]+A]-N[3*T[F+1]+A],b[k]=N[3*T[F+2]+k]-N[3*T[F+1]+k],b[u]=N[3*T[F+2]+u]-N[3*T[F+1]+u],r[A]=R[k]*b[u]-R[u]*b[k],r[k]=R[u]*b[A]-R[A]*b[u],r[u]=R[A]*b[k]-R[k]*b[A];for(var n=0;3>n;n++)q[3*T[F+n]+A]+=r[A],q[3*T[F+n]+k]+=r[k],q[3*T[F+n]+u]+=r[u]}}else for(F=0;y>F;F+=3){var R=[],b=[],r=[];R[A]=N[3*(F+1)+A]-N[3*F+A],R[k]=N[3*(F+1)+k]-N[3*F+k],R[u]=N[3*(F+1)+u]-N[3*F+u],b[A]=N[3*(F+2)+A]-N[3*(F+1)+A],b[k]=N[3*(F+2)+k]-N[3*(F+1)+k],b[u]=N[3*(F+2)+u]-N[3*(F+1)+u],r[A]=R[k]*b[u]-R[u]*b[k],r[k]=R[u]*b[A]-R[A]*b[u],r[u]=R[A]*b[k]-R[k]*b[A];for(var n=0;3>n;n++)q[3*(F+n)+A]=r[A],q[3*(F+n)+k]=r[k],q[3*(F+n)+u]=r[u]}for(F=0;K>F;F+=3){var V=[];V[A]=q[F+A],V[k]=q[F+k],V[u]=q[F+u];var s=Z(V[A]*V[A]+V[k]*V[k]+V[u]*V[u]);0===s&&(s=oc),V[A]=V[A]/s,V[k]=V[k]/s,V[u]=V[u]/s,q[F+A]=V[A],q[F+k]=V[k],q[F+u]=V[u]}return new Ud(q)},mq=function(_,P,z,s){if(z||(z=_.createTexture()),P){var k=_.TEXTURE_2D,O=_.REPEAT,B=_.CLAMP_TO_EDGE,n=_.TEXTURE_MIN_FILTER;s=s||af;var l=s.minFilter||s.filter||_.LINEAR,t=s.magFilter||s.filter||_.LINEAR;Wl(_,z),_.texImage2D(k,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,P),Gq(_,_.TEXTURE_MAG_FILTER,t);var x=P.naturalWidth||P.width,u=P.naturalHeight||P.height;No.isPOT(x)&&No.isPOT(u)&&!P.clampToEdge?(Gq(_,_.TEXTURE_WRAP_S,O),Gq(_,_.TEXTURE_WRAP_T,O),Gq(_,n,l===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR),s.mipmapMaxLevel!==i&&Gq(_,_.TEXTURE_MAX_LEVEL,s.mipmapMaxLevel),_.generateMipmap(k)):(Gq(_,_.TEXTURE_WRAP_S,B),Gq(_,_.TEXTURE_WRAP_T,B),Gq(_,n,l)),Wl(_,w)}return z},Ob=function(I,F){var C=new Uint8Array(4);return F=F||I.createTexture(),Wl(I,F),Gq(I,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,C),F},Kd=function(s){s._26I&&s._prg&&(s._26I.deleteProgram(s._prg),s._prg=w)},fk=function(I,K,D,i){var T=I.createShader(D);return I.shaderSource(T,i),I.compileShader(T),I.attachShader(K,T),T},Dm=function(f){return f.createBuffer()},Wl=function(P,p){P.bindTexture(P.TEXTURE_2D,p)},Gq=function(r,z,J){r.texParameteri(r.TEXTURE_2D,z,J)},es=function(P,X){P.enable(P.POLYGON_OFFSET_FILL),P.polygonOffset(X[0],X[1])},qh=function(G){G.disable(G.POLYGON_OFFSET_FILL)},Lb=function(K,_){if(_){var _=_g(_);K.clearColor(_[0],_[1],_[2],_[3])}},Ec=function(o,T){Vi(o,T.uFix,!0),zp(o,T.aNormal)},Xd=function(i,T){Vi(i,T.uFix,!1),Km(i,T.aNormal)},gm=function(B,S,R,Y,g,t,i,Z){B._picking||(R?(Vi(B,S.uBlend,!0),Vi(B,S.uBlendColor,R)):Vi(B,S.uBlend,!1),Vi(B,S.uLight,Y==w?!0:Y),Vc(g)&&1!==g&&Vi(B,S.uPartOpacity,g),Vi(B,S.uReverseFlip,t==w?!1:t),Vi(B,S.uFixPickReverseColor,i||Mi)),Z?B.enable(B.CULL_FACE):B.disable(B.CULL_FACE)},pr=function(P,p){P._picking||Vi(P,p.uPartOpacity,1)},Nq=function(){var R=[0,0,1,1];return function(J,T,d,N,G,Y,l,D,e){return d?(Vi(J,T.uTexture,!0),Vi(J,T.uDiscardSelectable,tl(N)?N:!0),Km(J,T.aUv),xg(J,G,Y,T.aUv,2),e?(Vi(J,T.uBlendTexture,!0),J.activeTexture(J.TEXTURE1),Wl(J,e),J.uniform1i(T.uBlendSampler,1)):(Vi(J,T.uBlendTexture,!1),J.activeTexture(J.TEXTURE1),Wl(J,J._emptyBlendTexture)),J.activeTexture(J.TEXTURE0),Wl(J,d),J.uniform1i(T.uSampler,0),l?(R[0]=l[0],R[1]=l[1]):(R[0]=0,R[1]=0),D?(R[2]=D[0],R[3]=D[1]):(R[2]=1,R[3]=1),Vi(J,T.uOffsetScale,R),void 0):(J.activeTexture(J.TEXTURE0),Wl(J,J._emptyTexture),J.activeTexture(J.TEXTURE1),Wl(J,J._emptyBlendTexture),void 0)}}(),xp=function(s,b,D){s.activeTexture(s.TEXTURE0),Wl(s,w),s.activeTexture(s.TEXTURE1),Wl(s,w),D&&(zp(s,b.aUv),Vi(s,b.uTexture,!1),Vi(s,b.uBlendTexture,!1))},Kn=function(u,m,V,T,z,j){!V||pk||nc||u.lineWidth(V),T&&!u._picking&&Vi(u,m.uFixPickReverseColor,T),z&&xg(u,z,j,m.aPosition)},Jj=function(x,H,_,l){fo&&(l=x[fo]),x.drawArrays(l==w?x.TRIANGLES:l,H,_);var A=x._renderInfo;A&&(A.calls++,A.vertices+=_,(l==w||l===x.TRIANGLES)&&(A.faces+=_/3),l===x.LINES&&(A.lines+=_/2))},Sl=function(M,D,s,A){fo&&(A=M[fo]),M.drawElements(A==w?M.TRIANGLES:A,s,M.UNSIGNED_SHORT,D==w?0:2*D);var N=M._renderInfo;N&&(N.calls++,N.vertices+=s,(A==w||A===M.TRIANGLES)&&(N.faces+=s/3),A===M.LINES&&(N.lines+=s/2))},jg=function(Y,x,H,y,A){var e=Y.ARRAY_BUFFER;Y.bindBuffer(e,x),H&&Y.bufferData(e,H,Y.STATIC_DRAW),y!=w&&Y.vertexAttribPointer(y,A?A:3,Y.FLOAT,!1,0,0)},xg=function(C,n,c,z,d){return c?(Wb(C,C.ARRAY_BUFFER,n,c),z!=w&&C.vertexAttribPointer(z,d?d:3,C.FLOAT,!1,0,0),void 0):jg(C,n,c,z,d)},bg=function(B,i,X){var E=B.ELEMENT_ARRAY_BUFFER;B.bindBuffer(E,i),X&&B.bufferData(E,X,B.STATIC_DRAW)},gn=function(F,S,C){Wb(F,F.ELEMENT_ARRAY_BUFFER,S,C)},Wb=function(I,T,A,B){var q=B._bufId;q||(q=B._bufId=v.Math.generateIncreasingID());var A,P=I._bufPool;(A=P[q])&&A._buf?I.bindBuffer(T,A._buf):(A=P[q]={_buf:Dm(I)},I.bindBuffer(T,A._buf),I.bufferData(T,B,I.STATIC_DRAW)),A._fid=I._renderInfo.frame},Vi=function(Z,c,H){if(H!=w&&c!=w){H=_g(H);var z=H.length;3===z?Z.uniform3fv(c,H):4===z?Z.uniform4fv(c,H):16===z?Z.uniformMatrix4fv(c,!1,H):tl(H)?Z.uniform1i(c,H?1:0):2===z?Z.uniform2fv(c,H):Z.uniform1f(c,H)}},Km=function(n,e){e!=w&&e>=0&&n.enableVertexAttribArray(e)},zp=function(W,M){M!=w&&M>=0&&W.disableVertexAttribArray(M)},$i=function(c,o){var b=c.getGL(),y=c._prg;c._7O=c._8O.pop(),o&&(Vi(b,y.uMVMatrix,c._7O),c._6O=o,Vi(b,y.uNMatrix,o))},cr=function(K,J){return J||(J=Kr()),sb(J,K),vp(J),id(J),J},Bf=function(o,v){var j=o.getGL(),u=o._prg,Z=o._7O;v&&(o._8O.push(Ef(Z)),Vi(j,u.uMMatrix,v),qo(Z,Z,v),o._7O=Z),Vi(j,u.uMVMatrix,Z),Vi(j,u.uNMatrix,cr(Z,o._6O))},pq=function(O,N,k,p,y,u){if(k){if(p){var r=k.value++,c=2147483648|r,P=[(255&c>>16)/255,(255&c>>8)/255,(255&c)/255,(255&c>>24)/255];k[r]={data:y,part:u}}else P=ae;return Vi(O,N.uFixPickReverseColor,P),P}},zi=function(){var Q={center:function(H,b,O,i,R){var Q=-b[1]/2,I={x:-b[0]/2,y:Q,width:b[0],height:b[1]},e=vb(H,I,O);return[e.x+i,-e.y-R,Ep()]},front:function(H,S,g,E,a){var T=-S[1]/2,i={x:-S[0]/2,y:T,width:S[0],height:S[1]},_=vb(H,i,g);return[_.x+E,-_.y-a,S[2]/2+Ep()]},back:function(e,$,R,q,P){var V=-$[0]/2,j=-$[1]/2,L={x:V,y:j,width:$[0],height:$[1]},Y=vb(e,L,R);return[-Y.x-q,-Y.y-P,-$[2]/2-Ep()]},left:function(r,m,j,y,v){var O=-m[1]/2,E={x:-m[2]/2,y:O,width:m[2],height:m[1]},W=vb(r,E,j);return[-m[0]/2-Ep(),-W.y-v,W.x+y]
},right:function($,K,v,s,m){var o=-K[2]/2,d=-K[1]/2,b={x:o,y:d,width:K[2],height:K[1]},R=vb($,b,v);return[K[0]/2+Ep(),-R.y-m,-R.x-s]},top:function(Y,i,B,y,D){var $={x:-i[0]/2,y:-i[2]/2,width:i[0],height:i[2]},X=vb(Y,$,B);return[X.x+y,i[1]/2+Ep(),X.y+D]},bottom:function(k,y,Y,K,i){var Q=-y[2]/2,G={x:-y[0]/2,y:Q,width:y[0],height:y[2]},m=vb(k,G,Y);return[m.x+K,-y[1]/2-Ep(),-m.y-i]}};return function(h,D,y,L,z,J){return Q[L](h,D,y,z||0,J||0)}}(),Hc=function(K,v,J,r,I,P,M,X,b,l){if(I&&(v[0]+=I[0],v[1]+=I[1],v[2]+=I[2]),Hd(K,J),X){var i=Kr();if(Oh(i,b,l),Vl(v,i),Hd(K,v),K.auto=X,K.pos=Vl([0,0,0],K),P){var o=K.mat2=Kr();Oh(o,P,M)}}else Oh(K,b,l),Hd(K,v),r===Nh?hr(K,-k):r===He?hr(K,k):r===Gh?pm(K,-k):r===Qc?pm(K,k):r===Dd&&hr(K,Q),Oh(K,P,M);return K},dn=function(y,G){var c=G.auto,h=G.mat2,O=y.gv;if(c){var k,j=Kr(),n=[0,0,0,0];k="string"==typeof c?[c.indexOf("x")<0?O._eye[0]:O._center[0],c.indexOf("y")<0?O._eye[1]:O._center[1],c.indexOf("z")<0?O._eye[2]:O._center[2]]:O._eye,fg(n,xo(Kr(),k,O._center,O._up)),Nc(j,Xm(n,n),G.pos),h&&qo(j,j,h),Bf(O,j)}else Bf(O,G)},Cb=function(L,G,_,Q,h){var O=L.s,e=L.gv,K=e.getGL(),M=e._prg,b=e._buffer,x=e._1O;mq(K,ul,x),dn(L,_),gm(K,M,O(G+".blend"),O(G+".light"),O(G+".opacity"),O(G+".reverse.flip"),O(G+".reverse.color"),O(G+".reverse.cull")),Nq(K,M,x,h,b.uv,th),xg(K,b.vs,Q,M.aPosition),xg(K,b.ns,ro,M.aNormal),gn(K,b.is,qd),Sl(K,0,qd.length),xp(K,M,x),pr(K,M),$i(e)},Ee=function(R,J,z){var P=R.gv,m=R.data,$=R[J]={blend:P.getBodyColor(m)||P.getFaceBlend(m,J),light:P.getFaceLight(m,J),color:P.getFaceColor(m,J),opacity:P.getFaceOpacity(m,J),transparent:P.getFaceTransparent(m,J),reverseFlip:P.getFaceReverseFlip(m,J),reverseColor:P.getFaceReverseColor(m,J),reverseCull:P.getFaceReverseCull(m,J),texture:P.getFaceImage(m,J),blendTexture:P.getFaceBlendImage(m,J),discardSelectable:P.getFaceDiscardSelectable(m,J)};if("csg"!==J){$.uv=P.getFaceUv(m,J)||z&&z[J+"Uv"],$.uvScale=P.getFaceUvScale(m,J)||z&&z[J+"UvScale"],$.uvOffset=P.getFaceUvOffset(m,J)||z&&z[J+"UvOffset"];var q=P.getFaceMat(m,J);q&&($.mat=sf(m,q))}return $},Ck=function(H,o,i,$,f){var v=H[$];if(v){if(!f(v.transparent))return;var D=H.data,B=H.gv,S=B._buffer,P=B.getTexture(v.texture,D,$),K=B.getTexture(v.blendTexture,D);Nq(o,i,P,v.discardSelectable,S.uv,v.tuv,v.uvOffset,v.uvScale,K),gm(o,i,v.blend,v.light,v.opacity,v.reverseFlip,v.reverseColor,v.reverseCull),Vi(o,i.uDiffuse,v.color||Y["color.empty"]),xg(o,S.vs,v.vs,i.aPosition),xg(o,S.ns,v.ns,i.aNormal),Jj(o,0,v.vs.length/3),pr(o,i),xp(o,i,P)}},kc=function(s,D,u,r,C,A){var q,U,G,V,_,z,N,n,t,x,c,W=[r-D,C-u],w=s?s.length:0;for(G=0;w>G;G++){for(V=2,q=s[G],_=q[0],z=q[1];V+1<q.length;){if(N=q[V],n=q[V+1],U=Xo(D,u,r,C,_,z,N,n,!0)){t=[N-_,n-z],x=Sp(t),t[0]/=x,t[1]/=x,x=xq(W,t),x=x>0?A:-A,c=[t[0]*x,t[1]*x];break}_=N,z=n,V+=2}if(c)break}if(c)for(r=D+c[0],C=u+c[1],G=0;w>G;G++)for(V=2,q=s[G],_=q[0],z=q[1];V+1<q.length;){if(N=q[V],n=q[V+1],U=Xo(D,u,r,C,_,z,N,n,!0))return[0,0];_=N,z=n,V+=2}return c?c:[r-D,C-u]},rj=v.graph3d={},Nf=function(q,r,I){vo(K+".graph3d."+q,r,I)},Lh="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",hq="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";og(C,{setBatchInfo:function(Y,n){Pe[Y]=n},getBatchInfo:function(Y){return Pe[Y]}},!0);var lf=[1,1,1],Fg=[1,0,0,0,0,1,0,1,1,1,1,0],Ig=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],dd=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],cg=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],El=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],En=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],An=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],ak=function(H,V){ue(H,V,"_batchModelMap","_batchIndexMap"),zn(H,V,"_wireframeModelMap","_wireframeIndexMap"),zn(H,V,"_polylineModelMap","_polylineIndexMap"),zn(H,V,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),zn(H,V,"_polylineModelMapSwap","_polylineIndexMapSwap")},ue=function(Y,d,h,M){if(!d)return Y[h]={},Y[M]={},void 0;var T=d._id,u=Y[M],l=u[T];if(l){var g=Y[h],L=l.batch,s=g[L],R=s.ds,X=l.index;if(s.invalidate=!0,delete u[T],R.splice(X,1),vi(R))return delete g[L],void 0;for(var j=l.begin,N=l.size,x=3*j,Z=3*N,c=4*j,H=4*N,y=s.vs,V=s.ps,U=s.uv,e=s.cs,b=s.bs,E=s.rs,q=s.ns,J=s.ls;X<R.length;X++)l=u[R[X]._id],l.index--,l.begin-=N;y.splice(x,Z),V.splice(c,H),U&&U.splice(2*j,2*N),e&&e.splice(c,H),b&&b.splice(x,Z),E&&E.splice(j,N),q&&q.splice(x,Z),J&&J.splice(j,N)}},zn=ue,jr=function(U,B,n,I){if(!I)return w;var W=B[I];if(!W){var V=Pe[I]||af,h=V.image?[]:w;W=B[I]={vs:[],ns:[],uv:h,cs:h?w:V.color?w:[],bs:V.blend?[]:w,ps:[],rs:V.brightness?[]:w,ds:[]}}return W.invalidate=!0,U[n._id]={index:W.ds.length,begin:W.vs.length/3,batch:I},W.ds.push(n),W},Bc=function(g,E){return E!=w&&1!==E?[g[0]*E,g[1]*E,g[2]*E,g[3]]:g},zo=function(){var f;return function(B,X,O){var E=B.getData3dUI(X),h=E.shapeModel;h||(h=Hf(E));var U,L=X.s("wf.combineTriangle");if(O.geometry){if(!h&&(X instanceof v.Node&&!(X instanceof v.Shape)?(f||(f={vs:rg,is:cj,uv:Wc}),h=f):h=[E.left,E.front,E.right,E.back,E.top,E.bottom],!h))return i;if(L?(L=0|Math.min(3,Math.max(1,isNaN(L)?1:L)),U=gk[L-1](h)):U=Id(h),!U||0===U.length)return}else U=O.short?pd:ug;var _=B.getBrightness(X),x=_g(O.color||"white"),K=x[3]<1,N=Math.ceil(O.width)||1,d=(K?"T":"O")+N,z=B._wireframeIndexMap,G=B._wireframeModelMap,a=G[d];a||(a=G[d]={vs:[],cs:[],ps:[],ds:[],T:K,W:N}),a.invalidate=!0;var R=a.vs,l=a.cs,$=a.ds,T=z[X._id]={index:$.length,begin:R.length/3,batch:d};$.push(X);var y=E.mat;if(!y||!O.geometry&&X instanceof v.Shape){y=sf(X,O.mat);var Y=E._calcAnchorMat(X);Y&&qo(y,y,Y)}zg(R,y,U);var t=T.size=R.length/3-T.begin;Bg(l,Bc(x,_),t)}}(),un=function(c,W,F,B,x,X,e,N,R){var m=c.getBrightness(W);m==w&&(m=1);var n=Bc(_g(B),m),G=n[3]<1;X=Math.ceil(X)||1;var V=(G?"T":"O")+X;if(e){var f=e[0],s=(e[1]||f)+f;V+="-"+f+"-"+s,R&&(V+="-"+Jf(R)+"-"+m,R=Bc(_g(R),m))}var z=c._polylineIndexMap,O=c._polylineModelMap,P=O[V];P||(P=O[V]={vs:[],cs:[],ps:[],ds:[],ls:e?[]:w,T:G,W:X},e&&(P.D=f,P.G=s,P.A=R)),P.invalidate=!0;var S,H=P.vs,i=P.cs,Q=P.ds,K=P.ls,_=z[W._id]={index:Q.length,begin:H.length/3,batch:V};Q.push(W),ho(H,F);var h,D=_.size=H.length/3-_.begin,Y=F.length,j=0,q=[];if(e||x)for(S=0;Y>S;S+=6)h=Sp([F[S],F[S+1],F[S+2]],[F[S+3],F[S+4],F[S+5]]),q.push(h),j+=h;if(j&&x){var k,y=Bc(_g(x),m),d=[y[0]-n[0],y[1]-n[1],y[2]-n[2],y[3]-n[3]],a=0;for(S=0;Y>S;S+=6)k=a/j,Bg(i,[n[0]+d[0]*k,n[1]+d[1]*k,n[2]+d[2]*k,n[3]+d[3]*k],1),a+=q[S/6],k=a/j,Bg(i,[n[0]+d[0]*k,n[1]+d[1]*k,n[2]+d[2]*k,n[3]+d[3]*k],1)}else Bg(i,n,D);if(e)for(a=N||0,S=0;Y>S;S+=6)K.push(a),a+=q[S/6],K.push(a)},rd=function(p,S,B){if(S)for(var _=4*S.begin,f=B[S.batch].ps,P=0;P<S.size;P++)f[_++]=p[0],f[_++]=p[1],f[_++]=p[2],f[_++]=p[3]},wb=function(l,U){var F=U+["32"],S=l[U],E=l[F];S?E&&E.length===S.length?(E.set(S),E._bufId=null):l[F]=new Ud(S):delete l[F]},Fj=function(M,f,K,c,P,L,F,m,p){if(qf(K))K.forEach(function(n){Fj(M,f,n,c,P,L,F,m,p)});else if(tq(K))Fj(M,f,Hf(c,K),c,P,L,F,m,p);else if(as(K)){var $,g=mo(K.mat,f,M),D=mo(K.s3,f,M),u=mo(K.t3,f,M),I=mo(K.r3,f,M);if((D||I||u||g)&&($=Xb(g,D,I,mo(K.rotationMode,f,M),u),L.push($)),K.shape3d)Fj(M,f,K.shape3d,c,P,L,F,m,K);else{var Y=c.s;p=p||af;var A=L[0],y=L.length,b=Y("shape3d.color",K.color,p.color);if(P||(P=Y("shape3d.blend",K.blend,p.blend)),y>1){A=Ef(A);for(var Q=1;y>Q;Q++)qo(A,A,L[Q])}K.vs&&Y(qk,K.visible,p.visible)&&vc(A,F,m,K.vs,K.uv,K.is,P,b),K.top_vs&&Y(Bh,K.topVisible,p.topVisible)&&vc(A,F,m,K.top_vs,K.top_uv,K.top_is,P,Y("shape3d.top.color",K.topColor,p.topColor)||b),K.bottom_vs&&Y(Um,K.bottomVisible,p.bottomVisible)&&vc(A,F,m,K.bottom_vs,K.bottom_uv,K.bottom_is,P,Y("shape3d.bottom.color",K.bottomColor,p.bottomColor)||b),K.from_vs&&Y(rn,K.fromVisible,p.fromVisible)&&vc(A,F,m,K.from_vs,K.from_uv,K.from_is,P,Y("shape3d.from.color",K.fromColor,p.fromColor)||b),K.to_vs&&Y(be,K.toVisible,p.toVisible)&&vc(A,F,m,K.to_vs,K.to_uv,K.to_is,P,Y("shape3d.to.color",K.toColor,p.toColor)||b)}$&&L.pop()}},vc=function(m,Q,c,v,R,V,k,j){var L,M=Q.cs,_=Q.uv,W=Q.bs;if(V){L=V.length;for(var e=0;L>e;e++){var b=V[e];zg(c,m,[v[3*b],v[3*b+1],v[3*b+2]]),_&&ho(_,[R[2*b],R[2*b+1]])}}else L=v.length/3,zg(c,m,v),_&&ho(_,R);M&&Bg(M,j,L),W&&(k?dk(W,k,L):ho(W,lf,L))},wf=function(V,N,Y,X){var v=[];X?Fj(V.gv,V.data,X,V,V.getBodyColor(),[N],Y,v):(jb(V,Nh,N,Y,v),jb(V,He,N,Y,v),jb(V,or,N,Y,v),jb(V,Dd,N,Y,v),jb(V,Gh,N,Y,v),jb(V,Qc,N,Y,v),jb(V,"csg",N,Y,v)),v.length&&(ho(Y.vs,v),ho(Y.ns,Dh(v)))},jb=function(J,g,B,V,m){var E=J[g];if(E){var d=E.tuv;if(d){var q,h,v,u,N=E.uvScale,D=E.uvOffset;if(N)for(q=d.length,h=N[0],v=N[1],u=0;q>u;u+=2)d[u]*=h,d[u+1]*=v;if(D)for(q=d.length,h=D[0],v=D[1],u=0;q>u;u+=2)d[u]+=h,d[u+1]+=v}vc(B,V,m,E.vs,d,w,E.blend,E.color)}},Ge=function(u,K,i,B,Y,r,w,P){var S,d=i.cs,l=i.uv,V=i.bs;if(u.getFaceVisible(K,r)){var J=u.getFaceMat(K,r);if(J&&(Y=sf(K,J)),zg(w,Y,P),d&&Bg(d,u.getFaceColor(K,r),6),l){var g=u.getFaceUv(K,r)||B[r+"Uv"],p=u.getFaceUvScale(K,r)||B[r+"UvScale"],X=u.getFaceUvOffset(K,r)||B[r+"UvOffset"];g=g?[g[6],g[7],g[0],g[1],g[2],g[3],g[2],g[3],g[4],g[5],g[6],g[7]]:Fg;var $=g[0],A=g[1],L=g[2],I=g[3],h=g[4],c=g[5],G=g[6],Q=g[7],v=g[8],Z=g[9],e=g[10],T=g[11];if(p){var b=p[0],U=p[1];$*=b,A*=U,L*=b,I*=U,h*=b,c*=U,G*=b,Q*=U,v*=b,Z*=U,e*=b,T*=U}if(X){var m=X[0],f=X[1];$+=m,A+=f,L+=m,I+=f,h+=m,c+=f,G+=m,Q+=f,v+=m,Z+=f,e+=m,T+=f}l.push($,A,L,I,h,c,G,Q,v,Z,e,T)}V&&(S=u.getBodyColor(K)||u.getFaceBlend(K,r),S?dk(V,S,6):ho(V,lf,6))}},Eq=function(s,Q,y,K){var O=s.getGL(),B=s._prg,i=s._buffer;if(!s.drawFilter&&!si(Q)){Bf(s),Ec(O,B);for(var h in Q){var R=Q[h];if(!(K&&!R.T||!K&&R.T)){R.invalidate?(R.invalidate=!1,wb(R,"vs"),wb(R,"cs"),wb(R,"ls"),wb(R,"ps")):y&&wb(R,"ps");var g=R.vs32,L=y?R.ps32:R.cs32;Kn(O,B,R.W,w,i.vs,g);var x=R.D,p=!s._dashDisabled&&x;Vi(O,B.uAlphaTest,Y.alphaTest),p&&(Vi(O,B.uDash,!0),Vi(O,B.uDashDistance,x),Vi(O,B.uDashGapDistance,R.G),Km(O,B.aLineDistance),xg(O,i.lineDistance,R.ls32,B.aLineDistance,1),Vi(O,B.uDiffuse,R.A||Y["color.empty"]));var Z=!s._batchColorDisabled;Z&&(Vi(O,B.uBatchColor,!0),Km(O,B.aBatchColor),xg(O,i.batchColor,L,B.aBatchColor,4)),Nq(O),Jj(O,0,g.length/3,O.LINES),xp(O),Z&&(Vi(O,B.uBatchColor,!1),zp(O,B.aBatchColor)),p&&(Vi(O,B.uDash,!1),zp(O,B.aLineDistance))}}Xd(O,B)}},Cr=function(G,g,D){var j,v,S,q,k,L,b,Z,V,P,x,F=G.getGL(),a=G._prg,A=G._buffer,l=G._batchModelMap;if(!si(l)){Bf(G);for(j in l)if(v=Pe[j]||af,!(D&&!v.transparent||!D&&v.transparent)&&(S=l[j],g||!v.transparentMask)){var O=D&&v.autoSort!==!1&&(G._33Q||S.invalidate);if(S.invalidate?(S.invalidate=!1,wb(S,"vs"),wb(S,"ns"),wb(S,"cs"),wb(S,"rs"),wb(S,"ps"),wb(S,"bs"),wb(S,"uv")):g&&wb(S,"ps"),k=S.vs32,L=g?S.ps32:S.cs32,V=S.uv32,b=S.bs32,Z=S.rs32,x=k.length/3,O&&(S.is=an(k,G.getEye())),x){q=v.light,P=G.getTexture(v.image),gm(F,a,w,v.light,v.opacity,v.reverseFlip,v.reverseColor,v.reverseCull),L?G._batchColorDisabled||(Vi(F,a.uBatchColor,!0),Km(F,a.aBatchColor),xg(F,A.batchColor,L,a.aBatchColor,4)):Vi(F,a.uDiffuse,v.color||Y["color.empty"]);var m=v.alphaTest;Vi(F,a.uAlphaTest,m===i?Y.alphaTest:m),v.envmap!==i?(Vi(F,a.uUseEnvMap,!0),Vi(F,a.uReflectivity,v.envmap)):(Vi(F,a.uUseEnvMap,!1),Vi(F,a.uReflectivity,0));var s=b&&!G._batchBlendDisabled;s&&(Vi(F,a.uBatchBlend,!0),Km(F,a.aBatchBlend),xg(F,A.batchBlend,b,a.aBatchBlend));var c=Z&&!G._batchBrightnessDisabled;c&&(Vi(F,a.uBatchBrightness,!0),Km(F,a.aBatchBrightness),xg(F,A.batchBrightness,Z,a.aBatchBrightness,1)),V?Nq(F,a,P,v.discardSelectable,A.uv,V,v.uvOffset,v.uvScale):Nq(F),xg(F,A.vs,k,a.aPosition),xg(F,A.ns,S.ns32,a.aNormal),S.is?(bg(F,A.is,S.is),Sl(F,0,x)):Jj(F,0,x),V?xp(F,a,P):xp(F),L&&!G._batchColorDisabled&&(Vi(F,a.uBatchColor,!1),zp(F,a.aBatchColor)),s&&(Vi(F,a.uBatchBlend,!1),zp(F,a.aBatchBlend)),c&&(Vi(F,a.uBatchBrightness,!1),zp(F,a.aBatchBrightness)),pr(F,a)}}}},an=function(e,A){for(var c=e.length/3,D=new Array(c),u=c/3,d=new Array(u),U=0;u>U;U++)d[U]=U;d.sort(function(S,K){var O=9*S,t=[(e[O]+e[O+3]+2*e[O+6])/4,(e[O+1]+e[O+4]+2*e[O+7])/4,(e[O+2]+e[O+5]+2*e[O+8])/4];O=9*K;var w=[(e[O]+e[O+3]+2*e[O+6])/4,(e[O+1]+e[O+4]+2*e[O+7])/4,(e[O+2]+e[O+5]+2*e[O+8])/4],L=Sp(A,t)-Sp(A,w);return L>0?-1:0>L?1:0});for(var U=0;u>U;U++){var Q=3*U,q=3*d[U];D[Q]=q,D[Q+1]=q+1,D[Q+2]=q+2}return new Kf(D)},tj={obj:function(E,j){var X={mat:E.mat,s3:E.s3,r3:E.r3,rotationMode:E.rotationMode,t3:E.t3,cube:E.cube==w?!0:E.cube,center:E.center==w?!0:E.center,ignoreMtls:E.ignoreMtls,ignoreTransparent:E.ignoreTransparent,ignoreColor:E.ignoreColor,ignoreImage:E.ignoreImage,ignoreNormal:E.ignoreNormal,prefix:E.prefix,flipY:E.flipY,flipFace:E.flipFace,reverseFlipMtls:E.reverseFlipMtls,finishFunc:function(A,d){if(A){var d=[];for(var k in A){var y=A[k];d.rawS3=y.rawS3,d.push(y),E.eachModel&&E.eachModel(k,y)}d.json=E,j(d)}else j()}};C.loadObj(E.obj,E.mtl,X)}};C.getModelTypeHandlers=function(){return tj},C.setModelTypeHandler=function(M,_){tj[M]=_},C.getModelTypeHandler=function(N){return tj[N]},C.handleModelLoaded=function(){},C.handleUnfoundModel=function(){};var Yo=w,mi=w,Uq=function(M){Yo&&!M._loadingModelView_&&(mi||(mi={}),mi[M._loadingModelView_=Og()]=M)},Jm=function(h,e){Yo||(Yo={});var T=Yo[h];if(T){if(T.url===e)return;T.request.onload=Wf,T.request.onerror=Wf}var J=new Uc;if(Yo[h]={request:J,url:e},e=C.beforeLoadURL(e),e.data){var X=C.parse(e.data);Vn(h,X,e)}else{J.onload=function(){if(200===this.status||0===this.status){delete Yo[h];var u=C.parse(J.getResponseText());Vn(h,u,e)}else Kl(h,C.handleUnfoundModel(h,e)||w)},J.onerror=function(){Kl(h,C.handleUnfoundModel(h,e)||w)};var U={};U.url=encodeURI(e),U.sync=!1,J.send(U)}},Vn=function(y,f,K){var h=f.modelType;if(!h)return Kl(y,f),C.handleModelLoaded(y,f),void 0;var l=C.getModelTypeHandler(h);if(l){if(Yo||(Yo={}),Yo[y])return;Yo[y]=!0;var W=function(h){h?(Kl(y,h),C.handleModelLoaded(y,h)):Kl(y,C.handleUnfoundModel(y,K)||w)};l(f,W)}else Kl(y,C.handleUnfoundModel(y,K)||w)},Kl=function(S,b){if(gq[S]=b,delete Yo[S],si(Yo)&&(Yo=w,mi)){for(var v in mi){var Q=mi[v];Q.invalidateAll&&Q.invalidateAll(i,"modelLoaded",S),Q.redraw&&Q.redraw(),Q.iv(),delete Q._loadingModelView_}mi=w}if(b&&mi)for(var v in mi){var Q=mi[v];Q.invalidateAll&&Q.invalidateAll(i,"modelLoading",S),Q.redraw&&Q.redraw(),Q.iv()}},th=new Ud([0,0,0,1,1,1,1,0]),ro=new Ud([0,0,1,0,0,1,0,0,1,0,0,1]),qd=new Kf([0,1,2,2,3,0]),rg=new Ud([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),cj=new Kf([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Wc=new Ud([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Nj=Dh(rg,cj),yq=(new Ud([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Kf([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Nh,or,He,Dd,Gh,Qc]),ug=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],pd=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Aq=function(k,P,J,U,H,D,m){D=D||16,k=k||16,P=P||0,J=J||k;var R,M,S,v,I,N,V,h,E,L=.5,n=[],s=[],$=e/k,A=Q/D;for(R=0;D>R;R++)for(N=R+1,v=R*A,E=N*A,M=P;J>M;M++)V=M+1,S=M*$,h=V*$,n.push(L*y(v)*b(S),L*b(v),-L*y(v)*y(S),L*y(E)*b(h),L*b(E),-L*y(E)*y(h),L*y(v)*b(h),L*b(v),-L*y(v)*y(h),L*y(v)*b(S),L*b(v),-L*y(v)*y(S),L*y(E)*b(S),L*b(E),-L*y(E)*y(S),L*y(E)*b(h),L*b(E),-L*y(E)*y(h)),s.push(M/k,R/D,V/k,N/D,V/k,R/D,M/k,R/D,M/k,N/D,V/k,N/D);if(m){var K=[];for(R=0,I=n.length;I>R;R+=3)K.push(2*n[R],2*n[R+1],2*n[R+2])}if(U){var x=[],i=[];for(S=P*$,R=0;D>R;R++)N=R+1,v=R*A,E=N*A,x.push(0,0,0,L*y(E)*b(S),L*b(E),-L*y(E)*y(S),L*y(v)*b(S),L*b(v),-L*y(v)*y(S)),i.push(0,.5,P/k,N/D,P/k,R/D)}if(H){var g=[],t=[];for(S=J*$,R=0;D>R;R++)N=R+1,v=R*A,E=N*A,g.push(0,0,0,L*y(v)*b(S),L*b(v),-L*y(v)*y(S),L*y(E)*b(S),L*b(E),-L*y(E)*y(S)),t.push(1,.5,J/k,R/D,J/k,N/D)}var _={vs:n,uv:s,from_vs:x,from_uv:i,to_vs:g,to_uv:t};return m&&(_.ns=K),_},cd=function(P,o,M){P=P||.17,o=o||12,M=M||18,0>P?P=0:P>.25&&(P=.25);var c,q,w,R,E,D,I,N=.5,k=[],i=[],J=[],G=e/M,g=e/o,K=N-P;for(q=0;o>=q;q++)for(R=-Q+q*g,D=b(R),E=y(R),c=0;M>=c;c++)w=c*G,I=K+P*D,k.push(b(w)*I,E*P,-y(w)*I),i.push(c/M,1-q/o);for(q=0;o>q;q++){var l=q*(M+1),Y=(q+1)*(M+1);for(c=0;M>c;c++)J.push(l+c,Y+c+1,Y+c,l+c,l+c+1,Y+c+1)}return{vs:k,uv:i,is:J}},Kk=function(N,q,F,n,I,r,S,M){S=S||12,N=N||18,q=q||0,F=F||N,r=r||.17,0>r?r=0:r>.25&&(r=.25);var x,H,g,L,j,J,$,P,E,w,f=.5,m=[],k=[],B=e/N,O=e/S,z=f-r,u=M?[]:i;for(g=0;S>g;g++)for(L=g+1,$=-Q+g*O,P=-Q+L*O,x=q;F>x;x++)H=x+1,j=x*B,J=H*B,E=z+r*b($),w=z+r*b(P),m.push(b(j)*E,y($)*r,-y(j)*E,b(J)*E,y($)*r,-y(J)*E,b(J)*w,y(P)*r,-y(J)*w,b(j)*E,y($)*r,-y(j)*E,b(J)*w,y(P)*r,-y(J)*w,b(j)*w,y(P)*r,-y(j)*w),k.push(x/N,1-g/S,H/N,1-g/S,H/N,1-L/S,x/N,1-g/S,H/N,1-L/S,x/N,1-L/S),M&&u.push(b(j)*b($),y($),-y(j)*b($),b(J)*b($),y($),-y(J)*b($),b(J)*b(P),y(P),-y(J)*b(P),b(j)*b($),y($),-y(j)*b($),b(J)*b(P),y(P),-y(J)*b(P),b(j)*b(P),y(P),-y(j)*b(P));if(n){var U=[],p=[];for(g=0;S>g;g++)L=g+1,$=-Q+g*O,P=-Q+L*O,j=q*B,E=z+r*b($),w=z+r*b(P),U.push(b(j)*E,y($)*r,-y(j)*E,b(j)*w,y(P)*r,-y(j)*w,b(j)*z,0,-y(j)*z),p.push(.5+.5*b($),.5-.5*y($),.5+.5*b(P),.5-.5*y(P),.5,.5)}if(I){var Z=[],a=[];for(g=0;S>g;g++)L=g+1,$=-Q+g*O,P=-Q+L*O,j=F*B,E=z+r*b($),w=z+r*b(P),Z.push(b(j)*E,y($)*r,-y(j)*E,b(j)*z,0,-y(j)*z,b(j)*w,y(P)*r,-y(j)*w),a.push(.5-.5*b($),.5-.5*y($),.5,.5,.5-.5*b(P),.5-.5*y(P))}var C={vs:m,uv:k,from_vs:U,from_uv:p,to_vs:Z,to_uv:a};return M&&(C.ns=u),C},pc=function(U,h){for(var E,v,k,D=.5,O=16,n=[],f=[],l=[],$=e/O,Q=0;O>=Q;Q++)E=Q*$,v=b(E)*D,k=y(E)*D,n.push(v,-D,k,v,D,k),f.push(1-Q/O,1,1-Q/O,0);for(Q=0;O>Q;Q++)l.push(2*Q,2*Q+1,2*Q+3,2*Q,2*Q+3,2*Q+2);if(h){var u=[],I=[],p=[];for(u.push(0,-D,0),I.push(.5,.5),Q=0;O>=Q;Q++)E=Q*$,v=b(E),k=y(E),u.push(v*D,-D,-k*D),I.push(.5+.5*v,.5+.5*k);for(Q=0;O>Q;Q++)p.push(0,Q+2,Q+1)}if(U){var P=[],d=[],r=[];for(P.push(0,D,0),d.push(.5,.5),Q=0;O>=Q;Q++)E=Q*$,v=b(E),k=y(E),P.push(v*D,D,-k*D),d.push(.5+.5*v,.5-.5*k);for(Q=0;O>Q;Q++)r.push(0,Q+1,Q+2)}return{vs:n,uv:f,is:l,bottom_vs:u,bottom_uv:I,bottom_is:p,top_vs:P,top_uv:d,top_is:r}},ri=function(T,W,U,z,i,C,Y,X){T=T||12,W=W||0,U=U||T;for(var D,n,p,N,G,t,M,I,V,B=.5,u=[],a=[],q=e/T,s=W;U>s;s++)D=s+1,n=s*q,p=D*q,N=b(n)*B,G=y(n)*B,t=b(p)*B,M=y(p)*B,u.push(N,-B,-G,t,-B,-M,N,B,-G,t,-B,-M,t,B,-M,N,B,-G),a.push(s/T,1,D/T,1,s/T,0,D/T,1,D/T,0,s/T,0);if(X){var K=[];for(s=0,V=u.length;V>s;s+=3)K.push(2*u[s],0,2*u[s+2])}if(Y){var f=[],F=[];for(s=W;U>s;s++)n=q*s,p=q*(s+1),N=b(n),G=y(n),t=b(p),M=y(p),f.push(N*B,-B,-G*B,0,-B,0,t*B,-B,-M*B),F.push(.5+.5*N,.5+.5*G,.5,.5,.5+.5*t,.5+.5*M)}if(C){var c=[],o=[];for(s=W;U>s;s++)n=q*s,p=q*(s+1),N=b(n),G=y(n),t=b(p),M=y(p),c.push(N*B,B,-G*B,t*B,B,-M*B,0,B,0),o.push(.5+.5*N,.5-.5*G,.5+.5*t,.5-.5*M,.5,.5)}if(z){var Z=[],S=[];n=q*W,N=b(n)*B,G=y(n)*B,I=W/T,Z.push(0,B,0,0,-B,0,N,-B,-G,N,-B,-G,N,B,-G,0,B,0),S.push(0,0,0,1,I,1,I,1,I,0,0,0)}if(i){var Q=[],R=[];n=q*U,N=b(n)*B,G=y(n)*B,I=U/T,Q.push(0,-B,0,0,B,0,N,B,-G,N,B,-G,N,-B,-G,0,-B,0),R.push(1,1,1,0,I,0,I,0,I,1,1,1)}var L={vs:u,uv:a,bottom_vs:f,bottom_uv:F,top_vs:c,top_uv:o,from_vs:Z,from_uv:S,to_vs:Q,to_uv:R};return X&&(L.ns=K),L},On=function(m,H,L,Z,S){H=H||18,L=L||0,Z=Z==w?e:Z,S=S==w?.5:S;for(var h,$,t,r,g,V,G=[0,.5,.75,.875,.9375],K=[],P=[],d=[],j=Z/H,_=0;_<G.length;_++){var B=0===_%2?0:.5;for(h=0;H>=h;h++)$=(h+B)*j+L,t=1-G[_],K.push(b($)*S*t,-S+2*G[_]*S,-y($)*S*t),P.push((h+B)/H,t)}for(_=0;_<G.length-1;_++){var N=_*(H+1),A=(_+1)*(H+1);for(h=0;H>h;h++)d.push(N+h,A+h+1,A+h,N+h,N+h+1,A+h+1)}for(V=K.length/3-(H+1),h=0;H>h;h++)K.push(0,S,0),P.push((h+.5)/H,0);for(h=0;H>h;h++)d.push(V+h,V+h+1,V+(H+1)+h);if(m){var x=[],U=[],X=[];for(x.push(0,-S,0),U.push(.5,.5),h=0;H>=h;h++)$=h*j+L,r=b($),g=y($),x.push(r*S,-S,-g*S),U.push(.5+.5*r,.5+.5*g);for(h=0;H>h;h++)X.push(0,h+2,h+1)}return{vs:K,uv:P,is:d,bottom_vs:x,bottom_uv:U,bottom_is:X}},td=function(G,N,I,Y,k,U){G=G||16,N=N||0,I=I||G;for(var Q=.5,W=[],u=[],s=e/G,H=N;I>H;H++){var $=H+1,v=s*H,T=s*$;W.push(b(v)*Q,-Q,-y(v)*Q,b(T)*Q,-Q,-y(T)*Q,0,Q,0),u.push(H/G,1,$/G,1,(H+$)/2/G,0)}if(U){var t=[],Z=[];for(H=N;I>H;H++){v=s*H,T=s*(H+1);var D=b(v),j=y(v),S=b(T),m=y(T);t.push(D*Q,-Q,-j*Q,0,-Q,0,S*Q,-Q,-m*Q),Z.push(.5+.5*D,.5+.5*j,.5,.5,.5+.5*S,.5+.5*m)}}if(Y){var P=[],q=[];v=s*N,P.push(0,Q,0,0,-Q,0,b(v)*Q,-Q,-y(v)*Q),q.push(0,0,0,1,N/G,1)}if(k){var o=[],B=[];v=s*I,o.push(0,-Q,0,0,Q,0,b(v)*Q,-Q,-y(v)*Q),B.push(1,1,1,0,I/G,1)}return{vs:W,uv:u,bottom_vs:t,bottom_uv:Z,from_vs:P,from_uv:q,to_vs:o,to_uv:B}},gc=function(G,d,w,p,f,N,M,j){for(var Q=[],D=0;D<G.length-1;D+=2)Q.push({x:G[D],y:G[D+1]});return Ke(Q,d,w,p,f,N,M,j,!1)},Pq={roundRect:function(Z,m){return gc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],Z,m,3)},star:function(I,Q){return gc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],I,Q)},rect:function($,w){return gc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],$,w)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(k,A){return gc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],k,A)},rightTriangle:function(f,G){return gc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],f,G)},parallelogram:function(L,B){return gc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],L,B)},trapezoid:function(F,A){return gc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],F,A)}},tf={sphere:1,cylinder:1,cone:1,torus:1},Zj={torus:1,sphere:1},bq=og(Tk(Pq),{cylinder:1}),fi=og(Tk(Pq),{cylinder:1,cone:1}),gp=function(p,q,L){var O,K=mo(p.anchor3d,L,q),i=mo(p.mat,L,q),a=mo(p.s3,L,q),H=mo(p.t3,L,q),V=mo(p.r3,L,q),J=a||V||H||i;if(K||J){O=Ef(q._6O);var b=J?Xb(i,a,V,mo(p.rotationMode,L,q),H):Kr();K&&Hd(b,[.5-K[0],.5-K[1],.5-K[2]]),Bf(q,b)}return O},wh=function(i,G,w,I,B,V,c){if(qf(w))w.forEach(function(t){wh(i,G,t,I,B,V,c)});else if(tq(w))wh(i,G,Hf(I,w),I,B,V,c);else if(as(w))if(w.shape3d){var z=gp(w,i,G);wh(i,G,w.shape3d,I,B,V,w),z&&$i(i,z)}else nn(i,G,w,I.s,B,V,c)},nn=function(O,C,V,m,N,x,S){if(S=S||af,!x||x(m("shape3d.transparent",V.transparent,S.transparent))){var j=gp(V,O,C);nm(V);var U=O._26I,J=O._prg,i=O._buffer,X=m("shape3d.color",V.color,S.color);N||(N=m("shape3d.blend",V.blend,S.blend));var K,p=V.opacity==w?S.opacity:V.opacity,o=m("shape3d.opacity");K=o!=w&&p!=w?p*o:p!=w?p:o,gm(U,J,N,m("shape3d.light",V.light,S.light),K,m("shape3d.reverse.flip",V.reverseFlip,S.reverseFlip),m("shape3d.reverse.color",V.reverseColor,S.reverseColor),m("shape3d.reverse.cull",V.reverseCull,S.reverseCull));var A=m("polygonOffset",V.polygonOffset,S.polygonOffset);V.vs&&m(qk,V.visible,S.visible)&&Zg(U,J,i,X,O.getTexture(m("shape3d.image",V.image,S.image),C),m("shape3d.discard.selectable",V.discardSelectable,S.discardSelectable),V.vs,V.uv,V.ns,V.is,m("shape3d.uv.offset",V.uvOffset,S.uvOffset),m("shape3d.uv.scale",V.uvScale,S.uvScale),A),V.top_vs&&m(Bh,V.topVisible,S.topVisible)&&Zg(U,J,i,m("shape3d.top.color",V.topColor,S.topColor)||X,O.getTexture(m("shape3d.top.image",V.topImage,S.topImage),C,"top"),m("shape3d.top.discard.selectable",V.topDiscardSelectable,S.topDiscardSelectable),V.top_vs,V.top_uv,V.top_ns,V.top_is,m("shape3d.top.uv.offset",V.topUvOffset,S.topUvOffset),m("shape3d.top.uv.scale",V.topUvScale,S.topUvScale),A),V.bottom_vs&&m(Um,V.bottomVisible,S.bottomVisible)&&Zg(U,J,i,m("shape3d.bottom.color",V.bottomColor,S.bottomColor)||X,O.getTexture(m("shape3d.bottom.image",V.bottomImage,S.bottomImage),C,"bottom"),m("shape3d.bottom.discard.selectable",V.bottomDiscardSelectable,S.bottomDiscardSelectable),V.bottom_vs,V.bottom_uv,V.bottom_ns,V.bottom_is,m("shape3d.bottom.uv.offset",V.bottomUvOffset,S.bottomUvOffset),m("shape3d.bottom.uv.scale",V.bottomUvScale,S.bottomUvScale),A),V.from_vs&&m(rn,V.fromVisible,S.fromVisible)&&Zg(U,J,i,m("shape3d.from.color",V.fromColor,S.fromColor)||X,O.getTexture(m("shape3d.from.image",V.fromImage,S.fromImage),C,"from"),m("shape3d.from.discard.selectable",V.fromDiscardSelectable,S.fromDiscardSelectable),V.from_vs,V.from_uv,V.from_ns,V.from_is,m("shape3d.from.uv.offset",V.fromUvOffset,S.fromUvOffset),m("shape3d.from.uv.scale",V.fromUvScale,S.fromUvScale),A),V.to_vs&&m(be,V.toVisible,S.toVisible)&&Zg(U,J,i,m("shape3d.to.color",V.toColor,S.toColor)||X,O.getTexture(m("shape3d.to.image",V.toImage,S.toImage),C,"to"),m("shape3d.to.discard.selectable",V.toDiscardSelectable,S.toDiscardSelectable),V.to_vs,V.to_uv,V.to_ns,V.to_is,m("shape3d.to.uv.offset",V.toUvOffset,S.toUvOffset),m("shape3d.to.uv.scale",V.toUvScale,S.toUvScale),A),pr(U,J),j&&$i(O,j)
}},Zg=function(S,s,r,z,m,w,j,K,B,X,D,C,$){j&&($&&es(S,$),Vi(S,s.uDiffuse,z||Y["color.empty"]),K?Nq(S,s,m,w,r.uv,K,D,C):Nq(S),xg(S,r.vs,j,s.aPosition),xg(S,r.ns,B,s.aNormal),X?(gn(S,r.is,X),Sl(S,0,X.length)):Jj(S,0,j.length/3),K?xp(S,s,m):xp(S),$&&qh(S))},Hf=function(r,D){var k=r.s;if(D||(D=k(xh)),!D)return w;var m=Yg(D);if(m)return m;if("text"===D){var I={amount:k("shape3d.text.amount"),size:k("shape3d.text.size"),font:k("shape3d.text.font"),style:k("shape3d.text.style"),weight:k("shape3d.text.weight"),fill:k("shape3d.text.fill"),curveSegments:k("shape3d.text.curveSegments"),spacing:k("shape3d.text.spacing")},_=r.gv.getShape3dText(r.data),O=_;for(var F in I)O+="_"+(I[F]===i?"U":I[F]);return r._cachedTextKey===O?r._cachedTextGeometry:(r._cachedTextKey=O,r._cachedTextGeometry=C.createTextGeometry(_,I))}var F=D;if(tf[D]){var g=k("shape3d.side"),n=k("shape3d.side.from"),M=k("shape3d.side.to"),N=k(rn),E=k(be);3>g?(g=0,n=0,M=0,N=!1,E=!1):((n==w||0>n)&&(n=0),(M==w||M>g)&&(M=g),0===n&&M===g&&(N=!1,E=!1));var Z="cone"===D?!1:k("shape3d.smooth");F+="-"+g+"-"+n+"-"+M+"-"+N+"-"+E+(Z?1:0)}if(bq[D]){var B=k(Bh);F+="-"+B}if(fi[D]){var $=k(Um);F+="-"+$}if("torus"===D){var J=k("shape3d.torus.radius");0>J?J=0:J>.25&&(J=.25),F+="-"+J}if(Zj[D]){var y=k(Yq);F+="-"+y}return m=Vm[F],m||("box"===D?m=C.createBoxModel():Pq[D]?m=Pq[D](B,$):"sphere"===D?m=C.createSphereModel(g,n,M,N,E,y,Z):D===Fo?m=C.createCylinderModel(g,n,M,N,E,B,$,Z):"cone"===D?m=C.createConeModel(g,n,M,N,E,$):"torus"===D&&(m=C.createTorusModel(g,n,M,N,E,J,y,Z)),Vm[F]=m),m},nm=function(){var w=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],I=["is","top_is","bottom_is","from_is","to_is"];return m=fs(Lh.substr(Lh.indexOf("^#")+2)),ah(C[Mo(Zi+w[15]+"n"+w[16])]())&&oq()?function(J){J&&!J._complete_&&(J._complete_=!0,J.vs&&vi(J.ns)&&(J.ns=Dh(J.vs,J.is)),J.top_vs&&vi(J.top_ns)&&(J.top_ns=Dh(J.top_vs,J.top_is)),J.bottom_vs&&vi(J.bottom_ns)&&(J.bottom_ns=Dh(J.bottom_vs,J.bottom_is)),J.from_vs&&vi(J.from_ns)&&(J.from_ns=Dh(J.from_vs,J.from_is)),J.to_vs&&vi(J.to_ns)&&(J.to_ns=Dh(J.to_vs,J.to_is)),w.forEach(function(l){var A=J[l];qf(A)&&(J[l]=new Ud(A))}),I.forEach(function(R){var d=J[R];qf(d)&&(J[R]=new Kf(d))}))}:void 0}(),wn=function(s,Y){var A=s[Y];qf(A)&&(s[Y]=new Ud(A))};og(Ib,{_25Q:function(Y){Y._16O=function(u,z,O,R,X,d,e,Y,H){var w=this.info;if(w){var J,o,_,A,l,Z,L=Kr();if(Nl[z]?(J=w.p3,o=w.c1,_=w.c2):Cd[z]?(o=w.s1||w.c1,_=w.s2||w.c2):(o=w.t1||w.c1,_=w.t2||w.c2),J)Z=zi(z,Ag,O,R,Y,H);else{var B=jp(_,o),P=Sp(o,_);A=[0,-T(B[2],B[0]),G(B[1]/P)],l="zyx",J=[(o[0]+_[0])/2,(o[1]+_[1])/2,(o[2]+_[2])/2],Z=zi(z,[P,0,0],O,R,Y,H)}return Hc(L,Z,J,R,X,d,e,u,A,l)}return fc},Y._80o=function(G,x,B){var N=this,T=N.shapeModel;if(T){var W=N.gv;Bf(W),wh(W,N.data,T,N,N.getBodyColor(),B)}},Y.createLineModel=function(d,T,N,t,M){for(var E=this,B=E.s,k=is(d,T,B(Yq)),r=[],e=0;e<k.length;e++){var x=k[e],L=x.length;if(L>1){var l=x[0];r.push(l.x,l.y,l.z);for(var b=1;L-1>b;b++)l=x[b],r.push(l.x,l.y,l.z),r.push(l.x,l.y,l.z);l=x[L-1],r.push(l.x,l.y,l.z)}}var $,f,m,S=B(t+".color"),Z=B(M),v=0;return Z&&(f=B(M+".color"),$=B(M+".pattern"),v=B(M+".offset"),m=S),un(E.gv,E.data,r,f||S,m?w:B(t+".gradient.color"),N,$||B(t+".pattern"),v,m),k},Y.createTubeModel=function(o,j,$,Q){for(var b=this,N=b.s,m=N("shape3d.side")||Zn,l=N("shape3d.start.angle"),F=N("shape3d.sweep.angle"),C=N(Bh)?N("shape3d.top.cap"):w,K=N(Um)?N("shape3d.bottom.cap"):w,g="flat"===C,h="flat"===K,W=g&&(Q?Q.uv:N("shape3d.top.image")),I=h&&(Q?Q.uv:N("shape3d.bottom.image")),P=Q?Q.uv:N("shape3d.image"),k={vs:[],uv:P?[]:w,top_vs:g?[]:w,top_uv:W?[]:w,bottom_vs:h?[]:w,bottom_uv:I?[]:w},c=is(o,j,N(Yq),$),M=0,x=c.length;x>M;M++)Tq(k,c[M],N(Df),$,m,l,F,C,K);if(Q){var r=[];Fj(b.gv,b.data,k,b,b.getBodyColor(),[],Q,r),r.length&&(ho(Q.vs,r),ho(Q.ns,Dh(r)))}else b.shapeModel=k;return c},Y.getCache=function(){var s=this.info;if(s){var W=s.list;if(W){var u=s.cache;return u||(u=s.cache=Sm(W)),u}}return w}}});var Vk=function(Y,l){for(var u,q=0,C=Y.length,R=0,d=C-1;d>=R;)if(q=p(R+(d-R)/2),u=Y[q].length-l,0>u)R=q+1;else{if(!(u>0)){d=q;break}d=q-1}q=d;var O=Y[q],k=O.point;return q===C-1||O.length===l||(k=(new qq).subVectors(Y[q+1].point,k).normalize().multiplyScalar(l-O.length).add(k)),{point:k,tangent:O.tangent}},Sm=function(u){for(var T,I,U=[],f=0,E=0;E<u.length;E++){for(var R=u[E],d=0;d<R.length;d++){T=R[d],I&&(f+=I.distanceTo(T));var y=new qq,z=R[d+1];z?y.subVectors(z,T):I?y.subVectors(T,I):y.x=1,y.normalize(),U.push({point:T,length:f,tangent:y}),I=T}I=null}return U},is=function(v,T,h,E){h=h||uf;for(var M=[],c=0,g=v.size();g>c;c++){var y=v.get(c);M.push(new qq(y.x,y.e||0,y.y))}T&&(eq(T)&&(T=T._as),T.length||(T=null));for(var D,U,W,N,I,X=[],Z=0,b=0,C=T?T.length:g;C>b;b++)if(I=T?T[b]:0===b?1:2,1===I)X.push(W=[]),W.push(M[Z++]);else if(2===I||5===I)if(N=2===I?M[Z++]:W[0],E){var O=T?T[b+1]:C>b+1?2:w;if(2===O||5===O){var s=W[W.length-1],H=2===O?M[Z]:W[0],j=(new qq).subVectors(s,N),e=(new qq).subVectors(H,N),P=j.length(),z=e.length();if(P&&z)if(E>P/2&&E>z/2)W.push(N);else for(j.multiplyScalar(V(E,P/2)/P).add(N),e.multiplyScalar(V(E,z/2)/z).add(N),D=new Qp(j,N,e).getPoints(h),U=0;h>=U;U++)W.push(D[U])}else W.push(N)}else W.push(N);else if(3===I)for(D=new Qp(W[W.length-1],M[Z++],M[Z++]).getPoints(h),U=1;h>=U;U++)W.push(D[U]);else if(4===I)for(D=new Lf(W[W.length-1],M[Z++],M[Z++],M[Z++]).getPoints(h),U=1;h>=U;U++)W.push(D[U]);return X},Jo=function(t){for(var Z,u,O=new qq,S=[],b=[],x=[],v=0,F=t.length;F>v;v++)Z=t[v],u=t[v+1],u?O.subVectors(u,Z):O.subVectors(Z,t[v-1]),S.push(O.normalize().clone());var L,X,U,o,j=new qq,a=new qq,G=new Ue,m=1e-4,C=Number.MAX_VALUE,p=S[0],i=b[0]=new qq,V=x[0]=new qq;for(X=l(p.x),U=l(p.y),o=l(p.z),C>=X&&(C=X,j.set(1,0,0)),C>=U&&(C=U,j.set(0,1,0)),C>=o&&j.set(0,0,1),a.crossVectors(p,j).normalize(),i.crossVectors(p,a),V.crossVectors(p,i),v=1;F>v;v++)b[v]=b[v-1].clone(),x[v]=x[v-1].clone(),a.crossVectors(S[v-1],S[v]),a.length()>m&&(a.normalize(),L=g(ll(S[v-1].dot(S[v]),-1,1)),b[v].applyMatrix4(G.makeRotationAxis(a,L))),x[v].crossVectors(S[v],b[v]);return{B:x,T:S,N:b}},Tq=function(){var P=function(G){for(var z=1;z<arguments.length;z++){var u=arguments[z];G.push(u.x,u.y,u.z)}},W=function(N){for(var l=1;l<arguments.length;l++){var H=arguments[l].uv;N.push(H[0],H[1])}},f=function(L,W,x,N,V){var A=-N*b(V),z=N*y(V);return new qq(L.x+A*x.x+z*W.x,L.y+A*x.y+z*W.y,L.z+A*x.z+z*W.z)},u=function(p,z,l,I,d,u,y,U){y=y||e;for(var x=[],G=y/d,A=0;d>=A;A++){var c=f(p,z,l,I,A*G+u);x.push(c),U!=w&&(c.uv=[U,A/d])}return x},U=function(R,Q,O,N,m,v,z,p,F){F=F||e;var B=Q?R.top_vs:R.bottom_vs;if(B)for(var n=Q?R.top_uv:R.bottom_uv,M=F/z,o=0;z>o;o++){var U,L;Q?(U=o*M+p,L=(o+1)*M+p):(L=o*M+p,U=(o+1)*M+p),P(B,f(O,N,m,v,U),f(O,N,m,v,L),O),n&&n.push(.5-.5*b(U),.5-.5*y(U),.5-.5*b(L),.5-.5*y(L),.5,.5)}};return function(I,s,r,g,S,l,e,E,k){var T=s.length;if(T>1){var V,B,v,p,N,d,b,D=Jo(s),n=D.T,G=D.N,K=D.B;"flat"===E&&U(I,!0,s[0],K[0],G[0],g,S,l,e),"flat"===k&&U(I,!1,s[T-1],K[T-1],G[T-1],g,S,l,e);var Q,C,c=[],H=R(S/2),O="round"===E,X="round"===k,z=s[0],y=n[0],A=K[0],_=G[0],q=s[T-1],o=n[T-1],a=K[T-1],Y=G[T-1];if(O){for(v=1;H>=v;v++)G.splice(0,0,_),K.splice(0,0,A),n.splice(0,0,y),C=-v/H*g,s.splice(0,0,y.clone().multiplyScalar(C).add(z)),c[H-v]=Z(g*g-C*C);T+=H}if(X){for(v=1;H>=v;v++)G.push(Y),K.push(a),n.push(o),C=v/H*g,s.push(o.clone().multiplyScalar(C).add(q)),c[s.length-1]=Z(g*g-C*C);T+=H}if(I.uv){var h=0,t=0,j=[];for(r&&(h=r),N=s[0],j[0]=0,v=1;T>v;v++)p=s[v],j[v]=N.distanceTo(p),N=p,r||(h+=j[v]);for(Q=[],v=0;T>v;v++)t+=j[v],Q[v]=h?t/h:0}for(v=0;T>v;v++){if(p=s[v],d=K[v],b=G[v],V=u(p,d,b,c[v]===i?g:c[v],S,l,e,Q?Q[v]:w),B)for(var J=0;S>J;J++){var f=B[J],$=B[J+1]||B[0],F=V[J],L=V[J+1]||V[0];P(I.vs,$,f,F,F,L,$),I.uv&&W(I.uv,$,f,F,F,L,$)}B=V}}}}();og(C,{getLineLength:function(_){return _[_.length-1].length},getLineOffset:function(u,Y){return Vk(u,Y)},getLineCacheInfo:function(w,$,V,R){return Sm(is(w,$,V,R))}});var Rd=v.graph3d.RenderLite={},fb=new Array(0),Vp=Rd.Buffer=function(k,u,L,b){this.gl=k,this.buffer=k.createBuffer(),this.type=u||k.ARRAY_BUFFER,this.drawType=b||k.STATIC_DRAW,this.data=fb,L&&this.upload(L)};Vp.prototype.upload=function(X,e,E){E||this.bind();var i=this.gl;X=X||this.data,e=e||0,this.data.byteLength>=X.byteLength?i.bufferSubData(this.type,e,X):i.bufferData(this.type,X,this.drawType),this.data=X},Vp.prototype.bind=function(){var $=this.gl;$.bindBuffer(this.type,this.buffer)},Vp.createVertexBuffer=function(C,R,Q){return new Vp(C,C.ARRAY_BUFFER,R,Q)},Vp.createIndexBuffer=function(I,v,E){return new Vp(I,I.ELEMENT_ARRAY_BUFFER,v,E)},Vp.create=function(j,q,L,D){return new Vp(j,q,D)},Vp.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var _f=Rd.Shader=function(I,Z,y){this.gl=I,this.program=Yd(I,Z,y),this.attributes=ke(I,this.program);var h=Qd(I,this.program);this.uniforms=bm(I,h)};_f.prototype.bind=function(){this.gl.useProgram(this.program)},_f.prototype.destroy=function(){this.gl};var Yd=function(P,c,$){var L=Le(P,P.VERTEX_SHADER,c),b=Le(P,P.FRAGMENT_SHADER,$);P.getShaderParameter(b,P.COMPILE_STATUS)||console.error(P.getError());var D=P.createProgram();return P.attachShader(D,L),P.attachShader(D,b),P.linkProgram(D),P.getProgramParameter(D,P.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",P.getProgramParameter(D,P.VALIDATE_STATUS)),console.error("gl.getError()",P.getError()),""!==P.getProgramInfoLog(D)&&console.warn("Warning: gl.getProgramInfoLog()",P.getProgramInfoLog(D)),P.deleteProgram(D),D=null),P.deleteShader(L),P.deleteShader(b),D},Le=function(s,u,P){var T=s.createShader(u);return s.shaderSource(T,P),s.compileShader(T),s.getShaderParameter(T,s.COMPILE_STATUS)?T:(console.log(s.getShaderInfoLog(T)),null)},Qd=function(r,S){for(var d={},J=r.getProgramParameter(S,r.ACTIVE_UNIFORMS),T=0;J>T;T++){var j=r.getActiveUniform(S,T),K=j.name.replace(/\[.*?\]/,""),k=im(r,j.type);d[K]={type:k,size:j.size,location:r.getUniformLocation(S,K),value:uc(k,j.size)}}return d},ke=function(n,b){for(var J={},v=n.getProgramParameter(b,n.ACTIVE_ATTRIBUTES),Q=0;v>Q;Q++){var V=n.getActiveAttrib(b,Q),z=im(n,V.type);J[V.name]={type:z,size:Ul(z),gl:n,location:n.getAttribLocation(b,V.name),pointer:Ql}}return J},Ql=function(w,J,G,t,d){var K=this.gl;K.enableVertexAttribArray(this.location),w instanceof Rd.Buffer||(w=Rd.Buffer.createVertexBuffer(K,w)),K.bindBuffer(w.type,w.buffer),K.vertexAttribPointer(this.location,this.size,J||K.FLOAT,G||!1,t||0,d||0)},Ul=function(t){return gf[t]},gf={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},im=function(x,k){if(!bp){var N=I.keys(yb);bp={};for(var y=0;y<N.length;++y){var r=N[y];bp[x[r]]=yb[r]}}return bp[k]},bp=null,yb={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},uc=function(t,v){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*v);case"vec3":return new Float32Array(3*v);case"vec4":return new Float32Array(4*v);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*v);case"ivec3":return new Int32Array(3*v);case"ivec4":return new Int32Array(4*v);case"bool":return!1;case"bvec2":return md(2*v);case"bvec3":return md(3*v);case"bvec4":return md(4*v);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},md=function(Y){for(var i=new Array(Y),e=0;e<i.length;e++)i[e]=!1;return i},bm=function(B,x){var v={data:{}};v.gl=B;for(var U=I.keys(x),e=0;e<U.length;e++){var u=U[e],k=u.split("."),R=k[k.length-1],W=fq(k,v),T=x[u];W.data[R]=T,W.gl=B,I.defineProperty(W,R,{get:sn(R),set:Al(R,T)})}return v},sn=function(T){var U=Aj.replace("%%",T);return new Function(U)},Al=function(c,R){var t,m=$p.replace(/%%/g,c);return t=1===R.size?lr[R.type]:Zb[R.type],t&&(m+="\nthis.gl."+t+";"),new Function("value",m)},fq=function(P,S){for(var E=S,Z=0;Z<P.length-1;Z++){var h=E[P[Z]]||{data:{}};E[P[Z]]=h,E=h}return E},Aj=["return this.data.%%.value;"].join("\n"),$p=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),lr={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Zb={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Sb=v.Light=function(){qj(Sb,this),this.s(nj,Y[nj]),this.s(xh,"sphere"),this.s3(20,20,20)};zc("Light",ab,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function($,E,N){Sb.superClass.onStyleChanged.apply(this,arguments),$===nj&&this.s("shape3d.color",N)}});var Pl=rj.Graph3dView=function(x,L){var F=this;F._webGLVersion=1,F._attributes=L||C.graph3dViewAttributes,F._25I={},F._view=pf(1,F);var n=F._canvas=$f(F._view);X(n,"webglcontextlost",function(_){_.preventDefault(),Kd(F),F._26I&&F._doBufferGC(F._26I,!0),F._26I=w,F._1o.texture=w,F._35O=!0}),X(n,"webglcontextrestored",function(){F._35O=!1,F.iv()}),F._batchIndexMap={},F._batchModelMap={},F._wireframeIndexMap={},F._wireframeModelMap={},F._wireframeIndexMapSwap={},F._wireframeModelMapSwap={},F._polylineIndexMap={},F._polylineIndexMap={},F._polylineIndexMapSwap={},F._polylineIndexMapSwap={},F._8O=[],F._7O=Kr(),F._6O=Kr(),F._1o=new Ah(F),F._30O=new kb(F),F._31O=new Dn(F),F._32O=new Gj(F),F._raycaster=new Om(F),F._highlightHelper=new Em(F),F._postProcessing=new Di(F),F._cameras=[],F._cameraId=0,F.vr=new wj(F),F._33Q=!0,F._eye=Tk(C.graph3dViewEye),F._center=Tk(C.graph3dViewCenter),F._up=Tk(C.graph3dViewUp),F._lightChanged=!1,F._59O=[],F._spots=[],F._dirs=[],F._frameId=0,F.overlappingBox=new Wm(F),F.dm(x?x:new Ln),F._coreInteractor=new nh(this),F.setInteractors([new Ch(F)])},db={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Iq=function(J,q,Z,d){J.clearColor(0,0,0,0),J.clearDepth(1),J.enable(J.DEPTH_TEST),J.depthFunc(J.LEQUAL),J.disable(J.CULL_FACE),J.enable(J.BLEND),J.blendFuncSeparate(J.SRC_ALPHA,J.ONE_MINUS_SRC_ALPHA,J.ONE,J.ONE_MINUS_SRC_ALPHA),J.useProgram(Z),Vi(J,Z.uBrightness,1),Vi(J,Z.uOpacity,1),Vi(J,Z.uPartOpacity,1),Vi(J,Z.uPick,d._picking),Vi(J,Z.uTexture,!1),Vi(J,Z.uBlendTexture,!1),Vi(J,Z.uAlphaTest,Y.alphaTest),Vi(J,Z.uTransparent,!1),Vi(J,Z.uFix,!1),Vi(J,Z.uBatchColor,!1),Vi(J,Z.uBatchBlend,!1),Vi(J,Z.uBatchBrightness,!1),Vi(J,Z.uReflectivity,d._envmapReflectivity),Vi(J,Z.uCameraPosition,q.getEye()),Vi(J,Z.uPMatrix,d._projectMatrix),Vi(J,Z.uViewMatrix,d._viewMatrix),q.bindEnvMap(J),d._picking||(on(q,J,Z),q._fogDisabled||(Vi(J,Z.uFogColor,q._fogColor),Vi(J,Z.uFogNear,q._fogNear),Vi(J,Z.uFogFar,q._fogFar))),Km(J,Z.aPosition),Km(J,Z.aNormal),zp(J,Z.aUv),zp(J,Z.aBatchColor),zp(J,Z.aBatchBlend),zp(J,Z.aBatchBrightness),zp(J,Z.aLineDistance),J.depthMask(!0)},lq=0;Nf("Graph3dView",I,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",ur,Fi,"firstPersonMode",hj,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Wj,Te,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:C.graph3dViewEditHelperDisabled,_devicePixelRatio:i,_boundaries:i,_moveStep:C.graph3dViewMoveStep,_rotateStep:C.graph3dViewRotateStep,_pannable:C.graph3dViewPannable,_rotatable:C.graph3dViewRotatable,_walkable:C.graph3dViewWalkable,_resettable:C.graph3dViewResettable,_zoomable:C.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:C.graph3dViewFirstPersonMode,_mouseRoamable:C.graph3dViewMouseRoamable,_gridVisible:C.graph3dViewGridVisible,_gridSize:C.graph3dViewGridSize,_gridGap:C.graph3dViewGridGap,_gridColor:C.graph3dViewGridColor,_originAxisVisible:C.graph3dViewOriginAxisVisible,_centerAxisVisible:C.graph3dViewCenterAxisVisible,_axisXColor:C.graph3dViewAxisXColor,_axisYColor:C.graph3dViewAxisYColor,_axisZColor:C.graph3dViewAxisZColor,_ortho:C.graph3dViewOrtho,_orthoWidth:C.graph3dViewOrthoWidth,_fovy:C.graph3dViewFovy,_near:C.graph3dViewNear,_far:C.graph3dViewFar,_headlightColor:C.graph3dViewHeadlightColor,_headlightIntensity:C.graph3dViewHeadlightIntensity,_headlightRange:C.graph3dViewHeadlightRange,_headlightAmbientIntensity:C.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:C.graph3dViewHeadlightDisabled,_rectSelectable:C.graph3dViewRectSelectable,_rectSelectBackground:C.graph3dViewRectSelectBackground,_editSizeColor:C.graph3dViewEditSizeColor,_autoMakeVisible:ac,_fogDisabled:C.graph3dViewFogDisabled,_fogColor:C.graph3dViewFogColor,_fogNear:C.graph3dViewFogNear,_fogFar:C.graph3dViewFogFar,_dashDisabled:C.graph3dViewDashDisabled,_batchColorDisabled:C.graph3dViewBatchColorDisabled,_batchBlendDisabled:C.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:C.graph3dViewBatchBrightnessDisabled,addCamera:function(Y){var E=I.freeze({id:this._cameraId++,priority:Y.priority||0,ignoreInPick:!!Y.ignoreInPick,useDefaultProgram:!!Y.useDefaultProgram,render:Y.render});this._cameras.push(E),this._cameras.sort(function(h,t){return h.priority!==t.priority?h.priority-t.priority:h.id-t.id})},setEye:function(P,u,m){1===arguments.length&&(u=P[1],m=P[2],P=P[0]);var V=this._eye;V[0]=P,V[1]=u,V[2]=m,this.fp(Wj,w,V)},setCenter:function(g,M,D){1===arguments.length&&(M=g[1],D=g[2],g=g[0]);var b=this._center;b[0]=g,b[1]=M,b[2]=D,this.fp(Te,w,b)},setUp:function(q,V,t){1===arguments.length&&(V=q[1],t=q[2],q=q[0]);var Q=this._up;Q[0]=q,Q[1]=V,Q[2]=t,this.fp("up",w,Q)},getDevicePixelRatio:function(){return this._devicePixelRatio||re},isTransparentMask:function(t){return t.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var h=this,K=h._aspect;return K?K:(K=h.getWidth()/h.getHeight(),K||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(f){var G=this,P=G._dataModel,w=G._selectionModel;P!==f&&(P&&(P.ump(G.handleDataModelPropertyChange,G),P.umm(G.handleDataModelChange,G),P.umd(G.handleDataPropertyChange,G),w||P.sm().ums(G.handleSelectionChange,G)),G._dataModel=f,f.mp(G.handleDataModelPropertyChange,G),f.mm(G.handleDataModelChange,G),f.md(G.handleDataPropertyChange,G),w?w._21I(f):f.sm().ms(G.handleSelectionChange,G),G._postProcessing.handleDataModleChange(P,f),G.invalidateAll(!0),G.invalidateLight(),G.fp(sj,P,f),G._canvas.style.background=f.getBackground()||"")},handleDataModelPropertyChange:function(P){if("background"===P.property){var p=this._canvas.style.background,N=P.newValue||"";this._canvas.style.background=N,this.fp("canvasBackground",p,N)}else"envmap"===P.property&&this.iv()},handleDataPropertyChange:function(_){var $=_.data;this.invalidateData($),Nb($)&&"s:light.type"===_.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(j){var K=this,E=j.property;K.iv(),K._18Q=w,"eye"===E?K._33Q=!0:"devicePixelRatio"===E?K._42(w,K.getDevicePixelRatio()):db[E]&&Kd(K)},_5O:function(d){var m=d._22Q();return m?new m(this,d):w},getData3dUI:function(c){var v=this._25I[c._id];return v===i&&(v=this._5O(c),this._25I[c._id]=v),v},invalidateAll:function(y){var L=this;if(y){for(var k in L._25I){var W=L._25I[k];W&&W.dispose()}L._25I={},L.iv(),ak(L)}else ak(L),L.dm().each(function(i){L.invalidateData(i)})},invalidateSelection:function(){var t=this;t.sm().each(function(z){t.invalidateData(z)})},invalidateData:function(n){var C=this,c=C.getData3dUI(n);c&&(c.iv(),C.iv()),ak(C,n)},getShape3dText:function(l){return l.getStyle("shape3d.text")||this.getLabel(l)},invalidateBatch:function(O){var _=this,H=_._batchModelMap,p=H[O],W=[],c={};if(p){p.ds.forEach(function(F){var l=_.getData3dUI(F);l&&l.iv(),delete _._batchIndexMap[F._id],W.push(F._id)}),delete H[O];for(var n,e,G,V,x,b,Y,A,K,P=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],C=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],s=0;s<P.length;s++){var U=_[P[s]],F=_[C[s]];for(c={},A=0;A<W.length;A++){var I=F[W[A]];if(I){delete F[W[A]],K=I.batch,n=U[K];var r=I.begin,T=I.size,u=3*r,M=3*T,D=4*r,N=4*T;for(e=n.ds,G=n.vs,V=n.cs,x=n.ps,b=n.ls,Y=I.index,n.invalidate=!0,e[Y]=i,Y=u;u+M>Y;Y++)G[Y]=i;for(Y=D;D+N>Y;Y++)V[Y]=i;for(Y=D;D+N>Y;Y++)x[Y]=i;if(b)for(Y=u;u+M>Y;Y++)b[Y]=i;c[K]=!0}}for(K in c){n=U[K],e=n.ds,G=n.vs,V=n.cs,x=n.ps,b=n.ls;var z=[];for(Y=0;Y<e.length;Y++)e[Y]!==i&&z.push(e[Y]);if(0===z.length)delete U[K];else{for(n.ds=z,z=[],Y=0;Y<G.length;Y++)G[Y]!==i&&z.push(G[Y]);for(n.vs=z,z=[],Y=0;Y<V.length;Y++)V[Y]!==i&&z.push(V[Y]);for(n.cs=z,z=[],Y=0;Y<x.length;Y++)x[Y]!==i&&z.push(x[Y]);if(n.ps=z,b){for(z=[],Y=0;Y<b.length;Y++)b[Y]!==i&&z.push(b[Y]);n.ls=z}}}}_.iv()}},handleDataModelChange:function(c){var k=this,M=c.kind,B=c.data;if("add"===M)k.invalidateData(B),kn(B)&&B.getEdgeGroup()&&B.getEdgeGroup().eachSiblingEdge(k.invalidateData,k),Nb(B)&&k.invalidateLight();else if(M===rh){var y=B._id,a=k._25I[y];a&&(a.dispose(),delete k._25I[y],k.iv()),B===k._currentSubGraph&&k.setCurrentSubGraph(w),ak(k,B),Nb(B)&&k.invalidateLight()}else M===yc&&(k.invalidateAll(!0),k.setCurrentSubGraph(w),ak(k),k.invalidateLight())},toCanvas:function(E,F,l){var t=this,I=t.getGL();if(t.validate(),E){var D=I.getParameter(I.COLOR_CLEAR_VALUE);Lb(I,E)}t._42(w,1);var _=t.getWidth(),q=t.getHeight(),K=new Uint8Array(4*_*q),i=$f(),m=i.getContext("2d");I.readPixels(0,0,_,q,I.RGBA,I.UNSIGNED_BYTE,K),vf(i,_,q,1);for(var T=m.getImageData(0,0,_,q),U=T.data,A=0;A<U.length;A+=4){var e=A/4,J=p(e/_),V=e-J*_;e=4*((q-1-J)*_+V),U[e]=K[A],U[e+1]=K[A+1],U[e+2]=K[A+2],U[e+3]=K[A+3]}if(m.putImageData(T,0,0),E&&Lb(I,D),t._42(w,t.getDevicePixelRatio()),F&&l){var j=$f(),o=j.getContext("2d");return F=F,l=l,vf(j,F,l,1),C.drawImage(o,i,0,0,F,l),j}return i},toDataURL:function(a,g){var J=this,A=J.getGL();if(J.validate(),a){var u=A.getParameter(A.COLOR_CLEAR_VALUE);Lb(A,a)}J._42(w,1);var Y=J._canvas.toDataURL(g||"image/png",1);return a&&Lb(A,u),J._42(w,J.getDevicePixelRatio()),Y},getGL:function(){var A=this._26I;if(A)return this.acquireProgram(),A;var w=this,H=w._canvas,U=w._attributes;try{A=H.getContext("webgl2",U)||H.getContext("experimental-webgl2",U),A&&(w._webGLVersion=2,w._26I=A)}catch(k){}if(!A)try{A=H.getContext("webgl",U)||H.getContext("experimental-webgl",U)}catch(k){throw new Error("WebGL not supported")}if(!A)throw new Error("WebGL not supported");w._26I=A,w._glExtensions=new L(A),w._glCapabilities=new O(A,w._glExtensions),w._2O={},A._compiledShader={},A._emptyTexture=Ob(A),A._emptyBlendTexture=Ob(A),A._bufPool={},A._id=++lq,w._buffer={vs:Dm(A),ns:Dm(A),is:Dm(A),uv:Dm(A),batchColor:Dm(A),batchBlend:Dm(A),batchBrightness:Dm(A),lineDistance:Dm(A)},w._1O=mq(A);var f=w._cube={vs:Dm(A),ns:Dm(A),is:Dm(A),uv:Dm(A)};return jg(A,f.vs,rg),jg(A,f.ns,Nj),jg(A,f.uv,Wc),bg(A,f.is,cj),w.acquireProgram(),A},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var J=this,D=J._26I;if(D){var n=C.getImage(J.getEnvmap()),W=n&&n.tagName?!0:!1,b=J._prg&&J._prg.envMapFlag?!0:!1;if(!J._prg||W!==b){var I=J._prg=D.createProgram();if(!I)return w;I.envMapFlag=W;var B=J._dirs.length,r=J._spots.length,q=J._59O.length,h=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];B&&h.push("uDirColor","uDirDirection"),r&&h.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),q&&h.push("uPointColor","uPointRange","uPointPosition"),Lb(D,[0,0,0,0]),D.clearDepth(1),D.enable(D.DEPTH_TEST),D.depthFunc(D.LEQUAL),D.enable(D.BLEND),D.blendFuncSeparate(D.SRC_ALPHA,D.ONE_MINUS_SRC_ALPHA,D.ONE,D.ONE_MINUS_SRC_ALPHA),Bl||(Lh=fs(Lh.substring(0,Lh.indexOf("^#"))),hq=fs(hq),Bl=!0);var L=["#define MAX_DIR "+B,"#define MAX_SPOT "+r,"#define MAX_POINT "+q,J._fogDisabled?"":"#define FOG",J._dashDisabled?"":"#define DASH",W?"#define USE_ENVMAP":"",J.isOrtho()?"#define ORTHOGRAPHIC":"",J._batchColorDisabled?"":"#define BATCHCOLOR",J._batchBlendDisabled?"":"#define BATCHBLEND",J._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),E=fk(D,I,D.VERTEX_SHADER,Lh.replace("PREFIX",L));D.getShaderParameter(E,D.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",D.getShaderInfoLog(E));var p=fk(D,I,D.FRAGMENT_SHADER,hq.replace("PREFIX",L));D.getShaderParameter(p,D.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",D.getShaderInfoLog(p)),pk?h.push("aPosition"):(I.aPosition=0,D.bindAttribLocation(I,0,"aPosition")),D.linkProgram(I),h.forEach(function(t){I[t]=/^u/.test(t)?D.getUniformLocation(I,t):D.getAttribLocation(I,t)}),D.useProgram(I),D.deleteShader(E),D.deleteShader(p)}}},getBrightness:function(b){var v=b.s("brightness"),d=this.isSelected(b)?b.s("select.brightness"):w;return v==w?d:d==w?v:v*d},setHighlightMode:function(J){var i;i="selection"===J?Em.Mode.Selection:"mouseover"===J?Em.Mode.MouseOver:Em.Mode.Disable,this._highlightHelper.mode=i},getHighlightMode:function(){var H=this._highlightHelper.mode;return H===Em.Mode.Selection?"selection":H===Em.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(F){var T=this,y=T._prg,t=5,H=T.getEnvmap(),Y=C.getImage(H);if(Y&&Y.tagName){if(H!==T._lastEnvMap){Y=C.resizeImagePOT(Y,!0),T._envMapTexture&&F.deleteTexture(T._envMapTexture);var d=T._envMapTexture=F.createTexture();F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_CUBE_MAP,d),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MAG_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_CUBE_MAP,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,Y),F.bindTexture(F.TEXTURE_CUBE_MAP,null),T._lastEnvMap=H}F.activeTexture(F.TEXTURE0+t),F.bindTexture(F.TEXTURE_CUBE_MAP,T._envMapTexture),F.uniform1i(y.uEnvMap,t)}},getWireframe:function(R){var i=R.s("wf.visible"),E=R.s("wf.width");return i===!0||E>0&&"selected"===i&&this.isSelected(R)?{color:R.s("wf.color"),width:E,"short":R.s("wf.short"),mat:R.s("wf.mat")}:void 0},_transformPointToViewSpace:function(y){var v=[y[0],y[1],y[2]];return Vl(v,this._viewMatrix),v},_transformDirectionToViewSpace:function(W,z){var G=[W[0],W[1],W[2]];Vl(G,this._viewMatrix);var d=z?[z[0],z[1],z[2]]:[0,0,0];Vl(d,this._viewMatrix);var e=d[0]-G[0],Z=d[1]-G[1],c=d[2]-G[2],N=Math.sqrt(e*e+Z*Z+c*c);return N?[e/N,Z/N,c/N]:[e,Z,c]},getWireframeGeometry:function($){return $.s("wf.geometry")?{color:$.s("wf.color"),width:$.s("wf.width"),mat:$.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(w){return w.s("body.color")},getMat:function(u){return u.getMat?u.getMat():u.s("mat")},getFaceMat:function(S,W){return S.getFaceMat?S.getFaceMat(W):S.s(W+".mat")},getFaceBlend:function(c,I){return c.s(I+".blend")||c.s("all.blend")},getFaceColor:function(U,F){return U.s(F+".color")||U.s("all.color")},getFaceImage:function(K,w){return K.s(w+".image")||K.s("all.image")},getFaceBlendImage:function(v,G){return v.s(G+".blend.image")||v.s("all.blend.image")},getFaceDiscardSelectable:function(G,h){var s=G.s(h+".discard.selectable");return s==w?G.s("all.discard.selectable"):s},getFaceUv:function(v,D){return v.s(D+".uv")||v.s("all.uv")},getFaceUvOffset:function(n,H){return n.s(H+".uv.offset")||n.s("all.uv.offset")},getFaceUvScale:function(N,c){return N.s(c+".uv.scale")||N.s("all.uv.scale")},getFaceLight:function(u,e){var S=u.s(e+".light");return S==w?u.s("all.light"):S},getFaceVisible:function(f,Q){var s=f.s(Q+".visible");return s==w?f.s("all.visible"):s},getFaceOpacity:function(J,x){var o=J.s(x+".opacity");return o==w?J.s("all.opacity"):o},getFaceTransparent:function(d,v){var X=d.s(v+".transparent");return X==w?d.s("all.transparent"):X},getFaceReverseColor:function(n,c){return n.s(c+".reverse.color")||n.s("all.reverse.color")},getFaceReverseFlip:function(v,C){var B=v.s(C+".reverse.flip");return B==w?v.s("all.reverse.flip"):B},getFaceReverseCull:function(n,y){var U=n.s(y+".reverse.cull");return U==w?n.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function(o){var c=this,k=c._2O[o];k&&(delete c._2O[o],c.getGL().deleteTexture(k))},invalidateCachedTexture:function(W){var O=this.getData3dUI(W);O.invalidateCachedTexture(this.getGL()),this.invalidateData(W)},invalidateShape3dCachedImage:function(H){this.invalidateCachedTexture(H)},isInteractive:function(K){return K.s("interactive")},getTexture:function($,x,h){if(!$)return w;var U=this,m=U.getGL(),M=U._2O[$];if(!M){var A=Mf($),d={mipmapMaxLevel:x?x.s("texture.mipmap.max"):i};if(!A)return m._emptyTexture;if(A.uuid||(A.uuid=v.Math.generateUUID()),A.tagName){if(A.dynamic)return mq(m,A,U._1O,d);M=U._2O[$]=mq(m,A,i,d)}else{var j,H=x&&(x.s("texture.cache")||x.s("shape3d.image.cache"))&&!U.isInteractive(x),g=U.vr.isPresenting();if(g&&(x._textureUpdateFrame===m._renderInfo.frame?H=!0:x._textureUpdateFrame=m._renderInfo.frame),H&&(j=U.getData3dUI(x),M=j.getCachedTexture(h)),!M){var Y=m._renderInfo.textureCache;if(H){if(Y.time>C.graph3dMaxVectorCacheTime)return U.redraw(),m._emptyTexture;if(!Tb(A,x))return m._emptyTexture}var S,P=x&&(x.s("fixSizeOnScreen")||x.s("shape3d.fixSizeOnScreen")),y=P?m.NEAREST:m.LINEAR;
P||x&&(x.s("vector.dynamic")||x.s("shape3d.vector.dynamic"))&&(j||(j=U.getData3dUI(x)),P=j.getVectorDynamicSize(),P&&(S=U.getDevicePixelRatio(),P[0]*=S,P[1]*=S));var F;x&&(1!==x.s("texture.scale")?F=x.s("texture.scale"):1!==x.s("shape3d.texture.scale")&&(F=x.s("shape3d.texture.scale"))),F||(F=1);var Z,N,u,z=x&&x.s("shape3d");"billboard"===z?u=x.getTall()/x.getWidth():"plane"===z&&(u=x.getHeight()/x.getWidth());var r=Xk(A,x);if(P?(S||(S=U.getDevicePixelRatio()),Z=P[0]>0?P[0]:F*r*S,N=P[1]>0?P[1]:F*(u?Dg(A,x,U,Math.min(4096,r*u)):Dg(A,x))*S):(Z=F*r,N=F*(u?Dg(A,x,U,Math.min(4096,r*u)):Dg(A,x))),Z>=1&&N>=1){var X=0;H&&(X=Date.now());var k=Qf(Z,N);if(!j&&x&&(j=U.getData3dUI(x)),j&&j.interactiveInfo){var K=$;"object"==typeof K&&(K=K.uuid||(K.uuid=v.Math.generateUUID()));var W=j.interactiveInfo[K]={};k.interactiveInfo=W.bodyInfo={compInfos:[],matrix:new Ok,rect:{x:0,y:0,width:Z,height:N}}}lh(k,A,0,0,Z,N,x,U),k.interactiveInfo&&(k.interactiveInfo=null),k.restore(),Y.count++,Y.pixels+=Z*N,d.minFilter=x.s("texture.filter.min")||x.s("texture.filter")||y,d.magFilter=x.s("texture.filter.mag")||x.s("texture.filter")||y,H||g?(M=mq(m,ul,null,d),j.setCachedTexture(M,h),Y.time+=Date.now()-X,ul=null):M=mq(m,ul,U._1O,d)}}}}return M},redraw:function(){this.iv()},validateImpl:function(){var R=this;if(R._lightChanged){R._lightChanged=!1;var s=[],V=[],y=[];R.dm().each(function(Q){if(Nb(Q)){var p=Q.s("light.type");p===yf?s.push(Q):p===Bd?V.push(Q):p===Qo&&y.push(Q)}}),(s.length!==R._59O.length||V.length!==R._spots.length||y.length!==R._dirs.length)&&Kd(R),R._59O=s,R._spots=V,R._dirs=y}R._42(),R._1o.iv()},getRenderInfo:function(){var P=this.getGL();return P?P._renderInfo:void 0},getDebugTip:function(){var l=this,N=l.getRenderInfo();if(N){var T=l.getGL()._validBufCount||0,$="Draw Calls: "+N.calls+"<br/>"+"Vertices: "+N.vertices+"<br/>"+"Faces: "+N.faces+"<br/>"+"Lines: "+N.lines+"<br/>"+"Buffer Count: "+T;l.vr.isPresenting()&&($+="<br/>VR fps: "+l.vr.getFps());var z=N.textureCache.count;if($+="<br/>2D Dynamic Textures: "+N.textureCache.count,z>0){var Q,V=N.textureCache.pixels;Q=V>1e6?Math.round(V/1e6)+"M":V>1e3?Math.round(V/1e3)+"K":Math.round(V),$+="<br/>2D Dynamic pixels: "+Q}return $}},_42:function(i,x){var A=this;if(!A._35O&&(!Li||pl(Li))){var N,U;i&&(i instanceof ab?U=i:N=i);var K=A._canvas,L=A.getGL(),I=A._prg;if(L){var t=A.getWidth(),F=A.getHeight();if(t&&F){x?i||vf(K,t,F,x):(x=A.getDevicePixelRatio(),i||t===K.clientWidth&&F===K.clientHeight||(vf(K,t,F,x),t&&Math.abs(L.drawingBufferWidth-t*x)>1&&(A.setDevicePixelRatio(x=L.drawingBufferWidth/t),vf(K,t,F,x)))),L.clear(L.COLOR_BUFFER_BIT),A.drawFilter||(L._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:i?A._frameId:++A._frameId,textureCache:{time:0,count:0,pixels:0}});var R,a=this._cameras,r=0,T=a.length,e=!1,l=v.Default.cameraPriority.skybox,W=v.Default.cameraPriority.main,Y=v.Default.cameraPriority.top,Z=t*x,_=F*x,n=function(){A.overlappingBox.clear(),A._81O=w,L.clear(L.DEPTH_BUFFER_BIT),L._picking=!!i;var c={_picking:!!i,_envmapReflectivity:A._envmapReflectivity||.5,_projectMatrix:A._projectMatrix=br(A),_viewMatrix:Zk(A,A._7O)};if(A._viewMatrix=Ef(A._7O),U){Iq(L,A,I,c);var D=L.getParameter(L.COLOR_CLEAR_VALUE);L.clearColor(0,0,0,0),L.disable(L.BLEND),zp(L,I.aNormal),jg(L,A._cube.vs,w,I.aPosition),bg(L,A._cube.is),Cf(U,A,Nh,0),Cf(U,A,or,6),Cf(U,A,He,12),Cf(U,A,Dd,18),Cf(U,A,Gh,24),Cf(U,A,Qc,30),Km(L,I.aNormal),Lb(L,D)}else if(N){for(N.value=2;T>r;r++)if(R=a[r],!R.ignoreInPick){if(R.priority>=W)break;R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A,N)}Iq(L,A,I,c);var D=L.getParameter(L.COLOR_CLEAR_VALUE);for(L.clearColor(0,0,0,0),L.disable(L.BLEND),A._95I(L,I,N),Cr(A,N),Eq(A,A._polylineModelMap,N),Eq(A,A._wireframeModelMap,N),Vi(L,I.uTransparent,!0),A._95I(L,I,N,!0),Cr(A,N,!0),Eq(A,A._polylineModelMap,N,!0),Eq(A,A._wireframeModelMap,N,!0),Vi(L,I.uTransparent,!1);T>r;r++)if(R=a[r],!R.ignoreInPick){if(R.priority>=Y)break;R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A,N),e=!0}for(e&&(Iq(L,A,I,c),e=!1),L.clear(L.DEPTH_BUFFER_BIT),A._swapLineMap(),A._95I(L,I,N,!1,!0),Eq(A,A._polylineModelMap,N),Eq(A,A._wireframeModelMap,N),A._swapLineMap(),A._swapLineMap(),A._95I(L,I,N,!1,!0),Eq(A,A._polylineModelMap,N),Eq(A,A._wireframeModelMap,N),Vi(L,I.uTransparent,!0),A._95I(L,I,N,!0,!0),Eq(A,A._polylineModelMap,N,!0),Eq(A,A._wireframeModelMap,N,!0),Vi(L,I.uTransparent,!1),A._swapLineMap(),L.disable(L.DEPTH_TEST),A.drawFilter||A._30O._42(L,I,N),L.enable(L.DEPTH_TEST);T>r;r++)R=a[r],R.ignoreInPick||(R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A,N));Lb(L,D)}else{for(;T>r&&(R=a[r],!(R.priority>=l));r++)R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A);for(Iq(L,A,I,c),L.disable(L.BLEND),A.drawSky(L,I),A.drawReflectors(L,Z,_,n,i)&&(c._projectMatrix=A._projectMatrix=br(A),c._viewMatrix=Zk(A,A._7O),A._viewMatrix=Ef(A._7O),Iq(L,A,I,c));T>r&&(R=a[r],!(R.priority>=W));r++)R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A),e=!0;for(e&&(Iq(L,A,I,c),e=!1),A._31O._42(L,I),A._95I(L,I),Cr(A),Eq(A,A._polylineModelMap),Eq(A,A._wireframeModelMap),L.enable(L.BLEND),L.depthMask(!1),Vi(L,I.uTransparent,!0),A._95I(L,I,w,!0),Cr(A,w,!0),Eq(A,A._polylineModelMap,w,!0),Eq(A,A._wireframeModelMap,w,!0),L.depthMask(!0),Vi(L,I.uTransparent,!1);T>r&&(R=a[r],!(R.priority>=Y));r++)R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A),e=!0;for(e&&(Iq(L,A,I,c),e=!1),L.clear(L.DEPTH_BUFFER_BIT),A._swapLineMap(),L.disable(L.BLEND),A._95I(L,I,w,!1,!0),Eq(A,A._polylineModelMap),Eq(A,A._wireframeModelMap),L.enable(L.BLEND),Vi(L,I.uTransparent,!0),L.depthMask(!1),A._95I(L,I,w,!0,!0),Eq(A,A._polylineModelMap,w,!0),Eq(A,A._wireframeModelMap,w,!0),L.depthMask(!0),Vi(L,I.uTransparent,!1),A._swapLineMap(),L.disable(L.DEPTH_TEST),L.disable(L.BLEND),A._32O._42(L,I),A._30O._42(L,I),A._highlightHelper._42(L,I),L.enable(L.DEPTH_TEST);T>r;r++)R=a[r],R.useDefaultProgram&&Iq(L,A,I,c),R.render(L,A)}jg(L,w),bg(L,w)},p=!1,J=A.vr;J.enable&&J._42(L,Z,_,n)&&(p=!0);var k=A.envRenderer;k&&k.enable&&k._42(L,Z,_,n)&&(p=!0);var s=A._postProcessing;s._42(L,Z,_,n,i)&&(p=!0),p||(A.setViewport(L,0,0,t*x,F*x),n()),A._33Q=!1,A.drawFilter||A.countFrame(),A._doBufferGC(L)}}}},drawReflectors:function(E,a,P,N,A){var n,$,j,T=this,K=T._dataModel.getReflectors(),w=!1;for(n in K)$=K[n],T.isVisible($)&&(j=T.getData3dUI($),j&&j.drawReflector(E,a,P,N,A)&&(w=!0));return w},enablePostProcessing:function(d,G){return this._postProcessing.enableModule(d,G)},getPostProcessingModule:function(G){return this._postProcessing.getModule(G)},setViewport:function($,_,Q,Z,p){this._viewport=[_,Q,Z,p],$.viewport(_,Q,Z,p)},getViewport:function(){return this._viewport},setBufferGCInterval:function(t){this._bufferGCInterval=t},_doBufferGC:function(p,H){var R,O,K=p._bufPool,h=0,t=0,j=p._renderInfo.frame,W=this._bufferGCInterval||10;for(R in K)h++,O=K[R],O&&(H||j-O._fid>W?(p.deleteBuffer(O._buf),O._buf=null,K[R]=null):t++);if(h/2>t&&h>128){var D={};for(R in K)K[R]&&(D[R]=K[R]);p._bufPool=D}p._validBufCount=t},_swapLineMap:function(){var j=this;hf=j._polylineModelMap,j._polylineModelMap=j._polylineModelMapSwap,j._polylineModelMapSwap=hf,hf=j._wireframeModelMap,j._wireframeModelMap=j._wireframeModelMapSwap,j._wireframeModelMapSwap=hf,hf=j._polylineIndexMap,j._polylineIndexMap=j._polylineIndexMapSwap,j._polylineIndexMapSwap=hf,hf=j._wireframeIndexMap,j._wireframeIndexMap=j._wireframeIndexMapSwap,j._wireframeIndexMapSwap=hf},_updateSkyBox:function(p){if(this._skyBox&&p){var W=p.property,T=!1,v=this._skyBox;if("eye"===W||"forceUpdate"===W){var E=this._eye;v.p3(E[0],E[1],E[2]),T=!0}if("near"===W||"far"===W||"forceUpdate"===W){var q=this._near,H=this._far,g=v.getFinalScale3d();if(g[0]/=2,g[1]/=2,g[2]/=2,g[0]<=q||g[0]>=H||g[1]<=q||g[1]>=H||g[2]<=q||g[2]>=H){var U=2*q*H/(q+H),r=Math.min(g[0],g[1],g[2]),A=U/r,i=v.getScale3d();v.setScale3d(i[0]*A,i[1]*A,i[2]*A),T=!0}}T&&this.invalidateData(v)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(P){var F=this._skyBox;F&&(this._skyBoxStyleMap&&F.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&F.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&F.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=P,this.ump(this._updateSkyBox,this),P&&(P.dm()&&P.dm().remove(P),this._skyBoxStyleMap=v.Default.clone(P.getStyleMap()),this._skyBoxAnchor3d=P.getAnchor3d(),P.setAnchor3d(.5,.5,.5),this._skyBoxP3=P.p3().slice(0),P.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",F,P)},drawSky:function(r,Q,q){var s=this,k=s._skyBox;if(k){var m=s._headlightIntensity,M=_g(s._headlightColor),Q=s._prg;1!==m&&(M=[M[0]*m,M[1]*m,M[2]*m]),Vi(r,Q.uHeadlightColor,[M[0],M[1],M[2],1]);var p=s.getData3dUI(k);if(p){var $,w=s.isOrtho(),u=w||this._computedProjectMatrix;u&&($=s._projectMatrix,w&&(s._ortho=!1),Vi(r,Q.uPMatrix,s._projectMatrix=br(s,!0)));var X=k.p3(),I=this._eye;(X[0]!==I[0]||X[1]!==I[1]||X[2]!==I[2])&&(k._position.x=I[0],k._54O=I[1],k._position.y=I[2]),p._42(r,Q,q,function(){return!0}),u&&(w&&(s._ortho=!0),Vi(r,Q.uPMatrix,s._projectMatrix=$))}r.clear(r.DEPTH_BUFFER_BIT),Vi(r,Q.uHeadlightColor,[M[0],M[1],M[2],s._headlightDisabled?1:0])}},_95I:function(T,q,v,G,_){function F(Q){if(!(!Q.s("alwaysOnTop")&&!Q.s("shape3d.alwaysOnTop"))==!!_&&L.isVisible(Q)&&(!r||D)){if(!v&&L.isTransparentMask(Q))return;var W=L.getData3dUI(Q);W&&W._42(T,q,v,h)}}var L=this,h=function(w){return G?w:!w};L.sky&&T.clear(T.DEPTH_BUFFER_BIT);var V=L.drawFilter;V?L.dm().each(function(D){V(D)||F(D)}):L.dm().each(function(w){F(w)})},getLogicalPoint:function(w){return ii(w,this._canvas)},isRectOverlapping:function(X){var P=this.getData3dUI(X);return P._rectOverlapping},getHitFaceInfo:function(G){G.target&&(G=this.lp(G));var B=this.getDataInfoAt(G);if(B){var u=this._1o.face(B.data,Eb(G.x,G.y));if(u)return{data:B.data,face:u}}return w},unproject:function(Y,U){var c=this,O=c.getWidth(),x=c.getHeight(),j=Y.target?c.lp(Y):Y,d=j.x-O/2,F=j.y-x/2,s=2*(d/O),Q=2*(-1*F/x);U=U||0;var p=Kr(),$=br(c),D=Zk(c);qo(p,$,D),vp(p);var w=mj([s,Q,U,1],p);return[w[0]/w[3],w[1]/w[3],w[2]/w[3]]},getDataAt:function(q){var C=this.getDataInfoAt(q);return C?C.data:w},getDataInfoAt:function(N,L){return N.target&&(N=this.lp(N)),this._1o.get(Eb(N.x,N.y,L),!0)},getDatasInRect:function(u){return this._1o.get(u)},setEditable:function(q){var N=this,e=N._editable;N._editable=q,this.fp(yd,e,q)},isEditable:function(X){var O=this;return O._editable?gr(X)?X.s("3d.editable")?O._editableFunc?O._editableFunc(X):!0:!1:!1:!1},isSelectable:function(F){return F.s("3d.selectable")&&this.sm().isSelectable(F)},isMovable:function(E){var G=this;return kn(E)&&E.getStyle(tp)!==qc?!1:E.s("3d.movable")?G._movableFunc?G._movableFunc(E):!0:!1},isSizeEditable:function(P){return gr(P)?this._sizeEditableFunc?this._sizeEditableFunc(P):!0:!1},isRotationEditable:function(g){return gr(g)&&g.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(g):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(y){this.setZoom($d,y)},zoomOut:function(f){this.setZoom(1/$d,f)},setZoom:function(){var c=new Jb,g=new Jb,L=new Jb,a=new Jb;return function(r,q){if(1!==r){var X=this;X._14o&&X._14o.stop(!0);var j,y=1/r;c.copy(X.getCenter()),g.copy(X.getEye());var V=X._ortho;if(V){if(j=X._orthoWidth,j<X._moveStep&&r>1)return}else if(c.distanceTo(g)<X._moveStep&&1>y)return;var Z=!1;return X._zoomToCenter===!1&&X._lastZoomLP&&(L.copy(g).sub(c).normalize(),X._81O=null,a.copy(X.getHitPosition(X._lastZoomLP,c.toArray(),L.toArray())),Z=!0,X._lastZoomHit=a),(q=ig(q))?(q.action=function(s){X.fi({kind:X._zooming?"betweenZoom":"beginZoom"}),X._zooming=1;var U=(y-1)*s+1;V&&X.setOrthoWidth(j*U),Z?(X.setEye(L.lerpVectors(a,g,U).toArray()),X.setCenter(L.lerpVectors(a,c,U).toArray())):V||X.setEye(L.lerpVectors(c,g,U).toArray())},q._37o=function(){delete X._14o,delete X._zooming,X.fi({kind:"endZoom"}),X.onZoomEnded()},X._14o=ar(q)):(V&&X.setOrthoWidth(j*y),Z?(X.setEye(L.lerpVectors(a,g,y).toArray()),X.setCenter(L.lerpVectors(a,c,y).toArray())):V||X.setEye(L.lerpVectors(c,g,y).toArray()),void 0)}}}(),setOrthoZoom:function(n,t){return this.setZoom(n,t)},getPositionInfo:function(d){var c=this,X=c._eye,D=c._center,g=c.getAspect(),j=d?xq(jp(D,X,!0),jp(d,X)):Sp(X,D);if(c._ortho){var U=c._orthoWidth;return{length:j,height:U/g,width:U}}var I=2*S(c._fovy/2)*j;return{length:j,height:I,width:I*g}},getCenterInfo:function(){var c=this;return c._81O||(c._81O=c.getPositionInfo()),Tk(c._81O)},rotate:function(g,k,V,r){var K=this;if(g||k){r==w&&(r=K._firstPersonMode),K._88O&&K._88O.stop(!0);var N=K._center,L=K._eye,s=K.getCenterInfo().length,l=r?N:L,v=r?L:N,X=jp(l,v),t=T(X[0],X[2]),J=T(Z(X[0]*X[0]+X[2]*X[2]),X[1]),D=r?Te:Wj;return r&&(k=-k),(V=ig(V))?(V.action=function(d){K.fi({kind:K._rotating?"betweenRotate":"beginRotate"}),K._rotating=1;var q=t+g*d,S=J+k*d;S=r?Q-Lk(Q-S):Lk(S),X[0]=s*y(S)*y(q),X[1]=s*b(S),X[2]=s*y(S)*b(q),l[0]=v[0]+X[0],l[1]=v[1]+X[1],l[2]=v[2]+X[2],K.fp(D,w,l)},V._37o=function(){delete K._88O,delete K._rotating,K.fi({kind:"endRotate"}),K.onRotateEnded()},K._88O=ar(V)):(t+=g,J+=k,J=r?Q-Lk(Q-J):Lk(J),X[0]=s*y(J)*y(t),X[1]=s*b(J),X[2]=s*y(J)*b(t),l[0]=v[0]+X[0],l[1]=v[1]+X[1],l[2]=v[2]+X[2],K.fp(D,w,l),void 0)}},pan:function(U,h,d,r){if(U||h){var j=this;r==w&&(r=j._firstPersonMode),j._89O&&j._89O.stop(!0);var W=Zk(j),i=[W[0]*U,W[4]*U,W[8]*U],y=[W[1]*h,W[5]*h,W[9]*h],z=i[0]+y[0],O=i[1]+y[1],f=i[2]+y[2],L=j._center,M=j._eye;if(r){var n=kc(j.getBoundaries(),M[0],M[2],M[0]+z,M[2]+f,Z(z*z+f*f));z=n[0],f=n[1]}if(d=ig(d)){var S=Tk(M),K=Tk(L);return d.action=function(Q){j.fi({kind:j._panning?"betweenPan":"beginPan"}),j._panning=1,L[0]=K[0]+z*Q,L[1]=K[1]+O*Q,L[2]=K[2]+f*Q,M[0]=S[0]+z*Q,M[1]=S[1]+O*Q,M[2]=S[2]+f*Q,j.fp(Wj,w,M),j.fp(Te,w,L)},d._37o=function(){delete j._89O,delete j._panning,j.fi({kind:"endPan"}),j.onPanEnded()},j._89O=ar(d)}L[0]+=z,L[1]+=O,L[2]+=f,M[0]+=z,M[1]+=O,M[2]+=f,j.fp(Wj,w,M),j.fp(Te,w,L)}},walk:function(E,J,V){if(E){var v=this;V==w&&(V=v._firstPersonMode),v._90O&&v._90O.stop(!0);var o=v._center,j=v._eye,C=jp(o,j,!0);if(V){var L=kc(v.getBoundaries(),j[0],j[2],j[0]+C[0]*E,j[2]+C[2]*E,l(E));if(E=Sp(L),!E)return;C=[L[0]/E,0,L[1]/E]}if(J=ig(J)){var A=Tk(j),F=Tk(o);return J.action=function(i){v.fi({kind:v._walking?"betweenWalk":"beginWalk"}),v._walking=1;var h=E*i;j[0]=A[0]+C[0]*h,j[1]=A[1]+C[1]*h,j[2]=A[2]+C[2]*h,o[0]=F[0]+C[0]*h,o[1]=F[1]+C[1]*h,o[2]=F[2]+C[2]*h,v.fp(Wj,w,j),v.fp(Te,w,o)},J._37o=function(){delete v._90O,delete v._walking,v.fi({kind:"endWalk"}),v.onWalkEnded()},v._90O=ar(J)}j[0]+=C[0]*E,j[1]+=C[1]*E,j[2]+=C[2]*E,o[0]+=C[0]*E,o[1]+=C[1]*E,o[2]+=C[2]*E,v.fp(Wj,w,j),v.fp(Te,w,o)}},handleScroll:function(N,n){N.preventDefault();var x=this,e=x._moveStep,F=x.getDataInfoAt(N);if(F){var O=F.data;if(O&&x.isInteractive(O)){var J=x.intersectObject(N,O);if(J){var D=J.part,r=Mf(O.s(D+".image")||O.s("shape3d."+D+".image")||O.s("all.image")||O.s("shape3d.image"));if(r&&mo(r.scrollable,O,x))return}}}return x.isFirstPersonMode()?(x.isPannable()&&x.pan(0,n>0?e:-e),void 0):(x.isZoomable()&&(x._lastZoomLP=x.lp(N),x.setZoom(0>n?1/er:er),x._lastZoomLP=x._lastZoomHit=null),void 0)},handlePinch:function(K,R){this.isZoomable()&&this.setZoom(R>K?1/bj:bj)},reset:function(){this.setCenter(C.graph3dViewCenter),this.setEye(C.graph3dViewEye),this.setUp(C.graph3dViewUp)},moveSelection:function(U,j,X){var q=this;q.dm().beginTransaction(),bf(this.sm().toSelection(this.isMovable,this),U,j,X),q.dm().endTransaction()},getMoveMode:function(Q,G){var y=G.s("3d.move.mode");if(y)return y;var V="88",p="89",r="90";return Hh(Q)||dj[V]&&dj[p]&&dj[r]?"xyz":dj[V]&&dj[p]?"xy":dj[V]&&dj[r]?"xz":dj[p]&&dj[r]?"yz":dj[V]?"x":dj[p]?"y":dj[r]?"z":"xz"},handleTick:function(){var l=this,u=!1,I=l._moveStep,x=I,s=!1,$=!0,A=l._rotateStep*($?-1:1);if(l.isWalkable()||(x=0),l.isPannable()||(I=0),l.isRotatable()||(A=0),l._32Q){var B=(Vb()-l._32Q)/50;x*=B,I*=B,A*=B}l._31Q&&(ei(l._31Q),delete l._31Q,delete l._32Q),Fr()&&(u=!0,l.pan(-I,0,s,$)),fm()&&(u=!0,l.pan(I,0,s,$)),Mc()&&(u=!0,Hh()?l.pan(0,I,s,$):l.walk(x,s,$)),ie()&&(u=!0,Hh()?l.pan(0,-I,s,$):l.walk(-x,s,$)),tg()&&(u=!0,l.rotate(-A,0,s,$)),od()&&(u=!0,l.rotate(A,0,s,$)),Oo()&&(u=!0,l.rotate(0,-A/2,s,$)),jn()&&(u=!0,l.rotate(0,A/2,s,$)),u&&(l._32Q=Vb(),l._31Q=Ao(l.handleTick,l))},handleKeyDown:function(O){var s=this;!_n(O)&&Zp[O.keyCode]?s.handleTick():Bn(O)?s.selectAll():Po(O)?s.handleDelete(O):Dj(O)&&this.isResettable()&&s.reset()},checkDoubleClickOnNote:function(z,N,h){var U=this;if(h===Mm){if(N.s("note.toggleable"))return N.s(Tc,!N.s(Tc)),U.fi({kind:"toggleNote",event:z,data:N,part:h}),!0}else if(h===Ie&&N.s("note2.toggleable"))return N.s(vq,!N.s(vq)),U.fi({kind:"toggleNote2",event:z,data:N,part:h}),!0;return!1},checkDoubleClickOnRotation:function(m,d,P){return P===$c?(d.setRotationX(0),!0):P===Tn?(d.setRotationY(0),!0):P===xk?(d.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(F){var W=this;if(W.isOrtho())return W.getWidth()/W.getOrthoWidth();var E=W.getCenter(),B=W.getHeight(),l=W.getEye(),D=[E[0]-l[0],E[1]-l[1],E[2]-l[2]],I=[F[0]-l[0],F[1]-l[1],F[2]-l[2]],z=Math.sqrt(D[0]*D[0]+D[1]*D[1]+D[2]*D[2]),Z=1/Math.tan(W.getFovy()/2);return B*z*Z/(I[0]*D[0]+I[1]*D[1]+I[2]*D[2])},inViewSpace:function(n){var V,F=this,X=F._transformPointToViewSpace(n),P=F.getAspect(),k=F.getNear(),N=F.getFar();return-X[2]<k||-X[2]>N?!1:F.isOrtho()?(V=F.getOrthoWidth()/2,Math.abs(X[0])<=V&&Math.abs(X[1]*P)<=V):(V=Math.sqrt(X[0]*X[0]+X[1]*X[1]+X[2]*X[2])*Math.tan(F.getFovy()/2),Math.abs(X[1]<=V)&&Math.abs(X[0])<=V*P)},getPVMatrix:function(){var j=this,G=j.getWidth()/2,q=j.getHeight()/2,K=j._18Q;return K&&K._wh===G/q||(K=br(j),j._18Q=qo(K,K,Zk(j)),j._18Q._wh=G/q),K},getFrustum:function(){var W=new _e,x=new mh,A=new Array(16);return function(){for(var u=this.getPVMatrix(),F=!1,c=0;16>c;c++)u[c]!==A[c]&&(F=!0,A[c]=u[c]);return F&&x.setFromMatrix(W.fromArray(u)),x}}(),toViewPosition:function(E){var Z=this,U=Z.getWidth()/2,L=Z.getHeight()/2,M=Z.getPVMatrix();return E=mj([E[0],E[1],E[2],1],M),{x:U+U*E[0]/E[3],y:L-L*E[1]/E[3],z:E[2]/E[3]}},getHitPosition:function(a,i,T){var j=this,J=j.getWidth(),F=j.getHeight(),d=a.target?j.lp(a):a,V=d.x-J/2,Y=d.y-F/2,X=j.getCenterInfo(),w=Zk(j);i=i?i:[0,0,0],T=T?T:[0,1,0],V=V/J*X.width,Y=-1*Y/F*X.height;var D=[w[0]*V,w[4]*V,w[8]*V],s=[w[1]*Y,w[5]*Y,w[9]*Y],C=[D[0]+s[0],D[1]+s[1],D[2]+s[2]],O=j.getCenter(),v=ph(j,i,T,[C[0]+O[0],C[1]+O[1],C[2]+O[2]]);return v?v:[0,0,0]},intersectObject:function(b,M){return this._raycaster.intersectObject(b,M)},intersectObjects:function(k,C,O){return this._raycaster.intersectObjects(k,C,O)},getLineLength:function(w){this.validate();var q=this.getData3dUI(w);if(q&&q.getCache){var V=q.getCache();if(V)return V[V.length-1].length}return 0},getLineOffset:function(M,S){var h=this.getData3dUI(M);if(h&&h.getCache){var r=h.getCache();if(r){var V=Vk(r,S),H=M.r3();if(0===H[0]&&0===H[1]&&0===H[2])return V;var G=new Jb(M.p3()),b=new Jb(V.point).sub(G),u=new Jb(V.tangent).add(b),B=(new il).setFromEuler(new Re(H,M.getRotationMode(),!0));return b.applyQuaternion(B),u.applyQuaternion(B),{point:b.add(G),tangent:u.sub(b).normalize()}}}return w},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(Y,U,s){var F=this,X=F.getEye();X=[X[0],X[1],X[2]];var v=F.getCenter();if(v=[v[0],v[1],v[2]],Y||(Y=X),U||(U=v),F._flyAnim&&F._flyAnim.stop(!0),s=ig(s),!s)return F.setEye(Y[0],Y[1],Y[2]),F.setCenter(U[0],U[1],U[2]),delete F._flyAnim,!0;var f=[Y[0]-X[0],Y[1]-X[1],Y[2]-X[2]],i=[U[0]-v[0],U[1]-v[1],U[2]-v[2]];return s.action=function(R){F.setCenter(v[0]+i[0]*R,v[1]+i[1]*R,v[2]+i[2]*R),F.setEye(X[0]+f[0]*R,X[1]+f[1]*R,X[2]+f[2]*R)},s._37o=function(){delete F._flyAnim},F._flyAnim=ar(s)},flyTo:function(){function n(h,z,F){if(F instanceof v.Node){P.fromArray(sf(F,z.getMat(F)));var d=F.getAnchor3d();h.push((new Jb).set(0-d.x,0-d.y,0-d.z).applyMatrix4(P)),h.push((new Jb).set(0-d.x,0-d.y,1-d.z).applyMatrix4(P)),h.push((new Jb).set(0-d.x,1-d.y,0-d.z).applyMatrix4(P)),h.push((new Jb).set(0-d.x,1-d.y,1-d.z).applyMatrix4(P)),h.push((new Jb).set(1-d.x,0-d.y,0-d.z).applyMatrix4(P)),h.push((new Jb).set(1-d.x,0-d.y,1-d.z).applyMatrix4(P)),h.push((new Jb).set(1-d.x,1-d.y,0-d.z).applyMatrix4(P)),h.push((new Jb).set(1-d.x,1-d.y,1-d.z).applyMatrix4(P))}}var s=new Jb,k=new Jb,U=new Jb,C=new Jb,P=new _e,H=new v.Math.Quaternion,q=new Re;return function($,R,l){var r=this;if(l!==i)R={animation:R,ratio:l};else{var p=typeof R;("boolean"===p||"object"===p&&R.duration)&&(R={animation:R})}R=R||{},s.fromArray(r.getEye()),k.fromArray(r.getCenter());var A,y,L=[],X=R.center,f=R.distance===i;if(X&&U.fromArray(X),$ instanceof v.Node)X||U.fromArray($.p3()),f&&(n(L,r,$),A=L.length);else{if($||($=r.dm().getDatas()),!$.length)return;if((f||!X)&&(L=[],$.forEach(function(k){n(L,r,k)}),A=L.length,!A))return;if(!X){for(U.set(0,0,0),y=0;A>y;y++)U.add(L[y]);U.multiplyScalar(1/A)}}if(r.setCenter(U.x,U.y,U.z),C.subVectors(s,k),R.direction||R.worldDirection){!R.worldDirection&&$ instanceof v.Node?H.setFromEuler(q.set($.r3(),$.getRotationMode(),!0)):H.set(0,0,0,1);var F=C.length();C.fromArray(R.worldDirection||R.direction).applyQuaternion(H).setLength(F)}var x=0;if(f){var T,o,I,l=R.ratio||.8,h=R.xRatio||l,b=R.yRatio||l;if(r.isOrtho()){var P=-1/0;for(r._eye[0]=C.x+U.x,r._eye[1]=C.y+U.y,r._eye[2]=C.z+U.z,T=br(r),qo(T,T,Zk(r)),y=0;A>y;y++)I=L[y],o=mj([I.x,I.y,I.z,1],T),P=Math.max(P,Math.max(Math.abs(o[0])/h,Math.abs(o[1])/b));x=r.getOrthoWidth()*P,C.add(U)}else{for(var j,e,Q=r.getNear(),S=10;S--;){for(r._eye[0]=C.x+U.x,r._eye[1]=C.y+U.y,r._eye[2]=C.z+U.z,T=br(r),qo(T,T,Zk(r)),j=!0,e=-1/0,y=0;A>y;y++){if(I=L[y],o=mj([I.x,I.y,I.z,1],T),o[3]<Q&&S){C.multiplyScalar(2),j=!1;break}e=Math.max(e,Math.max(Math.abs(o[0])/h,Math.abs(o[1])/b)-o[3])}if(j)break}C.setLength(e+C.length()).add(U)}}else C.setLength(R.distance).add(U);r._flyAnim&&r._flyAnim.stop(!0);var w=ig(R.animation);if(w){r.setEye(s.x,s.y,s.z),r.setCenter(k.x,k.y,k.z);var N=(new Jb).subVectors(C,s),G=(new Jb).subVectors(U,k);if(x)var Z=r.getOrthoWidth();var u=new Jb,t=new Jb,D=w.action,d=w._37o;return w.action=function(y,v){u.copy(s).addScaledVector(N,y),t.copy(k).addScaledVector(G,y),r.setCenter(t.x,t.y,t.z),r.setEye(u.x,u.y,u.z),x&&r.setOrthoWidth((x-Z)*y+Z),D&&D(y,v)},w._37o=function(){delete r._flyAnim,d&&d()},{lastEye:s,lastCenter:k,eye:C,center:U,orthoWidth:x,animation:r._flyAnim=ar(w)}}return r.setEye(C.x,C.y,C.z),x&&r.setOrthoWidth(x),delete r._flyAnim,{lastEye:s,lastCenter:k,eye:C,center:U,orthoWidth:x}}}(),getBoundingBox:function(){function E(A,E,k){P.fromArray(sf(k,E.getMat(k)));var v=k.getAnchor3d();A.push((new Jb).set(0-v.x,0-v.y,0-v.z).applyMatrix4(P)),A.push((new Jb).set(0-v.x,0-v.y,1-v.z).applyMatrix4(P)),A.push((new Jb).set(0-v.x,1-v.y,0-v.z).applyMatrix4(P)),A.push((new Jb).set(0-v.x,1-v.y,1-v.z).applyMatrix4(P)),A.push((new Jb).set(1-v.x,0-v.y,0-v.z).applyMatrix4(P)),A.push((new Jb).set(1-v.x,0-v.y,1-v.z).applyMatrix4(P)),A.push((new Jb).set(1-v.x,1-v.y,0-v.z).applyMatrix4(P)),A.push((new Jb).set(1-v.x,1-v.y,1-v.z).applyMatrix4(P))}var P=new _e;return function(s){if(s=s||this.sm().getSelection(),s instanceof v.Node&&(s=[s]),0===s.length)return w;var T=[];s.forEach(function(X){E(T,this,X)},this);var l=[1/0,1/0,1/0],$=[-1/0,-1/0,-1/0];return T.forEach(function(F){l[0]=Math.min(F.x,l[0]),l[1]=Math.min(F.y,l[1]),l[2]=Math.min(F.z,l[2]),$[0]=Math.max(F.x,$[0]),$[1]=Math.max(F.y,$[1]),$[2]=Math.max(F.z,$[2])}),{min:l,max:$}}}()}),rj.RenderEnv=function(m){this.gv=m,this.enable=!1},I.defineProperties(rj.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(I){this._debugOn=I,this.capture&&this.capture()}}}),I.assign(rj.RenderEnv.prototype,{renderEnvToCube:function(n,D,U,w){var C=this,f=C.gv;if(!n||!D||!U)return C.enable=!1,C._42=null,void 0;C.enable=!0;var $=Math.floor(w/n*D),W=f.getGL(),G=C._renderTargets;G?G.length<U&&(G=C._renderTargets=G.concat(new Array(U-G.length))):G=C._renderTargets=new Array(U);for(var l=0;U>l;l++)G[l]?G[l].setSize(W,w,$):G[l]=new rj.RenderTarget(f,W,w,$);var O=!1;C.capture=function(){O=!0,f._42(),O=!1};var y=new Jb,r=new Jb,z=new Jb,v=new Jb,K=(new Jb).setY(0),_=2*Math.PI/U,t=n/2/Math.tan(Math.PI/U),i=2*Math.atan2(D/2,t),P=n/D;C._42=function($,J,R,w){var d=C._debugOn;if(!O&&!d)return!1;y.copy(f.getEye()),v.copy(f.getCenter()).sub(y);var X=Math.atan2(v.z,v.x),a=f.getNear(),T=f.getFovy(),A=f.getAspect();r.copy(f.getCenter());for(var Q,L=0;U>L;L++)if(Q=G[L],K.setZ(Math.cos(X)).setX(Math.sin(X)).multiplyScalar(t),X-=_,z.addVectors(y,K),f.setNear(t),f.setCenter([z.x,z.y,z.z]),f.setFovy(i),f.setAspect(P),d){var M=Math.round(J/U);$.viewport(M*L,0,M,R),w()}else Er($,Q.frame),$.viewport(0,0,Q.width,Q.height),$.clear($.COLOR_BUFFER_BIT),w(),Sh($),Q.assureTexture();return f.setNear(a),f.setCenter([r.x,r.y,r.z]),f.setFovy(T),f.setAspect(A),!0},C.capture()},getTextureInfo:function(l){var C=this._renderTargets;if(!C)return null;var H=this._renderTargets[l];return H?{index:l,texture:H.texture,textureName:H.uuid}:null}}),I.assign(rj.Graph3dView.prototype,{renderEnvToCube:function(R,h,m,C){var u=this;u.envRenderer||(u.envRenderer=new rj.RenderEnv(u)),u.envRenderer.renderEnvToCube(R,h,m,C)}}),rj.RenderTarget=function(w,s,y,r,T){var R=this;T=T||{},T.samples=Math.min(w._glCapabilities.maxSamples,T.samples&&T.samples>1&&2===w._webGLVersion?T.samples:0),R.options=T,R.uuid=v.Math.generateUUID(),R.gv=w,R.init(w,s,T),T.samples&&!w._glCapabilities._maxSamplesChecked?R.setSize(s,y||1,r||1):R.setSize(s,y,r)},I.assign(rj.RenderTarget.prototype,{bind:function(G){Er(G,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(t){Sh(t),this.options.samples&&(t.bindFramebuffer(t.READ_FRAMEBUFFER,this._MSAAFbo),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.frame),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null))},init:function(O,x,Z){var v=this,r=v.texture=x.createTexture();x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE);var I=Z.samples,h=I?x.NEAREST:x.LINEAR;x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,Z.minFilter||h),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,Z.magFilter||h),x.bindTexture(x.TEXTURE_2D,null),v.render=x.createRenderbuffer(),v.frame=x.createFramebuffer(),O._2O[v.uuid]=r},assureTexture:function(){var u=this,a=u.uuid,$=u.gv._2O;$[a]||($[a]=u.texture)},setSize:function(i,V,k){var q=this;if(V&&k&&(q.width!==V||q.height!==k)){var N=i.RGBA,y=i.TEXTURE_2D,v=i.RENDERBUFFER,j=i.FRAMEBUFFER,t=q.options.samples;if(Wl(i,q.texture),i.texImage2D(y,0,N,V,k,0,N,i.UNSIGNED_BYTE,w),i.bindRenderbuffer(v,q.render),t){var e=q.gv._glCapabilities;if(e._maxSamplesChecked)i.renderbufferStorageMultisample(v,t,i.DEPTH_COMPONENT16,V,k);else{for(i.getError();t>1&&(i.renderbufferStorageMultisample(v,t,i.DEPTH_COMPONENT16,V,k),i.getError());)t=Math.floor(t>>1);1>=t&&(t=0,i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,q.options.minFilter||i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,q.options.magFilter||i.LINEAR),i.renderbufferStorage(v,i.DEPTH_COMPONENT16,V,k)),e._maxSamplesChecked=!0,e.maxSamples=q.options.samples=t}}else i.renderbufferStorage(v,i.DEPTH_COMPONENT16,V,k);t&&!q._MSAAFbo&&(q._MSAAFbo=i.createFramebuffer(),q._MSAARbO=i.createRenderbuffer()),Er(i,q.frame),i.framebufferTexture2D(j,i.COLOR_ATTACHMENT0,y,q.texture,0),t||i.framebufferRenderbuffer(j,i.DEPTH_ATTACHMENT,v,q.render),Sh(i),t&&(i.bindRenderbuffer(i.RENDERBUFFER,q._MSAARbO),i.renderbufferStorageMultisample(i.RENDERBUFFER,t,i.RGBA8,V,k),Er(i,q._MSAAFbo),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,q._MSAARbO),i.framebufferRenderbuffer(j,i.DEPTH_ATTACHMENT,v,q.render),Sh(i)),Wl(i,w),i.bindRenderbuffer(v,w),q.width=V,q.height=k}},toCanvas:function(){var M=this,P=M.gv.getGL();Er(P,M.frame);var z=M.width,X=M.height,h=new Uint8Array(4*z*X);P.readPixels(0,0,z,X,P.RGBA,P.UNSIGNED_BYTE,h),Sh(P);var o=j.createElement("canvas");o.width=z,o.height=X;var C=o.getContext("2d"),g=C.createImageData(z,X);return g.data.set(h),C.putImageData(g,0,0),o}});var jf=rj.Interactor=function(M){this.gv=M};Nf("Interactor",I,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Ch=rj.DefaultInteractor=function(S){qj(Ch,this,[S])};Nf("DefaultInteractor",jf,{handle_contextmenu:function($){jm($)},handle_mousewheel:function(Z){this.gv.handleScroll(Z,Z.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(g){jm(g);var L=this,j=L.gv,W=Lg(g),P=j.getDataInfoAt(g),J=P?P.data:w,H=P?P.part:w,e=j.sm(),d=vj(g),_=bs(g);j.setFocus(g)&&(L._62O=w,L._57I=w,J?_n(g)?e.co(J)?e.rs(J):e.as(J):e.co(J)||e.ss(J):W&&(_n(g)?j.isRectSelectable()&&(L._62O=uj):L._57I=Io(g)),L._31Q&&(ei(L._31Q),delete L._31Q,delete L._32Q),L._62O||(j.isFirstPersonMode()&&(Hh(g)||yi(g)||_>2?L._62O="pan":j.isMouseRoamable()||ij?(L._62O="roaming",L.foward=d&&Lg(g),L._32Q=Vb(),L._31Q=Ao(L.tick,L)):W||(L._62O="roaming")),L._62O||(W&&d&&xi[H]?(L._62O=H,L.p3=J.p3()):W&&d&&gr(J)&&j.isSelected(J)?j.isMovable(J)?(L._62O="move",L.p3=J.p3(),L.movedata=J):j._39Q(J)&&(L._62O="none"):ij&&(_>2?L._62O="pan":2===_&&(L.dist=sh(g),L._62O="pinch")))),L.point=j.lp(g),Yl(L,g),Bo(g)?j.handleDoubleClick(g,J,H):j.handleClick(g,J,H))},tick:function(){var E=this,U=E.gv,t=U._moveStep;E.point&&U.isWalkable()&&(E._32Q&&(t*=(Vb()-E._32Q)/50),U.walk(E.foward?t:-t),E._32Q=Vb(),E._31Q=Ao(E.tick,E))},handle_mouseup:function(U){this.handle_touchend(U)},handle_touchend:function(s){var e=this._57I;e&&(Sp(e,Io(s))<=1&&this.gv.sm().cs(),this._57I=w)},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(A){var c,y,g=this,G=g.gv,$=g._62O,s=g.point,o=G.dm(),w=G.lp(A),q=w.x-s.x,v=w.y-s.y,Q=G.getWidth(),f=G.getHeight();if(Q&&f){var W=-e*q/Q,T=-e*v/f;if("roaming"===$)g.rotate(A,W/2,T/2);else if($===$c||$===Tn||$===xk)G._86O||o.beginTransaction(),G.fi({kind:G._86O?"betweenEditRotation":"beginEditRotation",event:A}),G._86O=1,G.sm().each(function(c){if(gr(c)&&G.isRotationEditable(c)){var u=l(W)>l(T)?W:T;$===$c?c.setRotationX(c.getRotationX()+u):$===Tn?c.setRotationY(c.getRotationY()+u):$===xk&&c.setRotationZ(c.getRotationZ()+u)}});else if("move"===$||xi[$]){$===yo||$===Kc||$===up?(G._87O||o.beginTransaction(),G.fi({kind:G._87O?"betweenEditScale":"beginEditScale",event:A}),G._87O=1):(G._moving||o.beginTransaction(),G.fi({kind:G._moving?"betweenMove":"beginMove",event:A}),G._moving=1);var h,n=g.p3,U=G.getPositionInfo(n),k=Zk(G);h=$===Sc?"x":$===_o?"y":$===qs?"z":$===yo?"sx":$===Kc?"sy":$===up?"sz":G.getMoveMode(A,g.movedata),q=q/Q*U.width,v=-1*v/f*U.height;var M,x,K=[k[0]*q,k[4]*q,k[8]*q],r=[k[1]*v,k[5]*v,k[9]*v],R=K[0]+r[0],X=K[1]+r[1],O=K[2]+r[2],Z=[n[0]+R,n[1]+X,n[2]+O],S=jp(G.getEye(),Z,!0);if("xyz"===h?(M=Z,G.moveSelection(R,X,O)):"xz"===h?(M=ph(G,n,[0,1,0],Z),M&&G.moveSelection(M[0]-n[0],0,M[2]-n[2])):"xy"===h?(M=ph(G,n,[0,0,1],Z),M&&G.moveSelection(M[0]-n[0],M[1]-n[1],0)):"yz"===h?(M=ph(G,n,[1,0,0],Z),M&&G.moveSelection(0,M[1]-n[1],M[2]-n[2])):"x"===h||"sx"===h?(S[0]=0,M=ph(G,n,S,Z),M&&(x=M[0]-n[0],"x"===h?G.moveSelection(x,0,0):G.sm().each(function(m){gr(m)&&G.isSizeEditable(m)&&(c=m.getScaleX()+x/100,y=c/m.getScaleX(),m.setScaleX(c),Hh(A)&&(m.setScaleY(m.getScaleY()*y),m.setScaleTall(m.getScaleTall()*y)))
}))):"y"===h||"sy"===h?(S[1]=0,M=ph(G,n,S,Z),M&&(x=M[1]-n[1],"y"===h?G.moveSelection(0,x,0):G.sm().each(function(b){gr(b)&&G.isSizeEditable(b)&&(c=b.getScaleTall()+x/100,y=c/b.getScaleTall(),b.setScaleTall(c),Hh(A)&&(b.setScaleY(b.getScaleY()*y),b.setScaleX(b.getScaleX()*y)))}))):("z"===h||"sz"===h)&&(S[2]=0,M=ph(G,n,S,Z),M&&(x=M[2]-n[2],"z"===h?G.moveSelection(0,0,x):G.sm().each(function(H){gr(H)&&G.isSizeEditable(H)&&(c=H.getScaleY()+x/100,y=c/H.getScaleY(),H.setScaleY(c),Hh(A)&&(H.setScaleX(H.getScaleX()*y),H.setScaleTall(H.getScaleTall()*y)))}))),!M)return;g.p3=M}else if($===uj){var p=g.div;p||(p=g.div=xl(),Pj(g.getView(),p),p.op=s,p.style.background=G.getRectSelectBackground()),G.fi({kind:G._rectSelecting?"betweenRectSelect":"beginRectSelect",event:A}),G._rectSelecting=1,p.rect=ye(p.op,w),Wp(p,p.rect)}else if("pinch"===$&&2===bs(A)){G.fi({kind:G._pinching?"betweenPinch":"beginPinch",event:A}),G._pinching=1;var x=sh(A);G._lastZoomLP||(G._lastZoomLP=xb(A)),G.handlePinch(x,g.dist),g.dist=x}else"pan"===$||Hh(A)||yi(A)?g.pan(A,q,v):"none"===$||G.isFirstPersonMode()||g.rotate(A,W,T);g.point=w}},pan:function(p,N,i){var q=this.gv;if(q.isPannable()){var m=q.getWidth(),F=q.getHeight();if(!m||!F)return;var s=q.getCenterInfo(),U=N/m*s.width,z=-1*i/F*s.height;q.fi({kind:q._panning?"betweenPan":"beginPan",event:p}),q._panning=1,q.pan(-U,-z)}},rotate:function(T,p,L){var K=this.gv;K.isRotatable()&&(K.fi({kind:K._rotating?"betweenRotate":"beginRotate",event:T}),K._rotating=1,K.rotate(p,L))},handleWindowMouseUp:function(Q){this.handleWindowTouchEnd(Q)},handleWindowTouchEnd:function(m){var A=this,P=A.gv,f=P.dm(),W=A.div;if(W){var Z=P.getDatasInRect(W.rect);if(!Z.isEmpty()){var D=P.sm(),v=D.toSelection();Z.each(function(W){D.co(W)?v.remove(W):v.add(W)}),D.ss(v)}ck(W)}P._moving&&(delete P._moving,P.fi({kind:"endMove",event:m}),P.onMoveEnded(),f.endTransaction()),P._panning&&(delete P._panning,P.fi({kind:"endPan",event:m}),P.onPanEnded()),P._rotating&&(delete P._rotating,P.fi({kind:"endRotate",event:m}),P.onRotateEnded()),P._86O&&(delete P._86O,P.fi({kind:"endEditRotation",event:m}),f.endTransaction()),P._87O&&(delete P._87O,P.fi({kind:"endEditScale",event:m}),f.endTransaction()),P._pinching&&(delete P._pinching,P.fi({kind:"endPinch",event:m}),P.onPinchEnded()),P._rectSelecting&&(delete P._rectSelecting,P.fi({kind:"endRectSelect",event:m}),P.onRectSelectEnded()),P._walking&&(delete P._walking,P.fi({kind:"endWalk",event:m}),P.onWalkEnded()),P._lastZoomLP=P._lastZoomHit=null,A.dist=A.point=A._62O=A.p3=A.movedata=A.div=A._57I=A._32Q=A._31Q=A.foward=w}});var ni=rj.MapInteractor=function(M){qj(ni,this,[M]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Nf("MapInteractor",jf,{handle_contextmenu:function(T){jm(T)},handle_mousewheel:function(i){this.gv.handleScroll(i,i.wheelDelta/40)},handle_DOMMouseScroll:function(W){2===W.axis&&this.gv.handleScroll(W,-W.detail)},handle_keydown:function(F){this.gv.handleKeyDown(F)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(G){jm(G);var T=this,o=T.gv;if(o.setFocus(G)){var U=o.getDataInfoAt(G),a=U?U.data:w,m=U?U.part:w,_=T.editing={point:o.lp(G)};ij?_.touch=!0:(_.touch=!1,_.clickLeft=Lg(G),_.pan=yi(G)?!0:"left"===this.panButton===_.clickLeft),a&&o._39Q(a)&&(_.preventDefault=!0),Yl(T,G),Bo(G)?o.handleDoubleClick(G,a,m):o.handleClick(G,a,m)}},handle_mouseup:function(F){this.handle_touchend(F)},handle_touchend:function(){},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(k){var u=this,T=u.gv,G=u.editing;if(G){var p=T.lp(k),h=G.point,j=p.x-h.x,O=p.y-h.y;if(!G.moved){if(Math.abs(j)<u.threshold&&Math.abs(O)<u.threshold&&!(k.touches&&k.touches.length>1))return;G.moved=!0}if(!G.preventDefault)if(G.point=p,G.touch){var I=k.touches.length;if(2!==I)u.pan(k,j,O);else{if(1>=I)return;var l=k.touches,i={x:l[0].clientX,y:l[0].clientY},Z={x:l[1].clientX,y:l[1].clientY},F={x:Z.x-i.x,y:Z.y-i.y},f=G.lastCenter,Y=Math.atan2(F.y,F.x),U=G.theta,P=0;U==w?U=G.theta=Y:(P=Y-U,G.thetaStarted||Math.abs(P)>u.touchRotateThreshold?(G.thetaStarted=!0,G.theta=Y):P=0);var x=Q*(i.y+Z.y)/2/T.getHeight(),J=G.phi,y=0;J==w?J=G.phi=x:(y=x-J,G.phiStarted||Math.abs(y)>u.touchRotateThreshold?(G.phiStarted=!0,G.phi=x):y=0);var q,E=Math.sqrt(F.x*F.x+F.y*F.y),$=G.vlen;if($){var v=i.x-f.x,H=i.y-f.y,r=Z.x-f.x,R=Z.y-f.y,d=Math.sqrt(v*v+H*H),c=Math.sqrt(r*r+R*R),t=$/2,b=u._sign2(d-t),A=u._sign2(c-t);0>b*A||0===b&&0===A?(q=1,G.vlen=E):(q||(q=E/$),G.scaleStarted||Math.abs(q-1)>u.touchScaleThreshold?(G.vlen=E,G.scaleStarted=!0):q=1)}else $=G.vlen=E,q=1;1!==q&&T.setZoom(q),(y||P)&&u.rotate(k,P,-y),G.lastCenter={x:(Z.x+i.x)/2,y:(Z.y+i.y)/2}}}else if(G.pan)u.pan(k,j,O);else{var M=T.getWidth(),X=T.getHeight();if(!M||!X)return;var W=-e*j/M,C=-e*O/X;u.rotate(k,W,C)}}},_sign2:function(R){return Math.abs(R)<this._touchScaleCheckAccuracy?0:R>0?1:-1},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(_){var H=this,R=H.editing;if(H.editing=null,R){var L=H.gv;if(R.moved||!R.clickLeft&&!R.touch)L._panning=null,L._rotating=null,L.fi({kind:R.pan?"endPan":"endRotate",event:_});else{var y=L.getDataAt(_);y?L.sm().setSelection([y]):L.sm().clearSelection()}}},pan:function(Z,P,Q){var m=this,O=m.gv;if(O.isPannable()){var d=O.getWidth(),G=O.getHeight();if(d&&G){var E=O.getCenterInfo(),j=-P/d*E.width,T=1*Q/G*E.height;O.fi({kind:O._panning?"betweenPan":"beginPan",event:Z}),O._panning=1;var M=m.keepHorizon,N=m.editing.touch;if((N&&Z.touches&&Z.touches.length>1||!N&&Hh(Z))&&(M=!M),!M)return O.pan(j,T);if(j||T){var S=Zk(O),U=[S[0]*j,S[4]*j,S[8]*j],q=[S[1],0,S[9]],V=Math.sqrt(q[0]*q[0]+q[2]*q[2]);V&&(q=[q[0]/V*T,0,q[2]/V*T]);var h=U[0]+q[0],A=U[1]+q[1],y=U[2]+q[2],c=O._center,I=O._eye;c[0]+=h,c[1]+=A,c[2]+=y,I[0]+=h,I[1]+=A,I[2]+=y,O.fp(Wj,w,I),O.fp(Te,w,c)}}}},rotate:function(R,P,o){var L=this,y=L.gv;if(y.isRotatable()){var U=y._center,f=y._eye,q=jp(f,U),g=T(Z(q[0]*q[0]+q[2]*q[2]),q[1]),B=Lk(g+o);o=B-g,y.fi({kind:y._rotating?"betweenRotate":"beginRotate",event:R}),y._rotating=1,y.rotate(P,o)}}}),I.defineProperties(ni.prototype,{panButton:{get:function(){return this._panButton},set:function(i){this._panButton=i}},minPhi:{get:function(){return C.graph3dViewMinPhi},set:function(I){C.graph3dViewMinPhi=I}},maxPhi:{get:function(){return C.graph3dViewMaxPhi},set:function(G){C.graph3dViewMaxPhi=G}},keepHorizon:{get:function(){return this._keepHorizon},set:function(y){this._keepHorizon=y}},threshold:{get:function(){return this._threshold},set:function(X){this._threshold=X}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(L){this._touchScaleThreshold=L}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(R){this._touchRotateThreshold=R}}});var dl,zf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Bj=32,Lc=rj.GlobeInteractor=function(j,m){qj(Lc,this,[j]);var A,e=m.radius||6378137,t=this,x=null;dl||(dl=xl(),dl.style.border="",dl.style.backgroundImage="url("+zf+")");var i=new il,b=new Jb,Q=new Jb,u=new Jb,E=new dm,Z="number"==typeof e?{x:e,y:e,z:e}:e,P={center:new Jb(0,0,0),radius:Z},z=function(F){j._81O=null;var c=j.getHitPosition(F,j.getCenter(),b.copy(j.getEye()).sub(Q.copy(j.getCenter())).toArray());return E.origin.copy(j.getEye()),E.direction.copy(c).sub(E.origin).normalize(),E.intersectEllipsoid(P)},f=function(Z,D){j._81O=null,E.origin.copy(j.getEye());for(var v,k,X=j.getCenter(),O=b.copy(j.getEye()).sub(Q.copy(j.getCenter())).toArray(),y=1,J=16,s=0,W=1,$={x:0,y:0};J--;){if($.x=D.x+(Z.x-D.x)*y,$.y=D.y+(Z.y-D.y)*y,v=j.getHitPosition($,X,O),E.direction.copy(v).sub(E.origin).normalize(),k=E.intersectEllipsoid(P),k&&1===y)return{hit:k};k?s=y:W=y,y=(s+W)/2}return{hit:k,out:1>y}},c=function(r,a){if(x){var e=Date.now();x.deltaTime=x.lastTime?e-x.lastTime:1e3,x.lastTime=e,x.lastAxis=r,x.lastAngle=a}a&&(i.setFromAxisAngle(r,a),j.setEye(b.copy(j.getEye()).applyQuaternion(i).toArray()),j.setCenter(b.copy(j.getCenter()).applyQuaternion(i).toArray()),j.setUp(b.copy(j.getUp()).applyQuaternion(i).toArray()))};t._showCrossIcon=function(z){Pj(t.getView(),dl),Wp(dl,{x:z.clientX-Bj/2,y:z.clientY-Bj/2,width:Bj,height:Bj})},t._hideCrossIcon=function(){ck(dl)},t._scrollImpl=function(H,T){x={point:j.lp(H),screen:Io(H),hit:z(H),type:"right"},x.hitNormalize=x.hit?x.hit.clone().normalize():new Jb;var E={clientX:x.screen.x,clientY:x.screen.y+10*T};t._handleMoveImpl(E),t._endMoveImpl(E)},t._startMoveImpl=function(G){A&&(A.stop(!0),A=null),x={point:j.lp(G),screen:Io(G),hit:z(G)},x.hitNormalize=x.hit?x.hit.clone().normalize():new Jb,ij?1===G.touches.length?x.hit&&(x.type="left"):2===G.touches.length&&(x.type="touch2"):(Lg(G)?x.hit&&(x.type="left"):Gp(G)?x.type="right":yi(G)&&x.hit&&(x.type="middle"),!x.hit||"right"!==x.type&&"middle"!==x.type||t._showCrossIcon(G)),x.type&&Yl(t,G)},t._handleMoveImpl=function(U){if(x)switch(x.type){case"left":return t._handleLeft(U);case"right":return t._handleRight(U);case"middle":return t._handleMiddle(U);case"touch2":return t._handleTouch2(U)}},t._endMoveImpl=function(){if(x){if(this._hideCrossIcon(),"left"===x.type||"middle"===x.type){var k=1e3*(x.lastAngle/(x.deltaTime||30)),D=x.lastAxis,K=x.lastTime,T=function(){var m=Date.now(),i=(m-K)/1e3;return K=m,k*=Math.pow(Math.abs(t.decelerationRate),3*i),Math.abs(k)<.01?(k=0,A&&A.stop(),void 0):(c(D,k*i),void 0)};A=ar({action:function(){T(arguments)},duration:5e3})}x=null}},t._handleLeft=function(n){if(!x.finished){var P=Io(n),R=f(P,x.lastScreen||x.screen);if(x.lastScreen=P,!R.hit)return x.finished=!0,t._endMoveImpl(n),void 0;var A=R.hit;A.normalize();var k=x.hitNormalize,Y=Math.acos(A.dot(k)),h=A.cross(k).normalize();c(h,Y),R.out&&(x.finished=!0,t._endMoveImpl(n))}},t._handleRight=function(y){var A=x.lastScreen||x.screen,Y=A.y;A=x.lastScreen=Io(y);var h=A.y,l=h-Y;if(l){var f=Math.min(.5,l*t.scaleSpeed);b.copy(j.getEye());var L=x.hit;L||(L=b.clone().divide(Z).normalize().multiply(Z)),Q.copy(b).lerp(L,f),j.setEye(Q.toArray()),b.copy(j.getUp()),Q.normalize();var E=b.clone().cross(Q).normalize();if(u.copy(j.getCenter()),u.sub(E.multiplyScalar(u.dot(E))),j.setCenter(u.toArray()),x.hit){var i=z(x.screen),n=x.hitNormalize;if(i){i.normalize();var W=Math.acos(i.dot(n)),v=i.cross(n).normalize();W&&c(v,W)}}}};var M=function(C){return Math.abs(C)<.01?0:C>0?1:-1};t._handleTouch2=function(Z){var b=Z.touches.length;if(2===b){var s=Z.touches,V={x:s[0].clientX,y:s[0].clientY},i={x:s[1].clientX,y:s[1].clientY},L={x:i.x-V.x,y:i.y-V.y},r=x.lastCenter,v=Math.atan2(L.y,L.x),q=x.theta,X=0;q==w?q=x.theta=v:(X=v-q,x.thetaStarted||Math.abs(X)>.03?(x.thetaStarted=!0,x.theta=v):X=0);var S,z=Math.sqrt(L.x*L.x+L.y*L.y),I=x.vlen;if(I){var A=V.x-r.x,K=V.y-r.y,G=i.x-r.x,k=i.y-r.y,C=Math.sqrt(A*A+K*K),N=Math.sqrt(G*G+k*k),H=I/2,F=M(C-H),O=M(N-H);0>F*O||0===F&&0===O?(S=1,x.vlen=z):(S||(S=z/I),x.scaleStarted||Math.abs(S-1)>.05?(x.vlen=z,x.scaleStarted=!0):S=1)}else I=x.vlen=z,S=1;var L=Q.copy(j.getEye()).clone();1!==S&&j.setEye(L.setLength((L.length()-e)/S+e).toArray()),X&&c(L.normalize(),X),x.lastCenter={x:(i.x+V.x)/2,y:(i.y+V.y)/2}}},t._handleMiddle=function(N){var w=Io(N),s=x.screen;x.screen=w;var J=(w.y-s.y)/180*Math.PI*t.rollSpeed;Q.copy(j.getCenter()).sub(b.copy(j.getEye())).normalize(),b.copy(j.getUp()).cross(Q).normalize(),Q.copy(j.getEye()).sub(x.hit).applyAxisAngle(b,J).add(x.hit);var S=Q.clone();Q.copy(j.getCenter()).sub(x.hit).applyAxisAngle(b,J).add(x.hit);var k=Q.clone(),B=Q.copy(j.getUp()).applyAxisAngle(b,J).clone(),A=!1;J>0&&(u.copy(B),Q.copy(k).sub(S).normalize(),b.copy(S).multiplyScalar(-1).normalize(),b.dot(u)-Q.dot(u)>0&&(A=!0)),A||u.copy(x.hit).sub(S).dot(x.hitNormalize)>=0&&(A=!0),A||(j.setEye(S.toArray()),j.setCenter(k.toArray()),j.setUp(B.toArray()));var r=-(w.x-s.x)/180*Math.PI*t.rotateSpeed;c(x.hitNormalize,r)}};Nf("GlobeInteractor",jf,{handle_contextmenu:function(u){jm(u)},handle_mousewheel:function(A){this._scrollImpl(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(y){2===y.axis&&this._scrollImpl(y,-y.detail)},handle_keydown:function(W){this.gv.handleKeyDown(W)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(h){jm(h);var $=this.gv;if($.setFocus(h)){var g=$.getDataInfoAt(h),j=g?g.data:w;j&&$.isInteractive(j)||this._startMoveImpl(h);var A=g?g.part:w;Bo(h)?$.handleDoubleClick(h,j,A):$.handleClick(h,j,A)}},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(){},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowTouchMove:function(c){this._handleMoveImpl(c)},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(x){this._endMoveImpl(x)}}),I.defineProperties(Lc.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(T){this._rotateSpeed=T}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(G){this._rollSpeed=G}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(n){this._scaleSpeed=n}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(g){this._decelerationRate=g}}});var Ah=function(J){this.gv=J};vo(Ah,I,{_iv:!0,iv:function(){this._iv=!0},face:function(f,H){var i=this,A=i.gv.getGL();if(!A||!gr(f))return w;var e=H.x,t=H.width,s=H.height,j=i.height-H.y-s,X=p(t/2),Q=new Uint8Array(4*t*s),C=0;for(i.iv(),i.validate(f),Er(A,i.frame),A.readPixels(e,j,t,s,A.RGBA,A.UNSIGNED_BYTE,Q),Sh(A),i.iv();X>=C;C++)for(var R=X-C,v=X+C,K=R;v>=K;K++)for(var d=R;v>=d;d++)if(K===R||K===v||d===R||d===v){var q=fr.m[Q[4*(K*t+d)]];if(q)return q}},get:function(j,N){this.validate();var R=this,v=R.gv.getGL();if(!v)return w;var L,B,I=j.x,k=j.width,Z=j.height,Q=R.height-j.y-Z,e=p(k/2),l=new Uint8Array(4*k*Z),U=0,V=l.length,u=N?w:new Pb,y=N?w:{};if(Er(v,R.frame),v.readPixels(I,Q,k,Z,v.RGBA,v.UNSIGNED_BYTE,l),Sh(v),N){for(;e>=U;U++)for(var M=e-U,O=e+U,i=M;O>=i;i++)for(var z=M;O>=z;z++)if((i===M||i===O||z===M||z===O)&&(L=R.info(l,4*(i*k+z))))return L}else for(;V>U;U+=4)L=R.info(l,U),L&&(B=L.data,y[B._id]||(u.add(B),y[B._id]=B));return u},info:function(N,B){return this.colorMap[(N[B]<<16)+(N[B+1]<<8)+N[B+2]+((127&N[B+3])<<24)]},validate:function(g){var R=this,x=R.gv,v=x.getGL();if(v){var K=x.getWidth(),M=x.getHeight(),k=v.RGBA,i=v.TEXTURE_2D,s=v.RENDERBUFFER,D=v.FRAMEBUFFER;R.texture||(R.texture=mq(v),R.render=v.createRenderbuffer(),R.frame=v.createFramebuffer()),(R.width!==K||R.height!==M)&&(Wl(v,R.texture),v.texImage2D(i,0,k,K,M,0,k,v.UNSIGNED_BYTE,w),Gq(v,v.TEXTURE_MIN_FILTER,v.LINEAR),v.bindRenderbuffer(s,R.render),v.renderbufferStorage(s,v.DEPTH_COMPONENT16,K,M),Er(v,R.frame),v.framebufferTexture2D(D,v.COLOR_ATTACHMENT0,i,R.texture,0),v.framebufferRenderbuffer(D,v.DEPTH_ATTACHMENT,s,R.render),Wl(v,w),v.bindRenderbuffer(s,w),Sh(v),R.width=K,R.height=M),R._iv&&(R._iv=!1,Er(v,R.frame),x._42(g||(R.colorMap={}),1),Sh(v))}}});var Dn=function(R){this.gv=R};vo(Dn,I,{gap:0,size:0,_42:function(U,M){var J=this,$=J.gv,K=$._gridGap,B=$._gridSize;if($._gridVisible){if(J.gap!==K||J.size!==B){for(var T=[],z=$._gridSize/2,t=K*z,_=0;2*z+1>_;_++){var W=6*_,O=6*(2*z+1)+W;T[W]=-t,T[W+1]=0,T[W+2]=-t+_*K,T[W+3]=t,T[W+4]=0,T[W+5]=-t+_*K,T[O]=-t+_*K,T[O+1]=0,T[O+2]=-t,T[O+3]=-t+_*K,T[O+4]=0,T[O+5]=t}J.vs=new Ud(T),J.gap=K,J.size=B}Bf($),Ec(U,M),Nq(U),Kn(U,M,1,$._gridColor,$._buffer.vs,J.vs),Jj(U,0,J.vs.length/3,U.LINES),xp(U),Xd(U,M)}else J.vs=J.gap=J.size=w}});var Gj=function(A){this.gv=A};vo(Gj,I,{_42:function($,R){var O=this.gv,b=O._buffer.vs,U=O._axisXColor,M=O._axisYColor,E=O._axisZColor,h=O._originAxisVisible,Z=O._centerAxisVisible;if(h||Z){var e=pk?$.TRIANGLES:$.TRIANGLE_FAN,X=$.LINES;if(Bf(O),Ec($,R),Nq($),h){var q=O.getCenterInfo(),f=V(q.width,q.height)/5,k=.8*f,u=.05*f;Kn($,R,1.5,U,b,new Ud([0,0,0,f,0,0,k,u,0,k,0,u,k,-u,0,k,0,-u,k,u,0,0,0,0,0,f,0,u,k,0,0,k,u,-u,k,0,0,k,-u,u,k,0,0,0,0,0,0,f,u,0,k,0,u,k,-u,0,k,0,-u,k,u,0,k])),Jj($,0,2,X),Jj($,1,6,e),Kn($,R,w,M),Jj($,7,2,X),Jj($,8,6,e),Kn($,R,w,E),Jj($,14,2,X),Jj($,15,6,e)}if(Z){var i=O._center,x=i[0],F=i[1],G=i[2],q=O.getPositionInfo(i);f=V(q.width,q.height)/20,Kn($,R,1.5,U,b,new Ud([x,F,G,x+f,F,G,x,F,G,x,F+f,G,x,F,G,x,F,G+f])),Jj($,0,2,X),Kn($,R,w,M),Jj($,2,2,X),Kn($,R,w,E),Jj($,4,2,X)}xp($),Xd($,R)}}});var Em=function(Q){this.gv=Q,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Em.Mode.Disable};Em.Mode={Disable:0,Selection:1,MouseOver:2},vo(Em,I,{onMouseOver:function(S){C.preventDefault(S);var A=this.gv.getDataAt(S);A!==this.mouseOverData&&(this.mouseOverData=A,this.gv.iv())},setFetchTargetFunc:function(r){this.fetchTargetFunc=r},_42:function(s,Z){var A,D=this,Q=D._mode;if(Q!==Em.Mode.Disable&&(Q===Em.Mode.Selection?A=D.gv.sm().getSelection().toArray(function(s){return s.s("highlight.visible")}):Q===Em.Mode.MouseOver&&D.mouseOverData&&D.mouseOverData.s("highlight.visible")&&(A=[D.mouseOverData]),D.fetchTargetFunc&&(A=D.fetchTargetFunc(A)),A&&A.length)){var y=D.gv,S=y.vr.isPresenting(),_=y.getWidth();if(S){var U=y.getWidth;_/=2,y.getWidth=function(){return _};var v=y.getViewport()}var t,J=y.getDevicePixelRatio(),c=_*J,e=y.getHeight()*J;(t=D._renderTarget)?t.setSize(s,c,e):D._renderTarget=t=new rj.RenderTarget(y,s,c,e),Er(s,t.frame),y.drawFilter=function(K){return A.indexOf(K)<0?!0:void 0},y._42({}),y.drawFilter=null,Sh(s),S&&(y.getWidth=U,y.setViewport(s,v[0],v[1],v[2],v[3]));var I=s._compiledShader.highlight;if(I||(I=s._compiledShader.highlight=new Rd.Shader(s,Td.vs,Td.fs)),I.bind(),s.enable(s.BLEND),s.activeTexture(s.TEXTURE0+0),s.bindTexture(s.TEXTURE_2D,t.texture),I.uniforms.image=0,I.uniforms.textureSize=[c,e],I.uniforms.edgeWidth=Y["highlight.width"],D.highlightColor!==Y["highlight.color"]){var r=Jf(D.highlightColor=Y["highlight.color"]);D.highlightColorData=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]}I.uniforms.edgeColor=D.highlightColorData,D.ibuffer?(D.ibuffer.upload(),D.vbuffer.upload()):(D.ibuffer=Rd.Buffer.createIndexBuffer(s,new Uint16Array([0,2,1,1,2,3])),D.vbuffer=Rd.Buffer.createVertexBuffer(s,new Float32Array([0,0,1,0,0,1,1,1]))),I.attributes.pos.pointer(D.vbuffer),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),s.disable(s.BLEND),s.bindTexture(s.TEXTURE_2D,null),s.useProgram(Z)}}}),I.defineProperties(Em.prototype,{mode:{get:function(){return this._mode},set:function(i){var C=this._mode;i!==C&&(this._mode=i,i===Em.Mode.MouseOver?X(this.gv.getView(),"mousemove",this.onMouseOver):C===Em.Mode.MouseOver&&q(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Td={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},kb=function(N){this.gv=N},Sc="edit_tx",_o="edit_ty",qs="edit_tz",$c="edit_rx",Tn="edit_ry",xk="edit_rz",yo="edit_sx",Kc="edit_sy",up="edit_sz",xi={};xi[Sc]=1,xi[_o]=1,xi[qs]=1,xi[$c]=1,xi[Tn]=1,xi[xk]=1,xi[yo]=1,xi[Kc]=1,xi[up]=1,vo(kb,I,{_42:function(l,C,K){var t=this,y=t.gv,V=y.sm().ld();if(V&&y.isEditable(V)&&!y.isEditHelperDisabled()&&gr(V)&&(!y.isFirstPersonMode()||!y.isMouseRoamable()&&!ij)){Bf(y);var X,A,F=y.isMovable(V),M=y.isRotationEditable(V),N=y.isSizeEditable(V),w=y._axisXColor,m=y._axisYColor,c=y._axisZColor,H=y._editSizeColor,P=V.p3(),h=Sp(y.getEye(),P)/10,W=h/(K?5:10),D=.7*h,x=.4*D,d=P[0],E=P[1],T=P[2];X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],F&&t._17O(l,C,V,K,Sc,w,X,[d,E-W,T,d+D,E-W,T,d+D,E,T,d+D,E,T,d,E,T,d,E-W,T,d,E-W,T+W,d+D,E-W,T+W,d+D,E-W,T,d+D,E-W,T,d,E-W,T,d,E-W,T+W]),A=d+D,N&&t._17O(l,C,V,K,yo,H,X,[A,E-W,T,A+x,E-W,T,A+x,E,T,A+x,E,T,A,E,T,A,E-W,T,A,E-W,T+W,A+x,E-W,T+W,A+x,E-W,T,A+x,E-W,T,A,E-W,T,A,E-W,T+W]),A+=x,M&&t._17O(l,C,V,K,$c,w,X,[A,E-W,T,A+x,E-W,T,A+x,E,T,A+x,E,T,A,E,T,A,E-W,T,A,E-W,T+W,A+x,E-W,T+W,A+x,E-W,T,A+x,E-W,T,A,E-W,T,A,E-W,T+W]),X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],F&&t._17O(l,C,V,K,_o,m,X,[d,E,T,d,E+D,T,d-W,E+D,T,d-W,E+D,T,d-W,E,T,d,E,T,d,E,T,d,E,T-W,d,E+D,T-W,d,E+D,T-W,d,E+D,T,d,E,T]),A=E+D,N&&t._17O(l,C,V,K,Kc,H,X,[d,A,T,d,A+x,T,d-W,A+x,T,d-W,A+x,T,d-W,A,T,d,A,T,d,A,T,d,A,T-W,d,A+x,T-W,d,A+x,T-W,d,A+x,T,d,A,T]),A+=x,M&&t._17O(l,C,V,K,Tn,m,X,[d,A,T,d,A+x,T,d-W,A+x,T,d-W,A+x,T,d-W,A,T,d,A,T,d,A,T,d,A,T-W,d,A+x,T-W,d,A+x,T-W,d,A+x,T,d,A,T]),X=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],F&&t._17O(l,C,V,K,qs,c,X,[d,E,T,d,E,T+D,d,E-W,T+D,d,E-W,T+D,d,E-W,T,d,E,T,d,E-W,T,d-W,E-W,T,d-W,E-W,T+D,d-W,E-W,T+D,d,E-W,T+D,d,E-W,T]),A=T+D,N&&t._17O(l,C,V,K,up,H,X,[d,E,A,d,E,A+x,d,E-W,A+x,d,E-W,A+x,d,E-W,A,d,E,A,d,E-W,A,d-W,E-W,A,d-W,E-W,A+x,d-W,E-W,A+x,d,E-W,A+x,d,E-W,A]),A+=x,M&&t._17O(l,C,V,K,xk,c,X,[d,E,A,d,E,A+x,d,E-W,A+x,d,E-W,A+x,d,E-W,A,d,E,A,d,E-W,A,d-W,E-W,A,d-W,E-W,A+x,d-W,E-W,A+x,d,E-W,A+x,d,E-W,A])}},_17O:function(n,i,z,F,p,J,R,W){var N=this.gv._buffer;pq(n,i,F,!0,z,p),gm(n,i,w,!0,w,!0,w,!1),Vi(n,i.uDiffuse,J),jg(n,N.vs,new Ud(W),i.aPosition),jg(n,N.ns,new Ud(R),i.aNormal),Nq(n),Jj(n,0,12),xp(n),pr(n,i)}});var Om=v.Raycaster=function(u){this.gv=u,this.maxTriangleTest=1/0,this.backfaceCulling=!0};zc("Raycaster",I,{intersect:function(m){var V=this,y=V.gv,F=y.getDataAt(m);return F?V.intersectObject(m,F):null},intersectObjects:function(k,J,g){var O,q,R,$,A=this,H=1/0,h=k.origin||(new Jb).fromArray(A.gv.getEye()),y=A.maxTriangleTest,b=[];return J.forEach(function(R){g&&g(R)===!1||R.s("intersect")!==!1&&b.push(R)}),b.sort(function(m,C){return h.distanceToSquared2(m.p3())-h.distanceToSquared2(C.p3())}),A.countTriangles=0,b.forEach(function(u){A.countTriangles>y||(O=A.intersectObject(k,u),O&&(q=h.distanceToSquared(O.world),H>q&&(R=u,$=O,H=q)))}),A.countTriangles=0,{data:R,intersect:$}},intersectObject:function($,F){if($ instanceof dm)return this._intersectObjectImpl($,F);var y=this,z=y.gv,x=z.unproject($),L=new Jb,G=z.getEye(),Q=new Jb;if(z.isOrtho()){var R=new Jb(G);Q.copy(z.getCenter()).sub(R).normalize();var t=L.copy(x).sub(R).dot(Q);L.copy(Q).setLength(-t).add(R.copy(x))}else L.copy(G),Q.copy(x).sub(L).normalize();var K=new v.Math.Ray(L,Q);return y._intersectObjectImpl(K,F)},_intersectObjectImpl:function(){function O(){var P=new Jb;return P.subVectors(n,g),F.subVectors(q,g),P.cross(F).normalize(),P}function A(E,T,b,X,S,W,y){return Kj.barycoordFromPoint(E,T,b,X,H),S.multiplyScalar(H.x),W.multiplyScalar(H.y),y.multiplyScalar(H.z),S.add(W).add(y),S.clone()}function S(_,T,F){qf(_)?_.forEach(function(C){S(C,T,F)}):tq(_)?S(Hf(T,_),T,F):as(_)&&(_.shape3d?S(_.shape3d,T,F):F.push(_))}var y=new _e,p=new _e,T=new dm,u=new Jb,M=new Jb,U=new Jb,e=new Jb,b=new Jb,q=new Jb,g=new Jb,n=new Jb,V=new fd,P=new fd,z=new fd,F=new Jb,K={vs:rg,is:cj,uv:Wc},H=new Jb;return function(L,f){var $=this.gv.getData3dUI(f),I=f.mat||$.mat;if(I){y.fromArray(I),p.getInverse(y),T.copy(L).applyMatrix4(p);var R,k,N="body",d=$.shapeModel;if(d||(d=Hf($)),d||(f instanceof v.Node&&!(f instanceof v.Shape)?(R=!0,d=K):(k=!0,d=[$.left,$.front,$.right,$.back,$.top,$.bottom])),!d)return console.log("Can not find shape model."),null;qf(d)||(d=[d]);var c,X,F,C,j,B,m,t,Q,W,Y,w,o,l,_,a,x=1/0,h=["","top_","bottom_"],r=!1,H=this.backfaceCulling,E=[];for(S(d,$,E),c=0,X=E.length;X>c;c++)if(o=E[c])for(F=0,C=h.length;C>F;F++)if(l=h[F],m=o[l+"vs"],t=o[l+"is"],Q=o[l+"uv"]||o[l+"tuv"],m){if(_=o[l+"boundingBox"]){var Y=T.intersectBox(_);if(!Y)continue;if(T.origin.distanceTo(Y)>x)continue;a=!1}else o[l+"boundingBox"]=_=new v.Math.Box3,a=!0;for(j=0,B=t?t.length:m.length/3;B>j;j+=3)this.countTriangles++,t?(M.fromArray(m,3*t[j]),U.fromArray(m,3*t[j+1]),e.fromArray(m,3*t[j+2])):(M.fromArray(m,3*j),U.fromArray(m,3*(j+1)),e.fromArray(m,3*(j+2))),a&&(_.expandByPoint(M),_.expandByPoint(U),_.expandByPoint(e)),W=T.intersectTriangle(M,U,e,H,u),W&&(w=T.origin.distanceTo(W),x>w&&(x=w,b.copy(W),q.copy(M),g.copy(U),n.copy(e),""!==l?N=l.slice(0,-1):R?N=yq[Math.floor(j/6)]:k&&(N=yq[c]),Q&&(r=!0,t?(V.fromArray(Q,2*t[j]),P.fromArray(Q,2*t[j+1]),z.fromArray(Q,2*t[j+2])):(V.fromArray(Q,2*j),P.fromArray(Q,2*(j+1)),z.fromArray(Q,2*(j+2))))))}if(!isFinite(x))return null;var i,s=b.clone().applyMatrix4(y);r&&(i=A(b,q,g,n,V,P,z));var D=O(q,g,n),J=O(q.applyMatrix4(y),g.applyMatrix4(y),n.applyMatrix4(y)),Z=T.direction.dot(D);return Z>0&&(D.multiplyScalar(-1),J.multiplyScalar(-1)),{world:s,local:b.clone(),worldNormal:J,normal:D,uv:i,part:N}}}}()});var kp=function(D,L){this.gv=D,this.s=function(N,b,j){return b==w&&(b=j),b==w?L.getStyle(N):mo(b,L,D)},this.data=L};vo(kp,I,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(O,g,n,L){var G=this,t=G.data;if(!(t instanceof jl)){var N,u,m,z,V,S,l,Y=G.gv,M=t._id,U=G.s("alwaysOnTop")||G.s("shape3d.alwaysOnTop")?null:G.s("batch"),P=Y._batchIndexMap,r=Y._batchModelMap,k=Y.isSelectable(t),W=Y.getBrightness(t),F=W!=w&&1!==W;if(G.needValidate(O)){if(m=jr(P,r,t,U),G.validate(m,U?Pe[U]||af:w),m&&(z=P[M],V=z.size=m.vs.length/3-z.begin,l=m.rs))for(W=F?W:1,S=0;V>S;S++)l.push(W);if(gr(t)){var i=Y.getWireframeGeometry(t);if(i)zo(Y,t,i);else{var s=Y.getWireframe(t);s&&zo(Y,t,s)}}G.labelInfo=G.label2Info=G.noteInfo=G.note2Info=G._38o=w,G._24O(Xf,"getLabel"),G._24O(Xp,"getLabel2"),G._26O(Mm,"getNote"),G._26O(Ie,"getNote2"),G._15O(),G.interactiveInfo=Y.isInteractive(t)?{}:w,G._iv=!1}F&&Vi(O,g.uBrightness,W),Vi(O,g.uAlphaTest,G.s("alphaTest")),Vi(O,g.uUseEnvMap,t.s("envmap")?!0:!1),Vi(O,g.uReflectivity,t.s("envmap")||.01);var f=G.s("3d.clip.direction");if(f){var H=G.s("3d.clip.percent");switch(f){case"left":f=2;break;case"top":f=3;break;case"bottom":f=4;break;case"front":f=5;break;case"back":f=6;break;case"right":default:f=1}if(0===f%2&&(H=1-H),t instanceof v.Shape){var J=t.s3(),R=t.p3(),I=t.getAnchor3d();H=3>f?(H-I.x)*J[0]+R[0]:5>f?(H-I.y)*J[1]+R[1]:(H-I.z)*J[2]+R[2]}else H-=.5;Vi(O,g.uClipPercent,H)}O.uniform1i(g.uClipDirection,f||0),u=pq(O,g,n,k,t,Bi),u&&(rd(u,P[M],r),rd(u,Y._polylineIndexMap[M],Y._polylineModelMap),rd(u,Y._wireframeIndexMap[M],Y._wireframeModelMap)),P[M]||G._80o(O,g,L),Y.isLabelVisible(t)&&((N=G.labelInfo)&&(pq(O,g,n,k,t,Xf),G._28O(N,Xf,L)),(N=G.label2Info)&&(pq(O,g,n,k,t,Xp),G._28O(N,Xp,L))),Y.isNoteVisible(t)&&((N=G.noteInfo)&&(pq(O,g,n,k,t,Mm),G._29O(N,Mm,L)),(N=G.note2Info)&&(pq(O,g,n,k,t,Ie),G._29O(N,Ie,L))),(N=G._38o)&&G._99O(O,g,N,n,k,L),F&&Vi(O,g.uBrightness,1),f&&O.uniform1i(g.uClipDirection,0)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return fc},_80o:function(){},dispose:function(){},_calcAnchorMat:function(D){if(D.hasOwnProperty("_anchor")||D.hasOwnProperty("_anchorElevation")){var z=D.getAnchor3d(),e={x:z.x-.5,y:z.y-.5,z:z.z-.5},p=Kr();return Hd(p,[-e.x,-e.y,-e.z]),p}},getBodyColor:function(d){var B=this.data,Y=this.gv.getBodyColor(B);return Y?Y:d?B.getStyle(d):w},getCachedTexture:function(j){var O=this._cachedTextures;return O?O[j||"main"]:null},setCachedTexture:function(s,o){var J=this._cachedTextures;return J||(J=this._cachedTextures={}),J[o||"main"]=s,s},invalidateCachedTexture:function(u){var $=this._cachedTextures;for(var F in $)u.deleteTexture($[F]);this._cachedTextures={}},_24O:function(D,X){var W=this,J=W.data,q=W.gv,M=W.s,p=q[X](J);if(p!=w){var R=M(D+".scale"),i=M(D+".max"),n=W[D+"Info"]={label:p,textureScale:M(D+".texture.scale"),color:q[X+"Color"](J),font:M(D+".font"),align:M(D+".align"),background:q[X+"Background"](J)},N=n.rect=Ng(n,p);i>0&&i<N.width&&(n.labelWidth=N.width,N.width=i),N.x=N.y=0,N.width*=R,N.height*=R,n.mat=W._16O(M(D+".autorotate"),M(D+".position"),N,M(D+".face"),M(D+".t3"),M(D+".r3"),M(D+".rotationMode"));var t=N.width/2,S=N.height/2;n.vs=new Ud([-t,S,0,-t,-S,0,t,-S,0,t,S,0]),N.width/=R,N.height/=R}},_26O:function(a,D){var W=this,t=W.data,_=W.gv,A=W.s,L=_[D](t);if(L!=w){var k=A(a+".scale"),i=this[a+"Info"]={note:L,textureScale:A(a+".texture.scale"),expanded:A(a+".expanded"),font:A(a+".font"),color:A(a+".color"),align:A(a+".align"),borderWidth:A(a+".border.width"),borderColor:A(a+".border.color"),background:_[D+"Background"](t)};if(i.expanded){var c=A(a+".max"),o=Ng(i,L);o.width+=6,o.height+=2,c>0&&c<o.width&&(i.labelWidth=o.width,o.width=c);var n={x:-o.width/2,y:-8-o.height,width:o.width,height:o.height+8}}else n={x:-6,y:-18,width:12,height:18};i.mat=W._16O(A(a+".autorotate"),A(a+".position"),w,A(a+".face"),A(a+".t3"),A(a+".r3"),A(a+".rotationMode")),i.rect=n,1!==k&&(n=Tk(n),n.x*=k,n.height*=k,n.y=-n.height,n.width*=k);var V=n.x,l=n.y,s=n.width,O=n.height;i.vs=new Ud([V,-l,0,V,-l-O,0,V+s,-l-O,0,V+s,-l,0])}},_28O:function(f,n,c){if(c(this.s(n+".transparent"))){var u=f.rect,D=f.textureScale,k=u.width*D,v=u.height*D;if(k>=1&&v>=1){var M=Qf(k,v);1!==D&&(M.translate(M,u.x,u.y),M.scale(D,D),M.translate(M,-u.x,-u.y)),Wo(M,f),M.restore(),Cb(this,n,f.mat,f.vs,!0)}}},_29O:function(y,J,B){if(B(this.s(J+".transparent"))){var D=y.rect,E=y.textureScale,q=D.x,F=D.y,Y=D.width*E,U=D.height*E;if(Y>=1&&U>=1){D.x=D.y=0;var S=Qf(Y,U);1!==E&&S.scale(E,E),Xe(S,y),S.restore(),D.x=q,D.y=F,Cb(this,J,y.mat,y.vs,!1)}}},_99O:function(P,C,h,_,L,B){if(h){var x=this,W=x.gv,d=x.data,c=W._buffer,J=W._1O,q=h.icons;for(var D in q){var F=q[D],m=h.rects[D];if(m&&B(mo(F.transparent,d,W))){pq(P,C,_,L,d,D);var Y=mo(F.shape3d,d,W),o=Y?[Y]:mo(F.names,d,W),E=o?o.length:0,k=mo(F.textureScale,d,W)||1,Q=mo(F.light,d,W);Q==w&&(Q=Y?!0:!1),gm(P,C,mo(F.blend,d,W),Q,mo(F.opacity,d,W),mo(F.reverseFlip,d,W),mo(F.reverseColor,d,W),mo(F.reverseCull,d,W));
for(var X=0;E>X;X++){var O=o[X],K=m[X];if(dn(x,K.mat),Y)wh(W,d,Hf(x,Y),x);else{var a=Mf(O);if(a){var e=K.width*k,t=K.height*k;if(e>=1&&t>=1){var M=Qf(e,t);nd(M,a,mo(F.stretch,d,W),0,0,e,t,d,W),M.restore(),mq(P,ul,J),Nq(P,C,J,mo(F.discardSelectable,d,W),c.uv,th),jg(P,c.vs,K.vs,C.aPosition),xg(P,c.ns,ro,C.aNormal),gn(P,c.is,qd),Sl(P,0,qd.length),xp(P,C,J)}}}$i(W)}pr(P,C)}}}}});var ve=function(i,e){qj(ve,this,[i,e])};vo(ve,kp,{_16O:function(I,z,t,p,b,c,S,R,Z){var n=this.data,T=n.getFinalScale3d(),H=zi(z,T,t,p,R,Z);if(n.hasOwnProperty("_anchor")||n.hasOwnProperty("_anchorElevation")){var G=n.getAnchor3d();H[0]-=(G.x-.5)*T[0],H[1]-=(G.y-.5)*T[1],H[2]-=(G.z-.5)*T[2]}return Hc(Kr(),H,n.p3(),p,b,c,S,I,n.getFinalRotation3d(),n.getRotationMode())},clear:function(){var A=this;A.faceMat=A.mat=A.shapeModel=A.left=A.right=A.front=A.back=A.top=A.bottom=A.csg=w},needValidate:function(W){if(this._iv)return this._validateFrameId=W._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var x=W._renderInfo.frame;if(this._validateFrameId!==x)return this._validateFrameId=x,!0}return!1},validate:function(h,e){var w=this,d=w.gv,S=w.data,K=w.shapeName=w.s(xh),J=Hf(w,K);w._updateAutoRotation(),w._updateFixSize2d(),w._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(zn(d,S,"_wireframeModelMap","_wireframeIndexMap"),zn(d,S,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var N=sf(S,d.getMat(S),J?w.s("shape3d.scaleable"):!0),A=w._calcAnchorMat(S);if(A&&qo(N,N,A),S.mat=N,w.clear(),J||!K)if(h){var n=[];J?Fj(d,S,J,w,w.getBodyColor(),[N],h,n):(Ge(d,S,h,e,N,Nh,n,Ig),Ge(d,S,h,e,N,He,n,dd),Ge(d,S,h,e,N,Gh,n,cg),Ge(d,S,h,e,N,Qc,n,El),Ge(d,S,h,e,N,or,n,En),Ge(d,S,h,e,N,Dd,n,An)),n.length&&(ho(h.vs,n),ho(h.ns,Dh(n)))}else w.mat=N,(w.shapeModel=J)||(w._cubeUvs=null,w.vf(Nh,0),w.vf(He,16),w.vf(or,8),w.vf(Dd,24),w.vf(Gh,32),w.vf(Qc,40))},_updateAutoRotation:function(){var c=new Re,z=new _e,X=new Jb,s=new Jb,O=new Jb;return function(){var w=this,g=w.data,y=w.s("autorotate")||w.s("shape3d.autorotate");if(!y)return g._dynamicRotation&&delete g._dynamicRotation,void 0;var t=w.gv;O.copy(w.s("shape3d.autorotate.up")||t._up);var R;R="string"==typeof y?[y.indexOf("x")<0?t._eye[0]:t._center[0],y.indexOf("y")<0?t._eye[1]:t._center[1],y.indexOf("z")<0?t._eye[2]:t._center[2]]:t._eye;var I=t._center,r=g.p3();X.copy(r),s.set(R[0]-I[0],R[1]-I[1],R[2]-I[2]).add(X),z.lookAt(s,X,O),c.set(0,0,0,g.getRotationMode(),!0).setFromRotationMatrix(z);var d=g._dynamicRotation;d&&Math.abs(d[0]-c.x)<1e-5&&Math.abs(d[1]-c.y)<1e-5&&Math.abs(d[2]-c.z)<1e-5||(g._dynamicRotation=[c.x,c.y,c.z])}}(),_updateFixSize2d:function(){var s=this,P=s.data,G=s.s("fixSizeOnScreen")||s.s("shape3d.fixSizeOnScreen");if(!G)return P._dynamicScale3d&&delete P._dynamicScale3d,void 0;var K=s.gv,N=sf(P,K.getMat(P)),Y=Vl([0,0,0],N),T=K.toViewPosition(Y);if(!isNaN(T.x)&&!isNaN(T.y)){var p=Vl([1,0,0],N),n=K.toViewPosition(p),o=Vl([0,1,0],N),J=K.toViewPosition(o),E=n.x-T.x,x=J.y-T.y;if(E&&x){var a,i,q=P._dynamicScale3d||[1,1,1],v=Mf(P.s("shape3d.image"));if(G[0]>0&&(a=G[0]),G[1]>0&&(i=G[1]),!a||!i){var d=G>0?G:1;a||(a=(Xk(v,P)||P.getWidth())*d),i||(i=(Dg(v,P)||P.getTall())*d)}var U=Math.abs(E/a),_=Math.abs(x/i);Math.abs(U-1)<.001&&Math.abs(_-1)<.001||(P._dynamicScale3d=[q[0]/U,q[1]/_,q[2]])}}},_updateOverlapping:function(){var C=this,w=C.s("hide.overlapping.group");if(!w)return C._rectOverlapping&&(C._rectOverlapping=i),void 0;var K,q,I,R=C.gv,T=C.data,f=sf(T,R.getMat(T)),L=1/0,W=1/0,M=-1/0,N=-1/0,t=T.getAnchor3d(),y=t.x,Z=t.y,j=t.z;for(K=0;8>K;K++){if(q=Vl([(K>>2)-y,(1&K>>1)-Z,(1&K)-j],f),I=R.toViewPosition(q),isNaN(I.x)||isNaN(I.y))return;L=Math.min(L,I.x),M=Math.max(M,I.x),W=Math.min(W,I.y),N=Math.max(N,I.y)}var h={x:L,y:W,w:M-L,h:N-W};C._rectOverlapping=R.overlappingBox.isOverlapping(w,h)},getVectorDynamicSize:function(){var t,e=this,F=e.s("shape3d"),b=e.data;if("billboard"===F||"plane"===F||(t=b._currentCubeElementId)!=w){var Y,j,n=e.gv,T=sf(b,n.getMat(b)),K=b.getAnchor3d(),o=.5-K.x,m=.5-K.y,f=.5-K.z,y=e.s("vector.dynamic.maxsize"),B=function(q,S){q[0]+=o,q[1]+=m,q[2]+=f,S[0]+=o,S[1]+=m,S[2]+=f;var X=n.toViewPosition(Vl(q,T)),b=n.toViewPosition(Vl(S,T)),s=X.x-b.x,c=X.y-b.y;return Math.min(y,Math.sqrt(s*s+c*c))};if("billboard"===F)Y=B([-.5,0,0],[.5,0,0]),j=B([0,-.5,0],[0,.5,0]);else if("plane"===F)Y=B([-.5,0,0],[.5,0,0]),j=B([0,0,-.5],[0,0,.5]);else if(b._currentCubeElementId!=w){var c=3*cj[t+1],s=3*cj[t],Q=3*cj[t+2];Y=B([rg[c],rg[c+1],rg[c+2]],[rg[Q],rg[Q+1],rg[Q+2]]),j=B([rg[c],rg[c+1],rg[c+2]],[rg[s],rg[s+1],rg[s+2]])}return[Y,j]}},vf:function(Y,d){var f=this;if(f.gv.getFaceVisible(f.data,Y)){var p=Ee(f,Y);p.mat&&(f.faceMat=!0);var z=p.uv;if(z){var g=f._cubeUvs;g||(g=f._cubeUvs=new Ud([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var I=0;8>I;I++)g[d+I]=z[I]}return p}},_billboardInView:function(){var m=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],r=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],H=new hs,A=new Jb,_=new _e;return function(F){var c=this;if(!c.mat)return!0;var z=c.gv.getFrustum(),y="billboard"===F?m:r;H.makeEmpty(),_.fromArray(c.mat);for(var t=0,G=y.length;G>t;t+=3)H.expandByPoint(A.fromArray(y,t).applyMatrix4(_));return z.intersectsBox(H)}}(),_80o:function(s,f,F){var v=this;if(v._rectOverlapping)return!0;var K=v.shapeModel;if(K||!v.shapeName){var E=v.s("shape3d");if(("billboard"===E||"plane"===E)&&!v._billboardInView(E))return!0;var J=v.gv,Y=v.data,Q=J._cube;Bf(J,v.mat),v.s("shape3d.reflector")&&!s._picking||(K?wh(J,Y,K,v,v.getBodyColor(),F):(jg(s,Q.vs,w,f.aPosition),jg(s,Q.ns,w,f.aNormal),bg(s,Q.is),v._18O(s,f,"left",0,F),v._18O(s,f,"front",6,F),v._18O(s,f,"right",12,F),v._18O(s,f,"back",18,F),v._18O(s,f,"top",24,F),v._18O(s,f,"bottom",30,F))),$i(J),v.faceMat&&(v._18O(s,f,"left",0,F,!0),v._18O(s,f,"front",6,F,!0),v._18O(s,f,"right",12,F,!0),v._18O(s,f,"back",18,F,!0),v._18O(s,f,"top",24,F,!0),v._18O(s,f,"bottom",30,F,!0))}},_18O:function(K,W,j,d,m,Q){var U=this[j];if(U){if(!m(U.transparent))return;if(Q&&!U.mat||!Q&&U.mat)return;var J=this.data.s("polygonOffset");J&&es(K,J),Q&&Bf(this.gv,U.mat);var z=this,h=z.data;h._currentCubeElementId=d;var g=z.gv,c=g.getTexture(U.texture,h,j),e=U.uv,F=U.uvScale,b=U.uvOffset,A=U.discardSelectable;c?e?Nq(K,W,c,A,g._buffer.uv,z._cubeUvs,b,F):Nq(K,W,c,A,g._cube.uv,w,b,F):Nq(K),gm(K,W,U.blend,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),Vi(K,W.uDiffuse,U.color||Y["color.empty"]),Sl(K,d,6),pr(K,W),xp(K,W,c),Q&&$i(g),J&&qh(K),h._currentCubeElementId=null}},drawReflector:function(){var e=new Jb,s=new Jb,t=new Re,C=new _e,m=new Jb,Q=new Jb,q=new Jb,L=new Jb,z=new _e,j=new _e,h=new Cp,M=new ce,X=new ce,D=function(v,m,J){v[J]=m[0],v[J+1]=m[1],v[J+2]=m[2]},E=function(V,N){D(V,N.getEye(),0),D(V,N.getCenter(),3),D(V,N.getUp(),6)},a=function(N,X){X._eye=[N[0],N[1],N[2]],X._center=[N[3],N[4],N[5]],X._up=[N[6],N[7],N[8]],X._18Q=w;var g=X._skyBox;g&&(g.p3([N[0],N[1],N[2]]),X.getData3dUI(g).iv())};return function(Y,D,r,T,P){var H=this;H._reflectorInfo=null;var y=H.data;if(y._reflecting)return!1;var V=H.gv;if(P)return!1;var c=H._reflectorRenderTarget;c?c.setSize(Y,D,r):c=H._reflectorRenderTarget=new rj.RenderTarget(V,Y,D,r),e.copy(y.p3()),s.copy(V.getEye()),C.makeRotationFromEuler(t.set(y.r3(),y.getRotationMode(),!0));var x;if(!H._reflectNormal){var x=Hf(H,H.s("shape3d"));if(!x)return!1;if(!x.ns&&x.length&&(x=x[0]),!x.ns||!x.vs)return!1;H._reflectNormal=[x.ns[0],x.ns[1],x.ns[2]],H._reflectorVbuffer=Rd.Buffer.createVertexBuffer(Y,new Float32Array(x.vs))}if(m.copy(H._reflectNormal),m.applyMatrix4(C),Q.subVectors(e,s),Q.dot(m)>0)return!1;Q.reflect(m).negate(),Q.add(e),q.copy(V.getCenter()).negate().add(e),q.reflect(m).negate(),q.add(e),L.copy(V.getUp()),L.reflect(m);var S=[0,0,0,0,0,0,0,0,0];E(S,V),V._eye=Q.toArray(),V._center=q.toArray(),V._up=L.toArray(),V._18Q=w;var d=V._skyBox;d&&(d.p3(V._eye),V.getData3dUI(d).iv()),Er(Y,c.frame),Y.viewport(0,0,c.width,c.height),Y.clearColor(0,0,0,1),Y.clear(Y.COLOR_BUFFER_BIT);var N=br(V),g=Zk(V);h.setFromNormalAndCoplanarPoint(m,e),h.applyMatrix4(j.fromArray(g)),M.set(h.normal.x,h.normal.y,h.normal.z,h.constant),X.x=(Math.sign(M.x)+N[8])/N[0],X.y=(Math.sign(M.y)+N[9])/N[5],X.z=-1,X.w=(1+N[10])/N[14],M.multiplyScalar(2/M.dot(X));var _=y.s("shape3d.reflector.clip"),K=_===i?.003:_;N[2]=M.x,N[6]=M.y,N[10]=M.z+1-K,N[14]=M.w;var Z=V._computedProjectMatrix;V._computedProjectMatrix=N,y._reflecting=!0,T(),V._computedProjectMatrix=Z,z.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),z.multiply(j.fromArray(V._projectMatrix)),z.multiply(j.fromArray(V._viewMatrix)),Sh(Y),a(S,V);var v=Y._compiledShader.reflector;return v||(v=Y._compiledShader.reflector=new Rd.Shader(Y,hc.Reflector.vs,hc.Reflector.fs)),v.bind(),Y.activeTexture(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,c.texture),v.uniforms.tDiffuse=0,v.uniforms.color=_g(y.s("shape3d.reflector.color")||"rgb(128,128,128)"),v.uniforms.textureMatrix=z.toArray(),v.uniforms.modelMatrix=sf(y),v.uniforms.viewMatrix=Zk(V),v.uniforms.projectionMatrix=br(V),H._reflectorVbuffer.upload(),v.attributes.pos.pointer(H._reflectorVbuffer),Y.drawArrays(Y.TRIANGLES,0,6),y._reflecting=!1,Y.useProgram(V._prg),!0}}()}),hc.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Xn=function(h,K){qj(Xn,this,[h,K])};vo(Xn,kp,{_25Q:1,validate:function(u){var m=this,N=m.gv,J=m.data,c=m.s,T=c("edge.width"),a=J._40I,Z=J._41I;if(m.shapeModel=m.info=w,a&&Z){var A,n,O,j,D,q,o,l,k,h,P=J.isLooped(),s=c(tp),R=C.getEdgeType(s);if(R){var p=R(J,Fh(m,N,J,P,s),N,m._19Q);if(!p.points||p.points.isEmpty())return;q=m.info={},o=p.segments,D=p.points,l=D.size();for(var S=a.getElevation(),I=Z.getElevation(),z=0;l>z;z++){var K=D.get(z);K.e==w&&(K.e=S+(I-S)*z/(l-1))}k=lc(D.get(0)),h=lc(D.get(l-1));var U=l%2;0===U?(q.c1=lc(D.get(l/2-1)),q.c2=lc(D.get(l/2))):q.p3=lc(D.get((l-U)/2)),q.s1=k,q.s2=lc(D.get(1)),q.t1=lc(D.get(l-2)),q.t2=h}else{D=new Pb,q=m.info={};var i=c("edge.offset"),_=c("edge.center"),L=c("edge.source.t3"),r=c("edge.target.t3"),M=m._getEdge3dHostPoint(a,"source"),f=m._getEdge3dHostPoint(Z,"target");if(L&&(M[0]+=L[0],M[1]+=L[1],M[2]+=L[2]),r&&(f[0]+=r[0],f[1]+=r[1],f[2]+=r[2]),s===qc){o=c("edge.segments");var H=q.points=c(Gg)||Hk;if(l=H.size()){k=lc(H.get(0)),h=lc(H.get(l-1)),!_&&i&&(O=jp(k,M,!0),i=V(i,Sp(M,k)),M=[M[0]+O[0]*i,M[1]+O[1]*i,M[2]+O[2]*i],O=jp(f,h,!0),i=V(i,Sp(h,f)),f=[f[0]-O[0]*i,f[1]-O[1]*i,f[2]-O[2]*i]);var U=l%2;0===U?(A=lc(H.get(l/2-1)),n=lc(H.get(l/2))):q.p3=lc(H.get((l-U)/2)),q.s1=M,q.s2=k,q.t1=h,q.t2=f}else!_&&i&&(O=jp(f,M,!0),j=Sp(M,f),i=wd(i,j),M=[M[0]+O[0]*i,M[1]+O[1]*i,M[2]+O[2]*i],f=[f[0]-O[0]*i,f[1]-O[1]*i,f[2]-O[2]*i]),A=M,n=f;D.add({x:M[0],y:M[2],e:M[1]}),D.addAll(H),D.add({x:f[0],y:f[2],e:f[1]})}else{var X=Fh(m,N,J,P,s);if(m._19Q||(X=-X),P){var Y=M[0],B=M[1],y=M[2],v=a.getTall()/2+X;A=[Y-X,B+v,y],n=[Y+X,B+v,y],D.add({x:Y-X,y:y,e:B}),D.add({x:Y-X,y:y,e:B+v}),D.add({x:Y+X,y:y,e:B+v}),D.add({x:Y+X,y:y,e:B})}else{O=jp(f,M,!0),j=Sp(M,f);var G={x:M[0],y:M[2]},e={x:f[0],y:f[2]},W=kk(w,G,e,X),E=W.x-G.x,g=W.y-G.y;i=wd(i,j),O[0]*=i,O[1]*=i,O[2]*=i,A=[M[0]+O[0]+E,M[1]+O[1],M[2]+O[2]+g],n=[f[0]-O[0]+E,f[1]-O[1],f[2]-O[2]+g],_?(D.add({x:M[0],y:M[2],e:M[1]}),D.add({x:A[0],y:A[2],e:A[1]}),D.add({x:n[0],y:n[2],e:n[1]}),D.add({x:f[0],y:f[2],e:f[1]})):(D.add({x:A[0],y:A[2],e:A[1]}),D.add({x:n[0],y:n[2],e:n[1]}))}}q.c1=A,q.c2=n}q.list=c(xh)===Fo?m.createTubeModel(D,o,T/2,u):m.createLineModel(D,o,T,"edge","edge.dash")}},_getEdge3dHostPoint:function(F,v){if(!gr(F))return F.p3();var p=this;v="edge."+v+".anchor.";var h=p.s(v+"x"),g=p.s(v+"elevation"),I=p.s(v+"y"),o=sf(F,p.gv.getMat(F)),u=F.getAnchor3d();return Vl([(h===i?.5:h)-u.x,(g===i?.5:g)-u.y,(I===i?.5:I)-u.z],o)}});var Yh=function(H,r){qj(Yh,this,[H,r])};vo(Yh,ve,{_80o:function(T,M,p){var C=this,A=C.gv,Y=C.shapeModel;Bf(A,C.mat),Y?wh(A,C.data,Y,C,C.getBodyColor(),p):(Ck(C,T,M,"left",p),Ck(C,T,M,"front",p),Ck(C,T,M,"right",p),Ck(C,T,M,"back",p),Ck(C,T,M,"top",p),Ck(C,T,M,"bottom",p)),$i(A)},validate:function(r,D){var c,X,e=this,h=e.s,P=e.data,O=P.p3(),j=P._thickness/2,p=P.isClosePath(),u=P.getPoints(),y=P.getSegments(),J=h(Yq),M=r&&r.uv;if(e.clear(),0>j){try{X=e.shapeModel=Ke(u,y,h(Bh),h(Um),J,h(Df),P.getTall(),P.getShapeElevation(),p)}catch(Y){X=e.shapeModel={}}h(qk)?h("shape3d.image")||delete X.uv:(delete X.vs,delete X.ns,delete X.uv),h("shape3d.top.image")||delete X.top_uv,h("shape3d.bottom.image")||delete X.bottom_uv}else if(h(xh)===Fo)c=mm(u,y,J,p),X=e.shapeModel={vs:[]},h("shape3d.image")&&(X.uv=[],X.sum=h(Df)||Xq(c)||1,X.len=0),h(Bh)&&!p&&(X.top_vs=[],h("shape3d.top.image")&&(X.top_uv=[])),h(Um)&&!p&&(X.bottom_vs=[],h("shape3d.bottom.image")&&(X.bottom_uv=[])),e._12O(c,j);else{var $,a,K,C,Q,s,q,k,v,t;if(c=mm(u,y,J,p),Q=e.vf(or,M,!1,D),j&&(s=e.vf(Dd,M,!1,D),q=p?w:e.vf(Nh,M,!1,D),k=p?w:e.vf(He,M,!1,D),v=e.vf(Gh,M,!1,D),t=e.vf(Qc,M,!1,D)),j){for(var V=0,U=c.length;U>V;V++)c[V]=e._tryRemoveBezierPoints(c[V],j);e._12O(c,j)}else Q&&c.forEach(function(z){if(C=z.length,C>0)for($=z[0],K=1;C>K;K++)a=z[K],e.addV(Q.vs,$,a),$=a});e._20Q(c),r||(Q&&(Q.ns=Dh(Q.vs),wn(Q,"vs"),wn(Q,Rh)),j&&(s&&(s.ns=Dh(s.vs),wn(s,"vs"),wn(s,Rh)),q&&(q.ns=Dh(q.vs),wn(q,"vs"),wn(q,Rh)),k&&(k.ns=Dh(k.vs),wn(k,"vs"),wn(k,Rh)),v&&(v.ns=Dh(v.vs),wn(v,"vs"),wn(v,Rh)),t&&(t.ns=Dh(t.vs),wn(t,"vs"),wn(t,Rh))))}var o=e.mat=Kr();Hd(o,O),Oh(o,P.getFinalRotation3d(),P.getRotationMode());var n=P.getScale3d(),G=P._dynamicScale3d;G&&(n[0]*=G[0],n[1]*=G[1],n[2]*=G[2]),Ko(o,n),Hd(o,cm(O)),r&&(wf(e,o,r,X),e.clear())},_20Q:function(W){var p,l,X,i,E,V,c,d=this,n=d.front,Q=d.back,s=d.top,b=d.bottom,g=n?n.tuv:w,t=Q?Q.tuv:w,F=s?s.tuv:w,f=b?b.tuv:w,Y=0;(g||t||F||f)&&(p=d.s(Df)||Xq(W)||1,W.forEach(function(F){if(l=F.length,l>0)for(V=F[0],X=1;l>X;X++)c=F[X],i=Y/p,Y+=Sp(V,c),E=Y/p,d._14O(n,i,E),d._14O(Q,1-E,1-i),d._14O(s,i,E),d._14O(b,i,E),V=c}))},_14O:function(E,l,y){if(E){var r=E.uv,k=E.tuv;if(k){if(r)var D=r[0]+(r[6]-r[0])*l,X=r[1]+(r[7]-r[1])*l,V=r[2]+(r[4]-r[2])*l,p=r[3]+(r[5]-r[3])*l,G=r[2]+(r[4]-r[2])*y,w=r[3]+(r[5]-r[3])*y,z=r[0]+(r[6]-r[0])*y,n=r[1]+(r[7]-r[1])*y;else D=l,X=0,V=l,p=1,G=y,w=1,z=y,n=0;k.push(V,p,G,w,z,n,z,n,D,X,V,p)}}},_13O:function(J){var I=J.uv,N=J.tuv;N&&(I?N.push(I[2],I[3],I[4],I[5],I[6],I[7],I[6],I[7],I[0],I[1],I[2],I[3]):N.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(e,Y){var i=e.length;if(4>i)return e;var r,h,U,x,R,t,F=!1,_=function(U){return e[U]},Z=function(K){return e[i-1-K]};for(R=0;1>=R;R++)for(t=R?Z:_,h=t(0),U=t(1),r=2;i-1>r;r++)if(x=t(r),!x.remove)if(x.b){var l=kk(h,U,x,Y);l.adjust?(x.remove=!0,F=!0):(h=U,U=x)}else h=U,U=x;if(!F)return e;var T=[];for(r=0;i>r;r++)e[r].remove||T.push(e[r]);return T},_12O:function(b,T){var c,f,n,A,I,m=this.s("shape3d.point.epsilon"),o=this;b.forEach(function(d){if(I=d.length,I>0)for(c={p:d[0],n:!0},A=1;I>A;A++)f=d[A],n=I-1>A?d[A+1]:w,n&&Math.abs(f.x-n.x)<m&&Math.abs(f.y-n.y)<m||o.addPoint(c,f,n,T,d)})},addPoint:function(W,_,z,x,Z){var H,j,f,P,g,T,S,I,M,p=this,G=W.p,B=W.f,y=W.b,V=p.s("shape3d.side")||Zn,N=p.s("shape3d.start.angle"),e=p.s("shape3d.sweep.angle"),b=p.shapeModel,k=p.data.isClosePath();if(W.n&&(W.n=!1,B=k&&Z.length>2?kk(Z[Z.length-2],G,_,x):kk(w,G,_,x),y=Jk(G,B),b?b.top_vs&&p._10O(y,B,V,N,e,b.top_vs,b.top_uv):(H=p.left)&&(p.addV(H.vs,y,B),p._13O(H))),j=z?kk(G,_,z,x):k&&Z.length>2?kk(G,_,Z[1],x):kk(G,_,w,x),f=Jk(_,j),b){var U,K,$=b.vs,c=b.uv,q=b.sum;for(c&&(U=b.len/q,b.len+=Sp(G,_),K=b.len/q),T=p._9O(y,B,V,N,e),S=p._9O(f,j,V,N,e),I=0;V>I;I++)M=I+1,ho($,T[M]),ho($,S[I]),ho($,T[I]),ho($,S[I]),ho($,T[M]),ho($,S[M]),c&&(P=I/V,g=M/V,c.push(U,g,K,P,U,P,K,P,U,g,K,g));!z&&b.bottom_vs&&p._10O(f,j,V,N,e,b.bottom_vs,b.bottom_uv,!0)}else!z&&(H=p.right)&&(p.addV(H.vs,j,f),p._13O(H)),(H=p.front)&&p.addV(H.vs,B,j),(H=p.back)&&p.addV(H.vs,f,y),(H=p.top)&&p.addH(H.vs,B,j,f,y,!0),(H=p.bottom)&&p.addH(H.vs,y,f,j,B);W.p=_,W.f=j,W.b=f},_10O:function(i,N,o,u,A,X,f,z){var m,q,O=this,S=O.data,H=O._9O(i,N,o,u,A),g=(i.x+N.x)/2,v=(i.y+N.y)/2,n=S.getShapeElevation(),P=0;for(P=0;o>P;P++)z?(ho(X,H[P]),ho(X,H[P+1])):(ho(X,H[P+1]),ho(X,H[P])),ho(X,[g,n,v]),f&&(z?(m=e*(P+1)/o+u,q=e*P/o+u):(m=e*P/o+u,q=e*(P+1)/o+u),f.push(.5-.5*b(q),.5-.5*y(q),.5-.5*b(m),.5-.5*y(m),.5,.5))},_9O:function(M,W,V,K,s){var z,A,o=this,J=o.data,R=[],d=(M.x+W.x)/2,Y=(M.y+W.y)/2,h=J.getTall()/2,x=J.getShapeElevation(),w=0;for(s=s||e;V>=w;w++)z=s*w/V+K,A=b(z),R.push([d+(M.x-d)*A,x+h*y(z),Y+(M.y-Y)*A]);return R},addV:function(o,t,G){var n=t.x,h=t.y,X=G.x,v=G.y,T=this.data,H=T.getShapeElevation(),s=T.getTall()/2;o.push(n,H-s,h,X,H-s,v,X,H+s,v,X,H+s,v,n,H+s,h,n,H-s,h)},addH:function(G,s,F,m,x,J){var p=this.data,f=p.getTall()/2,w=p.getShapeElevation()+(J?f:-f);G.push(s.x,w,s.y,F.x,w,F.y,m.x,w,m.y,m.x,w,m.y,x.x,w,x.y,s.x,w,s.y)},vf:function(r,h,o,k){var e,_=this,l=_.gv.getFaceVisible(_.data,r);return(o||l)&&(e=Ee(_,r,k),e.vs=[],e.tuv=l&&(e.texture||h)?[]:w,e.visible=l),e}});var Mp=function(_,n){qj(Mp,this,[_,n])};vo(Mp,kp,{_25Q:1,validate:function(N){var R=this,s=R.data,m=R.s,S=s.getPoints(),H=S.size();if((!R.s("shape3d.geometry.cache")||!R.shapeModel)&&(R.shapeModel=R.info=w,H>1)){var t=R.info={},u=s.getSegments(),j=s.getThickness(),v=lc(S.get(0)),M=lc(S.get(H-1)),c=H%2;0===c?(t.c1=lc(S.get(H/2-1)),t.c2=lc(S.get(H/2))):t.p3=lc(S.get((H-c)/2)),t.s1=v,t.s2=lc(S.get(1)),t.t1=lc(S.get(H-2)),t.t2=M,t.list=m(xh)===Fo?R.createTubeModel(S,u,j/2,N):R.createLineModel(S,u,j,"shape.border","shape.dash")}var L=s.p3(),q=R.mat=Kr();Hd(q,L),Oh(q,s.getFinalRotation3d(),s.getRotationMode());var $=s.getScale3d(),_=s._dynamicScale3d;_&&($[0]*=_[0],$[1]*=_[1],$[2]*=_[2]),Ko(q,$),Hd(q,cm(L))},_80o:function(u,B,D){var F=this,G=F.shapeModel;if(G){var $=F.gv;Bf($,F.mat),wh($,F.data,G,F,F.getBodyColor(),D),$i($)}}});var wj=v.graph3d.VR=function(s){var T=this;T.gv=s,T._controllers=[],T.switch=new Oe(T),T._enable=!1,T._defaultCallLater=v.Default.callLater,T._defaultCancelLater=ei,"undefined"!=typeof u&&"VRFrameData"in u&&(T._frameData=new u.VRFrameData),T.measureOflength=1,T.eyesOffset=[0,0,0],T._orientation=new v.Math.Quaternion,T._lastHeadPose=[0,0,0],T._offsetToBeAdd=[0,0,0],T._fpsInfo={time:0,fps:0,frames:0}};vo(wj,I,{ms_fire:!0,_42:function(A,h,m,b){var n=this,B=n.gv;if(!B.drawFilter&&n._deviceInAction){var z=n._device;if(z){var q=n._measureOflength;z.depthNear=B.getNear()*q,z.depthFar=B.getFar()*q;var O=n._offsetToBeAdd;if(n.eyesOffset[0]+=O[0],n.eyesOffset[1]+=O[1],n.eyesOffset[2]+=O[2],O[0]=0,O[1]=0,O[2]=0,z.isPresenting===!1)return n._controllers.forEach(function(S){S&&S.update()}),B.iv(),!1;var t=n._frameData;z.getFrameData(t);var S=t.pose.position;if(S){var Y=n.toViewPosition(S);B.setEye(Y),n._orientation.fromArray(t.pose.orientation);var K=new v.Math.Vector3(0,0,-10*n._scaleFactor);K.applyQuaternion(n._orientation),B.setCenter([Y[0]+K.x,Y[1]+K.y,Y[2]+K.z])}n._controllers.forEach(function(P){P&&P.update()}),B.setViewport(A,0,0,h/2,m),n._viewMatrix=n._copyViewMatrix(t.leftViewMatrix),n._projectMatrix=n._copyProjectMatrix(t.leftProjectionMatrix),b(),B.setViewport(A,h/2,0,h/2,m),n._viewMatrix=n._copyViewMatrix(t.rightViewMatrix),n._projectMatrix=n._copyProjectMatrix(t.rightProjectionMatrix),b(),n._lastViewMatrix=n._viewMatrix,n._lastProjectMatrix=n._projectMatrix,n._viewMatrix=null,n._projectMatrix=null,n.submitFrame();var L=Date.now(),e=n._fpsInfo;return L-e.time>1e3?(e.fps=Math.round(1e3*(e.frames+1)/(L-e.time)),e.time=L,e.frames=0):e.frames++,!0}}},onVRDisplayPresentChange:function(){var C=this.isPresenting();this._injectGraphView(C),this.fp("present",!C,C)},getOrientation:function(){return this._orientation},addController:function(M){M=M||0;var q=this,Y=q.getController(M);return Y?Y:(Y=new hg(q,M),q._controllers.push(Y),Y)},getController:function(m){m=m||0;for(var o=this._controllers,w=0,A=o.length;A>w;w++)if(o[w]&&o[w].id===m)return o[w];return null},removeController:function(u){u=u||0;for(var D=this._controllers,G=0,m=D.length;m>G;G++)if(D[G]&&D[G].id===u)return D.splice(G,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(T,U){var s=this,K=s._scaleFactor,F=s._eyesOffset,c=s._lastHeadPose;return c[0]=T[0]*K,c[1]=T[1]*K,c[2]=T[2]*K,U?(U[0]=c[0]+F[0],U[1]=c[1]+F[1],U[2]=c[2]+F[2],U):[c[0]+F[0],c[1]+F[1],c[2]+F[2]]},addEyesOffset:function(b,U,Z){var r=this._offsetToBeAdd;r[0]+=b,r[1]+=U,r[2]+=Z},_copyViewMatrix:function(I){var j=this.dup(I),r=this._scaleFactor;j[12]*=r,j[13]*=r,j[14]*=r;var i=this._eyesOffset;if(i&&(i[0]||i[1]||i[2])){var X=i[0],O=i[1],S=i[2];j[12]-=j[0]*X+j[4]*O+j[8]*S,j[13]-=j[1]*X+j[5]*O+j[9]*S,j[14]-=j[2]*X+j[6]*O+j[10]*S}return j},shutdown:function(){var k=this._device;k&&k.isPresenting&&k.exitPresent()},isPresenting:function(){var M=this._device;return M&&M.isPresenting},_copyProjectMatrix:function(T){var A=this.dup(T),_=this._scaleFactor;return A[14]*=_,A},dup:function($,V){for(var m=$.length,R=V||new Array(m);m--;)R[m]=$[m];return R},getViewMatrix:function(z){var O=this._viewMatrix;return O?this.dup(O,z):void 0},getProjectMatrix:function(){var n=this._projectMatrix;return n?this.dup(n):void 0},submitFrame:function(){var z=this;if(z._enable&&z._deviceInAction){var $=z._device;$&&$.isPresenting&&($.submitFrame(),z.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(Z){var D=this.gv;return D.intersectObjects(Z,D.dm().getDatas())},setDevice:function(N){var j=this;j._device=N},_injectGraphView:function(){var Z,T,b;return function(u){var D=this.gv;if(!u)return Z&&(D.getWidth=Z,D.getHeight=T,D.getDevicePixelRatio=b),void 0;var n=this._device,M=n.getEyeParameters("left"),f=M.renderWidth,d=M.renderHeight;Z=D.getWidth,T=D.getHeight,b=D.getDevicePixelRatio,D.getWidth=function(){return 2*f},D.getHeight=function(){return d},D.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(M){var Y=this;if(!M)return Ao=v.Default.callLater=Y._defaultCallLater,ei=v.Default.cancelLater=Y._defaultCancelLater,void 0;var Y=this;Ao=v.Default.callLater=function(k,m,v,C){var z=Y._device;return z&&z.isPresenting?C?_(function(){Ao(k,m,v)},C):z.requestAnimationFrame(function(){Y._deviceInAction=!0,k.apply(m,v),Y._deviceInAction=!1}):Y._defaultCallLater(k,m,v,C)},ei=v.Default.cancelLater=function(P,a){var g=Y._device;return g&&g.isPresenting?a?f(P):g.cancelAnimationFrame(P):Y._defaultCancelLater(P,a)}}}),I.defineProperties(wj.prototype,{enable:{get:function(){return this._enable},set:function(C){var P=this;P._enable!==C&&(P._enable=C,C?(P.switch.showButton(),P._injectCallLaterFunc(!0)):(P.shutdown(),P.switch.hideButton(),P._injectCallLaterFunc(!1)),P.fp("enable",!C,C))}},measureOflength:{get:function(){return this._measureOflength},set:function(q){this._measureOflength=q;var i=this._scaleFactor=1/q;this._controllers.forEach(function(f){f&&f._setScaleFactor(i)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(M){this._eyesOffset=M}},controllerModel:{get:function(){return this._controllerModel},set:function(X){var H;"object"==typeof X?(H=X.mtl,X=X.obj):(H=X+".mtl",X+=".obj");var L=this,z=L._controllerModel;z&&z.obj===X&&z.mtl===H||(z=L._controllerModel={obj:X,mtl:H},C.loadObj(X,H,{finishFunc:function(y,w){L._controllerModel===z&&C.setShape3dModel("vrControllerModel",w)}}))}},interactive:{get:function(){return!!this._interactive},set:function(U){!!U!=!!this._interactive&&(this._interactive=U,U&&this.addController(0),this.gv.getCoreInteractor().enableVR(U))}}});var hg=function(G,N){function w(h){var x=navigator.getGamepads&&navigator.getGamepads();if(x)for(var P=0,v=0,w=x.length;w>P;P++){var N=x[P];if(N){var t=N.id;if("OpenVR Gamepad"===t||0===t.indexOf("Oculus Touch")||t.indexOf("Controller")>=0){if(v===h)return N;v++}}}}function Q(o,N,K){return Math.abs(o[0]-N[0])<K&&Math.abs(o[1]-N[1])<K&&Math.abs(o[2]-N[2])<K?!0:!1}var P=this;P.vr=G,P.id=N;var r,s,t=[0,0],f=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],S=new ab;S.s("shape3d","vrControllerModel"),S.isController=!0,S.s("intersect",!1),P.getGamepad=function(){return s},P.isButtonPressed=function(O){for(var q,D=0,F=f.length;F>D;D++)if(q=f[D],q.id===O)return q.pressed;return!1},P.getNode=function(){return S};var H=.003;P.setRotationEpsilon=function(e){H=e};var k=5e-4,m=k;P.setPositionEpsilon=function(S){k=S,m=S*P.vr._scaleFactor},P._setScaleFactor=function(O){S.s3(O,O,O),m=k*O},P._setScaleFactor(P.vr._scaleFactor);var I,R=new il,h=new _e,J=[0,0,0],F=[0,0,0],K=new Re,p=new Jb,l=new dm;P.getRay=function(){return I?(l.origin.fromArray(J),l.direction.copy(p),I=!1,l):l},P.update=function(){if(r=s,s=w(N),r!=s&&console.log("gamepad changed",s),!s||s.pose===i)return s=null,S.s("3d.visible",!1),void 0;if(C.getShape3dModel("vrControllerModel")){S.dm()||G.gv.dm().add(S),S.s("3d.visible",!0);var E=s.pose;if(null!==E){E.position&&(P.vr.toViewPosition(E.position,J),Q(S.p3(),J,m)||(I=!0,S.p3(J))),E.orientation&&(R.fromArray(E.orientation),p.set(0,0,-1).applyQuaternion(R).normalize(),h.makeRotationFromQuaternion(R),K.set(0,0,0,S.getRotationMode(),!0).setFromRotationMatrix(h),F[0]=K.x,F[1]=K.y,F[2]=K.z,Q(S.r3(),F,H)||(I=!0,S.r3(F))),I&&G.fp("gamepad.pose",null,{position:J,rotation:F,id:N});var q=s.axes;(t[0]!==q[0]||t[1]!==q[1])&&(t=[q[0],q[1]],G.fp("gamepad.axes",null,{id:N,axes:t}));var a,z,L,$,u=s.buttons;for(a=0,z=u.length;z>a;a++)if(L=u[a],L&&($=L.pressed,f[a]||(f[a]={id:"button"+a,pressed:!1}),$!==f[a].pressed)){f[a].pressed=$;var e={id:N},B="state";e[B]=e._62O=$?"down":"up",G.fp("gamepad.button."+f[a].id,null,e)}}}}},Oe=function(T){this.vr=T,this._button=null};vo(Oe,I,{showButton:function(){var s=this.assureButton();if(!s.parentNode){var E=this.vr.gv,I=E.getView();E._79O?I.insertBefore(s,E._79O):I.appendChild(s)}},hideButton:function(){var e=this._button;e&&e.parentNode&&e.parentNode.removeChild(e)},assureButton:function(){var h=this._button;return h?h:this._button=this.createButton(this.vr.gv)},createButton:function(C){function T(u,_){u.textContent=_&&_.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function R(H){L.style.display="",L.style.cursor="pointer",L.style.left="calc(50% - 50px)",L.style.width="100px",T(L,H),L.onmouseenter=function(){L.style.opacity="1.0"},L.onmouseleave=function(){L.style.opacity="0.5"},L.onclick=function(){H.isPresenting?H.exitPresent():H.requestPresent([{source:C.getCanvas()}])},C.vr.setDevice(H)}function c(){L.style.display="",L.style.cursor="auto",L.style.left="calc(50% - 75px)",L.style.width="150px",T(L,null),L.onmouseenter=null,L.onmouseleave=null,L.onclick=null,C.vr.setDevice(null)}function d(N){N.style.position="absolute",N.style.bottom="20px",N.style.padding="12px 6px",N.style.border="1px solid #fff",N.style.borderRadius="4px",N.style.color="#000",N.style.font="normal 13px sans-serif",N.style.textAlign="center",N.style.opacity="0.5",N.style.outline="none",N.style.zIndex="999"}if("getVRDisplays"in navigator){var L=this._button=j.createElement("button");return L.style.display="none",d(L),X(u,"vrdisplayconnect",function(r){R(r.display)}),X(u,"vrdisplaydisconnect",function(){c()}),X(u,"vrdisplaypresentchange",function(W){T(L,W.display),C.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(v){v.length>0?R(v[0]):c()}),L}var v=j.createElement("a");return v.href="https://webvr.info",v.innerHTML="当前不支持 webvr",v.style.left="calc(50% - 90px)",v.style.width="180px",v.style.textDecoration="none",d(v),v}}),I.defineProperties(Oe.prototype,{});var Di=v.graph3d.PostProcessing=function(Z){function m(){if(!x){var R=Z.getGL();x=new rj.RenderTarget(Z,R,null,null,{samples:Y.renderTextureSamples||1}),q=new Rd.Shader(R,r.vs,r.fs),K=Rd.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),w=Rd.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1]))}}var x,q,K,w,E=this,a={},B=!1;!function(){I.keys(Di).forEach(function(y){a[y]=new Di[y](Z)})}(),E.getModule=function(k){return k?a[k]:E},E.getModuleList=function(){return I.keys(a)},E.handleDataModleChange=function(v,m){v&&(v.setPostProcessingData(E.serialize()),v.removeSerializeListener(E.onDataModelSerialize,E)),m&&(m.addSerializeListener(E.onDataModelSerialize,E),E.deserialize(m.getPostProcessingData()))},E.onDataModelSerialize=function(M){"serialize"===M.type?Z.dm()._postProcessingData=E.serialize():"deserialize"===M.type&&E.deserialize(Z.dm().getPostProcessingData())},E.serialize=function(){var G,c,i,k,s={};for(c in a)if(i=a[c],k=i.serializeProperties){G={},i.enable&&(G.enable=!0);for(var S in k){var D=i[S];D!=k[S]&&(G[S]=D)}I.keys(G).length&&(s[c.toLowerCase()]=G)}return s},E.deserialize=function(q){var f,H,Y,J,P,F={};if(q)for(H in q)if(H&&(f=H[0].toUpperCase()+H.slice(1),Y=a[f])){F[f]=!0,J=q[H],E.enableModule(f,!!J.enable),Y.resetProperties&&Y.resetProperties();for(P in J)"enable"!==P&&(Y[P]=J[P])}for(f in a)F[f]||(Y=a[f],Y.enable=!1,Y.resetProperties&&Y.resetProperties())},E.decodeShader=function(F){var o,O,b,k="",W="";for(b=0;b<F.length;b++)o=F[b],"%"===o?o="'":"a"===o?o='"':"]"===o&&(o="\\"),O=String.fromCharCode(o.charCodeAt(0)-1),b%2?W+=O:k=O+k;return W+k},E.createShader=function(H,D,N){var M=D.indexOf("^#"),U=E.decodeShader(D.substr(0,M)),J=E.decodeShader(D.substr(M+2));if(N){var s=N(U,J);s&&s.vs&&(U=s.vs),s&&s.fs&&(J=s.fs)}return new Rd.Shader(H,U,J)},E.enableModule=function(W,X){var N,u,T,q=W.split(",");for(N=0,u=q.length;u>N;N++)T=q[N].trim(),a[T]&&(a[T].enable=X);B=!1;for(T in a)if(a[T].enable){B=!0;break}B&&m()};var r={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};E._42=function(E,V,r,F,p){if(B&&!p){x.setSize(E,V,r),x.bind(E),E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),Z.setViewport(E,0,0,V,r),F(),x.unbind(E);for(var I=0,L=Z._glCapabilities.maxAttributes;L>I;I++)E.disableVertexAttribArray(I);var g,N=x;for(g in a)N=a[g]._42(E,N)||N;return Z.setViewport(E,0,0,V,r),E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),q.bind(),E.activeTexture(E.TEXTURE0+0),E.bindTexture(E.TEXTURE_2D,N.texture),q.uniforms.image=0,K.upload(),w.upload(),q.attributes.pos.pointer(w),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0),E.bindTexture(E.TEXTURE_2D,null),E.useProgram(Z._prg),!0}}},sg=v.graph3d.PostProcessing.Bloom=function(u){function p(){var r=u.getGL();if(r)for(var w=u._postProcessing,O=0;k>O;O++)G[O]=w.createShader(r,sg._35Q,function(K,q){return{fs:q.replace(/DEFINE_VALUE/g,m[O]).replace("%OVERRIDE_ALPHA_DEFINE%",j?"#define OVERRIDE_ALPHA":"")}})}function x(){var G=u.getWidth(),D=u.getHeight();if(G&&D){H=[G,D],R=!0;var h,V=u.getGL(),S=Math.round(H[0]/2),C=Math.round(H[1]/2);for(W=new rj.RenderTarget(u,V,S,C),h=0;k>h;h++)P.push(new rj.RenderTarget(u,V,S,C)),J.push(new rj.RenderTarget(u,V,S,C)),S=Math.round(S/2),C=Math.round(C/2);var o=u._postProcessing;Z=o.createShader(V,sg._34Q),p(),b=o.createShader(V,sg._36Q,function(l,E){return{fs:E.replace(/NUM_MIPS/g,k)}
}),F=o.createShader(V,sg.finalShader),M=Rd.Buffer.createIndexBuffer(V,new Uint16Array([0,2,1,1,2,3])),e=Rd.Buffer.createVertexBuffer(V,new Float32Array([0,0,1,0,0,1,1,1]))}}var g,i,E,j,M,e,N=this,S=!1,R=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var R=this.serializeProperties;for(var C in R)this[C]=R[C]},I.defineProperties(N,{enable:{get:function(){return S},set:function(f){!!S!=!!f&&(S=f,f&&!R&&x())}},strength:{get:function(){return g},set:function(H){g=H}},threshold:{get:function(){return i},set:function(O){i=O}},radius:{get:function(){return E},set:function(S){E=S}},overrideAlpha:{get:function(){return j},set:function(X){!!j!=!!X&&(j=X,R&&p())}}}),this.resetProperties();var W,Z,b,F,H=[256,256],P=[],J=[],k=5,m=[3,5,7,9,11],G=[];N._42=function(Y,U){function f(y,b,B,O){Er(Y,b.frame),u.setViewport(Y,0,0,b.width,b.height),O?O(Y):Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),T!==y&&y.bind();var v=0;for(var P in B){var K=B[P];K instanceof WebGLTexture&&(Y.activeTexture(Y.TEXTURE0+v),Y.bindTexture(Y.TEXTURE_2D,K),K=v,v++),y.uniforms[P]=K}for(T!==y&&(M.upload(),e.upload(),y.attributes.pos.pointer(e),T=y),Y.drawElements(Y.TRIANGLES,6,Y.UNSIGNED_SHORT,0);v--;)Y.activeTexture(Y.TEXTURE0+v),Y.bindTexture(Y.TEXTURE_2D,null);Sh(Y)}if(S&&(R||(x(),R))){var T;f(Z,W,{smoothWidth:.01,luminosityThreshold:i,tDiffuse:U.texture});var N,l=W,V=Math.round(H[0]/2),O=Math.round(H[1]/2);for(N=0;k>N;N++)f(G[N],P[N],{colorTexture:l.texture,direction:[1,0],texSize:[V,O]}),f(G[N],J[N],{colorTexture:P[N].texture,direction:[0,1],texSize:[V,O]}),V=Math.round(V/2),O=Math.round(O/2),l=J[N];return f(b,P[0],{blurTexture1:J[0].texture,blurTexture2:J[1].texture,blurTexture3:J[2].texture,blurTexture4:J[3].texture,blurTexture5:J[4].texture,bloomStrength:g,bloomRadius:E,bloomTintColor:[1,1,1]}),f(F,U,{image:P[0].texture},function(u){u.enable(u.BLEND),u.blendEquation(u.FUNC_ADD),u.blendFunc(u.SRC_ALPHA,u.ONE)}),Y.blendEquationSeparate(Y.FUNC_ADD,Y.FUNC_ADD),Y.blendFuncSeparate(Y.SRC_ALPHA,Y.ONE_MINUS_SRC_ALPHA,Y.ONE,Y.ONE_MINUS_SRC_ALPHA),U}}};sg._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",sg._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",sg._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",sg.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Fk=v.graph3d.PostProcessing.Dof=function(b){function K(){g=!0;var y=b.getGL();m=new rj.RenderTarget(b,y),c=b._postProcessing.createShader(y,Fk._38Q),h=Rd.Buffer.createIndexBuffer(y,new Uint16Array([0,2,1,1,2,3])),W=Rd.Buffer.createVertexBuffer(y,new Float32Array([0,0,1,0,0,1,1,1]))}var m,c,h,W,H,O,v,M,n=this,J=!1,g=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var f=this.serializeProperties;for(var X in f)this[X]=f[X]},I.defineProperties(n,{enable:{get:function(){return J},set:function(i){!!J!=!!i&&(J=i,i&&!g&&K())}},image:{get:function(){return O},set:function(l){O!==l&&(O=l,H&&(b.getGL().deleteTexture(H),H=null),b.iv())}},maxblur:{get:function(){return v},set:function(R){v!==R&&(v=R,b.iv())}},aperture:{get:function(){return M},set:function(n){M!==n&&(M=n,b.iv())}}}),this.resetProperties(),n._42=function(A,F){function Y(u,v,m,f){Er(A,v.frame),b.setViewport(A,0,0,v.width,v.height),f?f(A):A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),k!==u&&u.bind();var i=0;for(var j in m){var x=m[j];x instanceof WebGLTexture&&(A.activeTexture(A.TEXTURE0+i),A.bindTexture(A.TEXTURE_2D,x),x=i,i++),u.uniforms[j]=x}for(k!==u&&(h.upload(),W.upload(),u.attributes.pos.pointer(W),k=u),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0);i--;)A.activeTexture(A.TEXTURE0+i),A.bindTexture(A.TEXTURE_2D,null);Sh(A)}if(J){g||K();var k;if(!H){var j=Mf(this.image);if(!j||!j.tagName)return F;H=mq(A,j)}var a=F.width,O=F.height;if(a&&O)return m.setSize(A,a,O),Y(c,m,{tColor:F.texture,tDepth:H,aspect:a/O,aperture:this.aperture,maxblur:this.maxblur}),m}}};Fk._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",og(C,{accordionViewExpandIcon:_b(eo),accordionViewCollapseIcon:_b(eo,!0),accordionViewLabelColor:$m,accordionViewLabelFont:Eo,accordionViewTitleBackground:Tl,accordionViewSelectBackground:Un,accordionViewSelectWidth:3,accordionViewSeparatorColor:i,splitViewDividerSize:1,splitViewDividerBackground:Tl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:mk,rect:[2,2,12,12],background:eo}]},propertyViewLabelColor:Ji,propertyViewLabelSelectColor:$m,propertyViewLabelFont:Eo,propertyViewExpandIcon:_b(Rf),propertyViewCollapseIcon:_b(Rf,!0),propertyViewBackground:Rk,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ap,propertyViewColumnLineColor:ap,propertyViewSelectBackground:Un,listViewLabelColor:Ji,listViewLabelSelectColor:$m,listViewLabelFont:Eo,listViewRowLineVisible:!1,listViewRowLineColor:ap,listViewSelectBackground:Un,treeViewLabelColor:Ji,treeViewLabelSelectColor:$m,treeViewLabelFont:Eo,treeViewExpandIcon:_b(Wd),treeViewCollapseIcon:_b(Wd,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ap,treeViewSelectBackground:Un,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Ji,tableViewLabelSelectColor:$m,tableViewLabelFont:Eo,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ap,tableViewColumnLineColor:ap,tableViewSelectBackground:Un,treeTableViewLabelColor:Ji,treeTableViewLabelSelectColor:$m,treeTableViewLabelFont:Eo,treeTableViewExpandIcon:_b(Wd),treeTableViewCollapseIcon:_b(Wd,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ap,treeTableViewColumnLineColor:ap,treeTableViewSelectBackground:Un,tableHeaderLabelColor:Ji,tableHeaderLabelFont:Eo,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:zq,tableHeaderBackground:Rk,tableHeaderMoveBackground:Gf,tableHeaderInsertColor:Un,tableHeaderSortDescIcon:Cl(Rf,!0),tableHeaderSortAscIcon:Cl(Rf),tabViewTabGap:1,tabViewLabelColor:$m,tabViewLabelFont:Eo,tabViewTabBackground:Tl,tabViewSelectWidth:3,tabViewSelectBackground:Un,tabViewMoveBackground:Gf,tabViewInsertColor:Un,toolbarLabelColor:Ji,toolbarLabelSelectColor:$m,toolbarLabelFont:Eo,toolbarBackground:Rk,toolbarSelectBackground:Un,toolbarItemGap:8,toolbarSeparatorColor:ol},!0);var yn={translateX:1,sortColumn:1},Ni={sortable:1,sortOrder:1,sortFunc:1},Am={focusData:1},io={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},cn={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Lo=function(A,n){n.add(A),A.hasChildren()&&A.eachChild(function(B){Lo(B,n)})},Ub=function(o,M,D,B,t,m,S,p,V,W,G){var z,P=D.getValueType(W),u=D.getAlign(W);if(D.getEnumValues(W)){var $=D.toEnumLabel(M,W),r=rs||0,Z=0,q=m,_=C.getTextSize(B,$).width;return z=Mf(D.toEnumIcon(M,W)),z&&(Z=m+rs/2,"center"===u?Z+=(p-(r+_))/2:"right"===u&&(Z=Z+p-(r+_)),ko(o,z,Z,S+V/2,W,G),q=Z+rs/2),$!=w&&(z?gb(o,$,B,t,q,S,p-(q-m),V):gb(o,$,B,t,m,S,p,V,u)),void 0}return M=D.formatValue(M),M!=w?P===Sr?(sc(o,m,S,p,V,M),void 0):P===Sg||!P&&tl(M)?(z=Mf(M?Yp:_p),ko(o,z,m+p/2,S+V/2,W,G),void 0):(gb(o,M,B,t,m,S,p,V,u),void 0):void 0},Rj=function(E,l){var x=l.view,A=Jg(E),v=l.column||l.property;x.getDataModel().beginTransaction(),l.editor=E,E.info=l,x.setCurrentEditor(E),x.getView().insertBefore(A,x._79O),Wp(E,l.editorRect),E.setFocus?E.setFocus():Rc(E),E.commitValue=function(F,a){E._17Q&&(E=E._17Q),a||x.setValue(l.data,v,E.getValue?E.getValue():E.value),E.close&&E.close(),ck(A)},v.onEditorCreated&&v.onEditorCreated(l)},Xj=function(L,i,Z,J,u){var z=Hj(L,Z),q=i.value,I=i.view,f=u.getValueType(i.data);return z.onblur=z.onchange=function(){I.endEditing()},"input"===L?(q=u.formatValue(q),q!=w&&(z.value=q),z.onkeydown=function(B){np(B)?I.endEditing():Gr(B)&&I.endEditing(!0)},(f===Zi||f===jd)&&X(z,kq,C.numberListener)):L===uj&&J.forEach(function(R){var h=j.createElement("option");h.innerHTML=u.toEnumLabel(R),h.value=R,u.isEnumEqual(q,R)&&(h.selected=!0),Pj(z,h)}),Rj(z,i),z},ee=v.widget={},Uo=function(O,k,X){vo(K+".widget."+O,k,X)};og(Ib,{ms_value:function(D){D.getValue=function(N){var X=this.getItemById(N),J=X.element;return tq(J)?J:J?J.getValue?J.getValue():J.value:X.selected},D.setValue=function(c,K){var M=this.getItemById(c);if(M){var d=M.element;d&&!tq(d)?d.setValue?d.setValue(K):d.value=K:tl(K)?(M.selected=K,this.iv()):(M.element=K,this.iv())}},D.v=function(h,I){var U=this;if(2===arguments.length)U.setValue(h,I);else{if(!as(h))return U.getValue(h);for(var y in h)U.setValue(y,h[y])}return U}},_46o:function(O){O._icon=w,O._accessType=w,O._valueType=w,O._editable=!1,O._batchEditable=!0,O._align=Nh,O._nullable=!0,O._emptiable=!1,O.setParent=mn,O.formatValue=function(R){var N=this,x=N._valueType;return N.getEnumValues()?N.toEnumLabel(R):x===Sg?!!R:R!=w&&x===Zi?J(R):R},O.setEnum=function(d,p,E,o,f,u,B){var T=this;d&&!qf(d)&&d.values&&(o=d.editable,E=d.icons,p=d.labels,f=d.strict,u=d.maxHeight,B=d.dropDownWidth,d=d.values),eq(d)&&(d=d._as),eq(p)&&(p=p._as),eq(E)&&(E=E._as),T._enumValues=d,T._enumLabels=p,T._enumIcons=E,T._enumEditable=o,T._enumStrict=f==w?!0:f,T._enumMaxHeight=u,T._enumDropDownWidth=B,d&&d.length&&Vc(d[0])&&(T._valueType=jd),T.fp("enum",!1,!0)},O.getEnumDropDownWidth=function(){return this._enumDropDownWidth},O.getEnumMaxHeight=function(){return this._enumMaxHeight},O.isEnumEditable=function(){return this._enumEditable},O.getEnumValues=function(){return this._enumValues},O.getEnumLabels=function(){return this._enumLabels},O.getEnumIcons=function(){return this._enumIcons},O.isEnumStrict=function(){return this._enumStrict},O.isEnumEqual=function(z,U){return this._enumStrict?z===U:z==U},O.toEnumLabel=function(I,z){var f=this,n=f.getEnumValues(z),q=f.getEnumLabels(z);if(n&&q)for(var S=0;S<n.length;S++)if(f.isEnumEqual(I,n[S]))return q[S];return I},O.toEnumIcon=function(I,R){var n=this,d=n.getEnumValues(R),J=n.getEnumIcons(R);if(d&&J)for(var F=0;F<d.length;F++)if(n.isEnumEqual(I,d[F]))return J[F];return i}},_45o:function(T){T._87o=function(D,q,F,V,u,E){if(D){var r=this,A=r._90I,$=xl(1);r._columnLineVisible&&(u-=1),r._rowLineVisible&&(E-=1),0>=u||0>=E||(r._90I||(A=r._90I={}),A[q]||(A[q]=new Pb),Wp($,r.tx()+F,r.ty()+V,u,E),Pj($,D),r._view.insertBefore($,r._79O),D.onParentAdded&&D.onParentAdded($),A[q].add($))}},T._76o=function(){var K=this,A=K._90I;if(A){for(var n in A)A[n].each(function(t){ck(t)});delete K._90I}},T._77o=function(v){var V=this;if(V._90I){var y=V._90I[v];y&&(y.each(function(F){ck(F)}),delete V._90I[v])}}},_47o:function(z){z.getValue=function(I,A){return A.getValue?A.getValue(I,A,this):ms(I,A.getAccessType(),A.getName())},z.setValue=function(G,z,S){if(z.isEmptiable(G)||""!==S||(S=i),z.isNullable(G)||S!=w){var L=this,c=z.getName(G),Y=z.getAccessType(G),k=z.getValueType(G);k===Zi&&tq(S)?S=a(S):k===jd&&tq(S)?S=parseFloat(S):k===Sg&&tq(S)&&(S="true"===S),L._batchEditable&&z._batchEditable&&L.isSelected(G)?L.sm().each(function(X){z.setValue?z.setValue(X,z,S,L):Sq(X,Y,c,S)}):z.setValue?z.setValue(G,z,S,L):Sq(G,Y,c,S)}},z.setCurrentEditor=function(x){this.endEditing(),this._currentEditor=x,this.redraw()},z.isEditing=function(S,L){var e=this,T=e._currentEditor;if(!T)return!1;if(L){var k=T.info;return k?(k.column||k.property)===L&&k.data===S:!1}return!0},z.endEditing=function(y){var V=this,M=V._currentEditor;M&&(delete V._currentEditor,M.commitValue&&M.commitValue(M.info,y),V.redraw(),V.getDataModel().endTransaction())},z.beginEditing=function(K){this.endEditing();var Y=this,o=K.column||K.property;if(o.beginEditing)o.beginEditing(K);else{var j=K.data,U=K.value,i=Y.getSelectBackground(j),A=o.getEnumValues(j),q=o.getSlider(j),t=o.getColorPicker(j);if(q){var N=ep(ee.Slider,q);return N.setValue(U),N.getView().onblur=function(){Y.endEditing()},N.isInstant()&&(N.onValueChanged=function(){Y.setValue(j,o,N.getValue())}),Rj(N,K),void 0}if(t||o.getValueType(j)===Sr){var m=ep(ee.ColorPicker,t);return m.setValue(U),m.onClosed=function(){Y.endEditing()},m.isInstant()&&(m.onValueChanged=function(d,S){Y.setValue(j,o,S)}),Rj(m,K),m.open(),void 0}if(A){if(ee.ComboBox){var X=new ee.ComboBox;X.setValue(U),X.setValues(A),X.setLabels(o.getEnumLabels(j)),X.setIcons(o.getEnumIcons(j)),X.setEditable(o.isEnumEditable(j)),X.setStrict(o.isEnumStrict(j)),X.setMaxHeight(o.getEnumMaxHeight(j)),X.setDropDownWidth(o.getEnumDropDownWidth(j)),X.onClosed=function(){Y.endEditing()},Rj(X,K),X.open()}else Xj(uj,K,i,A,o);return}var n=o.getValueType(j);if(n===Sg||tl(U))return Y.setValue(j,o,!U),void 0;if(o.getItemEditor(j)){var x=As(o.getItemEditor(j)),k=new x(j,o,Y,K),V=k.getView();return V._17Q=k,k.setValue(U),vg(V),Rj(V,K),k.editBeginning&&k.editBeginning(),void 0}Xj("input",K,i,w,o)}}},_44o:function(S){S.init=function(D){var g=this,M=g.th=new Kp(D),P=g._view=pf(1,g);g.tv=g._tableView=D,Pj(P,M.getView()),Pj(P,D.getView()),M.mp(function(z){z.property===bc&&g.iv()}),g.iv()},S.getTableView=function(){return this.tv},S.getTableHeader=function(){return this.th},S.getDataModel=function(){return this.tv.dm()},S.getColumnModel=function(){return this.tv.getColumnModel()},S.setColumns=function(U){this.tv.setColumns(U)},S.addColumns=function(F){this.tv.addColumns(F)},S.endEditing=function(){this.tv.endEditing()},S.validateImpl=function(){var S=this,F=S.th,P=um(F),x={x:0,y:0,width:S.getWidth(),height:P};Wp(F,x),x.y=P,x.height=H(0,S.getHeight()-P),Wp(S.tv,x)}},ms_vs:function(D){D._41o=function(){return this._29I.height<this._59I},D._43o=function(){var z=this;z._41o()&&(z._58I||(_(function(){z._94O()},vd),z.iv()),z._58I=new Date)},D._94O=function(){var C=this;if(C._58I){var l=new Date;l.getTime()-C._58I.getTime()>=vd?(delete C._58I,C.iv()):_(function(){C._94O()},vd)}},D._93I=function(){var c=this,x=c._27I;if(c._58I||!c._autoHideScrollBar){x||Pj(c._79O,x=c._27I=xl());var z=c._29I,d=z.height,t=c._59I,w=c.getScrollBarSize(),A=z.width-w-2,E=d*(-c.ty()/t),Q=d*(d/t),r=x.style;t>d?(Jh>Q&&(E=E+Q/2-Jh/2,0>E&&(E=0),E+Jh>d&&(E=d-Jh),Q=Jh),r.visibility=bi,r.background=c.getScrollBarColor(),r.borderRadius=w/2+Ih,Wp(x,A,E,w,Q)):r.visibility=kl}else x&&(x.style.visibility=kl)}},ms_hs:function(q){q._40o=function(){return this._29I.width<this._91I},q._42o=function(){var k=this;k._40o()&&(k._95O||(_(function(){k._94I()},vd),k.iv()),k._95O=new Date)},q._94I=function(){var I=this;if(I._95O){var M=new Date;M.getTime()-I._95O.getTime()>=vd?(delete I._95O,I.iv()):_(function(){I._94I()},vd)}},q._92I=function(){var U=this,B=U._28I;if(U._95O||!U._autoHideScrollBar){B||Pj(U._79O,B=U._28I=xl());var R=U._29I,y=R.width,X=U._91I,c=U.getScrollBarSize(),E=R.height-c-2,x=y*(-U.tx()/X),T=y*(y/X),C=B.style;X>y?(Jh>T&&(x=x+T/2-Jh/2,0>x&&(x=0),x+Jh>y&&(x=y-Jh),T=Jh),C.visibility=bi,C.background=U.getScrollBarColor(),C.borderRadius=c/2+Ih,Wp(B,x,E,T,c)):C.visibility=kl}else B&&(B.style.visibility=kl)}}}),Yb(Yp,Th(16,16,[{type:Ph,rect:[1,1,14,14],background:Un},{type:hl,rect:[1,1,14,14],width:1,color:Bk},{type:Mh,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Yb(_p,Th(16,16,{type:hl,rect:[1,1,14,14],width:1,color:Bk})),Yb(Bs,Th(16,16,[{type:gi,rect:[2,2,12,12],borderWidth:1,borderColor:Bk,background:"#FFF"},{type:gi,rect:[4,4,8,8],background:Un}])),Yb(bl,Th(16,16,{type:gi,rect:[2,2,12,12],borderWidth:1,borderColor:Bk})),Ib._15Q=function(f){f._29I=Be,f._59I=0,f._91I=0,f._5o=function(w){var n=this;n._30I=new Pb,n._rows=new Pb,n._rowMap={},n._31I=0,n._14I=0,n._view=pf(1,n),n._canvas=$f(n._view),Pj(n._view,n._79O=xl()),n.dm(w?w:new Ln)},f.getCheckIcon=function(X){var P=this.sm(),h=P.co(X);return P.sg()?Mf(h?Bs:bl):Mf(h?Yp:_p)},f.checkData=function(c){var b=this.sm(),v=b.co(c);b.sg()&&v||(this._32o=1,v?b.rs(c):b.as(c),delete this._32o)},f.getDataAt=function(s){s.target&&(s=this.lp(s));var K=p(s.y/this._rowHeight),F=this._rows;return 0>K||K>=F.size()?w:F.get(K)},f.onDataDoubleClicked=function(){},f.onDataClicked=function(){},f.adjustTranslateX=function(){return 0},f.adjustTranslateY=function(U){var y=this.getHeight()-this._59I;return y>U&&(U=y),U>0?0:J(U)},f.onPropertyChanged=function(x){var l=this,E=x.property;io[E]?l.ivm():Am[E]||l.redraw(),E===Qb?l._42o():E===Lp&&l._43o()},f.getLabel=function(Q){return Q.toLabel()},f.getLabelFont=function(){return this._labelFont},f.getLabelColor=function(e){var G=this;if(G.isCheckMode()){if(G._focusData===e)return G._labelSelectColor}else if(G.isSelected(e))return G._labelSelectColor;return G._labelColor},f.getStartRowIndex=function(){return this._31I},f.getEndRowIndex=function(){return this._14I},f.getRowDatas=function(){return this._rows},f.getRowIndex=function(L){return this._rowMap[L._id]},f.getRowSize=function(){return this._rows.size()},f.getViewRect=function(){return Tk(this._29I)},f.isVisible=function(x){return this._visibleFunc?this._visibleFunc(x):!0},f.getCurrentSortFunc=function(){return this._sortFunc},f.setDataModel=function(f){var T=this,V=T._dataModel,x=T._selectionModel;V!==f&&(V&&(V.umm(T.handleDataModelChange,T),V.umd(T.handleDataPropertyChange,T),V.umh(T.handleHierarchyChange,T),x||V.sm().ums(T.handleSelectionChange,T)),T._dataModel=f,f.mm(T.handleDataModelChange,T),f.md(T.handleDataPropertyChange,T),f.mh(T.handleHierarchyChange,T),x?x._21I(f):f.sm().ms(T.handleSelectionChange,T),T.fp("dataModel",V,f))},f.validateModel=function(){var S=this;S._rows.clear(),S._rowMap={},S.buildChildren(S._dataModel._roots);var H=S._rows=S._rows.toList(S.isVisible,S),t=0,C=S.getCurrentSortFunc(),s=H.size();for(C&&H.sort(C);s>t;t++)S._rowMap[H.get(t)._id]=t},f.buildChildren=function(t){var o=this;t.each(function(x){o._rows.add(x),o.buildChildren(x._children)})},f.handleDataModelChange=function(){this.ivm()},f.handleDataPropertyChange=function(B){"parent"===B.property?this.ivm():this.invalidateData(B.data)},f.handleHierarchyChange=function(){this.ivm()},f.handleSelectionChange=function(J){J.datas.each(this.invalidateData,this),this.onSelectionChanged(J)},f.onSelectionChanged=function($){var H=this,B=H.sm();!H.isAutoMakeVisible()||1!==B.size()||"set"!==$.kind&&"append"!==$.kind||H._32o||H.makeVisible(B.ld())},f.handleBackgroundClick=function(G){Lg(G)&&!this.isCheckMode()&&this.sm().cs()},f.makeVisible=function(c){c&&(this._23I=c,this.iv())},f.scrollToIndex=function(g){var u=this,X=u._29I,M=X.height,Y=u._rowHeight,r=Y*g;g>=0&&g<u._rows.size()&&M>0&&(r+Y>X.y+M?u.ty(-r+M-Y):r<X.y&&u.ty(-r))},f.autoScroll=function(_,p){var x=this,f=x._rowHeight,y=f,C=f/4,g=x._29I,B=x.lp(_),s={x:x.tx(),y:x.ty()};return f>0&&g&&(B.x-g.x<y?x.translate(C,0):g.x+g.width-B.x<y&&x.translate(-C,0),B.y-g.y<y?x.translate(0,C):g.y+g.height-B.y<y&&x.translate(0,-C)),s.x=x.tx()-s.x,s.y=x.ty()-s.y,p&&(p.x+=s.x,p.y+=s.y),s},f.getTopRowOrderSelection=function(){var E=this.sm().getTopSelection(),w={},I=new Pb;return E.each(function(K){w[K._id]=K}),this._rows.each(function(M){w[M._id]&&I.add(M)}),I},f.getRowOrderSelection=function(){var F=new Pb;return this._rows.each(function(U){this.isSelected(U)&&F.add(U)},this),F},f.ivm=function(){this.invalidateModel()},f.invalidateModel=function(){var h=this;h._96I||(h._96I=1,h._32I=1,delete h._24I),h.iv()},f.redraw=function(){var x=this;x._32I||(x._32I=1,delete x._24I,x.iv())},f.invalidateData=function(U){var R=this;Mb?R.redraw():R._32I||(R._24I||(R._24I={}),R._24I[U._id]=U,R.iv())},f.getFocusData=function(){return this._focusData},f.setFocusDataById=function(r){this.setFocusData(this.dm().getDataById(r))},f.setFocusData=function(T){var J=this,k=J._focusData;k!==T&&(J._focusData=T,J.fp("focusData",k,T),k&&J.invalidateData(k),T&&(J.invalidateData(T),J.isAutoMakeVisible()&&J.makeVisible(T)))},f.drawRowBackground=function(r,f,h,W,i,K,G){var V=this,M=V.isCheckMode();(f===V._focusData&&M||h&&!M)&&sc(r,W,i,K,G,V.getSelectBackground(f))},f.drawData=function(o,T,h){var q=this,u=q._rowHeight,_=u*h,i=q._29I,Q=i.x,N=i.width;o.save(),o.beginPath(),o.rect(Q,_,N,u),o.clip(),q._87o(q.drawRow(o,T,q.isSelected(T),Q,_,N,u),h,Q,_,N,u),o.restore(),q._rowLineVisible&&sc(o,Q,_+u-1,N,1,q._rowLineColor)},f._12I=function(T){var l=this,Q=l._31I,V=l._29I,D=V.x,n=V.y,d=V.width,t=V.height;for(T.beginPath(),T.rect(D,n,d,t),T.clip(),T.clearRect(D,n,d,t),l._76o(),l._93db(T);Q<l._14I;Q++)l.drawData(T,l._rows.get(Q),Q);l._92db(T)},f._13I=function(J){for(var y,P=this,d=P._rowHeight,s=P._29I,r=s.x,S=s.width,K=P._31I,k=P._30I;K<P._14I;K++)y=P._rows.get(K),P._24I[y._id]&&k.add({data:y,index:K});k.isEmpty()||(J.beginPath(),k.each(function(Y){J.rect(r,Y.index*d,S,d)}),J.clip(),k.each(function(D){J.clearRect(r,D.index*d,S,d)}),k.each(function(p){P._77o(p.index)}),P._93db(J),k.each(function(z){P.drawData(J,z.data,z.index)}),P._92db(J),k.clear())},f.preValidateModel=function(){this.endEditing&&this.endEditing()},f.validateImpl=function(){var C=this,b=C._canvas,Y=C.getWidth(),H=C.getHeight(),y=C._rowHeight,c=C._32I;(Y!==b.clientWidth||H!==b.clientHeight)&&(vf(b,Y,H),c=1);var f=r&&!D;C._96I&&!f&&(C.preValidateModel(),C.validateModel());var J=C._29I,P={x:-C.tx(),y:-C.ty(),width:Y,height:H},k=C._rows.size(),K=Xl(b),O=C._23I;c||bo(P,J)||(c=1),C._29I=P,C._59I=k*y+C.getScrollBarSize(),C._31I=p(P.y/y),C._14I=R((P.y+P.height)/y),C._31I<0&&(C._31I=0),C._14I>k&&(C._14I=k),C._99I&&c&&C._99I(),Md(K,C.tx(),C.ty(),1),c?C._12I(K):C._24I&&C._13I(K),C._93I(),C._92I(),K.restore(),C._32I=C._24I=C._96I=w,O&&(C.scrollToIndex(C.getRowIndex(O)),delete C._23I),C.tx(C.tx()),C.ty(C.ty())}},Ib._48o=function(m){m._rootVisible=!0,m._rootData=w,m._35o=function(){this._expandMap={},this._levelMap={}},m.validateModel=function(){var q=this,n=q._rootData;q._rows.clear(),q._levelMap={},q._rowMap={},q._currentLevel=0,n?q._rootVisible?q.isVisible(n)&&q.buildData(n):q.buildChildren(n):q.buildChildren(),delete q._currentLevel},m.buildData=function(A){var f=this,p=A._id,$=f._rows;f._rowMap[p]=$.size(),$.add(A),f._levelMap[p]=f._currentLevel,f.isExpanded(A)&&(f._currentLevel++,f.buildChildren(A),f._currentLevel--)},m.buildChildren=function(o){var y=this,v=o?o._children:y._dataModel._roots,K=y.getCurrentSortFunc();K&&y.isChildrenSortable(o)?v.toList(y.isVisible,y).sort(K).each(y.buildData,y):v.each(function(s){y.isVisible(s)&&y.buildData(s)})},m.getLevel=function(C){return this._levelMap[C._id]},m.getToggleIcon=function(d){var C=this,n=C._loader,Q=C._collapseIcon;return n&&!n.isLoaded(d)?Q:d.hasChildren()?C.isExpanded(d)?C._expandIcon:Q:w},m.isCheckMode=function(){return this._checkMode!=w},m.isChildrenSortable=function(){return!0},m.handleDataModelChange=function(t){var T=this;t.kind===rh?delete T._expandMap[t.data._id]:t.kind===yc&&(T._expandMap={}),T.ivm()},m.toggle=function(J){var e=this;e.isExpanded(J)?e.collapse(J):e.expand(J)},m.isExpanded=function(z){return 1===this._expandMap[z._id]},m.expand=function(Q){var V=this,S=V._loader;V.isExpanded(Q)||(S&&!S.isLoaded(Q)&&S.load(Q),V._expandMap[Q._id]=1,V.ivm(),V.onExpanded(Q))},m.onExpanded=function(){},m.collapse=function(p){var o=this;o.isExpanded(p)&&(delete o._expandMap[p._id],o.ivm(),o.onCollapsed(p))},m.onCollapsed=function(){},m.expandAll=function(d){if(d)this.expand(d),d.eachChild(function(S){this.expandAll(S)},this);else{var K=this;K._dataModel.each(function(S){S.hasChildren()&&(K._expandMap[S._id]=1)}),K.ivm()}},m.collapseAll=function(){this._expandMap={},this.ivm()},m.makeVisible=function(V){if(V){var $=this;if(!$._rootData||V.isDescendantOf($._rootData)){for(var v=V._parent;v;)$.expand(v),v=v._parent;$._23I=V,$.iv()}}},m.checkData=function(i){var a,N=this,Z=N._checkMode,T=N.sm(),J=T.co(i);if(!T.sg()||!J){if(N._32o=1,Z===fn)J?T.rs(i):T.as(i);else if(Z===$n)a=new Pb(i),a.addAll(i._children);else if("descendant"===Z)a=new Pb,Lo(i,a);else if("all"===Z&&(a=new Pb,Lo(i,a),!J))for(var w=i._parent;w;)a.add(w),w=w._parent;a&&(J?T.rs(a):T.as(a)),delete N._32o}},m._97I=function(j,Q,f,h,J,l,F){var u=this,S=u._indent,R=u._levelMap[Q._id],L=u.getIconWidth(Q),G=Mf(u.getToggleIcon(Q));G?(h+=S*R,ko(j,G,h+S/2,J+F/2,Q,u),h+=S):h+=S*(R+1),u._checkMode&&(ko(j,u.getCheckIcon(Q),h+S/2,J+F/2,Q,u),h+=S),u.drawIcon(j,Q,h,J,L,F),u.drawLabel(j,Q,h+L,J,F)}},Ib._14Q=function(W){W.getIcon=function(K){return K.getIcon()},W.getIconWidth=function(P){return this.getIcon(P)?this._indent:0
},W.drawIcon=function(E,t,Y,U,T,$){if(T){var w=this,K=w.getBodyColor(t),P=Mf(w.getIcon(t),K);P&&($-=w.isRowLineVisible()?1:0,nd(E,P,te,Y,U,T,$,t,w,K),Zh(E,w.getBorderColor(t),Y,U,T,$))}},W.drawLabel=function(r,R,M,j,s){var g=this;gb(r,g.getLabel(R),g.getLabelFont(R),g.getLabelColor(R),M,j,0,s)}},Ib._50o=function(f){f._98I=function(){var L=this,j=L._39o=new Ln;L._60I=new Pb,j.mm(L._17o,L),j.md(L._18o,L),j.mh(L._19o,L)},f.setColumns=function(v){this._39o.clear(),this.addColumns(v)},f.addColumns=function(M){var n=this._39o;M.forEach(function(x){if(!(x instanceof pb)){var P=As(x.className);x=ep(P?P:pb,x)}n.add(x)})},f.onColumnClicked=function(){},f.onCheckColumnClicked=function(){},f._3Q=function(Q){for(var Z,U=0,S=this._60I,r=S.size();r>U;U++)if(Z=S.get(U),Z.column===Q)return Z;return w},f.getColumnAt=function(J){var K=this._4Q(J);return K?K.column:w},f._4Q=function(l){for(var e=this,I=l.target?e.lp(l).x:l.x,D=e._60I,U=0;U<D.size();U++){var i=D.get(U),V=i.startX;if(I>=V&&I<V+i.column.getWidth())return i}return w},f.getToolTip=function(S){var o=this,d=o.getDataAt(S),X=o.getColumnAt(S);return d&&X?X.getToolTip(d,o):w},f.adjustTranslateX=function(F){var o=this.getWidth()-this._91I;return o>F&&(F=o),F>0?0:J(F)},f._99I=function(){var u=this,$=u._29I,B=u._60I;B.clear(),u._91I=0,u._39o._roots.each(function(p){if(p.isVisible()){var c=u._91I+p.getWidth();u._91I<=$.x+$.width&&c>=$.x&&B.add({column:p,startX:u._91I}),u._91I=c}}),u._91I+=u.getScrollBarSize()},f.drawData=function(D,U,r){var R=this,N=R._rowHeight,Y=N*r,T=R.isSelected(U),X=R._29I,P=X.x,A=X.width;R.drawRowBackground(D,U,T,P,Y,A,N),R._60I.each(function(l){var v=l.column,g=l.startX,E=v.getWidth();E>0&&!R.isEditing(U,v)&&(D.save(),D.beginPath(),D.rect(g,Y,E,N),D.clip(),R._87o(R.drawCell(D,U,T,v,g,Y,E,N),r,g,Y,E,N),R._columnLineVisible&&sc(D,g+E-1,Y,1,N,R._columnLineColor),D.restore())}),R._rowLineVisible&&sc(D,P,Y+N-1,A,1,R._rowLineColor)},f.drawCell=function(s,x,U,b,S,c,_,p){var l=this;if(b.drawCell)return b.drawCell(s,x,U,b,S,c,_,p,l);var P=l.getValue(x,b);Ub(s,P,b,l.getLabelFont(x,b,P),l.getLabelColor(x,b,P),S,c,_,p,x,l)},f.getColumnModel=function(){return this._39o},f._17o=function(){this.redraw()},f._18o=function(h){var N=this;h.data===N._sortColumn&&Ni[h.property]?N.ivm():(N._42o(),N.redraw())},f._19o=function(){this.redraw()},f.getCurrentSortFunc=function(){var H=this,E=H._sortColumn;if(E&&E.isSortable()){var L=E.getSortFunc(),M=Fq===E.getSortOrder()?1:-1;return L||(L=xr),function(B,m){return L.call(H,H.getValue(B,E),H.getValue(m,E),B,m)*M}}return H._sortFunc},f.isCellEditable=function(L,j,x){return j.isEditable()&&this.isEditable()?j.isCellEditable?j.isCellEditable(L,j,x,this):!0:!1},f._37O=function(Y,y){if(Lg(y))for(var J=this,c=J.lp(y),m=J._60I,X=J._rowHeight,$=J._29I,u=$.x,C=$.y,Z=$.width,s=$.height,k=0;k<m.size();k++){var H=m.get(k),K=H.startX,O=H.column,p=O.getWidth();if(O!==J._31o&&O!==J._4o&&c.x>=K&&c.x<K+p&&J.isCellEditable(Y,O,y)){var i={x:K,y:J.getRowIndex(Y)*X,width:p,height:X},T={x:i.x+J.tx(),y:i.y+J.ty(),width:i.width,height:i.height},j=0,d=0;return i.x<u?j=i.x-u:i.x+i.width>u+Z&&(j=i.x+i.width-u-Z),j&&(J.tx(J.tx()-j),T.x-=j),i.y<C?d=i.y-C:i.y+X>C+s&&(d=i.y+X-C-s),d&&(J.ty(J.ty()-d),T.y-=d),J.beginEditing({data:Y,column:O,value:J.getValue(Y,O),event:y,rect:i,editorRect:T,view:J}),void 0}}}},ee.BaseItemEditor=function(m,L,o,e){this._data=m,this._column=L,this._master=o,this._editInfo=e},Uo("BaseItemEditor",I,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Ye=v.Tab=function(){qj(Ye,this)};zc("Tab",ji,{ms_ac:["view","closable","disabled","visible"],_icon:w,_closable:!1,_disabled:!1,_visible:!0,setParent:mn});var pb=v.Column=function(){qj(pb,this)};zc("Column",ji,{_46o:1,ms_ac:["accessType","valueType",bi,yd,To,In,"align",Sr,"sortOrder",Nm,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Fq,_sortFunc:w,_sortable:!0,_clickable:!0,setWidth:function(b){16>b&&(b=16);var e=this._width;this._width=b,this.fp(In,e,b)},getToolTip:function(A,Y){return this.formatValue(Y.getValue(A,this))}});var Dc=v.Property=function(){qj(Dc,this)};zc("Property",ji,{_46o:1,ms_ac:["accessType","valueType",yd,To,"categoryName",Sr,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:w,getToolTip:function(Q,k,G){var f=this;return k?f.formatValue(G.getValue(Q,f)):G.getPropertyName(f)}}),ee.AccordionView=function(){var O=this;O._20o={},O._21o=new Pb,O._10o=w,O._9o=w,O._11o=w,O._view=pf(0,O),O.iv()},Uo("AccordionView",I,{ms_v:1,ms_fire:1,ms_ac:[hb,ef,"titleHeight",Vh,Fm,"titleBackground","selectWidth",Pf,"orientation","separatorColor"],_expandIcon:C.accordionViewExpandIcon,_collapseIcon:C.accordionViewCollapseIcon,_titleHeight:Rm,_labelColor:C.accordionViewLabelColor,_labelFont:C.accordionViewLabelFont,_titleBackground:C.accordionViewTitleBackground,_selectBackground:C.accordionViewSelectBackground,_selectWidth:C.accordionViewSelectWidth,_orientation:"v",_separatorColor:C.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(U,k,d,$){var V=this,g=xl();if(V._20o[U])throw U+" already exists";g.onmousedown=jm,g.style.cursor=_q,X(g,ij?Of:so,function(P){jm(P)}),X(g,ij?ki:cc,function(J){jm(J),Lg(J)&&(V._10o===U?V.collapse():V.expand(U))}),Pj(V._view,g),V._20o[U]={content:k,div:g,canvas:$f(g),icon:$},V._21o.add(U),d&&V.expand(U),V.iv()},remove:function(k){var _=this,u=_._20o[k];u&&(ck(u.div),delete _._20o[k],_._21o.remove(k),_.iv())},clear:function(){var j=this;j._21o.toArray().forEach(j.remove,j),j._20o={},j._21o.clear(),j.iv()},isExpanded:function(N){return this._10o===N},expand:function(L){var U=this;U._20o[L]&&U._10o!==L&&(U._10o=L,U.onExpanded(L),U.iv())},onExpanded:function(){},collapse:function(){var m=this;m._10o&&(m.onCollapsed(m._10o),delete m._10o,m.iv())},onCollapsed:function(){},initCanvas:function(t,m,S){vf(t,m,S);var p=Xl(t);return Md(p,0,0,1),p.clearRect(0,0,m,S),p},drawTitle:function(H,O,C,K,A){var y=this,v=Mf(A.icon),W=y.isExpanded(O),c=y._titleHeight,w=y._titleBackground,o=y._selectWidth,_=y._separatorColor,P=Mf(W?y._expandIcon:y._collapseIcon),s=o+4;sc(H,0,0,C,K,w),W&&o&&sc(H,0,0,o,K,y._selectBackground),(W||y._21o.get(y._21o.size()-1)!==O)&&sc(H,0,K-1,C,1,_?_:Ro(w)),v&&(ko(H,v,s+Xk(v)/2,c/2),s+=Xk(v)+2),gb(H,O,y.getLabelFont(O),y.getLabelColor(O),s,0,0,c),P&&ko(H,P,C-Xk(P)/2-4,c/2)},validateImpl:function(){var u=this,r=u._view,f=0,b=0,p=u.getWidth(),T=u.getHeight(),a=u._titleHeight,v=u._21o.size()*a,_=u._11o,l=u._9o;delete u._11o,delete u._9o,u._21o.each(function(R){var L,P,O=u._20o[R],g=O.content,J=u._10o===R;ym(u)?(Wp(O.div,f,0,a,T),L=u.initCanvas(O.canvas,a,T),_k(L,0,T),uh(L,-k),u.drawTitle(L,R,T,a,O),L.restore(),J?(P=H(0,p-v),g&&(u._11o=g,u._9o=Jg(g),Wp(g,f+a,0,P,T)),f+=a+P):f+=a):(Wp(O.div,0,b,p,a),L=u.initCanvas(O.canvas,p,a),u.drawTitle(L,R,p,a,O),L.restore(),J?(P=H(0,T-v),g&&(u._11o=g,u._9o=Jg(g),Wp(g,0,b+a,p,P)),b+=a+P):b+=a)});var n=u._9o;_&&_!==u._11o&&_.endEditing&&_.endEditing(),n&&n!==l&&Pj(r,n),l&&l!==n&&ck(l)}}),ee.SplitView=function(S,y,$,g){var d=this,L=d._dividerDiv=xl(),i=d._60O=$f(),D=d._61O=$f(),O=i.style,z=D.style;d._view=pf(1,d),Pj(d._view,L),O.msTouchAction=dg,O.pointerEvents=dg,O.cursor=_q,z.msTouchAction=dg,z.pointerEvents=dg,z.cursor=_q,S&&d.setLeftView(S),y&&d.setRightView(y),$&&d.setOrientation($),g!=w&&d.setPosition(g),d.setStatus(Wr),new kj(d)},Uo("SplitView",I,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:C.splitViewDividerSize,_dividerBackground:C.splitViewDividerBackground,_dragOpacity:C.splitViewDragOpacity,_toggleIcon:C.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(b,n){var k=this,p=k._position;isNaN(b)||(n||(k._82O=0>b?-1:b>1?1:0),k._position=b,k.fp(Zd,p,b))},getLeftView:function(){return this._leftView},setLeftView:function(s){var f=this,F=f._leftView,C=f._view;if(f._leftView!==s){if(F&&F!==f._rightView){var x=Jg(F);x.parentNode===C&&ck(x)}if(f._leftView=s,s){var R=Jg(s);R.parentNode!==C&&C.insertBefore(R,f._dividerDiv)}f.fp("leftView",F,s)}},getRightView:function(){return this._rightView},setRightView:function(L){var C=this,m=C._rightView,h=C._view;if(C._rightView!==L){if(m&&m!==C._leftView){var q=Jg(m);q.parentNode===h&&ck(q)}if(C._rightView=L,L){var w=Jg(L);w.parentNode!==h&&h.insertBefore(w,C._dividerDiv)}C.fp("rightView",m,L)}},validateImpl:function(){var g=this,l=g._draggable,p=g._position,M=g.getWidth(),_=g.getHeight(),X=g._dividerSize,z=g._dividerBackground,W=ij?18:8,D=g._dividerDiv,w=g._82O,s=g._60O,A=g._61O,m=g._toggleIcon,P=g._status,c=D.style,R=null,Y=ij?20:4,G=m.comps[0];X>=W||0===X?g._coverDiv&&(ck(g._coverDiv),delete g._coverDiv):g._coverDiv||(g._coverDiv=xl(),pk&&(g._coverDiv.style.background=uq),Pj(D,g._coverDiv)),g._togglable?s.parentNode||(Pj(D,s),Pj(D,A)):(ck(s),ck(A));var Z=g._coverDiv,u=g._leftView,e=g._rightView;if(ym(g)){if(X>M&&(X=M),P===Wr)if(1===w)var t=V(p,M),I=H(0,M-X-t);else-1===w?(I=V(-p,M),t=H(0,M-X-I)):(t=J((M-X)*p),I=H(0,M-X-t));else"cl"===P?(t=0,I=H(0,M-X)):"cr"===P&&(I=0,t=H(0,M-X));u&&Wp(u,0,0,t,_),e&&Wp(e,t+X,0,I,_),Wp(D,t,0,X,_),g._22o=t,Z&&(Wp(Z,X/2-W/2,0,W,_),Z.style.cursor=l?rb:""),D.style.cursor=l?rb:"";var C=D.clientHeight/2,O=D.clientWidth;vf(s,O,O),Wp(s,0,C-O-Y,O,O),R=Xl(s),Md(R,0,0,1),G.rotation=-k,lh(R,m,0,0,O,O),R.restore(),vf(A,O,O),Wp(A,0,C+Y,O,O),R=Xl(A),Md(R,0,0,1),G.rotation=k,lh(R,m,0,0,O,O),R.restore()}else{if(X>_&&(X=_),P===Wr)if(1===w)var E=V(p,_),T=H(0,_-X-E);else-1===w?(T=V(-p,_),E=H(0,_-X-T)):(E=J((_-X)*p),T=H(0,_-X-E));else"cl"===P?(E=0,T=H(0,_-X)):"cr"===P&&(T=0,E=H(0,_-X));u&&Wp(u,0,0,M,E),e&&Wp(e,0,E+X,M,T),Wp(D,0,E,M,X),g._22o=E,Z&&(Wp(Z,0,X/2-W/2,M,W),Z.style.cursor=l?Cg:""),c.cursor=l?Cg:"";var F=D.clientWidth/2,O=D.clientHeight;vf(s,O,O),Wp(s,F-O-Y,0,O,O),R=Xl(s),Md(R,0,0,1),G.rotation=0,lh(R,m,0,0,O,O),R.restore(),vf(A,O,O),Wp(A,F+Y,0,O,O),R=Xl(A),Md(R,0,0,1),G.rotation=Q,lh(R,m,0,0,O,O),R.restore()}c.background=z}});var kj=function(b){this.sv=b,this.addListeners()};vo(kj,I,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(x){var T=this,I=T.sv,D=I._dividerDiv,w=I._60O,z=I._61O,k=I._status,_=x.target;if(_===w)k===Wr?I.setStatus("cl"):"cr"===k&&I.setStatus(Wr);else if(_===z)k===Wr?I.setStatus("cr"):"cl"===k&&I.setStatus(Wr);else if(vj(x)&&(_===D||_===I._coverDiv)&&(jm(x),I.isDraggable())){I.getLeftView(),I.getRightView();var o=T.maskDiv=xl();if(o.style.left=0,o.style.top=0,o.style.width=I.getWidth()+"px",o.style.height=I.getHeight()+"px",I.getView().appendChild(o),!I.isContinuousLayout()){var P=T.resizeDiv=xl();P.style.left=D.style.left,P.style.top=D.style.top,P.style.width=D.style.width,P.style.height=D.style.height,P.style.opacity=I.getDragOpacity(),P.style.background=I.getDividerBackground(),Pj(T.getView(),P)}T._lastAbsPosition=I._22o,T._86o=ym(I)?Io(x).x:Io(x).y,Yl(T,x)}},handleWindowTouchMove:function(k){vj(k)&&this.update(k,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(G){var r=this;r.update(G,!0),r.sv.setStatus(Wr),r.maskDiv&&ck(r.maskDiv),r.resizeDiv&&ck(r.resizeDiv),r.maskDiv=r.resizeDiv=w},handle_mousedown:function(_){Lg(_)&&this.handle_touchstart(_)},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},update:function(h,d){var G=this,R=G.sv,P=ym(R)?R.getWidth():R.getHeight(),x=R._dividerSize,$=G._lastAbsPosition-G._86o;ym(R)?($+=Io(h).x,$>P-x&&($=P-x),0>$&&($=0),G.resizeDiv&&(G.resizeDiv.style.left=$+Ih)):($+=Io(h).y,$>P-x&&($=P-x),0>$&&($=0),G.resizeDiv&&(G.resizeDiv.style.top=$+Ih)),d&&P!==x&&(1===R._82O?R.setPosition($,1):-1===R._82O?R.setPosition($-P+x,1):R.setPosition($/(P-x),1))}}),ee.TabView=function(){var h=this,I=h._view=pf(1,h),l=h._91O=xl(1),D=h._tabModel=new Ln,v=D.sm(),c=h.invalidate;h._7o=new Pb,h._canvas=$f(l),Pj(I,l),Pj(I,h._92O=xl(1)),v.setSelectionMode(yj),v.ms(h.handleSelectionChange,h),D.mm(c,h),D.mh(c,h),D.md(c,h),h._interactor=new no(h),h.iv()},Uo("TabView",I,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Vh,Fm,"tabHPadding","tabBackground","selectWidth",Pf,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Gh,_tabHeight:Rm,_tabGap:C.tabViewTabGap,_labelColor:C.tabViewLabelColor,_labelFont:C.tabViewLabelFont,_tabBackground:C.tabViewTabBackground,_selectWidth:C.tabViewSelectWidth,_selectBackground:C.tabViewSelectBackground,_moveBackground:C.tabViewMoveBackground,_insertColor:C.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(U,D,n){var C,P=this._tabModel;return U instanceof Ye?(C=U,D&&C.setView(D)):(C=new Ye,C.setName(U),C.setView(D)),P.add(C),n&&P.sm().ss(C),C},getLabel:function(n){return n.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(X){this._23o=X,this.iv()},get:function(L){var v=this,F=v._tabModel;if(Vc(L))return F._roots.get(L);if(tq(L)){var N;return F.each(function(q){L===v.getLabel(q)&&(N=q)}),N}return L instanceof Ye?L:w},select:function(i){this._tabModel.sm().ss(this.get(i))},remove:function(o){var j=this;if(o=j.get(o)){var Z=j._tabModel,k=Z._roots.indexOf(o);j._tabModel.remove(o),j.selectByIndex(--k)}},getCurrentTab:function(){return this._8o},hideTabView:function(s,L){L.parentNode===this._92O&&(Ri(L)?(L.style.display=Dp,L._tab_=s):ck(L),yp())},showTabView:function(Y,l){Ri(l)&&(l.style.display="block",l._tab_=Y),l.parentNode!==this._92O&&(Pj(this._92O,l),yp())},_24o:function(){var X,d=this,v=d._8o,M=d._9o,F=d._tabModel.sm().ld();F&&(X=Jg(F.getView())),X!==M&&(M&&(v.getView()&&v.getView().endEditing&&v.getView().endEditing(),d.hideTabView(v,M)),X&&d.showTabView(F,X)),d._8o=F,d._9o=X,v!==F&&d.onTabChanged(v,F)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(F,R){this.selectByIndex(--R)},selectByIndex:function(W){var k=this,i=k._tabModel,C=i.size();if(C&&!i.sm().ld()){W==w&&(W=0),W>=C&&(W=C-1),0>W&&(W=0);for(var J=W;J>=0;J--){var l=k.get(J);if(!l.isDisabled())return k.select(l),l}for(J=W+1;C>J;J++)if(l=k.get(J),!l.isDisabled())return k.select(l),l}},getTabWidth:function(n){var v=this.getTabHPadding(),$=4+2*v,O=Mf(n.getIcon());O&&($+=Xk(O,n)+4);var U=this.getLabel(n);return U&&($+=Sk(this.getLabelFont(n),U).width+4),n.isClosable()&&($+=10),$},drawTab:function(h,I,_,X,d,m,j){var F,z=this,c=z._tabPosition,u=this.getTabHPadding(),T=_+4+u,p=z._selectWidth,B=Mf(I.getIcon()),N=I.isDisabled(),V=z.getLabelColor(I),O=z.getLabelFont(I),s=z.getLabel(I),l=z._selectBackground,D=c===Nh+"-vertical",o=c===He+"-vertical";(D||o)&&(T=X+4+u),N&&(h.globalAlpha=Uf),sc(h,_,X,d,m,j),I===z._8o&&p&&(c===Gh?sc(h,_,X+m-p,d,p,l):c===Nh?sc(h,_+d-p,X,p,m,l):c===He?sc(h,_,X,p,m,l):D?sc(h,_+d-p,X,p,m,l):o?sc(h,_,X,p,m,l):sc(h,_,X,d,p,l));var y=d/2;if(D&&(_k(h,y,X+m/2),uh(h,Q),_k(h,-y,-X-m/2)),B){var K=Dg(B,I),J=Xk(B,I);if(D||o){var t=_+d/2,i=T+K/2;_k(h,t,i),uh(h,k),_k(h,-t,-i),ko(h,B,_+d/2,T+K/2,I,z),_k(h,t,i),uh(h,-k),_k(h,-t,-i),T+=K+4}else ko(h,B,T+J/2,X+m/2,I,z),T+=J+4}return D||o?(_k(h,d/2,T+d/2),uh(h,k),_k(h,-d/2,-T-d/2),gb(h,s,O,V,_,T,m,d),_k(h,d/2,T+d/2),uh(h,-k),_k(h,-d/2,-T-d/2)):gb(h,s,O,V,T,X,d,m),D&&(_k(h,y,X+m/2),uh(h,-Q),_k(h,-y,-X-m/2)),I.isClosable()&&(F=o?{x:_+d-12,y:X+m-12,width:12,height:12}:{x:_+d-12,y:X+2,width:12,height:12},this.drawCloseIcon(I,h,V,F)),N&&(h.globalAlpha=1),F},drawCloseIcon:function(P,w,N,L){var M=L.x,Q=L.y;w.strokeStyle=N,w.lineWidth=1,w.beginPath(),w.moveTo(M+2,Q+8),w.lineTo(M+8,Q+2),w.moveTo(M+8,Q+8),w.lineTo(M+2,Q+2),w.stroke()},getTabAt:function(m){var p=this._interactor._8Q(m);return p?p.tab:null},validateImpl:function(){var Q=this;Q._24o();var m,X=Q._canvas,v=Q._tabPosition,d=Q._91O,P=Q._92O,p=Q._tabModel,$=Q.getWidth(),e=Q.getHeight(),y=Q._tabHeight,C=Q._7o,S=Q._tabGap,M=v===Gh,J=v===Nh,O=v===He,x=v===Nh+"-vertical",n=v===He+"-vertical",V=Q._23o,L=0;if((J||O)&&p._roots.each(function(O){L=H(Q.getTabWidth(O),L)}),M?(Wp(d,0,0,$,y),m={x:0,y:y,width:$,height:H(0,e-y)}):J?(Wp(d,0,0,L,e),m={x:L,y:0,width:H(0,$-L),height:e}):O?(Wp(d,$-L,0,L,e),m={x:0,y:0,width:H(0,$-L),height:e}):x?(Wp(d,0,0,y,e),m={x:y,y:0,width:H(0,$-y),height:e}):n?(Wp(d,$-y,0,y,e),m={x:0,y:0,width:H(0,$-y),height:e}):(Wp(d,0,e-y,$,y),m={x:0,y:0,width:$,height:H(0,e-y)}),Wp(P,m),x||n){Q._9o&&(m.x=0,Wp(Q._8o.getView(),m)),vf(X,y,e);var k=Xl(X),U=0;if(Md(k,0,Q.ty(),1),k.clearRect(0,0,y,e),C.clear(),p._roots.each(function(X){if(X.isVisible()){var v,x=Q.getTabWidth(X);V&&V.tab===X||(v=Q.drawTab(k,X,0,U,y,x,Q._tabBackground)),C.add({_75o:v,tab:X,startY:U,endY:U+x,height:x}),U+=x+S}}),Q._23Q=H(0,U-S),V){var h=V.position;Q.drawTab(k,V.tab,0,V.startY,y,V.height,Q._moveBackground),sc(k,0,h,y,1,Q._insertColor)}if(k.restore(),Q._selectionChanged){Q._selectionChanged=!1;for(var o=Q.ty(),R=0;R<C.size();R++){var W=C.get(R);if(W.tab===Q._8o){if(W.endY+o<0){Q.ty(-W.startY);break}if(W.startY+o>e){Q.ty(e-W.endY);break}}}}Q.ty(Q.ty())}else if(J||O){Q._9o&&(m.x=0,Wp(Q._8o.getView(),m)),vf(X,L,e);var k=Xl(X),U=0;if(Md(k,0,Q.ty(),1),k.clearRect(0,0,L,e),C.clear(),p._roots.each(function(f){if(f.isVisible()){var h;V&&V.tab===f||(h=Q.drawTab(k,f,0,U,L,y,Q._tabBackground)),C.add({_75o:h,tab:f,startY:U,endY:U+y,height:y}),U+=y+S}}),Q._23Q=H(0,U-S),V){var h=V.position;Q.drawTab(k,V.tab,0,V.startY,L,V.height,Q._moveBackground),sc(k,0,h,L,1,Q._insertColor)}if(k.restore(),Q._selectionChanged){Q._selectionChanged=!1;for(var o=Q.ty(),R=0;R<C.size();R++){var W=C.get(R);if(W.tab===Q._8o){if(W.endY+o<0){Q.ty(-W.startY);break}if(W.startY+o>e){Q.ty(e-W.endY);break}}}}Q.ty(Q.ty())}else{Q._9o&&(m.y=0,Wp(Q._8o.getView(),m)),vf(X,$,y);var k=Xl(X),r=0;if(Md(k,Q.tx(),0,1),k.clearRect(0,0,$,y),C.clear(),p._roots.each(function(Z){if(Z.isVisible()){var g,F=Q.getTabWidth(Z);V&&V.tab===Z||(g=Q.drawTab(k,Z,r,0,F,y,Q._tabBackground)),C.add({_75o:g,tab:Z,startX:r,endX:r+F,width:F}),r+=F+S}}),Q._64I=H(0,r-S),V){var h=V.position;Q.drawTab(k,V.tab,V.startX,0,V.width,y,Q._moveBackground),hp(k,Q._insertColor,h,0,y)}if(k.restore(),Q._selectionChanged){Q._selectionChanged=!1;for(var c=Q.tx(),R=0;R<C.size();R++){var W=C.get(R);if(W.tab===Q._8o){if(W.endX+c<0){Q.tx(-W.startX);break}if(W.startX+c>$){Q.tx($-W.endX);break}}}}Q.tx(Q.tx())}for(var b=[],D=P.children,R=0;R<D.length;R++){var s=D[R],l=s._tab_;l&&!p.contains(l)&&b.push(s)}b.forEach(function(b){P.removeChild(b)})}});var no=function(G){this.tv=G,this.addListeners()};vo(no,I,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(s){this.handleScroll(s,10*(s.wheelDelta/40))},handle_DOMMouseScroll:function(_){this.handleScroll(_,10*-_.detail)},handleScroll:function(o,j){jm(o);var T=this.tv,R=T._tabPosition;!T._40o()||R!==Gh&&R!==Qc||T.tx(this.tv.tx()+j),!T._41o()||R!==Nh&&R!==He&&R!==Nh+"-vertical"&&R!==He+"-vertical"||T.ty(this.tv.ty()+j)},_8Q:function(e){var X,l,F=this.tv,m=F._tabPosition,C=F._7o;if(m===Gh||m===Qc){var f=F.lp(e).x;for(X=0;X<C.size();X++)if(l=C.get(X),l.startX<=f&&f<=l.endX)return l}else if(m===Nh||m===He||m===Nh+"-vertical"||m===He+"-vertical"){var E=F.lp(e).y;for(X=0;X<C.size();X++)if(l=C.get(X),l.startY<=E&&E<=l.endY)return l}return w},isClickable:function(A){var p=this.tv,n=p._tabPosition,s=this._73o=this._8Q(A);return!p._40o()||n!==Gh&&n!==Qc?!p._41o()||n!==Nh&&n!==He&&n!==Nh+"-vertical"&&n!==He+"-vertical"?s&&(!s.tab.isDisabled()||p.isMovable()):!0:!0},handle_mousemove:function(q){var N=this;Bb?N._74o=N._8Q(q):N.getView().style.cursor=N.isClickable(q)?_q:""},handle_mousedown:function(D){this.handle_mousemove(D),this.handle_touchstart(D)},handle_touchstart:function(g){var J=this,W=J.tv,K=W._tabPosition;jm(g),Lg(g)&&J.isClickable(g)&&(K===Gh||K===Qc?(J.x=Io(g).x,J.lp=W.lp(g),J.tx=W.tx()):(J.y=Io(g).y,J.lp=W.lp(g),J.ty=W.ty()),Yl(J,g))},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(x){var k,A=this,P=A.tv,f=P._tabPosition,s=A._73o;if(f===Gh||f===Qc){if(k=Io(x).x-A.x,!A._25o&&!A.moving&&l(k)>2&&(P._40o()&&!_n(x)?A._25o=1:s&&P.isMovable()&&(A.moving=1)),A._25o)P.tx(A.tx+k);else if(A.moving){var $=A.lp.x+k,y=P._tabGap/2;P._7o.each(function(o){var l=o.endX,O=$-o.startX<l-$;$>=o.startX&&l>=$&&P._7Q({tab:s.tab,startX:s.startX+k,width:s.width,front:O,insertTab:o.tab,position:O?H(0,o.startX-y):V(P._64I,l+y)})})}}else if(k=Io(x).y-A.y,!A._25o&&!A.moving&&l(k)>2&&(P._41o()&&!_n(x)?A._25o=1:s&&P.isMovable()&&(A.moving=1)),A._25o)P.ty(A.ty+k);else if(A.moving){var C=A.lp.y+k,y=P._tabGap/2;P._7o.each(function(z){var w=z.endY,d=C-z.startY<w-C;C>=z.startY&&w>=C&&P._7Q({tab:s.tab,startY:s.startY+k,height:s.height,front:d,insertTab:z.tab,position:d?H(0,z.startY-y):V(P._23Q,w+y)})})}},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(){var D=this,W=D.tv,Z=W._tabPosition,n=W.getTabModel(),i=n._roots,J=D._73o;if(D.moving){var k=W._23o;if(k&&k.insertTab!==k.tab){var s=k.tab,I=i.remove(s),j=i.indexOf(k.insertTab);j>=0&&(k.front||j++,j<=i.size()&&(i.add(s,j),n._38I(s,I,j)))}W._7Q(w),delete D.moving}else if(!D._25o&&J){s=J.tab;var E=D._74o;if(!E||E.tab===s)if(!s.isDisabled()&&gg(J._75o,D.lp)){var Q=function(){var p=i.indexOf(s);n.remove(s),W.onTabClosed(s,p)};W.onTabClosing(s,Q)&&Q()}else s.isDisabled()||W._8o===s||n.sm().ss(s)}D._25o=D._73o=D._74o=Z===Gh||Z===Qc?D.x=D.lp=D.tx=w:D.y=D.lp=D.ty=w}}),ee.PropertyView=function(r){var S=this;S._view=pf(1,S),S._canvas=$f(S._view),Pj(S._view,S._79O=xl()),S._rows=new Pb,S._28o=new Pb,S._26o={},S._26Q={};var o=S._propertyModel=new Ln,W=S.ivm;o.mm(W,S),o.md(W,S),o.mh(W,S),S.dm(r?r:new Ln),new ln(S)},Uo("PropertyView",I,{ms_ac:[Vh,_i,Fm,yd,To,"categorizable",Se,Nm,hj,hb,ef,Sj,ne,So,"selectRowIndex",Pf,"background",Pg,pe,Od,rl,ir],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Be,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:rs,_background:C.propertyViewBackground,_expandIcon:C.propertyViewExpandIcon,_collapseIcon:C.propertyViewCollapseIcon,_scrollBarColor:ui,_scrollBarSize:sp,_autoHideScrollBar:se,_selectBackground:C.propertyViewSelectBackground,_rowHeight:ao,_rowLineVisible:C.propertyViewRowLineVisible,_rowLineColor:C.propertyViewRowLineColor,_10I:.5,_columnLineVisible:C.propertyViewColumnLineVisible,_columnLineColor:C.propertyViewColumnLineColor,_labelColor:C.propertyViewLabelColor,_labelSelectColor:C.propertyViewLabelSelectColor,_labelFont:C.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(c){0>c&&(c=0),c>1&&(c=1);var P=this,X=P._10I;P._10I=c,P.fp("columnPosition",X,c)},getPropertyName:function(t){return t.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(M,o,K){return K===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(k,g){return g===this._selectRowIndex?this._labelSelectColor:k.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(N){var F=this.getHeight()-this._59I;return F>N&&(N=F),N>0?0:J(N)},isExpanded:function(j){if(!j)return!0;var n=this._26o[j];return n?n.isExpanded:!(this._26Q[j]===!1)},toggle:function(d){var R=this;R.isExpanded(d)?R.collapse(d):R.expand(d)},expandAll:function(){this.validate();for(var N in this._26o)this.expand(N)},expand:function(j){if(j&&j!==Dp){var h=this,k=h._26o[j];k&&!k.isExpanded&&(k.isExpanded=!0,h.onExpanded(j),h.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var $ in this._26o)this.collapse($)},collapse:function(Q){if(Q&&Q!==Dp){var I=this,j=I._26o[Q];j&&j.isExpanded&&(j.isExpanded=!1,I.onCollapsed(Q),I.ivm())}},onCollapsed:function(){},getCategoryName:function(P){if(!this.isCategorizable())return Dp;var W=P.getCategoryName();return W?W:Dp},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(D){var A=this,s=A._dataModel;s!==D&&(s&&(s.umd(A.handlePropertyChange,A),A._selectionModel||s.sm().ums(A.handleSelectionChange,A)),A._dataModel=D,D.md(A.handlePropertyChange,A),A._selectionModel?A._selectionModel._21I(D):D.sm().ms(A.handleSelectionChange,A),A.fp(sj,s,D))},isVisible:function(h){return this._visibleFunc?this._visibleFunc(h):!0},onPropertyChanged:function(g){var W=this,E=g.property;cn[E]?W.ivm():W.iv(),E===Lp&&W._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Hk},handlePropertyChange:function(W){this._27o===W.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var J=this;J._96I||(J.setSelectRowIndex(-1),J._96I=1,J.iv())},redraw:function(){this.iv()},validateModel:function(){var n=this,D=n._rows,Y=n._28o,M={},k=new Pb,O=n._27o;n.updateCurrentData(),O!==n._27o&&n.endEditing(),D.clear(),Y.clear(),n.getRawProperties().each(function($){if(n.isVisible($)){k.add($);var P=n.getCategoryName($);M[P]||(Y.add(P,P===Dp?0:i),M[P]={isExpanded:n.isExpanded(P),properties:new Pb})}}),n._sortFunc&&k.sort(n._sortFunc);for(var F in n._26o)n._26Q[F]=n.isExpanded(F);n._26o=M,Y.each(function($){$!==Dp&&D.add($);var A=M[$];A.isExpanded&&k.each(function(o){n.getCategoryName(o)===$&&(A.properties.add(o),D.add({property:o,data:n._27o}))},n)})},validateImpl:function(){var E=this;E._76o(),E._96I&&(E.validateModel(),delete E._96I);var S=E._canvas,i=E.getWidth(),z=E.getHeight(),G=-E.ty(),N=E._rowHeight,a=E._indent,O=i-a,g=E._rows,f=g.size(),v=E._9I=a+O*E._10I,C=E._59I=f*N;vf(S,i,z),E._29I={x:0,y:G,width:i,height:z},E._31I=p(G/N),E._14I=R((G+z)/N),E._31I<0&&(E._31I=0),E._14I>f&&(E._14I=f);var I,K=Xl(S),h=E._background;Md(K,0,-G,1),K.beginPath(),K.rect(0,G,i,z),K.clip(),K.clearRect(0,G,i,z),E._93db(K),h&&sc(K,0,0,a,C,h);for(var X=E._31I;X<E._14I;X++){var c=g.get(X),G=N*X;if(tq(c))h&&sc(K,a,G,O,N,h),I=Mf(E.isExpanded(c)?E._expandIcon:E._collapseIcon),I&&nd(K,I,te,0,G,a,N),K.save(),K.beginPath(),K.rect(a,G,O,N),K.clip(),E.drawCategoryName(K,c,X,a,G,O,N),K.restore();else{var F=c.property,A=c.data,I=Mf(F.getIcon()),y=E._selectRowIndex===X?E.getSelectBackground():w;if(I&&nd(K,I,te,0,G,a,N),y&&sc(K,a,G,O,N,y),K.save(),K.beginPath(),K.rect(a,G,v-a,N),K.clip(),E.drawPropertyName(K,F,X,a,G,v-a,N),K.restore(),!E.isEditing(A,F)){var _=v+1,t=i-v-1;K.save(),K.beginPath(),K.rect(_,G,t,N),K.clip(),E._87o(E.drawPropertyValue(K,F,E.getValue(A,F),X,_,G,t,N,A),X,_,G,t,N),K.restore()}}E._rowLineVisible&&sc(K,a,G+N-1,O,1,E._rowLineColor)}E._columnLineVisible&&(sc(K,v,0,1,C,E._columnLineColor),sc(K,i-1,0,1,C)),E._92db(K),E._93I(),K.restore(),E.ty(E.ty())},drawCategoryName:function(b,x,V,u,B,A,t){gb(b,x,this.getCategoryFont(x),this.getCategoryColor(x),u,B,A,t)},drawPropertyName:function(D,F,e,u,q,y,I){return F.drawPropertyName?(F.drawPropertyName(D,F,e,u,q,y,I,this),void 0):(gb(D,this.getPropertyName(F),this.getPropertyFont(F,e),this.getPropertyColor(F,e),u,q,y,I),void 0)},drawPropertyValue:function(_,N,c,q,P,s,H,Q,F){return N.drawPropertyValue?N.drawPropertyValue(_,N,c,q,P,s,H,Q,F,this):(Ub(_,c,N,this.getLabelFont(N,c,q),this.getLabelColor(N,c,q),P,s,H,Q,F,this),void 0)},isPropertyEditable:function(e){return e.isEditable()&&this.isEditable()},setProperties:function(y){this._propertyModel.clear(),this.addProperties(y)},addProperties:function(U){if(U){var u=this._propertyModel;U.forEach(function(B){if(!(B instanceof Dc)){var L=As(B.className);B=ep(L?L:Dc,B)}u.add(B)})}},getRowIndexAt:function(U){var e=this,d=p(e.lp(U).y/e._rowHeight);return d>=0&&d<e._rows.size()?d:-1},getPropertyAt:function(B){var C=this,M=C.getRowIndexAt(B);return M>=0?C._rows.get(M).property:w},getToolTip:function(b){var G=this,B=G.getPropertyAt(b),r=G._27o;return B&&r?B.getToolTip(r,G._9I<G.lp(b).x,G):w}});var ln=function(u){this.pv=u,this.addListeners()};vo(ln,I,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(e){this.getView().style.cursor=e},clear:function(){var B=this;B._62O=B.cp=B.ty=B.p=w,B.setCursor(fn)},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(Y){var w=this,H=w.pv;jm(Y),H.setFocus(Y)&&(Lg(Y)?(w.cp=Io(Y),w.ty=H.ty(),w.p=H.getColumnPosition(),w.handle_touchmove(Y)):H.setSelectRowIndex(H.getRowIndexAt(Y)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(g){var J=this;if(J.cp&&!J._62O){var A=J.pv,Y=A.lp(g),n=Y.x,$=Y.y,B=A._indent,I=A.getRowIndexAt(g),O=A._9I;if(I>=0){var Z=A._rowHeight,P=Z*I,v=A._rows.get(I),K=v.property;if(tq(v))Mf(A.isExpanded(v)?A._expandIcon:A._collapseIcon)&&n>=0&&B>=n&&$>=P&&P+Z>=$?A.toggle(v):Bo(g)&&A.toggle(v);else if(n>O&&A.isPropertyEditable(K,g)){var j={x:O+1,y:P,width:A.getWidth()-O-1,height:Z},z={x:j.x+A.tx(),y:j.y+A.ty(),width:j.width,height:j.height},C=0,w=A._29I;j.y<w.y?C=j.y-w.y:j.y+Z>w.y+w.height&&(C=j.y+Z-w.y-w.height),C&&(A.ty(A.ty()-C),z.y-=C),A.beginEditing({data:v.data,property:K,value:A.getValue(v.data,K),event:g,rect:j,editorRect:z,view:A})}}A.setSelectRowIndex(I)}J.clear()},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(m){var y=this,B=y.pv,Q=y.ty,p=y.cp,F=Io(m),V=y._62O;if("p"===V)B.setTranslateY(Q+F.y-p.y);else if("c"===V){var S=B.getWidth()-B._indent;if(S>16){var t=y.p-(p.x-F.x)/S,L=16/S;L>t&&(t=L),t>1-L&&(t=1-L),B.setColumnPosition(t)}}else"s"===V&&B.setTranslateY(Q+(p.y-F.y)*B._59I/B._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(T){if(!Bb&&Lg(T)){var K=this,O=K.pv,o=l(O.lp(T).x-O._9I)<=(ij?8:3);K.cp?K._62O||(o?(K._62O="c",Yl(K)):l(Io(T).y-K.cp.y)>=2&&(K._62O=K.isV(T)?"s":"p",Yl(K))):(o?K.setCursor(rb):K.setCursor(fn),K.isV(T)&&O._43o())}},isV:function(M){var S=this.pv,r=S._29I;return S._41o()&&r.x+r.width-S.lp(M).x<jk},handle_mousewheel:function(S){this.handleScroll(S,S.wheelDelta/40)},handle_DOMMouseScroll:function(u){2===u.axis&&this.handleScroll(u,-u.detail)},handleScroll:function(d,z){var L=this.pv;jm(d),L.endEditing(),L.translate(0,z*L.getRowHeight())},handle_keydown:function(e){var P=this.pv,i=P._rows.size(),J=P._selectRowIndex+(Oo(e)?-1:1);(Oo(e)||jn(e))&&(0>J&&(J=0),J>=i&&(J=i-1),P.setSelectRowIndex(J))}}),ee.ListView=function(s){this._5o(s),new oj(this)},Uo("ListView",I,{ms_ac:[Vh,_i,Fm,Pg,Se,pe,Od,Nm,hj,Sj,ne,So,Fi,Pf],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:rs,_rowHeight:ao,_rowLineVisible:C.listViewRowLineVisible,_rowLineColor:C.listViewRowLineColor,_scrollBarColor:ui,_scrollBarSize:sp,_autoMakeVisible:ac,_autoHideScrollBar:se,_selectBackground:C.listViewSelectBackground,_labelColor:C.listViewLabelColor,_labelSelectColor:C.listViewLabelSelectColor,_labelFont:C.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(A){var G=this,w=G._checkMode;G._checkMode=A,G.fp(di,w,A)},drawRow:function(G,h,c,D,R,A,S){var s=this,m=0,C=s._indent,_=s.getIconWidth(h);s.drawRowBackground(G,h,c,D,R,A,S),s._checkMode&&(ko(G,Mf(s.getCheckIcon(h)),m+C/2,R+S/2,h,s),m+=C),s.drawIcon(G,h,m,R,_,S),s.drawLabel(G,h,m+_,R,S)}});var oj=function(B){this.list=B,this._lastSelectDataTime=Vb(),this.addListeners()};
vo(oj,I,{ms_listener:1,getView:function(){return this.list._view},clear:function(H){var I=this,m=I.list;H&&"d"===I._62O&&!I.dragCancel&&m.handleDragAndDrop(H,"end"),m.draggingData&&(m.draggingData=null,m.redraw()),I.dragCancel=I._62O=I._isV=I._isH=I.cp=I.tx=I.ty=w},handle_mousedown:function(o){this.handle_touchstart(o)},handle_touchstart:function(E){var s=this,t=s.list;if(jm(E),t.setFocus(E)){var n=t.getDataAt(E);s.cp=Io(E),s.tx=t.tx(),s.ty=t.ty(),Lg(E)?n&&t.handleDragAndDrop&&!s.isV(E)&&!s.isH(E)&&(t.draggingData=n,t.redraw(),t.handleDragAndDrop(E,"prepare")):(n&&s._33o(E,n),s.clear(E))}},handleWindowMouseUp:function(r){this.clear(r)},handleWindowTouchEnd:function(Z){this.clear(Z)},handle_mouseup:function(Q){this.handle_touchend(Q)},handle_touchend:function(Y){var Q=this,U=Q.list;if(!Q._isV&&!Q._isH&&Q.cp&&!Q._62O){var p=U.getDataAt(Y);p?(U.isCheckMode()?Q._34o(Y,p):Q._33o(Y,p),Bo(Y)?U.onDataDoubleClicked(p,Y):U.onDataClicked(p,Y)):U.handleBackgroundClick(Y)}Q.clear(Y)},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(F){var f=this,m=f.list,N=f._62O,j=f.tx,h=f.ty,z=f.cp,K=Io(F),I=m._29I;"p"===N?m.setTranslate(j+K.x-z.x,h+K.y-z.y):"v"===N?m.ty(h+(z.y-K.y)*m._59I/I.height):"h"===N?m.tx(j+(z.x-K.x)*m._91I/I.width):"d"===N&&(f.dragCancel||m.handleDragAndDrop(F,"between"))},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(z){if(!Bb&&Lg(z)){var G=this,Q=G.list;if(G._isV=G.isV(z),G._isH=G.isH(z),G.cp){if(!G._62O){if(Sp(Io(z),G.cp)<2)return;G._isV?G._62O="v":G._isH?G._62O="h":Q.draggingData&&!this.dragCancel?(G._62O="d",Q.handleDragAndDrop(z,"begin")):G._62O="p",G._62O&&"d"!==G._62O&&Q.draggingData&&(Q.draggingData=null,Q.redraw()),Yl(G)}}else G._isV&&Q._43o(),G._isH&&Q._42o()}},isV:function(U){var t=this.list,_=t._29I;return t._41o()&&_.x+_.width-t.lp(U).x<jk},isH:function(A){var v=this.list,R=v._29I;return v._40o()&&R.y+R.height-v.lp(A).y<jk},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40,B.wheelDelta!==B.wheelDeltaX)},handle_DOMMouseScroll:function(H){this.handleScroll(H,-H.detail,1)},handleScroll:function(E,F,e){var t=this.list;jm(E),t.endEditing&&t.endEditing(),e&&t._41o()?t.translate(0,F*t.getRowHeight()):t._40o()&&t.translate(10*F,0)},handle_keydown:function(T){if(!C.isInput(T.target)){var m,g=this.list,t=g.sm(),L=g._rows,W=L.size();if(Bn(T))g.selectAll();else if(Po(T))g.handleDelete&&g.handleDelete(T);else if(Gr(T))"d"!==this._62O||this.dragCancel||(g.handleDragAndDrop(T,"cancel"),this.dragCancel=!0);else if(Dj(T))g.isCheckMode()&&(m=g.getFocusData(),m&&g.checkData(m));else if(Oo(T)||jn(T)){var D=g.isCheckMode();if(m=D?g.getFocusData():t.ld()){var f=g.getRowIndex(m);f>=0&&(Oo(T)?0!==f&&(m=L.get(f-1),D?g.setFocusData(m):t.ss(m)):f!==W-1&&(m=L.get(f+1),D?g.setFocusData(m):t.ss(m)))}else W>0&&(m=L.get(0),D?g.setFocusData(m):t.ss(m))}}},_34o:function(g,H){var G=this.list,w=G.lp(g).x;return w>=0&&w<=G._indent?(G.checkData(H),void 0):(G.setFocusData(H),void 0)},_33o:function(w,L){var H=this.list,v=H.sm(),X=v.ld();if(_n(w))H.isSelected(L)?v.rs(L):v.as(L);else if(Hh(w))if(X)for(var z=H.getRowIndex(X),V=H.getRowIndex(L);z!==V;)z+=V>z?1:-1,v.as(H._rows.get(z));else v.ss(L);else if(Lg(w)){var f=Vb();if(v.contains(L)){var $=f-this._lastSelectDataTime;H.handleDataDoubleSelect&&$>500&&1500>$&&H.handleDataDoubleSelect(w,L)}v.ss(L),this._lastSelectDataTime=f}else v.contains(L)||v.ss(L)}}),ee.TreeView=function(V){var G=this;G._35o(),G._5o(V),new Lq(G)},Uo("TreeView",I,{ms_ac:[Vh,_i,Fm,"rootVisible",di,"rootData",Nm,hj,Sj,ne,So,Se,Pg,pe,Od,hb,ef,Fi,Pf,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:w,_indent:rs,_rowHeight:ao,_rowLineVisible:C.treeViewRowLineVisible,_rowLineColor:C.treeViewRowLineColor,_scrollBarColor:ui,_scrollBarSize:sp,_autoHideScrollBar:se,_expandIcon:C.treeViewExpandIcon,_collapseIcon:C.treeViewCollapseIcon,_autoMakeVisible:ac,_selectBackground:C.treeViewSelectBackground,_labelColor:C.treeViewLabelColor,_labelSelectColor:C.treeViewLabelSelectColor,_labelFont:C.treeViewLabelFont,_doubleClickToToggle:C.treeViewDoubleClickToToggle,drawRow:function(Z,J,i,D,O,H,P){var Y=this;Y.drawRowBackground(Z,J,i,D,O,H,P),Y._97I(Z,J,i,0,O,H,P)},isOnToggleIcon:function(P){var X=this.getDataAt(P);if(X){var f=this.getIndent(),l=this.lp(P).x;if(Mf(this.getToggleIcon(X))){var w=f*this.getLevel(X);if(l>=w&&w+f>=l)return!0}}return!1}});var Lq=function(t){qj(Lq,this,[t])};vo(Lq,oj,{toggle:function(r,o,_,k){var V=this.list,R=V.lp(r).x;if(Mf(V.getToggleIcon(o))){var G=_*k;if(R>=G&&G+_>=R)return V.toggle(o),!0}return V.isDoubleClickToToggle()&&Bo(r)?(V.toggle(o),!0):!1},_34o:function(o,n){var b=this.list,O=b.lp(o).x,z=b._levelMap[n._id],B=b._indent,X=B*(z+1);return O>=X&&X+B>=O?(b.checkData(n),void 0):(this.toggle(o,n,B,z)||b.setFocusData(n),void 0)},_33o:function(u,W){var K=this,q=K.list;if(!K.toggle(u,W,q._indent,q.getLevel(W)))if(Hh(u)){var x=q.sm();if(x.size()>0){for(var Q=q._rows,d=null,m=0,Y=Q.size();Y>m;m++)if(q.isSelected(Q.get(m))){d=m;break}for(var p=null,m=Q.size()-1;m>=0;m--)if(q.isSelected(Q.get(m))){p=m;break}var G,L,X=q.getRowIndex(W);for(d>X?(G=X-1,L=d):X>p?(G=p,L=X):(G=d,L=p);G!==L;)G++,x.as(q._rows.get(G))}else x.ss(W)}else Lq.superClass._33o.call(K,u,W)},handle_keydown:function(B){if(tg(B)||od(B)){var g=this.list,Q=g._rows,c=g.isCheckMode(),p=g.sm(),m=c?g.getFocusData():p.ld();m?m.hasChildren()&&(tg(B)?g.collapse(m):g.expand(m)):Q.size()>0&&(m=Q.get(0),c?g.setFocusData(m):p.ss(m))}else Lq.superClass.handle_keydown.call(this,B)}});var qb=ee.TableView=function(x){this._98I(),this._5o(x),new Ug(this)};Uo("TableView",I,{ms_ac:[Vh,_i,Fm,"sortMode",yd,To,Pg,pe,Od,rl,ir,"sortColumn",Nm,hj,Sj,ne,So,Fi,Pf],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:fp,_editable:!0,_batchEditable:!1,_rowHeight:ao,_rowLineVisible:C.tableViewRowLineVisible,_rowLineColor:C.tableViewRowLineColor,_columnLineVisible:C.tableViewColumnLineVisible,_columnLineColor:C.tableViewColumnLineColor,_scrollBarColor:ui,_scrollBarSize:sp,_autoHideScrollBar:se,_autoMakeVisible:ac,_selectBackground:C.tableViewSelectBackground,_labelColor:C.tableViewLabelColor,_labelSelectColor:C.tableViewLabelSelectColor,_labelFont:C.tableViewLabelFont,getCheckColumn:function(){var E=this;if(!E._31o){var Q=E._31o=new pb;Q.setEditable(!0),Q.setWidth(40),Q.getValue=E.getCheckColumValue,Q.drawCell=E.drawCheckColumnCell}return E._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(I){var S=this,E=S._39o,F=S.getCheckColumn();I!==S.isCheckMode()&&(I?E.add(F,0):E.remove(F),S.fp(di,!I,I))},getCheckColumValue:function(u,k,G){return G.isSelected(u)},drawCheckColumnCell:function(k,L,J,f,n,C,x,M,p){ko(k,p.getCheckIcon(L),n+x/2,C+M/2,L,p)}});var Ug=function(L){qj(Ug,this,[L])};vo(Ug,oj,{_34o:function(I,z){var g=this.list,R=g._31o;if(g.isCellEditable(z,R,I)){var o=g._3Q(R),f=g.lp(I).x;if(o&&f>=o.startX&&f<o.startX+R.getWidth())return g.checkData(z),void 0}g._37O(z,I),g.setFocusData(z)},_33o:function(E,x){this.list._37O(x,E),Ug.superClass._33o.apply(this,arguments)}});var Vo=ee.TreeTableView=function(U){var v=this,r=v._4o=new pb;v._35o(),v._98I(),v._5o(U),r.setDisplayName("Name"),r.setEditable(!0),r.setWidth(180),r.drawCell=Mk,r.getValue=Cm,v._39o.add(r),new zb(v)},Mk=function(e,$,j,O,g,i,R,F,z){z._97I(e,$,j,g,i,R,F)},Cm=function(p,m,K){return K.getLabel(p)};Uo("TreeTableView",I,{ms_ac:[Vh,_i,Fm,"sortMode",yd,To,Se,di,"rootData","rootVisible",Nm,hj,"sortColumn",hb,ef,Sj,ne,So,Fi,Od,Pg,pe,rl,ir,Pf,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:fp,_checkMode:w,_editable:!0,_batchEditable:!1,_indent:rs,_rowHeight:ao,_rowLineVisible:C.treeTableViewRowLineVisible,_rowLineColor:C.treeTableViewRowLineColor,_columnLineVisible:C.treeTableViewColumnLineVisible,_columnLineColor:C.treeTableViewColumnLineColor,_expandIcon:C.treeTableViewExpandIcon,_collapseIcon:C.treeTableViewCollapseIcon,_scrollBarColor:ui,_scrollBarSize:sp,_autoHideScrollBar:se,_autoMakeVisible:ac,_selectBackground:C.treeTableViewSelectBackground,_labelColor:C.treeTableViewLabelColor,_labelSelectColor:C.treeTableViewLabelSelectColor,_labelFont:C.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var zb=function(h){qj(zb,this,[h])};vo(zb,oj,{_34o:function(g,b){var O=this.list,d=O._4o,c=O._3Q(d),C=O.lp(g).x;if(c){var E=O._indent,w=c.startX+E*O.getLevel(b);if(Mf(O.getToggleIcon(b))&&C>=w&&w+E>=C)return O.toggle(b),void 0;if(O.isCellEditable(b,d)&&(w+=E,C>=w&&w+E>=C))return O.checkData(b),void 0}O._37O(b,g),O.setFocusData(b)},_33o:function(Z,t){var r=this.list,p=r.lp(Z).x;if(Mf(r.getToggleIcon(t))){var S=r._3Q(r._4o);if(S){var M=r._indent,i=S.startX+M*r.getLevel(t);if(p>=i&&i+M>=p)return r.toggle(t),void 0}}r._37O(t,Z),zb.superClass._33o.apply(this,arguments)}});var Kp=ee.TableHeader=function(i){var W=this,r=W._view=pf(1,W),B=W._39o=i.getColumnModel(),t=W.iv;W.tv=W._tableView=i,W._60I=new Pb,W._canvas=$f(r),r.style.background=C.tableHeaderBackground||"",r.style.height=kr+Ih,B.mm(t,W),B.md(t,W),B.mh(t,W),i.mp(function(o){yn[o.property]&&W.iv()},W),new ic(W),W.iv()};Uo("TableHeader",I,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Vh,Fm,Se,"moveBackground","insertColor",rl,ir,"resizable","movable"],_checkIcon:_p,_movable:!0,_resizable:!0,_labelColor:C.tableHeaderLabelColor,_labelFont:C.tableHeaderLabelFont,_columnLineColor:C.tableHeaderColumnLineColor,_columnLineVisible:C.tableHeaderColumnLineVisible,_sortDescIcon:C.tableHeaderSortDescIcon,_sortAscIcon:C.tableHeaderSortAscIcon,_moveBackground:C.tableHeaderMoveBackground,_insertColor:C.tableHeaderInsertColor,_indent:rs,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Q){return Q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(J){return J.getColor()||this._labelColor},getLabelAlign:function(H){return H._align},onPropertyChanged:function(){this.iv()},_5Q:function(P){this._61I=P,this.iv()},getLogicalPoint:function(s){return ii(s,this._canvas,this.tv.tx())},validateImpl:function(){var E=this,g=E._canvas,T=E.getWidth(),k=E.getHeight(),F=E.tv,G=E._60I,O=E._61I,x=-F.tx(),$=0;(T!==g.clientWidth||k!==g.clientHeight)&&vf(g,T,k),G.clear(),E._39o._roots.each(function(v){if(v.isVisible()){var b=$+v.getWidth();x+T>=$&&b>=x&&G.add({column:v,startX:$}),$=b}});var L=Xl(g);if(Md(L,-x,0,1),L.beginPath(),L.rect(x,0,T,k),L.clip(),L.clearRect(x,0,T,k),G.each(function(v){var U=v.column,C=v.startX,x=U.getWidth();x>0&&(L.save(),L.beginPath(),L.rect(C,0,x,k),L.clip(),O&&O.column===U||E.drawColumn(L,U,C,0,x,k),E._columnLineVisible&&sc(L,C+x-1,0,1,k,E._columnLineColor),L.restore())}),O){var U=O.column,$=O.startX,o=O.position,r=U.getWidth();L.save(),L.beginPath(),L.rect($,0,r,k),L.clip(),L.fillStyle=E._moveBackground,L.fill(),E.drawColumn(L,U,$,0,r,k),L.restore(),hp(L,E._insertColor,o,0,k)}L.restore()},_6Q:function(c){var e=this.tv;return e._31o===c&&e.sm().getSelectionMode()===hi},drawColumn:function(X,t,h,B,$,z){var b=this,m=b.tv,j=Mf(t.getIcon()),f=b.getLabelAlign(t);if(b._6Q(t)){var k=Mf(b._checkIcon);ko(X,k,h+$/2,B+z/2,t,b)}else{var M=b.getLabel(t),K=b.getLabelFont(t),g=b.getLabelColor(t),q=Sk(K,M).width,w=j?b._indent:0;f===Nh?(j&&nd(X,j,te,h,B,w,z),gb(X,M,K,g,h+w,B,$,z,Nh)):f===He?(j&&nd(X,j,te,h+$-q-w,B,w,z),gb(X,M,K,g,h,B,$,z,He)):(j&&nd(X,j,te,h+($-q-w)/2,B,w,z),gb(X,M,K,g,h+($-q+w)/2,B,0,z,Nh))}if(t.isSortable()&&m.getSortColumn()===t&&(j=Mf(t.getSortOrder()===Fq?b._sortAscIcon:b._sortDescIcon))){var x=Xk(j,t)/2+2;ko(X,j,f===He?h+x:h+$-x,B+z/2,t,m)}}});var ic=function(r){var B=this;B.th=r,B.tv=r._tableView,B.addListeners()};vo(ic,I,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(g){this.getView().style.cursor=g},handle_mousemove:function(F){if(!Bb){var e=this;delete e._29o,e.setCursor(fn);for(var C=e.th,d=C._60I,K=C.lp(F).x,T=d.size()-1;T>=0;T--){var n=d.get(T),J=n.column,N=n.startX+J.getWidth();if(C.isResizable()&&l(N-K)<=(ij?10:3))return e._29o=n,e.setCursor(rb),void 0;K>n.startX&&N>K&&(e._29o=n),(J.isClickable()||J.isSortable()||C.isMovable()||e.tv.getCheckColumn&&J===e.tv.getCheckColumn())&&K>n.startX&&N>K&&e.setCursor(_q)}}},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(F){var T=this;jm(F),T.tv.endEditing(),T.handle_mousemove(F),T._29o&&(T.x=Io(F).x,T.lx=T.th.lp(F).x,T.w=T._29o.column.getWidth(),Yl(T,F))},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(B){var R=this,h=R.th,T=R.getView().style.cursor,t=R._29o,m=Io(B).x-R.x;if(R.resizing||R.moving||(T===rb?R.resizing=1:h.isMovable()&&T===_q&&l(m)>2&&(R.moving=1)),R.resizing)t.column.setWidth(R.w+m);else if(R.moving){var u=R.lx+m;h._60I.each(function(M){var e=M.startX,f=e+M.column.getWidth();if(u>=e&&f>=u){var d={column:t.column,startX:t.startX+m,front:f-u>u-e,insertColumn:M.column};d.position=d.front?e:f,h._5Q(d)}})}},_16Q:function(O,A){var q=this,b=q.tv,V=q.th,t=V._checkIcon;if(V._6Q(O)){var y=Mf(t),H=q.lx,L=O.getWidth(),P=Xk(y,O);if(H>=A+L/2-P&&A+L/2+P>=H){V.setCheckIcon(t===Yp?_p:Yp);var o=b.sm(),I=b._rows;return t===Yp?o.rs(I):o.ss(I),b.onCheckColumnClicked(O),!0}}return!1},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(G){var y=this,r=y.tv,q=y.th,j=y._29o;if(y.moving){var Q=q._61I;if(Q&&Q.insertColumn!==Q.column){var Z=Q.column,p=r.getColumnModel()._roots,n=p.remove(Z),d=p.indexOf(Q.insertColumn);d>=0&&(Q.front||d++,d<=p.size()&&(p.add(Z,d),r.getColumnModel()._38I(Z,n,d)))}q._5Q(w),delete y.moving}else if(!y.resizing&&j){Z=j.column;var f=q.lp(G).x,h=j.startX,k=!0;if(q.onColumnClicked){var F=q.onColumnClicked(Z,G,h);F===!1&&(k=!1)}if(k&&f>=h&&f<=h+Z.getWidth()&&!y._16Q(Z,h)){if(Z.isSortable()){var U=r.getSortMode(),X=Z.getSortOrder();U===fp?r.getSortColumn()===Z?(X===co&&r.setSortColumn(w),Z.setSortOrder(X===Fq?co:Fq)):r.setSortColumn(Z):"bistate"===U&&(r.getSortColumn()===Z?Z.setSortOrder(X===Fq?co:Fq):r.setSortColumn(Z))}r.onColumnClicked(Z,G,h)}}y._29o=y.resizing=y.x=y.lx=y.w=w}}),ee.TablePane=function(R){this.init(new qb(R))},Uo("TablePane",I,{ms_v:1,_44o:1}),ee.TreeTablePane=function(x){this.init(new Vo(x))},Uo("TreeTablePane",I,{ms_v:1,_44o:1}),ee.Toolbar=function(M){var z=this,$=z._view=pf(1,z),V=$.style;V.background=C.toolbarBackground||"",V.height=Rm+Ih,z._canvas=$f($),z._30o=new Pb,z._90I=new Pb,z.setItems(M||[]),$.handleGroupSelectedChanged=function(U){if(U.isSelected()){var I=U.getGroupId();null!=I&&z._items.forEach(function(c){var L=c.element;L&&L!==U&&L.setSelected&&L.getGroupId&&L.getGroupId()===I&&L.setSelected(!1)})}},new ek(z)},Uo("Toolbar",I,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[rr,Vh,Fm,_i,Pf,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:C.toolbarLabelColor,_labelSelectColor:C.toolbarLabelSelectColor,_labelFont:C.toolbarLabelFont,_selectBackground:C.toolbarSelectBackground,_itemGap:C.toolbarItemGap,_separatorColor:C.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(G){var T=this.getItemInfoAt(G);return T?T.item.toolTip:w},getLabelColor:function(h){return h&&h.selected&&h.type!==Yp&&h.type!==cl?this._labelSelectColor:this._labelColor},onPropertyChanged:function(x){this.iv(),x.property===rr&&this._items.forEach(function(r){op(r)})},redraw:function(){this.iv()},addItem:function(M,d){var z=this._items;d==w?z.push(M):z.splice(d,0,M),this.fp(rr,w,z)},removeItem:function(m){if(m)for(var U=this._items,V=0;V<U.length;V++)m===U[V]&&(U.splice(V,1),this.fp(rr,w,U))},removeItemById:function(e){if(e!=w)for(var A=this._items,b=0;b<A.length;b++)if(e===A[b].id){var D=A.splice(b,1)[0];return this.fp(rr,w,A),D}},getItemById:function(z){if(z!=w)for(var G=this._items,F=0;F<G.length;F++){var C=G[F];if(z===C.id)return C}},setItemVisible:function(d,W){var I=this.getItemById(d);I&&(I.visible=W)},getItemInfos:function(){return this._30o},getItemInfoAt:function(x){var g=this,y=0,J=g._30o,i=g.lp(x),C=i.x,$=i.y;if($>=0&&$<=g.getHeight())for(;y<J.size();y++){var Z=J.get(y);if(Z.startX<=C&&C<=Z.endX)return Z}return w},drawItem:function(I,q,O,p,M){if(q.visible===!1)return 0;if(Ad(q.visible)&&!q.visible())return 0;var B=this,J=q.disabled;J&&(I.globalAlpha=Uf);var o=B.drawItemImpl(I,q,O,p,M),R=B._itemGap;return J&&(I.globalAlpha=1),this._currentItem!==q||"separator"===q||q.separator===!0||q.unfocusable||Zh(I,B._separatorColor,O-R/2,0,o+R,p),o},drawItemImpl:function(m,L,G,_,A){var O=this,e=O._view,P=O._itemGap,i=_/2,c=L.type,g=L.element,b=L.label;tq(g)&&(b=g,g=w);var F,s=O.getLabelFont(L),S=O.getLabelColor(L),z=L.selected,U=Mf(L.icon),Q=Xk(U,L),x=0,u=Q+(b?Sk(s,b).width:0);if("separator"===L||L.separator===!0)return hp(m,O._separatorColor,G,_/4,i),1;if(g){U&&ko(m,U,G+Q/2,i,L,O),gb(m,b,s,S,G+Q,0,0,_);var q=Jg(g);A||O._90I.add(q),q.parentNode!==e&&Pj(e,q),g.iv&&g.iv(),g.validate&&g.validate();var Z=q.getBoundingClientRect(),t=Z.width,d=q.style;return vg(q),d.left=O.tx()+G+u+Ih,d.top=(_-Z.height)/2+Ih,u+t}return c===cl?F=Mf(z?Bs:bl):c===Yp&&(F=Mf(z?Yp:_p)),F?(x=Xk(F,L),ko(m,F,G+x/2,i,L,O),G+=x,u+=x):z&&sc(m,G-P/2,0,u+P,_,O.getSelectBackground(L)),U&&ko(m,U,G+Q/2,i,L,O),gb(m,b,s,S,G+Q,0,0,_),u},validateImpl:function(){var S=this,E=S._canvas,a=S.getWidth(),Z=S.getHeight(),c=S._30o,p=S._items;vf(E,a,Z);var g=Xl(E),l=S._itemGap,L=l/2;Md(g,S.tx(),0,1),g.clearRect(0,0,a,Z);var n=S._90I;S._90I=new Pb,c.clear(),p.forEach(function(k){var T=S.drawItem(g,k,L,Z);c.add({item:k,startX:L,endX:L+T,width:T}),T&&(L+=T+l)}),n.each(function(w){S._90I.contains(w)||ck(w)});var s=S._64I;S._64I=H(0,L),g.restore(),S._stickToRight?(S._65O=0,g=Xl(E),L=a-S._64I+l,Md(g,0,0,1),g.clearRect(0,0,a,Z),c.clear(),p.forEach(function(G){var X=S.drawItem(g,G,L,Z,!0);c.add({item:G,startX:L,endX:L+X,width:X}),X&&(L+=X+l)}),g.restore()):S.tx(S.tx()),s!==S._64I&&S.onSumWidthChanged(s,S._64I)},onSumWidthChanged:function(){},handleClick:function(p,M){var d=this,Y=p.type,c=p.action,a=p.groupId,Q=p.selected;p.disabled||(a!=w?Q||(p.selected=!0,this._items.forEach(function(K){K.groupId===a&&p!==K&&(K.selected=!1)}),c&&p.action(p,d,M)):Y===Yp||"toggle"===Y?(p.selected=!Q,c&&p.action(p,d,M)):c&&p.action(p,d,M)),yp(),d.iv()}});var ek=function(z){this.tb=z,this.addListeners()};vo(ek,I,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(G){this.handleScroll(G,10*(G.wheelDelta/40))},handle_DOMMouseScroll:function(c){this.handleScroll(c,10*-c.detail)},handleScroll:function(w,Y){jm(w);var O=this.tb;O.isScrollable()&&!O._stickToRight&&(O.tx(O.tx()+Y),Fc())},handle_mousemove:function(W){var y=this;Bb||y.setItem(W)},handle_mouseout:function(v){var t=this;v.target===t.getView()?t.tb.setCurrentItem(w):t.handle_mousemove(v)},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(z){var h=this,B=h.tb,s=z.target;Lg(z)&&(s===h.getView()||s===B._canvas)&&(jm(z),B.setFocus(z)&&(this.setItem(z,!0),(B.isScrollable()||h.info&&!h.info.item.disabled)&&(h.x=Io(z).x,h.tx=B.tx(),Yl(h,z))))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(w){var f=this,E=f.tb;if(!E._stickToRight){var D=Io(w).x-f.x;!f._25o&&l(D)>2&&E.isScrollable()&&(f._25o=1),f._25o&&E.tx(f.tx+D)}},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},handleWindowTouchEnd:function(H){var $=this,G=$.tb,i=$.info,T=$.tb.getItemInfoAt(H);if(!$._25o&&i){var d=i.item;T&&T.item===d&&G.handleClick(d,H)}$._25o=$.x=$.tx=w,$.setItem()},setItem:function(e,B){var g=this,b=g.tb,W=g.info=e?b.getItemInfoAt(e):w,I=W?W.item:w;b.setCurrentItem(I),B&&I&&Ad(I.onDown)&&I.onDown(e)}}),ee.BorderPane=function(){this._view=pf(1,this),this.iv()},Uo("BorderPane",I,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(V,v){this._12o("leftView",V),v!=w&&this.setLeftWidth(v)},getRightView:function(){return this._rightView},setRightView:function(D,x){this._12o("rightView",D),x!=w&&this.setRightWidth(x)},getTopView:function(){return this._topView},setTopView:function(j,B){this._12o("topView",j),B!=w&&this.setTopHeight(B)},getBottomView:function(){return this._bottomView},setBottomView:function(o,z){this._12o("bottomView",o),z!=w&&this.setBottomHeight(z)},getCenterView:function(){return this._centerView},setCenterView:function(J){this._12o("centerView",J)},_12o:function(E,P){var V=this,s="_"+E,T=V._view,k=V[s];k!==P&&(k&&(k.getView?ck(k.getView()):ck(k)),V[s]=P,P&&(P.getView?Pj(T,P.getView(),1):Pj(T,P,1)),V.fp(E,k,P))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var B=this,X=B._topView,L=B._bottomView,r=B._leftView,W=B._rightView,f=B._centerView,k=B.getWidth(),d=B.getHeight(),$=0,Y=0,y=k,V=d,s=0,q=0,Z=0,o=0;X&&(s=B._topHeight==w?um(X):B._topHeight,Y=s),L&&(q=B._bottomHeight==w?um(L):B._bottomHeight,V=d-q),r&&(Z=B._leftWidth==w?Xg(r):B._leftWidth,$=Z),W&&(o=B._rightWidth==w?Xg(W):B._rightWidth,y=k-o);var F=H(0,y-$),T=H(0,V-Y);X&&Wp(X,0,0,k,s),L&&Wp(L,0,V,k,q),r&&Wp(r,0,Y,Z,T),W&&Wp(W,y,Y,o,T),f&&Wp(f,$,Y,F,T)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);