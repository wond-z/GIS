!function(B,Y,Q){"use strict";function c(){this.el=[1,0,0,0,1,0,0,0,1]}function F(R){var d={};return{get:function(l){if(d[l]!==Q)return d[l];var T;switch(l){case"WEBGL_depth_texture":T=R.getExtension("WEBGL_depth_texture")||R.getExtension("MOZ_WEBGL_depth_texture")||R.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":T=R.getExtension("EXT_texture_filter_anisotropic")||R.getExtension("MOZ_EXT_texture_filter_anisotropic")||R.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":T=R.getExtension("WEBGL_compressed_texture_s3tc")||R.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||R.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":T=R.getExtension("WEBGL_compressed_texture_pvrtc")||R.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":T=R.getExtension("WEBGL_compressed_texture_etc1");break;default:T=R.getExtension(l)}return d[l]=T,T}}}function h(f,h,N){function o(){if(q!==Q)return q;var S=h.get("EXT_texture_filter_anisotropic");return q=null!==S?f.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function S(F){if("highp"===F){if(f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision>0)return"highp";F="mediump"}return"mediump"===F&&f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var q;N=N||{};var d="undefined"!=typeof WebGL2RenderingContext&&f instanceof WebGL2RenderingContext,j=N.precision!==Q?N.precision:"highp",l=S(j);l!==j&&(console.warn("WebGL:",j,"not supported, using",l,"instead."),j=l);var n=N.logarithmicDepthBuffer===!0,y=f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS),v=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS),K=f.getParameter(f.MAX_TEXTURE_SIZE),P=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),t=f.getParameter(f.MAX_VERTEX_ATTRIBS),$=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS),i=f.getParameter(f.MAX_VARYING_VECTORS),L=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS),U=v>0,Z=d||!!h.get("OES_texture_float"),w=U&&Z,V=d?f.getParameter(f.MAX_SAMPLES):0;return{getMaxAnisotropy:o,getMaxPrecision:S,precision:j,logarithmicDepthBuffer:n,maxTextures:y,maxVertexTextures:v,maxTextureSize:K,maxCubemapSize:P,maxAttributes:t,maxVertexUniforms:$,maxVaryings:i,maxFragmentUniforms:L,vertexTextures:U,floatFragmentTextures:Z,floatVertexTextures:w,maxSamples:V}}var Z="ht";if(!B[Z]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),B.performance&&B.performance.now||function(){var Q=Date.now();B.performance||(B.performance={}),B.performance.now=function(){return Date.now()-Q}}();for(var T=Date.now(),z=16,M=["ms","moz","webkit","o"],r=0;r<M.length&&!B.requestAnimationFrame;++r)B.requestAnimationFrame=B[M[r]+"RequestAnimationFrame"],B.cancelAnimationFrame=B[M[r]+"CancelAnimationFrame"]||B[M[r]+"CancelRequestAnimationFrame"];B.requestAnimationFrame||(B.requestAnimationFrame=function(j){var M=Date.now(),R=z+T-M;return 0>R&&(R=0),T=M,B.setTimeout(function(){T=Date.now(),j(performance.now())},R)}),B.cancelAnimationFrame||(B.cancelAnimationFrame=function(V){return B.clearTimeout(V)}),Y.assign===Q&&(Y.assign=function(W){if(W===Q||null===W)throw new TypeError("Cannot convert undefined or null to object");for(var a=Y(W),j=1;j<arguments.length;j++){var C=arguments[j];if(C!==Q&&null!==C)for(var k in C)Y.prototype.hasOwnProperty.call(C,k)&&(a[k]=C[k])}return a})}();var M=B.document,I=null,v=B[Z]={},m=B[Z+"config"],t=v.Default=m&&m.Default||{},q=v.Style=m&&m.Style||{},z=v.Attr=m&&m.Attr||{},j=v.Color=m&&m.Color||{},O=v.IsGetter=m&&m.IsGetter||{};!function(){var G=!1;try{var A=Y.defineProperty({},"passive",{get:function(){G=!0}});B.addEventListener("test",A,A),B.removeEventListener("test",A,A)}catch(Z){G=!1}t.passiveSupported=G}();var G,D,N,L,W=t.passiveSupported,o=t.eventListenerOptionsFalse=W?{passive:!1,capture:!1}:!1,f=t.eventListenerOptionsTrue=W?{passive:!1,capture:!0}:!0,J=function(w,Q,R,p){w.addEventListener(Q,R,p?f:o)},i=function(q,x,t,I){q.removeEventListener(x,t,I?f:o)},n=Math,U=n.round,e=n.floor,X=n.ceil,K=n.sqrt,P=n.max,r=n.min,H=n.abs,x=n.cos,w=n.acos,C=n.sin,p=n.pow,a=n.asin,k=n.PI,E=2*k,b=k/2,_=n.tan,$=n.atan2,s=n.random,A=n.log,d=!0,u=!1,R=B.parseInt||global.parseInt,T="2020-08-15",l=B.navigator?B.navigator.platform.indexOf("Win")>-1:!1,y=function(f){return f*f},V=B.setTimeout,S=B.clearTimeout,g=B.location,je=B.navigator?B.navigator.userAgent.toLowerCase():"",gg=function(o){return o.test(je)},bk=gg(/msie/),kf=gg(/msie/)||gg(/trident/),Vh=gg(/msie 10/),Km=gg(/edge/),vb=gg(/firefox/),me=gg(/mac/),Jm=t.isTouchable===Q?l?!1:M?"ontouchend"in M:!1:t.isTouchable,ho="default",Vo="single",fq="multiple",Tk="front",Mn="back",Hd="left",Np="right",hq="top",Ce="bottom",dn="center",Tm="eye",fc="middle",gd="east",vl="west",yp="north",rn="none",kh="px",sq="absolute",Gj="border",Uf="triangle",qn="rect",nj="circle",tf="cylinder",Oe="shape",Zh="items",En="normal",Wg="remove",qb="clear",Or="width",Pe="height",pp="ingroup",eb="check",Rp="uncheck",df="radio",Jp="radioOn",gf="radioOff",Ar="points",qs="values",Cj="series",Vk="body",Ef="label",fj="label2",vd="note",Lq="note2",kn="icons",Xc="labelFont",xm="labelColor",Mf="labelSelectColor",an="note.expanded",ch="note2.expanded",In="edge.expanded",Ie="edge.points",Cr="edge.type",rb="rotation",ui="hidden",wr="visible",np="tuv",Sl="no",Wn="draw",ks="select",Bs="currentSubGraph",Yo="selectBackground",Ik="autoMakeVisible",Ci="autoHideScrollBar",Ab="scrollBarColor",yd="scrollBarSize",zm="indent",rg="rowHeight",uf="columnLineColor",ig="rowLineColor",Dh="columnLineVisible",jo="rowLineVisible",Wi="visibleFunc",Yb="expandIcon",eq="collapseIcon",Oi="checkMode",yk="sortFunc",Jo="editable",Hl="batchEditable",xd="tristate",jd="asc",Un="desc",sp="position",Wq="elevation",nq="children",to="translateX",ai="translateY",gq="dataModel",Nf="maxSize",$g="state",ji="shape3d",Vf="shape3d.resolution",ij="shape3d.visible",ss="shape3d.from.visible",zg="shape3d.to.visible",Mp="shape3d.top.visible",sr="shape3d.bottom.visible",od="repeat.uv.length",Rf="serializeValue",vf="deserializeValue",qp="centerUniform",Do="uniform",fp="rgba(255,255,255,0)",re="style",Yk="attr",mg="field",un="string",mb="boolean",Fm="color",nb="int",hf="number",Cn="ew-resize",sj="ns-resize",im="pointer",Tr="auto",pj="mousedown",hs="mousemove",fl="mouseup",cm="mouseout",xg="touchstart",_l="touchmove",rp="touchend",Po="keydown",Dg="keyup",qr=["DOMMouseScroll","mousewheel"],uc=vb?qr[0]:qr[1],lm=Jm?[xg,_l,rp,Po,Dg,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Po,Dg,"keypress","input",pj,hs,fl,cm,uc,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Rr=I,Ze=I,xf=I,xl=fl.length,se=function(){xf&&(S(xf.timeout),xf=I)},jn=function(){xf&&zs(xf.e,xf.info)};B.addEventListener&&(Jm||(J(B,cm,function(){se()}),J(B,uc,function(){am()})),J(B,Dg,function(J){91===J.keyCode?Le={}:delete Le[J.keyCode]},!0),J(B,Po,function(v){Le[v.keyCode]=!0},!0),J(B,"blur",function(){Le={}}));var ug,lg,wd,db=0,ne=I,oj=function(O,K){var q=V(function(){delete ne[q],Gi(ne)&&(ne=I),O()},K);return q},ng=I,Cd=I,Aj={},xk={},oo={},Qr={},Nr={},Le={},Md={},dl={},De={},xp={},Mr=/.json$/,Ai=/^data:image\/svg\+xml/,On={},Cl=[],Bp={},ql=I,_r=I,rm=function(){},Xr=function(){throw"Oops!"},_h=[0,0,0],Xq={x:0,y:0,width:0,height:0},cg=I,ae=I,zp=I,gm=function(s,l){xk[s]=l,l&&l.comps&&!l.uuid&&(l.uuid=v.Math.generateUUID()),$i[s]&&(l.cacheRule=$i[s],delete $i[s])},Ub=function(e){ae&&!e._72O&&(zp||(zp={}),zp[e._72O=um()]=e),ug!=I?Hf()<.05&&L&&!lg&&(Dj=se):Dj=gj},zk=function(m,T,Y,g){ae||(ae={});var E=ae[m];if(E){if(E.url===T)return;E.image?(E.image.onload=rm,E.image.onerror=rm):E.request&&(E.request.onload=rm,E.request.onerror=rm)}if(Mr.test(T)){var x=new Mc;if(ae[m]={request:x,url:T},T=t.beforeLoadURL(T,m),T.data){var b=t.parse(T.data);Ld(m,b),t.handleImageLoaded(m,b)}else{x.onload=function(){if(200===this.status||0===this.status){var N=t.parse(x.getResponseText());Ld(m,N),t.handleImageLoaded(m,N)}else Ld(m,t.handleUnfoundImage(m,T)||I)},x.onerror=function(){Ld(m,t.handleUnfoundImage(m,T)||I)};var K={};K.url=encodeURI(T),K.sync=!1,x.send(K)}}else{var b=new Image;ae[m]={image:b,url:T},/^data:image/.test(T)||(T=t.beforeLoadURL(T,m),T=t.appendTimeStamp(T),T=encodeURI(T),b.crossOrigin=t.crossOrigin),t.convertImageSrc(T,function(B){kf&&(T.toLowerCase().indexOf(".svg")>0||Ai.test(T))?(M.body.appendChild(b),b.style.visibility="hidden",b.onload=function(){V(function(){if(Y&&(b.width=Y),g&&(b.height=g),!b.width||!b.height){var S=b.width||b.clientWidth,j=b.height||b.clientHeight;b.width=S,b.height=j}t.handleImageLoaded(m,b),Ld(m,b),M.body.removeChild(b),b.style.visibility=""},180)},b.onerror=function(){Ld(m,t.handleUnfoundImage(m,T)||I),M.body.removeChild(b),b.style.visibility=""}):(b.onload=function(){Y&&(b.width=Y),g&&(b.height=g),t.handleImageLoaded(m,b),Ld(m,b)},b.onerror=function(){Ld(m,t.handleUnfoundImage(m,T)||I)}),b.src=B})}},Ld=function(y,H){if(gm(y,H),delete ae[y],Gi(ae)&&(ae=I,zp)){for(var E in zp){var e=zp[E];e._2O&&e._2O[y]&&(e.deleteTexture(y),delete e._2O[y]),e.invalidateAll&&e.invalidateAll(Q,"imageLoaded",y),e.redraw&&e.redraw(),e.iv(),delete e._72O}zp=I}if(H&&zp)for(var E in zp){var e=zp[E];e.invalidateAll&&e.invalidateAll(Q,"imageLoading",y),e.redraw&&e.redraw(),e.iv()}},Fc=function(){return A=n&&Date,function(){return B.performance&&B.performance.now?B.performance.now():Date.now()}}(),hh=function(p,j,T){return{width:p,height:j,comps:Ad(T)?T:[T]}},Oq=function(k,j){return{type:nj,rect:[k,j,1.6,1.6],borderWidth:1,borderColor:Yc,gradient:pe,gradientColor:Mo,background:Yc}},Hi=function(k,o){return hh(16,16,{type:Uf,rect:[4,4,10,8],background:k,rotation:o?1.57:3.14})},nm=function(p,w){return hh(16,16,{type:Uf,rect:[4,4,8,7],background:p,rotation:w?3.14:0})},nl=function(u){var h=u._orientation;return"horizontal"===h||"h"===h},Hb=function(r,b){var s=I||4,t=I||1,_=I||1;0>s?s=0:s>.25&&(s=.25);var J,i,f,S,z,u,p,m=.5,N=[],L=[],Q=[],B=E/_,g=E/t,F=m-s;for(i=0;t>=i;i++)for(S=-k+i*g,u=x(S),z=C(S),J=0;_>=J;J++)f=J*B,p=F+s*u,N.push(x(f)*p,z*s,-C(f)*p),(D=[r,b])&&L.push(J/_,1-i/t);for(i=0;t>i;i++){var j=i*(_+1),Z=(i+1)*(_+1);for(J=0;_>J;J++)Q.push(j+J,Z+J+1,Z+J,j+J,j+J+1,Z+J+1),Mq.z=Go.z=[r,b]}},ic=function(V){var B=2,N=0;for(var Z in V)Z.length===B&&R(Z,32)===wk&&(ql=_r=V[Z]),N++;return N},Lk=function(k,S,R,_){return R||(R=Jm?5:3,R/=_||1),{x:k-R,y:S-R,width:2*R,height:2*R}},li=function(a,l,J,S){var O=this;l||(l=Jm?5:3,J=20,S=20);var q={x:a,y:l,width:J,height:S};if(J)for(var P=0;J>P;P++)if(3===J)S=20;else for(var f=0;S>f;f++)O=B?B:J;var n={x:k,y:2*k};if(Vl(q,n)){var r=Pe[0]+hq[0]+qb[1]+jd.length,E=ui[0]+xd[0]+qb[1]+Vk.length;en[Tm]=[O[r],O[E]],O[r]=Om[Tm],O[E]=Om[ji]}},lo=function(M){return(/ble$/.test(M)||/ed$/.test(M)||O[M]?"is":"get")+M.charAt(0).toUpperCase()+M.slice(1)},Om=function(E){return"set"+E.charAt(0).toUpperCase()+E.slice(1)},fh=function(d){return typeof d===un||d instanceof String},mm=function(e){return typeof e===hf},gj=function(q){return typeof q===mb},nd=function(Y){return Y&&"object"==typeof Y},qi=function(t){return"function"==typeof t},Ad=function(w){return w instanceof Array},Ii=function(f){return f instanceof up},Xp=function(N){return Ad(N)?new up(N):N},Fg=function(s){return s instanceof Mh},Xm=function(C){return C instanceof vr},Rn=function(l){return l instanceof fi},Uq=function(f,j){if(!(f instanceof v.Group))return!1;if(!j)return f.isExpanded();var N=j.getDataUI(f);return N&&N._88I?!0:!1},Gf=function(E){return E instanceof Ml},Lf=function(p){return p&&"IFRAME"===p.tagName},aj=function(S){return S==I||t.numberDigits==I?S:parseFloat(S.toFixed(t.numberDigits))},Se=function(m,z,V){var g,W=z.length;if(V)for(var i=0;V>i;i++)if(3===W)m.push(z[0]),m.push(z[1]),m.push(z[2]);else for(g=0;W>g;g++)m.push(z[g]);else if(3===W)m.push(z[0]),m.push(z[1]),m.push(z[2]);else for(g=0;W>g;g++)m.push(z[g])},Rc=function(G){return G?nd(G)?G:{}:!1},Fd=function(D,U,H){var W,c=nd(D)?D:D.prototype;for(W in U)H&&W in c?c[W]===Q&&console.warn("class",c,"has own undefined property",W,", keep exist!"):c[W]=U[W];return D},Im=function(i,o){if(!("wheelDelta"in o)){var f=o.deltaMode;o.wheelDelta=f===o.DOM_DELTA_PIXEL?-o.deltaY:f===o.DOM_DELTA_LINE?40*-o.deltaY:120*-o.deltaY}i.handle_mousewheel(o)},Xe=function(L){return String.fromCharCode(L)},Zc=function(W){for(var M,E=0,C="";E<W.length;E++)M=W[W.length-1-E],"%"===M?M="'":"a"===M?M='"':"]"===M&&(M="\\"),C+=Xe(M.charCodeAt(0)-1);return C},mj=function(p,B,L){p.superClass.constructor.apply(B,L)},Gi=function(j){for(var s in j)return!1;return!0},rl=function(F){return F?0===F.length:!0},Gr=function(){var r="";return[Rp[0],ig[0],Ef[0]].forEach(function(l){r+=Om(l).slice(3)}),Do=M&&M[r]||qp,function($,O){return $===O?!0:$.x===O.x&&$.y===O.y&&$.width===O.width&&$.height===O.height}}(),bd=function(O,v,y){return v>O?v:O>y?y:O},jg=function(q){return 0>q?-1:q>0?1:0},Hf=function(){var H=1e4*C(xl++);return H-e(H)},ti=function(Y,e,k){return Lr(Y.x,Y.y,e.x,e.y,k.x,k.y,k.x+k.width,k.y,!0)||Lr(Y.x,Y.y,e.x,e.y,k.x+k.width,k.y,k.x+k.width,k.y+k.height,!0)||Lr(Y.x,Y.y,e.x,e.y,k.x+k.width,k.y+k.height,k.x,k.y+k.height,!0)||Lr(Y.x,Y.y,e.x,e.y,k.x,k.y+k.height,k.x,k.y,!0)},Lr=function(M,k,C,B,S,V,T,c,$){var y=(T-S)*(k-V)-(c-V)*(M-S),D=(c-V)*(C-M)-(T-S)*(B-k);if(0!==D){var e=y/D,E=M+e*(C-M),X=k+e*(B-k);return $&&(E+Qq<r(M,C)||E-Qq>P(M,C)||E+Qq<r(S,T)||E-Qq>P(S,T)||X+Qq<r(k,B)||X-Qq>P(k,B)||X+Qq<r(V,c)||X-Qq>P(V,c))?I:[E,X]}return I},Lo=function(B,U,X){if(B&&X)if(U){if(U===re)return B.getStyle(X);if(U===Yk)return B.getAttr(X);if(U===mg)return B[X]}else if(X=lo(X),B[X])return B[X]();return Q},pc=function(O,s,v,N){if(O&&v)if(s){if(s===re)O.s(v,N);else if(s===Yk)O.a(v,N);else if(s===mg){var _=O[v];O[v]=N,O.fp("f:"+v,_,N)}}else v=Om(v),O[v]&&O[v](N)},ir=function(S,d,_){return d&&"top"!==d?"bottom"===d?{x:S.x,y:S.y,width:S.width,height:S.height*_}:"right"===d?{x:S.x,y:S.y,width:S.width*_,height:S.height}:"left"===d?{x:S.x+S.width*(1-_),y:S.y,width:S.width*_,height:S.height}:void 0:{x:S.x,y:S.y+S.height*(1-_),width:S.width,height:S.height*_}},tn=function(T,t,e,Z,l){t&&Xl(T,e,Z,1,l,t)},Kf=function(u,d,l,R){var v=1-u;return v*v*d+2*u*v*l+u*u*R},Mq=function(j,k,t,J,U){var K=1-j;return K*K*K*k+3*K*K*j*t+3*K*j*j*J+j*j*j*U},Jg=function(p){var m,c,u,b,i=0;return p.forEach(function(y){if(m=y.length,m>0)for(c=y[0],b=1;m>b;b++)u=y[b],i+=Oj(c,u),c=u}),i},bs=function(L,p,T){var B="__"+L,H=function(n){T.disabled||T["handle_"+L](n)};T[B]||(T[B]=H,J(p,L,H))},Um=function(W,k,C){var I="__"+W,G=C[I];G&&(i(k,W,G),delete C[I])},Gp=function(d,Y){var l="_"+Y;d[lo(Y)]=function(){return this[l]},d[Om(Y)]=function(a){var k=this[l];this[l]=a,this.fp(Y,k,a)}},rq=function(_){return Y.create(_)},Zm=function(k){if(!k.element){var F,B;(F=k.textField)?B=jq(xj.TextField,F):(F=k.textArea)?B=jq(xj.TextArea,F):(F=k.button)?B=jq(xj.Button,F):(F=k.comboBox)?B=jq(xj.ComboBox,F):(F=k.checkBox)?B=jq(xj.CheckBox,F):(F=k.radioButton)?B=jq(xj.RadioButton,F):(F=k.slider)?B=jq(xj.Slider,F):(F=k.colorPicker)?B=jq(xj.ColorPicker,F):(F=k.image)&&(B=jq(xj.Image,F)),B&&(k.element=B)}},Th=function(J,z){var b=Tj(J);return b._ht=z,b},Tj=function(g,C){var n=M.createElement("div"),L=n.style;return n.tabIndex=-1,n.onkeydown=Rg,L.msTouchAction=rn,dq(n,I,0),Jm&&L.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",I),g&&(L.overflow=ui),C&&Ig(C,n),n},Sg=function(V,j){var c=M.createElement("canvas"),k=c.style;return k.msTouchAction=rn,j||(k.pointerEvents=rn),dq(c,I,0),V&&Ig(V,c),c},dq=function(V,k,X){var y=V.style;y.border=k?k+" solid 1px":0,y.outline=0,y.padding=X?"0 "+X+kh:0,Fb(V)},Fb=function(Y){var X=Y.style;X.position=sq,X.margin=0,X.setProperty("box-sizing","border-box",I),X.setProperty("-moz-box-sizing","border-box",I)},sg=function(_,i,k,E){E||(E=Bh),i!=I&&(_.width=i*E,_.style.width=i+kh),k!=I&&(_.height=k*E,_.style.height=k+kh)},Ig=function(H,i,f){H.appendChild(i),f&&(i.style.position=sq)},fo=function(Z,R){R.split||(R+="");for(var N,I=R.split("\n"),P=0,e=I.length,U=0;e>U;U++){var p=Cg(Z.font,I[U]);p.width>P&&(P=p.width),N||(N=p.height)}return Z.ss=I,{width:P,height:N*e}},Dq=function(N,g,q,A,d,z){var n=g.length;if(1===n)Pi(N,g[0],q,A,d);else for(var j=q.height/n,r={x:q.x,y:q.y,width:q.width,height:j},W=0;W<g.length;W++)z?Ac(N,g[W],A,d,r.x,r.y,r.width,r.height,z):Pi(N,g[W],r,A,d),r.y+=j},Pi=function(d,b,w,n,L){d.font=n?n:nk,d.fillStyle=L?L:yl,d.textAlign=dn,d.textBaseline=fc;var M,f;w?w.width===Q?(M=w.x,f=w.y):(M=w.x+w.width/2,f=w.y+w.height/2):(M=0,f=0),d.fillText(b,U(M),U(f))},de=function(g){g.getView&&(g=g.getView());var D=g.offsetWidth||g.scrollWidth;return!D&&g.style.width&&(D=R(g.style.width)),D},co=function(v){v.getView&&(v=v.getView());var $=v.offsetHeight||v.scrollHeight;return!$&&v.style.height&&($=R(v.style.height)),$},$p=function(c,Q,H){var I=Q[0].toUpperCase()+Q.substring(1,Q.length);c["webkit"+I]=H,c["moz"+I]=H,c["ms"+I]=H,c["o"+I]=H,c[Q]=H},Vi=function(){var n=function(k){Rg(k),k.stopPropagation()},h=function(b){Rg(b)},Q=Jm?[xg]:[Po,pj];return function(q,U){var X=Tj(),Z=X.style;return Z.backgroundColor=t.disabledBackground,q&&(Z.backgroundImage="url("+q+")",Z.backgroundPosition="50% 50%",Z.backgroundRepeat="no-repeat no-repeat"),U===!1?Q.forEach(function(P){J(X,P,h)}):Q.forEach(function($){J(X,$,n)}),X}}(),Ye=function(k){var m=k.getContext("2d");return m.save(),m.lineCap=Og,m.lineJoin=Ul,m},Dj=function(O,f,J,q){nc(O,f*Bh,J*Bh),q*=Bh,1!==q&&O.scale(q,q)},nc=function(p,S,M){p.translate(S,M)},Ur=function(N,p){p&&N.rotate(p)},Rl=function(f,b,u){b===Q&&(b=1),u===Q&&(u=1),(1!==b||1!==u)&&f.scale(b,u)},hd=!1,$f=function(q){var f=M.activeElement;if(M.activeElement!==q){f&&f.forceOnblur&&f.forceOnblur();for(var S=[],w=q.parentNode;w;)S.push([w,w.scrollLeft,w.scrollTop]),w=w.parentNode;if(!hd){var I=[],L=[];try{for(var d=B.parent,a=B;d!==a;)I.push([d,d.scrollX,d.scrollY]),a=d,d=B.parent;var H=B.frameElement;if(H)for(var P=H.parentNode;P;)L.push([P,P.scrollLeft,P.scrollTop]),P=P.parentNode}catch(N){hd=!0}}if(Jm)q.focus();else{var x=Qb(),z=x.target;q.focus(),z.scrollLeft=x.left,z.scrollTop=x.top}S.forEach(function(T){T[0].scrollLeft=T[1],T[0].scrollTop=T[2]}),hd||(I.forEach(function(S){S[0].scrollTo(S[1],S[2])}),L.forEach(function(b){b[0].scrollLeft=b[1],b[0].scrollTop=b[2]}))}},mf=function(s){return s&&s.getView?s.getView():s},Op=function(V,G,j,h,P){if(2===arguments.length&&(j=G.y,h=G.width,P=G.height,G=G.x),V.isSelfViewEvent)V.setX(G),V.setY(j),V.setWidth(h),V.setHeight(P);else{var _=mf(V),e=_.style;if((M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)!==_)G!==Q&&(e.left=G+kh),j!==Q&&(e.top=j+kh),h!==Q&&(e.width=h+kh),P!==Q&&(e.height=P+kh);else{var s=t.getWindowInfo();e.left=(G=s.left)+kh,e.top=(j=s.top)+kh,e.width=(h=s.width)+kh,e.height=(P=s.height)+kh}V.endEditing&&!Jm&&V.endEditing(),V.redraw&&V.redraw(),V.invalidate&&V.invalidate(),V.onLayouted&&V.onLayouted(G,j,h,P),V.fireViewEvent&&V.fireViewEvent("layout")}},le=function(T){if(!T.touches)return T;var r=T.touches[0];return r?r:T.changedTouches[0]},vi=function(l){return Jm?le(l).target:l.target},lj=function(r){t.popup&&t.popup.close(),t.popup=r},_k=I,Yf=function(T){_k.handleWindowTouchMove(T)},Pk=function(M){_k.handleWindowTouchEnd(M),i(B,_l,Yf),i(B,rp,Pk),_k=I},vj=function(f){_k.handleWindowMouseMove(f)},Vq=function(M){_k.handleWindowMouseUp(M),i(B,hs,vj),i(B,fl,Vq),_k=I},vc=function(O){return 1===Em(O)},xe=function(V,f){return f?f.keyCode===V:Le[V]},Fq=function($){return Ic($)&&xe(65,$)},wq=function(g){return xe(46,g)||xe(8,g)},zi=function(W){return function(A){return A?A.keyCode===W:Le[W]}},wk=573,Tb=[65,83,68,87,37,38,39,40,32,13,27],Bi=zi(Tb[0]),Ud=zi(Tb[1]),qc=zi(Tb[2]),Iq=zi(Tb[3]),Zo=zi(Tb[4]),dk=zi(Tb[5]),ip=zi(Tb[6]),nr=zi(Tb[7]),vp=zi(Tb[8]),ih=zi(Tb[9]),uq=zi(Tb[10]),$e={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},mq=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,6163],sm=I,dp=I,qd=function(Y,z){sm||(sm=Sg()),sg(sm,Y,z,1);var U=Ye(sm);return U.clearRect(0,0,Y,z),U},Up=function(){var r,K={};for(var w in B){var t=fq.length;if(w.length==t&&w[0]===fq[2]&&w[1]===rn[1]&&w[4]===fq[3]&&w[5]===fq[4]&&w.substr(t-2)===rn[1]+rn[2]){var N=B[w];for(var A in N)A.length===t&&A.substr(0,3)===Np[3]+Wg[3]+ks[0]&&A.substr(t-2)===fq[0]+vd[3]&&(qr=N[A])}}return function(q){var O,f=K[q];return f||(r||(r=Sg(),sg(r,1,1,1)),O=r.getContext("2d"),O.clearRect(0,0,1,1),Xl(O,0,0,1,1,q),f=O.getImageData(0,0,1,1).data,f=K[q]=[f[0],f[1],f[2],f[3]]),f}}(),An=function(c){if(!fh(c))return c;var R=Up(c);return R.CA||(R.CA=[R[0]/255,R[1]/255,R[2]/255,R[3]/255]),R.CA},tp=function(y,W,G,r,n){var o=Sg();o.width=G,o.height=r;var s=o.getContext("2d");s.drawImage(y,0,0,G,r);try{for(var e=s.getImageData(0,0,G,r),j=e.data,T=0,O=j.length;O>T;T+=4){var $=j[T+0],l=j[T+1],X=j[T+2],h=j[T+3];"override_a"===n?j[T+3]=255*W[3]:"override_rgb"===n?(j[T+0]=255*W[0],j[T+1]=255*W[1],j[T+2]=255*W[2]):"override"===n?(j[T+0]=255*W[0],j[T+1]=255*W[1],j[T+2]=255*W[2],j[T+3]=255*W[3]):(j[T+0]=W[0]*$,j[T+1]=W[1]*l,j[T+2]=W[2]*X,j[T+3]=W[3]*h)}s.putImageData(e,0,0)}catch(F){return y}return o},en=function(s,p,x){return p&&(p="miter"===x?8*p+20:p+1,s&&tb(s,p)),p},oc=function(H,J){if(J){var f=new xs(J),j=H.width/2,W=H.height/2,i=Hj([f.tf(-j,-W),f.tf(j,-W),f.tf(j,W),f.tf(-j,W)]);return i.x+=H.x+j,i.y+=H.y+W,i}return H},el=function(w,v,D,U,Z,Q,d,u){U*=Math.PI/180;var R={x:Math.cos(U)*(w.x-d.x)/2+Math.sin(U)*(w.y-d.y)/2,y:-Math.sin(U)*(w.x-d.x)/2+Math.cos(U)*(w.y-d.y)/2},y=Math.pow(R.x,2)/Math.pow(v,2)+Math.pow(R.y,2)/Math.pow(D,2);y>1&&(v*=Math.sqrt(y),D*=Math.sqrt(y));var l=(Z==Q?-1:1)*Math.sqrt((Math.pow(v,2)*Math.pow(D,2)-Math.pow(v,2)*Math.pow(R.y,2)-Math.pow(D,2)*Math.pow(R.x,2))/(Math.pow(v,2)*Math.pow(R.y,2)+Math.pow(D,2)*Math.pow(R.x,2)));isNaN(l)&&(l=0);var e={x:l*v*R.y/D,y:l*-D*R.x/v},n={x:(w.x+d.x)/2+Math.cos(U)*e.x-Math.sin(U)*e.y,y:(w.y+d.y)/2+Math.sin(U)*e.x+Math.cos(U)*e.y},i=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2))},f=function(S,q){return(S[0]*q[0]+S[1]*q[1])/(i(S)*i(q))},A=function(H,q){return(H[0]*q[1]<H[1]*q[0]?-1:1)*Math.acos(f(H,q))},O=A([1,0],[(R.x-e.x)/v,(R.y-e.y)/D]),x=[(R.x-e.x)/v,(R.y-e.y)/D],$=[(-R.x-e.x)/v,(-R.y-e.y)/D],G=A(x,$);f(x,$)<=-1&&(G=Math.PI),f(x,$)>=1&&(G=0);var f=v>D?v:D,h=v>D?1:v/D,s=v>D?D/v:1;if(null==u){var H={x:0,y:0,width:0,height:0};tb(H,f),H.x*=h,H.width*=h,H.y*=s,H.height*=s;var t=new xs(U);return H=Hj([t.tf(H.x,H.y),t.tf(H.x+H.width,H.y),t.tf(H.x+H.width,H.y+H.height),t.tf(H.x,H.y+H.height)]),H.x+=n.x,H.y+=n.y,[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}u.translate(n.x,n.y),u.rotate(U),u.scale(h,s),u.arc(0,0,f,O,O+G,1-Q),u.scale(1/h,1/s),u.rotate(-U),u.translate(-n.x,-n.y)},Sh=function(x,w){x&&x.beginPath();for(var W,I,n,d=[],l=function(n){for(var H,i=/(\-{0,1}[\d\.]+)/gi,z=[];H=i.exec(n);)z.push(parseFloat(H[0]));return z},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,O={x:0,y:0};W=h.exec(w);){var u=W[0],S=u.substr(0,1);if("M"===S||"m"===S){for(var q=l(u),F=0;F<q.length;F+=2){var L=q[F],T=q[F+1];"m"===S&&(L+=O.x,T+=O.y),x&&x.moveTo(L,T),d.push({x:L,y:T}),O.x=L,O.y=T}I=n=null}else if("H"===S||"h"===S){for(var q=l(u),F=0;F<q.length;F+=1){var L=q[F];"h"===S&&(L+=O.x),x&&x.lineTo(L,O.y),d.push({x:L,y:O.y}),O.x=L}I=n=null}else if("C"===S||"c"===S){for(var q=l(u),F=0;F<q.length;F+=6){var D=q[F],P=q[F+1],k=q[F+2],M=q[F+3],L=q[F+4],T=q[F+5];"c"===S&&(D+=O.x,P+=O.y,k+=O.x,M+=O.y,L+=O.x,T+=O.y),x&&x.bezierCurveTo(D,P,k,M,L,T),d.push({x:D,y:P}),d.push({x:k,y:M}),d.push({x:L,y:T}),O.x=L,O.y=T}I=[D,P,k,M,L,T],n=null}else if("S"===S||"s"===S){for(var q=l(u),F=0;F<q.length;F+=4){var D,P;I?(D=2*I[4]-I[2],P=2*I[5]-I[3]):(D=O.x,P=O.y);var k=q[F],M=q[F+1],L=q[F+2],T=q[F+3];"s"===S&&(k+=O.x,M+=O.y,L+=O.x,T+=O.y),x&&x.bezierCurveTo(D,P,k,M,L,T),d.push({x:D,y:P}),d.push({x:k,y:M}),d.push({x:L,y:T}),O.x=L,O.y=T}I=[D,P,k,M,L,T],n=null}else if("Q"===S||"q"===S){for(var q=l(u),F=0;F<q.length;F+=4){var D=q[F],P=q[F+1],L=q[F+2],T=q[F+3];"q"===S&&(D+=O.x,P+=O.y,L+=O.x,T+=O.y),x&&x.quadraticCurveTo(D,P,L,T),d.push({x:D,y:P}),d.push({x:L,y:T}),O.x=L,O.y=T}I=null,n=[D,P,L,T]}else if("T"===S||"t"===S){for(var q=l(u),F=0;F<q.length;F+=2){var D,P;n?(D=2*n[2]-n[0],P=2*n[3]-n[1]):(D=O.x,P=O.y);var L=q[F],T=q[F+1];"t"===S&&(L+=O.x,T+=O.y),x&&x.quadraticCurveTo(D,P,L,T),d.push({x:D,y:P}),d.push({x:L,y:T}),O.x=L,O.y=T}I=null,n=[D,P,L,T]}else if("V"===S||"v"===S){for(var q=l(u),F=0;F<q.length;F+=1){var T=q[F];"v"===S&&(T+=O.y),x&&x.lineTo(O.x,T),d.push({x:O.x,y:T}),O.y=T}I=n=null}else if("L"===S||"l"===S){for(var q=l(u),F=0;F<q.length;F+=2){var L=q[F],T=q[F+1];"l"===S&&(L+=O.x,T+=O.y),x&&x.lineTo(L,T),d.push({x:L,y:T}),O.x=L,O.y=T}I=n=null}else if("A"===S||"a"===S){for(var q=l(u),F=0;F<q.length;F+=7){var Y=q[F],Z=q[F+1],f=q[F+2],V=q[F+3],b=q[F+4],L=q[F+5],T=q[F+6];"a"===S&&(L+=O.x,T+=O.y);var U=el(O,Y,Z,f,V,b,{x:L,y:T},x);U&&(d=d.concat(U)),O.x=L,O.y=T}I=n=null}var j=u.substr(u.length-1);("z"===j||"Z"===j)&&x&&x.closePath()}return d},Wo=function(Z,v){var P,o,y="L"===v[0],m=v.length;Z.save(),y?(Z.transform(v[5],v[6],v[7],v[8],v[9],v[10]),P=Z.createLinearGradient(v[1],v[2],v[3],v[4]),o=11):(Z.transform(v[7],v[8],v[9],v[10],v[11],v[12]),P=Z.createRadialGradient(v[1],v[2],v[3],v[4],v[5],v[6]),o=13);for(var D=Z.compGray;m>o;)P.addColorStop(v[o],D?t.toGrayColor(v[o+1]):v[o+1]),o+=2;Z.fillStyle=P},Go=function(A,b){var d=A.s("shape.gradient.pack");if(d){for(var D=d.length,P=new Array(D),H=0;D>H;H++)P[H]=d[H];var R,E,G,T,m,N,q,O,Y,a,g,t,s,$="L"===P[0];R=$?5:7,E=P[R],G=P[R+1],T=P[R+2],m=P[R+3],N=P[R+4],q=P[R+5],O=b[0],Y=b[1],a=b[2],g=b[3],t=b[4],s=b[5],P[R]=O*E+a*G,P[R+1]=Y*E+g*G,P[R+2]=O*T+a*m,P[R+3]=Y*T+g*m,P[R+4]=O*N+a*q+t,P[R+5]=Y*N+g*q+s,A.s("shape.gradient.pack",P)}},Hg=function(d,f,K,$){var U=!1;if(d.beginPath?d.beginPath():U=!0,Ii(f)&&(f=f._as),Ii(K)&&(K=K._as),K&&K.length){for(var O,T,N,P,i=0,C=0,Y=K.length;Y>C;C++)O=K[C],1===O?(T=f[i++],d.moveTo(T.x,U?-T.y:T.y)):2===O?(T=f[i++],d.lineTo(T.x,U?-T.y:T.y)):3===O?(T=f[i++],N=f[i++],d.quadraticCurveTo(T.x,U?-T.y:T.y,N.x,U?-N.y:N.y)):4===O?(T=f[i++],N=f[i++],P=f[i++],d.bezierCurveTo(T.x,U?-T.y:T.y,N.x,U?-N.y:N.y,P.x,U?-P.y:P.y)):5===O&&d.closePath();$&&5!==O&&d.closePath()}else{var p,G,R,Z=f.length;if(Z>0){for(p=f[0],d.moveTo(p.x,U?-p.y:p.y),G=1;Z>G;G++)R=f[G],d.lineTo(R.x,U?-R.y:R.y);$&&d.closePath()}}},wn=function(J,U,T,C){if(Ii(J)&&(J=J._as),Ii(U)&&(U=U._as),U&&U.length){T=T||Cb;for(var t,p,l,S,b,y,u,_,g=[],k=I,G=0,Z=0,F=U.length;F>Z;Z++)if(t=U[Z],1===t)g.push(k=[]),k.push(J[G++]);else if(2===t)k.push(J[G++]);else if(3===t){for(p=k[k.length-1],l=J[G++],S=J[G++],y=1;T>y;y++)u=Kf(y/T,p.x,l.x,S.x),_=Kf(y/T,p.y,l.y,S.y),k.push({x:u,y:_,b:!0});k.push(S)}else if(4===t){for(p=k[k.length-1],l=J[G++],S=J[G++],b=J[G++],y=1;T>y;y++)u=Mq(y/T,p.x,l.x,S.x,b.x),_=Mq(y/T,p.y,l.y,S.y,b.y),k.push({x:u,y:_,b:!0});k.push(b)}else 5===t&&k.push(k[0]);return C&&5!==t&&k&&k.length>2&&k.push(k[0]),g}return C&&J.length>2&&(J=J.slice(),J.push(J[0])),J?[J]:[]},Qo=function(D,L,J,n,H,q){var s,Z,$,O=Up(L),M=n,C=O[0],B=O[1],R=O[2];if(J){var W=Up(J);s=W[0]-C,Z=W[1]-B,$=W[2]-R}else s=255-C,Z=255-B,$=255-R;for(q||(q=n>10?1:.5,q=1>H?r(q/H,2):q),D.save(),D.shadowOffsetX=0,D.shadowOffsetY=0,D.shadowBlur=0,D.shadowColor=0;(n-=q)>0;){var z=1-n/M,u=C+s*z,j=B+Z*z,b=R+$*z;u=r(X(u),255),j=r(X(j),255),b=r(X(b),255),D.strokeStyle="rgb("+u+","+j+","+b+")",D.lineWidth=n,D.stroke()}D.restore()},lf=function(){var M={};return function(d,O){var g=d+"-"+O,c=M[g];if(c)return c;var f,Z,H,u=Up(d);return 0>O?(O=(100+O)/100,f=X(u[0]*O),Z=X(u[1]*O),H=X(u[2]*O)):(O/=100,f=u[0],Z=u[1],H=u[2],f+=(255-f)*O,Z+=(255-Z)*O,H+=(255-H)*O,f=r(X(f),255),Z=r(X(Z),255),H=r(X(H),255)),M[g]="rgb("+f+","+Z+","+H+")"}}(),Xl=function(n,M,S,h,D,E){E&&(n.fillStyle=E),n.beginPath(),n.rect(M,S,h,D),n.fill()},Fr=function(Z,R,l,s,W,F,y){Z.beginPath(),Jh[R](Z,l.x,l.y,l.width,l.height,s,W,F,y)},yh=function(P,D,K,g,z){var v=Jh[K];P.fillStyle=v?v(P,D,g?g:Mo,z.x,z.y,z.width,z.height):D},ko=function(P,s,b,H,l,n){try{if(!s.tagName&&s.comps){s._cacheImage_||(s._cacheImage_={});var K;K="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",s._cacheImage_[K]||(s._cacheImage_[K]={__count__:0});var Y=s._cacheImage_[K][b];Y||(s._cacheImage_[K].__count__>t.imageCacheThreshold&&(s._cacheImage_[K]={__count__:0}),Y=v.Default.toCanvas(s,vk(s),ns(s),null,l,n,b,null,H),s._cacheImage_[K][b]=Y,s._cacheImage_[K].__count__++),s=Y}P.fillStyle=P.createPattern(s,"repeat")}catch(W){P.fillStyle="black"}},Qc=function(t,y,G,x,b,n,$){t.save(),t.translate(y,G),t.scale(1,$/n),t.arc(0,0,n,x,b),t.restore()},Ak=function(r,D,l,B,K,N,V,a){var w,u,O,e,j,E,f,P,I,J,m;if(H(K)>2*k&&(K=2*k),j=X(H(K)/(k/4)),w=K/j,u=-w,O=-B,j>0){E=D+x(B)*N,f=l+C(-B)*V,a?r.lineTo(E,f):r.moveTo(E,f);for(var $=0;j>$;$++)O+=u,e=O-u/2,P=D+x(O)*N,I=l+C(O)*V,J=D+x(e)*(N/x(u/2)),m=l+C(e)*(V/x(u/2)),r.quadraticCurveTo(J,m,P,I)}},nf=function(A,L,z,R,O,$,t,P,H){6===arguments.length&&(t=$,P=$,H=$);var k=L+R,W=z+O,T=O>R?2*R:2*O;$=T>$?$:T,t=T>t?t:T,P=T>P?P:T,H=T>H?H:T;var V=.29*H,G=.58*H;A.moveTo(k,W-H),A.quadraticCurveTo(k,W-G,k-V,W-V),A.quadraticCurveTo(k-G,W,k-H,W),V=.29*P,G=.58*P,A.lineTo(L+P,W),A.quadraticCurveTo(L+G,W,L+V,W-V),A.quadraticCurveTo(L,W-G,L,W-P),V=.29*$,G=.58*$,A.lineTo(L,z+$),A.quadraticCurveTo(L,z+G,L+V,z+V),A.quadraticCurveTo(L+G,z,L+$,z),V=.29*t,G=.58*t,A.lineTo(k-t,z),A.quadraticCurveTo(k-G,z,k-V,z+V),A.quadraticCurveTo(k,z+G,k,z+t),A.lineTo(k,W-H)},_d=function(s,v,O,H,X,R,q){v&&(O=U(O),H=U(H),q||(q=1),s.fillStyle=v,s.beginPath(),s.rect(O,H,q,R),s.rect(O,H,X,q),R-q>0&&s.rect(O,H+R-q,X,q),X-q>0&&s.rect(O+X-q,H,q,R),s.fill())},Zq=function(o,F,I,i){var Q=i.x,s=i.y,v=i.width,y=i.height;if(!(!F||!I||0>=v||0>=y)){var f,K=Oo(F),q=Sc(F),O=I>0;1===I||-1===I?(o.fillStyle=O?K:q,o.beginPath(),o.rect(Q,s,1,y),o.rect(Q,s,v,1),o.fill(),o.fillStyle=O?q:K,o.beginPath(),o.rect(Q,s+y-1,v,1),o.rect(Q+v-1,s,1,y),o.fill()):(I=r(H(I),r(v/2,y/2)),f=o.createLinearGradient(Q,s,Q+I,s),f.addColorStop(0,O?K:q),f.addColorStop(1,F),o.fillStyle=f,o.beginPath(),o.moveTo(Q,s),o.lineTo(Q+I,s+I),o.lineTo(Q+I,s+y-I),o.lineTo(Q,s+y),o.lineTo(Q,s),o.fill(),f=o.createLinearGradient(Q,s,Q,s+I),f.addColorStop(0,O?K:q),f.addColorStop(1,F),o.fillStyle=f,o.beginPath(),o.moveTo(Q,s),o.lineTo(Q+I,s+I),o.lineTo(Q+v-I,s+I),o.lineTo(Q+v,s),o.lineTo(Q,s),o.fill(),f=o.createLinearGradient(Q,s+y,Q,s+y-I),f.addColorStop(0,O?q:K),f.addColorStop(1,F),o.fillStyle=f,o.beginPath(),o.moveTo(Q,s+y),o.lineTo(Q+I,s+y-I),o.lineTo(Q+v-I,s+y-I),o.lineTo(Q+v,s+y),o.lineTo(Q,s+y),o.fill(),f=o.createLinearGradient(Q+v,s,Q+v-I,s),f.addColorStop(0,O?q:K),f.addColorStop(1,F),o.fillStyle=f,o.beginPath(),o.moveTo(Q+v,s),o.lineTo(Q+v-I,s+I),o.lineTo(Q+v-I,s+y-I),o.lineTo(Q+v,s+y),o.lineTo(Q+v,s),o.fill())}},Cq=function(i,r,h,f,Q,Z,x){var w=i.createLinearGradient(f,Q,Z,x);return w.addColorStop(0,h),w.addColorStop(1,r),w},qg=function(N,J,$,I,q,c,R){var P=N.createLinearGradient(I,q,c,R);return P.addColorStop(0,J),P.addColorStop(.5,$),P.addColorStop(1,J),P},ec=function(V,H,E,L,c,s,l){var R=V.createLinearGradient(L,c,s,l);return R.addColorStop(0,H),R.addColorStop(1/3,E),R.addColorStop(2/3,H),R.addColorStop(1,E),R},tj=function(O,M,S,q,U,y,d,W,T){var f=O.createRadialGradient(q+y*W,U+d*T,r(y,d)/24,q+y/2,U+d/2,P(y,d)/2);return f.addColorStop(0,S),f.addColorStop(1,M),f},Rk=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Jh={polygon:function(s,B,e,Z,F,c){(c==I||3>c)&&(c=6);for(var O,d,J=r(Z,F)/2,h=B+Z/2,l=e+F/2,m=0,u=2*k/c,R=0;c>R;R++)O=h+x(m)*J,d=l+C(m)*J,0===R?s.moveTo(O,d):s.lineTo(O,d),m+=u;
s.closePath()},arc:function(u,R,p,W,S,O,m,T,f){O==I&&(O=k),m==I&&(m=E),T==I&&(T=!0);var C=R+W/2,b=p+S/2;T&&u.moveTo(C,b),f?Qc(u,C,b,O,m,W/2,S/2):u.arc(C,b,r(W,S)/2,O,m),T&&u.closePath()},rect:function(C,u,t,K,d){C.rect(u,t,K,d)},circle:function(T,x,C,p,K){T.arc(x+p/2,C+K/2,r(p,K)/2,0,E,!0)},oval:function(O,D,v,n,G){Qc(O,D+n/2,v+G/2,0,E,n/2,G/2)},roundRect:function(w,a,$,v,o,i){i==I&&(i=r(r(v,o)/4,8)),nf(w,a,$,v,o,i)},star:function(Q,i,m,h,X){var Y=2*h,S=2*X,u=i+h/2,a=m+X/2;Q.moveTo(u-Y/4,a-S/12),Q.lineTo(i+.306*h,m+.579*X),Q.lineTo(u-Y/6,a+S/4),Q.lineTo(i+h/2,m+.733*X),Q.lineTo(u+Y/6,a+S/4),Q.lineTo(i+.693*h,m+.579*X),Q.lineTo(u+Y/4,a-S/12),Q.lineTo(i+.611*h,m+.332*X),Q.lineTo(u+0,a-S/4),Q.lineTo(i+.388*h,m+.332*X),Q.closePath()},pentagram:function(w,O,r,R,a){var e=.5*a,c=O+.5*R,o=r+e,x=.5257311121191336*R;x>e&&(x=e);var s=Rk,$=0;for(w.moveTo(c+x*s[$++],o+x*s[$++]);20>$;)w.lineTo(c+x*s[$++],o+x*s[$++]);w.closePath()},triangle:function(o,Z,N,A,t){o.moveTo(Z+A/2,N),o.lineTo(Z+A,N+t),o.lineTo(Z,N+t),o.closePath()},hexagon:function(E,V,Q,L,I){E.moveTo(V,Q+I/2),E.lineTo(V+L/4,Q+I),E.lineTo(V+3*L/4,+Q+I),E.lineTo(V+L,Q+I/2),E.lineTo(V+3*L/4,Q),E.lineTo(V+L/4,Q),E.closePath()},pentagon:function(V,E,w,Y,J){var M=2*Y,p=2*J,j=E+Y/2,c=w+J/2;V.moveTo(j-M/4,c-p/12),V.lineTo(j-M/6,c+p/4),V.lineTo(j+M/6,c+p/4),V.lineTo(j+M/4,c-p/12),V.lineTo(j+0,c-p/4),V.closePath()},diamond:function(T,J,Q,R,B){T.moveTo(J+R/2,Q),T.lineTo(J,Q+B/2),T.lineTo(J+R/2,Q+B),T.lineTo(J+R,Q+B/2),T.closePath()},rightTriangle:function(O,V,N,Q,I){O.moveTo(V,N),O.lineTo(V+Q,N+I),O.lineTo(V,N+I),O.closePath()},parallelogram:function(L,v,P,r,E){var o=r/4;L.moveTo(v+o,P),L.lineTo(v+r,P),L.lineTo(v+r-o,P+E),L.lineTo(v,P+E),L.closePath()},trapezoid:function(e,Y,a,E,M){var T=E/4;e.moveTo(Y+T,a),e.lineTo(Y+E-T,a),e.lineTo(Y+E,a+M),e.lineTo(Y,a+M),e.closePath()},"linear.southwest":function(z,e,E,S,H,x,Z){return Cq(z,e,E,S,H+Z,S+x,H)},"linear.southeast":function(b,E,g,p,o,T,$){return Cq(b,E,g,p+T,o+$,p,o)},"linear.northwest":function(F,b,P,v,C,H,y){return Cq(F,b,P,v,C,v+H,C+y)},"linear.northeast":function(O,g,m,o,B,f,N){return Cq(O,g,m,o+f,B,o,B+N)},"linear.north":function(c,U,b,r,R,v,P){return Cq(c,U,b,r,R,r,R+P)},"linear.south":function(M,R,z,G,W,g,C){return Cq(M,R,z,G,W+C,G,W)},"linear.west":function(w,d,f,i,Y,K){return Cq(w,d,f,i,Y,i+K,Y)},"linear.east":function(v,C,A,x,Q,d){return Cq(v,C,A,x+d,Q,x,Q)},"radial.center":function($,A,u,N,V,T,C){return tj($,A,u,N,V,T,C,.5,.5)},"radial.southwest":function(i,S,G,m,D,g,X){return tj(i,S,G,m,D,g,X,.25,.75)},"radial.southeast":function(r,z,x,U,E,q,w){return tj(r,z,x,U,E,q,w,.75,.75)},"radial.northwest":function(f,I,j,s,z,K,b){return tj(f,I,j,s,z,K,b,.25,.25)},"radial.northeast":function(J,l,X,Y,N,r,E){return tj(J,l,X,Y,N,r,E,.75,.25)},"radial.north":function(m,C,B,P,X,M,_){return tj(m,C,B,P,X,M,_,.5,.25)},"radial.south":function(t,g,b,u,L,H,G){return tj(t,g,b,u,L,H,G,.5,.75)},"radial.west":function(d,j,m,k,V,n,x){return tj(d,j,m,k,V,n,x,.25,.5)},"radial.east":function(v,s,j,F,t,W,x){return tj(v,s,j,F,t,W,x,.75,.5)},"spread.horizontal":function(S,T,Y,x,k,c){return qg(S,T,Y,x,k,x+c,k)},"spread.vertical":function(u,E,e,k,Z,P,f){return qg(u,E,e,k,Z,k,Z+f)},"spread.diagonal":function(r,b,X,U,Y,u,F){return qg(r,b,X,U+u,Y,U,Y+F)},"spread.antidiagonal":function(U,B,h,c,F,q,y){return qg(U,B,h,c,F,c+q,F+y)},"spread.north":function(U,j,b,B,t,P,O){return ec(U,j,b,B,t-O/4,B,t+O+O/4)},"spread.south":function(Y,D,$,H,L,k,z){return ec(Y,$,D,H,L-z/4,H,L+z+z/4)},"spread.west":function(I,A,G,S,P,x){return ec(I,A,G,S-x/4,P,S+x+x/4,P)},"spread.east":function(F,D,H,c,d,x){return ec(F,H,D,c-x/4,d,c+x+x/4,d)}},$o=function(X,L,o){return new xs(X).tf(L,o)},Re=function(u){var B=u.touches[0],S=u.touches[1],W=B.clientX,v=B.clientY,Q=S.clientX,V=S.clientY;return K((W-Q)*(W-Q)+(v-V)*(v-V))},Hr=function(Y){var z=Y.touches[0],D=Y.touches[1],d=z.clientX,P=z.clientY,A=D.clientX,K=D.clientY;return{x:(d+A)/2,y:(P+K)/2}},nh=(function(){for(var s=0,n=Un.split(""),J=0;J<n.length;J++)s=10*R(n[J])+s;return Hb(B[wk.toString(8*J)+Ef.substr(J)+3],B[wk.toString(8*J)+Ef.substr(J)+4]),s}(),function(T,A,h){for(var w=0;w<h.size();w++){var E=h.get(w);T.co(E)&&A.add(E)}for(w=0;w<h.size();w++)E=h.get(w),nh(T,A,E._children)}),_j=function(t,N,H){for(var C=0;C<H.size();C++){var S=H.get(H.size()-1-C);t.co(S)&&N.add(S)}for(C=0;C<H.size();C++)S=H.get(C),_j(t,N,S._children)},mp=function(L,V,W){for(var b=!1,K=0;K<W.size();K++){var B=W.get(K);L.co(B)?b&&V.add(B):b=1}for(K=0;K<W.size();K++)B=W.get(K),mp(L,V,B._children)},Vc=function(I,K,V){for(var p=!1,r=0;r<V.size();r++){var d=V.get(V.size()-1-r);I.co(d)?p&&K.add(d):p=!0}for(r=0;r<V.size();r++)d=V.get(r),Vc(I,K,d._children)},Je=t.moveDatas=function(E,J,r,A){var p=A==I;if(0!==J||0!==r||!p&&0!==A){var N=!0,L=[];if(E.forEach(function($){N&&($._69O||Rn($)||Gf($))&&(N=!1)}),N)L=E;else{var D={},B={};E.forEach(function(r){D[r._id]=!0});var T={},l=function($){var x=$._id;return D[x]?(L.push($),T[x]=!0):T[x]=!1},o=function(X){var n=X._id;if(B[n])return l(X);var N=T[n];if(N!==Q)return N;var I=X._parent;if(I&&(Gf(I)||Rn(I))&&o(I))return T[n]=!0;var S=X._host;return S&&(B[n]=n,N=o(S),B[n]=Q,N)?T[n]=!0:l(X)};E.forEach(function(E){o(E)})}L.forEach(function(Z){if(Fg(Z))p?Z.translate(J,r):Z.translate3d(J,r,A);else{var K=Z.s(Ie);if(!K||K.isEmpty())return;var x=new up;K.each(function(B){B=Gk(B),p?(B.x+=J,B.y+=r):(B.x+=J,B.y+=A,B.e==I?B.e=r:B.e+=r),x.add(B)}),Z.s(Ie,x)}})}},Dm=function(){function u(A,s){return s===A.substring(0,s.length)?!0:!1}function S(W){return parseFloat(W)||0}function V(R,X){if(X==Q&&(X=new _i),u(R,"matrix3d")){var k=R.substring(9,R.length-1).split(",");k=k.map(S),X.fromArray(k)}else if(u(R,"matrix")){var k=R.substring(7,R.length-1).split(",");k=k.map(S),X.el[0]=k[0],X.el[1]=k[1],X.el[2]=0,X.el[3]=0,X.el[4]=k[2],X.el[5]=k[3],X.el[6]=0,X.el[7]=0,X.el[8]=0,X.el[9]=0,X.el[10]=1,X.el[11]=0,X.el[12]=k[4],X.el[13]=k[5],X.el[14]=0,X.el[15]=1}return X}function l(I,J){J==Q&&(J=new He);var C=I.split(/\s+/);return C=C.map(S),J.set(C[0]||0,C[1]||0,C[2]||0),J}var T,O,Z,a,$,y=function(Y,B){T||(T=new _i,O=new He,Z=new _i,a=new _i,$=new _i),B==Q&&(B=new _i);var i=getComputedStyle(Y);i.transform&&"none"!==i.transform&&(V(i.transform,T),l(i.transformOrigin,O),a.setPosition(O),O.negate(),$.setPosition(O),(kf||"preserve-3d"!==i.transformStyle)&&(T.el[8]=0,T.el[9]=0,T.el[10]=1,T.el[11]=0),B.multiplyMatrices($,B),B.multiplyMatrices(T,B),B.multiplyMatrices(a,B)),!kf&&i.perspective&&"none"!==i.perspective&&(Z.el[11]=-1/S(i.perspective),l(i.perspectiveOrigin,O),a.setPosition(O),O.negate(),$.setPosition(O),B.multiplyMatrices($,B),B.multiplyMatrices(Z,B),B.multiplyMatrices(a,B));for(var t=Y.offsetParent,k=Y.offsetLeft,I=Y.offsetTop,L=Y.parentElement;L&&L!==t;){var A=getComputedStyle(L);if("none"!==A.transform||"none"!==A.perspective)break;L=L.parentElement}return L==Q&&Y!==Y.ownerDocument.documentElement&&"fixed"!==i.position&&(L=Y.ownerDocument.documentElement),t!=Q&&t!==L&&(k-=L.offsetLeft,I-=L.offsetTop),O.set(k,I,0),a.setPosition(O),B.multiplyMatrices(a,B),L&&y(L,B),B};return function(h,w){var m=h.parentElement;if(m){var X=m.updateAppendMatrix;if(X){delete m.updateAppendMatrix;var M=new _i;y(m,M);var I=new _i;I.getInverse(M),m._matrixAppend=I,m._maxrixPreAppend=M}return w?m._matrixAppend:m._maxrixPreAppend}}}(),Bj=function(B,z){for(;B&&!B.hasOwnProperty(z);)B=Y.getPrototypeOf(B);return B&&Y.getOwnPropertyDescriptor(B,z)},Rj=Y.getPrototypeOf?function(b,A,l){var D=Bj(A,l);D&&Y.defineProperty(b,l,D)}:function(s,l,c){s[c]=l[c]},Bk={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ke=function(){var V={1:function(w,m){return{x:w.x-m.width/2,y:w.y-m.height/2}},2:function(M,P){return{x:M.x+P.width/2,y:M.y-P.height/2}},3:function(g,z){return{x:g.x+g.width/2,y:g.y-z.height/2}},4:function(_,m){return{x:_.x+_.width-m.width/2,y:_.y-m.height/2}},5:function(_,u){return{x:_.x+_.width+u.width/2,y:_.y-u.height/2}},6:function(T){return{x:T.x,y:T.y}},7:function(t){return{x:t.x+t.width/2,y:t.y}},8:function(y){return{x:y.x+y.width,y:y.y}},9:function(J,N){return{x:J.x-N.width/2,y:J.y+N.height/2}},10:function(G,j){return{x:G.x+j.width/2,y:G.y+j.height/2}},11:function(Y,f){return{x:Y.x+Y.width/2,y:Y.y+f.height/2}},12:function(N,P){return{x:N.x-P.width/2+N.width,y:N.y+P.height/2}},13:function(D,q){return{x:D.x+D.width+q.width/2,y:D.y+q.height/2}},14:function(Q,a){return{x:Q.x-a.width/2,y:Q.y+Q.height/2}},15:function(E){return{x:E.x,y:E.y+E.height/2}},16:function(E,f){return{x:E.x+f.width/2,y:E.y+E.height/2}},17:function(N){return{x:N.x+N.width/2,y:N.y+N.height/2}},18:function(o,E){return{x:o.x+o.width-E.width/2,y:o.y+o.height/2}},19:function(h){return{x:h.x+h.width,y:h.y+h.height/2}},20:function(C,v){return{x:C.x+C.width+v.width/2,y:C.y+C.height/2}},21:function(d,P){return{x:d.x-P.width/2,y:d.y+d.height-P.height/2}},22:function(j,q){return{x:j.x+q.width/2,y:j.y+j.height-q.height/2}},23:function(r,X){return{x:r.x+r.width/2,y:r.y+r.height-X.height/2}},24:function(L,$){return{x:L.x+L.width-$.width/2,y:L.y+L.height-$.height/2}},25:function(r,N){return{x:r.x+r.width+N.width/2,y:r.y+r.height-N.height/2}},26:function(F){return{x:F.x,y:F.y+F.height}},27:function(o){return{x:o.x+o.width/2,y:o.y+o.height}},28:function(C){return{x:C.x+C.width,y:C.y+C.height}},29:function(B,R){return{x:B.x-R.width/2,y:B.y+B.height+R.height/2}},30:function(b,L){return{x:b.x+L.width/2,y:b.y+b.height+L.height/2}},31:function(J,d){return{x:J.x+J.width/2,y:J.y+J.height+d.height/2}},32:function(H,O){return{x:H.x+H.width-O.width/2,y:H.y+H.height+O.height/2}},33:function(i,L){return{x:i.x+i.width+L.width/2,y:i.y+i.height+L.height/2}},34:function(y,u){return{x:y.x,y:y.y-u.height/2}},35:function(O,G){return{x:O.x+O.width,y:O.y-G.height/2}},36:function(G,m){return{x:G.x,y:G.y+G.height+m.height/2}},37:function(i,V){return{x:i.x+i.width,y:i.y+i.height+V.height/2}},38:function(K,B){return{x:K.x+K.width/4,y:K.y-B.height/2}},39:function(V,d){return{x:V.x+3*V.width/4,y:V.y-d.height/2}},40:function(Z){return{x:Z.x+Z.width/4,y:Z.y}},41:function(m){return{x:m.x+3*m.width/4,y:m.y}},42:function(f,P){return{x:f.x+f.width/4,y:f.y+P.height/2}},43:function(y,Q){return{x:y.x+3*y.width/4,y:y.y+Q.height/2}},44:function(j,k){return{x:j.x+j.width/2,y:j.y+j.height/2-k.height/2}},45:function(E){return{x:E.x+E.width/4,y:E.y+E.height/2}},46:function(A,D){return{x:A.x+A.width/2-D.width/2,y:A.y+A.height/2}},47:function(a,m){return{x:a.x+a.width/2+m.width/2,y:a.y+a.height/2}},48:function(I){return{x:I.x+3*I.width/4,y:I.y+I.height/2}},49:function(g,D){return{x:g.x+g.width/2,y:g.y+g.height/2+D.height/2}},50:function(u,N){return{x:u.x+u.width/4,y:u.y+u.height-N.height/2}},51:function(u,D){return{x:u.x+3*u.width/4,y:u.y+u.height-D.height/2}},52:function(w){return{x:w.x+w.width/4,y:w.y+w.height}},53:function(K){return{x:K.x+3*K.width/4,y:K.y+K.height}},54:function(N,X){return{x:N.x+N.width/4,y:N.y+N.height+X.height/2}},55:function(B,R){return{x:B.x+3*B.width/4,y:B.y+B.height+R.height/2}}};return ic(B)?function(w,Z,y){return V[w](Z,y?y:Xq)}:void 0}();Fd(j,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var fk=j.reverse,ci=j.transparent,qf=j.rectSelectBackground,th=j.dash,Kl=j.titleBackground,Ue=j.titleIconBackground,oe=j.headerBackground,ub=j.headerIconBackground,ao=j.headerSeparator,Jl=j.headerLine,fs=j.contentIconBackground,uo=j.contentLine,lc=(j.widgetIconHighlight,j.widgetIconBorder),Yc=(j.widgetIconGradient,j.imageBackground),Mo=j.imageGradient,ps=j.highlight,zq=j.label,Uj=j.labelSelect;if(T&&!B.shutAlert1){var Bg=new Date,Oh=T.split("-"),fe=new Date(Bg.getFullYear(),Bg.getMonth(),Bg.getDate()),T=new Date(R(Oh[0],10),R(Oh[1],10)-1,R(Oh[2],10)),kp=fe.getTime(),so=T.getTime(),Bm=Z+"_try",rr=B.alert;try{var cs=B.localStorage;if(cs&&rr)if(so>kp&&1728e6>so-kp){var Dp=(so-kp)/864e5;cs&&cs[Bm]!=Dp&&(cs[Bm]=Dp,B.htWillExpire?rr(B.htWillExpire.replace("{{day}}",Dp)):rr("HT for Web free trial license will expire in "+Dp+" days, please apply for a new license!"))}else kp>=so&&(B.htExpired?rr(B.htExpired):rr("Your free trial of HT for Web has expired!")),cs&&delete cs[Bm]}catch(is){}}Math.sign===Q&&(Math.sign=function(B){return 0>B?-1:B>0?1:+B});var Yr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",tk={encode:function(B,X){var s,x,d,U,C,K,n,$="",L=0;for(B=tk._utf8_encode(B);L<B.length;)s=B.charCodeAt(L++),x=B.charCodeAt(L++),d=B.charCodeAt(L++),U=s>>2,C=(3&s)<<4|x>>4,K=(15&x)<<2|d>>6,n=63&d,isNaN(x)?K=n=64:isNaN(d)&&(n=64),$=$+X.charAt(U)+X.charAt(C)+X.charAt(K)+X.charAt(n);return $},decode:function(s,e){var n,a,I,u,H,T,C,K="",$=0;for(s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");$<s.length;)u=e.indexOf(s.charAt($++)),H=e.indexOf(s.charAt($++)),T=e.indexOf(s.charAt($++)),C=e.indexOf(s.charAt($++)),n=u<<2|H>>4,a=(15&H)<<4|T>>2,I=(3&T)<<6|C,K+=String.fromCharCode(n),64!=T&&(K+=String.fromCharCode(a)),64!=C&&(K+=String.fromCharCode(I));return K=tk._utf8_decode(K)},_utf8_encode:function(E){E=E.replace(/\r\n/g,"\n");for(var U="",q=0;q<E.length;q++){var R=E.charCodeAt(q);128>R?U+=String.fromCharCode(R):R>127&&2048>R?(U+=String.fromCharCode(192|R>>6),U+=String.fromCharCode(128|63&R)):(U+=String.fromCharCode(224|R>>12),U+=String.fromCharCode(128|63&R>>6),U+=String.fromCharCode(128|63&R))}return U},_utf8_decode:function($){for(var O="",n=0,X=0,q=0,f=0;n<$.length;)X=$.charCodeAt(n),128>X?(O+=String.fromCharCode(X),n++):X>191&&224>X?(q=$.charCodeAt(n+1),O+=String.fromCharCode((31&X)<<6|63&q),n+=2):(q=$.charCodeAt(n+1),f=$.charCodeAt(n+2),O+=String.fromCharCode((15&X)<<12|(63&q)<<6|63&f),n+=3);return O}},Wk=[],vn=[],Qg=v.Math={generateUUID:function(){for(var J=[],k=0;256>k;k++)J[k]=(16>k?"0":"")+k.toString(16).toUpperCase();return function(){var H=0|4294967295*Math.random(),e=0|4294967295*Math.random(),b=0|4294967295*Math.random(),y=0|4294967295*Math.random();return J[255&H]+J[255&H>>8]+J[255&H>>16]+J[255&H>>24]+"-"+J[255&e]+J[255&e>>8]+"-"+J[64|15&e>>16]+J[255&e>>24]+"-"+J[128|63&b]+J[255&b>>8]+"-"+J[255&b>>16]+J[255&b>>24]+J[255&y]+J[255&y>>8]+J[255&y>>16]+J[255&y>>24]}}(),clamp:function(Y,t,D){return Math.max(t,Math.min(D,Y))},generateIncreasingID:function(){var o=0;return function(){return++o}}(),encodeBase64:function(l,z){return tk.encode(l,z||Yr)},decodeBase64:function(n,w){return tk.decode(n,w||Yr)},randomArray:function(w,Z){Z=Z||w.length;for(var e=Z-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),N=w[e];w[e]=w[n],w[n]=N}return w},isPOT:function(B){return B>0&&0===(B-1&B)},nearestPOT:function(h){if(!h)return 1;var M=h;M--,M|=M>>1,M|=M>>2,M|=M>>4,M|=M>>8,M|=M>>16,M++;var i=M>>1;return h-i>M-h?M:i},requestMatrix4:function(){return Wk.length>0?Wk.pop():new Qg.Matrix4},releaseMatrix4:function(H){Wk.push(H)},requestVector3:function(){return vn.length>0?vn.pop():new Qg.Vector3},releaseVector3:function(p){vn.push(p)}},As=v.Matrix=v.Math.Matrix2d=function(d,v,a,o,Q){this.setFromTransform(d,v,a,o,Q)},xs=As;As.prototype={},As.prototype.constructor=As,As.prototype.set=function(a,W,w,d,N,c){return this.a=a,this.b=W,this.c=w,this.d=d,this.tx=N,this.ty=c,this},As.prototype.setFromTransform=function(j,V,M,e,y){var o=this;if(j===Q)return o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0,void 0;j=j||0;var q=C(j),t=x(j);return e=e||1,y=y||1,o.a=t*e,o.b=q*e,o.c=-q*y,o.d=t*y,o.tx=V||0,o.ty=M||0,o},As.prototype.apply=function(z,q){q=q||new xi;var h=z.x,k=z.y;return q.x=this.a*h+this.c*k+this.tx,q.y=this.b*h+this.d*k+this.ty,q},As.prototype.applyInverse=function(O,p){p=p||new xi;var c=1/(this.a*this.d+this.c*-this.b),m=O.x,v=O.y;return p.x=this.d*c*m+-this.c*c*v+(this.ty*this.c-this.tx*this.d)*c,p.y=this.a*c*v+-this.b*c*m+(-this.ty*this.a+this.tx*this.b)*c,p},As.prototype.translate=function(O,A){return this.tx+=O,this.ty+=A,this},As.prototype.scale=function(d,O){return this.a*=d,this.d*=O,this.c*=d,this.b*=O,this.tx*=d,this.ty*=O,this},As.prototype.rotate=function(y){var p=Math.cos(y),c=Math.sin(y),g=this.a,f=this.c,X=this.tx;return this.a=g*p-this.b*c,this.b=g*c+this.b*p,this.c=f*p-this.d*c,this.d=f*c+this.d*p,this.tx=X*p-this.ty*c,this.ty=X*c+this.ty*p,this},As.prototype.appendTranslate=function(i,n){return this.tx+=this.a*i+this.c*n,this.ty+=this.b*i+this.d*n,this},As.prototype.appendScale=function(W,f){return this.a*=W,this.d*=f,this.c*=f,this.b*=W,this},As.prototype.appendRotate=function(W){if(!W)return this;var A=Math.cos(W),p=Math.sin(W),z=this.a,n=this.b;return this.a=z*A+this.c*p,this.b=n*A+this.d*p,this.c=-z*p+this.c*A,this.d=-n*p+this.d*A,this},As.prototype.append=function(P){var t=this.a,w=this.b,Z=this.c,u=this.d;return this.a=P.a*t+P.b*Z,this.b=P.a*w+P.b*u,this.c=P.c*t+P.d*Z,this.d=P.c*w+P.d*u,this.tx=P.tx*t+P.ty*Z+this.tx,this.ty=P.tx*w+P.ty*u+this.ty,this},As.prototype.setTransform=function(X,J,h,S,u,Y,j,z,B){var d,p,y,o,O,D,g,l,s,e;return O=Math.sin(j),D=Math.cos(j),g=Math.cos(B),l=Math.sin(B),s=-Math.sin(z),e=Math.cos(z),d=D*u,p=O*u,y=-O*Y,o=D*Y,this.a=g*d+l*y,this.b=g*p+l*o,this.c=s*d+e*y,this.d=s*p+e*o,this.tx=X+(h*d+S*y),this.ty=J+(h*p+S*o),this},As.prototype.prepend=function(R){var D=this.tx;if(1!==R.a||0!==R.b||0!==R.c||1!==R.d){var b=this.a,Q=this.c;this.a=b*R.a+this.b*R.c,this.b=b*R.b+this.b*R.d,this.c=Q*R.a+this.d*R.c,this.d=Q*R.b+this.d*R.d}return this.tx=D*R.a+this.ty*R.c+R.tx,this.ty=D*R.b+this.ty*R.d+R.ty,this},As.prototype.transform=As.prototype.prepend,As.prototype.invert=function(){var p=this.a,j=this.b,E=this.c,e=this.d,Q=this.tx,h=p*e-j*E;return this.a=e/h,this.b=-j/h,this.c=-E/h,this.d=p/h,this.tx=(E*this.ty-e*Q)/h,this.ty=-(p*this.ty-j*Q)/h,this},As.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},As.prototype.clone=function(){var y=new As;return y.a=this.a,y.b=this.b,y.c=this.c,y.d=this.d,y.tx=this.tx,y.ty=this.ty,y},As.prototype.copy=function(x){return x.a=this.a,x.b=this.b,x.c=this.c,x.d=this.d,x.tx=this.tx,x.ty=this.ty,x},As.prototype.tf=function(B,i){1===arguments.length&&(i=B.y,B=B.x);var w=this;return{x:w.a*B+w.c*i+w.tx,y:w.b*B+w.d*i+w.ty}},As.prototype.tfi=function(U,T){1===arguments.length&&(T=U.y,U=U.x);var J=this,K=1/(J.a*J.d+J.c*-J.b);return{x:J.d*K*U+-J.c*K*T+(J.ty*J.c-J.tx*J.d)*K,y:J.a*K*T+-J.b*K*U+(-J.ty*J.a+J.tx*J.b)*K}},As.IDENTITY=new As,As.TEMP_MATRIX=new As;var Bb=v.Math.Quaternion=function(A,O,d,M){this.set(A,O,d,M)};Y.assign(Bb.prototype,{set:function($,Z,K,R){var d=this;return d._x=$||0,d._y=Z||0,d._z=K||0,d._w=R!==Q?R:1,d},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(B){var Q=this;return Q._x=B._x,Q._y=B._y,Q._z=B._z,Q._w=B._w,Q},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(j){return this._x*j._x+this._y*j._y+this._z*j._z+this._w*j._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var U=this.length();return 0===U?(this._x=0,this._y=0,this._z=0,this._w=1):(U=1/U,this._x=this._x*U,this._y=this._y*U,this._z=this._z*U,this._w=this._w*U),this},fromArray:function(c,n){n===Q&&(n=0);var Z=this;return Z._x=c[n],Z._y=c[n+1],Z._z=c[n+2],Z._w=c[n+3],this},slerp:function(G,U){if(0===U)return this;if(1===U)return this.copy(G);var Y=this._x,q=this._y,T=this._z,Z=this._w,I=Z*G._w+Y*G._x+q*G._y+T*G._z;if(0>I?(this._w=-G._w,this._x=-G._x,this._y=-G._y,this._z=-G._z,I=-I):this.copy(G),I>=1)return this._w=Z,this._x=Y,this._y=q,this._z=T,this;var l=Math.sqrt(1-I*I);if(Math.abs(l)<.001)return this._w=.5*(Z+this._w),this._x=.5*(Y+this._x),this._y=.5*(q+this._y),this._z=.5*(T+this._z),this;var b=Math.atan2(l,I),i=Math.sin((1-U)*b)/l,x=Math.sin(U*b)/l;return this._w=Z*i+this._w*x,this._x=Y*i+this._x*x,this._y=q*i+this._y*x,this._z=T*i+this._z*x,this},setFromAxisAngle:function(V,M){var R=M/2,E=Math.sin(R);return this._x=V.x*E,this._y=V.y*E,this._z=V.z*E,this._w=Math.cos(R),this},setFromEuler:function(r){var c=r._x,V=r._y,O=r._z,w=r._order,l=Math.cos,Y=Math.sin,B=l(c/2),a=l(V/2),Z=l(O/2),f=Y(c/2),y=Y(V/2),G=Y(O/2);return"XYZ"===w?(this._x=f*a*Z+B*y*G,this._y=B*y*Z-f*a*G,this._z=B*a*G+f*y*Z,this._w=B*a*Z-f*y*G):"YXZ"===w?(this._x=f*a*Z+B*y*G,this._y=B*y*Z-f*a*G,this._z=B*a*G-f*y*Z,this._w=B*a*Z+f*y*G):"ZXY"===w?(this._x=f*a*Z-B*y*G,this._y=B*y*Z+f*a*G,this._z=B*a*G+f*y*Z,this._w=B*a*Z-f*y*G):"ZYX"===w?(this._x=f*a*Z-B*y*G,this._y=B*y*Z+f*a*G,this._z=B*a*G-f*y*Z,this._w=B*a*Z+f*y*G):"YZX"===w?(this._x=f*a*Z+B*y*G,this._y=B*y*Z+f*a*G,this._z=B*a*G-f*y*Z,this._w=B*a*Z-f*y*G):"XZY"===w&&(this._x=f*a*Z-B*y*G,this._y=B*y*Z-f*a*G,this._z=B*a*G+f*y*Z,this._w=B*a*Z+f*y*G),this},setFromRotationMatrix:function(A){var g,i=A.el,R=i[0],T=i[4],O=i[8],x=i[1],e=i[5],M=i[9],q=i[2],D=i[6],r=i[10],c=R+e+r;return c>0?(g=.5/Math.sqrt(c+1),this._w=.25/g,this._x=(D-M)*g,this._y=(O-q)*g,this._z=(x-T)*g):R>e&&R>r?(g=2*Math.sqrt(1+R-e-r),this._w=(D-M)/g,this._x=.25*g,this._y=(T+x)/g,this._z=(O+q)/g):e>r?(g=2*Math.sqrt(1+e-R-r),this._w=(O-q)/g,this._x=(T+x)/g,this._y=.25*g,this._z=(M+D)/g):(g=2*Math.sqrt(1+r-R-e),this._w=(x-T)/g,this._x=(O+q)/g,this._y=(M+D)/g,this._z=.25*g),this},setFromToVectors:function(){var x,Y;return function(b,M){return x===Q&&(x=new He),Y=b.dot(M)+1,1e-7>Y?(Y=0,Math.abs(b.x)>Math.abs(b.z)?x.set(-b.y,b.x,0):x.set(0,-b.z,b.y)):x.crossVectors(b,M),this._x=x.x,this._y=x.y,this._z=x.z,this._w=Y,this.normalize()}}(),setFromUnitVectors:function(){var C,U,$=1e-6;return function(H,z){return C===Q&&(C=new He),U=H.dot(z)+1,$>U?(U=0,Math.abs(H.x)>Math.abs(H.z)?C.set(-H.y,H.x,0):C.set(0,-H.z,H.y)):C.crossVectors(H,z),this._x=C.x,this._y=C.y,this._z=C.z,this._w=U,this.normalize()}}(),multiply:function(o){return this.multiplyQuaternions(this,o)},premultiply:function(V){return this.multiplyQuaternions(V,this)},multiplyQuaternions:function(c,J){var k=c._x,E=c._y,F=c._z,g=c._w,j=J._x,T=J._y,D=J._z,_=J._w;return this._x=k*_+g*j+E*D-F*T,this._y=E*_+g*T+F*j-k*D,this._z=F*_+g*D+k*T-E*j,this._w=g*_-k*j-E*T-F*D,this}});var wp=v.Math.Vector4=function(s,w,V,c){this.x=s||0,this.y=w||0,this.z=V||0,this.w=c!==Q?c:1};Y.assign(wp.prototype,{isVector4:!0,set:function(D,y,t,h){return this.x=D,this.y=y,this.z=t,this.w=h,this},setScalar:function(y){return this.x=y,this.y=y,this.z=y,this.w=y,this},setX:function(J){return this.x=J,this},setY:function(F){return this.y=F,this},setZ:function(P){return this.z=P,this},setW:function(X){return this.w=X,this},setComponent:function(I,D){switch(I){case 0:this.x=D;break;case 1:this.y=D;break;case 2:this.z=D;break;case 3:this.w=D;break;default:throw new Error("index is out of range: "+I)}return this},getComponent:function(k){switch(k){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+k)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this.w=q.w!==Q?q.w:1,this},add:function(G,K){return K!==Q?this.addVectors(G,K):(this.x+=G.x,this.y+=G.y,this.z+=G.z,this.w+=G.w,this)},addScalar:function(n){return this.x+=n,this.y+=n,this.z+=n,this.w+=n,this},addVectors:function(q,e){return this.x=q.x+e.x,this.y=q.y+e.y,this.z=q.z+e.z,this.w=q.w+e.w,this},addScaledVector:function(b,u){return this.x+=b.x*u,this.y+=b.y*u,this.z+=b.z*u,this.w+=b.w*u,this},sub:function(N,I){return I!==Q?this.subVectors(N,I):(this.x-=N.x,this.y-=N.y,this.z-=N.z,this.w-=N.w,this)},subScalar:function(k){return this.x-=k,this.y-=k,this.z-=k,this.w-=k,this},subVectors:function(O,r){return this.x=O.x-r.x,this.y=O.y-r.y,this.z=O.z-r.z,this.w=O.w-r.w,this},multiplyScalar:function(y){return this.x*=y,this.y*=y,this.z*=y,this.w*=y,this},applyMatrix4:function(p){var k=this.x,M=this.y,s=this.z,f=this.w,X=p.el;return this.x=X[0]*k+X[4]*M+X[8]*s+X[12]*f,this.y=X[1]*k+X[5]*M+X[9]*s+X[13]*f,this.z=X[2]*k+X[6]*M+X[10]*s+X[14]*f,this.w=X[3]*k+X[7]*M+X[11]*s+X[15]*f,this},divideScalar:function(V){return this.multiplyScalar(1/V)},setAxisAngleFromQuaternion:function(F){this.w=2*Math.acos(F.w);var o=Math.sqrt(1-F.w*F.w);return 1e-4>o?(this.x=1,this.y=0,this.z=0):(this.x=F.x/o,this.y=F.y/o,this.z=F.z/o),this},setAxisAngleFromRotationMatrix:function(c){var M,t,I,l,v=.01,J=.1,r=c.el,o=r[0],U=r[4],s=r[8],S=r[1],p=r[5],Y=r[9],Q=r[2],j=r[6],K=r[10];if(Math.abs(U-S)<v&&Math.abs(s-Q)<v&&Math.abs(Y-j)<v){if(Math.abs(U+S)<J&&Math.abs(s+Q)<J&&Math.abs(Y+j)<J&&Math.abs(o+p+K-3)<J)return this.set(1,0,0,0),this;M=Math.PI;var E=(o+1)/2,k=(p+1)/2,a=(K+1)/2,G=(U+S)/4,y=(s+Q)/4,$=(Y+j)/4;return E>k&&E>a?v>E?(t=0,I=.707106781,l=.707106781):(t=Math.sqrt(E),I=G/t,l=y/t):k>a?v>k?(t=.707106781,I=0,l=.707106781):(I=Math.sqrt(k),t=G/I,l=$/I):v>a?(t=.707106781,I=.707106781,l=0):(l=Math.sqrt(a),t=y/l,I=$/l),this.set(t,I,l,M),this}var Z=Math.sqrt((j-Y)*(j-Y)+(s-Q)*(s-Q)+(S-U)*(S-U));return Math.abs(Z)<.001&&(Z=1),this.x=(j-Y)/Z,this.y=(s-Q)/Z,this.z=(S-U)/Z,this.w=Math.acos((o+p+K-1)/2),this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this.w=Math.min(this.w,u.w),this},max:function(x){return this.x=Math.max(this.x,x.x),this.y=Math.max(this.y,x.y),this.z=Math.max(this.z,x.z),this.w=Math.max(this.w,x.w),this},clamp:function(r,c){return this.x=Math.max(r.x,Math.min(c.x,this.x)),this.y=Math.max(r.y,Math.min(c.y,this.y)),this.z=Math.max(r.z,Math.min(c.z,this.z)),this.w=Math.max(r.w,Math.min(c.w,this.w)),this},clampScalar:function(){var m,w;return function(h,d){return m===Q&&(m=new wp,w=new wp),m.set(h,h,h,h),w.set(d,d,d,d),this.clamp(m,w)}}(),clampLength:function(s,t){var P=this.length();return this.divideScalar(P||1).multiplyScalar(Math.max(s,Math.min(t,P)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(P){return this.x*P.x+this.y*P.y+this.z*P.z+this.w*P.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(s){return this.normalize().multiplyScalar(s)},lerp:function(o,S){return this.x+=(o.x-this.x)*S,this.y+=(o.y-this.y)*S,this.z+=(o.z-this.z)*S,this.w+=(o.w-this.w)*S,this},lerpVectors:function(e,h,k){return this.subVectors(h,e).multiplyScalar(k).add(e)},equals:function(U){return U.x===this.x&&U.y===this.y&&U.z===this.z&&U.w===this.w},fromArray:function(w,i){return i===Q&&(i=0),this.x=w[i],this.y=w[i+1],this.z=w[i+2],this.w=w[i+3],this},toArray:function(H,R){return H===Q&&(H=[]),R===Q&&(R=0),H[R]=this.x,H[R+1]=this.y,H[R+2]=this.z,H[R+3]=this.w,H},fromBufferAttribute:function(E,A){return this.x=E.getX(A),this.y=E.getY(A),this.z=E.getZ(A),this.w=E.getW(A),this}});var He=v.Math.Vector3=function(l,b,M){l===Q?(this.x=0,this.y=0,this.z=0):"object"==typeof l?this.copy(l):this.set(l,b==Q?l:b,M==Q?l:M)};Y.assign(He.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(_,p,F){return this.x=_,this.y=p,this.z=F,this},equals:function(o){return o&&this.x===o.x&&this.y===o.y&&this.z===o.z},setScalar:function(p){return this.x=p,this.y=p,this.z=p,this},setX:function(x){return this.x=x,this},setY:function(C){return this.y=C,this},setZ:function(I){return this.z=I,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(b){return b.x===Q?(this.x=b[0],this.y=b[1],this.z=b[2]):(this.x=b.x,this.y=b.y,this.z=b.z||0),this},add:function(O){return this.x+=O.x,this.y+=O.y,this.z+=O.z,this},addScalar:function(_){return this.x+=_,this.y+=_,this.z+=_,this},addVectors:function($,I){return this.x=$.x+I.x,this.y=$.y+I.y,this.z=$.z+I.z,this},addScaledVector:function(T,O){return this.x+=T.x*O,this.y+=T.y*O,this.z+=T.z*O,this},sub:function(c){return this.x-=c.x,this.y-=c.y,this.z-=c.z,this},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this},subVectors:function(L,U){return this.x=L.x-U.x,this.y=L.y-U.y,this.z=L.z-U.z,this},divide:function(Q){return this.x/=Q.x,this.y/=Q.y,this.z/=Q.z,this},multiply:function(J){return this.x*=J.x,this.y*=J.y,this.z*=J.z,this},multiplyScalar:function(H){return this.x*=H,this.y*=H,this.z*=H,this},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(F){var m=this.x-F.x,J=this.y-F.y,i=this.z-F.z;return m*m+J*J+i*i},distanceToSquared2:function(W){var b=this.x-W[0],d=this.y-W[1],E=this.z-W[2];return b*b+d*d+E*E},divideVectors:function(Y,T){return this.x=Y.x/T.x,this.y=Y.y/T.y,this.z=Y.z/T.z,this},multiplyVectors:function(u,f){return this.x=u.x*f.x,this.y=u.y*f.y,this.z=u.z*f.z,this},transformDirection:function(D){var w=this.x,l=this.y,z=this.z,H=D.el;return this.x=H[0]*w+H[4]*l+H[8]*z,this.y=H[1]*w+H[5]*l+H[9]*z,this.z=H[2]*w+H[6]*l+H[10]*z,this.normalize()},applyAxisAngle:function(){var t=new Bb;return function(j,E){return this.applyQuaternion(t.setFromAxisAngle(j,E))}}(),applyEuler:function(){var k=new Bb;return function(O){return this.applyQuaternion(k.setFromEuler(O))}}(),applyQuaternion:function(k){var T=this.x,i=this.y,r=this.z,w=k._x,h=k._y,S=k._z,F=k._w,X=F*T+h*r-S*i,v=F*i+S*T-w*r,_=F*r+w*i-h*T,Y=-w*T-h*i-S*r;return this.x=X*F+Y*-w+v*-S-_*-h,this.y=v*F+Y*-h+_*-w-X*-S,this.z=_*F+Y*-S+X*-h-v*-w,this},applyMatrix4:function(U){var E=this.x,B=this.y,J=this.z,x=U.el,u=1/(x[3]*E+x[7]*B+x[11]*J+x[15]);return this.x=(x[0]*E+x[4]*B+x[8]*J+x[12])*u,this.y=(x[1]*E+x[5]*B+x[9]*J+x[13])*u,this.z=(x[2]*E+x[6]*B+x[10]*J+x[14])*u,this},applyMatrix3:function(P){var B=this.x,q=this.y,$=this.z,j=P.el;return this.x=j[0]*B+j[3]*q+j[6]*$,this.y=j[1]*B+j[4]*q+j[7]*$,this.z=j[2]*B+j[5]*q+j[8]*$,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var s=new He;return function(S){return this.sub(s.copy(S).multiplyScalar(2*this.dot(S)))}}(),dot:function(F){return this.x*F.x+this.y*F.y+this.z*F.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var z=this.length();
return z?this.multiplyScalar(1/z):this},setLength:function(O){return this.normalize().multiplyScalar(O)},fromArray:function(v,u){return u===Q&&(u=0),this.x=v[u],this.y=v[u+1],this.z=v[u+2],this},toArray:function(k,m){return k===Q&&(k=[0,0,0]),m===Q&&(m=0),k[m]=this.x,k[m+1]=this.y,k[m+2]=this.z,k},cross:function(n){return this.crossVectors(this,n)},angleTo:function(m){var u=this.dot(m)/Math.sqrt(this.lengthSq()*m.lengthSq());return u>1||-1>u?0:Math.acos(u)},lerp:function(t,z){return this.x+=(t.x-this.x)*z,this.y+=(t.y-this.y)*z,this.z+=(t.z-this.z)*z,this},lerpVectors:function(o,N,e){return this.subVectors(N,o).multiplyScalar(e).add(o)},crossVectors:function(G,A){var X=G.x,q=G.y,E=G.z,z=A.x,v=A.y,W=A.z;return this.x=q*W-E*v,this.y=E*z-X*W,this.z=X*v-q*z,this},min:function(I){return this.x=Math.min(this.x,I.x),this.y=Math.min(this.y,I.y),this.z=Math.min(this.z,I.z),this},max:function(z){return this.x=Math.max(this.x,z.x),this.y=Math.max(this.y,z.y),this.z=Math.max(this.z,z.z),this},setFromMatrixPosition:function(Z){return this.setFromMatrixColumn(Z,3)},setFromMatrixScale:function(o){var I=this.setFromMatrixColumn(o,0).length(),l=this.setFromMatrixColumn(o,1).length(),W=this.setFromMatrixColumn(o,2).length();return this.x=I,this.y=l,this.z=W,this},setFromMatrixColumn:function(d,q){return this.fromArray(d.el,4*q)}});var xi=v.Math.Vector2=function(h,t,a){"object"==typeof h&&(h.x!=Q?(t=h.y,h=h.x,a=h.e):(a=h[2],t=h[1],h=h[0])),this.set(h||0,t||0,a)};xi.prototype={},xi.prototype.constructor=xi,Y.defineProperties(xi.prototype,{width:{get:function(){return this.x},set:function(z){this.x=z}},height:{get:function(){return this.y},set:function(Q){this.y=Q}}}),xi.prototype.clone=function(){return new xi(this.x,this.y,this.e)},xi.prototype.copy=function(E){return this.set(E.x,E.y,E.e),this},xi.prototype.equals=function(Y){return Y.x===this.x&&Y.y===this.y},xi.prototype.set=function(e,T,p){return this.x=e||0,this.y=T||(0!==T?this.x:0),p!=Q&&(this.e=p),this},xi.prototype.setScalar=function(Z){return this.x=Z,this.y=Z,this},xi.prototype.setX=function($){return this.x=$||0,this},xi.prototype.setY=function(M){return this.y=M||0,this},xi.prototype.add=function(D){return this.x+=D.x,this.y+=D.y,this},xi.prototype.addVectors=function(j,m){return this.x=j.x+m.x,this.y=j.y+m.y,this},xi.prototype.addScalar=function(_){return this.x+=_,this.y+=_,this},xi.prototype.addScaledVector=function(x,E){return this.x+=x.x*E,this.y+=x.y*E,this},xi.prototype.sub=function(B){return this.x-=B.x,this.y-=B.y,this},xi.prototype.subScalar=function(m){return this.x-=m,this.y-=m,this},xi.prototype.subVectors=function(p,L){return this.x=p.x-L.x,this.y=p.y-L.y,this},xi.prototype.multiply=function(Y){return this.x*=Y.x,this.y*=Y.y,this},xi.prototype.multiplyScalar=function(z){return this.x*=z,this.y*=z,this},xi.prototype.divide=function(C){return this.x/=C.x,this.y/=C.y,this},xi.prototype.divideScalar=function(W){return this.multiplyScalar(1/W)},xi.prototype.min=function(F){return this.x=Math.min(this.x,F.x),this.y=Math.min(this.y,F.y),this},xi.prototype.max=function(b){return this.x=Math.max(this.x,b.x),this.y=Math.max(this.y,b.y),this},xi.prototype.fromArray=function(_,B){return B===Q&&(B=0),this.x=_[B],this.y=_[B+1],this},xi.prototype.clamp=function(O,$){return this.x=Math.max(O.x,Math.min($.x,this.x)),this.y=Math.max(O.y,Math.min($.y,this.y)),this},xi.prototype.clampScalar=function(){var v,J;return function(Y,R){return v===Q&&(v=new xi,J=new xi),v.set(Y,Y),J.set(R,R),this.clamp(v,J)}}(),xi.prototype.clampLength=function(J,y){var N=this.length();return this.multiplyScalar(Math.max(J,Math.min(y,N))/N)},xi.prototype.dot=function(R){return this.x*R.x+this.y*R.y},xi.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},xi.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},xi.prototype.normalize=function(){return this.divideScalar(this.length())},xi.prototype.angle=function(){var K=Math.atan2(this.y,this.x);return 0>K&&(K+=2*Math.PI),K},xi.prototype.distanceTo=function(L){return Math.sqrt(this.distanceToSquared(L))},xi.prototype.distanceToSquared=function(u){var L=this.x-u.x,c=this.y-u.y;return L*L+c*c},xi.prototype.isNearEnough=function(i){return this.distanceToSquared(i)<1e-8},xi.prototype.setLength=function(o){var N=this.length();return N?this.multiplyScalar(o/N):this},xi.prototype.lerp=function(k,o){return this.x+=(k.x-this.x)*o,this.y+=(k.y-this.y)*o,this},xi.prototype.lerpVectors=function(l,Y,U){return this.subVectors(Y,l).multiplyScalar(U).add(l)},xi.prototype.rotateAround=function(b,z){var O=b?b.x:0,h=b?b.y:0,R=Math.cos(z),Q=Math.sin(z),o=this.x-O,w=this.y-h;return this.x=o*R-w*Q+O,this.y=o*Q+w*R+h,this},Y.assign(c.prototype,{isMatrix3:!0,set:function(f,o,p,V,n,w,C,c,N){var I=this.el;return I[0]=f,I[1]=V,I[2]=C,I[3]=o,I[4]=n,I[5]=c,I[6]=p,I[7]=w,I[8]=N,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(p){var S=this.el,t=p.el;return S[0]=t[0],S[1]=t[1],S[2]=t[2],S[3]=t[3],S[4]=t[4],S[5]=t[5],S[6]=t[6],S[7]=t[7],S[8]=t[8],this},setFromMatrix4:function(b){var g=b.el;return this.set(g[0],g[4],g[8],g[1],g[5],g[9],g[2],g[6],g[10]),this},applyToBufferAttribute:function(){var F=new He;return function(H){for(var G=0,W=H.count;W>G;G++)F.x=H.getX(G),F.y=H.getY(G),F.z=H.getZ(G),F.applyMatrix3(this),H.setXYZ(G,F.x,F.y,F.z);return H}}(),multiply:function(z){return this.multiplyMatrices(this,z)},premultiply:function(j){return this.multiplyMatrices(j,this)},multiplyMatrices:function(E,L){var f=E.el,i=L.el,e=this.el,m=f[0],N=f[3],x=f[6],n=f[1],t=f[4],B=f[7],I=f[2],T=f[5],J=f[8],r=i[0],V=i[3],_=i[6],U=i[1],c=i[4],A=i[7],q=i[2],d=i[5],R=i[8];return e[0]=m*r+N*U+x*q,e[3]=m*V+N*c+x*d,e[6]=m*_+N*A+x*R,e[1]=n*r+t*U+B*q,e[4]=n*V+t*c+B*d,e[7]=n*_+t*A+B*R,e[2]=I*r+T*U+J*q,e[5]=I*V+T*c+J*d,e[8]=I*_+T*A+J*R,this},multiplyScalar:function(m){var D=this.el;return D[0]*=m,D[3]*=m,D[6]*=m,D[1]*=m,D[4]*=m,D[7]*=m,D[2]*=m,D[5]*=m,D[8]*=m,this},determinant:function(){var I=this.el,B=I[0],b=I[1],a=I[2],n=I[3],v=I[4],J=I[5],Y=I[6],k=I[7],N=I[8];return B*v*N-B*J*k-b*n*N+b*J*Y+a*n*k-a*v*Y},getInverse:function(F){var _=F.el,M=this.el,b=_[0],n=_[1],h=_[2],p=_[3],E=_[4],Y=_[5],v=_[6],A=_[7],x=_[8],r=x*E-Y*A,y=Y*v-x*p,c=A*p-E*v,G=b*r+n*y+h*c;if(0===G)return this.identity();var q=1/G;return M[0]=r*q,M[1]=(h*A-x*n)*q,M[2]=(Y*n-h*E)*q,M[3]=y*q,M[4]=(x*b-h*v)*q,M[5]=(h*p-Y*b)*q,M[6]=c*q,M[7]=(n*v-A*b)*q,M[8]=(E*b-n*p)*q,this},transpose:function(){var $,M=this.el;return $=M[1],M[1]=M[3],M[3]=$,$=M[2],M[2]=M[6],M[6]=$,$=M[5],M[5]=M[7],M[7]=$,this},getNormalMatrix:function(S){return this.setFromMatrix4(S).getInverse(this).transpose()},transposeIntoArray:function(K){var E=this.el;return K[0]=E[0],K[1]=E[3],K[2]=E[6],K[3]=E[1],K[4]=E[4],K[5]=E[7],K[6]=E[2],K[7]=E[5],K[8]=E[8],this},setUvTransform:function(T,w,L,M,V,z,$){var Q=Math.cos(V),U=Math.sin(V);this.set(L*Q,L*U,-L*(Q*z+U*$)+z+T,-M*U,M*Q,-M*(-U*z+Q*$)+$+w,0,0,1)},scale:function(j,r){var F=this.el;return F[0]*=j,F[3]*=j,F[6]*=j,F[1]*=r,F[4]*=r,F[7]*=r,this},rotate:function(t){var k=Math.cos(t),L=Math.sin(t),l=this.el,H=l[0],u=l[3],c=l[6],F=l[1],D=l[4],M=l[7];return l[0]=k*H+L*F,l[3]=k*u+L*D,l[6]=k*c+L*M,l[1]=-L*H+k*F,l[4]=-L*u+k*D,l[7]=-L*c+k*M,this},translate:function(t,q){var h=this.el;return h[0]+=t*h[2],h[3]+=t*h[5],h[6]+=t*h[8],h[1]+=q*h[2],h[4]+=q*h[5],h[7]+=q*h[8],this},equals:function(b){for(var c=this.el,P=b.el,x=0;9>x;x++)if(c[x]!==P[x])return!1;return!0},fromArray:function(K,q){q===Q&&(q=0);for(var I=0;9>I;I++)this.el[I]=K[I+q];return this},toArray:function(c,t){c===Q&&(c=[]),t===Q&&(t=0);var e=this.el;return c[t]=e[0],c[t+1]=e[1],c[t+2]=e[2],c[t+3]=e[3],c[t+4]=e[4],c[t+5]=e[5],c[t+6]=e[6],c[t+7]=e[7],c[t+8]=e[8],c}});var _c=v.Math.Plane=function(B,S){this.normal=B!==Q?B:new He(1,0,0),this.constant=S!==Q?S:0};Y.assign(_c.prototype,{set:function(t,J){return this.normal.copy(t),this.constant=J,this},setComponents:function(F,e,q,L){return this.normal.set(F,e,q),this.constant=L,this},setFromNormalAndCoplanarPoint:function(V,T){return this.normal.copy(V),this.constant=-T.dot(this.normal),this},setFromCoplanarPoints:function(){var R=new He,f=new He;return function(M,x,y){var e=R.subVectors(y,x).cross(f.subVectors(M,x)).normalize();return this.setFromNormalAndCoplanarPoint(e,M),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(h){return this.normal.copy(h.normal),this.constant=h.constant,this},normalize:function(){var o=1/this.normal.length();return this.normal.multiplyScalar(o),this.constant*=o,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(S){return this.normal.dot(S)+this.constant},distanceToSphere:function(i){return this.distanceToPoint(i.center)-i.radius},projectPoint:function(E,h){return h===Q&&(h=new He),h.copy(this.normal).multiplyScalar(-this.distanceToPoint(E)).add(E)},intersectLine:function(){var S=new He;return function(h,k){k===Q&&(k=new He);var u=h.delta(S),d=this.normal.dot(u);if(0===d)return 0===this.distanceToPoint(h.start)?k.copy(h.start):Q;var j=-(h.start.dot(this.normal)+this.constant)/d;return 0>j||j>1?Q:k.copy(u).multiplyScalar(j).add(h.start)}}(),intersectsLine:function(b){var n=this.distanceToPoint(b.start),x=this.distanceToPoint(b.end);return 0>n&&x>0||0>x&&n>0},intersectsBox:function(x){return x.intersectsPlane(this)},intersectsSphere:function(R){return R.intersectsPlane(this)},coplanarPoint:function(W){return W===Q&&(W=new He),W.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var Z=new He,t=new c;return function(l,y){var L=y||t.getNormalMatrix(l),r=this.coplanarPoint(Z).applyMatrix4(l),H=this.normal.applyMatrix3(L).normalize();return this.constant=-r.dot(H),this}}(),translate:function(z){return this.constant-=z.dot(this.normal),this},equals:function(b){return b.normal.equals(this.normal)&&b.constant===this.constant}});var Pl=v.Math.Ray=function(R,f){this.origin=R!==Q?R.clone():new He,this.direction=f!==Q?f.clone():new He};Y.assign(Pl.prototype,{set:function(P,o){return this.origin.copy(P),this.direction.copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this.maxHitLen=l.maxHitLen,this},at:function(I,U){var r=U||new He;return r.copy(this.direction).multiplyScalar(I).add(this.origin)},setMaxHitLength:function(V){this.maxHitLen=V},lookAt:function(E){return this.direction.copy(E).sub(this.origin).normalize(),this},applyMatrix4:function(O){var e=this.maxHitLen;if(e){var E=this.direction.clone().multiplyScalar(e).add(this.origin);E.applyMatrix4(O)}return this.origin.applyMatrix4(O),this.direction.transformDirection(O),e&&(this.maxHitLen=this.origin.distanceTo(E)),this},intersectSphere:function(){var K=new He;return function(U,n){K.subVectors(U.center,this.origin);var j=K.dot(this.direction),X=K.dot(K)-j*j,W=U.radius*U.radius;if(X>W)return null;var s=Math.sqrt(W-X),L=j-s,D=j+s;return 0>L&&0>D?null:0>L?this.at(D,n):this.at(L,n)}}(),intersectEllipsoid:function(){var A=new He,Y=new He;return function(w,l){A.subVectors(w.center,this.origin),A.divide(w.radius),Y.divideVectors(this.direction,w.radius);var Q=Y.lengthSq(),z=A.dot(Y),h=A.dot(A)*Q-z*z;if(h>Q)return null;var f=Math.sqrt(Q-h),V=(z-f)/Q,o=(z+f)/Q;return 0>V&&0>o?null:0>V?this.at(o,l):this.at(V,l)}}(),intersectBox:function(z,K){var O,f,$,c,a,d,A=1/this.direction.x,C=1/this.direction.y,u=1/this.direction.z,l=this.origin;if(A>=0?(O=(z.min.x-l.x)*A,f=(z.max.x-l.x)*A):(O=(z.max.x-l.x)*A,f=(z.min.x-l.x)*A),C>=0?($=(z.min.y-l.y)*C,c=(z.max.y-l.y)*C):($=(z.max.y-l.y)*C,c=(z.min.y-l.y)*C),O>c||$>f)return null;if(($>O||O!==O)&&(O=$),(f>c||f!==f)&&(f=c),u>=0?(a=(z.min.z-l.z)*u,d=(z.max.z-l.z)*u):(a=(z.max.z-l.z)*u,d=(z.min.z-l.z)*u),O>d||a>f)return null;if((a>O||O!==O)&&(O=a),(f>d||f!==f)&&(f=d),0>f)return null;var v=O>=0?O:f,e=this.maxHitLen;return e&&v>e?null:this.at(v,K)},intersectTriangle:function(){var y=new He,L=new He,p=new He,e=new He;return function(Q,v,C,Z,q){L.subVectors(v,Q),p.subVectors(C,Q),e.crossVectors(L,p);var W,b=this.direction.dot(e);if(b>0){if(Z)return null;W=1}else{if(!(0>b))return null;W=-1,b=-b}y.subVectors(this.origin,Q);var u=W*this.direction.dot(p.crossVectors(y,p));if(0>u)return null;var I=W*this.direction.dot(L.cross(y));if(0>I||u+I>b)return null;var i=-W*y.dot(e);if(0>i)return null;var V=i/b,R=this.maxHitLen;return R&&V>R?null:this.at(V,q)}}()});var yi=v.Math.Box3=function(i,R){this.min=i!==Q?i:new He(1/0,1/0,1/0),this.max=R!==Q?R:new He(-1/0,-1/0,-1/0)};Y.assign(yi.prototype,{set:function(N,A){return this.min.copy(N),this.max.copy(A),this},setFromArray:function(s){for(var i=1/0,$=1/0,I=1/0,J=-1/0,b=-1/0,h=-1/0,N=0,M=s.length;M>N;N+=3){var Z=s[N],q=s[N+1],F=s[N+2];i>Z&&(i=Z),$>q&&($=q),I>F&&(I=F),Z>J&&(J=Z),q>b&&(b=q),F>h&&(h=F)}return this.min.set(i,$,I),this.max.set(J,b,h),this},setFromPoints:function(o){this.makeEmpty();for(var k=0,u=o.length;u>k;k++)this.expandByPoint(o[k]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(l){return this.min.min(l),this.max.max(l),this},expandByBox:function(E){return this.min.min(E.min),this.max.max(E.max),this},applyMatrix4:function(){var y=[new He,new He,new He,new He,new He,new He,new He,new He];return function(D){return this.isEmpty()?this:(y[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(D),y[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(D),y[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(D),y[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(D),y[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(D),y[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(D),y[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(D),y[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(D),this.setFromPoints(y),this)}}()});var jr=v.Math.Sphere=function(K,v){this.center=K!==Q?K:new He,this.radius=v!==Q?v:0};Y.assign(jr.prototype,{set:function(u,E){return this.center.copy(u),this.radius=E,this},setFromPoints:function(){var b=new yi;return function(w,_){var M=this.center;_!==Q?M.copy(_):b.setFromPoints(w).getCenter(M);for(var A=0,V=0,x=w.length;x>V;V++)A=Math.max(A,M.distanceToSquared(w[V]));return this.radius=Math.sqrt(A),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(i){return this.center.copy(i.center),this.radius=i.radius,this},empty:function(){return this.radius<=0},containsPoint:function(S){return S.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(D){return D.distanceTo(this.center)-this.radius},intersectsSphere:function(q){var F=this.radius+q.radius;return q.center.distanceToSquared(this.center)<=F*F},intersectsBox:function(z){return z.intersectsSphere(this)},intersectsPlane:function(g){return Math.abs(g.distanceToPoint(this.center))<=this.radius},clampPoint:function(R,e){var o=this.center.distanceToSquared(R);return e===Q&&(e=new He),e.copy(R),o>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(K){return K===Q&&(K=new yi),K.set(this.center,this.center),K.expandByScalar(this.radius),K},applyMatrix4:function(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this},translate:function(V){return this.center.add(V),this},equals:function(q){return q.center.equals(this.center)&&q.radius===this.radius}});var Kq=v.Math.Frustum=function(P,x,_,B,I,z){this.planes=[P!==Q?P:new _c,x!==Q?x:new _c,_!==Q?_:new _c,B!==Q?B:new _c,I!==Q?I:new _c,z!==Q?z:new _c]};Y.assign(Kq.prototype,{set:function(Z,B,O,T,o,L){var Q=this.planes;return Q[0].copy(Z),Q[1].copy(B),Q[2].copy(O),Q[3].copy(T),Q[4].copy(o),Q[5].copy(L),this},clone:function(){return(new this.constructor).copy(this)},copy:function(K){for(var M=this.planes,g=0;6>g;g++)M[g].copy(K.planes[g]);return this},setFromMatrix:function(V){var h=this.planes,s=V.el,I=s[0],d=s[1],r=s[2],W=s[3],j=s[4],J=s[5],S=s[6],H=s[7],x=s[8],z=s[9],m=s[10],Z=s[11],_=s[12],$=s[13],D=s[14],e=s[15];return h[0].setComponents(W-I,H-j,Z-x,e-_).normalize(),h[1].setComponents(W+I,H+j,Z+x,e+_).normalize(),h[2].setComponents(W+d,H+J,Z+z,e+$).normalize(),h[3].setComponents(W-d,H-J,Z-z,e-$).normalize(),h[4].setComponents(W-r,H-S,Z-m,e-D).normalize(),h[5].setComponents(W+r,H+S,Z+m,e+D).normalize(),this},intersectsObject:function(){var H=new jr;return function(B){var L=B.geometry;return null===L.boundingSphere&&L.computeBoundingSphere(),H.copy(L.boundingSphere).applyMatrix4(B.matrixWorld),this.intersectsSphere(H)}}(),intersectsSprite:function(){var L=new jr;return function(G){return L.center.set(0,0,0),L.radius=.7071067811865476,L.applyMatrix4(G.matrixWorld),this.intersectsSphere(L)}}(),intersectsSphere:function(s){for(var g=this.planes,w=s.center,o=-s.radius,p=0;6>p;p++){var l=g[p].distanceToPoint(w);if(o>l)return!1}return!0},intersectsBox:function(){var L=new He;return function(D){for(var A=this.planes,x=0;6>x;x++){var s=A[x];if(L.x=s.normal.x>0?D.max.x:D.min.x,L.y=s.normal.y>0?D.max.y:D.min.y,L.z=s.normal.z>0?D.max.z:D.min.z,s.distanceToPoint(L)<0)return!1}return!0}}(),containsPoint:function(Q){for(var h=this.planes,C=0;6>C;C++)if(h[C].distanceToPoint(Q)<0)return!1;return!0}});var _i=v.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};Y.assign(_i.prototype,{set:function(k,h,S,i,I,K,t,Z,b,d,f,V,F,C,Y,N){var L=this.el;return L[0]=k,L[4]=h,L[8]=S,L[12]=i,L[1]=I,L[5]=K,L[9]=t,L[13]=Z,L[2]=b,L[6]=d,L[10]=f,L[14]=V,L[3]=F,L[7]=C,L[11]=Y,L[15]=N,this},clone:function(){return(new _i).fromArray(this.el)},fromArray:function(U,a){a===Q&&(a=0);for(var l=this.el,y=0;16>y;y++)l[y]=U[y+a];return this},getElements:function(){return this.el},scale:function(Y){var T=this.el,j=Y.x,B=Y.y,i=Y.z;return T[0]*=j,T[4]*=B,T[8]*=i,T[1]*=j,T[5]*=B,T[9]*=i,T[2]*=j,T[6]*=B,T[10]*=i,T[3]*=j,T[7]*=B,T[11]*=i,this},makeRotationFromEuler:function(V){var Q=this.el,F=V._x,Y=V._y,q=V._z,R=V._order,x=Math.cos(F),W=Math.sin(F),s=Math.cos(Y),U=Math.sin(Y),b=Math.cos(q),T=Math.sin(q);if("XYZ"===R){var k=x*b,a=x*T,p=W*b,J=W*T;Q[0]=s*b,Q[4]=-s*T,Q[8]=U,Q[1]=a+p*U,Q[5]=k-J*U,Q[9]=-W*s,Q[2]=J-k*U,Q[6]=p+a*U,Q[10]=x*s}else if("YXZ"===R){var y=s*b,e=s*T,O=U*b,Z=U*T;Q[0]=y+Z*W,Q[4]=O*W-e,Q[8]=x*U,Q[1]=x*T,Q[5]=x*b,Q[9]=-W,Q[2]=e*W-O,Q[6]=Z+y*W,Q[10]=x*s}else if("ZXY"===R){var y=s*b,e=s*T,O=U*b,Z=U*T;Q[0]=y-Z*W,Q[4]=-x*T,Q[8]=O+e*W,Q[1]=e+O*W,Q[5]=x*b,Q[9]=Z-y*W,Q[2]=-x*U,Q[6]=W,Q[10]=x*s}else if("ZYX"===R){var k=x*b,a=x*T,p=W*b,J=W*T;Q[0]=s*b,Q[4]=p*U-a,Q[8]=k*U+J,Q[1]=s*T,Q[5]=J*U+k,Q[9]=a*U-p,Q[2]=-U,Q[6]=W*s,Q[10]=x*s}else if("YZX"===R){var P=x*s,A=x*U,m=W*s,o=W*U;Q[0]=s*b,Q[4]=o-P*T,Q[8]=m*T+A,Q[1]=T,Q[5]=x*b,Q[9]=-W*b,Q[2]=-U*b,Q[6]=A*T+m,Q[10]=P-o*T}else if("XZY"===R){var P=x*s,A=x*U,m=W*s,o=W*U;Q[0]=s*b,Q[4]=-T,Q[8]=U*b,Q[1]=P*T+o,Q[5]=x*b,Q[9]=A*T-m,Q[2]=m*T-A,Q[6]=W*b,Q[10]=o*T+P}return Q[3]=0,Q[7]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,this},makeRotationFromQuaternion:function(q){var R=this.el,F=q._x,u=q._y,Q=q._z,I=q._w,N=F+F,S=u+u,c=Q+Q,y=F*N,w=F*S,J=F*c,H=u*S,v=u*c,A=Q*c,e=I*N,x=I*S,o=I*c;return R[0]=1-(H+A),R[4]=w-o,R[8]=J+x,R[1]=w+o,R[5]=1-(y+A),R[9]=v-e,R[2]=J-x,R[6]=v+e,R[10]=1-(y+H),R[3]=0,R[7]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(D){var b=this.el,N=D.el,u=N[0],t=N[1],o=N[2],i=N[3],X=N[4],Z=N[5],W=N[6],x=N[7],S=N[8],s=N[9],h=N[10],c=N[11],V=N[12],R=N[13],T=N[14],w=N[15],r=s*T*x-R*h*x+R*W*c-Z*T*c-s*W*w+Z*h*w,A=V*h*x-S*T*x-V*W*c+X*T*c+S*W*w-X*h*w,f=S*R*x-V*s*x+V*Z*c-X*R*c-S*Z*w+X*s*w,k=V*s*W-S*R*W-V*Z*h+X*R*h+S*Z*T-X*s*T,e=u*r+t*A+o*f+i*k;if(0===e)return this.identity();var m=1/e;return b[0]=r*m,b[1]=(R*h*i-s*T*i-R*o*c+t*T*c+s*o*w-t*h*w)*m,b[2]=(Z*T*i-R*W*i+R*o*x-t*T*x-Z*o*w+t*W*w)*m,b[3]=(s*W*i-Z*h*i-s*o*x+t*h*x+Z*o*c-t*W*c)*m,b[4]=A*m,b[5]=(S*T*i-V*h*i+V*o*c-u*T*c-S*o*w+u*h*w)*m,b[6]=(V*W*i-X*T*i-V*o*x+u*T*x+X*o*w-u*W*w)*m,b[7]=(X*h*i-S*W*i+S*o*x-u*h*x-X*o*c+u*W*c)*m,b[8]=f*m,b[9]=(V*s*i-S*R*i-V*t*c+u*R*c+S*t*w-u*s*w)*m,b[10]=(X*R*i-V*Z*i+V*t*x-u*R*x-X*t*w+u*Z*w)*m,b[11]=(S*Z*i-X*s*i-S*t*x+u*s*x+X*t*c-u*Z*c)*m,b[12]=k*m,b[13]=(S*R*o-V*s*o+V*t*h-u*R*h-S*t*T+u*s*T)*m,b[14]=(V*Z*o-X*R*o-V*t*W+u*R*W+X*t*T-u*Z*T)*m,b[15]=(X*s*o-S*Z*o+S*t*W-u*s*W-X*t*h+u*Z*h)*m,this},makeRotationAxis:function(B,T){var q=Math.cos(T),$=Math.sin(T),J=1-q,Q=B.x,g=B.y,a=B.z,S=J*Q,e=J*g;return this.set(S*Q+q,S*g-$*a,S*a+$*g,0,S*g+$*a,e*g+q,e*a-$*Q,0,S*a-$*g,e*a+$*Q,J*a*a+q,0,0,0,0,1),this},multiply:function(X){return this.multiplyMatrices(this,X)},premultiply:function(p){return this.multiplyMatrices(p,this)},multiplyMatrices:function(Z,$){var L=Z.el,A=$.el,o=this.el,x=L[0],g=L[4],h=L[8],b=L[12],f=L[1],Y=L[5],N=L[9],H=L[13],t=L[2],O=L[6],q=L[10],n=L[14],V=L[3],F=L[7],C=L[11],D=L[15],_=A[0],s=A[4],G=A[8],S=A[12],R=A[1],J=A[5],W=A[9],U=A[13],l=A[2],p=A[6],E=A[10],Q=A[14],z=A[3],k=A[7],M=A[11],r=A[15];return o[0]=x*_+g*R+h*l+b*z,o[4]=x*s+g*J+h*p+b*k,o[8]=x*G+g*W+h*E+b*M,o[12]=x*S+g*U+h*Q+b*r,o[1]=f*_+Y*R+N*l+H*z,o[5]=f*s+Y*J+N*p+H*k,o[9]=f*G+Y*W+N*E+H*M,o[13]=f*S+Y*U+N*Q+H*r,o[2]=t*_+O*R+q*l+n*z,o[6]=t*s+O*J+q*p+n*k,o[10]=t*G+O*W+q*E+n*M,o[14]=t*S+O*U+q*Q+n*r,o[3]=V*_+F*R+C*l+D*z,o[7]=V*s+F*J+C*p+D*k,o[11]=V*G+F*W+C*E+D*M,o[15]=V*S+F*U+C*Q+D*r,this},lookAt:function(){var X=new He,J=new He,T=new He;return function(g,A,k){var M=this.el;return T.subVectors(g,A),0===T.lengthSq()&&(T.z=1),T.normalize(),X.crossVectors(k,T),0===X.lengthSq()&&(1===Math.abs(k.z)?T.x+=1e-4:T.z+=1e-4,T.normalize(),X.crossVectors(k,T)),X.normalize(),J.crossVectors(T,X),M[0]=X.x,M[4]=J.x,M[8]=T.x,M[1]=X.y,M[5]=J.y,M[9]=T.y,M[2]=X.z,M[6]=J.z,M[10]=T.z,this}}(),extractScale:function(){var a;return function(n){a===Q&&(a=new He),n===Q&&(n=new He);var E=a.setFromMatrixColumn(this,0).length(),D=a.setFromMatrixColumn(this,1).length(),B=a.setFromMatrixColumn(this,2).length();return n.set(E,D,B),n}}(),extractRotation:function(){var d;return function(a){d===Q&&(d=new He),a===Q&&(a=new _i);var $=this.el,X=a.el,U=1/d.setFromMatrixColumn(a,0).length(),P=1/d.setFromMatrixColumn(a,1).length(),q=1/d.setFromMatrixColumn(a,2).length();return $[0]=X[0]*U,$[1]=X[1]*U,$[2]=X[2]*U,$[4]=X[4]*P,$[5]=X[5]*P,$[6]=X[6]*P,$[8]=X[8]*q,$[9]=X[9]*q,$[10]=X[10]*q,this}}(),multiplyScalar:function(x){var l=this.el;return l[0]*=x,l[4]*=x,l[8]*=x,l[12]*=x,l[1]*=x,l[5]*=x,l[9]*=x,l[13]*=x,l[2]*=x,l[6]*=x,l[10]*=x,l[14]*=x,l[3]*=x,l[7]*=x,l[11]*=x,l[15]*=x,this},getPosition:function(I){return I===Q&&(I=new He),I.setFromMatrixColumn(this,3)},setPosition:function(j){var I=this.el;return I[12]=j.x,I[13]=j.y,I[14]=j.z,this},toArray:function(y,C){y===Q&&(y=[]),C===Q&&(C=0);var Z=this.el;return y[C]=Z[0],y[C+1]=Z[1],y[C+2]=Z[2],y[C+3]=Z[3],y[C+4]=Z[4],y[C+5]=Z[5],y[C+6]=Z[6],y[C+7]=Z[7],y[C+8]=Z[8],y[C+9]=Z[9],y[C+10]=Z[10],y[C+11]=Z[11],y[C+12]=Z[12],y[C+13]=Z[13],y[C+14]=Z[14],y[C+15]=Z[15],y},determinant:function(){var J=this.el,E=J[0],X=J[4],z=J[8],V=J[12],p=J[1],l=J[5],t=J[9],m=J[13],Y=J[2],f=J[6],$=J[10],j=J[14],A=J[3],b=J[7],e=J[11],q=J[15];return A*(+V*t*f-z*m*f-V*l*$+X*m*$+z*l*j-X*t*j)+b*(+E*t*j-E*m*$+V*p*$-z*p*j+z*m*Y-V*t*Y)+e*(+E*m*f-E*l*j-V*p*f+X*p*j+V*l*Y-X*m*Y)+q*(-z*l*Y-E*t*f+E*l*$+z*p*f-X*p*$+X*t*Y)},copy:function(w){var p=this.el,R=w.el;return p[0]=R[0],p[1]=R[1],p[2]=R[2],p[3]=R[3],p[4]=R[4],p[5]=R[5],p[6]=R[6],p[7]=R[7],p[8]=R[8],p[9]=R[9],p[10]=R[10],p[11]=R[11],p[12]=R[12],p[13]=R[13],p[14]=R[14],p[15]=R[15],this},compose:function(x,a,A){var Y=this.el,B=a._x,U=a._y,s=a._z,T=a._w,W=B+B,q=U+U,r=s+s,h=B*W,I=B*q,L=B*r,y=U*q,i=U*r,N=s*r,Z=T*W,f=T*q,$=T*r,J=A.x,c=A.y,F=A.z;return Y[0]=(1-(y+N))*J,Y[1]=(I+$)*J,Y[2]=(L-f)*J,Y[3]=0,Y[4]=(I-$)*c,Y[5]=(1-(h+N))*c,Y[6]=(i+Z)*c,Y[7]=0,Y[8]=(L+f)*F,Y[9]=(i-Z)*F,Y[10]=(1-(h+y))*F,Y[11]=0,Y[12]=x.x,Y[13]=x.y,Y[14]=x.z,Y[15]=1,this},decompose:function(){var l=new He,G=new _i;return function(z,s,_){var p=this.el,r=l.set(p[0],p[1],p[2]).length(),e=l.set(p[4],p[5],p[6]).length(),f=l.set(p[8],p[9],p[10]).length(),u=this.determinant();0>u&&(r=-r),z.x=p[12],z.y=p[13],z.z=p[14],G.copy(this);var S=1/r,J=1/e,t=1/f;return G.el[0]*=S,G.el[1]*=S,G.el[2]*=S,G.el[4]*=J,G.el[5]*=J,G.el[6]*=J,G.el[8]*=t,G.el[9]*=t,G.el[10]*=t,s.setFromRotationMatrix(G),_.x=r,_.y=e,_.z=f,this}}()});var xr=v.Math.Triangle=function(R,G,U){this.a=R!==Q?R:new He,this.b=G!==Q?G:new He,this.c=U!==Q?U:new He};Y.assign(xr,{barycoordFromPoint:function(){var z=new He,h=new He,u=new He;return function(w,M,a,Y,e){z.subVectors(Y,M),h.subVectors(a,M),u.subVectors(w,M);var U=z.dot(z),i=z.dot(h),f=z.dot(u),C=h.dot(h),k=h.dot(u),T=U*C-i*i,r=e||new He;if(0===T)return r.set(-2,-1,-1);var S=1/T,O=(C*f-i*k)*S,o=(U*k-i*f)*S;return r.set(1-O-o,o,O)}}()});var Sr=v.Math.Euler=function(m,u,j,s,E){this.set(m,u,j,s,E)};Sr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Sr.DefaultOrder="XYZ",Sr.ReverseOrder=function(B){return B=B[2]+B[1]+B[0],B.toUpperCase()},Y.defineProperties(Sr.prototype,{x:{get:function(){return this._x},set:function($){this._x=$,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Z){this._y=Z,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(o){this._z=o,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(s){this._order=s,this.onChangeCallback()}}}),Y.assign(Sr.prototype,{set:function(n,g,o,V,I){return Ad(n)&&(I=o,V=g,o=n[2],g=n[1],n=n[0]),V?I&&(V=Sr.ReverseOrder(V)):V="ZYX",this._x=n||0,this._y=g||0,this._z=o||0,this._order=V||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(v){return this._x=v._x,this._y=v._y,this._z=v._z,this._order=v._order,this.onChangeCallback(),this},setFromRotationMatrix:function(U,h,D){var F=v.Math.clamp,a=U.el||U,n=a[0],V=a[4],G=a[8],Y=a[1],W=a[5],b=a[9],X=a[2],H=a[6],u=a[10];return h=h||this._order,"XYZ"===h?(this._y=Math.asin(F(G,-1,1)),Math.abs(G)<.99999?(this._x=Math.atan2(-b,u),this._z=Math.atan2(-V,n)):(this._x=Math.atan2(H,W),this._z=0)):"YXZ"===h?(this._x=Math.asin(-F(b,-1,1)),Math.abs(b)<.99999?(this._y=Math.atan2(G,u),this._z=Math.atan2(Y,W)):(this._y=Math.atan2(-X,n),this._z=0)):"ZXY"===h?(this._x=Math.asin(F(H,-1,1)),Math.abs(H)<.99999?(this._y=Math.atan2(-X,u),this._z=Math.atan2(-V,W)):(this._y=0,this._z=Math.atan2(Y,n))):"ZYX"===h?(this._y=Math.asin(-F(X,-1,1)),Math.abs(X)<.99999?(this._x=Math.atan2(H,u),this._z=Math.atan2(Y,n)):(this._x=0,this._z=Math.atan2(-V,W))):"YZX"===h?(this._z=Math.asin(F(Y,-1,1)),Math.abs(Y)<.99999?(this._x=Math.atan2(-b,W),this._y=Math.atan2(-X,n)):(this._x=0,this._y=Math.atan2(G,u))):"XZY"===h?(this._z=Math.asin(-F(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(H,W),this._y=Math.atan2(G,n)):(this._x=Math.atan2(-b,u),this._y=0)):console.warn("unsupported order: "+h),this._order=h,D!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new _i;return function(H,x,j){return M.makeRotationFromQuaternion(H),this.setFromRotationMatrix(M,x,j)}}(),setFromVector3:function(S,H){return this.set(S.x,S.y,S.z,H||this._order)},reorder:function(){var d=new Bb;return function(e){return d.setFromEuler(this),this.setFromQuaternion(d,e)}}(),equals:function(L){return L._x===this._x&&L._y===this._y&&L._z===this._z&&L._order===this._order},fromArray:function(J){return this._x=J[0],this._y=J[1],this._z=J[2],J[3]!==Q&&(this._order=J[3]),this.onChangeCallback(),this},toArray:function(z,N){return z===Q&&(z=[]),N===Q&&(N=0),z[N]=this._x,z[N+1]=this._y,z[N+2]=this._z,z[N+3]=this._order,z},toVector3:function(f){return f?f.set(this._x,this._y,this._z):new He(this._x,this._y,this._z)},onChange:function(L){return this.onChangeCallback=L,this},onChangeCallback:function(){}});var hl={ms_ac:function(l,L){for(var c=L.ms_ac,e=0;e<c.length;e++)Gp(l,c[e])},ms_listener:function(Y){Y.addListeners=function(){for(var A=this,o=0;o<lm.length;o++){var T=lm[o];"wheel"===T&&!A.handle_wheel&&A.handle_mousewheel&&(A.handle_wheel=function(O){Im(A,O)}),A["handle_"+T]&&bs(T,A.getView(),A)}},Y.removeListeners=function(){for(var L=this,b=0;b<lm.length;b++)L["handle_"+lm[b]]&&Um(lm[b],L.getView(),L)}},ms_fire:function(a){a.mp=function(l,W,G){this.addPropertyChangeListener(l,W,G)},a.ump=function(F,v){this.removePropertyChangeListener(F,v)},a.fp=function(C,I,U,v,c){return this.firePropertyChange(C,I,U,v,c)},a.addPropertyChangeListener=function(i,s,E){var k=this;k._62I||(k._62I=new pi),k._62I.add(i,s,E)},a.removePropertyChangeListener=function(k,d){this._62I&&this._62I.remove(k,d)},a.firePropertyChange=function(c,H,T,v,U){if(v){if(v(H,T))return!1}else if(H===T)return!1;var q=this,O=U||{};return O.property=c,O.oldValue=H,O.newValue=T,O.source=q,O.data=q,q._62I&&q._62I.fire(O),q.onPropertyChanged&&q.onPropertyChanged(O),!0}},ms_attr:function(y){y.a=function(s,x){var G=this;if(2===arguments.length)G.setAttr(s,x);else{if(!nd(s))return G.getAttr(s);for(var w in s)G.setAttr(w,s[w])}return G},y.getAttr=function(q,d){if(d===Q&&(d=1),this._attrObject&&q in this._attrObject)return this._attrObject[q];if(this.getImage){var L=this.getImage();if(fh(L)&&(L=xk[L]),nd(L)&&"dataBindings"in L)for(var c=L.dataBindings,o=c.length-1;o>=0;o--){var K=c[o];if(K.attr===q){if("defaultValue"in K)return K.defaultValue;break}}}return d?z[q]:Q},y.setAttr=function(s,V){var l=this;l._attrObject||(l._attrObject={});var H=l._attrObject[s];V===Q?delete l._attrObject[s]:l._attrObject[s]=V,l.fp&&l.fp("a:"+s,H,V)&&l.onAttrChanged&&l.onAttrChanged(s,H,V)},y.getSerializableAttrs=function(){var W,J={};for(W in this._attrObject)J[W]=1;return J}},ms_bnb:function(s){s.getBodyColor=function(f){return f.s("body.color")},s.getBorderColor=function($){return $.s("border.color")}},_51o:function(k){k.mi=function(b,F,X){this.addInteractorListener(b,F,X)},k.umi=function(O,g){this.removeInteractorListener(O,g)},k.fi=function(g){this.fireInteractorEvent(g)},k.addInteractorListener=function(E,H,i){var k=this;k._63I||(k._63I=new pi),k._63I.add(E,H,i)},k.removeInteractorListener=function($,U){this._63I&&this._63I.remove($,U)},k.fireInteractorEvent=function(K){this._63I&&this._63I.fire(K)},k.setInteractors=function(p){var T=this,G=T._interactors;G&&G.each(function(E){E.tearDown()}),Ad(p)&&(p=new up(p)),T._interactors=p,p&&p.each(function(F){F.setUp()}),T.fp("interactors",G,p),T.invalidateSelection()},k.getInteractors=function(){return this._interactors}},_49o:function(m){m._44O=I,m._45O=I,m.getTopPainters=function(){return this._44O},m.getBottomPainters=function(){return this._45O},m.addTopPainter=function(D){var Q=this;Q._44O||(Q._44O=new up),Q._44O.contains(D)||(Q._44O.add(D),Q.redraw&&Q.redraw())},m.removeTopPainter=function(I){var C=this;C._44O&&(C._44O.remove(I),C.redraw&&C.redraw())},m.addBottomPainter=function(Y){var M=this;M._45O||(M._45O=new up),M._45O.contains(Y)||(M._45O.add(Y),M.redraw&&M.redraw())},m.removeBottomPainter=function(g){var E=this;E._45O&&(E._45O.remove(g),E.redraw&&E.redraw())},m._93db=function(i,I){var v=this;v._45O&&v._45O.each(function(t){t.draw?t.draw(i,I):t.call(v,i,I)})},m._92db=function(w,c){var e=this;e._44O&&e._44O.each(function(g){g.draw?g.draw(w,c):g.call(e,w,c)})}},ms_sm:function(m){m.sm=function(){return this.getSelectionModel()},m.setSelectableFunc=function(x){this.sm().setFilterFunc(x)},m.getSelectableFunc=function(){return this.sm().getFilterFunc()},m.getSelectionModel=function(){var t=this;return t._selectionModel?t._selectionModel:t.dm().sm()},m.isSelectionModelShared=function(){return!this._selectionModel},m.setSelectionModelShared=function(B){var b=this,z=!b._selectionModel,s=b.handleSelectionChange,p=b.dm();
z!==B&&(b.invalidateSelection&&b.invalidateSelection(),B?(p.sm().ms(s,b),b._selectionModel.ums(s,b),b._selectionModel.dispose(),b._selectionModel=I):(p.sm().ums(s,b),b._selectionModel=new bm(p),b._selectionModel.ms(s,b)),b.onSelectionModelSharedChanged(),b.fp("selectionModelShared",z,B))},m.onSelectionModelSharedChanged=function(){var S=this;S.redraw(),S.invalidateSelection&&S.invalidateSelection()},m.removeSelection=function(){var t=this.dm();t.beginTransaction(),this.sm().toSelection().each(t.remove,t),t.endTransaction()},m.selectAll=function(){var n=this;n.sm().ss(n.dm().toDatas(function(x){return n.isVisible(x)&&n.isSelectable(x)}))},m.isSelected=function(i){return this.sm().co(i)},m.isSelectedById=function(j){var i=this.dm().getDataById(j);return i?this.isSelected(i):!1},m.isSelectable=function(L){return this.sm().isSelectable(L)}},ms_tx:function(b){b._64I=0,b._65O=0,b.isScrollable=function(){return this.getWidth()<this._64I},b._40o=function(){return this.isScrollable()},b.getLogicalPoint=function(B){return pq(B,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},b.tx=function(M){return M===Q?this.getTranslateX():(this.setTranslateX(M),void 0)},b.getTranslateX=function(){return this._65O},b.setTranslateX=function(s){var G=this,Q=G.getWidth()-G._64I;Q>s&&(s=Q),s>0&&(s=0),s=U(s);var E=G._65O;G._65O=s,G.fp(to,E,s)}},ms_ty:function(H){H._23Q=0,H._66O=0,H._41o=function(){return this.getHeight()<this._23Q},H.getLogicalPoint=function(E){return pq(E,this._canvas||this._view,this.tx?this.tx():0,this.ty())},H.ty=function(x){return x===Q?this.getTranslateY():(this.setTranslateY(x),void 0)},H.getTranslateY=function(){return this._66O},H.setTranslateY=function(W){var x=this,D=x.getHeight()-x._23Q;D>W&&(W=D),W>0&&(W=0),W=U(W);var v=x._66O;x._66O=W,x.fp(ai,v,W)}},ms_txy:function(F){F._65O=0,F._66O=0,F.tx=function(d){return d===Q?this.getTranslateX():(this.setTranslateX(d),void 0)},F.ty=function(h){return h===Q?this.getTranslateY():(this.setTranslateY(h),void 0)},F.onTranslateEnded=function(){},F.setTranslate=function(H,z,F){var U=this;if(F=Rc(F)){U._65I&&U._65I.stop(!0);var A=U.tx(),h=U.ty();F.action=function(V){U.setTranslate(A+(H-A)*V,h+(z-h)*V)},F._37o=function(){delete U._66I,delete U._65I,U.onTranslateEnded()},U._66I=1,U._65I=qh(F)}else U.tx(H),U.ty(z)},F.getTranslateX=function(){return this._65O},F.setTranslateX=function(Z){var M=this;Z=M.adjustTranslateX(Z);var H=M._65O;M._65O=Z,M.fp(to,H,Z)},F.getTranslateY=function(){return this._66O},F.setTranslateY=function(P){var c=this;P=c.adjustTranslateY(P);var E=c._66O;c._66O=P,c.fp(ai,E,P)},F.adjustTranslateX=function(S){return U(S)},F.adjustTranslateY=function(x){return U(x)},F.translate=function(F,P,g){this.setTranslate(this.tx()+F,this.ty()+P,g)},F.getLogicalPoint=function(o){var T=this;return pq(o,this._canvas||T._view,T.tx(),T.ty())}},ms_dm:function(B){B.dm=function(W){return W?(this.setDataModel(W),void 0):this.getDataModel()},B.getDataModel=function(){return this._dataModel}},ms_lp:function(s){s.lp=function(H){return this.getLogicalPoint(H)}},ms_v:function(U){U._disabled=!1,U.setDisabled=function(Y,P){var $=this,o=$._disabled;o!==Y&&(o&&(mo($._63O),delete $._63O),Y&&(Ig($._view,$._63O=Vi(P)),$.iv()),$._disabled=Y,$.fp("disabled",o,Y))},U.isDisabled=function(){return this._disabled},U.getDisabledDiv=function(){return this._63O},U.getView=function(){return this._view},U.addToDOM=function(x){var y=this,F=y.getView(),t=F.style;x=x||M.body,x.appendChild(F),t.left="0",t.right="0",t.top="0",t.bottom="0",J(B,"resize",function(){y.iv()}),y.iv()},U.getWidth=function(){return this._view.clientWidth},U.getHeight=function(){return this._view.clientHeight},U.setWidth=function(K){var O=this;O._view.style.width=K+kh,O.iv(),O.fp&&O.fp(Or,I,K)},U.setHeight=function(W){var n=this;n._view.style.height=W+kh,n.iv(),n.fp&&n.fp(Pe,I,W)},U.setFocus=function(P){var z=this,s=z._currentEditor;return P&&s&&(s.getView&&(s=s.getView()),s.contains(P.target))?!1:($f(z._view),z.endEditing&&z.endEditing(),z.fireViewEvent("focus"),!0)},U.iv=function(y){this.invalidate(y)},U.invalidate=function(q){var l=this;l._68I||(l._68I=1,ve(l.validate,l,I,q),l.onInvalidated&&l.onInvalidated(),l.fireViewEvent("invalidate"))},U.validate=function(){var D=this,W=D._view;if(D._68I&&(delete D._68I,W.parentNode))if(0===W.offsetWidth&&0===W.offsetHeight&&D._67I!==I)D._67I===Q&&(D._67I=t.reinvalidateCount),D._67I>0?D._67I--:D._67I=I,D.iv();else{D.fireViewEvent("beginValidate"),D.validateImpl(),D.onValidated&&D.onValidated(),D.fireViewEvent("validate");var b=D._63O;b&&(W.lastChild!==b&&(mo(b),Ig(W,b)),Op(b,0,0,D.getWidth(),D.getHeight())),Ub(D),rc(D),kd(D)}},U.layout=function(k,s,y,q){1===arguments.length?Op(this,k):Op(this,k,s,y,q)},U.addViewListener=function(j,t,A){var s=this;s._67O||(s._67O=new pi),s._67O.add(j,t,A)},U.removeViewListener=function(e,r){this._67O.remove(e,r)},U.fireViewEvent=function(U){var L=this;L._67O&&(fh(U)&&(U={kind:U}),L._67O.fire(U)),t.viewListener&&t.viewListener(L,U)}},ms_tip:function(T){T.setToolTipEnabled=function(C){var N=this;C?Jm||N._13o||(N.enableToolTip(),N.fp("toolTipEnabled",!1,!0)):N._13o&&(N.disableToolTip(),N.fp("toolTipEnabled",!0,!1))},T.isToolTipEnabled=function(){return!!this._13o},T.enableToolTip=function(){var W=this;if(!Jm&&!W._13o){W._13o=function(S){var R=W.getToolTip(S);R!=I?t.toolTipContinual&&t.isToolTipShowing()?zs(S,R):(am(),xf={timeout:V(jn,Of),e:S,info:R}):am()};var Z=W.getView();J(Z,hs,W._13o),J(Z,"mouseleave",t.hideToolTip)}},T.disableToolTip=function(){var O=this;if(O._13o){var K=O.getView();i(K,hs,O._13o),i(K,"mouseleave",t.hideToolTip),delete O._13o}},T.getToolTip=function(A){var Z=this;if(Z.getDataAt){var p=Z.getDataAt(A);return p?p.getToolTip():I}return Z.getValue?Z.getValue():void 0}},_52o:function(m){m._zoom=1,m._29I=Xq,m.zoomIn=function(F,X){this.setZoom(this._zoom*uh,F,X)},m.zoomOut=function(K,c){this.setZoom(this._zoom/uh,K,c)},m.zoomReset=function(F,_){this.setZoom(1,F,_)},m.scrollZoomIn=function(G){this.setZoom(this._zoom*zn,I,G)},m.scrollZoomOut=function(r){this.setZoom(this._zoom/zn,I,r)},m.pinchZoomIn=function(x){this.setZoom(this._zoom*Uh,I,x)},m.pinchZoomOut=function(Z){this.setZoom(this._zoom/Uh,I,Z)},m.adjustZoom=function(o){return Qh>o?Qh:o>qm?qm:o},m.getZoom=function(){return this._zoom},m.setZoom=function(x,y,$){var r=this;if(y=Rc(y)){r._14o&&r._14o.stop(!0);var l=r._zoom;y.action=function(Z){r._96O(l+(x-l)*Z,$)},y._37o=function(){delete r._zooming,delete r._14o,r.onZoomEnded()},r._zooming=1,r._14o=qh(y)}else r._96O(x,$)},m._96O=function(p,S){var g=this;if(p=g.adjustZoom(p),p!==g._zoom){g.validate();var G=g._29I,D=g._zoom;0!==G.width&&0!==G.height&&(S=S?S:{x:G.x+G.width/2,y:G.y+G.height/2},g.tx((S.x-G.x)*D-S.x*p),g.ty((S.y-G.y)*D-S.y*p)),g._zoom=p,g.fp("zoom",D,p)}}},ms_edge:function(C){C._2I=function(d){var q=this;q._44I||(q._44I=new up),q._42I||(q._42I=new up),q._44I.add(d),q._42I.add(d),q._20I()},C._4I=function(F){var Z=this;Z._44I||(Z._44I=new up),Z._43I||(Z._43I=new up),Z._44I.add(F),Z._43I.add(F),Z._20I()},C._16I=function(t){var M=this;M._44I.remove(t),M._42I.remove(t),M._44I.isEmpty()&&delete M._44I,M._42I.isEmpty()&&delete M._42I,M._20I()},C._18I=function(E){var M=this;M._44I.remove(E),M._43I.remove(E),M._44I.isEmpty()&&delete M._44I,M._43I.isEmpty()&&delete M._43I,M._20I()},C._20I=function(){var t=this;if(delete t._45I,!t._44I||t._44I.isEmpty())return delete t._70O,void 0;var n;t._44I.each(function(X){X.isLooped()&&(n||(n={}),n[X._id]||(t._45I||(t._45I=new up),t._45I.add(X),n[X._id]=X))}),n?(t._70O=new up,t._44I.each(function(M){n[M._id]?"A"===n[M._id]||(n[M._id]="A",t._70O.add(M)):t._70O.add(M)})):t._70O=t._44I},C.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},C.getSourceAgentEdges=function(){return this._46I},C.getTargetAgentEdges=function(){return this._47I},C._1I=function(g){var O=this;O._46I||(O._46I=new up),O._48I||(O._48I=new up),O._46I.add(g),O._48I.add(g),O._19I()},C._3I=function(U){var X=this;X._47I||(X._47I=new up),X._48I||(X._48I=new up),X._47I.add(U),X._48I.add(U),X._19I()},C._15I=function(t){var U=this;U._46I.remove(t),U._48I.remove(t),U._46I.isEmpty()&&delete U._46I,U._48I.isEmpty()&&delete U._48I,U._19I()},C._17I=function(Q){var V=this;V._47I.remove(Q),V._48I.remove(Q),V._47I.isEmpty()&&delete V._47I,V._48I.isEmpty()&&delete V._48I,V._19I()},C._19I=function(){var v=this;delete v._49I;var t=v._48I;if(t&&!t.isEmpty()){var B={};t.each(function(u){B[u._id]?v._49I||(v._49I=new up):B[u._id]=u}),v._49I?t.each(function(h){B[h._id]&&(v._49I.add(h),delete B[h._id])}):v._49I=t}},C.getLoopedEdges=function(){return this._45I},C.getEdges=function(){return this._70O},C.getAgentEdges=function(){return this._49I},C.getSourceEdges=function(){return this._42I},C.getTargetEdges=function(){return this._43I},C._8I=function(){this._70O&&this._70O.each(function(p){p._7I()})}}};Fd(t,{getVersion:function(){return"7.0.7-dev15"}},!0),Fd(t,{numberDigits:5,crossOrigin:"",baseZIndex:Q,isTouchable:Jm,devicePixelRatio:B.devicePixelRatio?B.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:j.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return _k},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Jm?20:1,animDuration:200,animEasing:function(N){return N*N},labelColor:zq,labelSelectColor:Uj,labelFont:(Jm?"15":"12")+"px arial, sans-serif",widgetIndent:Jm?30:20,widgetRowHeight:Jm?30:20,widgetHeaderHeight:Jm?32:22,widgetTitleHeight:Jm?34:24,scrollBarColor:ci,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Jm?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:ti,intersectionLineLine:Lr,isEnter:ih,isEsc:uq,isDelete:wq,isSpace:vp,isLeft:Zo,isUp:dk,isRight:ip,isDown:nr,getTarget:vi,isString:fh,isNumber:mm,isBoolean:gj,isArray:Ad,isSelectAll:Fq,isFunction:qi,isObject:nd,getPropertyValue:Lo,setPropertyValue:pc,addMethod:Fd,isMobile:function(){var $;return function(){return $!==Q?$:($=!1,function(M){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(M)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(M.substr(0,4)))&&($=!0)}(navigator.userAgent||navigator.vendor||B.opera),$)}}(),createGradient:function(k,Q,r,K,N,c,l,I){var n=Jh[Q];return n(k,r,K,N,c,l,I)},appendToScreen:function(c){c=c.getView?c.getView():c,(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement||M.body).appendChild(c)},encodeString:function(M){return v.Math.encodeBase64(M,t.encodeStringKey)},decodeString:function(f){return v.Math.decodeBase64(f,t.encodeStringKey)},findView:function(m){var N=function(_,a){var T=a._ht;T&&_.push(T);var C=a.children,e=C.length;if(e)for(var S=0;e>S;S++)N(_,C[S])},k=[];N(k,M.body);var y=function(Y,h){for(var g="2d"===h?om.GraphView:Pm.Graph3dView,P=0,w=Y.length;w>P;P++)if(Y[P]instanceof g)return k[P];return null};return"all"===m?k:"2d"===m?y(k,"2d"):"3d"===m?y(k,"3d"):y(k,"3d")||y(k,"2d")},toggleFullscreen:function(X){var P=X.getView();if(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)M.exitFullscreen?M.exitFullscreen():M.msExitFullscreen?M.msExitFullscreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen&&M.webkitExitFullscreen();else{var r=!0;if(X.isSelfViewEvent){var L=X.getX(),F=X.getY(),N=X.getWidth(),z=X.getHeight(),_=P.style.background,q=P.style.backgroundColor;_||q||(P.style.backgroundColor="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var p=setInterval(function(){if(P!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(p),X.setX(L),X.setY(F),X.setWidth(N),X.setHeight(z),X._fullscreen=!1,P.style.oldBackgroundColor=q,X.iv();else{var y=v.Default.getWindowInfo();(r||y.width!==X.getWidth()||y.height!==X.getHeight())&&(X.setX(y.left),X.setY(y.top),X.setWidth(y.width),X.setHeight(y.height),X._fullscreen=!0,X.iv(),r=!1)}},500)}else{var t=P.style.left,K=P.style.top,N=P.style.width,z=P.style.height,_=P.style.background,q=P.style.backgroundColor;_||q||(P.style.backgroundColor="white"),P.requestFullscreen?P.requestFullscreen():P.msRequestFullscreen?P.msRequestFullscreen():P.mozRequestFullScreen?P.mozRequestFullScreen():P.webkitRequestFullscreen&&P.webkitRequestFullscreen();var p=setInterval(function(){if(P!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(p),P.style.left=t,P.style.top=K,P.style.width=N,P.style.height=z,P.style.oldBackgroundColor=q,X.iv();else{var Z=v.Default.getWindowInfo();(r||Z.width!==X.getWidth()||Z.height!==X.getHeight())&&(Op(X),r=!1)}},500)}}},appendTimeStamp:function(v){return v},setCompType:function(O,T){qi(T)||nd(T)?Md[O]=T:Xo(O)},getCompType:function(w){var I=Md[w];return I===Q&&Mr.test(w)&&Xo(w),I},getCompTypeMap:function(){return Md},drawCompType:function(l,A,P,Y,_,a){l(A,P,Y,_,a)},numberListener:function(){var n={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(C){var G=C.keyCode;n[G]||65===G&&t.isCtrlDown(C)||86===G&&t.isCtrlDown(C)||67===G&&t.isCtrlDown(C)||88===G&&t.isCtrlDown(C)||G>=35&&40>=G||(C.shiftKey||48>G||G>57)&&(96>G||G>105)&&C.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(I){var q=I.target.tagName;("DIV"===q||"CANVAS"===q)&&!(t.ignoreKeyCodes.indexOf(I.keyCode)>=0)&&("keydown"!==I.type||Zo(I)||ip(I)||dk(I)||nr(I)||wq(I)||65===I.keyCode&&(I.metaKey||I.ctrlKey))&&(I.preventDefault(),I.preventManipulation&&I.preventManipulation())},getWindowInfo:function(){var T=M.documentElement,Y=T&&(T.scrollLeft||T.scrollTop)?T:M.body;return{target:Y,left:Y.scrollLeft,top:Y.scrollTop,width:B.innerWidth||Y.clientWidth,height:B.innerHeight||Y.clientHeight}},isDragging:function(){return!!_k},isLeftButton:function(Q){return Jm?!0:0===Q.button},isMiddleButton:function(m){return Jm?!1:m&&(1===m.button||4&(m.buttons||0))},isRightButton:function(H){return Jm?!1:H&&(2===H.button||2&(H.buttons||0))},isInput:function(I){if(!I)return!1;var l=I.tagName;return"INPUT"===l||"TEXTAREA"===l||"SELECT"===l},getTouchCount:function(D){return Jm?D.touches.length:1},isDoubleClick:function(){function M(a){a.details=0,a.timeout=null,a.lastPoint=null}var N={};return ng=new A,Cd=ng.getTime(),function(B){if(B.touches&&B.touches.length>1)return!1;var l=B.button==I?"":B.button,r=B.type+l,H=r+"_isDoubleClick",h=N[r];if(h||(h=N[r]={details:0,timeout:null,lastPoint:null}),B[H]===Q){B[H]=!0;var x=hb(B);h.timeout&&(S(h.timeout),h.timeout=null),h.lastPoint&&Oj(h.lastPoint,x)>t.doubleClickRange&&M(h),h.lastPoint=x,h.details++,h.timeout=V(function(){M(this)}.bind(h),500)}return 2===h.details}}(),isShiftDown:function(Z){return Z?Z.shiftKey:Le["16"]},isCtrlDown:function(x){return x?me?x.metaKey:x.ctrlKey:me?Le["91"]:Le["17"]},getClientPoint:function(i){return Jm&&(i=le(i)),{x:i.clientX,y:i.clientY}},isMouseEvent:function(h){return h instanceof MouseEvent||0===h.type.indexOf("mouse")},getTargetElement:function(i){if(t.isMouseEvent(i)||!M.elementFromPoint)return i.target;var P=mr(i);return M.elementFromPoint(P.x,P.y)},getPagePoint:function(X){return Jm&&(X=le(X)),{x:X.pageX,y:X.pageY}},createObject:function(h,n){var l=new h;for(var P in n){var b=n[P];if(qi(b))l[P]=b;else if(0===P.indexOf("s:"))l.s(P.substr(2),n[P]);else if(0===P.indexOf("a:"))l.a(P.substr(2),n[P]);else{var I=Om(P),b=n[P];l[I]?(l[I](b),"setToolTip"===I&&l.enableToolTip&&l.enableToolTip()):l[P]=b}}return l},setImage:function(c,S,m,D){var o=arguments.length;4===o?zk(c,D,S,m):2===o?fh(S)?zk(c,S):gm(c,S):1===o&&zk(c,c)},getImage:function(T,e,o){var Y;if(T==I)return I;if(nd(T)?Y=T:(Y=xk[T],T&&Y===Q&&(ae&&ae[T]||zk(T,T))),e&&Y&&Y.tagName){var c;c="override"===o?"colors_override":"override_rgb"===o?"colors_override_rgb":"override_a"===o?"colors_override_a":"colors",Y[c]||(Y[c]={__count__:0});var C=Y[c][e];return C||(Y[c].__count__>t.imageCacheThreshold&&(Y[c]={__count__:0}),C=tp(Y,An(e),Y.width,Y.height,o),Y[c][e]=C,Y[c].__count__++),C}return Y},isImageComplete:function(U,T,x){var N=Bn(U);if(!N)return!1;if(N.tagName)return N.complete;for(var E,U,l,F=N.comps,y=!0,P=0,b=F.length;b>P;P++)if(E=F[P],l=E.type,"image"===E.type){U=E.name,U&&U.func&&(U=Nq(U,T));var Y=Kn(U,T,x);if(!Y){y=!1;break}}else if(Mr.test(l)&&t.getCompType(l)===Q){y=!1,Xo(l);break}return y},getId:function(){var S=1;return function(){return++S}}(),callLater:function(A,L,p,U){var C=function(){A.apply(L,p)};return U?V(C,U):B.requestAnimationFrame(C)},cancelLater:function(V,o){o?S(V):B.cancelAnimationFrame(V)},clone:function(j){if(null==j||"object"!=typeof j)return j;if(j instanceof Date){var U=new Date;return U.setTime(j.getTime()),U}if(j instanceof Array){for(var U=[],x=0,G=j.length;G>x;x++)U[x]=Gk(j[x]);return U}if(j instanceof up){for(var U=new up,x=0,G=j.length;G>x;x++)U.set(x,Gk(j.get(x)));return U}if(j instanceof Fh)return j;if(j instanceof Y){var U={};for(var c in j)j.hasOwnProperty(c)&&(U[c]=Gk(j[c]));return U}return j},callWhenLoaded:function(R,x){x=x||100;var d=oj(R,x);ne||(ne={}),ne[d]={tick:d,cb:R,delay:x}},beforeLoadURL:function(E,v){if(ne){var V={};for(var v in ne){var n=ne[v];S(n.tick);var k=oj(n.cb,n.delay);V[k]={tick:k,delay:n.delay,cb:n.cb}}ne=V}return t.convertURL?t.convertURL(E,v):E},convertURL:function(K){return K},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return t.getImage("default_blank")},resizeImagePOT:function(F,$){if(!F||!F.tagName)return F;var Y=F.width,J=F.height;if(!Y||!J)return F;if(Qg.isPOT(Y)&&Qg.isPOT(J)&&(!$||Y===J))return F;var E,g;$?g=E=Qg.nearestPOT(Math.min(Y,J)):(E=Qg.nearestPOT(Y),g=Qg.nearestPOT(J));var t=Sg(),W=t.getContext("2d");return sg(t,E,g,1),W.drawImage(F,0,0,Y,J,0,0,E,g),t},sortFunc:function(J,y){if(J===y)return 0;if(J==I&&y!=I)return 1;if(J!=I&&y==I)return-1;if(J==I&&y==I)return 0;var j,C=typeof J,m=typeof y;return C===un&&m===un?j=J.localeCompare(y):C===hf&&m===hf&&(j=J-y),j===Q&&(j=(""+J).localeCompare(""+y)),j>0?1:0>j?-1:0},getClassMap:function(){return Aj},getClass:function(Y){if(fh(Y)){var z,j=Aj[Y];if(!j){z=Y.split("."),j=B;for(var v=0;v<z.length;v++)j=j[z[v]];Aj[Y]=j}return j}return Y},def:function(W,f,$){var A,r,E,Q=function(){};if(Q.prototype=f.prototype,A=new Q,fh(W)){if(Aj[W])throw"'"+W+"' already defined";E=Mj(W),A.getClassName=function(){return W}}else E=W;if(A.constructor=E,A.getClass=function(){return E},A.getSuperClass=function(){return f},$)for(r in $)hl[r]&&hl.hasOwnProperty(r)?hl[r](A,$):Rj(A,$,r);E.prototype=A,E.superClass=f.prototype},startAnim:function(){var Q=function(W){W.duration&&(W.startTime=Fc()),W.timeId=ve(W.tick,I,I,W.interval)};return function(p){return p=Gk(p),p.easing=p.easing||t.animEasing,p.duration||p.frames||(p.duration=t.animDuration),p.t=0,p.duration?p.interval=0:(p.frame=0,p.interval=p.interval||10),p.tick=function(){if(p.duration){var u=(Fc()-p.startTime)/p.duration;if(u>1&&(u=1),p.t=u,p.action(p.easing(u),u),!p.isRunning())return;1===u?p.stop():p._isPaused||(p.timeId=ve(p.tick))}else{if(p.frame++,u=p.t=p.frame/p.frames,p.action(p.easing(u),u),!p.isRunning())return;p.frame<p.frames?p._isPaused||(p.timeId=ve(p.tick,I,I,p.interval)):p.stop()}},p.resume=function(){p._isPaused&&(delete p._isPaused,p.duration?p.t<1&&(p.startTime=Fc()-p.duration*p.t,p.timeId=ve(p.tick)):p.frame<p.frames&&(p.timeId=ve(p.tick,I,I,p.interval)))},p.pause=function(){hr(p.timeId,!p.duration),p._isPaused=!0},p.isPaused=function(){return this._isPaused},p.stop=function(V){p.isRunning()&&(hr(p.timeId,!p.duration),delete p.timeId,p.duration?p.t<1&&V&&(p.t=1,p.action(p.easing(1),1)):p.frame<p.frames&&V&&(p.frame=p.frames,p.action(p.easing(1),1)),p._37o&&p._37o(),p.finishFunc&&p.finishFunc())},p.isRunning=function(){return p.timeId!=I},p.delay?ve(Q,I,[p],p.delay):Q(p),p}}(),getTextSize:function(){var A={},H=M?Sg().getContext("2d"):I;return function(w,F){H.font=w?w:nk;var R=A[H.font];return R||(R=2*H.measureText("e").width+4,A[H.font]=R),{width:H.measureText(F).width+4,height:R}}}(),drawText:function(x,N,j,H,K,D,L,w,u,c){if(N!=I){var o=Cg(j,N),n={};n.y=c&&c!==fc?c===hq?D+o.height/2:D+w-o.height/2:D+w/2,n.x=u&&u!==Hd?u===Np?K+L-o.width/2:K+L/2:K+o.width/2,Pi(x,N,n,j,H)}},getDistance:function(v,g){var r=v.length;return g?3===r?K(y(v[0]-g[0])+y(v[1]-g[1])+y(v[2]-g[2])):2===r?K(y(v[0]-g[0])+y(v[1]-g[1])):v.z===Q?K(y(g.x-v.x)+y(g.y-v.y)):K(y(g.x-v.x)+y(g.y-v.y)+y(g.z-v.z)):3===r?K(y(v[0])+y(v[1])+y(v[2])):2===r?K(y(v[0])+y(v[1])):void 0},brighter:function(K,q){return 0>q&&(q=-q),lf(K,q?q:40)},darker:function(v,D){return D>0&&(D=-D),lf(v,D?D:-40)},unionPoint:function(g,q){if(!g)return I;if(2===arguments.length)return g&&q?{x:r(g.x,q.x),y:r(g.y,q.y),width:H(g.x-q.x),height:H(g.y-q.y)}:I;var R=g;if(R._as&&(R=R._as),R.length===Q)return I;var v=R.length;if(0>=v)return I;for(var m=1,W=R[0],p={x:W.x,y:W.y,width:0,height:0};v>m;m++){W=R[m];var J=r(p.x,W.x),L=P(p.x+p.width,W.x),x=r(p.y,W.y),k=P(p.y+p.height,W.y);p.x=J,p.y=x,p.width=L-J,p.height=k-x}return p},unionRect:function(X,D){if(X&&!D)return Gk(X);if(!X&&D)return Gk(D);if(X&&D){var j={x:r(X.x,D.x),y:r(X.y,D.y)};return j.width=P(X.x+X.width,D.x+D.width)-j.x,j.height=P(X.y+X.height,D.y+D.height)-j.y,j}return I},containsPoint:function(D,V,q,z){if(z!=I&&1!==z){var o=D.x+D.width/2,c=D.y+D.height/2;D={x:o-D.width/2*z,y:c-D.height/2*z,width:D.width*z,height:D.height*z}}if(q){var g=D.width/2,U=D.height/2,f=C(-q),X=x(-q),H=V.x-D.x-g,Y=V.y-D.y-U;return V={x:X*H-f*Y,y:f*H+X*Y},Vl({x:-g,y:-U,width:D.width,height:D.height},V)}return!(!D||V.x<D.x||V.y<D.y||V.x>D.x+D.width||V.y>D.y+D.height)},containsRect:function(a,D){if(!a||!D)return!1;var e=D.x,R=D.y,C=D.width,A=D.height,n=a.width,O=a.height;if(0>(n|O|C|A))return!1;var B=a.x,m=a.y;if(B>e||m>R)return!1;if(n+=B,C+=e,e>=C){if(n>=B||C>n)return!1}else if(n>=B&&C>n)return!1;if(O+=m,A+=R,R>=A){if(O>=m||A>O)return!1}else if(O>=m&&A>O)return!1;return!0},intersectsRect:function(l,a){if(!l||!a)return!1;var T=a.width,E=a.height,j=l.width,G=l.height;if(0>=j||0>=G||0>=T||0>=E)return!1;var V=a.x,Q=a.y,g=l.x,q=l.y;return j+=g,G+=q,T+=V,E+=Q,j>V&&G>Q&&T>g&&E>q},intersection:function(w,R){if(!w||!R)return I;var G=R.x,D=R.y,n=w.x,E=w.y,f=G,u=D,H=n,X=E;return f+=R.width,u+=R.height,H+=w.width,X+=w.height,n>G&&(G=n),E>D&&(D=E),f>H&&(f=H),u>X&&(u=X),f-=G,u-=D,0>=f||0>=u?I:{x:G,y:D,width:f,height:u}},grow:function(r,C,v){v===Q&&(v=C),r.x-=C,r.y-=v,r.width=r.width+2*C,r.height=r.height+2*v},getScreenPoint:function(M,Z,n,w,f,X,i){var $=n.getBoundingClientRect(),A=M*(X||1)-n.scrollLeft+(w||0),y=Z*(i||1)-n.scrollTop+(f||0),N=Dm(n,!1);if(N){var q=new He(A,y,0);return q.applyMatrix4(N),console.log(q),{x:q.x,y:q.y}}return{x:A+$.left,y:y+$.top}},getLogicalPoint:function(V,Y,u,C,S,F){var W,O,b=Y.getBoundingClientRect();V.target?(Ic(V)?me?Le["91"]=!0:Le["17"]=!0:me?Le["91"]=!1:Le["17"]=!1,Le["16"]=Kh(V)?!0:!1,V=Jm?le(V):V,W=V.clientX,O=V.clientY):(W=V.x,O=V.y);var n=Dm(Y,!0);if(n){var M=new He(W,O,0);M.applyMatrix4(n);do{if(Math.abs(M.z)<=1e-6)break;var h=new He(W,O,1);if(h.applyMatrix4(matrix),Math.abs(h.z)<=1e-6){M=h;break}if(h.sub(M),Math.abs(h.z)<=1e-6)break;M.addScaledVector(h,-M.z/h.z)}while(!1);return{x:(M.x+Y.scrollLeft-(u||0))/(S||1),y:(M.y+Y.scrollTop-(C||0))/(F||1)}}return{x:(W-b.left+Y.scrollLeft-(u||0))/(S||1),y:(O-b.top+Y.scrollTop-(C||0))/(F||1)}},removeHTML:function(){var v;return function(t){return t&&t.getView&&(t=t.getView()),t&&t.parentNode?v===t?!0:(v=t,t.parentNode.removeChild(t),v=I,!0):!1}}(),getToolTipDiv:function(){if(!Rr){Rr=Tj(),Ze=Tj();var G=Rr.style;t.baseZIndex!=I&&(G.zIndex=R(t.baseZIndex)+3+""),G.whiteSpace="nowrap",G.color=t.toolTipLabelColor,G.background=t.toolTipBackground,G.font=t.toolTipLabelFont,G.padding="5px",G.boxShadow="0px 0px 3px "+t.toolTipShadowColor}return Rr},isToolTipShowing:function(){return Rr&&Rr.parentNode?!0:Ze&&Ze.parentNode?!0:!1},hideToolTip:function(){mo(Rr),mo(Ze),se()},showToolTip:function(Q,z){if(!Q||z==I)return am(),void 0;t.getToolTipDiv();var h,X;if(z.html?(z=z.html,h=Ze,mo(Rr)):(h=Rr,mo(Ze)),X=h.style,h.innerHTML=z,h.parentNode||v.Default.appendToScreen(h),Q.target){Q=mr(Q);var Y=Qb(),q=Q.x,Z=Q.y,M=Jm?60:12;if(Jm){var y=h.getBoundingClientRect();X.left=q-y.width/2+kh,X.top=Z-y.height-M<Y.top?Z+M+kh:Z-y.height-M+kh}else{X.left=q+M+kh,X.top=Z+M+kh;var y=h.getBoundingClientRect();y.left+y.width>Y.width&&(X.left=q-M-y.width+kh),y.top+y.height>Y.height&&(X.top=Z-M-y.height+kh),y.left<0&&(X.left=q+M+kh),y.top<0&&(X.top=Z+M+kh)}}else X.left=Q.x+kh,X.top=Q.y+kh;se()},startDragging:function(X,H,h){h==Q&&(h=!0),X!==_k&&(_k?h&&(Jm?_k.handleWindowTouchEnd(H):_k.handleWindowMouseUp(H)):Jm?(J(B,_l,Yf),J(B,rp,Pk)):(J(B,hs,vj),J(B,fl,Vq)),_k=X)},getImageMap:function(){return xk},toBoundaries:function(W,N,V,S){var x=[];return wn(W,N,V,S).forEach(function(D){var K=[];D.forEach(function(a){K.push(a.x,a.y)}),x.push(K)}),x},getCurrentKeyCodeMap:function(){return Le},drawCenterImage:function(V,v,w,S,X,$,h,y){!X&&$&&$.isSelfViewEvent&&(X=$);var c=vk(v,X,$),m=ns(v,X,$);Kk(V,v,U(w-c/2),U(S-m/2),c,m,X,$,h,y)},drawStretchImage:function(m,T,Y,E,e,V,O,H,w,d,R,D){!H&&w&&w.isSelfViewEvent&&(H=w);var C,Q=vk(T,H,w,V),J=ns(T,H,w,O);"uniform"===Y?(C=r(V/Q,O/J),Q*=C,J*=C,E+=U((V-Q)/2),e+=U((O-J)/2),V=Q,O=J):"centerUniform"===Y&&((Q>V||J>O)&&(C=r(V/Q,O/J),Q*=C,J*=C),E+=U((V-Q)/2),e+=U((O-J)/2),V=Q,O=J);var W=m.interactiveInfo;if(W){var A;if(A="center"===Y?{x:E+V/2-Q/2,y:e+O/2-J/2,width:Q,height:J}:{x:E,y:e,width:V,height:O},W.rect){var c=W.compInfos,_=c.length;_&&(c[_-1].rect.image=T)}else W.rect=A}if("center"===Y){var t=R!==!1&&(Q>V||J>O);t&&(m.save(),m.beginPath(),m.rect(E,e,V,O),m.clip()),Kk(m,T,E+V/2-Q/2,e+O/2-J/2,Q,J,H,w,d,D),t&&m.restore()}else Kk(m,T,E,e,V,O,H,w,d,D)},toCanvas:function(K,t,q,V,i,E,Y,w,Z){K=Bn(K,Y),t=t||vk(K,i),q=q||ns(K,i);var b=Sg(),O=Ye(b);return w?(sg(b,t,q,w),O.scale(w,w)):sg(b,t,q,1),ck(O,K,V,0,0,t,q,i,E,Y,Z),K&&K.clampToEdge&&(b.clampToEdge=K.clampToEdge),O.restore(),b},toGrayColor:function(m){if(!m)return m;var q=Up(m),C=U(.299*q[0]+.587*q[1]+.114*q[2]);return"rgba("+C+","+C+","+C+","+q[3]/255+")"},createGradientImage:function(s,j,I,z){for(var C=["L",0,0,s,0,1,0,0,1,0,0],t=0,L=Math.min(j.length,I.length);L>t;t++)C.push(I[t],j[t]);var A=v.Default.toCanvas({width:s,height:s,clampToEdge:!0,comps:[{type:"shape",rotation:z||0,points:[0,0,s,0,s,s,0,s],background:"#ffffff",gradientPack:C}]});return A},createElement:function(Q,$,h,m){var R=M.createElement(Q);return dq(R,$||j.widgetBorder,2),R.style.font=h?h:nk,m!=I&&(R.value=m),t.onElementCreated&&t.onElementCreated(R),R},containedInView:function(K,j){var $=mf(j).getBoundingClientRect();return Vl({x:$.left,y:$.top,width:$.width,height:$.height},hb(K))},isIsolating:function(){return db>0},setIsolating:function(m){m?db++:db--},getMSMap:function(){return hl},stringify:function(O,K,h){var F=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var Q=JSON.stringify(O,function(m,O){return"function"==typeof O?"__ht__"+(O.__ht__||O.toString()):mm(O)?aj(O):O instanceof v.List?"__ht__list"+(O.__ht__list||t.stringify(O._as)):O},K==I?2:K);return Date.prototype.toJSON=F,h&&(Q="__ht__encode"+t.encodeString(Q)),Q},parse:function(v){return fh(v)?"__ht__encode"!=v.substr(0,12)||(v=t.decodeString(v.substr(12)),fh(v))?JSON.parse(v,function(M,C){if(fh(C))if("__ht__function"==C.substr(0,14)){var P=C.indexOf("{")+1,Q=C.lastIndexOf("}"),c=C.indexOf("(")+1,G=C.indexOf(")");if(P&&Q&&c&&G){var $=new Function(C.substring(c,G),C.substring(P,Q));return $.__ht__=C.substr(6),$}}else{if("__ht__date"==C.substr(0,10))return new Date(R(C.substr(10)));if("__ht__list"===C.substr(0,10))return new up(t.parse(C.substr(10)))}return C}):v:v},loadJS:function(S,$){$&&S.push($);var b=S.shift();if(Ad(b))S=b.contact(S),t.loadJS(S);else if(qi(b))b(),t.loadJS(S);else if(fh(b)){var p=M.createElement("script");p.onload=function(){t.loadJS(S)},p.setAttribute("src",b),M.getElementsByTagName("head")[0].appendChild(p)}else S.length&&t.loadJS(S)},toRoundedCorner:function(){function c(l,q,g){l.x=q.x,l.y=q.e||g,l.z=q.y}var A=new He,n=new He,T=new He,N=new He;return function(l,H){var s,D=0;l.getPoints&&(D=l.getElevation(),l=l.getPoints()),s=l instanceof up?l:new up(l);var R=s.size();if(0>=H)return{points:s};var i=new up,v=new up,M=s.get(0);c(A,M,D),i.add(M),v.add(1);for(var j=1;R>j;j++)if(R>j+1){var o=s.get(j),Z=s.get(j+1);c(n,o,D),c(T,Z,D),N.subVectors(A,n).setLength(Math.min(.99*N.length(),H)).add(n),o.e!==Q||M.e!==Q?i.add({x:N.x,y:N.z,e:N.y}):i.add({x:N.x,y:N.z}),i.add(o),N.subVectors(T,n).setLength(Math.min(.99*N.length(),H)).add(n),o.e!==Q||Z.e!==Q?i.add(M={x:N.x,y:N.z,e:N.y}):i.add(M={x:N.x,y:N.z}),A.copy(N),v.addAll([2,3])}else i.add(s.get(j)),v.add(2);return{points:i,segments:v}}}(),toColorData:Up,setCanvas:sg,createDiv:Tj,createDisabledDiv:Vi,createView:Th,createCanvas:Sg,appendChild:Ig,initContext:Ye,checkLoadingImage:Ub,translateAndScale:Dj,layout:Op,getPosition:Ke,drawPoints:Hg,drawRoundRect:nf,drawBorder:_d,setFocus:$f,getter:lo,setter:Om,isEmptyObject:Gi,cameraPriority:function(){var A={skybox:0,main:1e4,top:1e7};return Y.seal(Y.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return A.skybox},set:function(G){if(G>=A.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");A.skybox=Number(G)}},main:{configurable:!1,enumerable:!1,get:function(){return A.main},set:function(r){if(r<=A.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(r>=A.top)throw new RangeError("Main camera must have lower priority than the top camera.");A.main=Number(r)}},top:{configurable:!1,enumerable:!1,get:function(){return A.top},set:function(c){if(c<=A.main)throw new RangeError("Top camera must have higher priority than the main camera.");
A.top=Number(c)}}}))}()},!0),Fd(O,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var ls=t.disabledOpacity,Of=t.toolTipDelay,Bh=t.devicePixelRatio,yo=t.autoMakeVisible,ed=t.autoHideScrollBar,pe=t.imageGradient,zs=t.showToolTip,am=t.hideToolTip,aq=t.dashPattern,Og=t.lineCap,Ul=t.lineJoin,yl=t.labelColor,Uk=t.labelSelectColor,nk=t.labelFont,Xh=t.widgetIndent,$l=t.widgetRowHeight,eh=t.widgetHeaderHeight,Ng=t.widgetTitleHeight,Ib=t.scrollBarColor,js=t.scrollBarSize,Ji=t.scrollBarTimeout,ln=t.scrollBarMinLength,gr=t.scrollBarInteractiveSize,uh=t.zoomIncrement,zn=t.scrollZoomIncrement,Uh=t.pinchZoomIncrement,qm=t.zoomMax,Qh=t.zoomMin,jq=t.createObject,Rg=t.preventDefault,_e=t.setImage,Bn=t.getImage,Kn=t.isImageComplete,Kd=t.drawCenterImage,ck=t.drawStretchImage,um=t.getId,ve=t.callLater,hr=t.cancelLater,es=t.sortFunc,Gk=t.clone,Mj=t.getClass,qh=t.startAnim,Oo=t.brighter,Sc=t.darker,Ac=t.drawText,Cg=t.getTextSize,Qn=t.isLeftButton,Ei=t.isMiddleButton,Wf=t.isRightButton,Em=t.getTouchCount,Mb=t.isDoubleClick,Kh=t.isShiftDown,Ic=t.isCtrlDown,hb=t.getClientPoint,mr=t.getPagePoint,Oj=t.getDistance,Hj=t.unionPoint,Jq=t.unionRect,Vl=t.containsPoint,Zp=t.containsRect,zr=t.intersectsRect,vo=t.intersection,Qb=t.getWindowInfo,tb=t.grow,pq=t.getLogicalPoint,ze=t.getScreenPoint,_g=t.startDragging,mo=t.removeHTML,sn=t.createElement,Cb=t.segmentResolution,yq=t.shapeResolution,cl=t.shapeSide,Rq=t.def,$b=function(e,h,p){Rq(Z+"."+e,h,p)},$c=function(X,f){X.childNodes.forEach(function(E){f(E),$c(E,f)})};Fd(t,{toolTipLabelColor:yl,toolTipLabelFont:nk,toolTipBackground:j.toolTipBackground,toolTipShadowColor:ci,debugTipLabelFont:nk,debugTipLabelColor:yl,debugTipBackground:j.toolTipBackground,drawBreakableText:Dq,setDevicePixelRatio:function(v){Bh=t.devicePixelRatio="number"==typeof v?v:B.devicePixelRatio,$c(M.body,function(a){var k=a._ht;k&&k._canvas&&(sg(k._canvas,k.getWidth(),k.getHeight()),k.redraw?k.redraw():k.iv())})}},!0);var Qq=1e-6,oh="undefined"!=typeof Uint16Array?Uint16Array:Array,Ko="undefined"!=typeof Float32Array?Float32Array:Array,Ti=function(M,L,P){var p=[M[0]-L[0],M[1]-L[1],M[2]-L[2]];if(P){var T=Oj(p);T>0&&(p[0]/=T,p[1]/=T,p[2]/=T)}return p},Mg=function(){var n="charCodeAt",R=2*(2*sq.length+1);for(var x in B)if(x===Z+Hd[0]+(kh.length+2)){var p=B[x];if(!p)break;for(var A=p.length,U=0;A>U;U++)if(p[U][n](0)===R&&p[U+1]!=I&&p[U+1]===kh[0]&&p[U+2]!=I&&p[U+2][n](0)===R){for(var k=U+3;A>k;k++)if(p[k][n](0)===R){if(0==p[k+1])for(var K,i=k+2;A>i;i++){if(p[i][n](0)===R){0==p[i-1]&&K&&(bk=K.substr(0,K.length-1));break}K==I?K=p[i]:K+=p[i]}break}break}break}return function(m){return[-m[0],-m[1],-m[2]]}}(),nn=function(I,b){return 3===I.length?I[0]*b[0]+I[1]*b[1]+I[2]*b[2]:I[0]*b[0]+I[1]*b[1]},Tf=function(){var H=new Ko(16);return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},Cm=Tf(),no=function(T){var Q=new Ko(16);return Q[0]=T[0],Q[1]=T[1],Q[2]=T[2],Q[3]=T[3],Q[4]=T[4],Q[5]=T[5],Q[6]=T[6],Q[7]=T[7],Q[8]=T[8],Q[9]=T[9],Q[10]=T[10],Q[11]=T[11],Q[12]=T[12],Q[13]=T[13],Q[14]=T[14],Q[15]=T[15],Q},Er=function(j,t){return j[0]=t[0],j[1]=t[1],j[2]=t[2],j[3]=t[3],j[4]=t[4],j[5]=t[5],j[6]=t[6],j[7]=t[7],j[8]=t[8],j[9]=t[9],j[10]=t[10],j[11]=t[11],j[12]=t[12],j[13]=t[13],j[14]=t[14],j[15]=t[15],j},rs=function(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M},Tl=function(w,E){var S=w[0],J=w[1],A=w[2];return w[0]=E[0]*S+E[4]*J+E[8]*A+E[12],w[1]=E[1]*S+E[5]*J+E[9]*A+E[13],w[2]=E[2]*S+E[6]*J+E[10]*A+E[14],w},Nc=function(y,M){var h=y[0],l=y[1],J=y[2],x=y[3];return y[0]=M[0]*h+M[4]*l+M[8]*J+M[12]*x,y[1]=M[1]*h+M[5]*l+M[9]*J+M[13]*x,y[2]=M[2]*h+M[6]*l+M[10]*J+M[14]*x,y[3]=M[3]*h+M[7]*l+M[11]*J+M[15]*x,y},yf=function(){var h,M,l,O,B=Xe(Tb[1]+Tb[7]),G=Xe(Tb[0]+Tb[3]-Tb[10]),T=Xe(Tb[8]+2),b=function(){return M=l.charAt(h),h+=1,M},K=function(){var S="";if(M===T)for(;b();){if(M===T)return b(),S;S+=M}else b()},F=function(){for(;M&&" ">=M;)b()},f=function(){var C,J={};if(M===B){if(b(),F(),M===G)return b(),J;for(;M;){if(C=K(),F(),b(),J[C]=O(),F(),M===G)return b(),J;b(),F()}}};return O=function(){switch(F(),M){case B:return f();default:return K()}},function(Z){if(L={},Z){var H;if(l=Z,h=0,M=" ",H=O(),F(),!M)return H}}}(),os=function(P,l){if(l){var V=C(l),H=x(l),t=P[4],v=P[5],J=P[6],W=P[7],Y=P[8],U=P[9],X=P[10],h=P[11];P[4]=t*H+Y*V,P[5]=v*H+U*V,P[6]=J*H+X*V,P[7]=W*H+h*V,P[8]=Y*H-t*V,P[9]=U*H-v*V,P[10]=X*H-J*V,P[11]=h*H-W*V}},Rb=function(l,Y){if(Y){var z=C(Y),s=x(Y),$=l[0],B=l[1],Z=l[2],t=l[3],I=l[8],M=l[9],P=l[10],f=l[11];l[0]=$*s-I*z,l[1]=B*s-M*z,l[2]=Z*s-P*z,l[3]=t*s-f*z,l[8]=$*z+I*s,l[9]=B*z+M*s,l[10]=Z*z+P*s,l[11]=t*z+f*s}},Vg=function(q,P){if(P){var E=C(P),F=x(P),$=q[0],B=q[1],t=q[2],O=q[3],D=q[4],f=q[5],h=q[6],g=q[7];q[0]=$*F+D*E,q[1]=B*F+f*E,q[2]=t*F+h*E,q[3]=O*F+g*E,q[4]=D*F-$*E,q[5]=f*F-B*E,q[6]=h*F-t*E,q[7]=g*F-O*E}},vh=function(W,e,o){return ph(I,o===!1?I:W.getFinalScale3d(),W.getFinalRotation3d(),W.getRotationMode(),W.p3(),I,e)},ph=function(T,c,B,h,Z,R,V){return R||(R=Tf()),Z&&kl(R,Z),Dn(R,B,h),V&&Xb(R,R,V),c&&Ff(R,c),T&&Xb(R,R,T),R},Nj=function(s,U,L){U=R(U),L=R(L);var m=this;m.g=s,m._84O=U,m._85O=L,m._70I=!0,m.F=0,m._83O=U+L,m.pen={x:0,y:0}},ds="lineDashOffset",wl="setLineDash",El=function(m){for(var T in m)1===T.length&&(ds=m[T]);return T?1:0},Zl=function(l,M,q){return rl(M)?l:l[wl]?(l[wl](M),q&&(l.lineDashOffset=q),l):new Nj(l,M[0],M.length>1?M[1]:M[0])},ol=function(q,a){!rl(a)&&q[wl]&&(q[wl](Cl),q.lineDashOffset=0)};if(Rq(Nj,Y,{_69I:6,moveTo:function(Y,W){var p=this,A=p.pen;A.x=Y,A.y=W,p.g.moveTo(Y,W),p.start||(p.start={x:Y,y:W})},lineTo:function(s,F){var y=this,L=y.pen,t=s-L.x,c=F-L.y,i=$(c,t),U=x(i),T=C(i),G=y._23O(L.x,L.y,s,F),Y=y._85O,m=y._84O,h=y._83O;if(y.F){if(y.F>G)return y._70I?y._72I(s,F):y.moveTo(s,F),y.F-=G,void 0;if(y._70I?y._72I(L.x+U*y.F,L.y+T*y.F):y.moveTo(L.x+U*y.F,L.y+T*y.F),G-=y.F,y.F=0,y._70I=!y._70I,!G)return}var b=e(G/h);if(b){for(var W=U*m,n=T*m,E=U*Y,J=T*Y,O=0;b>O;O++)y._70I?(y._72I(L.x+W,L.y+n),y.moveTo(L.x+E,L.y+J)):(y.moveTo(L.x+E,L.y+J),y._72I(L.x+W,L.y+n));G-=h*b}y._70I?G>m?(y._72I(L.x+U*m,L.y+T*m),y.moveTo(s,F),y.F=Y-(G-m),y._70I=!1):(y._72I(s,F),G===m?(y.F=0,y._70I=!y._70I):(y.F=m-G,y.moveTo(s,F))):G>Y?(y.moveTo(L.x+U*Y,L.y+T*Y),y._72I(s,F),y.F=m-(G-Y),y._70I=!0):(y.moveTo(s,F),G===Y?(y.F=0,y._70I=!y._70I):y.F=Y-G)},quadraticCurveTo:function(u,G,K,d){var i,k=this,U=k.pen,P=U.x,E=U.y,I=k._22O(P,E,u,G,K,d),D=0,s=0,V=k._85O,A=k._84O;if(k.F){if(k.F>I)return k._70I?k._71I(u,G,K,d):k.moveTo(K,d),k.F-=I,void 0;if(D=k.F/I,i=k._20O(P,E,u,G,K,d,D),k._70I?k._71I(i[2],i[3],i[4],i[5]):k.moveTo(i[4],i[5]),k.F=0,k._70I=!k._70I,!I)return}var r=I-I*D,Z=e(r/k._83O),O=A/I,o=V/I;if(Z)for(var q=0;Z>q;q++)k._70I?(s=D+O,i=k._21O(P,E,u,G,K,d,D,s),k._71I(i[2],i[3],i[4],i[5]),D=s,s=D+o,i=k._21O(P,E,u,G,K,d,D,s),k.moveTo(i[4],i[5])):(s=D+o,i=k._21O(P,E,u,G,K,d,D,s),k.moveTo(i[4],i[5]),D=s,s=D+O,i=k._21O(P,E,u,G,K,d,D,s),k._71I(i[2],i[3],i[4],i[5])),D=s;r=I-I*D,k._70I?r>A?(s=D+O,i=k._21O(P,E,u,G,K,d,D,s),k._71I(i[2],i[3],i[4],i[5]),k.moveTo(K,d),k.F=V-(r-A),k._70I=!1):(i=k._19O(P,E,u,G,K,d,D),k._71I(i[2],i[3],i[4],i[5]),I===A?(k.F=0,k._70I=!k._70I):(k.F=A-r,k.moveTo(K,d))):r>V?(s=D+o,i=k._21O(P,E,u,G,K,d,D,s),k.moveTo(i[4],i[5]),i=k._19O(P,E,u,G,K,d,s),k._71I(i[2],i[3],i[4],i[5]),k.F=A-(r-V),k._70I=!0):(k.moveTo(K,d),r===V?(k.F=0,k._70I=!k._70I):k.F=V-r)},bezierCurveTo:function(){var y=arguments;this.pen={x:y[4],y:y[5]},this.g.bezierCurveTo(y[0],y[1],y[2],y[3],y[4],y[5])},arc:function(E,N,v,q,p,b){b||(q=-q,p=-p),Ak(this,E,N,q,p-q,v,v,!1)},rect:function(U,V,a,X){var G=this;G.pen={x:U,y:V},G.moveTo(U,V),G.lineTo(U,V+X),G.lineTo(U+a,V+X),G.lineTo(U+a,V),G.lineTo(U,V)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(D,x,n,H){var c=n-D,b=H-x;return K(c*c+b*b)},_22O:function(i,B,V,K,w,t,u){for(var I,r,H,f,$,W,v,U=0,C=i,T=B,Z=u>0?u:this._69I,l=1;Z>=l;l++)H=l/Z,f=1-H,$=f*f,W=2*H*f,v=H*H,I=$*i+W*V+v*w,r=$*B+W*K+v*t,U+=this._23O(C,T,I,r),C=I,T=r;return U},_21O:function(t,e,$,R,Y,n,c,l){var s=this;if(0===c)return s._20O(t,e,$,R,Y,n,l);if(1===l)return s._19O(t,e,$,R,Y,n,c);var w=s._20O(t,e,$,R,Y,n,l);return w.push(c/l),s._19O.apply(s,w)},_20O:function(L,Q,m,h,V,r,M){if(1!==M){var S=m+(V-m)*M,b=h+(r-h)*M;m=L+(m-L)*M,h=Q+(h-Q)*M,V=m+(S-m)*M,r=h+(b-h)*M}return[L,Q,m,h,V,r]},_19O:function(g,p,_,O,n,c,a){if(1!==a){var D=g+(_-g)*a,B=p+(O-p)*a;_+=(n-_)*a,O+=(c-O)*a,g=D+(_-D)*a,p=B+(O-B)*a}return[g,p,_,O,n,c]},_72I:function(Z,s){var W=this.pen;(Z!==W.x||s!==W.y)&&(W.x=Z,W.y=s,this.g.lineTo(Z,s))},_71I:function(Q,y,f,B){var h=this.pen;(Q!==f||y!==B||f!==h.x||B!==h.y)&&(h.x=f,h.y=B,this.g.quadraticCurveTo(Q,y,f,B))}}),d&&g){var wb=g.toString();u=wb.indexOf(ui.substr(0,2))>0&&wb.indexOf(hq+hq.substr(1,1))>1||wb.indexOf(mg.substr(0,2)+ui.substr(2,2)+Hd[0]+ui[4])>1?!0:!1}!0&&B.console&&(B.navigator&&B.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?B.console.log.apply(console,["Hightopo - Version"+v.Default.getVersion()+" - %chttp://hightopo.com/request.html","color: #f00;"]):B.console.log("Hightopo - Version"+v.Default.getVersion()+" - http://hightopo.com/request.html"));var wc=I,Dr=I,rc=t.checkLoadingCompType=function(L){wc&&!L._72O&&(Dr||(Dr={}),Dr[L._72O=um()]=L)},Xo=function(k,A){if(A||(A=k),A&&(wc||(wc={}),!wc[k])){var r=new Mc;if(wc[A]={request:r,url:A},A=t.beforeLoadURL(A,k),A.data){var E=t.parse(A.data);fb(k,E),t.handleCompTypeLoaded(k,E)}else{r.onload=function(){if(200===this.status||0===this.status){var $=t.parse(r.getResponseText());fb(k,$),t.handleCompTypeLoaded(k,$)}else fb(k,I)},r.onerror=function(){fb(k,I)};var n={};n.url=encodeURI(A),n.sync=!1,r.send(n)}}},fb=function(J,O){if(Md[J]=O,delete wc[J],Gi(wc)&&(wc=I,Dr)){for(var R in Dr){var q=Dr[R];q.invalidateAll&&q.invalidateAll(Q,"compTypeLoaded",J),q.redraw&&q.redraw(),q.iv(),delete q._72O}Dr=I}if(O&&Dr)for(var R in Dr){var q=Dr[R];q.invalidateAll&&q.invalidateAll(Q,"compTypeLoading",J),q.redraw&&q.redraw(),q.iv()}},Td=j.chart,ll="",cq=!0,Tn=t.compStack=[],Yp=/^style@/,$j=/^attr@/,Zj=/^field@/,pl={x:.5,y:.5},Ah=function(){cq=!0},lb=function(){return cq},vk=function(i,D,X,h){if(!i)return 0;if(Nq(i.fitSize,D,X)&&h)return h;var u=Nq(i.width,D,X);return null==u?20:u},ns=function(R,j,$,t){if(!R)return 0;if(Nq(R.fitSize,j,$)&&t)return t;var O=Nq(R.height,j,$);return null==O?20:O},Nq=function(r,f,N){if(!r||!r.func)return r;var b,W=r.func,x=r.value;return b=qi(W)?N&&N.vectorDataBindingDisabled&&!r.isSafeFunc?x:W(f,N):f instanceof Fh||(v.ui?f instanceof v.ui.View:0)?$j.test(W)?f.a(ll+W.slice(5)):Yp.test(W)?f.s(ll+W.slice(6)):Zj.test(W)?f[W.slice(6)]:f[W]?f[W](N):x:x,x!==Q&&b==I?x:b},Kk=t.drawImage=function(){var A,Y,m,h,T,d,R=function(X,v){X.getValue&&X.getValue.compType===v||(X.getValue=function(M){var b=o(X,M);if(b===Q&&v.properties){var w=v.properties[M];w&&(b=w.defaultValue)}return b},X.getColor=function(h){return N(X.getValue(h))},X.getValue.compType=v)},o=function(C,Z,U){var z,X=!1;if(C.prefix&&Y instanceof Fh){var L=Y.a(ll+Z);L!==Q&&(X=!0,z=L)}return z===Q&&(z=C[Z]),z&&z.func&&(X=!0,z=Nq(z,Y,m)),U&&(z=U(z),X||(C[Z]=z)),z},N=function(j,$){var O;if(O=$?o(j,$):j,A&&A.compGray&&O)return t.toGrayColor(O);if(T&&O){if("override"===d)return T;if("override_rgb"===d){var D=An(T);return O=Up(O),"rgba("+U(255*D[0])+","+U(255*D[1])+","+U(255*D[2])+","+O[3]/255+")"}if("override_a"===d){var D=An(T);return O=Up(O),"rgba("+O[0]+","+O[1]+","+O[2]+","+D[3]+")"}var D=An(T);return O=Up(O),"rgba("+U(O[0]*D[0])+","+U(O[1]*D[1])+","+U(O[2]*D[2])+","+O[3]/255*D[3]+")"}return O},f=function(q){if(Ad(q)){for(var J=new up,W=q.length,h=0;W>h;h+=2)J.add({x:q[h],y:q[h+1]});q=J}return q},l=function(W){var z=o(W,"anchorX"),B=o(W,"anchorY");if(z!==Q||B!==Q)return{x:z===Q?pl.x:z,y:B===Q?pl.y:B};var G=o(W,"type"),t=o(W,"name");if("image"!==G||!t)return pl;var w=Bn(t);return w&&w.anchorX!==Q&&w.anchorY!==Q?{x:w.anchorX,y:w.anchorY}:pl},V=function(p,q){var G=o(p,qn),Z=l(p);if(Ad(G)){var T=G.length,L=o(p,"relative"),n=q.width,j=q.height;if(4===T)G={x:G[0],y:G[1],width:G[2],height:G[3]},L&&(G.x*=n,G.y*=j,G.width*=n,G.height*=j);else if(3===T){var M=G[0];G={width:G[1],height:G[2]},L&&(G.width*=n,G.height*=j),"object"==typeof M?M.length&&(M={x:M[0],y:M[1]}):M=Ke(M,q,G),G.x=M.x-G.width*Z.x,G.y=M.y-G.height*Z.y}G.x+=o(p,"offsetX")||0,G.y+=o(p,"offsetY")||0,!L&&q.fitSize&&(G=k(p,G,q))}return G},k=function(t,r,O){if(r){var m,L,u,A={x:r.x,y:r.y,width:r.width,height:r.height},D=l(t),P=o(t,"layoutH"),C=o(t,"layoutV"),_=1,V=1,N=0,K=0,n=1,c=1;switch(P){case"left":break;case"right":A.x+=O.width-O.rw;break;case"center":A.x+=.5*(O.width-O.rw);break;case"scale":case"leftright":default:m=o(t,rb)||0,m&&(N=Math.abs(K=Math.sin(m)),n=Math.abs(c=Math.cos(m))),"leftright"!==P?(_+=n*(O.widthScale-1),V+=N*(O.widthScale-1)):(_+=A.width?n*(O.width-O.rw)/A.width:0,V+=A.height?N*(O.width-O.rw)/A.height:0,L=-Math.min(-D.x*c+D.y*K,-D.x*c-(1-D.y)*K,(1-D.x)*c+D.y*K,(1-D.x)*c-(1-D.y)*K))}switch(C){case"top":break;case"bottom":A.y+=O.height-O.rh;break;case"center":A.y+=.5*(O.height-O.rh);break;case"scale":case"topbottom":default:m==I&&(m=o(t,rb),m&&(N=Math.abs(K=Math.sin(m)),n=Math.abs(c=Math.cos(m)))),"topbottom"!==C?(_+=N*(O.heightScale-1),V+=n*(O.heightScale-1)):(_+=A.width?N*(O.height-O.rh)/A.width:0,V+=A.height?n*(O.height-O.rh)/A.height:0,u=-Math.min(-D.x*K-D.y*c,-D.x*K+(1-D.y)*c,(1-D.x)*K-D.y*c,(1-D.x)*K+(1-D.y)*c))}return(1!==_||1!==V)&&("scale"!==P&&P?"leftright"===P&&(A.x+=A.width*(1-_)*D.x+L*(O.width-O.rw)):A.x+=A.x*(O.widthScale-1)+D.x*A.width*(O.widthScale-_),"scale"!==C&&C?"topbottom"===C&&(A.y+=A.height*(1-V)*D.y+u*(O.height-O.rh)):A.y+=A.y*(O.heightScale-1)+D.y*A.height*(O.heightScale-V),A.width*=_,A.height*=V),A.width<0&&(A.width=0),A.height<0&&(A.height=0),A}},q=function(E){return Ad(E)?new up(E):E},g=function(X,J,M,P,f,D,_){var F=A.interactiveInfo,n=X.transform;if(n)return A.save(),A.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),F&&F.compInfos.push({comp:X,rect:J,matrix:n.clone(),prefix:ll}),!0;f===Q&&(f=1),D===Q&&(D=1);var t=o(X,"clipPercentage"),g=Gr(M,J);if(g&&!P&&1===f&&1===D&&!(1>t))return F&&F.compInfos.push({comp:X,rect:J,matrix:F.matrix.clone(),prefix:ll}),!1;_=_||pl;var p=J.x+J.width*_.x,I=J.y+J.height*_.y,i=M.x+M.width*_.x,b=M.y+M.height*_.y,W=M.width?f*(J.width/M.width):1,K=M.height?D*(J.height/M.height):1;if(A.save(),F&&(F.matrix.appendTranslate(p,I).appendRotate(P).appendScale(W,K).appendTranslate(-i,-b),F.compInfos.push({comp:X,rect:J,matrix:F.matrix.clone()})),nc(A,p,I),Ur(A,P||0),Rl(A,W,K),nc(A,-i,-b),1>t){0>t&&(t=0);var O=ir(M,o(X,"clipDirection"),t);A.beginPath(),A.rect(O.x,O.y,O.width,O.height),A.clip()}return!0},D=function(){A.restore()},F=function(K,Z,s){var X=o(K,"path"),W=o(K,rb),v=o(K,"scaleX"),y=o(K,"scaleY"),V=l(K),m=I,r=Sh(null,X);if(s||(s=K.unionRect,s||(s=Hj(r),K.path.func||(K.unionRect=s)),m=s),s){m||(m=K.unionRect,m||(m=Hj(r),K.path.func||(K.unionRect=m)));var F=g(K,s,m,W,v,y,V),z=o(K,"borderPattern"),T=Zl(A,z),S=N(K,"background"),G=N(K,"borderColor"),_=o(K,"borderWidth"),O=o(K,"gradient"),p=N(K,"gradientColor"),i=o(K,"border3d"),d=N(K,"border3dColor"),L=o(K,"border3dAccuracy"),a=A.lineJoin,n=A.lineCap;A.lineJoin=o(K,"borderJoin")||Ul,A.lineCap=o(K,"borderCap")||Og,S?(yh(A,S,O,p,m),Sh(A,X),A.fill(),T!==A&&Sh(A,X)):Sh(A,X);var R=o(K,"borderWidthAbsolute");if(R&&(A.save(),A.setTransform(1,0,0,1,0,0)),_&&G&&(A.lineWidth=_,A.strokeStyle=G,A.stroke(),i&&Qo(A,G,d,_,h,L)),ol(A,z),o(K,"dash")){var t=o(K,"dashWidth")||_;if(t>0){z=o(K,"dashPattern")||aq;var T=Zl(A,z,o(K,"dashOffset")),M=N(K,"dashColor")||N(th);T!==A&&Sh(A,X),A.strokeStyle=M,A.lineWidth=t,A.stroke(),o(K,"dash3d")&&Qo(A,M,N(K,"dash3dColor"),t,h,o(K,"dash3dAccuracy")),ol(A,z)}}R&&A.restore(),Z===qn&&Zq(A,S,o(K,"depth"),m),A.lineJoin=a,A.lineCap=n,F&&D()}},J=function(O,$,V,R){var s=o(O,Ar,f),_=o(O,rb),J=l(O);if(s&&R.fitSize){var Q=new up,a=Hj(s),c=k(O,a,R),L=a.x+J.x*a.width,e=a.y+J.y*a.height,C=c.x+J.x*c.width,y=c.y+J.y*c.height,i=a.width?c.width/a.width:1,H=a.height?c.height/a.height:1;s.each(function(B){Q.add({x:C+(B.x-L)*i,y:y+(B.y-e)*H})}),s=Q,O.unionRect=null}var z=o(O,"scaleX"),x=o(O,"scaleY"),X=$===Oe,P=I;if(!V&&X&&(V=O.unionRect,V||(V=Hj(s),O.points.func||(O.unionRect=V)),P=V),V){X?P||(P=O.unionRect,P||(P=Hj(s),O.points.func||(O.unionRect=P))):P=V;var t,w,U,j,K=g(O,V,P,_,z,x,J),M=o(O,"borderPattern"),p=Zl(A,M),r=N(O,"background"),W=Bn(o(O,"repeatImage"),T,d),v=o(O,"gradientPack"),n=N(O,"borderColor"),Z=o(O,"borderWidth"),E=o(O,"segments",q),S=o(O,"gradient"),B=N(O,"gradientColor"),b=o(O,"border3d"),G=N(O,"border3dColor"),u=o(O,"border3dAccuracy"),F=o(O,"closePath"),mb=o(O,"fillRule")||"nonzero",Vk=A.lineJoin,Ie=A.lineCap;if(A.lineJoin=o(O,"borderJoin")||Ul,A.lineCap=o(O,"borderCap")||Og,X)if(r||W||v){var wq=o(O,"fillClipPercentage");if(1>wq){0>wq&&(wq=0);var rp=ir(P,o(O,"fillClipDirection"),wq);A.save(),A.beginPath(),A.rect(rp.x,rp.y,rp.width,rp.height),A.clip()}Hg(A,s,E,F),v?Wo(A,v):W?ko(A,W,T,d,Y,m):yh(A,r,S,B,P),A.fill(mb),1>wq&&A.restore(),v&&A.restore(),p!==A&&Hg(p,s,E,F)}else Hg(p,s,E,F);else if("roundRect"===$?t=o(O,"cornerRadius"):"polygon"===$?t=o(O,"polygonSide"):"arc"===$&&(t=o(O,"arcFrom"),w=o(O,"arcTo"),U=o(O,"arcClose"),j=o(O,"arcOval")),r||W||v){var wq=o(O,"fillClipPercentage");if(1>wq){0>wq&&(wq=0);var rp=ir(P,o(O,"fillClipDirection"),wq);A.save(),A.beginPath(),A.rect(rp.x,rp.y,rp.width,rp.height),A.clip()}Fr(A,$,P,t,w,U,j),v?Wo(A,v):W?ko(A,W,T,d,Y,m):yh(A,r,S,B,P),A.fill(mb),1>wq&&A.restore(),v&&A.restore(),A!==p&&Fr(p,$,P,t,w,U,j)}else Fr(p,$,P,t,w,U,j);var qb=o(O,"borderWidthAbsolute");if(qb&&(A.save(),A.setTransform(1,0,0,1,0,0)),Z&&n&&(A.lineWidth=Z,A.strokeStyle=n,A.stroke(),b&&Qo(A,n,G,Z,h,u)),ol(A,M),o(O,"dash")){var Cj=o(O,"dashWidth")||Z;if(Cj>0){M=o(O,"dashPattern")||aq;var p=Zl(A,M,o(O,"dashOffset")),lg=N(O,"dashColor")||N(th);p!==A&&(X?Hg(p,s,E,F):Fr(p,$,P,t,w,U,j)),A.strokeStyle=lg,A.lineWidth=Cj,A.stroke(),o(O,"dash3d")&&Qo(A,lg,N(O,"dash3dColor"),Cj,h,o(O,"dash3dAccuracy")),ol(A,M)}}qb&&A.restore(),$===qn&&Zq(A,r,o(O,"depth"),P),A.lineJoin=Vk,A.lineCap=Ie,K&&D()}},c=function(R,i){var W=T||o(R,Fm),O=d||o(R,"blendMode"),S=o(R,"name"),J=Bn(S,W,O);J?ck(A,J,o(R,"stretch"),i.x,i.y,i.width,i.height,Y,m,W,null,O):cq=!1},n=function(f,m){var v=o(f,"text");v!=I&&Ac(A,v,o(f,"font"),N(f,Fm),m.x,m.y,m.width,m.height,o(f,"align"),o(f,"vAlign"))},K=function(U,Q){_d(A,N(U,Fm),Q.x,Q.y,Q.width,Q.height,o(U,"width"))},w=function(T,Z){var h=o(T,qs),d=0;if(h&&(h.forEach(function(a){d+=a}),d>0)){for(var b=o(T,"colors")||Td,O=o(T,"startAngle")||0,F=o(T,"hollow"),N=o(T,Ef),p=o(T,Xc),j=o(T,xm),t=N?new up:I,k=Z.x,V=Z.y,R=Z.width,$=Z.height,U=k+R/2,u=V+$/2,M=r(R,$)/2,J=0,y=0;y<h.length;y++){var B=h[y],c=E*B/d,D=O+c;if(A.fillStyle=b[J++],J===b.length&&(J=0),A.beginPath(),F){var g=U+x(O)*M/2,a=u+C(O)*M/2,G=U+x(D)*M,S=u+C(D)*M;A.moveTo(g,a),A.arc(U,u,M/2,O,D,!1),A.lineTo(G,S),A.arc(U,u,M,D,O,!0)}else A.moveTo(U,u),A.arc(U,u,M,D,O,!0);t&&(c=(O+D)/2,t.add({text:qi(N)?N(B,y,d,Y):B,x:U+.75*x(c)*M,y:u+.75*C(c)*M})),A.closePath(),A.fill(),O=D}t&&t.each(function(u){Ac(A,u.text,p,j,u.x,u.y,0,0,dn)})}},i=function(T,q){var U=o(T,Cj);if(U&&U.length>0){var R=U.length,l=o(T,Ef),C=o(T,Xc),B=o(T,xm),k=l?new up:I,b=o(T,"minValue")||0,j=o(T,"maxValue");if(j==I&&(j=0,U.forEach(function(d){o(d,qs).forEach(function(x){j=P(j,x)})})),b===j)return;for(var $=q.height/(j-b),J=q.y+j*$,Q=o(U[0],qs).length,E=q.width/(3*Q+1),V=2*E/R,N=0,X=0;R>X;X++)for(var K=U[X],n=o(K,Fm),M=o(K,"colors"),e=o(K,qs),H=0;Q>H;H++){M?A.fillStyle=M[H]:n?A.fillStyle=n:(A.fillStyle=Td[N++],N===Td.length&&(N=0));var p=e[H],m=p*$,f=q.x+(1+3*H)*E+X*V;if(Xl(A,f,J-m,V,m),k){var r=qi(l)?l(p,H,K,Y):p,g=Cg(C,r).height;k.add({x:f,y:J-m-g,width:V,height:g,text:r})}}k&&k.each(function(G){Ac(A,G.text,C,B,G.x,G.y,G.width,G.height,dn)})}},z=function(f,c){var Q=o(f,Cj);if(Q&&Q.length>0){var v=Q.length,i=o(Q[0],qs).length,x=c.width/(3*i+1),O=0,p=o(f,"maxValue"),t=o(f,Ef),E=o(f,Xc),d=o(f,xm),L=t?new up:I;if(p==I){p=0;for(var w=0;i>w;w++){for(var W=0,q=0;v>q;q++)W+=o(Q[q],qs)[w];p=P(p,W)}}if(p>0){for(var w=0;i>w;w++)for(var y=c.y+c.height,q=0;v>q;q++){var h=Q[q],_=o(h,Fm),C=o(h,qs)[w],z=C/p*c.height;_?A.fillStyle=_:(A.fillStyle=Td[O++],O===Td.length&&(O=0)),y-=z;var N={x:c.x+(1+3*w)*x,y:y,width:2*x,height:z};Xl(A,N.x,N.y,N.width,N.height),L&&(N.text=qi(t)?t(C,w,h,Y):C,L.add(N))}L&&L.each(function(a){Ac(A,a.text,E,d,a.x,a.y,a.width,a.height,dn)})}}},j=function(N,s){var l=o(N,Cj);if(l&&l.length>0){for(var r=l.length,Z=o(l[0],qs).length,P=s.width/(3*Z+1),t=0,n=o(N,Ef),k=o(N,Xc),g=o(N,xm),d=n?new up:I,J=0;Z>J;J++){for(var i=0,C=0;r>C;C++)i+=o(l[C],qs)[J];if(i>0){var m=s.y+s.height;for(C=0;r>C;C++){var V=l[C],R=o(V,Fm),e=o(V,qs)[J],L=e/i*s.height;R?A.fillStyle=R:(A.fillStyle=Td[t++],t===Td.length&&(t=0)),m-=L;var K={x:s.x+(1+3*J)*P,y:m,width:2*P,height:L};Xl(A,K.x,K.y,K.width,K.height),d&&(K.text=qi(n)?n(e,J,V,Y):e,d.add(K))}}}d&&d.each(function(R){Ac(A,R.text,k,g,R.x,R.y,R.width,R.height,dn)})}},e=function(B,V){var i=o(B,Cj);if(i&&i.length>0){var W=i.length,x=o(B,"minValue")||0,H=o(B,"maxValue");if(H==I&&(H=0,i.forEach(function(W){o(W,qs).forEach(function(_){H=P(H,_)})})),x===H)return;for(var S=V.height/(H-x),t=V.y+H*S,_=o(i[0],qs).length,m=V.width/(3*_+1),M=0,F=o(B,"lineWidth")||2,s=o(B,"line3d"),L=o(B,"linePoint"),R=o(B,Ef),l=o(B,Xc),n=o(B,xm),X=0;W>X;X++){var G=i[X],p=o(G,Fm),Q=o(G,qs);p?A.strokeStyle=p:(p=A.strokeStyle=Td[M++],M===Td.length&&(M=0)),A.beginPath();for(var y=0;_>y;y++){var w=V.x+(2+3*y)*m,U=t-Q[y]*S;0===y?A.moveTo(w,U):A.lineTo(w,U)}if(A.lineWidth=F,A.stroke(),s&&Qo(A,p,I,F,h),L||R){var r,K=F/2+2;for(y=0;_>y;y++){var z=Q[y];if(w=V.x+(2+3*y)*m,U=t-z*S,qi(L)?L(A,w,U,p,y,G,Y):L&&(A.fillStyle=p,A.beginPath(),A.arc(w,U,K,0,E,!0),A.fill()),qi(R)?r=R(z,y,G,Y):R&&(r=z),r){var D=Cg(l,r).height,O=A.shadowBlur;if(O){var T=A.shadowOffsetX,j=A.shadowOffsetY,N=A.shadowColor;A.shadowOffsetX=0,A.shadowOffsetY=0,A.shadowBlur=0,A.shadowColor=I}Ac(A,r,l,n,w,U-D-K+2,0,D,dn),O&&(A.shadowOffsetX=T,A.shadowOffsetY=j,A.shadowBlur=O,A.shadowColor=N)}}}}}},G=function(Z){A=Z[0],Y=Z[1],m=Z[2],h=Z[3],T=Z[4],d=Z[5]},S=function(){return[A,Y,m,h,T,d]},v=function(q,d){var t;m&&m.getState?t=m.getState(Y):(t=Y instanceof Fh?Y.s($g):null,(t===Q||null===t)&&(t=o(q,$g)));var Z=o(d,$g);return Z!==Q&&null!==Z&&Z!==t?!1:o(d,wr)},b={border:K,image:c,text:n,pieChart:w,columnChart:i,stackedColumnChart:z,percentageColumnChart:j,lineChart:e};return function(z,H,w,X,i,e,r,j,y,n){if(H&&i&&e){var K=S();A=z,Y=r,m=j,!Y&&m&&m.isSelfViewEvent&&(Y=m),h=m?m._zoom?m._zoom:1:1,T=y,d=n;var k=i,P=e;if(tm()){var $,p,W;0===A[Nf]?tm[0]&&($=!0):$=!0,A.texureImage2D?tm[1]&&(p=!0):p=!0,A.texureImage3D?tm[2]&&(W=!0):W=!0,$&&p&&W&&(k=w,P=X)}if(H.tagName)return fh(bk)&&!B[bk]||A.drawImage(H,k,P,i,e),G(K),void 0;if(o(H,"visible")===!1)return G(K),void 0;T||(T=Nq(H.color,Y,m)),n||(d=Nq(H.blendMode,Y,m)),fh(bk)&&!B[bk]&&(i=k,e=P);var c=vk(H,Y,m,i),x=ns(H,Y,m,e),a={x:0,y:0,width:c,height:x,fitSize:o(H,"fitSize")},E=o(H,"clip"),O=o(H,"opacity");if(a.fitSize){var M=a.rw=Nq(H.width,Y,m)||20;a.widthScale=c/M;var u=a.rh=Nq(H.height,Y,m)||20;a.heightScale=x/u}if(A.save(),A.interactiveInfo){var U=A.interactiveInfo.matrix,Z=U.clone();U.appendTranslate(k,P).appendScale(i/c,e/x)}nc(A,k,P),(c!==i||x!==e)&&A.scale(i/c,e/x),E&&(qi(E)?E(A,c,x,Y,m,H):(A.beginPath(),A.rect(0,0,c,x),A.clip())),O!=I&&(A.globalAlpha*=O),o(H,"comps").forEach(function(i){if(i.prefix){var Z=ll,E=Nq(i.prefix,Y,m);E&&(ll=ll+E+".")}if(v(H,i)===!1)return i.prefix&&(ll=Z),void 0;if(Tn.splice(0,0,i),A.interactiveInfo)var L=A.interactiveInfo.matrix.clone();var M=o(i,"opacity"),k=o(i,"shadow"),G=o(i,"type"),U=V(i,a);if(M!=I){var P=A.globalAlpha;A.globalAlpha*=M}if(k){var S=A.shadowOffsetX,_=A.shadowOffsetY,n=A.shadowBlur,X=A.shadowColor,B=o(i,"shadowOffsetX"),x=o(i,"shadowOffsetY"),u=o(i,"shadowBlur"),c=N(i,"shadowColor");A.shadowOffsetX=(B==I?3:B)*h,A.shadowOffsetY=(x==I?3:x)*h,A.shadowBlur=(u==I?6:u)*h,A.shadowColor=c||N(ps)}if("save"===G)A.save();else if("endClip"===G||"restore"===G)A.restore();else if("clip"===G)A.save(),Hg(A,o(i,"points",f),o(i,"segments",q),!0),A.clip();else if(Jh[G])U=U||{x:0,y:0,width:a.width,height:a.height},J(i,G,U,a);else if(G===Oe)J(i,G,U,a);else if("SVGPath"===G)F(i,G,U);else{U=U||{x:0,y:0,width:a.width,height:a.height};var y=o(i,rb),p=o(i,"scaleX"),C=o(i,"scaleY"),O=l(i),e=g(i,U,U,y,p,C,O);if(qi(G))R(i,G),t.drawCompType(G,A,U,i,Y,m);else if(t.getCompType(G)){var s=t.getCompType(G),z=s.func||s;R(i,s),t.drawCompType(z,A,U,i,Y,m)}else b[G]?b[G](i,U):t.getCompType(G)===Q&&Mr.test(G)&&Xo(G);e&&D()}k&&(A.shadowOffsetX=S,A.shadowOffsetY=_,A.shadowBlur=n,A.shadowColor=X),M!=I&&(A.globalAlpha=P),A.interactiveInfo&&(A.interactiveInfo.matrix=L),i.prefix&&(ll=Z),Tn.splice(0,1)}),A.interactiveInfo&&(A.interactiveInfo.matrix=Z),A.restore(),G(K)}}}();t.getCurrentComp=function(){return Tn[0]},t.getParentComp=function(){return Tn[1]},t.getInternal=function(){return{isEnter:ih,isEsc:uq,isSpace:vp,isLeft:Zo,isUp:dk,isRight:ip,isDown:nr,addMethod:Fd,superCall:mj,toPointsArray:wn,translateAndScale:Dj,appendArray:Se,createWorldMatrix:ph,vec3TransformMat4:Tl,setCanvas:sg,createDiv:Tj,createView:Th,createCanvas:Sg,createImage:hh,initContext:Ye,layout:Op,fillRect:Xl,Mat:xs,drawBorder:_d,isString:fh,setBorder:dq,getPropertyValue:Lo,setPropertyValue:pc,drawVerticalLine:tn,draw3DRect:Zq,getPinchDist:Re,isSameRect:Gr,getPosition:Ke,intersectionLineRect:ti,getNodeRect:Pb,getEdgeAgentPosition:ik,getEdgeHostPosition:Kg,getImageWidth:vk,getImageHeight:ns,initItemElement:Zm,drawPoints:Hg,createG2:Zl,closePopup:lj,isH:nl,createAnim:Rc,createNormalMatrix:ye,createNormals:tg,toFloatArray:Nm,glMV:sf,glPop:bj,batchShape:Jf,createNodeMatrix:vh,getFaceInfo:cn,transformAppend:pg,drawFaceInfo:Sd,to3dPointsArray:Il,setGLDebugMode:function(W){Nl=W},cube:function(){return{vs:ob,is:gk,uv:Eh}},ui:function(){return{DataUI:Jj,NodeUI:Vn,EdgeUI:Gb,GroupUI:al,ShapeUI:Al,GridUI:Lh,Data3dUI:Dd,Node3dUI:Tp,Shape3dUI:oq}},getInternalVersion:function(){return"U2FsdGVkX180zCvAUzieqAIfRotymM9hfr19SDin6ls="},getDragger:function(){return _k},addMSMap:function(k){Fd(hl,k)},k:G,addEventListener:J,removeEventListener:i}},function(l){function b(K,h){K!=I&&(h==I&&un!=typeof K?this._54O(K,256):this._54O(K,h))}function t(){return new b(I)}function O(I,g,A,n,p,P){for(;--P>=0;){var F=g*this[I++]+A[n]+p;p=e(F/67108864),A[n++]=67108863&F}return p}function H(X,c,$,V,e,b){for(var x=32767&c,I=c>>15;--b>=0;){var q=32767&this[X],J=this[X++]>>15,h=I*q+J*x;q=x*q+((32767&h)<<15)+$[V]+(1073741823&e),e=(q>>>30)+(h>>>15)+I*J+(e>>>30),$[V++]=1073741823&q}return e}function T(q,Y,f,Q,g,n){for(var m=16383&Y,J=Y>>14;--n>=0;){var i=16383&this[q],z=this[q++]>>14,T=J*i+z*m;i=m*i+((16383&T)<<14)+f[Q]+g,g=(i>>28)+(T>>14)+J*z,f[Q++]=268435455&i}return g}function D(m){return um.charAt(m)}function u(G,u){var O=kp[G.charCodeAt(u)];return O==I?-1:O}function z(a){for(var m=this.t-1;m>=0;--m)a[m]=this[m];a.t=this.t,a.s=this.s}function Y(X){this.t=1,this.s=0>X?-1:0,X>0?this[0]=X:-1>X?this[0]=X+this.DV:this.t=0}function S(e){var l=t();return l._58O(e),l}function f(l,H){var g,q=this;if(16==H)g=4;else if(8==H)g=3;else if(256==H)g=8;else if(2==H)g=1;else if(32==H)g=5;else{if(4!=H)return q.fromRadix(l,H),void 0;g=2}q.t=0,q.s=0;for(var Y=l.length,x=!1,y=0;--Y>=0;){var c=8==g?255&l[Y]:u(l,Y);0>c?"-"==l.charAt(Y)&&(x=!0):(x=!1,0==y?q[q.t++]=c:y+g>q.DB?(q[q.t-1]|=(c&(1<<q.DB-y)-1)<<y,q[q.t++]=c>>q.DB-y):q[q.t-1]|=c<<y,y+=g,y>=q.DB&&(y-=q.DB))}8==g&&0!=(128&l[0])&&(q.s=-1,y>0&&(q[q.t-1]|=(1<<q.DB-y)-1<<y)),q._57O(),x&&b.ZERO._78O(q,q)}function o(){for(var g=this,U=g.s&g.DM;g.t>0&&g[g.t-1]==U;)--g.t}function B(J){var v=this;if(v.s<0)return"-"+v._85O()[mn](J);var d;if(16==J)d=4;else if(8==J)d=3;else if(2==J)d=1;else if(32==J)d=5;else{if(4!=J)return v.toRadix(J);d=2}var h,i=(1<<d)-1,I=!1,r="",p=v.t,f=v.DB-p*v.DB%d;if(p-->0)for(f<v.DB&&(h=v[p]>>f)>0&&(I=!0,r=D(h));p>=0;)d>f?(h=(v[p]&(1<<f)-1)<<d-f,h|=v[--p]>>(f+=v.DB-d)):(h=v[p]>>(f-=d)&i,0>=f&&(f+=v.DB,--p)),h>0&&(I=!0),I&&(r+=D(h));return I?r:"0"}function U(){var $=t();return b.ZERO._78O(this,$),$}function j(){return this.s<0?this._85O():this}function V(B){var L=this,j=L.s-B.s;if(0!=j)return j;var o=L.t;if(j=o-B.t,0!=j)return L.s<0?-j:j;for(;--o>=0;)if(0!=(j=L[o]-B[o]))return j;return 0}function L(p){var P,i=1;return 0!=(P=p>>>16)&&(p=P,i+=16),0!=(P=p>>8)&&(p=P,i+=8),0!=(P=p>>4)&&(p=P,i+=4),0!=(P=p>>2)&&(p=P,i+=2),0!=(P=p>>1)&&(p=P,i+=1),i}function i(){var C=this;return C.t<=0?0:C.DB*(C.t-1)+L(C[C.t-1]^C.s&C.DM)}function Q(Q,z){var J;for(J=this.t-1;J>=0;--J)z[J+Q]=this[J];for(J=Q-1;J>=0;--J)z[J]=0;z.t=this.t+Q,z.s=this.s}function n(r,m){for(var h=r;h<this.t;++h)m[h-r]=this[h];m.t=P(this.t-r,0),m.s=this.s}function M(p,Z){var l,A=this,B=p%A.DB,y=A.DB-B,M=(1<<y)-1,Y=e(p/A.DB),G=A.s<<B&A.DM;for(l=A.t-1;l>=0;--l)Z[l+Y+1]=A[l]>>y|G,G=(A[l]&M)<<B;for(l=Y-1;l>=0;--l)Z[l]=0;Z[Y]=G,Z.t=A.t+Y+1,Z.s=A.s,Z._57O()}function F(q,v){var Y=this;v.s=Y.s;var F=e(q/Y.DB);if(F>=Y.t)return v.t=0,void 0;var C=q%Y.DB,P=Y.DB-C,g=(1<<C)-1;v[0]=Y[F]>>C;for(var w=F+1;w<Y.t;++w)v[w-F-1]|=(Y[w]&g)<<P,v[w-F]=Y[w]>>C;C>0&&(v[Y.t-F-1]|=(Y.s&g)<<P),v.t=Y.t-F,v._57O()}function w(s,V){for(var $=this,G=0,C=0,X=r(s.t,$.t);X>G;)C+=$[G]-s[G],V[G++]=C&$.DM,C>>=$.DB;if(s.t<$.t){for(C-=s.s;G<$.t;)C+=$[G],V[G++]=C&$.DM,C>>=$.DB;C+=$.s}else{for(C+=$.s;G<s.t;)C-=s[G],V[G++]=C&$.DM,C>>=$.DB;C-=s.s}V.s=0>C?-1:0,-1>C?V[G++]=$.DV+C:C>0&&(V[G++]=C),V.t=G,V._57O()}function J(S,v){var i=this.abs(),Y=S.abs(),$=i.t;for(v.t=$+Y.t;--$>=0;)v[$]=0;for($=0;$<Y.t;++$)v[$+i.t]=i.am(0,Y[$],v,$,0,i.t);v.s=0,v._57O(),this.s!=S.s&&b.ZERO._78O(v,v)}function $(F){for(var J=this.abs(),Y=F.t=2*J.t;--Y>=0;)F[Y]=0;for(Y=0;Y<J.t-1;++Y){var v=J.am(Y,J[Y],F,2*Y,0,1);(F[Y+J.t]+=J.am(Y+1,2*J[Y],F,2*Y+1,v,J.t-Y-1))>=J.DV&&(F[Y+J.t]-=J.DV,F[Y+J.t+1]=1)}F.t>0&&(F[F.t-1]+=J.am(Y,J[Y],F,2*Y,0,1)),F.s=0,F._57O()}function v(X,h,m){var W=X.abs(),P=this;if(!(W.t<=0)){var y=P.abs();if(y.t<W.t)return h!=I&&h._58O(0),m!=I&&P._77O(m),void 0;m==I&&(m=t());var R=t(),E=P.s,o=X.s,S=P.DB-L(W[W.t-1]);S>0?(W._44O(S,R),y._44O(S,m)):(W._77O(R),y._77O(m));var q=R.t,Q=R[q-1];if(0!=Q){var D=Q*(1<<P.F1)+(q>1?R[q-2]>>P.F2:0),p=P.FV/D,i=(1<<P.F1)/D,a=1<<P.F2,s=m.t,z=s-q,v=h==I?t():h;for(R._59O(z,v),m._52O(v)>=0&&(m[m.t++]=1,m._78O(v,m)),b.ONE._59O(q,v),v._78O(R,R);R.t<q;)R[R.t++]=0;for(;--z>=0;){var r=m[--s]==Q?P.DM:e(m[s]*p+(m[s-1]+a)*i);if((m[s]+=R.am(0,r,m,z,0,q))<r)for(R._59O(z,v),m._78O(v,m);m[s]<--r;)m._78O(v,m)}h!=I&&(m._45O(q,h),E!=o&&b.ZERO._78O(h,h)),m.t=q,m._57O(),S>0&&m._46O(S,m),0>E&&b.ZERO._78O(m,m)}}}function c(D){var Z=t();return this.abs()._49O(D,I,Z),this.s<0&&Z._52O(b.ZERO)>0&&D._78O(Z,Z),Z}function g(r){this.m=r}function _(T){return T.s<0||T._52O(this.m)>=0?T.mod(this.m):T}function A(V){return V}function a(G){G._49O(this.m,I,G)}function q(b,M,q){b._47O(M,q),this._74O(q)}function d(X,F){X._48O(F),this._74O(F)}function k(){if(this.t<1)return 0;var x=this[0];if(0==(1&x))return 0;var h=3&x;return h=15&h*(2-(15&x)*h),h=255&h*(2-(255&x)*h),h=65535&h*(2-(65535&(65535&x)*h)),h=h*(2-x*h%this.DV)%this.DV,h>0?this.DV-h:-h}function m(S){var R=this;R.m=S,R.mp=S._50O(),R.mpl=32767&R.mp,R.mph=R.mp>>15,R.um=(1<<S.DB-15)-1,R.mt2=2*S.t}function h(w){var a=t();return w.abs()._59O(this.m.t,a),a._49O(this.m,I,a),w.s<0&&a._52O(b.ZERO)>0&&this.m._78O(a,a),a}function y(y){var _=t();return y._77O(_),this._74O(_),_}function W(O){for(var W=this;O.t<=W.mt2;)O[O.t++]=0;for(var a=0;a<W.m.t;++a){var P=32767&O[a],p=P*W.mpl+((P*W.mph+(O[a]>>15)*W.mpl&W.um)<<15)&O.DM;for(P=a+W.m.t,O[P]+=W.m.am(0,p,O,a,0,W.m.t);O[P]>=O.DV;)O[P]-=O.DV,O[++P]++}O._57O(),O._45O(W.m.t,O),O._52O(W.m)>=0&&O._78O(W.m,O)}function Wc(D,F){D._48O(F),this._74O(F)}function nd(X,y,J){X._47O(y,J),this._74O(J)}function Fq(){return 0==(this.t>0?1&this[0]:this.s)}function Wh(Y,S){if(Y>4294967295||1>Y)return b.ONE;
var y=t(),q=t(),V=S._73O(this),j=L(Y)-1;for(V._77O(y);--j>=0;)if(S._76O(y,q),(Y&1<<j)>0)S._75O(q,V,y);else{var l=y;y=q,q=l}return S.revert(y)}function yd(h,M){var J;return J=256>h||M._51O()?new g(M):new m(M),this.exp(h,J)}function si(){var s=this;if(s.s<0){if(1==s.t)return s[0]-s.DV;if(0==s.t)return-1}else{if(1==s.t)return s[0];if(0==s.t)return 0}return(s[1]&(1<<32-s.DB)-1)<<s.DB|s[0]}function xm(D,v){return new b(D,v)}function Kf(){var f=this;f.n=I,f.e=0,f.d=I,f.p=I,f.q=I,f.dmp1=I,f.dmq1=I,f._10A=I}function cd(n){return n._53O(this.e,this.n)}function lm(Q){var v,C,W,c="",V=0;for(v=0;v<Q.length&&Q.charAt(v)!=rc;++v)W=Rd.indexOf(Q.charAt(v)),0>W||(0==V?(c+=D(W>>2),C=3&W,V=1):1==V?(c+=D(C<<2|W>>4),C=15&W,V=2):2==V?(c+=D(C),c+=D(W>>2),C=3&W,V=3):(c+=D(C<<2|W>>4),c+=D(15&W),V=0));return 1==V&&(c+=D(C<<2)),c}function Im(T){var p=T.split(""),s=lm(T);return p.forEach(function(e){var B=e.length;B>0&&s&&(ug+=R(e))}),s}function $o(m,L){var E=Ge._4O.Util._56O(m,"ss"),T={},z=0;return T.v=E==L,T.t=1,T.s=0>z?-1:0,lg=T.v,z>0?T[0]=z:-1>z?T[0]=z+T.DV:T.t=0,[E,T]}function Ke(C){var n=38,y=C.substring(0,n);if(y&&30==y.indexOf("05000420")){var R=["ss",C.substring(n)];return R}return[]}function ln(L,i){i=i.replace(ts,""),i=i.replace(/[ \n]+/g,"");var U=xm(i,16);if(U._55O()>this.n._55O())return 0;var y=this._37O(U),T=y[mn](16).replace(/^1f+00/,""),K=Ke(T);if(0==K.length)return!1;for(var Q,Y,k,I=.5,v=cl,j=[0,.5,.75,.875,.9375],D=[],o=[],t=[],u=E/v,f=K[1],z=$o(L,f)[0],g=0,Z=0;g<j.length;g++){var c=0===g%2?0:.5;for(Q=0;v>=Q;Q++)Y=(Q+c)*u,k=1-j[g],D.push(x(Y)*I*k,-I+2*j[g]*I,-C(Y)*I*k),o.push((Q+c)/v,k)}for(g=0;g<j.length-1;g++){var H=g*(v+1),M=(g+1)*(v+1);for(Q=0;v>Q;Q++)t.push(H+Q,M+Q+1,M+Q,H+Q,H+Q+1,M+Q+1)}return t.forEach(function(X){Z+=X}),f==z&&Z>10}var ji,xl=0xdeadbeefcafe,xn=15715070==(16777215&xl),mn="toString",Pp="",vj="nat",cf=function(){};N=l["D"+11182[mn](p(2,5))];var Uf=b.prototype;Sl+=vl.substr(0,1);var Ud=l.navigator?l.navigator.appName:"";xn&&"Microsoft Internet Explorer"==Ud?(Uf.am=H,ji=30):xn&&"Netscape"!=Ud?(Uf.am=O,ji=26):(Uf.am=T,ji=28),Uf.DB=ji,Uf.DM=(1<<ji)-1,Uf.DV=1<<ji;var Vd=52;Uf.FV=p(2,Vd),Uf.F1=Vd-ji,Uf.F2=2*ji-Vd;var Uc,Bc,um="0123456789abcdefghijklmnopqrstuvwxyz",kp=[],Tn=function(d){return String.fromCharCode(d)};for(Uc="0".charCodeAt(0),Bc=0;9>=Bc;++Bc)kp[Uc++]=Bc;for(Uc="a".charCodeAt(0),Bc=10;36>Bc;++Bc)kp[Uc++]=Bc;for(Uc="A".charCodeAt(0),Bc=10;36>Bc;++Bc)kp[Uc++]=Bc;var Fj=g.prototype;Fj._73O=_,Fj.revert=A,Fj._74O=a,Fj._75O=q,Fj._76O=d;var li=m.prototype;li._73O=h,li.revert=y,li._74O=W,li._75O=nd,li._76O=Wc,Uf._77O=z,Uf._58O=Y,Uf._54O=f,Uf._57O=o,Uf._59O=Q,Uf._45O=n,Uf._44O=M,Uf._46O=F,Uf._78O=w,Uf._47O=J,Uf._48O=$,Uf._49O=v,Uf._50O=k,Uf._51O=Fq,Uf.exp=Wh,Uf.toString=B,Uf._85O=U,Uf.abs=j,Uf._52O=V,Uf._55O=i,Uf.mod=c,Uf._53O=yd,b.ZERO=S(0),b.ONE=S(1),Uf._86O=si;var kb=function(s,z){var T=this;T.isPublic=!0,typeof s!==un?(T.n=s,T.e=z):s!=I&&z!=I&&s.length>0&&z.length>0&&(T.n=xm(s,16),T.e=R(z,16))};dp=function(){var d,C,_=Im(se),B=_.substr(0,4),Y=_.substr(4,2),v=_.substr(6,2),q=1,M=!q,f=G,u=[],S=sj.charAt(7);if(N&&(N[mn]().indexOf(vj)<0||N[Sl][mn]().indexOf(vj)<0||!_?d=I:(_=new N(B-0,Y-q,v-0),C=_.setHours(9),N[Sl]()>C?d=Go[S]:M=!0)),_&&d&&d[0]&&d[X(.5)]&&f){var t=yf(d[0]),T=yf(d[1]);for(var j in T)u.push(j);var W,r=0,Z=t[u[r]],F=T[u[r++]],i=T[u[r++]],g=T[u[r++]],l=T[u[r++]],c=T[u[r++]],D=T[u[r++]],o=t[u[r]],H=T[u[r++]],E=Yl._27O(f);if(Z===F&&E&&H){W=F+i+g+l+c+D;var k=!D||D===qr;if(!k&&D)for(var L,b=0,P=D.length;P>b;b++)D[b]===Wi[r]?L===qr?k=!0:L[0]===Mf[5]&&qr&&qr.indexOf(L.substr(1))>=0?k=!0:L=I:(L==I?L=D[b]:L+=D[b],b===P-1&&(L===qr?k=!0:L[0]===Mf[5]&&qr&&qr.indexOf(L.substr(1))>=0&&(k=!0)));W&&E._31O(W,H)&&E._31O(Z,o)&&k&&(!c||N[Sl]()<c)&&(M=!0)}}return M||(Fr=rl),S};var Sn=Kf.prototype;Sn._37O=cd,Sn._38O=kb;var Rd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rc="=",xc=25,Rk=10,se="ICAIFQ==",Ed=Ed||function(W,H){var a={},I=a._7A={},Y=I._6A=function(){function W(){}return{_80O:function(i){W.prototype=this;var x=new W;return i&&x._5A(i),x.hasOwnProperty("_82O")||(x._82O=function(){x.$super._82O.apply(this,arguments)}),x._82O.prototype=x,x.$super=this,x},_3A:function(){var U=this._80O();return U._82O.apply(U,arguments),U},_82O:function(){},_5A:function(n){for(var Y in n)n.hasOwnProperty(Y)&&(this[Y]=n[Y]);n.hasOwnProperty(mn)&&(this.toString=n.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),$=I._39O=Y._80O({_82O:function(T,k){T=this._84O=T||[],this._65O=k!=H?k:4*T.length},toString:function(o){return(o||T).stringify(this)},_89O:function(x){var f=this._84O,E=x._84O,s=this._65O,_=x._65O;if(this._57O(),s%4)for(var Z=0;_>Z;Z++){var M=255&E[Z>>>2]>>>24-8*(Z%4);f[s+Z>>>2]|=M<<24-8*((s+Z)%4)}else if(E.length>65535)for(var Z=0;_>Z;Z+=4)f[s+Z>>>2]=E[Z>>>2];else f.push.apply(f,E);return this._65O+=_,this},_57O:function(){var f=this._84O,S=this._65O;f[S>>>2]&=4294967295<<32-8*(S%4),f.length=X(S/4)},_88O:function(){var m=Y._88O.call(this);return m._84O=this._84O.slice(0),m},_87O:function(_){for(var V=[],i=0;_>i;i+=4)V.push(0|4294967296*s);return new $._82O(V,_)}}),F=a._2A={},T=F._69O={stringify:function(b){var X,w=b._84O,l=b._65O,Q=[];for(X=0;l>X;X++){var s=255&w[X>>>2]>>>24-8*(X%4);Q.push((s>>>4).toString(16)),Q.push((15&s).toString(16))}return Q.join("")},_68O:function(z){for(var l=z.length,I=[],G=0;l>G;G+=2)I[G>>>3]|=R(z.substr(G,2),16)<<24-4*(G%8);return new $._82O(I,l/2)}},p=F._8A={stringify:function(S){var f,z=S._84O,i=S._65O,T=[];for(f=0;i>f;f++){var X=255&z[f>>>2]>>>24-8*(f%4);T.push(Tn(X))}return T.join("")},_68O:function(_){var o,Q=_.length,k=[];for(o=0;Q>o;o++)k[o>>>2]|=(255&_.charCodeAt(o))<<24-8*(o%4);return new $._82O(k,Q)}},q=F._9A={stringify:function(n){try{return decodeURIComponent(escape(p.stringify(n)))}catch(y){throw new Error("")}},_68O:function(e){return p._68O(unescape(encodeURIComponent(e)))}},Z=I._32O=Y._80O({_1A:function(){this._83O=new $._82O,this._23O=0},_33O:function(K){typeof K==un&&(K=q._68O(K)),this._83O._89O(K),this._23O+=K._65O},_25O:function(g){var d=this._83O,s=d._84O,Y=d._65O,Z=this._79O,h=4*Z,f=Y/h;f=g?X(f):P((0|f)-this._22O,0);var E=f*Z,b=r(4*E,Y);if(E){for(var i=0;E>i;i+=Z)this._20O(s,i);var N=s.splice(0,E);d._65O-=b}return new $._82O(N,b)},_88O:function(){var g=Y._88O.call(this);return g._83O=this._83O._88O(),g},_22O:0});I._66O=Z._80O({cfg:Y._80O(),_82O:function(P){this.cfg=this.cfg._80O(P),this._1A()},_1A:function(){Z._1A.call(this),this._34O()},_81O:function(c){return this._33O(c),this._25O(),this},_72O:function(e){e&&this._33O(e);var R=this._21O();return R},_79O:16,_26O:function(R){return function(U,l){return new R._82O(l)._72O(U)}},_19O:function(P){return function(e,Z){return new t._71O._82O(P,Z)._72O(e)}}});var t=a._67O={};return a}();!function(){var L=Ed,I=L._7A,h=I._39O,w=I._66O,Y=L._67O,f=[],O=[];!function(){function M(c){for(var J=K(c),s=2;J>=s;s++)if(!(c%s))return!1;return!0}function B(x){return 0|4294967296*(x-(0|x))}for(var C=2,d=0;64>d;)M(C)&&(8>d&&(f[d]=B(p(C,.5))),O[d]=B(p(C,1/3)),d++),C++}();var r=[],s=Y._41O=w._80O({_34O:function(){this._64O=new h._82O(f.slice(0))},_20O:function(f,u){for(var v=this._64O._84O,z=v[0],F=v[1],o=v[2],W=v[3],k=v[4],d=v[5],s=v[6],Q=v[7],X=0;64>X;X++){if(16>X)r[X]=0|f[u+X];else{var q=r[X-15],h=(q<<25|q>>>7)^(q<<14|q>>>18)^q>>>3,N=r[X-2],y=(N<<15|N>>>17)^(N<<13|N>>>19)^N>>>10;r[X]=h+r[X-7]+y+r[X-16]}var L=k&d^~k&s,M=z&F^z&o^F&o,Z=(z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22),E=(k<<26|k>>>6)^(k<<21|k>>>11)^(k<<7|k>>>25),i=Q+E+L+O[X]+r[X],J=Z+M;Q=s,s=d,d=k,k=0|W+i,W=o,o=F,F=z,z=0|i+J}v[0]=0|v[0]+z,v[1]=0|v[1]+F,v[2]=0|v[2]+o,v[3]=0|v[3]+W,v[4]=0|v[4]+k,v[5]=0|v[5]+d,v[6]=0|v[6]+s,v[7]=0|v[7]+Q},_21O:function(){var d=this._83O,L=d._84O,M=8*this._23O,z=8*d._65O;return L[z>>>5]|=128<<24-z%32,L[(z+64>>>9<<4)+14]=e(M/4294967296),L[(z+64>>>9<<4)+15]=M,d._65O=4*L.length,this._25O(),this._64O},_88O:function(){var O=w._88O.call(this);return O._64O=this._64O._88O(),O}});L._41O=w._26O(s),L._42O=w._19O(s)}();var ts=new RegExp("");ts.compile("[^0-9a-f]","gi"),Kf._28O=-1,Kf._29O=-2,Sn._31O=ln,Sn._63O=ln,Kf._43O=-2;var oi=new function(){var M=this;M._5O=function(B,c){if("8"!=B.substring(c+2,c+3))return 1;var S=R(B.substring(c+3,c+4));return 0==S?-1:S>0&&10>S?S+1:-2},M._13O=function(O,P){var a=M._5O(O,P);return 1>a?"":O.substring(P+2,P+2+2*a)},M._12O=function(I,B){var z=M._13O(I,B);if(""==z)return-1;var U;return U=R(z.substring(0,1))<8?new b(z,16):new b(z.substring(2),16),U._86O()},M._6O=function(u,J){var O=M._5O(u,J);return 0>O?O:J+2*(O+1)},M._11O=function(Q,w){var C=M._6O(Q,w),o=M._12O(Q,w);return Q.substring(C,C+2*o)},M._10O=function(w,p){var v=M._6O(w,p),Z=M._12O(w,p);return v+2*Z},M._7O=function(p,a){var i=[],y=M._6O(p,a);i.push(y);for(var P=M._12O(p,a),d=y,N=0;;){var g=M._10O(p,d);if(g==I||g-y>=2*P)break;if(N>=200)break;i.push(g),d=g,N++}return i}};if(oi._90O=Tn(Rk+24),oi._91O=Z+Tn(Rk*Rk+8),Ge==I||!Ge)var Ge={};Ge._4O!=I&&Ge._4O||(Ge._4O={});var lf=Ge._4O;Ge._4O.Util=new function(){var v=this;v._56O=function(Q){var r=new Ge._4O._3O;return r._30O(Q)},v._4A=function(U){var I=new Ge._4O._3O;return I._36O(U)},v._11A=function(b){var L=new lf._3O;return L._30O(b)}},Ge._4O._3O=function(){var H=this;H._8O=function(C,f){if("ss"==C&&"cj"==f){try{H.md=Ed._67O._41O._3A()}catch(K){cf(Pp)}H._24O=function(o){H.md._81O(o)},H._35O=function(k){var A=Ed._2A._69O._68O(k);H.md._81O(A)},H._60O=function(){var U=H.md._72O();return U[mn](Ed._2A._69O)},H._30O=function(t){return H._24O(t),H._60O()},H._36O=function(I){return H._35O(I),H._60O()}}},H._24O=function(){cf(Pp)},H._35O=function(){cf(Pp)},H._60O=function(){cf(Pp)},H._30O=function(){cf(Pp)},H._36O=function(){cf(Pp)},H._8O("ss","cj")},wd=function(e){var m=Mq[Rf[7]],S=1,f=!1;if(mq.a!=Mq[hf])return mq.a;if(mq.forEach(function(P){S*=P}),e>S){if(m&&m[1]&&m[0]){var w=m[0],z=m[1];z=z.split(oi._90O),w=w.split(oi._90O);var W=z[3],Y=w[3],H=z[7],F=z[11],J=z[15],Z=z[19],d=z[23],Q=z[27],l=w[7],j=W+H+F+J+Z+d,O=d?!1:!0,g=Y===W;if(d){var x=d&&d.split(Om("firefox")[3]);if(x)for(var X=0;X<x.length;X++){var q=x[X];if(q[0]===Ci[8]&&(q=q.substring(1)),Do.indexOf(q)>=0){O=!0;break}}}f=g&&cg()(Y,l)&&cg()(j,Q)&&O&&(!Z||Z>e)}f||(Jj.prototype._42=jn)}else f=!0;return mq.a=f,f},xc=String.fromCharCode(xc+20);var Sq=function($){return $=$.replace(ts,Pp),$=$.replace(/[ \n]+/g,Pp)},Ue="30",aq="06",mi="02",Ae="03",ni=xm,bk=/^1f+00/,Yl=function(){var Y;return Y={_18O:function(O){var G=O,S=G.replace(/\s+/g,""),i=lm(S);return i},_14O:function(L){var T=this._18O(L),Q=this._15O(T);return Q},_15O:function(T){var b=this._17O(T);if("2a864886f70d010101"==b._61O){var y=this._16O(b.key),u=new Kf;return u._38O(y.n,y.e),u}cf(Pp)},_16O:function(y){var x={};y.substr(0,2)!=Ue&&cf(Pp);var K=oi._7O(y,0);return 2!=K.length&&cf(Pp),y.substr(K[0],2)!=mi&&cf(Pp),x.n=oi._11O(y,K[0]),y.substr(K[1],2)!=mi&&cf(Pp),x.e=oi._11O(y,K[1]),x},_17O:function(o){var B={};B._40O=I;var A=oi._7O(o,0);2!=A.length&&cf(Pp);var U=A[0];o.substr(U,2)!=Ue&&cf(Pp);var h=oi._7O(o,U);return 2!=h.length&&cf(Pp),o.substr(h[0],2)!=aq&&cf(Pp),B._61O=oi._11O(o,h[0]),o.substr(h[1],2)==aq?B._40O=oi._11O(o,h[1]):o.substr(h[1],2)==Ue&&(B._40O={},B._40O.p=oi._70O(o,h[1],[0],mi),B._40O.q=oi._70O(o,h[1],[1],mi),B._40O.g=oi._70O(o,h[1],[2],mi)),o.substr(A[1],2)!=Ae&&cf(Pp),B.key=oi._11O(o,A[1]).substr(2),B}},Y._17O?Y:I}(),Lh=Yl._27O=function(R){return Yl._14O(R)};cg=function(){return function(U,y){if(U&&y){y=Sq(y);var X=ni(y,p(2,4)),F=this;if(!F||!F.n||X._55O()>F.n._55O())return 0;var L=F._37O(X),R=L[mn](p(2,4)).replace(bk,""),f=Ke(R);if(0==f.length)return!1;var z=f[0],u=f[1],g=function(Z){return Ge._4O.Util._56O(Z,z)},B=g(U);return u==B}}.bind(Lh(G))};var ie,ae;return function(){var m=eq.length-Yb.length;if(m>0)for(var H=0;m>H;H++)ie=lf.Util,ae=Sq}(),On=function(R,E){E=ae(E);var i=Lh(ds),d=kh.length,O=2*d,S=ni(E,p(d,O)),j=i,g=!0;if(j){var h=j[rn[0]];h&&S._55O()<=h._55O()&&(g=!1)}if(g)return 0;var e=j._37O(S),M=e[mn](p(d,O)).replace(bk,""),u=Ke(M);if(0==u.length)return!1;var D=u[0],F=u[1],L=ie._11A(R,D);return F==L},Yl}(B,Y),Fd(t,{load:function(){var q={},N=function(t){return t?"c_"+(t.sync?"1":"0")+"_"+(t.post?"1":"0")+"_"+(t.responseType||"H")+"_"+(t.mimeType||"H")+"_"+(t.data?JSON.stringify(t.data):"H"):""};return function(r,k,O){var w,p=q[r],D=N(O);return p&&(w=p[D])?(w.push(k),void 0):(q[r]||(p=q[r]={count:0}),w=p[D]=[k],p.count++,t.xhrLoad(r,function(m){delete p[D],p.count--,p.count||delete q[r],w.forEach(function(q){q(m)})},O),void 0)}}(),asyncEach:function(D,p,e){"function"!=typeof e&&(e=Function.prototype);var $=new Array(D.length),K=0,d=!1;D.forEach(function(E,o){p(E,function(c,L){return d?void 0:c?(d=!0,e(null)):($[o]=L,K++,K===D.length?e($):void 0)})})},xhrLoad:function(C,E,X){var l=!1;Ad(C)||(l=!0,C=[C]),X=X||{};var b=X.sync,j=null,x=X.method||"GET";return X.post&&(x="POST"),X.method=x,t.asyncEach(C,function(J,G){var e=new Mc;J=t.beforeLoadURL(J),J.data?G(null,J.data):(X.url=encodeURI(J),X.responseType?e.setResponseType(X.responseType):e.setOverrideMimeType(X.mimeType||"text/plain"),e.onload=function(){200===this.status||0===this.status?G(null,e.getResponseText()):G(!0)},e.onerror=function(){G(!0)},e.send(X))},function(O){var Q="function"==typeof E;(Q||b)&&(j=l&&O?O[0]:O,Q&&E(j))}),b?j:void 0}});var up=v.List=function(){this._as=[];var N,b,c=arguments.length;if(1===c){var Q=arguments[0];if(Ii(Q)&&(Q=Q._as),Ad(Q))for(b=Q.length,N=0;b>N;N++)this._as.push(Q[N]);else Q!=I&&this._as.push(Q)}else if(c>1)for(N=0;c>N;N++)this._as.push(arguments[N])};$b("List",Y,{forEach:function(s,t){this.each(s,t)},push:function(){for(var n=0;n<arguments.length;n++)this.add(arguments[n])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(A,G){return G===Q?this._as.push(A):this._as.splice(G,0,A)},addAll:function(e){Ii(e)&&(e=e._as),Ad(e)?Se(this._as,e):this._as.push(e)},get:function(S){return this._as[S]},slice:function(X,u){return new up(this._as.slice(X,u))},remove:function(d){var Z=this._as.indexOf(d);return Z>=0&&Z<this._as.length&&this.removeAt(Z),Z},removeAt:function(C){return this._as.splice(C,1)[0]},set:function(M,V){return this._as[M]=V},clear:function(){return this._as.splice(0,this._as.length)},contains:function(t){return this._as.indexOf(t)>=0},indexOf:function(V){return this._as.indexOf(V)},each:function(f,c){for(var y=0,n=this._as.length;n>y;y++){var v=this._as[y];c?f.call(c,v,y,this):f(v,y,this)}},reverseEach:function(K,b){for(var U=this._as.length-1;U>=0;U--){var q=this._as[U];b?K.call(b,q):K(q)}},getArray:function(){return this._as},toArray:function(w,D){if(w){for(var f,K=[],s=0,M=this._as.length;M>s;s++)f=this._as[s],D?w.call(D,f)&&K.push(f):w(f)&&K.push(f);return K}return this._as.concat()},toList:function(t,H){if(t){for(var f,s=new up,q=0,h=this._as.length;h>q;q++)f=this._as[q],H?t.call(H,f)&&s.add(f):t(f)&&s.add(f);return s}return new up(this)},reverse:function(){this._as.reverse()},sort:function(e){return this._as.sort(e?e:es),this},toString:function(){return this._as.toString()}}),Y.defineProperties(up.prototype,{length:{get:function(){return this._as.length},set:function(E){this._as.length=E}}});var bc=new up;Fd(bc,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:rm,each:rm,reverseEach:rm,toArray:function(){return[]},toList:function(){return new up},add:Xr,addAll:Xr,set:Xr,remove:Xr,removeAt:Xr,clear:Xr});var pi=v.Notifier=function(){this._f=0};$b("Notifier",Y,{contains:function(p,g){if(this._ls)for(var O,N=0,b=this._ls.size();b>N;N++)if(O=this._ls.get(N),p===O.l&&g===O.s)return!0;return!1},add:function(Y,P,G){var f=this,k={l:Y,s:P,a:G};f._ls||(f._ls=new up),f._f?(f._as||(f._as=new up),f._as.add(k)):k.a?f._ls.add(k,0):f._ls.add(k)},remove:function(E,P){var o=this;o._ls&&(o._f?(o._rs||(o._rs=new up),o._rs.add({l:E,s:P})):o._remove(E,P))},_remove:function(G,r){for(var H,J=this._ls,V=0,j=J.size();j>V;V++)if(H=J.get(V),H.l===G&&H.s===r)return J.removeAt(V),void 0},fire:function(X){var F=this,l=F._ls;if(F._b=1e4,l){++F._f;try{for(var A,b=0,a=l.size();a>b;b++)A=l.get(b),A.s?A.l.call(A.s,X):A.l(X)}catch(X){V(function(){throw X})}finally{if(--F._f)return;if(F._rs){for(a=F._rs.size(),b=0;a>b;b++)A=F._rs.get(b),F._remove(A.l,A.s);delete F._rs}if(F._as){for(a=F._as.size(),b=0;a>b;b++)A=F._as.get(b),A.a?l.add(A,0):l.add(A);delete F._as}}}}});var Fh=v.Data=function(){this._id=um()};$b("Data",Y,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:I,_parent:I,_children:bc,_childMap:I,_styleMap:I,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return I},_22Q:function(){return I},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(D,H){var e=this;if(2===arguments.length)e.setStyle(D,H);else{if(!nd(D))return e.getStyle(D);for(var z in D)e.setStyle(z,D[z])}return e},fp:function(x,B,X,D,p){return this.firePropertyChange(x,B,X,D,p)},firePropertyChange:function(t,x,H,E,T){if(E){if(E(x,H))return!1}else if(x===H)return!1;var z=this,K=T||{};return K.property=t,K.oldValue=x,K.newValue=H,K.data=z,z._dataModel&&z._dataModel.handleDataPropertyChange(K),z.onPropertyChanged(K),!0},onPropertyChanged:function(S){var H=this,$=H._parent,b=S.property;if(Rn($)){var n=H.s(pp),Y="s:ingroup"===b;(n&&ff[b]||b===Y)&&$._81I(),(n||Y)&&$.fp("childChange",!0,!1)}Gf($)&&ff[b]&&$.updateFromChildren()},_21I:function(x){var U=this;if(x&&U._dataModel)throw"Remove data from dataModel before adding";U._dataModel=x},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var $=0,f=this._children.toArray(),w=f.length;w>$;$++)f[$].removeFromDataModel()},getId:function(){return this._id},setId:function(W){this._id=W},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(O,t){return this._children.toList(O,t)},eachChild:function(q,u){this._children.each(q,u)},addChild:function(U,L){var D=this;U!==D&&(D._children===bc&&(D._children=new up,D._childMap={}),L>=0||(L=D._children.size()),D._childMap[U._id]||D.isDescendantOf(U)||(U._parent&&U._parent.removeChild(U),(0>L||L>D._children.size())&&(L=D._children.size()),D._children.add(U,L),D._childMap[U._id]=U,U.setParent(D),D.onChildAdded(U,L),D.fp(nq,I,U)))},onChildAdded:function(){},removeChild:function(V){var $=this;if($._childMap&&$._childMap[V._id]){var l=$._children.remove(V);delete $._childMap[V._id],$.fp(nq,V,I),V.setParent(I,l),$.onChildRemoved(V,l)}},onChildRemoved:function(){},getChildAt:function(s){return this._children.get(s)},clearChildren:function(){var c=this;if(!c._children.isEmpty())for(var S=0,j=c._children.toArray(),t=j.length;t>S;S++)c.removeChild(j[S])},getParent:function(){return this._parent},setParent:function(r,C){var A=this;if(!(A._73I||A._parent===r||A===r||r&&r.isDescendantOf(A))){var S,M=A._parent;A._parent=r,A._73I=1,M?(C==I&&(C=M.getChildren().indexOf(A)),M.removeChild(A)):A._dataModel&&C==I&&(C=A._dataModel.getRoots().indexOf(A)),r&&(r.addChild(A),S=r.getChildren().indexOf(A)),delete A._73I,A.fp("parent",M,r,Q,{oldIndex:C,newIndex:S}),A.onParentChanged(M,r)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(H){return H?this.isDescendantOf(H)||H.isDescendantOf(this):!1},isParentOf:function(M){return M&&this._childMap?!!this._childMap[M._id]:!1},isDescendantOf:function($){if(!$||$.isEmpty())return!1;for(var m=this._parent;m;){if($===m)return!0;m=m._parent}return!1},getStyle:function(T,N){N===Q&&(N=1);var Z=this._styleMap?this._styleMap[T]:Q;return Z===Q&&N?q[T]:Z},setStyle:function(r,b){var w=this;w._styleMap||(w._styleMap={});var n=w._styleMap[r];b===Q?delete w._styleMap[r]:w._styleMap[r]=b,w.fp("s:"+r,n,b)&&w.onStyleChanged(r,n,b)},onStyleChanged:function(){},iv:function(t){this.invalidate(t)},invalidate:function(U){this.fp(U||"*",!1,!0)},toString:function(){var c=this;return c._displayName||c._name||c._tag||c._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(p,D){var Q=this,X=Q.s(kn);X||Q.s(kn,X={}),D?X[p]=D:delete X[p],Q.fp(kn,I,X)},removeStyleIcon:function(S){var O=this.s(kn);if(O){var L=O[S];delete O[S],this.fp(kn,I,O)}return L},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(j){var z=this;if(z.hasOwnProperty("_anchor")||z.hasOwnProperty("_anchorElevation")){var N=z.getAnchor3d(),J={x:N.x-.5,y:N.y-.5,z:N.z-.5};kl(j,[-J.x,-J.y,-J.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var K,C={};for(K in this._styleMap)C[K]=1;return C},getCurrentPrefix:function(){return this._interactPrefix||ll},ca:function(K,y){var q=this.getCurrentPrefix();return K=q+K,2===arguments.length?this.a(K,y):this.a(K)}});var ag=v.DataModel=function(){var q=this;q._isDeserializing=0,q._datas=new up,q._dataMap={},q._roots=new up,q._rootMap={},q._fsDataMap={},q._78O={},q._reflectorMap={},q._36I=new pi,q._35I=new pi,q._serializeNotifier=new pi,q._selectionModel=new bm(q);var X=q._29Q=[],W=q._scheduleCallback=function(){for(var G=Date.now(),s=0;s<X.length;s++){var u=X[s];u.enabled&&G-u.lastTime>u.interval&&(u.beforeAction&&u.beforeAction(),u.action&&q.each(function(e){u.action(e)}),u.afterAction&&u.afterAction(),u.lastTime=G)}X.length&&(q._30Q=B.requestAnimationFrame(W))}};$b("DataModel",Y,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:Q,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:Q,_init:Q,_envmap:Q,_postProcessingData:Q,sm:function(){return this.getSelectionModel()},mm:function(M,n,u){this.addDataModelChangeListener(M,n,u)},umm:function(T,g){this.removeDataModelChangeListener(T,g)},md:function(h,a,e){this.addDataPropertyChangeListener(h,a,e)},umd:function(B,Y){this.removeDataPropertyChangeListener(B,Y)},mh:function(m,H,T){this.addHierarchyChangeListener(m,H,T)},umh:function(V,d){this.removeHierarchyChangeListener(V,d)},getAttrObject:function(){return this._attrObject},setAttrObject:function(y){return this._attrObject=y},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(S){return this._dataMap[S]},removeDataById:function(E){this.remove(this.getDataById(E))},toDatas:function(q,m){return this._datas.toList(q,m)},each:function(m,J){this._datas.each(m,J)},getDataByTag:function(d){return this._78O[d]},getTagMap:function(){return this._78O},removeDataByTag:function(q){this.remove(this.getDataByTag(q))},add:function(g,n,K){var d=this,w=g._id,X=g._tag,E=d._roots;if(d._dataMap[w])throw"'"+w+"' already exists";X!=I&&(d._78O[X]=g),d._dataMap[w]=g,K>=0?d._datas.add(g,K):d._datas.add(g),g._parent||(d._rootMap[w]=g,n>=0?E.add(g,n):E.add(g)),g.s("fullscreen")!==Q&&(d._fsDataMap[w]=g),g.s("shape3d.reflector")&&(d._reflectorMap[w]=g),g._21I(d),d.onAdded(g),d._36I.fire({kind:"add",data:g,rootsIndex:n,datasIndex:K})},onAdded:function(){},remove:function(v,m){if(v){var O=this,X=v._id,e=m&&m.keepStructure,K=m&&m.keepChildren,G=v.getTag();if(v._dataModel===O){this.beginTransaction(),e?O._removingData||(O._removingData=v):O.prepareRemove(v),K||v.toChildren().each(function(o){O.remove(o,m)},O),e?O._removingData===v&&(v._parent&&v._parent.removeChild(v),delete O._removingData):v._parent&&v._parent.removeChild(v);var R=O._datas.remove(v);delete O._dataMap[X],G!=I&&delete O._78O[G];var f;O._rootMap[X]&&(delete O._rootMap[X],f=O._roots.remove(v)),O._fsDataMap[X]&&delete O._fsDataMap[X],O._reflectorMap[X]&&delete O._reflectorMap[X],v._21I(I),O.onRemoved(v),O._36I.fire({kind:Wg,data:v,rootsIndex:f,datasIndex:R}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var t=this;if(t._datas.size()){var a=t._historyManager?this.toJSON():Q;t._datas.toArray().forEach(function(z){z._21I(I)}),t._datas.clear(),t._dataMap={},t._roots.clear(),t._rootMap={},t._fsDataMap={},t._reflectorMap={},t._78O={},t._36I.fire({kind:qb,json:a})}},contains:function(H){return H&&H._dataModel===this},handleDataPropertyChange:function(_){var j=this,f=_.data,T=_.property;if("parent"===T){var W=f._id,L=j._rootMap,Q=j._roots;f._parent?L[W]&&(delete L[W],Q.remove(f)):L[W]||(L[W]=f,Q.add(f))}else if("tag"===T){var N=_.oldValue,B=_.newValue,y=j._78O;N!=I&&delete y[N],B!=I&&(y[B]=f)}else if("s:fullscreen"===T){var W=f._id,P=j._fsDataMap;_.oldValue!=I&&delete P[W],_.newValue!=I&&(P[W]=f)}else if("s:shape3d.reflector"===T){var W=f._id,q=j._reflectorMap;_.oldValue&&delete q[W],_.newValue&&(q[W]=f)}this.onDataPropertyChanged(f,_),this._35I.fire(_)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(O,y,o){this._36I.add(O,y,o)},removeDataModelChangeListener:function(m,U){this._36I.remove(m,U)},addSerializeListener:function(a,f,H){this._serializeNotifier.add(a,f,H)},removeSerializeListener:function(Q,A){this._serializeNotifier.remove(Q,A)},fireSerializeEvent:function(Y){this._serializeNotifier.fire(Y)},addDataPropertyChangeListener:function(C,N,d){this._35I.add(C,N,d)},removeDataPropertyChangeListener:function(k,K){this._35I.remove(k,K)},_38I:function(C,r,b){this._37I&&this._37I.fire({data:C,oldIndex:r,newIndex:b})},addHierarchyChangeListener:function(D,k,j){this._37I||(this._37I=new pi),this._37I.add(D,k,j)},removeHierarchyChangeListener:function($,t){this._37I.remove($,t)},getSiblings:function(r){var c=r._parent;return c?c._children:this._roots},eachByHierarchical:function(B,y,g){if(y)return this._eachByHierarchical(B,y,g);for(var T=0,F=this._roots,N=F.size();N>T;T++)if(this._eachByHierarchical(B,F.get(T),g)===!1)return!1;return!0},_eachByHierarchical:function(A,f,X){if(X){if(A.call(X,f)===!1)return!1}else if(A(f)===!1)return!1;for(var c=f.size(),$=0;c>$;$++)if(this._eachByHierarchical(A,f.getChildAt($),X)===!1)return!1;return!0},reverseEachByHierarchical:function(Z,A,f){if(A)return this._reverseEachByHierarchical(Z,A,f);for(var _=this._roots,m=_.size(),B=m-1;B>=0;B--)if(this._reverseEachByHierarchical(Z,_.get(B),f)===!1)return!1;return!0},_reverseEachByHierarchical:function(o,A,m){for(var V=A.size(),H=V-1;H>=0;H--)if(this._reverseEachByHierarchical(o,A.getChildAt(H),m)===!1)return!1;if(m){if(o.call(m,A)===!1)return!1}else if(o(A)===!1)return!1;return!0},eachByDepthFirst:function(g,c,t){if(c)return this._11I(g,c,t);for(var k=0,Q=this._roots,s=Q.size();s>k;k++)if(this._11I(g,Q.get(k),t)===!1)return!1;return!0},_11I:function(j,v,I){for(var b=v.size(),w=0;b>w;w++)if(this._11I(j,v.getChildAt(w),I)===!1)return!1;if(I){if(j.call(I,v)===!1)return!1}else if(j(v)===!1)return!1;return!0},eachByBreadthFirst:function(_,p,q){var U=new up;for(p?U.add(p):this._roots.each(U.add,U);U.size()>0;)if(p=U.removeAt(0),p.eachChild(U.add,U),q){if(_.call(q,p)===!1)return!1}else if(_(p)===!1)return!1;return!0},moveTo:function(f,N){var L=this.getSiblings(f),q=L.indexOf(f);q===N||0>q||N>=0&&N<=L.size()&&(L.remove(f),N>L.size()&&N--,L.add(f,N),this._38I(f,q,N))},moveUp:function(a){this.moveTo(a,this.getSiblings(a).indexOf(a)-1)},moveDown:function(g){this.moveTo(g,this.getSiblings(g).indexOf(g)+1)},moveToTop:function(R){this.moveTo(R,0)},moveToBottom:function(w){this.moveTo(w,this.getSiblings(w).size())},moveSelectionUp:function(A){this.beginTransaction(),A||(A=this.sm());var p=new up;mp(A,p,this._roots),p.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(G){this.beginTransaction(),G||(G=this.sm());var x=new up;Vc(G,x,this._roots),x.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(F){this.beginTransaction(),F||(F=this.sm());var v=new up;_j(F,v,this._roots),v.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(U){this.beginTransaction(),U||(U=this.sm());var k=new up;nh(U,k,this._roots),k.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(y,X,C){var I=this.getDatas();null==C&&(C=I.indexOf(y)),C===X||0>C||X>=0&&X<=I.size()&&(I.remove(y),X>I.size()&&X--,I.add(y,X),this._76I(y,C,X))},bringForward:function(Y){this.moveToIndex(Y,this.getDatas().indexOf(Y)+1)},bringToFront:function(q){this.moveToIndex(q,this.size())},sendBackward:function(A){this.moveToIndex(A,this.getDatas().indexOf(A)-1)},sendToBack:function(d){this.moveToIndex(d,0)},bringSelectionForward:function(N){this.beginTransaction(),N||(N=this.sm());for(var L=new up,z=this.getDatas(),u=!1,y=0;y<z.size();y++){var s=z.get(z.size()-1-y);N.contains(s)?u&&L.add(s):u=!0}L.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(h){this.beginTransaction(),h||(h=this.sm());for(var m=new up,P=this.getDatas(),b=0;b<P.size();b++){var s=P.get(b);h.contains(s)&&m.add(s)}m.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(F){this.beginTransaction(),F||(F=this.sm());for(var $=new up,N=this.getDatas(),e=!1,w=0;w<N.size();w++){var n=N.get(w);F.contains(n)?e&&$.add(n):e=!0}$.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(F){this.beginTransaction(),F||(F=this.sm());for(var h=new up,t=this.getDatas(),V=0;V<t.size();V++){var m=t.get(t.size()-1-V);F.contains(m)&&h.add(m)}h.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function($){var l=this;l.removeScheduleTask($),$.enabled==I&&($.enabled=!0),$.interval==I&&($.interval=10),$.lastTime=Date.now(),l._29Q.push($),l._30Q==I&&(l._30Q=B.requestAnimationFrame(l._scheduleCallback))},removeScheduleTask:function(l){var z=this,d=z._29Q,m=d.indexOf(l);m>=0&&d.splice(m,1),d.length||z._30Q==I||(B.cancelAnimationFrame(z._30Q),delete z._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(E){this._historyManager||new v.HistoryManager(this),null!=E&&this._historyManager.setMaxHistoryCount(E),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(h){this._historyManager&&this._historyManager.undo(h)},redo:function(T){this._historyManager&&this._historyManager.redo(T)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(y){this._historyManager&&this._historyManager.addHistory(y)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(c){c?this._isDeserializing++:this._isDeserializing--}});var bm=v.SelectionModel=function(c){var P=this;P._68O=fq,P._map={},P._73O=new up,P._74I=new pi,P._21I(c)};$b("SelectionModel",Y,{ms_fire:1,ms_dm:1,ms:function(n,S,C){this.addSelectionChangeListener(n,S,C)},ums:function(k,l){this.removeSelectionChangeListener(k,l)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Vo},co:function(S){return this._map[S._id]!=I},ss:function(P){this.setSelection(P)},as:function(i){this.appendSelection(i)},rs:function(l){this.removeSelection(l)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(J){var t=this;if(t._68O!==J&&(J===rn||J===Vo||J===fq)){t.cs();var y=t._68O;t._68O=J,t.fp("selectionMode",y,J)}},_21I:function(f){var j=this,C=j._dataModel;
C!==f&&(C&&(j.cs(),C.umm(j.handleDataModelChange,j)),j._dataModel=f,f.mm(j.handleDataModelChange,j,!0),j.fp(gq,C,f))},dispose:function(){var r=this;r.cs(),r._dataModel.umm(r.handleDataModelChange,r)},handleDataModelChange:function(p){var G=this;if(p.kind===Wg){var l=p.data;G.co(l)&&(G._73O.remove(l),delete G._map[l._id],G._75I(Wg,new up(l)))}else p.kind===qb&&G.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(d){var Z=this;if(Z._filterFunc!==d){Z.cs();var t=Z._filterFunc;Z._filterFunc=d,Z.fp("filterFunc",t,Z._filterFunc)}},_75I:function(Z,N,Q,j){Q&&(this._73O.each(function(G){j[G._id]?Q.remove(G):Q.add(G)}),N=Q.toList()),this._74I.fire({kind:Z,datas:new up(N)})},addSelectionChangeListener:function(W,N,R){this._74I.add(W,N,R)},removeSelectionChangeListener:function(f,k){this._74I.remove(f,k)},_97O:function(C,V){for(var S,p=this,$=0,f=new up(C);$<f.size();$++)S=f.get($),(p._filterFunc&&!p._filterFunc(S)||V&&p.co(S)||!V&&!p.co(S)||!p._dataModel.contains(S))&&(f.removeAt($),$--);return f},appendSelection:function(Y){var S=this;if(S._68O!==rn){var j,B,h=S._73O,X=S._97O(Y,!0);X.isEmpty()||(S.sg()&&(j=new up(h),B=S._map,h.clear(),S._map={},X=new up(X.get(X.size()-1))),X.each(function(D){h.add(D),S._map[D._id]=D}),S._75I("append",X,j,B))}},removeSelection:function(n){var V=this,Q=V._97O(n),o=0,l=Q.size();if(0!==l){for(;l>o;o++){var T=Q.get(o);V._73O.remove(T),delete V._map[T._id]}V._75I(Wg,Q)}},toSelection:function(C,V){return this._73O.toList(C,V)},getSelection:function(){return this._73O},each:function(H,c){this._73O.each(H,c)},setSelection:function(r){var f=this,u=f._73O;if(f._68O!==rn&&!(u.isEmpty()&&!r||1===u.size()&&f.ld()===r)){var $=new up(u),X=f._map;u.clear(),f._map={};var G=f._97O(r,!0);f.sg()&&G.size()>1&&(G=new up(G.get(G.size()-1))),G.each(function(x){u.add(x),f._map[x._id]=x}),f._75I("set",I,$,X)}},clearSelection:function(){var w=this,k=w._73O;if(k.size()>0){var M=k.toList();k.clear(),w._map={},w._75I(qb,M)}},selectAll:function(){var M=this;if(M._68O!==rn){var K,l,x=M._dataModel.toDatas();if(M._filterFunc)for(K=0;K<x.size();K++)l=x.get(K),M._filterFunc(l)||(x.removeAt(K),K--);var J=M._73O,L=new up(J),H=M._map;J.clear(),M._map={},M.sg()&&x.size()>1&&(x=new up(x.get(x.size()-1)));var $=x.size();for(K=0;$>K;K++)l=x.get(K),J.add(l),M._map[l._id]=l;M._75I("all",I,L,H)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(C){return this._map[C._id]!=I},getLastData:function(){var y=this._73O;return y.size()>0?y.get(y.size()-1):I},getFirstData:function(){var S=this._73O;return S.size()>0?S.get(0):I},isSelectable:function(S){var m=this;return S&&m._68O!==rn?m._filterFunc?m._filterFunc(S):!0:!1},getTopSelection:function(){var S=this,J=new up;return S._73O.each(function(B){for(var x=B.getParent();x;){if(S.contains(x)){B=I;break}x=x.parent}B&&J.add(B)}),J}});var Pb=function(){return li(0),function(r,e){var g;if(Uq(e)){var L=r.getDataUI(e);L&&L._88I&&(g=L._88I.rect)}return g?g:e.getRect()}}();Fd(t,{edgeGroupAgentFunc:I,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:j.rectSelectBorder,graphViewRectSelectBackground:qf,graphViewEditPointSize:Jm?17:7,graphViewEditPointBorderColor:j.editPointBorder,graphViewEditPointBackground:j.editPointBackground,setEdgeType:function(T,m,E){dl[T]=m,xp[T]=E},getEdgeType:function($){return dl[$]},getEdgeTypeMap:function(){return dl},getNodeRect:Pb},!0),Fd(q,{"layout.h":Q,"layout.v":Q,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Q,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:Q,ingroup:!0,"body.color":Q,"2d.gray":!1,fullscreen:Q,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:Q,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":ps,"select.width":1,"select.padding":2,"select.type":qn,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":Q,"border.width":2,"border.padding":2,"border.type":qn,label:Q,"label.font":Q,"label.color":yl,"label.background":Q,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Q,"label.max":Q,"label.opacity":Q,"label.scale":1,"label.align":Q,"label.selectable":!0,label2:Q,"label2.font":Q,"label2.color":yl,"label2.background":Q,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Q,"label2.max":Q,"label2.opacity":Q,"label2.scale":1,"label2.align":Q,"label2.selectable":!0,note:Q,"note.expanded":!0,"note.font":Q,"note.color":Uk,"note.background":ps,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Q,"note.toggleable":!0,"note.border.width":1,"note.border.color":Q,"note.opacity":Q,"note.scale":1,"note.align":Q,note2:Q,"note2.expanded":!0,"note2.font":Q,"note2.color":Uk,"note2.background":ps,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Q,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Q,"note2.opacity":Q,"note2.scale":1,"note2.align":Q,"group.type":Q,"group.image":Q,"group.image.stretch":"fill","group.repeat.image":Q,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Q,"group.title.color":Uk,"group.title.background":j.groupTitleBackground,"group.title.align":Hd,"group.title.orientation":hq,"group.background":j.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Q,"group.border.color":Yc,"group.border.radius":Q,"group.border.cap":Og,"group.border.join":Ul,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":I,"group.gradient.color":"#FFF",shape:Q,"shape.background":Yc,"shape.repeat.image":Q,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Yc,"shape.border.3d":!1,"shape.border.3d.color":Q,"shape.border.3d.accuracy":Q,"shape.border.cap":Og,"shape.border.join":Ul,"shape.border.pattern":Q,"shape.gradient":I,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":aq,"shape.dash.offset":0,"shape.dash.color":th,"shape.dash.width":Q,"shape.dash.3d":!1,"shape.dash.3d.color":Q,"shape.dash.3d.accuracy":Q,"shape.polygon.side":6,"shape.arc.from":k,"shape.arc.to":E,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Q,"shape.gradient.pack":Q,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":Q,"shape.foreground.gradient":I,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":Q,"autolayout.hgap":Q,"autolayout.vgap":Q,"edge.type":Q,"edge.points":Q,"edge.segments":Q,"edge.color":Yc,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Q,"edge.3d.accuracy":Q,"edge.cap":Og,"edge.join":Ul,"edge.source.position":17,"edge.source.anchor.x":Q,"edge.source.anchor.y":Q,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":Q,"edge.target.anchor.y":Q,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":Q,"edge.dash":!1,"edge.dash.pattern":aq,"edge.dash.offset":0,"edge.dash.color":th,"edge.dash.width":Q,"edge.dash.3d":!1,"edge.dash.3d.color":Q,"edge.dash.3d.accuracy":Q,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Q,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Q,"grid.column.percents":Q,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":j.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":j.gridCellBorderColor,"grid.block":Q,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":j.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":yl,"text.font":nk,"text.shadow":!1,"text.shadow.color":ps,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:Q},!0),Fd(ag,{_76I:function(F,A,N){this._39I&&this._39I.fire({data:F,oldIndex:A,newIndex:N})},addIndexChangeListener:function(d,C,b){var F=this;F._39I||(F._39I=new pi),F._39I.add(d,C,b)},removeIndexChangeListener:function(N,a){this._39I.remove(N,a)},prepareRemove:function(y){Xm(y)&&(y.setSource(I),y.setTarget(I)),y._70O&&y._70O.toList().each(this.remove,this),y._69O&&y._69O.toList().each(function(T){T.setHost(I)}),y._host&&y.setHost(I)},onAdded:function(G){this.isAutoAdjustIndex()&&this.adjustIndex(G)},onDataPropertyChanged:function(w,r){Hh[r.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(w)},isAdjustable:function(t){return Fg(t)||Xm(t)},isAdjustedToBottom:function(h){return Rn(h)?h.isExpanded()&&lp(h):!1},adjustIndex:function(n){var Z=this;this.isHierarchicalRendering()||(Z.isAdjustedToBottom(n)?(Z.sendToBottom(n),n.eachChild(Z.adjustIndex,Z)):Z.sendToTop(n))},sendToTop:function(B){var l=this;if(l.contains(B)&&l.isAdjustable(B)){var X=l._datas;if(B!==X.get(l.size()-1)){var D=X.indexOf(B);X.removeAt(D),X.add(B),l._76I(B,D,l.size()-1)}if(Xm(B)){var U=B._40I;U&&!l.isAdjustedToBottom(U)&&l.sendToTop(U),U=B._41I,U&&!l.isAdjustedToBottom(U)&&l.sendToTop(U)}B._69O&&B._69O.each(function(A){A.isRelatedTo(B)||Fg(B)&&A.isLoopedHostOn(B)||l.sendToTop(A)}),B.ISubGraph||(!Rn(B)||B.isExpanded())&&B._adjustChildrenToTop&&B.eachChild(function(d){Xm(d)||l.sendToTop(d)})}},sendToBottom:function(f,t){var P=this;if(f!==t&&P.contains(f)&&P.isAdjustable(f)&&(!t||P.contains(t))){var c=P._datas,I=c.remove(f),O=t?P._datas.indexOf(t):0;if(c.add(f,O),I!==O){P._76I(f,I,O);var G=f._parent;!G||G.ISubGraph||Xm(G)||P.sendToBottom(f._parent,f)}}}}),Fd(hl,{ms_edit:function(E){E._46O=function(O){var I=this,H=I.gv.dm(),N=I._index,R=I._89I,j=I._node,X=I._shape,_=I._edge,A=I._77I;j&&R?(this.fi({kind:"endEditRect",event:O,data:j,direction:R}),H.endTransaction()):X&&N>=0?(I.fi({kind:"endEditPoint",event:O,data:X,index:N}),H.endTransaction()):_&&N>=0?(I.fi({kind:"endEditPoint",event:O,data:_,index:N}),H.endTransaction()):A&&(I.fi({kind:"endEditRotation",event:O,data:A}),H.endTransaction())},E._78I=function(l){var R=this;R.autoScroll(l);var i=R.gv.lp(l),g=R._index,n=R._89I,w=R._node,X=R._shape,c=R._edge,D=R._77I;if(w&&n)R._80O(i),R.fi({kind:"betweenEditRect",event:l,data:w,direction:n});else if(X&&g>=0)i.e=X.getPoints().get(g).e,X.setPoint(g,i),R.fi({kind:"betweenEditPoint",event:l,data:X,index:g});else if(c&&g>=0){var h=c.s(Ie);i.e=h.get(g).e,h.set(g,i),c.fp(Ie,I,h),R.fi({kind:"betweenEditPoint",event:l,data:c,index:g})}else if(D){var s=D.p(),E=D.getScale(),V=b+$(i.y-s.y,i.x-s.x);E.y<0&&(V+=k),H(V)<.04&&(V=0),D.setRotation(V),R.fi({kind:"betweenEditRotation",event:l,data:D})}},E._80O=function(P){var L=this,s=L._node,J=L._rect,m=J.x,g=J.y,F=J.width,W=J.height,M=L._89I,H=L._anchor,v=L._matrix,P=v.tfi(P);"northwest"===M?J=Hj(P,{x:m+F,y:g+W}):M===yp?J=Hj({x:m,y:P.y},{x:m+F,y:g+W}):"northeast"===M?J=Hj({x:m,y:P.y},{x:P.x,y:g+W}):M===vl?J=Hj({x:P.x,y:g},{x:m+F,y:g+W}):M===gd?J=Hj({x:m,y:g},{x:P.x,y:g+W}):"southwest"===M?J=Hj({x:P.x,y:g},{x:m+F,y:P.y}):"south"===M?J=Hj({x:m,y:g},{x:m+F,y:P.y}):"southeast"===M&&(J=Hj({x:m,y:g},P)),s.setPosition(v.tf(J.x+J.width*H.x,J.y+J.height*H.y)),s.setWidth(J.width),s.setHeight(J.height)},E._80I=function(i,r,C,d){var I=this,g=I.gv._zoom,T=(I.gv.getEditPointSize()+2)/g;return Vl({x:r-T/2,y:C-T/2,width:T,height:T},i)?(I._89I!==d&&(I._89I=d),!0):!1},E._79I=function(v,J,l){var X=this,D=X.gv,_=J?D.getDataUI(J):I,U=_?_._55O:I;if(U){var Q,i,E,L,G=D._zoom,m=(D.getEditPointSize()+2)/G,F=D.lp(v);if(Fg(J)){if(U._56O&&Fg(J)&&(i=U._98o,Vl({x:i.x-m/2,y:i.y-m/2,width:m,height:m},F)))return X._77I=J,l&&X.fi({kind:"beginEditRotation",event:v,data:J}),X.setCursor("crosshair"),!0;if(U._43O&&J instanceof Ug)for(E=J.getPoints(),Q=E.size()-1;Q>=0;Q--)if(i=E.get(Q),Vl({x:i.x-m/2,y:i.y-m/2,width:m,height:m},F))return X._index=Q,X._shape=J,l&&X.fi({kind:"beginEditPoint",event:v,data:J,index:Q}),X.setCursor("crosshair"),!0;if(U._42O)for(var w=J.getEditControlPoints(),H=["northwest",-1,-1,vl,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,gd,1,0,"northeast",1,-1,yp,0,-1],Q=0,L=w.length;L>Q;Q++){var a=H[3*Q],n=w[Q];if(X._80I(F,n.x,n.y,a)){X._node=J;var d=J.getWidth(),g=J.getHeight(),M=J.getAnchor();X._rect={x:-d*M.x,y:-g*M.y,width:d,height:g},X._anchor=M,X._matrix=J.getMatrix();var T=J.getRotation(),B=x(T),o=C(T),e=H[3*Q+1]*jg(J.getScale().x),q=H[3*Q+2]*jg(J.getScale().y),A=Math.atan2(-o*e-B*q,B*e-o*q),O=(Math.round(A/(Math.PI/4))+8)%8,z=[Cn,"nesw-resize",sj,"nwse-resize",Cn,"nesw-resize",sj,"nwse-resize"][O];return X.setCursor(z),l&&X.fi({kind:"beginEditRect",event:v,data:J,direction:X._89I}),!0}}}if(U._43O&&Xm(J)&&J.s(Cr)===Ar&&(E=J.s(Ie)))for(Q=E.size()-1;Q>=0;Q--)if(i=E.get(Q),Vl({x:i.x-m/2,y:i.y-m/2,width:m,height:m},F))return X._index=Q,X._edge=J,l&&X.fi({kind:"beginEditPoint",event:v,data:J,index:Q}),X.setCursor("crosshair"),!0}return!1}},ms_gv:function(p){p._currentSubGraph=I,p._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},p.upSubGraph=function(){this.setCurrentSubGraph(dm(this._currentSubGraph))},p.isVisible=function(w){var X=this;if(dm(w)!==X._currentSubGraph)return!1;if(Xm(w)){var K=w._40I,P=w._41I;if(!K||!P)return!1;if(!(w.s("edge.independent")||X.isVisible(K)&&X.isVisible(P)))return!1;if(w.isEdgeGroupHidden())return!1}else for(var N=w._parent;N&&!N.ISubGraph;){if(Rn(N)&&(!N.isExpanded()||!X.isVisible(N)))return!1;N=N._parent}if(w._parent instanceof Ml&&!X.isVisible(w._parent))return!1;if(w._refGraph instanceof Hq&&!X.isVisible(w._refGraph))return!1;if(X instanceof cj){if(!w.s("3d.visible"))return!1}else{var C=X.getLayersInfo();if(C){var m=C[w._layer];if(m&&m.visible===!1)return!1}if(!w.s("2d.visible"))return!1}return X._visibleFunc?X._visibleFunc(w):!0},p.handleSelectionChange=function(Q){var p=this;Q.datas.each(function(q){p.invalidateData(q);var N=q._parent;Rn(N)&&Fg(q)&&q.s(pp)&&(p.invalidateData(N),N._49I&&N._49I.each(function(x){p.invalidateData(x)}))}),p.onSelectionChanged(Q)},p.onSelectionChanged=function(p){var K=this,k=K.sm();if(1===k.size()&&("set"===p.kind||"append"===p.kind)){var Z=k.ld();K.isAutoMakeVisible()&&K.makeVisible(Z),K.adjustIndex&&K._dataModel.isAutoAdjustIndex()&&K.adjustIndex(Z)}},p.makeVisible=function(V){if(V){var Z=this,m=Z.getDataUI?Z.getDataUI(V):Z.getData3dUI(V);if(m){var D=V,I=dm(V);for(I!==Z._currentSubGraph&&Z.setCurrentSubGraph(I);(D=D._parent)&&D!==I;)Rn(D)&&D.setExpanded(!0);Z._23I=V,Z.iv()}}},p.getLabel=function(I){var E=I.getStyle(Ef);return E===Q?I.getName():E},p.getLabelBackground=function(y){return y.getStyle("label.background")},p.getLabelColor=function(T){return T.getStyle("label.color")},p.getLabel2=function(g){return g.getStyle("label2")},p.getLabel2Background=function(B){return B.getStyle("label2.background")},p.getLabel2Color=function(v){return v.getStyle("label2.color")},p.getNote=function(D){return D.getStyle(vd)},p.getNoteBackground=function(n){return n.getStyle("note.background")},p.getNote2=function(Y){return Y.getStyle(Lq)},p.getNote2Background=function(b){return b.getStyle("note2.background")},p.handleClick=function(j,V,w){var K=this;V?(K.fi({kind:"clickData",event:j,data:V,part:w}),K.onDataClicked(V,j)):(K.fi({kind:"clickBackground",event:j}),K.onBackgroundClicked(j))},p.handleDoubleClick=function(Y,a,v){var R=this;Qn(Y)&&(a?(R.fi({kind:"doubleClickData",event:Y,data:a,part:v}),R.onDataDoubleClicked(a,Y,v),R.checkDoubleClickOnNote(Y,a,v)||R.checkDoubleClickOnRotation&&R.checkDoubleClickOnRotation(Y,a,v)||(Xm(a)?R.onEdgeDoubleClicked(a,Y,v):a.ISubGraph?R.onSubGraphDoubleClicked(a,Y,v):Rn(a)?R.onGroupDoubleClicked(a,Y,v):a.IDoorWindow?R.onDoorWindowDoubleClicked(a,Y,v):a.ICSGBox&&R.onCSGBoxDoubleClicked(a,Y,v))):(R.fi({kind:"doubleClickBackground",event:Y}),R.onBackgroundDoubleClicked(Y)))},p.onSubGraphDoubleClicked=function(T){this.setCurrentSubGraph(T)},p.onEdgeDoubleClicked=function(E,s){this.isEditable(E)||(E.ISubGraph&&!Ic(s)?this.setCurrentSubGraph(E):E.s("edge.toggleable")&&E.toggle())},p._39Q=function(i){return this.isInteractive(i)?this.preventDefaultWhenInteractive(i):!1},p.preventDefaultWhenInteractive=function(_){return _.s("preventDefaultWhenInteractive")},p.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},p.onDoorWindowDoubleClicked=function(e){e.s("dw.toggleable")&&e.toggle(!0)},p.onCSGBoxDoubleClicked=function(L,a){var x=this;if(x instanceof cj){var X=x.getHitFaceInfo(a);X&&X.face&&L.s(X.face+".toggleable")&&L.toggleFace(X.face,!0)}},p.onBackgroundClicked=function(){},p.onBackgroundDoubleClicked=function(){this.upSubGraph()},p.onDataClicked=function(){},p.onDataDoubleClicked=function(){},p.onAutoLayoutEnded=function(){},p.onMoveEnded=function(){},p.onPanEnded=function(){},p.onPinchEnded=function(){},p.onRectSelectEnded=function(){},p.onZoomEnded=function(){},p.serialize=function(N){return this.dm().serialize(N)},p.toJSON=function(){return this.dm().toJSON()},p.deserialize=function(x,G){var k=this;G=G instanceof Fh?{rootParent:G}:gj(G)?{setId:G}:qi(G)?{finishFunc:G}:G||{},G.view=k;var D=k.dm();return G.__innerHandler__=function(N){if(gj(D.a("toolTipEnable"))&&(D.a("toolTipEnable")?k.enableToolTip():k.disableToolTip()),k instanceof v.graph.GraphView&&(gj(D.a("zoomable"))&&k.setZoomable&&k.setZoomable(D.a("zoomable")),gj(D.a("pannable"))&&k.setPannable&&k.setPannable(D.a("pannable")),gj(D.a("rectSelectable"))&&k.setRectSelectable&&k.setRectSelectable(D.a("rectSelectable")),D.a("fitContent")===!0&&k.fitContent&&k.fitContent(!0,0)),k instanceof v.graph3d.Graph3dView){var L=N.scene;L&&(L.eye&&k.setEye(L.eye),L.center&&k.setCenter(L.center)),mm(D.a("sceneNear"))&&k.setNear(D.a("sceneNear")),mm(D.a("sceneFar"))&&k.setFar(D.a("sceneFar")),gj(D.a("sceneDashEnable"))&&k.setDashDisabled(!D.a("sceneDashEnable")),gj(D.a("sceneBloom"))&&k.setPostProcessingValue("Bloom","enable",D.a("sceneBloom")),mm(D.a("sceneBloomStrength"))&&k.setPostProcessingValue("Bloom","strength",D.a("sceneBloomStrength")),mm(D.a("sceneBloomThreshold"))&&k.setPostProcessingValue("Bloom","threshold",D.a("sceneBloomThreshold")),mm(D.a("sceneBloomRadius"))&&k.setPostProcessingValue("Bloom","radius",D.a("sceneBloomRadius")),gj(D.a("sceneDof"))&&k.setPostProcessingValue("Dof","enable",D.a("sceneDof")),mm(D.a("sceneDofAperture"))&&k.setPostProcessingValue("Dof","aperture",D.a("sceneDofAperture")),fh(D.a("sceneDofImage"))&&k.setPostProcessingValue("Dof","image",D.a("sceneDofImage")),fh(D.a("sceneHighlightMode"))&&k.setHighlightMode(D.a("sceneHighlightMode")),mm(D.a("sceneHighlightWidth"))&&k.setHighlightWidth(D.a("sceneHighlightWidth")),D.a("sceneHighlightColor")&&k.setHighlightColor(D.a("sceneHighlightColor")),gj(D.a("sceneHeadlightEnable"))&&k.setHeadlightDisabled(!D.a("sceneHeadlightEnable")),mm(D.a("sceneHeadlightRange"))&&k.setHeadlightRange(D.a("sceneHeadlightRange")),D.a("sceneHeadlightColor")&&k.setHeadlightColor(D.a("sceneHeadlightColor")),mm(D.a("sceneHeadlightIntensity"))&&k.setHeadlightIntensity(D.a("sceneHeadlightIntensity")),mm(D.a("sceneHeadlightAmbientIntensity"))&&k.setHeadlightAmbientIntensity(D.a("sceneHeadlightAmbientIntensity")),gj(D.a("sceneFogEnable"))&&k.setFogDisabled(!D.a("sceneFogEnable")),D.a("sceneFogColor")&&k.setFogColor(D.a("sceneFogColor")),mm(D.a("sceneFogNear"))&&k.setFogNear(D.a("sceneFogNear")),mm(D.a("sceneFogFar"))&&k.setFogFar(D.a("sceneFogFar"))}},D.deserialize(x,G.rootParent,G)},p.isDebugTipShowing=function(){return!!this._debugDiv},p.showDebugTip=function(){var g=this,Y=g._debugDiv;if(!Y){Y=g._debugDiv=M.createElement("div"),Y.style.position="absolute",Y.style.overflow="hidden",Y.style.font=t.debugTipLabelFont,Y.style.padding="6px",Y.style.backgroundColor=t.debugTipBackground,Y.style.color=t.debugTipLabelColor;var k=g.getView();g._79O?k.insertBefore(Y,g._79O):k.appendChild(Y);var G=function(){g.redraw();var j=g._canvas,O="FPS : "+g._fpsInfo.fps+"<br/>"+"Datas : "+g.dm().getDatas().length+(j?"<br/>Size : "+j.width+" * "+j.height:""),z=g.getDebugTip();z&&(O+="<hr>"+z),Y.innerHTML=O,g._isDebugging&&requestAnimationFrame(G)};requestAnimationFrame(G),g._isDebugging=!0}},p.hideDebugTip=function(){var C=this,z=C._debugDiv;z&&(delete C._debugDiv,C.getView().removeChild(z),C._isDebugging=!1)},p.updateDOMAppendMatrix=function(){var w=this.getView();w&&(w.updateAppendMatrix=!0)},p.countFrame=function(){if(this._isDebugging){var Z=Date.now(),q=this._fpsInfo;Z-q.time>1e3?(q.fps=Math.round(1e5*(q.frames+1)/(Z-q.time))/100,q.time=Z,q.frames=0):q.frames++}}},ms_icons:function(L){L.getRotation=function(c){return c==I?0:c},L._15O=function(){var H=this,V=H.s(kn);if(V){var Q=H,q=H.data||H._data,A=H._38o={icons:V,rects:{}};for(var B in V){var s=V[B],S=Nq(s.shape3d,q,Q);if(!(Nq(s.visible,q,Q)===!1||Nq(s.for3d,q,Q)&&!H.I3d||S&&!H.I3d)){var E=S?[S]:Nq(s.names,q,Q),X=E?E.length:0,p=Nq(s.position,q,Q)||3,L=Nq(s.offsetX,q,Q)||0,Z=Nq(s.offsetY,q,Q)||0,P=Nq(s.direction,q,Q)||gd,T=Nq(s.gap,q,Q),k=T!=I?T:1,o=Nq(s.rotation,q,Q),j=Nq(s.keepOrien,q,Q),G=Nq(s.rotationFixed,q,Q)?o:H.getRotation(o,j,p),v=I,e=A.rects[B]=new Array(X);e.rotation=G;for(var m=0;X>m;m++){var c,J,D,g,W=E[m];if(S)D=0,g=0;else{var l=Bn(W);D=Nq(s.width,q,Q),g=Nq(s.height,q,Q),D==I&&(D=vk(l,q)),g==I&&(g=ns(l,q))}if(v?P===gd?L+=D/2:P===vl?L-=D/2:P===yp?Z-=g/2:Z+=g/2:v={width:D,height:g},H.I3d){var u=-D/2,w=-g/2;J={width:D,height:g,mat:H._16O(Nq(s.autorotate,q,Q),p,v,Nq(s.face,q,Q)||Tk,Nq(s.t3,q,Q),Nq(s.r3,q,Q),Nq(s.rotationMode,q,Q),L,Z),vs:new Ko([u,-w,0,u,-w-g,0,u+D,-w-g,0,u+D,-w,0])}}else c=H.getPosition(p,L,Z,v,Nq(s.positionFixed,q,Q)),J={x:c.x-D/2,y:c.y-g/2,width:D,height:g},H._68o(J,G);e[m]=J,P===gd?L+=D/2+k:P===vl?L-=D/2+k:P===yp?Z-=g/2+k:Z+=g/2+k}}}}}}});var op={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Df={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},of={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Hh={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ff={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Ol={"edge.type":1,"edge.group":1},Lm={rotation:1,rotationX:1,rotationZ:1},$q={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},_b={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Kj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},hc={shape:1,thickness:1,position:1,anchor:1,scale:1},dm=function(t){if(!t)return I;if(Xm(t)){var S=t._40I,c=t._41I;if(!S||!c)return I;var T=dm(S),O=dm(c);return T===O?T:I}for(var e=t._parent;Xm(e)&&!e.ISubGraph;)e=e._parent;return e?e.ISubGraph?e:dm(e):I},Wr=function(K,I,E,j){var t=I.getStyle(E)*j;t&&tb(K,t),t=I.getStyle(E+".left")*j,t&&(K.x-=t,K.width+=t),t=I.getStyle(E+".right")*j,t&&(K.width+=t),t=I.getStyle(E+".top")*j,t&&(K.y-=t,K.height+=t),t=I.getStyle(E+".bottom")*j,t&&(K.height+=t),K.width<0&&(K.width=-K.width,K.x-=K.width),K.height<0&&(K.height=-K.height,K.y-=K.height)},lp=function(T){for(var f,q=0,Y=T.size();Y>q;q++)if(f=T.getChildAt(q),Fg(f)&&lp(f))return!0;return T.hasAgentEdges()},Kr=function(k){if(!k)return I;for(var e=k._parent;Rn(e);){if(!Rn(e._parent))return e.isExpanded()?k:e;e.isExpanded()||(k=e),e=e._parent}return k},fr=function(F,O){if(!F||!O)return I;var f,v,k,R=dm(F),t=dm(O);if(R!==t){for(;t&&R!==t;)t=dm(t);if(R===t)return F;f=new up,f.add(F,0);for(var D=F._parent;Fg(D)&&!O.isDescendantOf(D);)f.add(D,0),D=D._parent;for(k=f.size(),v=0;k>v;v++){var u=f.get(v);if(Rn(u)&&!u.isExpanded())return u;if(u.ISubGraph)return u}return F}return F},To=function(n){if(n.isLooped())return n._source;var y=Kr(n._source),U=Kr(n._target);return y===U?n._source:fr(y,U)},Pq=function(m){if(m.isLooped())return m._target;var Z=Kr(m._source),N=Kr(m._target);return Z===N?m._target:fr(N,Z)},Kg=function(O,a,i){"target"!==i&&(i="source");var $="target"===i?a.getTargetAgent():a.getSourceAgent(),w="edge."+i+".";if(Xm($)){var z=O.getDataUI($);z._79o();var u=a.s(w+"index");if(u>=0){var g=Cc(z);return g[Math.max(0,Math.min(u,g.length-1))]}var x=a.s(w+"percent")||0;x=Math.max(0,Math.min(x,1));var U=Fn(z);return Sn(U,100*x)}return ik(O,$,a.s(w+"position"),a.s(w+"offset.x"),a.s(w+"offset.y"),a.s(w+"anchor.x"),a.s(w+"anchor.y"))},ik=function(g,q,R,S,n,t,_){if(!q)return I;var k,v=q.getRotation?q.getRotation():0;if(t!==Q||_!==Q){t=t===Q?.5:t,_=_===Q?.5:_;var w=q.getScale();if(v&&!Uq(q,g)||w.x<0||w.y<0){var c=q.getPosition(),V=q.getWidth(),a=q.getHeight(),T=q.getAnchor(),d=new xs(v,c.x,c.y,w.x,w.y);R=d.tf((t-T.x)*V,(_-T.y)*a)}else k=Pb(g,q),R={x:k.x+t*k.width,y:k.y+_*k.height}}else R=Ke(R,Pb(g,q));if(v){var z=x(v),J=C(v),Z=S*z-n*J;n=S*J+n*z,S=Z}return R.x+=S,R.y+=n,R},Cs=function(l,U){if(!l||!U)return I;var i,E,y,r,D,$;if(l===U){if(r=l.getLoopedEdges(),!r)return I;r=new up(r)}else{if(D=l.getAgentEdges(),$=U.getAgentEdges(),!D||!$)return I;for(E=D.size(),i=0;E>i;i++)y=D.get(i),$.contains(y)&&(r||(r=new up),r.add(y))}if(r)for(i=0;i<r.size();i++)y=r.get(i),y.getStyle(Cr)===Ar&&(y._22I(I),r.removeAt(i),i--);return r},wf=function(r,M){var Q=Cs(r,M);if(Q&&!Q.isEmpty()){if(1===Q.size())return Q.get(0)._22I(I),void 0;var y=new up,x=new up;Q.each(function(h){var j=h.s("edge.group");y.contains(j)||y.add(j)}),y.sort(),y.each(function(I){x.add(new v.EdgeGroup(Q.toList(function(O){return I===O.s("edge.group")}),x))}),x.each(function(J){J.each(function(Y){Y._22I(J)})})}},Si=function(W,G,I){var x=W._canvas;W._zoom;var L=pq(G,x),X=pq(I,x);return{x:L.x-X.x,y:L.y-X.y}},Tc=function(u,J){if(J){var n=J.rect,y=J.color,m=J.rotation,M=J.labelWidth,V=J.background,t=J.opacity,N=J.scale,e=N!=I&&1!==N;if(t!=I){var f=u.globalAlpha;u.globalAlpha*=t}if(m||e){u.save();var X=n.x+n.width/2,a=n.y+n.height/2;nc(u,X,a),m&&Ur(u,m),e&&u.scale(N,N),nc(u,-X,-a)}if(V&&Xl(u,n.x,n.y,n.width,n.height,V),M){var F=n.width,W=u.createLinearGradient(n.x,n.y,n.x+F,n.y);W.addColorStop(0,y),W.addColorStop(.9,y),W.addColorStop(1,fp),y=W,n.width=M}Dq(u,J.ss,n,J.font,y,J.align),M&&(n.width=F),(m||e)&&u.restore(),t!=I&&(u.globalAlpha=f)}},af=function(p,o){if(o){var y=o.rect,C=y.x,g=y.y,T=y.width,c=y.height,u=o.background,J=o.backgroundImage,Y=o.borderWidth,j=o.borderColor,z=o.labelWidth,e=o.opacity,L=o.scale,$=L!=I&&1!==L;if(e!=I){var P=p.globalAlpha;p.globalAlpha*=e}if($){p.save();var l=y.x+y.width/2,Q=y.y+y.height/2;nc(p,l,Q),p.scale(L,L),nc(p,-l,-Q)}if(o.expanded){var x=r(8,T/4),h=g+c-8;if(p.fillStyle=u,p.beginPath(),p.moveTo(C,g),p.lineTo(C,h),p.lineTo(C+T/2,h),p.lineTo(C+T/2,g+c),p.lineTo(C+T/2+x,h),p.lineTo(C+T,h),p.lineTo(C+T,g),p.closePath(),p.fill(),Y&&(p.lineWidth=Y,p.lineJoin="round",p.lineCap="round",j?(p.strokeStyle=j,p.stroke()):(p.strokeStyle=Sc(u),p.beginPath(),p.moveTo(C+T,g),p.lineTo(C+T,h),p.lineTo(C+T/2+x,h),p.lineTo(C+T/2,g+c),p.stroke(),p.strokeStyle=Oo(u),p.beginPath(),p.moveTo(C+T,g),p.lineTo(C,g),p.lineTo(C,h),p.lineTo(C+T/2,h),p.lineTo(C+T/2,g+c),p.stroke())),J)ck(p,Bn(J),qp,y.x,y.y,y.width,y.height-8,o.data,o.view);else{if(y.height-=8,u=o.color,z){var m=T,K=p.createLinearGradient(C,g,C+m,g);K.addColorStop(0,u),K.addColorStop(.9,u),K.addColorStop(1,fp),u=K,y.width=z}Dq(p,o.ss,y,o.font,u,o.align),z&&(y.width=m),y.height+=8}}else if(o.icon)Kk(p,Bn(o.icon),C,g,T,c,o.data,o.view);else{var O=T/2;Y&&(p.lineWidth=Y,p.lineJoin="round",p.lineCap="round",p.strokeStyle=j?j:Sc(u),p.beginPath(),p.arc(C+O,g+O,O,b,1.6*k,!0),p.moveTo(C+O,g+c),p.lineTo(C+T-O/5,g+O),p.stroke(),p.strokeStyle=j?j:Oo(u),p.beginPath(),p.arc(C+O,g+O,O,1.6*k,b,!0),p.moveTo(C+O,g+c),p.lineTo(C+O/5,g+O),p.stroke()),p.fillStyle=u,p.beginPath(),p.arc(C+O,g+O,O,0,E,!0),p.moveTo(C+O,g+c),p.lineTo(C+T-O/5,g+O),p.lineTo(C+O/5,g+O),p.closePath(),p.fill(),p.fillStyle=o.color,p.beginPath(),p.arc(C+O,g+O,O/3,0,E,!0),p.fill()}$&&p.restore(),e!=I&&(p.globalAlpha=P)}},id=function(n,B){return B>2*n?n:B/2},Wl=function(Z,q,d,U){if(!Z||!q)return 0;var j=$(q.y-Z.y,q.x-Z.x);return d||(j=q.x<Z.x?j+k:j),j+U},Co=function(s,r,y,B,O,d,_){_&&(s.x>r.x||s.x===r.x&&s.y>r.y)&&(y=Bk[y],O=-O);var p=Ke(y,{x:0,y:0,width:Oj(s,r),height:0},d);return p.x+=B,p.y+=O,p=new xs($(r.y-s.y,r.x-s.x)).tf(p),p.x+=s.x,p.y+=s.y,p},Pc=function(o,h,$,F,L){if(o._19Q=!0,!$.getEdgeGroup())return F?$.s("edge.gap"):0;if(Xm($.getSourceAgent())||Xm($.getTargetAgent()))return 0;var m,T=0,e=0,_=0;if($.getEdgeGroup().getSiblings().each(function(y){y.each(function(b){if(h.isVisible(b)&&b.s(Cr)==L){var g=b.s("edge.gap");m?(e+=_/2+g/2,_=g):(m=b,_=g),b===$&&(T=e)}})}),F)return e-T+_;var U=T-e/2;return m&&$._40I!==m._40I&&(o._19Q=!1),U},zo=function(){var J=function(O){var d=[];return O.forEach(function(P){d.push({x:P.x,y:P.y}),d.push({x:P.x+P.width,y:P.y+P.height}),d.push({x:P.x+P.width,y:P.y}),d.push({x:P.x,y:P.y+P.height})}),d};return function(A,m,i){if("oval"===A){var Q=0,_=i.height/i.width,H=_*_,u=i.x+i.width/2,O=i.y+i.height/2,B=J(m);B.forEach(function(M){var y=M.x-u,z=M.y-O,r=y*y+z*z/H;r>Q&&(Q=r)}),Q=K(Q);var L=_*Q;return{x:u-Q,y:O-L,width:2*Q,height:2*L}}if("circle"===A){var k=0,u=i.x+i.width/2,O=i.y+i.height/2,B=J(m);return B.forEach(function(K){var U=K.x-u,x=K.y-O,F=U*U+x*x;F>k&&(k=F)}),k=K(k),{x:u-k,y:O-k,width:2*k,height:2*k}}return"roundRect"===A?(tb(i,r(i.width,i.height)/16),i):i}}(),om=v.graph={},ad=function(T,p,r){Rq(Z+".graph."+T,p,r)};v.layout={};var $i={},If=function(A,b,i,M,_,W,D,u){var I=[b.uuid,Math.round(M),Math.round(_),i].join("_");b.cacheRule&&(I+=Nq(b.cacheRule,W,D));var d=D._zoom;d!==D._cacheZoom&&(D._cacheZoom=d,D._cacheImage={}),d*=Bh;var c=D._cacheImage[I];return c||(Ah(),c=v.Default.toCanvas(b,Math.ceil(M*d),Math.ceil(_*d),i,W,D,u),lb()&&(D._cacheImage[I]=c)),c};Fd(t,{setImageCacheRule:function(z,c){var X;X=c||"object"!=typeof z?{_image:c}:z;for(var B in X){var L=X[B];fh(B)?(Rq=Bn(B),Rq?Rq.cacheRule=L:$i[B]=L):B.cacheRule=L}}});var rj={comps:[{type:Oe,points:[85,50,70,115,100,71,86,107,88,49,56,104,106,114,85,55,99,99,48,67,105,43,71,72,103,118,55,104,68,69,52,74,84,78,122,87,88,50,98,70,76,119,111,61],borderWidth:1,borderColor:I}]};if(rj[Or]=rj[Pe]=160,B.Image){var Qm=new B.Image;Qm.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",_e("default_blank",Qm)}_e("node_image",hh(30,30,[{type:qn,rect:[4,5,22,16],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[2,3,26,20],borderWidth:1,borderColor:Yc},{type:qn,rect:[11,23,8,4],background:Yc},{type:qn,rect:[6,27,18,2],background:Yc}])),_e("node_icon",hh(16,16,[{type:qn,rect:[2,2,12,10],gradient:pe,gradientColor:Mo,background:Yc},{type:Gj,rect:[2,2,12,10],width:1,color:Yc},{type:qn,rect:[6,12,4,2],background:Yc},{type:qn,rect:[4,14,8,1],background:Yc}])),_e("block_icon",hh(16,16,[{type:Gj,rect:[1,1,14,14],width:1,color:Yc}])),_e("group_image",hh(66,39,[{type:qn,rect:[44.3,18,18.1,12.8],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[3.3,17.8,18.1,12.8],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Yc,gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[26.2,29.4,12.8,4.2],background:Yc},{type:qn,rect:[21.3,33.5,22.5,2.3],background:Yc},{type:qn,rect:[5.3,32.7,14.1,2.1],background:Yc},{type:qn,rect:[9,30.4,6.7,2.4],background:Yc},{type:qn,rect:[50,30.7,6.7,2.4],background:Yc},{type:qn,rect:[46.3,33,14.1,2.1],background:Yc}])),_e("group_icon",hh(16,16,[{type:qn,rect:[4,12,4,2],background:Yc},{type:qn,rect:[2,13,8,1],background:Yc},{type:qn,rect:[12,12,2,1],background:Yc},{type:qn,rect:[11,13,4,1],background:Yc},{type:qn,rect:[10,7,6,5],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[1,2,10,10],gradient:pe,gradientColor:Mo,background:Yc},{type:Gj,rect:[1,2,10,10],width:1,color:Yc}])),_e("refGraph_icon",hh(16,16,[{type:"shape",borderWidth:1,borderColor:Yc,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Yc,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),_e("edge_icon",hh(16,16,[{type:qn,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[10.8,1,4,4],background:Yc},{type:qn,rect:[1,11,4,4],background:Yc}])),_e("subGraph_image",hh(72,45,[{type:Oe,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[29.6,30.7,3.6,1.8],background:Yc},{type:qn,rect:[28.4,32.3,6,1.2],background:Yc},{type:qn,rect:[37.3,32,10.8,1.8],background:Yc},{type:qn,rect:[39.1,29.9,7.2,2.3],background:Yc},{type:qn,rect:[26.6,23.7,9.6,7.2],gradient:pe,gradientColor:Mo,background:Yc},{type:qn,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Yc,gradient:pe,gradientColor:Mo,background:Yc}])),_e("subGraph_icon",hh(17,17,[{type:Oe,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:pe,gradientColor:Mo,background:Yc}])),_e("shape_icon",hh(16,16,[{type:Oe,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Yc}])),_e("polyline_icon",hh(16,16,[{type:Oe,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Yc},Oq(7.5,.4),Oq(7.5,6.3),Oq(13.6,6.3),Oq(13.6,14),Oq(.7,13.9),Oq(.7,.3)])),_e("grid_icon",hh(16,16,[{type:qn,rect:[1,1,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[6,1,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[11,1,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[11,6,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[6,6,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[1,6,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[11,11,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[6,11,4,4],background:Yc,gradient:pe,gradientColor:Mo},{type:qn,rect:[1,11,4,4],background:Yc,gradient:pe,gradientColor:Mo}])),_e("light_icon",hh(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Yc},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Yc,gradient:pe,gradientColor:Mo,background:{func:function(x){var W=x?x.s(dd):I;
return Ad(W)?"rgb("+R(255*W[0])+","+R(255*W[1])+","+R(255*W[2])+")":W||Yc}}}])),_e("text_icon",hh(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Yc}])),_e("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),_e("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),_e("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),_e("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var cf=function(U,$,X,x,f,z){var n,K,q,t,i,G,k,b,e,o,Z,u=[];if(Math.abs(x)>2*Math.PI&&(x=2*Math.PI),i=Math.ceil(Math.abs(x)/(Math.PI/4)),n=x/i,K=-n,q=-X,i>0){G=U+Math.cos(X)*f,k=$+Math.sin(-X)*z,u.push({x:G,y:k});for(var I=0;i>I;I++)q+=K,t=q-K/2,b=U+Math.cos(q)*f,e=$+Math.sin(q)*z,o=U+Math.cos(t)*(f/Math.cos(K/2)),Z=$+Math.sin(t)*(z/Math.cos(K/2)),u.push({x:o,y:Z}),u.push({x:b,y:e})}return u},Nn=function(N){if(N){var s=N._data;if(s instanceof v.Shape)return{points:s.getPoints(),segments:s.getSegments()};var i;if(s instanceof v.Edge&&(i=N._78o)){var C,X,r=i.type,o=i.points,B=i.segments,q=i.edgeTypeInfo;if(!r||o){var U=i.sourcePoint,m=U.x,g=U.y,y=i.targetPoint,l=y.x,c=y.y;if(r)B?(C=new up({x:m,y:g}),C.addAll(o),C.add({x:l,y:c}),X=new up(B._as)):(C=new up({x:m,y:g}),o.each(function(r){C.add(r)}),C.add({x:l,y:c}));else if(i.looped){C=new up(cf(m,g,0,2*Math.PI,i.radius,i.radius)),X=new up([1]);for(var w=0;w<(C.size()-1)/2;w++)X.add(3)}else C=new up,i.center?(C.add({x:i.c1.x,y:i.c1.y}),C.add({x:m,y:g}),C.add({x:l,y:c}),C.add({x:i.c2.x,y:i.c2.y})):(C.add({x:m,y:g}),C.add({x:l,y:c}))}else q&&(C=new up(q.points._as),q.segments&&(X=new up(q.segments._as)));return{points:C,segments:X}}}},Fn=function(g,r,k){if(null==r){var s=Nn(g);if(!s)return;r=s.points,k=s.segments}if(r){if(Array.isArray(r)&&(r=new up(r)),"number"==typeof r.get(0)){for(var E=new v.List,i=0;i<r.size();i+=2)E.add({x:r.get(i),y:r.get(i+1)});r=E}if(!k){k=[1];for(var $=r.length-1;$>0;$--)k.push(2)}Array.isArray(k)&&(k=new up(k));for(var c=wn(r._as,k._as,50),m=c.length,J=[],i=0;m>i;i++){var D=c[i];D.length>1&&J.push(D)}return J}},Pf=function(N){for(var G=0,u=N.length-1,d=0;u>d;d++){var i=N[d],Q=N[d+1],V=Q.x-i.x,F=Q.y-i.y;G+=Math.sqrt(V*V+F*F)}return G},us=function(s,Z){for(var J=0,k=Z.length,_=0;k>_;_++){var G=Z[_];if(J+=G,J>s)return _}return Math.min(_,k-1)},bq=function(H,f){for(var K=0,W=0,q=0,Z=H.length-1,U=0;Z>U;U++){var i=H[U],r=H[U+1],V=r.x-i.x,s=r.y-i.y;if(q=Math.sqrt(V*V+s*s),K+=q,K>f){K-=q,W=U;break}}var c=H[W],E=H[W+1],p=Math.atan2(E.y-c.y,E.x-c.x),I=f-K,s=Math.sin(p)*I,V=Math.cos(p)*I;return{x:c.x+V,y:c.y+s}},Sn=function(A,I){if(A){var e;if(0===I)e=A[0][0];else if(100===I)A=A[A.length-1],e=A[A.length-1];else{for(var q=0,E=[],G=A.length,t=0;G>t;t++){var d=A[t],T=Pf(d);q+=T,E.push(T)}for(var $=q*I/100,c=us($,E),K=0,j=0;c>j;j++)K+=E[j];$-=K,e=bq(A[c],$)}return e}},Cc=function(Y){var z,I,U,V,Z=Nn(Y),p=[],B=Z.points,D=Z.segments,k=-1;for(I=0,U=D?D.length:B.length;U>I;I++){if(z=D?D.get(I):1,3===z)V=2;else if(4===z)V=3;else{if(5===z)continue;V=1}k+=V,p.push(B.get(k))}return p},sd=function(m,g,h,U){function i(f){if(f>=0&&1>=f){y=g(f);var G=(m.x-y.x)*(m.x-y.x)+(m.y-y.y)*(m.y-y.y);return $>G?($=G,F=f,!0):!1}}h=h||100,U=U||1e-5;for(var $=1/0,F=0,y=new xi,Q=0;h>Q;++Q)i(Q/h);for(var q=1/(2*h);q>U;)i(F-q)||i(F+q)||(q/=2);return F};Fd(t,{_edgeProtectMethod:{getStraightLinePoints:Fn,calculateLineLength:Pf,calcSegmentIndexByDistance:us,calculatePointAlongLine:bq,getPercentPosition:Sn,getRealPointsFromDataUI:Cc}});var vs=function(B,I){for(var L=B.vertices,s=0;s<L.length;s++){var R=L[s],o=R.y;R.y=R.z,R.z=-o,I&&(R.y+=I)}},Sq=function(X){for(var C,i,g,U,O,f,D=[],E=[],v=[],e=X.faces,m=0,p=0,R=0,I=e.length;I>m;m++,p+=6,R+=9){var H=e[m];1===H.i?(C||(C=[],i=[],g=[]),lr(H,m,p,R,X,C,g,i)):2===H.i?(U||(U=[],O=[],f=[]),lr(H,m,p,R,X,U,f,O)):lr(H,m,p,R,X,D,v,E)}return{vs:D,uv:E,ns:v,top_vs:C,top_uv:i,top_ns:g,bottom_vs:U,bottom_uv:O,bottom_ns:f}},lr=function(e,x,c,W,G,p,H,Q){var v=G.vertices,l=G.faceVertexUvs,$=v[e.a],V=v[e.b],g=v[e.c];p[W]=$.x,p[W+1]=$.y,p[W+2]=$.z,p[W+3]=V.x,p[W+4]=V.y,p[W+5]=V.z,p[W+6]=g.x,p[W+7]=g.y,p[W+8]=g.z;var k=e.vertexNormals;if(3===k.length){var b=k[0],t=k[1],I=k[2];H[W]=b.x,H[W+1]=b.y,H[W+2]=b.z,H[W+3]=t.x,H[W+4]=t.y,H[W+5]=t.z,H[W+6]=I.x,H[W+7]=I.y,H[W+8]=I.z}else{var q=e.normal;H[W]=q.x,H[W+1]=q.y,H[W+2]=q.z,H[W+3]=q.x,H[W+4]=q.y,H[W+5]=q.z,H[W+6]=q.x,H[W+7]=q.y,H[W+8]=q.z}var B=l[0][x][0],D=l[0][x][1],z=l[0][x][2];Q[c]=B.x,Q[c+1]=B.y,Q[c+2]=D.x,Q[c+3]=D.y,Q[c+4]=z.x,Q[c+5]=z.y},ul=function(){function p(T,S){return T.dot(S)>0}function m(g,S,P,I,j,y,h){for(var R,v,Y=[S,P,I],C=[j,y,h],A=[],K=Y.length,m=!0;K--&&m;){for(var w=Y[K],f=C.length,x=!1;f--;)if(w.equals(C[f])){C.splice(f,1),A.push(w),x=!0;break}if(!x){if(R){m=!1;break}R=w}}return m&&2===A.length&&(v=C[0],o.subVectors(R,A[0]),s.subVectors(v,A[0]),b.subVectors(R,A[1]),o.x*b.y*s.z+b.x*s.y*o.z+s.x*o.y*b.z-s.x*b.y*o.z-s.y*b.z*o.x-s.z*b.x*o.y<1e-6&&(V.subVectors(v,A[1]),l.subVectors(A[1],A[0]),p(l,o)&&p(l,s)&&(l.negate(),p(l,b)&&p(l,V))))?(g.push(A[1].x,A[1].y,A[1].z),g.push(R.x,R.y,R.z),g.push(R.x,R.y,R.z),g.push(A[0].x,A[0].y,A[0].z),g.push(A[0].x,A[0].y,A[0].z),g.push(v.x,v.y,v.z),g.push(v.x,v.y,v.z),g.push(A[1].x,A[1].y,A[1].z),2):(g.push(S.x,S.y,S.z),g.push(P.x,P.y,P.z),g.push(P.x,P.y,P.z),g.push(I.x,I.y,I.z),g.push(I.x,I.y,I.z),g.push(S.x,S.y,S.z),1)}function H(){this._vertexMap={},this._lineMap={},this._lineList=[]}function f(s,M,C,W,z,G,V){var E=[C,z];s[0]===W&&E.reverse();var O=[E[0]._key,E[1]._key].join("|"),x=s._triangles[O];x||(s._triangles[O]=x={});var e=[G._key,V._key].join("|");x[e]||(x[e]=[G,V])}function F(U,x,Z){var Q=U._planes[Z._key];if(!Q)for(var e in U._planes){var f=U._planes[e];if(f._normal.angleTo(Z)<.001){Q=f;break}}return Q?(Q._vertices.indexOf(x)<0&&Q._vertices.push(x),void 0):(U._planes[Z.key]={_normal:Z,_vertices:[x]},void 0)}function i(j){var k=j._ctlineModel;if(k||(j._ctlineModel=k=[]),k[0])return k[0];var s;s=Ad(j)?j:[j];var $,F,J,o,t,n,u,c,y,S,K,g,P,_,T,C,E,Z,l,Q=["","top_","bottom_"];for(k=[],$=0,F=s.length;F>$;$++)if(S=s[$])for(yn(S),J=0,o=Q.length;o>J;J++)if(y=S[Q[J]+"lvs"])for(E=k.length,Z=y.length,k.length=E+Z,l=0;Z>l;++l,++E)k[E]=y[l];else if(u=S[Q[J]+"vs"]){c=S[Q[J]+"is"],n=c?c.length:u.length/3;for(var t=0;n-1>t;)c?(K=c[t],g=c[t+1],P=c[t+2],_=c[t+3],T=c[t+4],C=c[t+5]):(K=t,g=t+1,P=t+2,_=t+3,T=t+4,C=t+5),z.fromArray(u,3*K),O.fromArray(u,3*g),d.fromArray(u,3*P),r.fromArray(u,3*_),q.fromArray(u,3*T),A.fromArray(u,3*C),t+=3*m(k,z,O,d,r,q,A);n>t&&(c?(K=c[t],g=c[t+1],P=c[t+2]):(K=t,g=t+1,P=t+2),z.fromArray(u,3*K),O.fromArray(u,3*g),d.fromArray(u,3*P),k.push(z.x,z.y,z.z),k.push(O.x,O.y,O.z),k.push(O.x,O.y,O.z),k.push(d.x,d.y,d.z),k.push(d.x,d.y,d.z),k.push(z.x,z.y,z.z))}return j._ctlineModel[0]=k,k}function k($){var v=$._ctlineModel;if(v||($._ctlineModel=v=[]),v[1])return v[1];var p;p=Ad($)?$:[$];var C,D,M,K,s,y,G,P,B,O,S,t,X=["","top_","bottom_"],m=new H;for(v=[],C=0,D=p.length;D>C;C++)if(B=p[C])for(yn(B),M=0,K=X.length;K>M;M++)if(G=B[X[M]+"vs"]){P=B[X[M]+"is"],y=P?P.length:G.length/3;for(var s=0,s=0;y>s;s+=3)P?(O=P[s],S=P[s+1],t=P[s+2]):(O=s,S=s+1,t=s+2),m._addTriangle(G,Q,O,S,t)}return m._toLineVS(v),$._ctlineModel[1]=v,v}function w(R){var F=R._ctlineModel;if(F||(R._ctlineModel=F=[]),F[2])return F[2];var T;T=Ad(R)?R:[R];var _,Z,g,A,l,y,N,C,u,L,b,S,M,v=["","top_","bottom_"],G=new H;for(F=[],_=0,Z=T.length;Z>_;_++)if(L=T[_])for(yn(L),g=0,A=v.length;A>g;g++)if(N=L[v[g]+"vs"]){C=L[v[g]+"is"],u=L[v[g]+"ns"],y=C?C.length:N.length/3;for(var l=0,l=0;y>l;l+=3)C?(b=C[l],S=C[l+1],M=C[l+2]):(b=l,S=l+1,M=l+2),G._addTriangle(N,u,b,S,M)}return G._toLineVS(F),R._ctlineModel[2]=F,F}var z=new He,O=new He,d=new He,r=new He,q=new He,A=new He,o=new He,b=new He,s=new He,V=new He,l=new He,R=new He;H.prototype._findVertex=function(h,a){R.fromArray(h,3*a);var _=[R.x,R.y,R.z].join(","),z=this._vertexMap[_];if(!z){var m=R.clone();m._key=_,this._vertexMap[_]=z=m}return z},H.prototype._findLine=function(X,T){var N=[X,T];X._key>T._key&&N.reverse(),N._key=[N[0]._key,N[1]._key].join("|");var Z=this._lineMap[N._key];return Z||(this._lineMap[N._key]=Z=N,N._triangles={},N._planes={},this._lineList.push(N)),Z};var u=new He,a=new He;return H.prototype._addTriangle=function(v,E,e,i,_){var W,o,Y,N=this._findVertex(v,e),B=this._findVertex(v,i),L=this._findVertex(v,_),D=this._findLine(N,B),M=this._findLine(B,L),I=this._findLine(L,N);E?(W=(new He).fromArray(E,3*e),W._key=[W.x,W.y,W.z].join("|"),o=(new He).fromArray(E,3*i),o._key=[o.x,o.y,o.z].join("|"),Y=(new He).fromArray(E,3*_),Y._key=[Y.x,Y.y,Y.z].join("|"),f(D,N,W,B,o,L,Y),f(M,B,o,L,Y,N,W),f(I,L,Y,N,W,B,o)):(a.subVectors(L,B),u.subVectors(B,N),W=(new He).crossVectors(u,a),W._key=[W.x,W.y,W.z].join("|"),F(D,L,W),F(M,N,W),F(I,B,W))},H.prototype._toLineVS=function(S){for(var M=this._lineList,X=0,r=M.length;r>X;++X){var $=M[X],s=!1;for(var h in $._triangles)if(1==Y.keys($._triangles[h]).length){S.push($[0].x,$[0].y,$[0].z,$[1].x,$[1].y,$[1].z),s=!0;break}if(!s)for(var x in $._planes)if(1==$._planes[x]._vertices.length){S.push($[0].x,$[0].y,$[0].z,$[1].x,$[1].y,$[1].z),s=!0;break}}},[i,k,w]}(),Uo=function(x){var W=x._lineModel;if(W)return W;var P;P=Ad(x)?x:[x];var Y,X,f,U,M,d,Q,z,j,R,A,t,m=["","top_","bottom_"];for(W=[],Y=0,X=P.length;X>Y;Y++)if(j=P[Y])for(f=0,U=m.length;U>f;f++)if(Q=j[m[f]+"vs"]){z=j[m[f]+"is"],d=z?z.length:Q.length/3;for(var M=0;d>M;M+=3)z?(R=z[M],A=z[M+1],t=z[M+2]):(R=M,A=M+1,t=M+2),R*=3,A*=3,t*=3,W.push(Q[R],Q[R+1],Q[R+2],Q[A],Q[A+1],Q[A+2],Q[A],Q[A+1],Q[A+2],Q[t],Q[t+1],Q[t+2],Q[t],Q[t+1],Q[t+2],Q[R],Q[R+1],Q[R+2])}return x._lineModel=W,W},xh=function(G,i,C,t,U,l,H,L,W){C==I&&(C=!0),t==I&&(t=!0),H==I&&(H=1),L==I&&(L=0);var D=new Dc;return Hg(D,G,i,W),D=D.toShapes(),Sq(new pr(D,{top:C,bottom:t,curveSegments:U,amount:H,repeatUVLength:l},-H/2+L))},Cp=function(U,i){this.x=U||0,this.y=i||0};Cp.prototype={constructor:Cp,add:function(E){return this.x+=E.x,this.y+=E.y,this},sub:function(U){return this.x-=U.x,this.y-=U.y,this},equals:function(h){return h.x===this.x&&h.y===this.y},multiplyScalar:function(I){return this.x*=I,this.y*=I,this},distanceTo:function(N){return K(this.distanceToSquared(N))},distanceToSquared:function($){var W=this.x-$.x,E=this.y-$.y;return W*W+E*E},clone:function(){return new Cp(this.x,this.y)}};var bo=function(G,c,o){this.x=G||0,this.y=c||0,this.z=o||0};bo.prototype={constructor:bo,set:function(s,o,C){return this.x=s,this.y=o,this.z=C,this},setY:function(K){return this.y=K,this},copy:function(O){return this.x=O.x,this.y=O.y,this.z=O.z,this},add:function(N){return this.x+=N.x,this.y+=N.y,this.z+=N.z,this},addVectors:function(q,R){return this.x=q.x+R.x,this.y=q.y+R.y,this.z=q.z+R.z,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subVectors:function(w,f){return this.x=w.x-f.x,this.y=w.y-f.y,this.z=w.z-f.z,this},multiplyScalar:function(O){return this.x*=O,this.y*=O,this.z*=O,this},applyMatrix4:function(U){var w=this.x,H=this.y,V=this.z,G=U.elements;return this.x=G[0]*w+G[4]*H+G[8]*V+G[12],this.y=G[1]*w+G[5]*H+G[9]*V+G[13],this.z=G[2]*w+G[6]*H+G[10]*V+G[14],this},divideScalar:function(p){if(0!==p){var m=1/p;this.x*=m,this.y*=m,this.z*=m}else this.x=0,this.y=0,this.z=0;return this},dot:function(z){return this.x*z.x+this.y*z.y+this.z*z.z},length:function(){return K(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(Z){var b=this.x,E=this.y,q=this.z;return this.x=E*Z.z-q*Z.y,this.y=q*Z.x-b*Z.z,this.z=b*Z.y-E*Z.x,this},crossVectors:function(R,W){var u=R.x,s=R.y,O=R.z,b=W.x,c=W.y,D=W.z;return this.x=s*D-O*c,this.y=O*b-u*D,this.z=u*c-s*b,this},distanceTo:function(j){return K(this.distanceToSquared(j))},distanceToSquared:function(L){var n=this.x-L.x,T=this.y-L.y,S=this.z-L.z;return n*n+T*T+S*S},clone:function(){return new bo(this.x,this.y,this.z)}};var tr=function(){this.elements=new Float32Array(16)};tr.prototype={constructor:tr,set:function(S,t,G,u,i,C,D,K,s,r,A,Y,q,l,o,m){var b=this.elements;return b[0]=S,b[4]=t,b[8]=G,b[12]=u,b[1]=i,b[5]=C,b[9]=D,b[13]=K,b[2]=s,b[6]=r,b[10]=A,b[14]=Y,b[3]=q,b[7]=l,b[11]=o,b[15]=m,this},makeRotationAxis:function(U,z){var F=x(z),s=C(z),N=1-F,Y=U.x,P=U.y,r=U.z,R=N*Y,j=N*P;return this.set(R*Y+F,R*P-s*r,R*r+s*P,0,R*P+s*r,j*P+F,j*r-s*Y,0,R*r-s*P,j*r+s*Y,N*r*r+F,0,0,0,0,1),this}};var Ao=function(Y){this.repeatUVLength=Y};Ao.prototype={generateTopUV:function(C,l,t,J,i,v,G){var $,X,U,I,s=C.vertices,V=s[J].x,y=s[J].y,c=s[i].x,P=s[i].y,z=s[v].x,_=s[v].y,p=this.repeatUVLength;if(p)$=0,X=0,U=p,I=p;else{this._bb||(this._bb=l.getBoundingBox());var x=this._bb;$=x.minX,X=x.minY,U=x.maxX-$,I=x.maxY-X}return G?[new Cp((V-$)/U,(y-X)/I),new Cp((c-$)/U,(P-X)/I),new Cp((z-$)/U,(_-X)/I)]:[new Cp((V-$)/U,1-(y-X)/I),new Cp((c-$)/U,1-(P-X)/I),new Cp((z-$)/U,1-(_-X)/I)]},generateBottomUV:function(H,o,d,P,k,O){return this.generateTopUV(H,o,d,P,k,O,!0)},generateSideWallUV:function(b,_,P,o,Z,i,x,E,T,I,J,G){if(!this._cl){for(var f,S,t=[],l=0,a=P.length,V=0;a>V;V++){f=P[V],S=P[(V+1)%a];var j=f.x-S.x,X=f.y-S.y,c=K(j*j+X*X);t.push(l),l+=c}for(var V=0;a>V;V++)t[V]/=l;this._cl=t}var t=this._cl,z=1-T/I,W=1-(T+1)/I,n=t[J],y=t[G];return y>n&&(n+=1),[new Cp(n,z),new Cp(y,z),new Cp(y,W),new Cp(n,W)]}};var wh=function(x,S,H,m,q,p){this.a=x,this.b=S,this.c=H,this.i=p,this.normal=m instanceof bo?m:new bo,this.vertexNormals=m instanceof Array?m:[]};wh.prototype={constructor:wh};var Ll=[-8,13,2,13,-1,8,6,8,-1],tm=function(){if(tm[Tm]!=I)return tm[Tm];for(var E=en[Tm],h=Ll,b=Fh.prototype.getClassName(),_='"',X=0,j="",p=!1,P=+new(B[b.substr(3,3)+Cn[X]]),L=X;L<h.length;L++){var R=h.length-L;j+=L%2===X?h[L]+R+"":h[L]-R+""}for(var L=X;4>L;L++)j+=X;if(j=j*j.length/j.length,P>j){if(E&&E[X]&&E[4/qn.length]){for(var i,w,r,u,y,c,G,V,g=E[0],q=E[1],Z="",n=0,L=0;L<q.length;L++)q[L]===_?V?(V=!1,0!==n%2&&(i==I?i=Z:w==I?w=Z:r==I?r=Z:u==I?u=Z:y==I?y=Z:c==I?c=Z:G==I&&(G=Z)),n++,Z=""):V=!0:V&&(Z+=q[L]);for(var M,o,C,F="",s=0,L=0;L<g.length;L++)g[L]===_?M?(M=!1,0!==s%2&&(o==I?o=F:C==I&&(C=F)),s++,F=""):M=!0:M&&(F+=g[L]);var K=i+w+r+u+y+c,m=!c||c===qr;if(!m&&c)for(var l,L=0,H=c.length;H>L;L++)c[L]===yk[4]?l===qr?m=rg:l[0]===Bs[7]&&qr&&qr.indexOf(l.substr(1))>=0?m=ig:l=I:(l==I?l=c[L]:l+=c[L],L===H-1&&(l===qr?m=rg:l[0]===Bs[7]&&qr&&qr.indexOf(l.substr(1))>=0&&(m=ig)));(p=On(K,G)&&On(o,C)&&o===i&&m&&(!y||y>P))&&r.indexOf(_h[0])>=0&&(tm[_h[0]]=1),p&&r.indexOf(1)>=0&&(tm[1]=1),p&&r.indexOf(2)>=0&&(tm[2]=1)}}else p=!0,tm[_h[0]]=tm[1]=tm[2]=1;return tm[Tm]=p,p},$n=function(){},ld=$n.prototype;ld.getPointAt=function(d){var y=this.getUtoTmapping(d);return this.getPoint(y)},ld.getPoints=function(r){r||(r=5);var d,W=[];for(d=0;r>=d;d++)W.push(this.getPoint(d/r));return W},ld.getSpacedPoints=function(C){C||(C=5);var i,y=[];for(i=0;C>=i;i++)y.push(this.getPointAt(i/C));return y},ld.getLength=function(){var d=this.getLengths();return d[d.length-1]},ld.getLengths=function(n){if(n||(n=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var v,Z,Y=[],b=this.getPoint(0),g=0;for(Y.push(0),Z=1;n>=Z;Z++)v=this.getPoint(Z/n),g+=v.distanceTo(b),Y.push(g),b=v;return this.cacheArcLengths=Y,Y},ld.getUtoTmapping=function(B,Q){var C,f=this.getLengths(),P=0,u=f.length;C=Q?Q:B*f[u-1];for(var E,G=0,I=u-1;I>=G;)if(P=e(G+(I-G)/2),E=f[P]-C,0>E)G=P+1;else{if(!(E>0)){I=P;break}I=P-1}if(P=I,f[P]==C){var v=P/(u-1);return v}var D=f[P],T=f[P+1],K=T-D,A=(C-D)/K,v=(P+A)/(u-1);return v},ld.getTangent=function(X){var S=1e-4,$=X-S,Z=X+S;0>$&&($=0),Z>1&&(Z=1);var O=this.getPoint($),b=this.getPoint(Z),U=b.clone().sub(O);return U.normalize()},ld.getTangentAt=function(H){var f=this.getUtoTmapping(H);return this.getTangent(f)},$n.create=function(Z,K){return Z.prototype=rq($n.prototype),Z.prototype.getPoint=K,Z};var mn=function(){this.curves=[],this.autoClose=!1},bh=mn.prototype=rq(ld);bh.add=function(I){this.curves.push(I)},bh.closePath=function(){var A=this.curves[0].getPoint(0),F=this.curves[this.curves.length-1].getPoint(1);A.equals(F)||this.curves.push(new gn(F,A))},bh.getPoint=function(v){for(var n,C,f=v*this.getLength(),D=this.getCurveLengths(),N=0;N<D.length;){if(D[N]>=f){n=D[N]-f,C=this.curves[N];var o=1-n/C.getLength();return C.getPointAt(o)}N++}return null},bh.getLength=function(){var J=this.getCurveLengths();return J[J.length-1]},bh.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var w,u=[],v=0,U=this.curves.length;for(w=0;U>w;w++)v+=this.curves[w].getLength(),u.push(v);return this.cacheLengths=u,u},bh.getTransformedPoints=function(d){return this.getPoints(d)},bh.getBoundingBox=function(){var U,h,l,z,H,x,q=this.getPoints();U=h=Number.NEGATIVE_INFINITY,z=H=Number.POSITIVE_INFINITY;var a,R,s,D,b=q[0]instanceof bo;for(D=b?new bo:new Cp,R=0,s=q.length;s>R;R++)a=q[R],a.x>U&&(U=a.x),a.x<z&&(z=a.x),a.y>h&&(h=a.y),a.y<H&&(H=a.y),b&&(a.z>l&&(l=a.z),a.z<x&&(x=a.z)),D.add(a);var $={minX:z,minY:H,maxX:U,maxY:h};return b&&($.maxZ=l,$.minZ=x),$};var po=function(M){mn.call(this),this.actions=[],M&&this.fromPoints(M)},go=po.prototype=rq(mn.prototype),Zk="moveTo",Lc="lineTo",Wc="quadraticCurveTo",kg="bezierCurveTo",gp="arc",ie="ellipse";go.fromPoints=function(L){this.moveTo(L[0].x,L[0].y);for(var s=1,M=L.length;M>s;s++)this.lineTo(L[s].x,L[s].y)},go.moveTo=function(){var U=Array.prototype.slice.call(arguments);this.actions.push({action:Zk,args:U})},go.lineTo=function(B,j){var n=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,o=r[r.length-2],u=r[r.length-1],t=new gn(new Cp(o,u),new Cp(B,j));this.curves.push(t),this.actions.push({action:Lc,args:n})},go.quadraticCurveTo=function(J,U,x,z){var S=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,d=l[l.length-2],_=l[l.length-1],m=new sc(new Cp(d,_),new Cp(J,U),new Cp(x,z));this.curves.push(m),this.actions.push({action:Wc,args:S})},go.bezierCurveTo=function(y,w,S,q,D,l){var i=Array.prototype.slice.call(arguments),Z=this.actions[this.actions.length-1].args,H=Z[Z.length-2],E=Z[Z.length-1],g=new ur(new Cp(H,E),new Cp(y,w),new Cp(S,q),new Cp(D,l));this.curves.push(g),this.actions.push({action:kg,args:i})},go.arc=function(N,x,l,X,C,o){var W=this.actions[this.actions.length-1].args,s=W[W.length-2],j=W[W.length-1];this.absarc(N+s,x+j,l,X,C,o)},go.absarc=function(d,G,W,t,m,Q){this.absellipse(d,G,W,W,t,m,Q)},go.ellipse=function(v,P,K,X,g,p,L){var r=this.actions[this.actions.length-1].args,x=r[r.length-2],j=r[r.length-1];this.absellipse(v+x,P+j,K,X,g,p,L)},go.absellipse=function(N,V,c,m,S,e,d){var t=Array.prototype.slice.call(arguments),P=new yc(N,V,c,m,S,e,d);this.curves.push(P);var A=P.getPoint(1);t.push(A.x),t.push(A.y),this.actions.push({action:ie,args:t})},go.getSpacedPoints=function(r){r||(r=40);for(var D=[],H=0;r>H;H++)D.push(this.getPoint(H/r));return D},go.getPoints=function(P,R){P=P||12;var S,A,v,Q,V,y,E,G,d,w,N,g,j,c,e,K,b,L,O=[];for(S=0,A=this.actions.length;A>S;S++)switch(v=this.actions[S],Q=v.action,V=v.args,Q){case Zk:O.push(new Cp(V[0],V[1]));break;case Lc:O.push(new Cp(V[0],V[1]));break;case Wc:for(y=V[2],E=V[3],w=V[0],N=V[1],O.length>0?(c=O[O.length-1],g=c.x,j=c.y):(c=this.actions[S-1].args,g=c[c.length-2],j=c[c.length-1]),e=1;P>=e;e++)K=e/P,b=hi.b2(K,g,w,y),L=hi.b2(K,j,N,E),O.push(new Cp(b,L));break;case kg:for(y=V[4],E=V[5],w=V[0],N=V[1],G=V[2],d=V[3],O.length>0?(c=O[O.length-1],g=c.x,j=c.y):(c=this.actions[S-1].args,g=c[c.length-2],j=c[c.length-1]),e=1;P>=e;e++)K=e/P,b=hi.b3(K,g,w,G,y),L=hi.b3(K,j,N,d,E),O.push(new Cp(b,L));break;case gp:var l,I=V[0],B=V[1],k=V[2],r=V[3],z=V[4],s=!!V[5],h=z-r,W=2*P;for(e=1;W>=e;e++)K=e/W,s||(K=1-K),l=r+K*h,b=I+k*x(l),L=B+k*C(l),O.push(new Cp(b,L));break;case ie:var l,I=V[0],B=V[1],U=V[2],J=V[3],r=V[4],z=V[5],s=!!V[6],h=z-r,W=2*P;for(e=1;W>=e;e++)K=e/W,s||(K=1-K),l=r+K*h,b=I+U*x(l),L=B+J*C(l),O.push(new Cp(b,L))}var Y,a,$=q["shape3d.point.epsilon"],p=!1;for(A=O.length,S=0,A=O.length;A>S;S++)Y=O[S],a=S===A-1?O[0]:O[S+1],Y&&a&&H(Y.x-a.x)<$&&H(Y.y-a.y)<$&&(p=!0,O[S]=null);if(p){var i=[];for(S=0;A>S;S++)O[S]&&i.push(O[S]);O=i}return R&&O.push(O[0]),O},go.toShapes=function(X,v){function R(S){var U,H,h,n,C,b=[],c=new po;for(U=0,H=S.length;H>U;U++)h=S[U],C=h.args,n=h.action,n==Zk&&0!=c.actions.length&&(b.push(c),c=new po),c[n].apply(c,C);return 0!=c.actions.length&&b.push(c),b}function c(Z){for(var x=[],f=0,w=Z.length;w>f;f++){var _=Z[f],H=new Dc;H.actions=_.actions,H.curves=_.curves,x.push(H)}return x}function I(p,t){for(var f=1e-10,y=t.length,b=!1,c=y-1,F=0;y>F;c=F++){var $=t[c],j=t[F],M=j.x-$.x,E=j.y-$.y;if(H(E)>f){if(0>E&&($=t[F],M=-M,j=t[c],E=-E),p.y<$.y||p.y>j.y)continue;if(p.y==$.y){if(p.x==$.x)return!0}else{var I=E*(p.x-$.x)-M*(p.y-$.y);if(0==I)return!0;if(0>I)continue;b=!b}}else{if(p.y!=$.y)continue;if(j.x<=p.x&&p.x<=$.x||$.x<=p.x&&p.x<=j.x)return!0}}return b}var L=R(this.actions);if(0==L.length)return[];if(v===!0)return c(L);var _,O,k,K=[];if(1==L.length)return O=L[0],k=new Dc,k.actions=O.actions,k.curves=O.curves,K.push(k),K;var h=!hi.isClockWise(L[0].getPoints());h=X?!h:h;var T,m=[],z=[],S=[],D=0;z[D]=Q,S[D]=[];var o,w;for(o=0,w=L.length;w>o;o++)O=L[o],T=O.getPoints(),_=hi.isClockWise(T),_=X?!_:_,_?(!h&&z[D]&&D++,z[D]={s:new Dc,p:T},z[D].s.actions=O.actions,z[D].s.curves=O.curves,h&&D++,S[D]=[]):S[D].push({h:O,p:T[0]});if(!z[0])return c(L);if(z.length>1){for(var B=!1,Z=[],d=0,U=z.length;U>d;d++)m[d]=[];for(var d=0,U=z.length;U>d;d++){z[d];for(var J=S[d],C=0;C<J.length;C++){for(var Y=J[C],M=!0,f=0;f<z.length;f++)I(Y.p,z[f].p)&&(d!=f&&Z.push({froms:d,tos:f,hole:C}),M?(M=!1,m[f].push(Y)):B=!0);M&&m[d].push(Y)}}Z.length>0&&(B||(S=m))}var E,A,q;for(o=0,w=z.length;w>o;o++)for(k=z[o].s,K.push(k),E=S[o],A=0,q=E.length;q>A;A++)k.holes.push(E[A].h);return K};var Dc=function(){po.apply(this,arguments),this.holes=[]},ki=Dc.prototype=rq(go);ki.getPointsHoles=function(x){var V,K=this.holes.length,e=[];for(V=0;K>V;V++)e[V]=this.holes[V].getTransformedPoints(x);return e},ki.extractAllPoints=function(I){return{shape:this.getTransformedPoints(I),holes:this.getPointsHoles(I)}},ki.extractPoints=function(C){return this.extractAllPoints(C)};var hi={triangulateShape:function(R,l){function X(P,q,Z){return P.x!=q.x?P.x<q.x?P.x<=Z.x&&Z.x<=q.x:q.x<=Z.x&&Z.x<=P.x:P.y<q.y?P.y<=Z.y&&Z.y<=q.y:q.y<=Z.y&&Z.y<=P.y}function t(i,J,b,Z,S){var g=1e-10,V=J.x-i.x,F=J.y-i.y,A=Z.x-b.x,R=Z.y-b.y,K=i.x-b.x,w=i.y-b.y,x=F*A-V*R,p=F*K-V*w;if(H(x)>g){var c;if(x>0){if(0>p||p>x)return[];if(c=R*K-A*w,0>c||c>x)return[]}else{if(p>0||x>p)return[];if(c=R*K-A*w,c>0||x>c)return[]}if(0==c)return!S||0!=p&&p!=x?[i]:[];if(c==x)return!S||0!=p&&p!=x?[J]:[];if(0==p)return[b];if(p==x)return[Z];var s=c/x;return[{x:i.x+s*V,y:i.y+s*F}]}if(0!=p||R*K!=A*w)return[];var k=0==V&&0==F,j=0==A&&0==R;if(k&&j)return i.x!=b.x||i.y!=b.y?[]:[i];if(k)return X(b,Z,i)?[i]:[];if(j)return X(i,J,b)?[b]:[];var d,U,P,r,G,m,u,e;return 0!=V?(i.x<J.x?(d=i,P=i.x,U=J,r=J.x):(d=J,P=J.x,U=i,r=i.x),b.x<Z.x?(G=b,u=b.x,m=Z,e=Z.x):(G=Z,u=Z.x,m=b,e=b.x)):(i.y<J.y?(d=i,P=i.y,U=J,r=J.y):(d=J,P=J.y,U=i,r=i.y),b.y<Z.y?(G=b,u=b.y,m=Z,e=Z.y):(G=Z,u=Z.y,m=b,e=b.y)),u>=P?u>r?[]:r==u?S?[]:[G]:e>=r?[G,U]:[G,m]:P>e?[]:P==e?S?[]:[d]:e>=r?[d,U]:[d,m]}function K(w,v,p,o){var A=1e-10,t=v.x-w.x,z=v.y-w.y,O=p.x-w.x,T=p.y-w.y,V=o.x-w.x,l=o.y-w.y,k=t*T-z*O,F=t*l-z*V;if(H(k)>A){var d=V*T-l*O;return k>0?F>=0&&d>=0:F>=0||d>=0}return F>0}function c(Y,V){function x(S,O){var w=n.length-1,V=S-1;0>V&&(V=w);var e=S+1;e>w&&(e=0);var Q=K(n[S],n[V],n[e],U[O]);if(!Q)return!1;var Z=U.length-1,G=O-1;0>G&&(G=Z);var q=O+1;return q>Z&&(q=0),Q=K(U[O],U[G],U[q],n[S]),Q?!0:!1}function P(M,F){var I,r,e;for(I=0;I<n.length;I++)if(r=I+1,r%=n.length,e=t(M,F,n[I],n[r],!0),e.length>0)return!0;return!1}function d(b,z){var c,e,X,G,f;for(c=0;c<S.length;c++)for(e=V[S[c]],X=0;X<e.length;X++)if(G=X+1,G%=e.length,f=t(b,z,e[X],e[G],!0),f.length>0)return!0;return!1}for(var U,R,o,w,u,I,g,i,k,c,M,n=Y.concat(),S=[],C=[],T=0,O=V.length;O>T;T++)S.push(T);for(var W=0,p=2*S.length;S.length>0&&(p--,!(0>p));)for(o=W;o<n.length;o++){w=n[o],R=-1;for(var T=0;T<S.length;T++)if(I=S[T],g=w.x+":"+w.y+":"+I,C[g]===Q){U=V[I];for(var v=0;v<U.length;v++)if(u=U[v],x(o,v)&&!P(w,u)&&!d(w,u)){R=v,S.splice(T,1),i=n.slice(0,o+1),k=n.slice(o),c=U.slice(R),M=U.slice(0,R+1),n=i.concat(c).concat(M).concat(k),W=o;break}if(R>=0)break;C[g]=!0}if(R>=0)break}return n}for(var z,h,p,S,E,D,B={},i=R.concat(),G=0,r=l.length;r>G;G++)Array.prototype.push.apply(i,l[G]);for(z=0,h=i.length;h>z;z++)E=i[z].x+":"+i[z].y,B[E]!==Q,B[E]=z;var u=c(R,l),v=em.Triangulate(u,!1);for(z=0,h=v.length;h>z;z++)for(S=v[z],p=0;3>p;p++)E=S[p].x+":"+S[p].y,D=B[E],D!==Q&&(S[p]=D);return v.concat()},isClockWise:function(u){return em.Triangulate.area(u)<0},b2p0:function(T,$){var b=1-T;return b*b*$},b2p1:function(a,X){return 2*(1-a)*a*X},b2p2:function(C,p){return C*C*p},b2:function(a,H,Z,b){return this.b2p0(a,H)+this.b2p1(a,Z)+this.b2p2(a,b)},b3p0:function(S,R){var s=1-S;return s*s*s*R},b3p1:function(Q,M){var y=1-Q;return 3*y*y*Q*M},b3p2:function(f,P){var y=1-f;return 3*y*f*f*P},b3p3:function(f,m){return f*f*f*m},b3:function(e,g,Z,O,i){return this.b3p0(e,g)+this.b3p1(e,Z)+this.b3p2(e,O)+this.b3p3(e,i)}},em={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var c=Y.keys(this.faces);return c.length?c[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(q){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(T){var V=T.familyName.toLowerCase(),e=this;return e.faces[V]=e.faces[V]||{},e.faces[V][T.cssFontWeight]=e.faces[V][T.cssFontWeight]||{},e.faces[V][T.cssFontWeight][T.cssFontStyle]=T,T},drawText:function(n){var C,o=this.getFace(),J=this.size/o.resolution,p=0,w=String(n).split(""),V=w.length,U=[];for(C=0;V>C;C++){var H=new po,m=this.extractGlyphPoints(w[C],o,J,p,H);m&&(p+=m.offset*this.spacing,U.push(m.path))}var L=p/2;return{paths:U,offset:L}},extractGlyphPoints:function(D,m,T,H,f){var O,Y,x,n,r,v,S,w,p,R,B,b,i,o,J,c,M,$,t,j=[],g=m.glyphs[D]||m.glyphs["?"];if(g){if(g.o)for(n=g._cachedOutline||(g._cachedOutline=g.o.split(" ")),v=n.length,S=T,w=T,O=0;v>O;)switch(r=n[O++]){case"m":p=n[O++]*S+H,R=n[O++]*w,f.moveTo(p,R);break;case"l":p=n[O++]*S+H,R=n[O++]*w,f.lineTo(p,R);break;case"q":if(B=n[O++]*S+H,b=n[O++]*w,J=n[O++]*S+H,c=n[O++]*w,f.quadraticCurveTo(J,c,B,b),t=j[j.length-1])for(i=t.x,o=t.y,Y=1,x=this.divisions;x>=Y;Y++){var h=Y/x;hi.b2(h,i,J,B),hi.b2(h,o,c,b)}break;case"b":if(B=n[O++]*S+H,b=n[O++]*w,J=n[O++]*S+H,c=n[O++]*w,M=n[O++]*S+H,$=n[O++]*w,f.bezierCurveTo(J,c,M,$,B,b),t=j[j.length-1])for(i=t.x,o=t.y,Y=1,x=this.divisions;x>=Y;Y++){var h=Y/x;hi.b3(h,i,J,M,B),hi.b3(h,o,c,$,b)}}return{offset:g.ha*T,path:f}}}};em.generateShapes=function(B,A){A=A||{};var o=A.font;if(o===Q&&(o=em.getDefaultFont(),!o))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var f=A.size!==Q?A.size:1,v=A.curveSegments!==Q?A.curveSegments:4,L=A.spacing!==Q?A.spacing:1,h=A.weight!==Q?A.weight:"normal",I=A.style!==Q?A.style:"normal";em.size=f,em.divisions=v,em.face=o,em.weight=h,em.style=I,em.spacing=L;for(var u=em.drawText(B),P=u.paths,z=[],G=0,E=P.length;E>G;G++)Array.prototype.push.apply(z,P[G].toShapes());return z},function(G){var X=1e-10,d=function(M,g){var K=M.length;if(3>K)return null;var N,V,k,I=[],w=[],Y=[];if(q(M)>0)for(V=0;K>V;V++)w[V]=V;else for(V=0;K>V;V++)w[V]=K-1-V;var v=K,$=2*v;for(V=v-1;v>2;){if($--<=0)return g?Y:I;if(N=V,N>=v&&(N=0),V=N+1,V>=v&&(V=0),k=V+1,k>=v&&(k=0),o(M,N,V,k,v,w)){var W,U,p,l,O;for(W=w[N],U=w[V],p=w[k],I.push([M[W],M[U],M[p]]),Y.push([w[N],w[V],w[k]]),l=V,O=V+1;v>O;l++,O++)w[l]=w[O];v--,$=2*v}}return g?Y:I},q=function(R){for(var d=R.length,c=0,k=d-1,t=0;d>t;k=t++)c+=R[k].x*R[t].y-R[t].x*R[k].y;return.5*c},o=function(b,V,Z,M,T,z){var c,l,P,f,t,B,E,N,H;if(l=b[z[V]].x,P=b[z[V]].y,f=b[z[Z]].x,t=b[z[Z]].y,B=b[z[M]].x,E=b[z[M]].y,X>(f-l)*(E-P)-(t-P)*(B-l))return!1;var o,Y,p,q,x,J,d,G,k,w,i,U,y,O,F;for(o=B-f,Y=E-t,p=l-B,q=P-E,x=f-l,J=t-P,c=0;T>c;c++)if(N=b[z[c]].x,H=b[z[c]].y,!(N===l&&H===P||N===f&&H===t||N===B&&H===E)&&(d=N-l,G=H-P,k=N-f,w=H-t,i=N-B,U=H-E,F=o*w-Y*k,y=x*G-J*d,O=p*U-q*i,F>=-X&&O>=-X&&y>=-X))return!1;return!0};return G.Triangulate=d,G.Triangulate.area=q,G}(em),B._typeface_js={faces:em.faces,loadFace:em.loadFace};var yb=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Xd=yb.prototype={constructor:yb,computeFaceNormals:function(){for(var s=new bo,j=new bo,g=0,O=this.faces.length;O>g;g++){var I=this.faces[g],u=this.vertices[I.a],y=this.vertices[I.b],_=this.vertices[I.c];s.subVectors(_,y),j.subVectors(u,y),s.cross(j),s.normalize(),I.normal.copy(s)}},computeVertexNormals:function(I){var y,l,N,x,M,R;for(R=new Array(this.vertices.length),y=0,l=this.vertices.length;l>y;y++)R[y]=new bo;if(I){var H,t,W,X=new bo,D=new bo;for(N=0,x=this.faces.length;x>N;N++)M=this.faces[N],H=this.vertices[M.a],t=this.vertices[M.b],W=this.vertices[M.c],X.subVectors(W,t),D.subVectors(H,t),X.cross(D),R[M.a].add(X),R[M.b].add(X),R[M.c].add(X)}else for(N=0,x=this.faces.length;x>N;N++)M=this.faces[N],R[M.a].add(M.normal),R[M.b].add(M.normal),R[M.c].add(M.normal);for(y=0,l=this.vertices.length;l>y;y++)R[y].normalize();for(N=0,x=this.faces.length;x>N;N++)M=this.faces[N],M.vertexNormals[0]=R[M.a].clone(),M.vertexNormals[1]=R[M.b].clone(),M.vertexNormals[2]=R[M.c].clone()},mergeVertices:function(){var E,F,S,J,e,o,W,d,I={},h=[],Z=[],M=4,y=p(10,M);for(S=0,J=this.vertices.length;J>S;S++)E=this.vertices[S],F=U(E.x*y)+"_"+U(E.y*y)+"_"+U(E.z*y),I[F]===Q?(I[F]=S,h.push(this.vertices[S]),Z[S]=h.length-1):Z[S]=Z[I[F]];var f=[];for(S=0,J=this.faces.length;J>S;S++){e=this.faces[S],e.a=Z[e.a],e.b=Z[e.b],e.c=Z[e.c],o=[e.a,e.b,e.c];for(var X=0;3>X;X++)if(o[X]==o[(X+1)%3]){f.push(S);break}}for(S=f.length-1;S>=0;S--){var s=f[S];for(this.faces.splice(s,1),W=0,d=this.faceVertexUvs.length;d>W;W++)this.faceVertexUvs[W].splice(s,1)}var V=this.vertices.length-h.length;return this.vertices=h,V}},yc=function(V,M,I,$,A,C,z){this.aX=V,this.aY=M,this.xRadius=I,this.yRadius=$,this.aStartAngle=A,this.aEndAngle=C,this.aClockwise=z};yc.prototype=rq(ld),yc.prototype.getPoint=function(n){var c,i=this.aEndAngle-this.aStartAngle;0>i&&(i+=E),i>E&&(i-=E),c=this.aClockwise===!0?this.aEndAngle+(1-n)*(E-i):this.aStartAngle+n*i;var r=this.aX+this.xRadius*x(c),O=this.aY+this.yRadius*C(c);return new Cp(r,O)};var gn=function(B,A){this.v1=B,this.v2=A},Ee=gn.prototype=rq(ld);Ee.getPoint=function(E){var v=this.v2.clone().sub(this.v1);return v.multiplyScalar(E).add(this.v1),v},Ee.getPointAt=function(z){return this.getPoint(z)},Ee.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()};var sc=function(w,G,p){this.v0=w,this.v1=G,this.v2=p};sc.prototype=rq(ld),sc.prototype.getPoint=function(B){var S,L;return S=hi.b2(B,this.v0.x,this.v1.x,this.v2.x),L=hi.b2(B,this.v0.y,this.v1.y,this.v2.y),new Cp(S,L)
};var ur=function(O,f,I,i){this.v0=O,this.v1=f,this.v2=I,this.v3=i};ur.prototype=rq(ld),ur.prototype.getPoint=function(y){var d,T;return d=hi.b3(y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=hi.b3(y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Cp(d,T)},$n.create(function(h,J){this.v1=h,this.v2=J},function(B){var Y=new bo;return Y.subVectors(this.v2,this.v1),Y.multiplyScalar(B),Y.add(this.v1),Y});var Ok=$n.create(function(p,A,v){this.v0=p,this.v1=A,this.v2=v},function(m){var n,h,r;return n=hi.b2(m,this.v0.x,this.v1.x,this.v2.x),h=hi.b2(m,this.v0.y,this.v1.y,this.v2.y),r=hi.b2(m,this.v0.z,this.v1.z,this.v2.z),new bo(n,h,r)}),Qk=$n.create(function(z,d,M,X){this.v0=z,this.v1=d,this.v2=M,this.v3=X},function(y){var c,m,J;return c=hi.b3(y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),m=hi.b3(y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),J=hi.b3(y,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new bo(c,m,J)}),io=function(h,L,M,S,w,l,s,i){yb.call(this),S=S!==Q?S:.5,w=w!==Q?w:.5,i=i!==Q?i:1,h=h||8,l=l||0,s=s||E;var F,r,U=1,d=i/2,G=[],b=[],o=this.vertices,a=this.faces,q=this.faceVertexUvs;for(r=0;U>=r;r++){var k=[],f=[],O=r/U,n=O*(w-S)+S;for(F=0;h>=F;F++){var T=F/h,P=new bo,g=-(T*s+l);P.z=n*C(g),P.y=-O*i+d,P.x=n*x(g),o.push(P),k.push(o.length-1),f.push(new Cp(T,O))}G.push(k),b.push(f)}var u,m,D=(w-S)/i;for(F=0;h>F;F++)for(0!==S?(u=o[G[0][F]].clone(),m=o[G[0][F+1]].clone()):(u=o[G[1][F]].clone(),m=o[G[1][F+1]].clone()),u.setY(K(u.x*u.x+u.z*u.z)*D).normalize(),m.setY(K(m.x*m.x+m.z*m.z)*D).normalize(),r=0;U>r;r++){var c=G[r][F],N=G[r+1][F],W=G[r+1][F+1],p=G[r][F+1],R=u.clone(),e=u.clone(),J=m.clone(),X=m.clone(),j=b[r][F].clone(),z=b[r+1][F].clone(),I=b[r+1][F+1].clone(),V=b[r][F+1].clone();a.push(new wh(c,N,p,[R,e,X])),q[0].push([j,z,V]),a.push(new wh(N,W,p,[e.clone(),J,X.clone()])),q[0].push([z.clone(),I,V.clone()])}if(L&&S>0)for(this.vertices.push(new bo(0,d,0)),F=0;h>F;F++){var c=G[0][F],N=G[0][F+1],W=this.vertices.length-1,R=new bo(0,1,0),e=new bo(0,1,0),J=new bo(0,1,0),j=b[0][F].clone(),z=b[0][F+1].clone(),I=new Cp(z.x,0);a.push(new wh(c,N,W,[R,e,J],null,1));var H=F/h*E,Y=x(H),v=C(H),$=(F+1)/h*E,_=x($),B=C($);q[0].push([new Cp(.5+.5*Y,.5+.5*v),new Cp(.5+.5*_,.5+.5*B),new Cp(.5,.5)])}if(M&&w>0)for(this.vertices.push(new bo(0,-d,0)),F=0;h>F;F++){var c=G[r][F+1],N=G[r][F],W=o.length-1,R=new bo(0,-1,0),e=new bo(0,-1,0),J=new bo(0,-1,0),j=b[r][F+1].clone(),z=b[r][F].clone();a.push(new wh(c,N,W,[R,e,J],null,2));var H=F/h*E,Y=x(H),v=C(H),$=(F+1)/h*E,_=x($),B=C($);q[0].push([new Cp(.5+.5*_,.5-.5*B),new Cp(.5+.5*Y,.5-.5*v),new Cp(.5,.5)])}};io.prototype=rq(Xd);var yg=function(D,V,s,c,Y,_,R){yb.call(this),R=R||.5,D=D||16,V=V||16,s=(s!==Q?s:0)-k,c=c!==Q?c:E,Y=Y!==Q?Y:0,_=_!==Q?_:k;var h,U,O=[],P=[],l=this.vertices,K=this.faces,q=this.faceVertexUvs;for(U=0;V>=U;U++){var N=[],j=[];for(h=0;D>=h;h++){var a=h/D,d=U/V,v=new bo;v.x=-R*x(s+a*c)*C(Y+d*_),v.y=R*x(Y+d*_),v.z=R*C(s+a*c)*C(Y+d*_),l.push(v),N.push(l.length-1),j.push(new Cp(a,d))}O.push(N),P.push(j)}for(U=0;V>U;U++)for(h=0;D>h;h++){var g=O[U][h+1],y=O[U][h],M=O[U+1][h],S=O[U+1][h+1],$=l[g].clone().normalize(),n=l[y].clone().normalize(),X=l[M].clone().normalize(),F=l[S].clone().normalize(),G=P[U][h+1].clone(),A=P[U][h].clone(),J=P[U+1][h].clone(),t=P[U+1][h+1].clone();H(l[g].y)===R?(G.x=(G.x+A.x)/2,K.push(new wh(g,M,S,[$,X,F])),q[0].push([G,J,t])):H(l[M].y)===R?(J.x=(J.x+t.x)/2,K.push(new wh(g,y,M,[$,n,X])),q[0].push([G,A,J])):(K.push(new wh(g,y,S,[$,n,F])),q[0].push([G,A,t]),K.push(new wh(y,M,S,[n.clone(),X,F.clone()])),q[0].push([A.clone(),J,t.clone()]))}};yg.prototype=rq(Xd);var cr=function(y,g,q,w,m,M){yb.call(this),y=y||.33,g=g||.17,w=w||8,q=q||6,m=m||0,M=M||E;for(var s=new bo,A=[],r=[],S=0;w>=S;S++)for(var h=S/w*E+k,$=0;q>=$;$++){var d=$/q*M+m;s.x=y*x(d),s.z=-y*C(d);var K=new bo,V=y+g*x(h);K.x=V*x(d),K.z=-V*C(d),K.y=g*C(h),this.vertices.push(K),A.push(new Cp($/q,1-S/w)),r.push(K.clone().sub(s).normalize())}for(var S=1;w>=S;S++)for(var $=1;q>=$;$++){var n=(q+1)*S+$-1,p=(q+1)*(S-1)+$-1,o=(q+1)*(S-1)+$,L=(q+1)*S+$,v=new wh(n,p,L,[r[n].clone(),r[p].clone(),r[L].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([A[n].clone(),A[p].clone(),A[L].clone()]),v=new wh(p,o,L,[r[p].clone(),r[o].clone(),r[L].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([A[p].clone(),A[o].clone(),A[L].clone()])}this.computeFaceNormals()};cr.prototype=rq(Xd);var pr=function(X,G,c){return X?(yb.call(this),X=X instanceof Array?X:[X],this.addShapeList(X,G),G.convertYZ!==!1&&vs(this,c),this.computeFaceNormals(),void 0):(X=[],void 0)},Sb=pr.prototype=rq(yb.prototype);Sb.addShapeList=function(M,N){for(var V=M.length,C=0;V>C;C++){var J=M[C];this.addShape(J,N)}},Sb.addShape=function(u,z){function y(){if(z.bottom)for(var Z=0;K>Z;Z++)F=e[Z],O(F[2],F[1],F[0],!0);if(z.top)for(Z=0;K>Z;Z++)F=e[Z],O(F[0]+A*X,F[1]+A*X,F[2]+A*X,!1)}function S(){var z=0;for(p(o,z),z+=o.length,V=0,w=v.length;w>V;V++)C=v[V],p(C,z),z+=C.length}function p(W,x){for(var Z,t,i=W.length;--i>=0;){Z=i,t=i-1,0>t&&(t=W.length-1);var L=0,J=X;for(L=0;J>L;L++){var M=A*L,f=A*(L+1),e=x+Z+M,q=x+t+M,F=x+t+f,s=x+Z+f;D(e,q,F,s,W,L,J,Z,t)}}}function W(k,K,g){r.vertices.push(new bo(k,K,g))}function O(H,B,C,N){H+=Z,B+=Z,C+=Z,r.faces.push(new wh(H,B,C,null,null,N?2:1));var b=N?n.generateBottomUV(r,u,z,H,B,C):n.generateTopUV(r,u,z,H,B,C);r.faceVertexUvs[0].push(b)}function D(V,I,W,k,X,N,b,m,O){V+=Z,I+=Z,W+=Z,k+=Z,r.faces.push(new wh(V,I,k)),r.faces.push(new wh(I,W,k));var J=n.generateSideWallUV(r,u,X,z,V,I,W,k,N,b,m,O);r.faceVertexUvs[0].push([J[0],J[1],J[3]]),r.faceVertexUvs[0].push([J[1],J[2],J[3]])}var L,q,i,d,s,T=z.amount,N=z.curveSegments||yq,X=z.steps||1,$=z.extrudePath,t=!1,n=new Ao(z.repeatUVLength);$&&(L=$.getSpacedPoints(X),t=!0,q=z.frames!==Q?z.frames:new Gh.FrenetFrames($,X,!1),i=new bo,d=new bo,s=new bo);var C,V,w,r=this,Z=this.vertices.length,h=u.extractPoints(N),P=h.shape,v=h.holes,M=!hi.isClockWise(P);if(M){for(P=P.reverse(),V=0,w=v.length;w>V;V++)C=v[V],hi.isClockWise(C)&&(v[V]=C.reverse());M=!1}var e=hi.triangulateShape(P,v),o=P;for(V=0,w=v.length;w>V;V++)C=v[V],P=P.concat(C);for(var m,F,A=P.length,K=e.length,E=0;A>E;E++)m=P[E],t?(d.copy(q.normals[0]).multiplyScalar(m.x),i.copy(q.binormals[0]).multiplyScalar(m.y),s.copy(L[0]).add(d).add(i),W(s.x,s.y,s.z)):W(m.x,m.y,0);var R;for(R=1;X>=R;R++)for(E=0;A>E;E++)m=P[E],t?(d.copy(q.normals[R]).multiplyScalar(m.x),i.copy(q.binormals[R]).multiplyScalar(m.y),s.copy(L[R]).add(d).add(i),W(s.x,s.y,s.z)):W(m.x,m.y,T/X*R);y(),S()};var Gh=function(T,A,y,O,g){function o(B,g,w){return R.vertices.push(new bo(B,g,w))-1}yb.call(this),A=A||64,y=y||1,O=O||8,g=g||!1;var _,X,j,l,s,m,z,h,k,W,p,Q,u,e,r,i,Z,I,q,B,F=[],R=this,w=A+1,v=new bo,f=new Gh.FrenetFrames(T,A,g),n=f.tangents,G=f.normals,U=f.binormals;for(this.tangents=n,this.normals=G,this.binormals=U,k=0;w>k;k++)for(F[k]=[],l=k/(w-1),h=T.getPointAt(l),_=n[k],X=G[k],j=U[k],W=0;O>W;W++)s=W/O*E,m=-y*x(s),z=y*C(s),v.copy(h),v.x+=m*X.x+z*j.x,v.y+=m*X.y+z*j.y,v.z+=m*X.z+z*j.z,F[k][W]=o(v.x,v.y,v.z);for(k=0;A>k;k++)for(W=0;O>W;W++)p=g?(k+1)%A:k+1,Q=(W+1)%O,u=F[k][W],e=F[p][W],r=F[p][Q],i=F[k][Q],Z=new Cp(k/A,W/O),I=new Cp((k+1)/A,W/O),q=new Cp((k+1)/A,(W+1)/O),B=new Cp(k/A,(W+1)/O),this.faces.push(new wh(u,e,i)),this.faceVertexUvs[0].push([Z,I,B]),this.faces.push(new wh(e,r,i)),this.faceVertexUvs[0].push([I.clone(),q,B.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Gh.prototype=rq(Xd),Gh.FrenetFrames=function(o,a,N){function U(){B[0]=new bo,m[0]=new bo,n=Number.MAX_VALUE,b=H(V[0].x),$=H(V[0].y),e=H(V[0].z),n>=b&&(n=b,p.set(1,0,0)),n>=$&&(n=$,p.set(0,1,0)),n>=e&&p.set(0,0,1),x.crossVectors(V[0],p).normalize(),B[0].crossVectors(V[0],x),m[0].crossVectors(V[0],B[0])}var D,n,b,$,e,t,I,p=new bo,V=[],B=[],m=[],x=new bo,X=new tr,z=a+1,P=1e-4;for(this.tangents=V,this.normals=B,this.binormals=m,t=0;z>t;t++)I=t/(z-1),V[t]=o.getTangentAt(I),V[t].normalize();for(U(),t=1;z>t;t++)B[t]=B[t-1].clone(),m[t]=m[t-1].clone(),x.crossVectors(V[t-1],V[t]),x.length()>P&&(x.normalize(),D=w(bd(V[t-1].dot(V[t]),-1,1)),B[t].applyMatrix4(X.makeRotationAxis(x,D))),m[t].crossVectors(V[t],B[t]);if(N)for(D=w(bd(B[0].dot(B[z-1]),-1,1)),D/=z-1,V[0].dot(x.crossVectors(B[0],B[z-1]))>0&&(D=-D),t=1;z>t;t++)B[t].applyMatrix4(X.makeRotationAxis(V[t],D*t)),m[t].crossVectors(V[t],B[t])};var rd=function($,X,k,M){yb.call(this),X=X||18,k=k||0,M=M==I?E:M;for(var J=1/($.length-1),G=1/X,m=0,P=X;P>=m;m++)for(var p=k+m*G*M,g=x(p),D=C(p),R=0,h=$.length;h>R;R++){var a=$[R],_=new bo;_.x=g*a.x-D*a.y,_.y=D*a.x+g*a.y,_.z=a.z,this.vertices.push(_)}for(var d=$.length,m=0,P=X;P>m;m++)for(var R=0,h=$.length-1;h>R;R++){var w=R+d*m,t=w,V=w+d,g=w+1+d,z=w+1,i=m*G,L=R*J,B=i+G,f=L+J;this.faces.push(new wh(t,z,V)),this.faceVertexUvs[0].push([new Cp(i,L),new Cp(i,f),new Cp(B,L)]),this.faces.push(new wh(V,z,g)),this.faceVertexUvs[0].push([new Cp(B,L),new Cp(i,f),new Cp(B,f)])}this.mergeVertices(),vs(this),this.computeFaceNormals(),this.computeVertexNormals()};rd.prototype=rq(Xd);var Rh=function(b,S){S=S||{};var e=em.generateShapes(b,S);S.amount=S.amount!==Q?S.amount:.5,S.convertYZ=!1,S.fill!==!1&&(S.bottom=!0,S.top=!0),pr.call(this,e,S)};Rh.prototype=rq(Sb);var Mh=v.Node=function(){mj(Mh,this)},Od={X:os,Y:Rb,Z:Vg},si={X:0,Y:1,Z:2},$r={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},pm="xzy",Dn=function(V,u,B){if(u){var r=u[0],f=u[1],L=u[2];"xzy"===B?(Rb(V,f),Vg(V,L),os(V,r)):"xyz"===B?(Vg(V,L),Rb(V,f),os(V,r)):"yxz"===B?(Vg(V,L),os(V,r),Rb(V,f)):"yzx"===B?(os(V,r),Vg(V,L),Rb(V,f)):"zxy"===B?(Rb(V,f),os(V,r),Vg(V,L)):"zyx"===B?(os(V,r),Rb(V,f),Vg(V,L)):(Rb(V,f),Vg(V,L),os(V,r))}};$b("Node",Fh,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:pm,_64O:0,_rotationX:0,_53O:0,_host:I,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Vn},_22Q:function(){return Tp},getX:function(){return this.p().x},setX:function(_){this.p(_,this.p().y)},getY:function(){return this.p().y},setY:function(W){this.p(this.p().x,W)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(e){this.setAnchor(e,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(I){this.setAnchor(this.getAnchor().x,I)},getScaleX:function(){return this.getScale().x},setScaleX:function(b){this.setScale(b,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(B){this.setScale(this.getScale().x,B)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(c,t){Tl(c,ph(I,I,this.r3(),this.getRotationMode())),this.translate3d(c[0]*t,c[1]*t,c[2]*t)},translateFront:function(L){this.translate3dBy([0,0,1],L)},translateBack:function(M){this.translate3dBy([0,0,-1],M)},translateLeft:function(i){this.translate3dBy([-1,0,0],i)},translateRight:function(K){this.translate3dBy([1,0,0],K)},translateTop:function(p){this.translate3dBy([0,1,0],p)},translateBottom:function(H){this.translate3dBy([0,-1,0],H)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(P,r,K){1===arguments.length&&(r=P[1],K=P[2],P=P[0]),this.p(P,K),this.setElevation(r)},translate3d:function(g,D,S){1===arguments.length&&(D=g[1],S=g[2],g=g[0]),this.translate(g,S),this.setElevation(this._54O+D)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(T,P,U){1===arguments.length&&(P=T[1],U=T[2],T=T[0]),this.setSize(T,U),this.setTall(P)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(I,y,w){1===arguments.length&&(y=I[1],w=I[2],I=I[0]),this.setRotationX(I),this.setRotation(-y),this.setRotationZ(w)},setRotationY:function(l){this.setRotation(-l)},getRotationY:function(){return-this._64O},lookAtDirection:function(F,W){W=W||Tk;var p=this,I=Oj(F);W===Tk?(p.r3([-a(F[1]/I),-$(F[2],F[0])+b,0]),p.setRotationMode("xzy")):W===Np?(p.r3(0,-$(F[2],F[0]),a(F[1]/I)),p.setRotationMode("zyx")):W===Hd?(p.r3(0,-$(F[2],F[0])+k,-a(F[1]/I)),p.setRotationMode("zyx")):W===hq?(p.r3([-a(F[1]/I)+b,-$(F[2],F[0])+b,0]),p.setRotationMode("xzy")):W===Ce&&(p.r3([-a(F[1]/I)-b,-$(F[2],F[0])+b,0]),p.setRotationMode("xzy")),W===Mn&&(p.r3([-a(F[1]/I)+k,-$(F[2],F[0])+b,k]),p.setRotationMode("zxy"))},lookAt:function(A,J){return this.lookAtDirection(Ti(A,this.p3()),J)},lookAtX:function(){var _=new He,Z=new He,j=new He,D=new _i,E=new _i,q=new Sr;return function(B,v){var A=vh(this);if(D.fromArray(A),j.copy(this.p3()),_.copy(B).sub(j),!(_.lengthSq()<1e-6)){_.normalize(),v===Tk?Z.set(0,0,1):v===Mn?Z.set(0,0,-1):v===Hd?Z.set(-1,0,0):v===Np?Z.set(1,0,0):v===hq?Z.set(0,1,0):v===Ce&&Z.set(0,-1,0),Z.applyMatrix4(D).sub(j).normalize();var u=Math.acos(_.dot(Z));if(u){var M=_.clone().cross(Z);M.lengthSq()<1e-6&&(v===hq||v===Ce?M.set(0,0,1).applyMatrix4(D).sub(j):M.set(0,1,0).applyMatrix4(D).sub(j)),M.normalize(),q.set(this.r3(),this.getRotationMode(),!0),D.makeRotationFromEuler(q),E.makeRotationAxis(M,-u),q.setFromRotationMatrix(E.multiply(D)),this.r3([q.x,q.y,q.z])}}}}(),getHost:function(){return this._host},setHost:function(B){var E=this;if(E!==B&&E._host!==B){var Z=E._host;Z&&Z._removeAttach(E),E._host=B,E._host&&E._host._addAttach(E),E.fp("host",Z,B),E.onHostChanged(Z,B)}},getAttaches:function(){return this._69O},_addAttach:function(r){var h=this;h._69O||(h._69O=new up),h._69O.add(r),h.fp("attaches",I,r)},_removeAttach:function(W){var Q=this;Q._69O.remove(W),Q._69O.isEmpty()&&delete Q._69O,Q.fp("attaches",W,I)},getImage:function(){if(this._pendingCheckImageJSON){var V=t.getImage(this._image);V&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Hq&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(r){var R=this,I=R._image,D=R.getWidth(),m=R.getHeight();R._image=r,R.fp("image",I,r)&&(null!=r&&(nd(r)||fh(r)&&/\.json$/i.test(r))&&(this._pendingCheckImageJSON=!0),R.fp(Or,D,R.getWidth()),R.fp(Pe,m,R.getHeight()))},getElevation:function(){return this._54O},setElevation:function(T){var r=this;if(!r._50O){r._50O=1;var i=r._54O;r._54O=T,r.fp(Wq,i,T),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(i){var O=this;if(!O._49O){O._49O=1;var c=O._64O;O._64O=i,O.fp(rb,c,i),delete O._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(B){var w=this;if(!w._51O){w._51O=1;var S=w._rotationX;w._rotationX=B,w.fp("rotationX",S,B),delete w._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(o){var C=this;if(!C._52O){C._52O=1;var x=C._53O;C._53O=o,C.fp("rotationZ",x,o),delete C._52O}},getPosition:function(){return this._position},setPosition:function(s,k){var o=this;if(!o._50I){o._50I=1;var q;if(q=2===arguments.length?{x:s,y:k}:s,q.x!==o._position.x||q.y!==o._position.y){var A=o._position;o._position=q,o.fp(sp,A,q)}delete o._50I}},translate:function(s,v){var p=this._position;this.p(p.x+s,p.y+v)},getWidth:function(){var H=this;if(H._width>=0)return H._width;var F=H.getStyle("shape3d");if(F){var G=bf(F);if(G&&G.rawS3)return G.rawS3[0];if("billboard"===F||"plane"===F){var t=Bn(H.getStyle("shape3d.image"));return t?vk(t,H):20}}var t=Bn(H._image);return t?vk(t,H):20},setWidth:function(W){var l=this,d=l._width;l._width=W,l.fp(Or,d,W)},getHeight:function(){var U=this;if(U._height>=0)return U._height;var W=U.getStyle("shape3d");if(W){var s=bf(W);if(s&&s.rawS3)return s.rawS3[2];if("plane"===W){var h=Bn(U.getStyle("shape3d.image"));return h?ns(h,U):20}if("billboard"===W)return 2}var h=Bn(U._image);return h?ns(h,U):20},setHeight:function(q){var T=this,W=T._height;T._height=q,T.fp(Pe,W,q)},getTall:function(){var r=this;if(r._tall>=0)return r._tall;var m=r.getStyle("shape3d");if(m){var h=bf(m);if(h&&h.rawS3)return h.rawS3[1];if("billboard"===m){var T=Bn(r.getStyle("shape3d.image"));return T?ns(T,r):20}if("plane"===m)return 2}return 20},setTall:function(W){var J=this,Y=J._tall;J._tall=W,J.fp("tall",Y,W)},setSize:function(P,f){var e=this;2===arguments.length?(e.setWidth(P),e.setHeight(f)):(e.setWidth(P.width),e.setHeight(P.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(M,p,J,F,W){var Y=this,t=Y.getAnchor(),K=Y.getScale();arguments.length<=2&&(W=p,p=M.y,J=M.width,F=M.height,M=M.x);var L=W&&K.x<0?1-t.x:t.x,T=W&&K.y<0?1-t.y:t.y;Y.p(M+J*L,p+F*T),W&&(J/=Math.abs(K.x),F/=Math.abs(K.y)),Y.setWidth(J),Y.setHeight(F)},getMatrix:function(){var e=this,i=e._64O,l=e._position,s=e.getScale();return new xs(i,l.x,l.y,s.x,s.y)},getAnchorRect:function(){var A=this,C=A.getWidth(),r=A.getHeight(),N=A.getAnchor();return{x:-C*N.x,y:-r*N.y,width:C,height:r}},toLocal:function(p){return this.getMatrix().tfi(p)},toGlobal:function(F){return this.getMatrix().tf(F)},getAttachPosition:function(){var V=new xs;return function(d,e,k,g){k=k||0,g=g||0;var M=this,$=M.getAnchor(),h=M._64O,Z=M._position,N=M.getScale();return V.setFromTransform(h,Z.x,Z.y).tf({x:k+N.x*M.getWidth()*(d-$.x),y:g+N.y*M.getHeight()*(e-$.y)})}}(),isInRect:function(c){c=this.toLocal(c);var Z=this.getWidth(),I=this.getHeight();return c.x+=Z*this.getAnchorX(),c.y+=I*this.getAnchorY(),!(c.x<0||c.y<0||c.x>Z||c.y>I)},getRect:function(){var B=this,W=B.getWidth(),t=B.getHeight(),J=B.getAnchor(),N={x:-W*J.x,y:-t*J.y,width:W,height:t},S=B.getMatrix();return N=Hj([S.tf(N.x,N.y),S.tf(N.x+N.width,N.y),S.tf(N.x+N.width,N.y+N.height),S.tf(N.x,N.y+N.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var l=this,T=l.getAnchor(),X=l._anchorElevation;return{x:T.x,y:X,z:T.y}},setAnchorElevation:function(T){var j=this,X=j._anchorElevation;return X!==T?(j._anchorElevation=T,j.fp("anchorElevation",X,T),!0):!1},setAnchor3d:function(H,T,X,J){var m,G=this;"number"==typeof H?m={x:H,y:T,z:X}:(m=H.length?{x:H[0],y:H[1],z:H[2]}:H,J=T);var f=G.getDataModel();f&&f.beginTransaction();var W=G.getAnchor3d(),D=G.setAnchor(m.x,m.z);if(G.setAnchorElevation(m.y)&&(D=!0),D&&J&&!db){G.getAnchor3d();var s=vh(G),Z=Tl([m.x-W.x,m.y-W.y,m.z-W.z],s);G.p3(Z)}return f&&f.endTransaction(),D},getAnchor:function(){var B=this;if(B.hasOwnProperty("_anchor"))return B._anchor;var l=Bn(B._image);return l&&l.anchorX!==Q?{x:l.anchorX,y:l.anchorY}:B._anchor},setAnchor:function(o,e,a){var y,s=this;"number"==typeof o?y={x:o,y:e}:(y=o.length?{x:o[0],y:o[1]}:o,a=e);var J=s.getAnchor();if(J.x!==y.x||J.y!==y.y){var U=s.getDataModel();if(U&&U.beginTransaction(),s._anchor=y,s.fp("anchor",J,y),a&&!db){var c=s.getPosition(),H=s.getSize(),M=s.getRotation(),E=s.getScale(),d=-H.width*(J.x-y.x)*E.x,P=-H.height*(J.y-y.y)*E.y,N=C(M),r=x(M);s.setPosition(c.x+r*d-N*P,c.y+N*d+r*P)}return U&&U.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(Y,f){var l,i=this;l=2===arguments.length?{x:Y,y:f}:Y;var R=i.getScale();(R.x!==l.x||R.y!==l.y)&&(i._scale=l,i.fp("scale",R,l))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var c=this,B=c._scaleTall,u=c.getScale();return[u.x,B,u.y]},getFinalScale3d:function(){var u=this,k=u.s3(),h=u._dynamicScale3d,$=u.getScale3d();return k&&($[0]*=k[0],$[1]*=k[1],$[2]*=k[2]),h&&($[0]*=h[0],$[1]*=h[1],$[2]*=h[2]),$},getFinalRotation3d:function(){var o=this;return o._dynamicRotation||o.r3()},setScaleTall:function(S){var l=this,X=l._scaleTall;X!==S&&(l._scaleTall=S,l.fp("scaleTall",X,S))},setScale3d:function(A,t,I){var D,W=this;D="number"==typeof A?{x:A,y:t,z:I}:A.length?{x:A[0],y:A[1],z:A[2]}:A,W.setScaleTall(D.y),W.setScale(D.x,D.z)},getCorners:function(e,X){e==I&&(e=0),X==I&&(X=e);var V=this,O=V.getAnchor(),b=V.getWidth(),T=V.getHeight(),R=-b*O.x-e,N=-T*O.y-X,x=b+2*e,H=T+2*X,s=V.getMatrix();return[s.tf(R,N),s.tf(R,N+H),s.tf(R+x,N+H),s.tf(R+x,N)]},getEditControlPoints:function(U,Q,A){Q==I&&(Q=0),A==I&&(A=Q);var P=this,l=P.getAnchor(),d=P.getWidth(),v=P.getHeight(),W=-d*l.x-Q,o=-v*l.y-A,Z=d+2*Q,E=v+2*A;if(U)return[{x:W,y:o},{x:W,y:0},{x:W,y:o+E},{x:0,y:o+E},{x:W+Z,y:o+E},{x:W+Z,y:0},{x:W+Z,y:o},{x:0,y:o}];var r=P.getMatrix();return[r.tf(W,o),r.tf(W,0),r.tf(W,o+E),r.tf(0,o+E),r.tf(W+Z,o+E),r.tf(W+Z,0),r.tf(W+Z,o),r.tf(0,o)]},rotateAt:function(b,t,Y){var v=this,o=v._position,G=v._64O,z=new xs(G,o.x,o.y).tf(b,t),k=K(b*b+t*t),w=$(o.y-z.y,o.x-z.x)+Y;v.setRotation(G+Y),v.p(z.x+k*x(w),z.y+k*C(w))},onParentChanged:function(){Mh.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var B={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(v){B[v]=!0}),function(V){var M=this;Mh.superClass.onPropertyChanged.call(M,V),B[V.property]&&!M._layoutUpdating&&M.updateLayoutParameters(null,V.property),M._69O&&M._69O.each(function(m){m.handleHostPropertyChange(V)}),M._49I&&M._49I.each(function(o){o.fp("agentChange",!0,!1)}),"a:layout"===V.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(h){this.updateAttach(h)},onStyleChanged:function(y){Mh.superClass.onStyleChanged.apply(this,arguments),Kj[y]&&this.updateAttach()},updateAttach:function(s){var n=this;return db?(n.updateLayoutParameters(),void 0):(n._51I||(n._51I=1,n._71O(s),delete n._51I),void 0)},_71O:function(L){var l,i,x,m,E,n,X,z,s=this,V=s._host,T=L?L.property:I,K=L?L.oldValue:I,r=L?L.newValue:I;if(V instanceof Mh&&(X=Bn(V.getImage()),X&&X.layoutAttach&&(z=X.layoutAttach)),L&&!$q[T]&&"a:layout"!==T.substring(0,8)||!z||z(V,this))if(V instanceof v.Grid){if(T===Wq)s.setElevation(s._54O+r-K);else if(!L||_b[T]){if(l=s.s("attach.row.index"),i=s.s("attach.column.index"),x=V.getCellRect(l,i),!x)return;m=s.s("attach.row.span"),E=s.s("attach.column.span"),(1!==m||1!==E)&&(x=Jq(x,V.getCellRect(l+m-1,i+E-1))),Wr(x,s,"attach.padding",1),s.setRect(x)}}else if(V instanceof Ug&&(n=s.s("attach.index"))>=0&&(!L||hc[T])){var d=s.s("attach.thickness"),J=V.getScale(),c=Math.max(J.x,J.y);d>0&&s.setHeight(V.getThickness()*d*c);var Z=s.s("attach.offset"),w=V.getPoints(),Y=w.size();if(Y>n){var g=V.getPointsMatrix2d(),q=w.get(n),Q=Y===n+1?w.get(0):w.get(n+1);q=g.apply(q),Q=g.apply(Q);var D=[Q.x-q.x,Q.y-q.y],t=Oj(D);if(t){s.s("attach.offset.relative")&&(Z*=t),s.s("attach.offset.opposite")&&(Z=t-Z);var u={x:q.x+D[0]/t*Z,y:q.y+D[1]/t*Z},f=s.s("attach.gap");f&&(s.s("attach.gap.relative")&&(f*=V.getThickness()*c),u=jk(I,u,Q,f)),s.p(u),s.setRotation($(D[1],D[0]))}}}else L&&(T===sp?s.translate(r.x-K.x,r.y-K.y):T===Wq?s.setElevation(s._54O+r-K):Lm[T]?s._11Q(V,T,r-K):("anchor"===T||"width"===T||"height"===T||"scale"===T)&&s.layout(V))},_11Q:function(){var o=new v.Math.Euler,x=v.Math.Euler.ReverseOrder,y=new v.Math.Vector2,P=new v.Math.Vector2;return function(h,L,q){var g=this,r=h.p3(),V=h.r3(),I=g.p3(),a=g.r3();if(L===rb&&(L="rotationY",q=-q),(L===rb||"rotationY"===L)&&0===a[0]&&0===a[2]&&0===V[0]&&0===V[2]&&0===I[1]&&0===r[1])return g.setRotation(-a[1]-q),y.set(I[0],I[2]).rotateAround(P.set(r[0],r[2]),-q),g.p(y.x,y.y),void 0;var e=$r[h.getRotationMode()],W=e[0],l=e[1],X=e[2],B=Od[W],C=Od[l],J=Od[X],u=Tf();L===rb+W?(J(u,V[si[X]]),C(u,V[si[l]]),B(u,q),C(u,-V[si[l]]),J(u,-V[si[X]])):L===rb+l?(J(u,V[si[X]]),C(u,q),J(u,-V[si[X]])):L===rb+X&&J(u,q);var D=Ti(I,r);Tl(D,u),g.p3(r[0]+D[0],r[1]+D[1],r[2]+D[2]);var s=g.getRotationMode();Dn(u,g.r3(),s),o.setFromRotationMatrix(u,x(s)),g.r3([o.x,o.y,o.z])}}(),isHostOn:function(K){var i=this;if(i._host&&K&&K._69O)for(var r={},Z=i._host;Z&&Z!==i&&!r[Z._id];){if(Z===K)return!0;r[Z._id]=Z,Z=Z._host}return!1},isLoopedHostOn:function(G){return this.isHostOn(G)&&G.isHostOn(this)},getScaledSize:function(){var y=this.getSize(),g=this.getScale();return y.width*=Math.abs(g.x),y.height*=Math.abs(g.y),y},layout:function(D){if(D=D||this.getHost()){var X=this,j=X.s("layout.h")||"center",W=X.s("layout.v")||"center";if("center"!==j||"center"!==W){var k=new v.Math.Vector2,V=D.getPosition(),F=D.getAnchor(),m=D.getScaledSize();X.getPosition();var J,i,t,q,K,T=1,Z=1;switch(X._layoutUpdating=!0,j){case"left":k.setX(X._layoutHValue-F.x*m.width);break;case"right":k.setX((1-F.x)*m.width-X._layoutHValue);break;case"leftright":J=m.width-X._layoutHValue[2],t=X.getRotation()-D.getRotation(),q=Math.abs(Math.sin(t)),K=Math.abs(Math.cos(t)),T+=K*J/X._layoutHValue[3],Z+=q*J/X._layoutHValue[4],k.setX(X._layoutHValue[1]+(X._layoutHValue[5]-F.x)*m.width);break;case"center":k.setX((.5-F.x)*m.width-X._layoutHValue);break;case"scale":t=X.getRotation()-D.getRotation(),q=Math.abs(Math.sin(t)),K=Math.abs(Math.cos(t)),k.setX((.5-F.x)*m.width-X._layoutHValue[1]*m.width/X._layoutHValue[0]),i=m.width/X._layoutHValue[2]-1,T+=K*i,Z+=q*i}switch(W){case"top":k.setY(X._layoutVValue-F.y*m.height);break;case"bottom":k.setY((1-F.y)*m.height-X._layoutVValue);break;case"topbottom":t||(t=X.getRotation()-D.getRotation(),q=Math.abs(Math.sin(t)),K=Math.abs(Math.cos(t))),J=m.height-X._layoutVValue[2],T+=q*J/X._layoutVValue[3],Z+=K*J/X._layoutVValue[4],k.setY(X._layoutVValue[1]+(X._layoutVValue[5]-F.y)*m.height);break;case"center":k.setY((.5-F.y)*m.height-X._layoutVValue);break;case"scale":t||(t=X.getRotation()-D.getRotation(),q=Math.abs(Math.sin(t)),K=Math.abs(Math.cos(t))),k.setY((.5-F.y)*m.height-X._layoutVValue[1]*m.height/X._layoutVValue[0]),i=m.height/X._layoutVValue[2]-1,T+=q*i,Z+=K*i}if("leftright"===j||"scale"===j||"topbottom"===W||"scale"===W){var x=this.getScale(),O=Math.abs(x.x),l=Math.abs(x.y);"leftright"===j||"scale"===j?X.setSize(X._layoutHValue[3]*T/O,X._layoutHValue[4]*Z/l):X.setSize(X._layoutVValue[3]*T/O,X._layoutVValue[4]*Z/l)}k.rotateAround(null,D.getRotation()),this.setPosition(k.x+V.x,k.y+V.y),X._layoutUpdating=Q}}},updateLayoutParameters:function(D,u){if(D=D||this.getHost()){var x=this,d=x.s("layout.h"),g=x.s("layout.v");if(d||g){var G,w,c,n,V,Z,L=new v.Math.Vector2,Y=D.getPosition(),R=D.getAnchor(),k=D.getScaledSize(),f=x.getPosition(),C=x.getScaledSize();switch(L.set(f.x-Y.x,f.y-Y.y),L.rotateAround(null,-D.getRotation()),d){case"left":x._layoutHValue=L.x+R.x*k.width;break;case"right":x._layoutHValue=-L.x+(1-R.x)*k.width;break;case"center":x._layoutHValue=-L.x+(.5-R.x)*k.width;break;case"leftright":case"scale":"scale"===d?G=-L.x+(.5-R.x)*k.width:(w=x.getAnchor(),c=x.getRotation()-D.getRotation(),n=Math.cos(c),V=Math.sin(c),Z=-Math.min(-w.x*n+w.y*V,-w.x*n-(1-w.y)*V,(1-w.x)*n+w.y*V,(1-w.x)*n-(1-w.y)*V),G=L.x-(Z-R.x)*k.width),"position"===u&&"object"==typeof x._layoutHValue?(x._layoutHValue[0]=k.width,x._layoutHValue[1]=G):x._layoutHValue=[k.width,G,k.width,C.width,C.height,Z]}switch(g){case"top":x._layoutVValue=L.y+R.y*k.height;break;case"bottom":x._layoutVValue=-L.y+(1-R.y)*k.height;break;case"center":x._layoutVValue=-L.y+(.5-R.y)*k.height;break;case"topbottom":case"scale":"scale"===g?G=-L.y+(.5-R.y)*k.height:(c||(w=x.getAnchor(),c=x.getRotation()-D.getRotation(),n=Math.cos(c),V=Math.sin(c)),Z=-Math.min(-w.x*V-w.y*n,-w.x*V+(1-w.y)*n,(1-w.x)*V-w.y*n,(1-w.x)*V+(1-w.y)*n),G=L.y-(Z-R.y)*k.height),"position"===u&&"object"==typeof x._layoutVValue?(x._layoutVValue[0]=k.height,x._layoutVValue[1]=G):x._layoutVValue=[k.height,G,k.height,C.width,C.height,Z]}}}},getSerializableProperties:function(){var i=Mh.superClass.getSerializableProperties.call(this);return Fd(i,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),i}});var vr=v.Edge=function(K,g){var f=this;mj(vr,f),f.setSource(K),f.setTarget(g)};$b("Edge",Fh,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Gb},_22Q:function(){return Gc},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(K){if(K===this)return!1;if(Fg(K))return!0;for(var J,v,h,P,s,I=[this],q=-1,S=0;S>q;)if(q++,J=I[q],v=J._44I)for(v=v.getArray(),P=0,s=v.length;s>P;P++)if(h=v[P],Xm(h)&&!(I.indexOf(h)>=0)){if(h===K)return!1;I.push(h),S++}return!0},setSource:function(a){var Q=this;if(Q._source!==a&&Q.canSetSourceTarget(a)){var P=Q._source;Q._source=a,P&&P._16I(Q),a&&a._2I(Q),Q._7I(),Q.fp("source",P,a)}},setTarget:function(s){var m=this;if(m._target!==s&&m.canSetSourceTarget(s)){var T=m._target;m._target=s,T&&T._18I(m),s&&s._4I(m),m._7I(),m.fp("target",T,s)}},isLooped:function(){var K=this;return K._source===K._target&&Fg(K._source)&&Fg(K._target)},onPropertyChanged:function(){var Z=this;Z._49I&&Z._49I.each(function(g){g.fp("agentChange",!0,!1)})},_7I:function(){var I,H=this,p=To(H);H._40I!==p&&(I=this._40I,I&&I._15I(H),H._40I=p,p&&p._1I(H),H.fp("sourceAgent",I,p),wf(I,H._41I),wf(p,H._41I));var _=Pq(H);H._41I!==_&&(I=H._41I,I&&I._17I(H),H._41I=_,_&&_._3I(H),H.fp("targetAgent",I,_),wf(I,H._40I),wf(_,H._40I))},_22I:function(A){this._52I=A,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var h=this;return h._52I&&h._52I.get(0)!==h&&!h.getStyle(In)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var H=this,i=H._52I;return i&&!H.getStyle(In)&&i.size()>1&&H===i.get(0)},toggle:function(){this.beginTransaction();var B=this._52I,a=!this.s(In);B&&B.size()>1&&(B.each(function(c){c.s(In,a)}),B.getSiblings().each(function(T){T!==B&&T.each(function(R){R.fp("edgeGroup",I,T)})})),this.endTransaction()},setStyle:function(Y,E){(Y===Ie||"edge.segments"===Y)&&(E=Xp(E)),vr.superClass.setStyle.call(this,Y,E)},onStyleChanged:function(F){vr.superClass.onStyleChanged.apply(this,arguments),Ol[F]&&wf(this._41I,this._40I)},getSerializableProperties:function(){var G=vr.superClass.getSerializableProperties.call(this);return Fd(G,{source:1,target:1}),G}});var fi=v.Group=function(){mj(fi,this)};$b("Group",Mh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return al},onChildAdded:function(){fi.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){fi.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var U=this;if(!U._54I&&!db){var W=U.getChildrenRect();W&&(U._53I=1,U.p(Ke(U.s("group.position"),W,U.getSize())),delete U._53I)}},getChildrenRect:function(){var f,r=this;return r.eachChild(function($){Fg($)&&(f=Jq(f,r.getChildRect($)))}),f},getChildRect:function(U){var $;return Fg(U)&&U.s(pp)&&(Rn(U)&&U.isExpanded()&&U.eachChild(function(y){$=Jq($,U.getChildRect(y))}),!$&&U.getRect&&($=U.getRect())),$},setPosition:function(G,C){var _=this;if(!_._54I){var L;L=2===arguments.length?{x:G,y:C}:G,db||_._53I||(_._54I=1,Je(_._children,L.x-_._position.x,L.y-_._position.y),delete _._54I),fi.superClass.setPosition.call(this,L)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(O){var x=this;if(x._57O!==O){var p=x._57O;x._57O=O,x.fp("expanded",p,x._57O),x._fireInvalidateDeep(),x._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(r){Rn(r)?r._fireInvalidateDeep():r.iv()})},_8I:function(){fi.superClass._8I.call(this),this.eachChild(function(N){Fg(N)&&N._8I()})},onStyleChanged:function(E){fi.superClass.onStyleChanged.apply(this,arguments),"group.position"===E&&this._81I()},getSerializableProperties:function(){var r=fi.superClass.getSerializableProperties.call(this);return r.expanded=1,r}});var Ml=v.Block=function(){mj(Ml,this)};$b("Block",Mh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Vp},onChildAdded:function(){Ml.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ml.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()
},updateFromChildren:function(){var $=this;if(!db&&!$._updatingToChildren&&$._syncSize&&!$._freezeSyncFromChildren){var S,u,_,n,o,q=[],p=$.getRotation();if($.eachChild(function(L){Fg(L)&&q.push.apply(q,L.getCorners())}),q.length){$._updatingFromChildren=1;var z=x(-p),t=C(-p),M=1/0,G=-1/0,R=1/0,k=-1/0;for(n=0,o=q.length;o>n;n++)_=q[n],S=_.x,u=_.y,_.x=z*S-t*u,_.y=t*S+z*u,M=r(M,_.x),G=P(G,_.x),R=r(R,_.y),k=P(k,_.y);var a=$.getScale();$.setSize(H((G-M)/a.x),H((k-R)/a.y));var v;a.x<0&&(v=M,M=G,G=v),a.y<0&&(v=R,R=k,k=v),z=x(p),t=C(p);var f=$.getAnchor();S=M+(G-M)*f.x,u=R+(k-R)*f.y,$.setPosition(z*S-t*u,t*S+z*u),delete $._updatingFromChildren}}},setPosition:function(B,E){var f=this;if(!f._updatingToChildren){var Z;Z=2===arguments.length?{x:B,y:E}:B,db||f._updatingFromChildren||(f._updatingToChildren=1,Je(f._children,Z.x-f._position.x,Z.y-f._position.y),delete f._updatingToChildren),Ml.superClass.setPosition.call(this,Z)}},setWidth:function(g){return this.setSize(g,this.getHeight())},setHeight:function(v){return this.setSize(this.getWidth(),v)},setSize:function(j,m){1>j&&(j=1),1>m&&(m=1);var F=this;if(!F._updatingToChildren){2!==arguments.length&&(m=j.height,j=j.width);var X=F.getWidth(),Z=F.getHeight();if(j!==X&&Ml.superClass.setWidth.call(F,j),m!==Z&&Ml.superClass.setHeight.call(F,m),!db&&!F._updatingFromChildren){F._updatingToChildren=1;var r=j/X,y=m/Z;F._adjustChildScaleOrSize(r,y,"size"),delete F._updatingToChildren,F.updateFromChildren()}}},_adjustChildScaleOrSize:function(o,V,F){var r=this;if(r._syncSize){var J=r.getPosition(),p=r.getRotation();r.getScale(),r.eachChild(function(j){if(Fg(j)){var i=j.getPosition(),y=j.getRotation(),g=j.getWidth(),T=j.getHeight(),d=j.getScale(),Z=d.x*g,W=d.y*T,r=new xs(y,i.x,i.y,Z,W);r.translate(-J.x,-J.y),r.rotate(-p),y=$(r.b*Math.sign(Z),r.a*Math.sign(Z)),r.scale(o,V);var B,G,z,A=x(y);if(Math.abs(A)<.001?(B=C(y),G=r.b/B,z=-r.c/B):(G=r.a/A,z=r.d/A),"scale"===F)j.setScale(G/g,z/T);else if("size"===F){var N=G/d.x,Q=z/d.y;j.setScale(jg(G)*Math.abs(d.x),jg(z)*Math.abs(d.y)),j instanceof v.Shape?(j.setWidthForce(Math.max(Math.abs(N),1e-5)),j.setHeightForce(Math.max(Math.abs(Q),1e-5))):j.setSize(Math.max(.01,Math.abs(N)),Math.max(.01,Math.abs(Q)))}r.rotate(p),r.translate(J.x,J.y),j.setPosition(r.tx,r.ty)}})}},_calcChangeFactor:function(i,u,e,G){var c,l,W,B;return c=H(i),l=H(e),W=c>l?c/l:l/c,c=H(u),l=H(G),B=c>l?c/l:l/c,P(W,B)},setAnchor:function(){var z=this;if(!z._updatingToChildren){var d=z.getAnchor();if(Ml.superClass.setAnchor.apply(z,arguments),!db&&!z._updatingFromChildren&&z._syncSize){z._updatingToChildren=1;var _=z.getAnchor();z.getPosition();var h=z.getSize(),L=z.getScale(),c=z.getRotation(),W=-h.width*L.x*(d.x-_.x),g=-h.height*L.y*(d.y-_.y),U=C(c),O=x(c),T=O*W-U*g,v=U*W+O*g;z.eachChild(function(G){if(Fg(G)){var i=G.getPosition();G.setPosition(i.x-T,i.y-v)}}),delete z._updatingToChildren}}},setRotation:function(L){var D=this;if(!D._updatingToChildren){var f=D.getRotation();if(Ml.superClass.setRotation.apply(D,arguments),!db&&!D._updatingFromChildren){D._updatingToChildren=1;var V=D.getPosition(),P=L-f;D.eachChild(function(D){if(Fg(D)){var x=D.getMatrix();x.translate(-V.x,-V.y),x.rotate(P),x.translate(V.x,V.y);var N=Math.sign(D.getScale().x);D.setRotation($(x.b*N,x.a*N)),D.setPosition(x.tx,x.ty)}}),delete D._updatingToChildren}}},setScale:function(a,k){var c=this;if(!c._updatingToChildren){null==k&&(k=a.y,a=a.x);var O=c.getScale();if(H(a)<.01&&(a=.01*(jg(a)||jg(O.x))),H(k)<.01&&(k=.01*(jg(k)||jg(O.y))),Ml.superClass.setScale.call(c,a,k),!db&&!c._updatingFromChildren){c._updatingToChildren=1;var F=a/O.x,D=k/O.y;c._adjustChildScaleOrSize(F,D,"size"),delete c._updatingToChildren,c.updateFromChildren()}}},getSerializableProperties:function(){var r=Ml.superClass.getSerializableProperties.call(this);return r.clickThroughEnabled=1,r.syncSize=1,r}});var hp=v.Grid=function(){mj(v.Grid,this)};$b("Grid",Mh,{IRotatable:!1,_icon:"grid_icon",_image:I,getUIClass:function(){return Lh},setRotation:function(){},getCellRect:function(G,d){var s=this,f=s.s("grid.row.count"),J=s.s("grid.column.count");if(0>=f||0>=J||0>G||G>=f||0>d||d>=J)return I;var p,e,L,x=s.getRect(),w=s.s("grid.row.percents"),S=s.s("grid.column.percents");if(Wr(x,s,"grid.border",-1),w&&w._as&&(w=w._as),S&&S._as&&(S=S._as),w&&w.length===f){for(L=0,p=0;G>p;p++)L+=x.height*w[p];x.y+=L,x.height=x.height*w[G]}else x.height=x.height/f,x.y+=x.height*G;if(S&&S.length===J){for(e=0,p=0;d>p;p++)e+=x.width*S[p];x.x+=e,x.width=x.width*S[d]}else x.width=x.width/J,x.x+=x.width*d;return tb(x,-s.s("grid.gap")),x}});var Pd=v.Text=function(){mj(Pd,this),this.setSize(100,50),this.s("text","TEXT")};$b("Text",Mh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Yj},setWidth:function(H){H||(H=.001),Pd.superClass.setWidth.call(this,H)},setHeight:function(l){l||(l=.001),Pd.superClass.setHeight.call(this,l)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),_e("__text__",{width:{value:100,isSafeFunc:!0,func:function(e){return e?e._width:100}},height:{value:50,isSafeFunc:!0,func:function(e){return e?e._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Ug=v.Shape=function(){mj(Ug,this),this._59O=new up};Ug.__de__=rj,$b("Shape",Mh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Al},_22Q:function(){return oq},getLength:function(p){return Jg(wn(this._59O,this._58O,p,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var X=this._58O;return X?new up(X._as.slice(0)):X},setSegments:function(w){var Q=this._58O;w=w?Ad(w)?new up(w.slice(0)):new up(w._as.slice(0)):null,(Q&&w&&Q._as.join(",")!==w._as.join(",")||Q!==w)&&(this._58O=w,this.fp("segments",Q,w))},getPoints:function(){return this._59O},toPoints:function(){var r=this._59O;return new up(r._as.slice(0))},getPointsMatrix2d:function(){var r=this,O=new Qg.Matrix2d,X=r.getPosition(),j=r.getScale(),t=r.getRotation();return O.translate(-X.x,-X.y).scale(j.x,j.y).rotate(t).translate(X.x,X.y),O},getPointsMatrix3d:function(){return function(){var K=this,m=new Qg.Matrix4,$=m.getElements(),x=K.p3();kl($,x),Dn($,K.getFinalRotation3d(),K.getRotationMode());var t=K.getScale3d(),i=K._dynamicScale3d;return i&&(t[0]*=i[0],t[1]*=i[1],t[2]*=i[2]),Ff($,t),kl($,Mg(x)),m}}(),setPoints:function(B,Z){var W=this,S=W._59O;B=B?Ad(B)?new up(B.slice(0)):new up(B._as.slice(0)):new up;var U,c,o,a,r,e;Z&&(U=W.getPosition(),e=new xs(W.getRotation(),0,0,W.getScale().x,W.getScale().y)),(S&&B&&S._as.join(",")!==B._as.join(",")||S!==B)&&(W._59O=B,W.fs(),W.fp("points",S,B)),Z&&(c=W.getPosition(),o=c.x-U.x,a=c.y-U.y,r=e.tf(o,a),W.setPosition(c.x-o+r.x,c.y-a+r.y))},addPoint:function(V,f,J){var q=this.toPoints();q.add(V,f),this.setPoints(q,J)},setPoint:function(e,j,U){var J=this.toPoints();J.set(e,j),this.setPoints(J,U)},removePointAt:function(S){var e=this.toPoints();e.removeAt(S),this.setPoints(e)},setWidthForce:function(M){var e=this;if(!e._55I&&!db&&e.getWidth()){e._55I=1;var N=e._position.x,L=M/e.getWidth(),w=e.toPoints(),i=new up;1!==L&&(w.each(function(Y){i.add({x:(Y.x-N)*L+N,y:Y.y,e:Y.e})}),e.setPoints(i),Go(e,[L,0,0,1,N*(1-L),0]),e.fs()),delete e._55I}Ug.superClass.setWidth.call(e,M)},setWidth:function(l){return this.setWidthForce(1>l?1:l)},setHeightForce:function(H){var P=this;if(!P._55I&&!db&&P.getHeight()){P._55I=1;var W=P._position.y,U=H/P.getHeight(),K=P.toPoints(),R=new up;1!==U&&(K.each(function(B){R.add({x:B.x,y:(B.y-W)*U+W,e:B.e})}),P.setPoints(R),Go(P,[1,0,0,U,0,W*(1-U)]),P.fs()),delete P._55I}Ug.superClass.setHeight.call(P,H)},setHeight:function(U){return this.setHeightForce(1>U?1:U)},setAnchorElevation:function(G){var O=this;O._55I=!0;var W=O._updatingAnchor3d,b=!db&&!W;if(b){var f,u=G,X=O.getAnchorElevation(),m=O.getTall();f=m*(X-u),0!==f&&O.shiftPointsElevation(f)}var h=Ug.superClass.setAnchorElevation.apply(O,arguments);return W||delete O._55I,h},getShapeElevation:function(){var i=this,s=i._54O;return s-(i.getTall()||0)*(i._anchorElevation-.5)},setAnchor3d:function(I,V,b,B){var F,f=this;"number"==typeof I?F={x:I,y:V,z:b}:(F=I.length?{x:I[0],y:I[1],z:I[2]}:I,B=V),f._55I=!0,f._updatingAnchor3d=!0;var w=f.getDataModel();if(w&&w.beginTransaction(),!db){var N=f.getAnchor3d(),C=f.getSize(),W=f.getTall(),L=C.width*(N.x-F.x),r=C.height*(N.z-F.z),c=W*(N.y-F.y);B||f.shiftPoints(L,r,c);var H=f.p3()}var X=Ug.superClass.setAnchor3d.apply(f,arguments);if(!db&&B){var o=f.p3();f.shiftPoints(o[0]-H[0]+L,o[2]-H[2]+r,o[1]-H[1]+c)}return w&&w.endTransaction(),delete f._updatingAnchor3d,delete f._55I,X},setAnchor:function(I,J,B){var O=this;O._55I=!0;var b=O._updatingAnchor3d,p=!db&&!b;if(p){var n,q,V;"number"==typeof I?V={x:I,y:J}:(V=I.length?{x:I[0],y:I[1]}:I,B=J);var U=O.getAnchor(),s=O.getSize();n=s.width*(U.x-V.x),q=s.height*(U.y-V.y),B||O.shiftPoints(n,q);var T=O.getPosition()}var i=Ug.superClass.setAnchor.apply(O,arguments);if(p){var M=O.getPosition();B&&O.shiftPoints(M.x-T.x+n,M.y-T.y+q)}return b||delete O._55I,i},shiftPoints:function(S,U,x){if(S||U||x){var r=this,E=r.getElevation()||0,Z=r.toPoints(),Q=new up;Z.each(function(B){var q=B.e;x&&(q=(q==I?E:q)+x),Q.add({x:B.x+S,y:B.y+U,e:q})}),r.setPoints(Q),r.fs()}},shiftPointsElevation:function(f){return this.shiftPoints(0,0,f)},setPosition:function(a,k){var q,g=this;if(!g._28Q){if(g._28Q=1,!g._55I&&!db){q=2===arguments.length?{x:a,y:k}:a;var F=q.x-g._position.x,l=q.y-g._position.y;if(0===F&&0===l)return delete g._28Q,void 0;g._55I=1,g.shiftPoints(F,l),Go(g,[1,0,0,1,F,l]),delete g._55I}Ug.superClass.setPosition.apply(g,arguments),delete g._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var F=this;if(2!==F._59O.size())return!1;var J=F._58O;return J?2===J.size()&&1===J.get(0)&&2===J.get(1)?!0:!1:!0},fireShapeChange:function(){var L=this;if(!L._55I&&!db){var Z=Hj(L._59O);Z&&(L._55I=1,L.setRect(Z),delete L._55I)}L.fp(Oe,!1,!0)},getSerializableProperties:function(){var J=Ug.superClass.getSerializableProperties.call(this);return J.segments=1,J.points=1,J.thickness=1,J.closePath=1,J}});var Ki=v.Polyline=function(){mj(Ki,this),this.s({"shape.background":null,"shape.border.width":2})};$b("Polyline",Ug,{_icon:"polyline_icon",_22Q:function(){return wg},getUIClass:function(){return tc},setClosePath:function(){},setTall:function(y){var O=this,W=O.getDataModel();if(W&&W.beginTransaction(),!O._55I&&!O._24Q&&!db&&O.getTall()){O._24Q=1;var l=O._54O,R=y/O.getTall();if(1!==R){var u=O.toPoints(),P=new up;u.each(function(p){P.add({x:p.x,y:p.y,e:p.e==I?p.e:(p.e-l)*R+l})}),O.setPoints(P),O.fs()}delete O._24Q}Ki.superClass.setTall.call(O,y),W&&W.endTransaction()},setElevation:function(S){var v=this,n=v.getDataModel();if(n&&n.beginTransaction(),!v._55I&&!v._24Q&&!db){v._24Q=1;var w=S-v._54O;0!==w&&v.shiftPointsElevation(w),delete v._24Q}Ki.superClass.setElevation.apply(v,arguments),n&&n.endTransaction()},fireShapeChange:function(){var J=this,A=J._59O;if(!J._55I&&!J._24Q&&!db){var T=A.size();if(T){var l=1,$=A.get(0),d=J._54O;$.e==I&&($.e=d);for(var K=$.e,G=0;T>l;l++){$=A.get(l),$.e==I&&($.e=d);var C=r(K,$.e),W=P(K+G,$.e);K=C,G=W-C}J._24Q=1,J.setTall(G),J.setElevation(K+G*J._anchorElevation),delete J._24Q}}Ki.superClass.fireShapeChange.apply(J,arguments)}});var er=v.SubGraph=function(){mj(er,this)};$b("SubGraph",Mh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){er.superClass._8I.call(this),this.eachChild(function(k){Fg(k)&&k._8I()})}}),t.loadingRefGraph=0;var Hq=v.RefGraph=function(){mj(Hq,this)};$b("RefGraph",Ml,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(R){var z=this._ref;this._ref=R,this.fp("ref",z,R),this.updateRef()},_21I:function(){Hq.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var U=this;if(t.loadingRefGraph++,U.clearChildrenFromDataModel(),t.loadingRefGraph--,U._ref&&U._dataModel){U._xhrLoadHandler&&(U._xhrLoadHandler.cancel=!0);var O=db,r=U._xhrLoadHandler=function(N){if(N&&U._dataModel){t.loadingRefGraph++;var I=U._pendingUpdateInfo={needToRestore:O};O&&(I.position=U.p(),I.width=U.getWidth(),I.height=U.getHeight(),I.rotation=U.getRotation(),I.anchor=U.getAnchor(),I.scale=U.getScale()),U.p(0,0),U.setAnchor(.5,.5),U.setRotation(0),U.setScale(1,1);var V=t.parse(N),f=U._dataModel.deserialize(V,U,{justDatas:!0});f.each(function(Q){Q._refGraph=U}),U.checkPendingUpdateInfo(),t.loadingRefGraph--,t.handleRefGraphLoaded(U,f,V)}};r.xhrLoadCalled=!1,t.load(U._ref,function(U){r.cancel||(r.xhrLoadCalled?r(U):ve(function(){r(U)}))}),r.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var V=this,L=V._pendingUpdateInfo;if(!L)return V.onPendingUpdated&&(t.loadingRefGraph++,V.onPendingUpdated(),t.loadingRefGraph--),void 0;var X=!0;this.eachChild(function(C){(C._pendingCheckImageJSON||C._pendingUpdateInfo)&&(X=!1)}),X&&(t.loadingRefGraph++,V._pendingUpdateInfo=null,V.updateFromChildren(),L.needToRestore&&(V.setSize(L.width,L.height),V.setAnchor(L.anchor),V.setRotation(L.rotation),V.setScale(L.scale),V.p(L.position)),this.getParent()instanceof Hq&&this.getParent().checkPendingUpdateInfo(),V.onPendingUpdated&&V.onPendingUpdated(),t.loadingRefGraph--)},getSerializableProperties:function(){var H=Hq.superClass.getSerializableProperties.call(this);return H.ref=1,H}}),v.EdgeGroup=function(Z,n){this._70O=Z,this._siblings=n;for(var s,m,j=0,A=Z.size(),Y=q[In];A>j;j++)if(s=Z.get(j).getStyle(In,!1),s!=I){Y=s;break}Y==I&&(Y=!0);var g=t.edgeGroupAgentFunc;for(g&&(m=g(Z),m&&m!==Z.get(0)&&(Z.remove(m),Z.add(m,0))),j=0;A>j;j++)Z.get(j).s(In,Y)},$b("EdgeGroup",Y,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(C){return this._70O.get(C)},indexOf:function(s){return this._70O.indexOf(s)},each:function(F,e){this._70O.each(F,e)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(w,W){this._siblings.each(function(r){r._70O.each(w,W)})}});var qq=function(c,p,v){var k=De[c]={type:c,action:p};if(v)for(var G in v)k[G]=v[G]};Fd(t,{setConnectAction:qq,getConnectAction:function(r,q){if(!q){if(!r)return null;q=r.getCurrentConnectActionType()}return De[q]},doConnectAction:function(l,Y,Q,B){B=B||l.getCurrentConnectActionType();var _=De[B];if(!_)return!1;var E=_.action;return E?(Y instanceof lq.Group?l.sm().getSelection().each(function(I){E.call(null,l,I,Q)}):E.call(null,l,Y,Q),!0):!1},doDeleteConnectionAction:function(o,j,L){L=L||o.getCurrentConnectActionType();var h=De[L];if(!h||!h.delete)return!1;var E=h.delete.action;return E?(j instanceof lq.Group?o.sm().getSelection().each(function(Q){E.call(null,o,Q)}):E.call(null,o,j),!0):!1}});var ts=v.JSONSerializer=function(V,Q){this.dm=this._dataModel=V,this._hierarchical=t.forceHierarchicalSerialization?!0:Q==I?V.isHierarchicalRendering():Q};$b("JSONSerializer",Y,{ms_ac:["hierarchical"],serialize:function(U){return t.stringify(this.toJSON(),U)},toJSON:function(){var J=this,R=J.dm,a=R.getRoots(),T=J.json={v:t.getVersion(),p:{},a:{},d:[]},r=R.getSerializableAttrs();R.getInit()&&(T.init=R.getInit()),R.getName()&&(T.p.name=R.getName()),R.getBackground()&&(T.p.background=R.getBackground()),R.getLayers()&&(T.p.layers=R.getLayers()),R.getEnvmap()&&(T.p.envmap=R.getEnvmap()),T.p.autoAdjustIndex=R.isAutoAdjustIndex(),T.p.hierarchicalRendering=R.isHierarchicalRendering();for(var n in r){var f=R.a(n);f!==Q&&J[Rf](n,f,T.a)}return Gi(T.a)&&delete T.a,J._hierarchical?a.each(J.serializeData,this):R.each(function(j){J.serializeData(j)}),R.fireSerializeEvent({type:"serialize",json:T}),R.getPostProcessingData()&&(T.p.postProcessingData=R.getPostProcessingData()),T},isSerializable:function(){return!0},getProperties:function(d){return d.getSerializableProperties()},getStyles:function(F){return F.getSerializableStyles()},getAttrs:function(l){return l.getSerializableAttrs()},serializeData:function(b){var N=this;if(N.isSerializable(b)&&!b._refGraph){var L,Y,O,c,E=Mj(b.getClassName())||b.getClass(),W=new E,S={c:b.getClassName(),i:b.getId(),p:{},s:{},a:{}};N.json.d.push(S),L=N.getProperties(b);for(Y in L)if(/^_/.test(Y)){if(O=b[Y],!("_width"!==Y&&"_height"!==Y||O!=I&&-1!==O)){var J;((b.s("layout.h")||b.s("layout.v"))&&b.getHost()||b instanceof v.Node&&(J=b.getParent())&&J instanceof v.Block||b.s("fullscreen"))&&(O=b[Y]="_width"===Y?b.getWidth():b.getHeight())}O!==W[Y]&&N[Rf](Y.substr(1),O,S.p)}else c=lo(Y),b[c]&&(O=b[c](),O!==W[c]()&&N[Rf](Y,O,S.p));L=N.getStyles(b);for(Y in L)O=b.s(Y),O!==W.s(Y)&&N[Rf](Y,O,S.s);L=N.getAttrs(b);for(Y in L)O=b.a(Y),O!==W.a(Y)&&N[Rf](Y,O,S.a);Gi(S.p)&&delete S.p,Gi(S.s)&&delete S.s,Gi(S.a)&&delete S.a}N._hierarchical&&b.getChildren().each(N.serializeData,N)},serializeValue:function(G,z,Z){Ii(z)?z={__a:z._as}:z instanceof Fh&&(z={__i:z.getId()}),Z[G]=z},deserialize:function(e,G,S){var y=this;return fh(e)&&/.json$/.test(e)?(t.xhrLoad(e,function(b){y.deserializeImpl(b,G,S)}),void 0):y.deserializeImpl(e,G,S)},deserializeImpl:function(b,O,Y){var v=this,j=v.dm;j.setDeserializing(!0),Y=gj(Y)?{setId:Y}:qi(Y)?{finishFunc:Y}:Y||{},b=v.json=fh(b)?t.parse(b):b,!Y.justDatas&&b.a&&b.a.onPreDeserialize&&!Y.disableOnPreDeserialize&&b.a.onPreDeserialize(b,j,Y.view),j.beginTransaction(),db++,v._82I={};var o=new up,i=new up,G=0,D=b.d.length;if(Y.justDatas||(!Y.disableInit&&qi(b.init)&&b.init(j),j.setInit(b.init)),!Y.justDatas){for(var c in b.a)j.a(c,v[vf](b.a[c]));for(var l in b.p)j[Om(l)](b.p[l])}for(;D>G;G++){var w=b.d[G],n=Mj(w.c),Z=new n,T=w.i;Y.setId&&T!=I&&(Z._id=T),v._82I[T]=Z,o.add(Z),i.add(w)}for(G=0;D>G;G++)v.deserializeData(o.get(G),i.get(G));return o.each(function(i){O&&!i.getParent()&&i.setParent(O),j.add(i)}),Y.__innerHandler__&&Y.__innerHandler__(b,j,Y.view,o),j.fireSerializeEvent({type:"deserialize",json:b}),db--,j.endTransaction(),!Y.justDatas&&b.a&&b.a.onPostDeserialize&&!Y.disableOnPostDeserialize&&b.a.onPostDeserialize(b,j,Y.view,o),Y.finishFunc&&Y.finishFunc(b,j,Y.view,o),j.setDeserializing(!1),o},deserializeData:function(L,$){for(var l in $.p)L[Om(l)](this[vf]($.p[l]));for(l in $.s)L.s(l,this[vf]($.s[l]));for(l in $.a)L.a(l,this[vf]($.a[l]))},deserializeValue:function(e){if(nd(e)){var P=e.__i;if(P!=I)return this._82I[P];if(P=e.__a,Ad(P))return new up(P)}return e}}),Fd(ag,{serialize:function(p,j){return new ts(this,j).serialize(p)},toJSON:function(Q){return new ts(this,Q).toJSON()},deserialize:function(b,L,s){return new ts(this).deserialize(b,L,s)}});var Jn=v.OverlappingBox=function(d){this.gv=d,this.boxes={}};$b("OverlappingBox",Y,{clear:function(){var g,P,O=this.boxes;for(g in O)P=O[g],P.length=0},isOverlapping:function(H,f){var X,B,L=this,a=L.boxes,j=a[H];j?(X=j.rects,B=j.length):j=a[H]={rects:X=[],length:B=0};var x,r,f;for(x=0;B>x;x++)if(r=X[x],r.x<f.x+f.w&&r.x+r.w>f.x&&r.y<f.y+f.h&&r.h+r.y>f.y)return!0;return X.length<=B?(X.push(f),j.length++):X[j.length++]=f,!1}}),Fd(t,{fetch:function(G,a){var B="GET",T=!1,p=null,S="";a&&(B=a.method||"GET",T=a.sync,S=a.url,p=a.data||null),G.open(B,S,!T),a.responseType?G.responseType=a.responseType:a.overrideMimeType&&G.overrideMimeType&&G.overrideMimeType(a.overrideMimeType),G.send(p)},convertImageSrc:function(X,J){J&&"function"==typeof J||(J=function(){}),J(X)}});var Mc=v.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};$b("Request",Y,{_responseType:null,_overrideMimeType:"text/plain",send:function(N){var D=this._xhr,o=this.onload,i=this.onerror;this.getResponseType()?N.responseType=this.getResponseType():this.getOverrideMimeType()&&(N.overrideMimeType=this.getOverrideMimeType()),D.onload=o,D.onerror=i,t.fetch(D,N)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(L){this._responseType=L},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(h){this._overrideMimeType=h},getResponseText:function(){var t=this._xhr;return t.response||t.responseText}}),om.GraphView=function(v){var N=this;N._24I={},N._34I=new up,N._25I={},N._56I={},N._view=Th(1,N),N._canvas=Sg(N._view),N.dm(v?v:new ag),this._coreInteractor=new _q(this),N.setEditable(!1),N.setScrollBarVisible(t.graphViewScrollBarVisible),N._initView()},ad("GraphView",Y,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Ab,yd,Ik,Ci,"resettable","editInteractor",Bs,"zoomable","pannable","rectSelectable","autoScrollZone",Wi,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:t.graphViewZoomable,_resettable:t.graphViewResettable,_pannable:t.graphViewPannable,_rectSelectable:t.graphViewRectSelectable,_autoScrollZone:t.graphViewAutoScrollZone,_rectSelectBackground:t.graphViewRectSelectBackground,_rectSelectBorderColor:t.graphViewRectSelectBorderColor,_editPointSize:t.graphViewEditPointSize,_editPointBorderColor:t.graphViewEditPointBorderColor,_editPointBackground:t.graphViewEditPointBackground,_scrollBarColor:Ib,_scrollBarSize:js,_autoHideScrollBar:ed,_autoMakeVisible:yo,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(e){this._dataModel.setLayers(e)},setEditable:function(k){var f=this,N=f.__interactorMap__;if(!N){var p=om.XEditInteractor;N=f.__interactorMap__={scrollBar:new ym(f),select:new Di(f),edit:p?new p(f):new jp(f),text:new ib(f),move:new Te(f),"default":new fn(f),touch:new ef(f,{editable:!1})}}k?(f._uieditable=!0,f.setInteractors([N.scrollBar,N.select,N.edit,N.text,N.move,N.default,N.touch])):(f._uieditable=!1,f.setInteractors([N.scrollBar,N.select,N.move,N.default,N.touch]))},getCanvas:function(){return this._canvas},_33I:function(O){var c=O.getUIClass();return c?new c(this,O):I},getDataUI:function(p){var U=this,x=U._25I[p._id];return x===Q&&(x=U._33I(p),U._25I[p._id]=x),x},getNodeRect:function(H){return t.getNodeRect(this,H)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(E){var W=this.getDataUI(E);return W?(W._79o(),W._78o):null},getEdgeSourcePosition:function(p){var E=this,o=E.getDataUI(p),S=o.s,c=o._data._40I;return ik(E,c,S("edge.source.position"),S("edge.source.offset.x"),S("edge.source.offset.y"),S("edge.source.anchor.x"),S("edge.source.anchor.y"))},getEdgeTargetPosition:function(a){var y=this,q=y.getDataUI(a),b=q.s,I=q._data._41I;return ik(y,I,b("edge.target.position"),b("edge.target.offset.x"),b("edge.target.offset.y"),b("edge.target.anchor.x"),b("edge.target.anchor.y"))},invalidateAll:function(d){var R=this;if(d){for(var W in R._25I){var N=R._25I[W];N&&N.dispose()}R._25I={},R._56I={},R._24I={},R._34I.clear(),R.redraw()}else R.dm().each(function(w){R.invalidateData(w)})},invalidateSelection:function(){var J=this;J.sm().each(function(j){J.invalidateData(j)})},invalidateData:function(c){var m=this;m._24I[c._id]=c,m._21Q(c),m.iv()},_21Q:function(J){var W=this,w=W._24I;if(Xm(J)&&xp[J.s(Cr)]){var F=J.getSourceAgent();F&&F.getAgentEdges().each(function(B){w[B._id]=B}),F=J.getTargetAgent(),F&&F.getAgentEdges().each(function(C){w[C._id]=C}),W.iv()}},redraw:function(N){var t=this;t._32I||(N?t._34I.add(N):(t._32I=1,t._34I.clear()),t.iv())},each:function(I,J){var q,v,n,F=0,u=this.getLayers(),C=this._dataModel,g=C._datas._as,h=g.length;if(u){for(var Z=u.length;Z>F;F++)if(n=u[F],nd(n)&&(n=n.name),C.isHierarchicalRendering()){var r=function(p){return p._layer===n?J?I.call(J,p):I(p):void 0};if(this._dataModel.eachByHierarchical(r)===!1)return}else for(var X=0;h>X;X++)if(q=g[X],q._layer===n&&(v=J?I.call(J,q):I(q),v===!1))return}else if(C.isHierarchicalRendering())this._dataModel.eachByHierarchical(I,null,J);else for(;h>F;F++)if(q=g[F],v=J?I.call(J,q):I(q),v===!1)return},reverseEach:function(J,T){var p,x,D,O,C=this._dataModel,V=C._layers,f=C._datas._as,M=f.length;if(V){for(p=V.length-1;p>=0;p--)if(O=V[p],nd(O)&&(O=O.name),C.isHierarchicalRendering()){var H=function(N){return N._layer===O?T?J.call(T,N):J(N):void 0};if(C.reverseEachByHierarchical(H)===!1)return}else for(var W=M-1;W>=0;W--)if(x=f[W],x._layer===O&&(D=T?J.call(T,x):J(x),D===!1))return}else if(C.isHierarchicalRendering())C.reverseEachByHierarchical(J,null,T);else for(p=M-1;p>=0;p--)if(x=f[p],D=T?J.call(T,x):J(x),D===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var H=this,e=H._84I;if(!e){var A=this.dm().a("width"),E=this.dm().a("height");A>0&&E>0?H._84I={x:0,y:0,width:A,height:E}:(H.each(function(B){H.isVisible(B)&&(e=Jq(e,H.getDataUIBounds(B)))}),H._84I=e?e:Xq)}return H._84I},getScrollRect:function(){return Jq(this.getContentRect(),this._29I)},makeCenter:function(U,E,O){var J=this;if(!J.getWidth()||!J.getHeight())return O||ve(J.makeCenter,J,[U,E,!0],500),void 0;J.makeVisible(U),J.validate();var A=J.getDataUIBounds(U);if(A){var q=J.getWidth(),h=J.getHeight(),o=A.x+A.width/2,L=A.y+A.height/2,P=-o*J._zoom+q/2,z=-L*J._zoom+h/2;J.setTranslate(P,z,E)}},fitData:function(q,M,h,V,Y){var H=this;if(!H.getWidth()||!H.getHeight())return Y||ve(H.fitData,H,[q,M,h,V,!0],500),void 0;var T=function(){H.makeVisible(q),H.validate();var m=H.getDataUIBounds(q);m&&(m=Gk(m),tb(m,h==I?20:h),H.fitRect(m,M,V))};M?t.callWhenLoaded(T):T()},fitContent:function(v,l,o,U){var u=this;if(!u.getWidth()||!u.getHeight())return U||ve(u.fitContent,u,[v,l,o,!0],500),void 0;var K=function(){u.validate();var p=Gk(u.getContentRect());tb(p,l==I?20:l),u.fitRect(p,v,o)};v?t.callWhenLoaded(K):K()},fitRect:function(X,i,m){var V=this,Z=V.getWidth(),s=V.getHeight(),z=X.x+X.width/2,M=X.y+X.height/2,D=r(Z/X.width,s/X.height),t=V._zoom,x=-z*t+Z/2,q=-M*t+s/2;0===D||isNaN(D)||(m&&(D=r(1,D)),i?(V._65I&&(delete V._65I.finishFunc,V._65I.stop(!0)),V._14o&&V._14o.stop(!0),V.setTranslate(x,q,{finishFunc:function(){V.setZoom(D,i)}})):(V.setTranslate(x,q),V.setZoom(D)))},fitSelection:function(g,U,J){var c=this,D=c.sm(),e=null;D.size()&&(D.each(function(T){var I=c.getDataUIBounds(T);e=e?Jq(I,e):I}),g&&tb(e,g),c.fitRect(e,U,J))},toCanvas:function(z,g){g=g||this._zoom,this.validateImpl();var K=this,j=K.getContentRect();j.width||(j.width=10),j.height||(j.height=10);var e=Sg(),T=j.x*g,M=j.y*g,h=Math.ceil(j.width*g),w=Math.ceil(j.height*g);sg(e,h,w,1);var J=Ye(e);return z=z||this._dataModel.getBackground(),z&&Xl(J,0,0,h,w,z),nc(J,-T,-M),J.scale(g,g),K._42(J),J.restore(),e},toDataURL:function(S,E,$){return this.toCanvas(S,$).toDataURL(E||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(F,J){var U=this,q=U.dm().getBackground();if(q){var P=U.dm().a("width"),W=U.dm().a("height");P>0&&W>0&&Xl(F,0,0,P,W,q)}var m=U.__htmlOrderList,R=[];if(U._93db(F,J),U.each(function(Z){var x=U.getDataUI(Z);if(x){var T=U._56I[Z._id],y=x._htmlView;if(T){var $=x._79o();if(y=x._htmlView,v.HtmlNode&&Z instanceof v.HtmlNode)x._42(F);else{var h=U.getViewRect(),D=y&&y.layoutHTML;!J||zr(J,$)?(D&&(y.layoutHTML(),x.__outerLayout&&delete x.__outerLayout),x._42(F)):zr(h,$)||!D||x.__outerLayout||(y.layoutHTML(),x.__outerLayout=!0)}}y&&(R.push(y),y.getView&&(y=y.getView()),y.style.display=T?"block":rn)}}),m&&R.length>0){var G=!1;if(m.length!==R.length)G=!0;else for(var u=0;u<R.length;u++)if(R[u]!==m[u]){G=!0;break}G&&(R.forEach(function(u){u.autoAdjustIndex!==!1&&U.appendHTML(u,!0)}),this.__htmlOrderList=R)}else this.__htmlOrderList=R;U._92db(F,J)},validateImpl:function(){this.tryUpdateRootData();var s,O,N,U,p,B=this,u=B.tx(),q=B.ty(),D=B._zoom,d=B._canvas,V=this.getWidth(),i=this.getHeight(),z=B._29I,R={x:-u/D,y:-q/D,width:V/D,height:i/D},c={},S=B._34I,Y=B._24I,A=B._32I,k=B._23I;B._24I={},(V!==d.clientWidth||i!==d.clientHeight)&&(sg(d,V,i),A=1),A||Gr(R,z)||(A=1),B._29I=R,B.each(function(h){O=h._id;var X=c[O]=B.isVisible(h);X!==B._56I[O]&&(Y[O]=h,N=B.getDataUI(Y[O]),N&&N._84o(X),B._84o(h,X))},B);for(O in Y)N=B.getDataUI(Y[O]),N&&(!A&&B._56I[O]&&(p=N._79o(),p&&S.add(p)),N.invalidate()),B._83I=1;if(B._56I=c,!A)for(O in Y)c[O]&&(N=B.getDataUI(Y[O]),N&&(p=N._79o(),p&&S.add(p)));if(A?U=R:(S.each(function(o){zr(R,o)&&(U=Jq(U,o))}),U&&(tb(U,P(1,1/D)),U.x=e(U.x*D)/D,U.y=e(U.y*D)/D,U.width=X(U.width*D)/D,U.height=X(U.height*D)/D,U=vo(R,U))),B._74O=U,U){s=Ye(d);var Z=U.x,K=U.y,l=U.width,f=U.height;Z=Math.floor((Z*D+u)*Bh),K=Math.floor((K*D+q)*Bh),l=Math.ceil(l*D*Bh)+1,f=Math.ceil(f*D*Bh)+1,A||(U.x=(Z/Bh-u)/D,U.y=(K/Bh-q)/D,U.width=l/Bh/D,U.height=f/Bh/D),s.beginPath(),s.rect(Z,K,l,f),s.clip(),s.clearRect(Z,K,l,f),Dj(s,u,q,D),B._42(s,U),s.restore(),delete B._74O}if(S.clear(),delete B._32I,k&&V>0&&i>0){var N=B.getDataUI(k);if(N){var p=N._79o(),o=B._29I,J=o.x,I=o.y,j=o.width,n=o.height,D=B._zoom;p&&!zr(p,o)&&(p.x+p.width<J&&B.tx(-p.x*D),p.x>J+j&&B.tx(-(p.x+p.width-j)*D),p.y+p.height<I&&B.ty(-p.y*D),p.y>I+n&&B.ty(-(p.y+p.height-n)*D))}delete B._23I}B._83I&&(delete B._83I,delete B._84I),B._98O(),B.countFrame(),Gi(B._24I)||ve(B.iv,B)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var r,j=this.getFullscreenDatas();for(var V in j)r=j[V],this.scaleRootData(r);this._rootDataUpdating=!1}},scaleRootData:function(j){var a=j.s("fullscreen");if("uniform"===a||"fill"===a){j.getRotation()&&j.setRotation(0);var l=j.s("fullscreen.gap")||0,t=this.getWidth(),N=this.getHeight();if(t&&N){var D,p,r,X=t-2*l,e=N-2*l,q=j.getAnchor(),P=j.getScaledSize(),V=P.width,O=P.height,u=j.s("fullscreen.lock");if(u)return"uniform"===a?X/e>V/O?(D=e/O,V=O*X/e):(D=X/V,O=V*e/X):"v"===u?(D=e/O,V=X/D,j.getWidth()!==V&&j.setWidth(V)):(D=X/V,O=e/D,j.getHeight()!==O&&j.setHeight(O)),this.setZoom(D),p=l-(j.getX()-q.x*V)*D,r=l-(j.getY()-q.y*O)*D,p!==this.tx()&&this.tx(p),r!==this.ty()&&this.ty(r),void 0;p=this.tx(),r=this.ty(),D=this._zoom;var $={x:(-p+l)/D,y:(-r+l)/D,width:X/D,height:e/D};if("uniform"===a){var i=V/O,B=Math.min($.width,$.height*i),m=B/i;$.x+=.5*($.width-B),$.y+=.5*($.height-m),$.width=B,$.height=m}X=$.width/j.getScaleX(),e=$.height/j.getScaleY(),(j.getWidth()!=X||j.getHeight()!==e)&&j.setSize(X,e);var Z=$.x+q.x*$.width,I=$.y+q.y*$.height,z=j.getPosition();(Z!==z.x||I!==z.y)&&j.setPosition(Z,I)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(f){var D=this;f!==D.isScrollBarVisible()&&(f?(Ig(D._view,D._79O=Tj()),Ig(D._79O,D._27I=Tj()),Ig(D._79O,D._28I=Tj())):(mo(D._79O),delete D._79O,delete D._27I,delete D._28I),D.fp("scrollBarVisible",!f,f))},getDebugTip:function(){return""},showScrollBar:function(){var l=this;l._79O&&(l._85I||(V(function(){l._86I()},Ji),l.iv()),l._85I=new Date)},_86I:function(){var Q=this;if(Q._85I){var l=new Date,r=l.getTime();r-Q._85I.getTime()>=Ji?(delete Q._85I,Q.iv()):V(function(){Q._86I()},Ji)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var c=this,V=this._27I,T=this._28I;if(c._79O){if(c._autoHideScrollBar&&!c._85I)return V.style.visibility=ui,T.style.visibility=ui,void 0;var y=c.getScrollBarColor(),g=c._zoom,l=c.getScrollBarSize(),F=c.getViewRect(),z=c.getScrollRect(),q=F.height*g,b=z.height*g,i=F.width*g-l-2,e=q*((F.y-z.y)*g/b),C=q*(q/b),r=V.style;b-.5>q?(ln>C&&(e=e+C/2-ln/2,0>e&&(e=0),e+ln>q&&(e=q-ln),C=ln),Op(V,i,e,l,C),r.visibility=wr,r.background=y,r.borderRadius=l/2+kh):r.visibility=ui;var Q=F.width*g,_=z.width*g,e=F.height*g-l-2,i=Q*((F.x-z.x)*g/_),J=Q*(Q/_),r=T.style;_-.5>Q?(ln>J&&(i=i+J/2-ln/2,0>i&&(i=0),i+ln>Q&&(i=Q-ln),J=ln),Op(T,i,e,J,l),r.visibility=wr,r.background=y,r.borderRadius=l/2+kh):r.visibility=ui}},setDataModel:function(_){var M=this,a=M._dataModel,B=M._selectionModel;a!==_&&(a&&(a.ump(M.handleDataModelPropertyChange,M),a.umm(M.handleDataModelChange,M),a.umd(M.handleDataPropertyChange,M),a.removeIndexChangeListener(M._75O,M),a.removeHierarchyChangeListener(M.handleHierarchyChange,M),B||a.sm().ums(M.handleSelectionChange,M)),M._dataModel=_,_.mp(M.handleDataModelPropertyChange,M),_.mm(M.handleDataModelChange,M),_.md(M.handleDataPropertyChange,M),_.addIndexChangeListener(M._75O,M),_.addHierarchyChangeListener(M.handleHierarchyChange,M),B?B._21I(_):_.sm().ms(M.handleSelectionChange,M),M.invalidateAll(!0),M.fp(gq,a,_),M.updateBackground())
},getLayersInfo:function(){if(this._layersInfo===Q){var g=this.getLayers();g?(this._layersInfo={},g.forEach(function(D){var J=nd(D)?D.name:D;this._layersInfo[J]=D},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(y,Q,r){var n,t,T=this,g=T.getDataUI(y),q=Fn(g),v=sd(Q,function(J){return Sn(q,100*J)},100,.001),U=Sn(q,100*v);if(!r){var K=Cc(g),$=new xi(U.x,U.y),I=49/(T._zoom*T._zoom);for(n=0,t=K.length;t>n;n++)if($.distanceToSquared(K[n])<I)return{index:n,point:K[n],distance:Math.sqrt((K[n].x-Q.x)*(K[n].x-Q.x)+(K[n].y-Q.y)*(K[n].y-Q.y))}}return{percent:v,point:U,distance:Math.sqrt((U.x-Q.x)*(U.x-Q.x)+(U.y-Q.y)*(U.y-Q.y))}},calculateAttachPoint:function(){var e=new xi,a=new xi,s=new xi;return function(E,q){var i=this.getAttachPoints(E);if(!i||!i.length)return null;s.set(q.x,q.y);for(var j,h,k,X,A,R=1/0,z=0,Y=i.length;Y>z;z++)k=i[z],a.x=k.x,a.y=k.y,e.x=k.offsetX||0,e.y=k.offsetY||0,X=ik(this,E,0,e.x,e.y,a.x,a.y),h=s.distanceToSquared(X),R>h&&(j=z,R=h,A=X);R=Math.sqrt(R);var L=this.getAttachStyle(E);if("close"===L){var r=E.s("attach.close.threshold")/this._zoom;if(R>r)return null}return{index:j,distance:R,info:i[j],point:A}}}(),getAttachPoints:function(V){var t=V.s("attach.points");if(t)return t;var u=Bn(V._image);return u?Nq(u.attachPoints,V,this)||null:void 0},getAttachStyle:function(w){var i=w.s("attach.style");if(i)return i;var n=Bn(w._image);return n?Nq(n.attachStyle,w,this)||"close":void 0},updateLayers:function(){this._layersInfo=Q,this.invalidateSelection(),this.redraw()},updateBackground:function(){var c=this.dm().a("width"),J=this.dm().a("height");this._canvas.style.background=c>0&&J>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(R){if("background"===R.property){var n=this._canvas.style.background,z=R.newValue||"";this.updateBackground(),this.fp("canvasBackground",n,z),this.redraw()}else"a:width"===R.property||"a:height"===R.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===R.property?this.updateLayers():"hierarchicalRendering"===R.property&&this.redraw()},handleDataPropertyChange:function(q){this.dm().isHierarchicalRendering()&&"parent"===q.property&&q.data.hasChildren()&&this.redraw(),this.invalidateData(q.data)},onPropertyChanged:function(d){var w=this,m=d.property;if(w.redraw(),"zoom"===m){var I=w.sm().getSelection();I.size()&&I.each(function(d){d.invalidate()})}else"dataModel"===m&&(w._83I=1);of[m]?w.showScrollBar():m===Bs&&w.onCurrentSubGraphChanged(d)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(N){var n=this,b=N.kind,k=N.data;if(n._83I=1,"add"===b)n.invalidateData(k),Xm(k)&&k.getEdgeGroup()&&k.getEdgeGroup().eachSiblingEdge(n.invalidateData,n);else if(b===Wg){n._21Q(k);var x=k._id,W=n._25I[x];if(W){if(n._56I[x]){var C=W._79o();C&&n.redraw(C)}W.dispose(),delete n._25I[x],delete n._24I[x],delete n._56I[x]}k===n._currentSubGraph&&n.setCurrentSubGraph(I)}else b===qb&&(n.invalidateAll(!0),n.setCurrentSubGraph(I))},_75O:function(S){this.invalidateData(S.data)},handleHierarchyChange:function(H){this.dm().isHierarchicalRendering()&&H.data.hasChildren()&&this.redraw(),this.invalidateData(H.data)},adjustIndex:function(p){var A=this;if(A.isVisible(p)){A.dm().beginTransaction();for(var C=p;C._parent&&A.isVisible(C._parent);)C=C._parent;C&&C!==p&&A._dataModel.adjustIndex(C),A._dataModel.adjustIndex(p),A.dm().endTransaction()}},getImage:function(q){return q.getImage?q.getImage():Q},getSelectWidth:function(G){var b=Bn(this.getImage(G));return b&&Nq(b.disableSelectedBorder,G,this)?0:G.s("select.width")},getSelectColor:function(h){return h.s("select.color")},isSelectable:function(W,m){if(this.isSelected(W))return!0;if(!m&&W.getParent()instanceof Ml&&this.isSelectable(W.getParent(),!0)&&W.getParent().isSyncSize())return!1;var a=this.getLayersInfo();if(a){var v=a[W._layer];if(v&&v.selectable===!1)return!1}return W.s("2d.selectable")&&this.sm().isSelectable(W)},isMovable:function(R){var a=this;if(Xm(R)&&R.getStyle(Cr)!==Ar)return!1;var n=this.getLayersInfo();if(n){var K=n[R._layer];if(K&&K.movable===!1)return!1}return R.s("2d.movable")?a._movableFunc?a._movableFunc(R):!0:!1},isEditable:function(R){var r=this;if(v._uiSerializing)return r._uieditable;if(!r._editInteractor||!r.isSelected(R))return!1;if(Rn(R)){var p=r.getDataUI(R);if(!p||p._88I)return!1}if(Xm(R)&&R.getStyle(Cr)!==Ar)return!1;var n=this.getLayersInfo();if(n){var Z=n[R._layer];if(Z&&Z.editable===!1)return!1}return R.s("2d.editable")?r._editableFunc?r._editableFunc(R):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(N){return Fg(N)&&0!==N.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(N):!0},isRectEditable:function(u){return this._rectEditableFunc?this._rectEditableFunc(u):!0},isAnchorEditable:function(N){return this._anchorEditableFunc?this._anchorEditableFunc(N):!0},isRotationEditable:function(C){return C.setRotation&&C.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(C):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(p){var s=p.getAnchor(),v=p.getScale(),n=this._zoom,E=$o(p.getRotation(),0,-p.getHeight()*v.y*s.y-(v.y<0?-1:1)*(Jm?32:16)/n),I=p.p();return E.x+=I.x,E.y+=I.y,E},getLogicalPoint:function(C){var p=this;return pq(C,p._canvas,p.tx(),p.ty(),p._zoom,p._zoom)},getScreenPoint:function(N,K){var $,M=this;return"object"==typeof N?N.x!==Q?($=N.x,K=N.y):($=N[0],K=N[1]):$=N,ze($,K,M._canvas,M.tx(),M.ty(),M._zoom,M._zoom)},getSelectedDataAt:function(X){var B=this;return this.getDataAt(X,function(k){return B.isSelected(k)})},getDataInfoAt:function(M,e,x){var t,Q=this.lp(M),r=this.getDataAt(Q,e,x);if(r){var _=this.getDataUI(r);t={data:r,ui:_,point:Q};var i=_._38o;if(i){var F=i.icons;for(var g in F){var W=F[g],L=i.rects[g];if(L)for(var B=Nq(W.names,r,this),z=B?B.length:0,R=L.rotation,H=z-1;H>=0;H--){var K=B[H],n=L[H];if(Vl(n,Q,R))return t.part="icons",t.name=g,t.icon=K,t.rect=n,t.index=H,t.rotation=R,t}}}if(this.isNoteVisible(r)){if(_.note2Info&&Vl(_.note2Info.clickRect,Q,I,_.note2Info.scale))return t.part="note2",t;if(_.noteInfo&&Vl(_.noteInfo.clickRect,Q,I,_.noteInfo.scale))return t.part="note",t}if(this.isLabelVisible(r)){if(_.label2Info&&Vl(_.label2Info.rect,Q,_.label2Info.rotation,_.label2Info.scale))return t.part="label2",t;if(_.labelInfo&&Vl(_.labelInfo.rect,Q,_.labelInfo.rotation,_.labelInfo.scale))return t.part="label",t}if(r.isInRect&&r.isInRect(Q))return t.part="body",t}return t},getDataAt:function(A,W,h){A.target&&(A=this.lp(A));var $,Z=this._zoom;return this.reverseEach(function(r){return(W?W(r):this.isSelectable(r))&&this.rectIntersects(r,Lk(A.x,A.y,h,Z))?($=r,!1):void 0},this),$},getIconInfoAt:function(k,R){var M=this;if(k.target&&(k=M.lp(k)),R||(R=M.getDataAt(k)),R){var W=M.getDataUI(R);if(W&&W._38o){var V,v=W._38o,K=new up;for(V in v.icons)K.add(V);for(var A=K.size()-1;A>=0;A--){V=K.get(A);for(var r=v.rects[V],B=r.rotation,g=r.length-1;g>=0;g--){var j=r[g],Z=j.width,J=j.height,m={x:k.x-j.x-Z/2,y:k.y-j.y-J/2};B!=I&&(m=$o(-B,m.x,m.y));var j={x:-Z/2,y:-J/2,width:Z,height:J};if(Vl(j,m))return{key:V,index:g,name:v.icons[V].names[g],rect:r[g],point:k,rotation:B,relativeRect:j,relativePoint:m,data:R}}}}}return I},getDatasInRect:function(X,F,e){e===Q&&(e=1);var f=this,y=new up;return f.reverseEach(function(n){e&&!f.isSelectable(n)||(F?f.rectIntersects(n,X):f.rectContains(n,X))&&y.add(n)}),y},moveSelection:function(z,Q){var d=this;d.dm().beginTransaction(),Je(d.sm().toSelection(d.isMovable,d),z,Q),d.dm().endTransaction()},moveDatas:function(u,d,R){var X=this;X.dm().beginTransaction(),u instanceof up||(u=new up(u)),Je(u,d,R),X.dm().endTransaction()},getDataUIBounds:function(F){var q=this.getDataUI(F);return q?q._79o():I},drawData:function(h,A,K){var c=this.getDataUI(A);if(c){var F=c._79o();(!K||zr(K,F))&&(c._42(h),A instanceof v.Block&&A.eachChild(function(z){this.drawData(h,z,K)},this))}},getBoundsForGroup:function(z){return z.s(pp)?this.getDataUIBounds(z):I},isPixelPerfect:function(q){return q.s("pixelPerfect")},rectIntersects:function(_,x){this.validate();var $=I;if(this._56I[_._id]){var q=this._25I[_._id];if(q){var r=q._79o();if(Zp(x,r))$=!0;else if((x=vo(x,r))&&(q.rectIntersects&&($=q.rectIntersects(x)),$==I)){if(!this.isPixelPerfect(_))return!0;var b=x.x,G=x.y,z=x.width,B=x.height,e=this._zoom,p=t.hitMaxArea,M=z*B*e*e;if(M>p){var c=Math.sqrt(p/M);e*=c}z*=e,B*=e,2>z&&(z=2),2>B&&(B=2),b*=e,G*=e;var R=qd(z,B);nc(R,-b,-G),R.scale(e,e),this._drawForChecking=!0,this.drawData(R,_,x),this._drawForChecking=!1;try{for(var N=0,i=R.getImageData(0,0,z,B).data;N<i.length;N+=4)if(0!==i[N+3]){$=!0;break}R.restore()}catch(W){sm=I,$=!1}}}}return $?!0:!1},rectContains:function(i,o){if(this._56I[i._id]){var X=this._25I[i._id];if(X)return Zp(o,X._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(U){if(!t.isInput(U.target)){var Z=this,W=Z._focusData,N=W&&Z._25I[W._id],J=0,m=Z._dataModel._datas;if(!(W&&W._enabled&&W._editable&&N&&N.onKeyDown&&N.onKeyDown(U)===!0))if(9===U.keyCode&&(W&&(J=m.indexOf(W),Kh(U)?-1===--J&&(J=0):++J===m.size()&&(J=0)),Z._focusData=W=m.get(J),Z.sm().setSelection(W)),Fq(U)?Z.selectAll():vp(U)&&Z.isResettable()&&Z.reset(),Z.sm().isEmpty()){if(Z._editing)return;var Y=Z.tx(),F=Z.ty(),s=!1,P=Kh()?100:10;Zo(U)&&(Y-=P,s=!0),dk(U)&&(F-=P,s=!0),ip(U)&&(Y+=P,s=!0),nr(U)&&(F+=P,s=!0),s&&Z.setTranslate(Y,F)}else{wq(U)&&Z.handleDelete(U);var T=Kh()?10:1;Zo(U)&&(Z.moveSelection(-T,0),Z.fi({kind:"moveLeft"})),dk(U)&&(Z.moveSelection(0,-T),Z.fi({kind:"moveUp"})),ip(U)&&(Z.moveSelection(T,0),Z.fi({kind:"moveRight"})),nr(U)&&(Z.moveSelection(0,T),Z.fi({kind:"moveDown"}))}}},handleScroll:function(h,V){if(Rg(h),this.isZoomable()){if(!this.getEditInteractor()){var z=this.getDataAt(h);if(z){var C=Bn(this.getImage(z));if(C&&Nq(C.scrollable,z,this))return}}var H=this.lp(h);V>0?this.scrollZoomIn(H):0>V&&this.scrollZoomOut(H)}},handlePinch:function(W,V,b){this.isZoomable()&&(V>b?this.pinchZoomIn(W):this.pinchZoomOut(W))},checkDoubleClickOnNote:function(g,o){var X=this,J=X.lp(g),l=X.getDataUI(o),S=l.note2Info;return S&&o.s("note2.toggleable")&&Vl(S.clickRect,J)?(o.s(ch,!o.s(ch)),X.fi({kind:"toggleNote2",event:g,data:o}),!0):(S=l.noteInfo,S&&o.s("note.toggleable")&&Vl(S.clickRect,J)?(o.s(an,!o.s(an)),X.fi({kind:"toggleNote",event:g,data:o}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(q,Q){var U=this,V=U.getAutoScrollZone(),L=V/U.getZoom(),E=V/4,M=U._29I,y=U.lp(q),O={x:U.tx(),y:U.ty()};return y&&V>0&&M&&(y.x-M.x<L?U.translate(E,0):M.x+M.width-y.x<L&&U.translate(-E,0),y.y-M.y<L?U.translate(0,E):M.y+M.height-y.y<L&&U.translate(0,-E)),O.x=U.tx()-O.x,O.y=U.ty()-O.y,Q&&(Q.x+=O.x,Q.y+=O.y),O},getMoveMode:function(M,O){var w=O.s("2d.move.mode");return w?w:Le["88"]?"x":Le["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(N,W,K){var l=this;return"currentSubGraph"===W?{__i:N.getId()}:K.serializeProperty(N,W,l)},deserializeProperty:function(v,B,y){var G=this;if("currentSubGraph"===B){var i=G.dm(),$=i.__idMap;return $[v.__i]}return y.deserializeProperty(v,B,G)},setDefaultCursor:function(g,U){this._defaultCursor=g,U!==!1&&this.setCursor(g)},setCursor:function(Y){"default"===Y&&(Y=this._defaultCursor||Y);var b=this.getView().style;b.cursor=Y,b.cursor="-webkit-"+Y,b.cursor="-moz-"+Y},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(o){return o===I||t.getConnectAction(null,o)?(this._currentActionType=o,this.redraw(),!0):!1},getEditStyle:function(C){var $=this.getEditInteractor();return $?$.getStyle(C):Q},setEditStyle:function(l,p,k){var G=this.getEditInteractor();return G?(G.setStyle(l,p,k),!0):!1},isConnectActionVisible:function(F){var B=t.getConnectAction(this);if(!B)return!1;var O=B.visible;return qi(O)&&(O=O(this,F)),O},isInteractive:function(y){if(this._drawForChecking)return!1;var c=Bn(this.getImage(y));return c&&Nq(c.interactive,y,this)?!0:y.s("interactive")},appendHTML:function(P,M){var s=this.getView();if(!(M||P&&P.parentNode!==s))return!1;var B=P.getView&&P.getView();if(!M&&B&&B.parentNode===s)return!1;(P.getView||P.isSelfViewEvent)&&(P=P.getView());var l=this.getEditInteractor();return l&&l._canvas?s.insertBefore(P,l._canvas):this.isScrollBarVisible()?s.insertBefore(P,this.getView().lastChild):Ig(s,P),!0},_layoutHTMLImpl:function(W,w,H){if(arguments.length>1){var F,l=this,E=l._zoom;if(w.getView&&(F=w,w=w.getView()),w.style.position="absolute",H){var B=W.getRect();Op(F||w,l.tx()+B.x*E,l.ty()+B.y*E,B.width*E,B.height*E)}else{var T=new As,B=W.getAnchorRect(),A=W.getPosition(),h=W.getScale(),X=w.style;Op(F||w,B),T.appendTranslate(l.tx(),l.ty()),T.appendScale(E,E),T.append(new As(W.getRotation(),A.x,A.y,h.x,h.y)),$p(X,"transform","matrix("+T.a.toFixed(5)+", "+T.b.toFixed(5)+", "+T.c.toFixed(5)+",\n    "+T.d.toFixed(5)+", "+T.tx.toFixed(5)+", "+T.ty.toFixed(5)+")"),$p(X,"transformOrigin",(-B.x).toFixed(5)+"px "+(-B.y).toFixed(5)+"px"),w.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(k){return k instanceof Pd?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(b){var Q="state",Y=b.s(Q);if(Y)return Y;var W=Bn(b._image);return W?Nq(W[Q],b,this)||null:void 0},getShape:function(N){return N.getStyle(Oe)}}),Y.defineProperties(om.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(d){this._layoutHTML=d}}});var Jj=function(j,n){var x=this;x.gv=j,x.s=function(N){return n.getStyle(N)},x._data=n,x._87I=new up};Rq(Jj,Y,{_6I:I,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var R=this,F=R.gv.isSelected(R._data);return!F||R.isShadowed()?0:R.gv.getSelectWidth(R._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(b){var R=this._data,L=this.gv.getBodyColor(R);return L?L:b?R.getStyle(b):I},_2Q:function(y){return this.s(y)},_1Q:function(d,L,z,N){var M=this.s,K=M("2d.gray"),v=M(L+".dash.color");if(K&&(v=t.toGrayColor(v)),d.strokeStyle=v,d.lineWidth=z,d.stroke(),M(L+".dash.3d")){var U=M(L+".dash.3d.color");Qo(d,v,K?t.toGrayColor(U):U,z,this.gv._zoom,M(L+".dash.3d.accuracy"))}ol(d,N)},invalidate:function(){this._6I=I},_79o:function(){var O=this;if(!O._6I){var K=O._data,S=O.gv;O.labelInfo=O.label2Info=O.noteInfo=O.note2Info=O._38o=I,O._87I.clear(),O.interactiveInfo=S.isInteractive(K)?{}:I,O._3O(),O._55O=S.isEditable(K)?{_42O:S.isRectEditable(K),_43O:S.isPointEditable(K),_56O:S.isRotationEditable(K)}:I,O._6I=O._81o()}return O._6I},_3O:function(){},getPosition:function(){return Xq},_68o:function(y,h){y&&this._87I.add(oc(y,h))},_81o:function(){var M=this,S=M.s;M._24O(Ef,"getLabel"),M._24O(fj,"getLabel2"),M._26O(vd,"getNote"),M._26O(Lq,"getNote2"),M._15O(),M._55O&&M._48O();var w;if(M._87I.each(function(O){w=Jq(w,O)}),w&&M.isShadowed()){var f=Gk(w);f.x+=S("shadow.offset.x"),f.y+=S("shadow.offset.y"),tb(f,S("shadow.blur")),w=Jq(w,f)}return M._87I.clear(),w},_42:function(n){var i=this,C=i._data,A=i.gv,W=i.s,N=W("opacity"),_=this.isShadowed();if(_){var G=n.shadowOffsetX,z=n.shadowOffsetY,D=n.shadowBlur,U=n.shadowColor,a=A.getZoom();n.shadowOffsetX=W("shadow.offset.x")*a,n.shadowOffsetY=W("shadow.offset.y")*a,n.shadowBlur=W("shadow.blur")*a,n.shadowColor=i.getSelectColor()}if(N!=I){var $=n.globalAlpha;n.globalAlpha=N}i._80o(n),A.isLabelVisible(C)&&((!A._drawForChecking||W("label.selectable"))&&Tc(n,i.labelInfo),(!A._drawForChecking||W("label2.selectable"))&&Tc(n,i.label2Info)),A.isNoteVisible(C)&&(af(n,i.noteInfo),af(n,i.note2Info)),i._99O(n),N!=I&&(n.globalAlpha=$),_&&(n.shadowOffsetX=G,n.shadowOffsetY=z,n.shadowBlur=D,n.shadowColor=U)},_80o:function(){},_47O:function(){},_24O:function(t,$){var Q=this,w=Q._data,n=Q.gv,A=Q.s,q=n[$](w);if(q!=I){var u=A(t+".scale"),C=A(t+".max"),v=A(t+".position"),P=Q[t+"Info"]={label:q,scale:u,color:n[$+"Color"](w),font:A(t+".font"),opacity:A(t+".opacity"),align:A(t+".align"),rotation:Q.getRotation(A(t+".rotation"),!1,v),background:n[$+"Background"](w)},e=fo(P,q);C>0&&C<e.width&&(P.labelWidth=e.width,e.width=C),1!==u&&(e.width*=u,e.height*=u);var H=Q.getPosition(v,A(t+".offset.x"),A(t+".offset.y"),e,A(t+".position.fixed"));if(e.x=H.x-e.width/2,e.y=H.y-e.height/2,Q._68o(P.rect=e,P.rotation),1!==u){var Z=e.width/u,V=e.height/u;P.rect={x:H.x-Z/2,y:H.y-V/2,width:Z,height:V}}}},_26O:function(e,F){var S=this,W=S.gv,T=S._data,U=S.s,K=W[F](T);if(K!=I){var w,z,f=U(e+".scale"),l=S[e+"Info"]={note:K,scale:f,data:T,view:W,expanded:U(e+".expanded"),font:U(e+".font"),color:U(e+".color"),opacity:U(e+".opacity"),align:U(e+".align"),icon:U(e+".icon"),backgroundImage:U(e+".backgroundImage"),borderWidth:U(e+".border.width"),borderColor:U(e+".border.color"),background:W[F+"Background"](T)},Q=S.getPosition(U(e+".position"),U(e+".offset.x"),U(e+".offset.y")),k=Q.x,L=Q.y;if(l.expanded){var r,y=U(e+".max"),s=U(e+".backgroundImage");s?(s=Bn(s),r={width:vk(s,T),height:ns(s,T)}):r=fo(l,K),r.width+=6,r.height+=2,y>0&&y<r.width&&(l.labelWidth=r.width,r.width=y),w=r.width,z=r.height+8,l.clickRect={x:k-w*f/2,y:L-z*f,width:w*f,height:z*f*r.height/z}}else{var c=U(e+".icon");c?(c=Bn(c),w=vk(c,T),z=ns(c,T)):(w=12,z=18),l.clickRect={x:k-w*f/2,y:L-z*f,width:w*f,height:z*f}}l.rect={x:k-w/2,y:L-z*f/2-z/2,width:w,height:z};var t=X(l.borderWidth/2)*f;S._68o({x:k-w*f/2-t,y:L-z*f-t,width:w*f+2*t,height:z*f+2*t})}},_48O:function(){},_99O:function(c){var t=this,e=t._38o;if(e){var S=t.gv,x=t._data,G=e.icons,g=t.interactiveInfo;g&&(g._38o={});for(var v in G){var F=G[v],j=e.rects[v];if(j){g&&(g._38o[v]=[]);var l=Nq(F.opacity,x,S),E=Nq(F.names,x,S),i=E?E.length:0,b=j.rotation;if(l!=I){var L=c.globalAlpha;c.globalAlpha*=l}for(var Z=0;i>Z;Z++){var y=E[Z],D=Bn(y),Y=j[Z];if(b){var _=Y.x+Y.width/2,k=Y.y+Y.height/2;c.save(),nc(c,_,k),Ur(c,b),nc(c,-_,-k)}g&&g._38o[v].push(c.interactiveInfo={compInfos:[],matrix:b?new As(b,_,k).appendTranslate(-_,-k):new As}),ck(c,D,Nq(F.stretch,x,S),Y.x,Y.y,Y.width,Y.height,t._data,t.gv),c.interactiveInfo=I,b&&c.restore()}l!=I&&(c.globalAlpha=L)}}}}});var Vn=function(x,I){mj(Vn,this,[x,I])};Rq(Vn,Jj,{_checkEmptyRect:!0,_40O:function(A,O){var q=this,w=q.s,L=A.rect;(A.borderColor=q.gv.getBorderColor(q._data))&&(A.borderType=w("border.type"),A.borderWidth=w("border.width"),A.borderPadding=w("border.padding"),O=P(O,A.borderPadding+A.borderWidth/2));var p=q._data.getScale(),y=P(1,P(H(p.x),H(p.y)));if(A.selectWidth=q.getSelectWidth()){var r=q.gv._zoom;A.selectType=w("select.type"),A._97o=q.getSelectColor(),A.selectPadding=w("select.padding"),O=P(O,(A.selectPadding+A.selectWidth/2/r)/y)}O>0&&(O*=y,L=Gk(L),tb(L,O)),q._68o(L)},_39O:function(O,n){var b,f=this,o=n.rect;if(n.borderWidth>0&&(b=n.borderPadding,O.strokeStyle=n.borderColor,O.lineWidth=n.borderWidth,Fr(O,n.borderType,{x:o.x-b,y:o.y-b,width:o.width+2*b,height:o.height+2*b}),O.stroke()),n.selectWidth>0){var d=f.gv._zoom;if(b=n.selectPadding,O.strokeStyle=n._97o,O.lineWidth=n.selectWidth/d,n.rotation!=I){O.save(),O.translate(n.position.x,n.position.y),O.rotate(n.rotation);var m=f._data,F=m.getWidth(),U=m.getHeight(),E=n.scale,P=n.anchor;o={x:E.x*-F*P.x,y:E.y*-U*P.y,width:E.x*F,height:E.y*U}}Fr(O,n.selectType,{x:o.x-b,y:o.y-b,width:o.width+2*b,height:o.height+2*b}),n.rotation!=I&&O.restore(),O.stroke()}},dispose:function(){var S=this,C=S._htmlView;Vn.superClass._3O.call(S),C&&(C.onHTMLRemoved&&C.onHTMLRemoved(),mo(C))},_3O:function(){var B=this,q=B.s,z=B._data,k=B.gv,J=k.getShape(z),l=B.getBodyColor(),i=B._83o=J?{shape:J,_53o:B.getBodyColor("shape.background"),_27Q:Bn(q("shape.repeat.image"),l),shapeGradientPack:q("shape.gradient.pack"),_54o:q("shape.border.width"),_55o:q("shape.border.color"),_56o:q("shape.border.3d"),_57o:q("shape.border.3d.color"),_58o:q("shape.border.3d.accuracy"),shapeGradient:q("shape.gradient"),_59o:q("shape.gradient.color"),_60o:q("shape.border.pattern"),_61o:q("shape.border.cap"),_62o:q("shape.border.join"),shapeForeground:q("shape.foreground"),bodyColor:l,gray:q("2d.gray")}:{img:Bn(k.getImage(z),l),bodyColor:l,gray:q("2d.gray"),stretch:q("image.stretch")};if(d&&!u);else{var j,c=i.img;c&&c.renderHTML?(B._htmlInfo&&B._htmlInfo.img!==c&&(B._htmlInfo=I),B._htmlInfo||(B._htmlInfo={img:c,cache:{}}),j=c.renderHTML(z,k,B._htmlInfo.cache)):B._htmlInfo=I,B._htmlView&&B._htmlView!==j&&(B._htmlView.onHTMLRemoved&&B._htmlView.onHTMLRemoved(),mo(B._htmlView.getView?B._htmlView.getView():B._htmlView)),(B._htmlView=j)&&k.appendHTML(j)&&(j.onHTMLAddedSync&&j.onHTMLAddedSync(),j.onHTMLAdded&&ve(j.onHTMLAdded)),i.rect=z.getRect(),i.position=z.p(),i.scale=z.getScale(),i.anchor=z.getAnchor(),i.rotation=z.getRotation(),J===qn&&(i._63o=q("shape.depth"));var S=0;if(J)S=en(I,i._54o/2,i._62o),B.s("shape.dash")&&(S=P(S,(B.s("shape.dash.width")||i._54o)/2));else if(c&&c.boundExtend)if(S=Nq(c.boundExtend,z,k),c.boundExtendAbsolute){var t=z.getScale();S/=k._zoom*P(1,P(H(t.x),H(t.y)))}else if(!Nq(c.fitSize,z,k)){var T=Nq(c.width,z,k),V=Nq(c.height,z,k);S*=P(z.getWidth()/T,z.getHeight()/V)}B._40O(i,S);var E=q("clip.percentage");if(1>E&&(0>E&&(E=0),i.clipRect=ir(z.getAnchorRect(),q("clip.direction"),E)),J){var v=q("shape.fill.clip.percentage");1>v&&(0>v&&(v=0),i.shapeClipRect=ir(z.getAnchorRect(),q("shape.fill.clip.direction"),v));var Y=q("shape.foreground.clip.percentage");1>Y&&(0>Y&&(Y=0),i.shapeForegroundClipRect=ir(z.getAnchorRect(),q("shape.foreground.clip.direction"),Y))}}},getPosition:function(t,g,A,y){var Q=Ke(t,this._83o.rect,y);return Q.x+=g,Q.y+=A,Q},_80o:function(H){var F=this,m=F.s,u=F.gv,Q=F._data,D=F._83o,L=D.rect,T=D.position,e=D.rotation,w=D.anchor,Z=D.scale,y=D.shape,h=D.clipRect;if(!F._checkEmptyRect||L.width>0&&L.height>0){var $=Q.getSize();if($.x=-$.width*w.x,$.y=-$.height*w.y,H.save(),nc(H,T.x,T.y),Ur(H,e),Rl(H,Z.x,Z.y),h&&(H.beginPath(),H.rect(h.x,h.y,h.width,h.height),H.clip()),u._drawForChecking&&D.img&&Nq(D.img.pixelPerfect,Q,u)===!1)Xl(H,$.x,$.y,$.width,$.height,"#888888");else if(F.freeDraw)F.freeDraw(H,$,D);else if(y){var M,E,o,S,c=D._60o,i=Zl(H,c),C=D._27Q,z=D._54o,k=D.shapeGradientPack,s=D.gray,f=H.lineJoin,G=H.lineCap,d=function(c){return s?t.toGrayColor(c):c};"roundRect"===y?M=m("shape.corner.radius"):"polygon"===y?M=m("shape.polygon.side"):"arc"===y&&(M=m("shape.arc.from"),E=m("shape.arc.to"),o=m("shape.arc.close"),S=m("shape.arc.oval")),H.lineJoin=D._62o,H.lineCap=D._61o;var X=d(D._53o);if(X||C||k){var j=D.shapeClipRect;j&&(H.save(),H.beginPath(),H.rect(j.x,j.y,j.width,j.height),H.clip()),Fr(H,y,$,M,E,o,S),k?Wo(H,k):C?ko(H,C,d(D.bodyColor),null,Q,u):yh(H,X,D.shapeGradient,d(D._59o),$),H.fill(),j&&H.restore(),k&&H.restore(),H!==i&&Fr(i,y,$,M,E,o,S)}else Fr(i,y,$,M,E,o,S);var N=D.shapeForeground;if(N){H.save();var U=D.shapeForegroundClipRect;U&&(H.beginPath(),H.rect(U.x,U.y,U.width,U.height),H.clip()),Fr(H,y,$,M,E,o,S),yh(H,N,m("shape.foreground.gradient"),d(m("shape.foreground.gradient.color")),$),H.fill(),H.restore()}if(z>0){var O=m("shape.border.width.absolute");O&&(H.save(),H.setTransform(1,0,0,1,0,0)),H.lineWidth=z;var l=d(D._55o);H.strokeStyle=l,H.stroke(),O&&H.restore(),D._56o&&Qo(H,l,d(D._57o),z,u._zoom,D._58o)}if(ol(H,c),m("shape.dash")){var W=m("shape.dash.width")||z;if(W>0){c=m("shape.dash.pattern");var i=Zl(H,c,F._2Q("shape.dash.offset"));i!==H&&Fr(i,y,$,M,E,o,S),F._1Q(H,"shape",W,c)}}Zq(H,X,D._63o,$),H.lineJoin=f,H.lineCap=G}else{var K=F.interactiveInfo;K&&(H.interactiveInfo=K.bodyInfo={compInfos:[],matrix:new As(e,T.x,T.y,Z.x,Z.y)}),D.gray&&(H.compGray=!0);var Y=D.img;Y&&Y.cacheRule!=I&&(Y=If(H,Y,D.stretch,$.width,$.height,Q,u,D.bodyColor)),ck(H,Y,D.stretch,$.x,$.y,$.width,$.height,Q,u,D.bodyColor),H.compGray=!1,H.interactiveInfo=I}H.restore()}F._39O(H,D)},_48O:function(){},_47O:function(){}});var Gb=function(m,R){mj(Gb,this,[m,R])},$h=function(H,L,l,J){var v=Oj(H,L);return l=J?r(l,v):id(l,v),v?l/=v:l=0,{x:H.x+(L.x-H.x)*l,y:H.y+(L.y-H.y)*l}};Rq(Gb,Jj,{_3O:function(){var F,x=this,w=x._data,q=x.gv,_=x.s,B=_(Cr),R=w.isLooped(),M=_("edge.width"),c=_("edge.center"),T=_("edge.offset"),z=q.getBorderColor(w),s=z?_("border.width"):0,l=x.getSelectWidth(),E=w._40I,U=w._41I,H=x._78o=E&&U?{looped:R,type:B,width:M,center:c,color:x.getBodyColor("edge.color"),borderColor:z,borderWidth:s,_97o:l?x.getSelectColor():I,selectWidth:l,pattern:_("edge.pattern"),cap:_("edge.cap"),join:_("edge.join"),is3d:_("edge.3d"),_67o:_("edge.3d.color"),_66o:_("edge.3d.accuracy"),gray:_("2d.gray")}:I;if(H){var a=t.getEdgeType(B);if(a){var K=a(w,Pc(x,q,w,R,B),q,x._19Q);K.points&&K.points.size()>1?(H.edgeTypeInfo=K,F=Hj(H.edgeTypeInfo.points)):K[Wn]&&K.rect&&(H.edgeTypeInfo=K,F=K.rect)}else{var D=_("edge.source.anchor.x"),j=_("edge.source.anchor.y"),W=_("edge.target.anchor.x"),p=_("edge.target.anchor.y"),V=Kg(q,w,"source"),i=Kg(q,w,"target");if(B===Ar){var C=H.points=_(Ie)||bc,G=C.size();H.segments=_("edge.segments");var g=D!==Q||j!==Q||Xm(E),e=W!==Q||p!==Q||Xm(U);if(!c)if(T)g||(V=$h(V,G?C.get(0):i,T,G)),e||(i=$h(i,G?C.get(G-1):V,T,G));else{var r;g||(r=ti(V,G?C.get(0):i,Pb(q,E)),r&&(V={x:r[0],y:r[1]})),e||(r=ti(G?C.get(G-1):V,i,Pb(q,U)),r&&(i={x:r[0],y:r[1]}))}F=Jq(Hj(H.points),Hj(V,i))}else{var Y=Pc(x,q,w,R,B);if(x._19Q||(Y=-Y),R)V=Gk(V),V.x=q.getNodeRect(E).x,H.radius=Y,F={x:V.x-Y,y:V.y-Y,width:2*Y,height:2*Y};else{var h=Oj(V,i),J=id(T,h),A={x:J,y:Y},L={x:h-J,y:Y},v=$(i.y-V.y,i.x-V.x),u=H.mat=new xs(v);if(H.orienAngle=v,H.angle=i.x<V.x?v+k:v,H.rect={x:A.x,y:A.y,width:L.x-A.x,height:0},H.origin=V,A=u.tf(A),A.x+=V.x,A.y+=V.y,L=u.tf(L),L.x+=V.x,L.y+=V.y,c){var m={x:h,y:0};m=u.tf(m),m.x+=V.x,m.y+=V.y,F=Hj([V,A,L,m]),H.c1=V,H.c2=m}else F=Hj(A,L);V=A,i=L}}H.sourcePoint=V,H.targetPoint=i,w._lastSourcePoint=V,w._lastTargetPoint=i}var X=0;_("edge.dash")&&(X=_("edge.dash.width")||M);var o="square"===H.cap?.71:.5;en(F,P(X*o,M*o+s+l),H.join),x._68o(F)}},getRotation:function(v,o,O){v=v||0;var B=this._78o;if(B){var W,D=B.angle,y=B.points,p=B.edgeTypeInfo;if(D!=I)return o?B.orienAngle+v:D+v;if(p&&p[Wn])return p.getRotation?p.getRotation(this,v,o,O):0;if(p&&p.points){var b=p.points;return W=b.size(),Df[O]?W&&0===W%2?Wl(b.get(W/2-1),b.get(W/2),o,v):v:op[O]?Wl(b.get(0),b.get(1),o,v):Wl(b.get(W-2),b.get(W-1),o,v)}if(y)return W=y.size(),Df[O]?W&&0===W%2?Wl(y.get(W/2-1),y.get(W/2),o,v):v:op[O]?Wl(B.sourcePoint,W?y.get(0):B.targetPoint,o,v):Wl(W?y.get(W-1):B.sourcePoint,B.targetPoint,o,v)}return v},getPosition:function(_,l,W,L,p){var i=this._78o;if(i){var k,v=i.type,x=i.points,u=i.edgeTypeInfo,N=i.sourcePoint,G=i.targetPoint;if(!v)return i.looped?{x:N.x-i.radius+l,y:N.y+W}:(p&&N&&G&&(N.x>G.x||N.x===G.x&&N.y>G.y)&&(_=Bk[_],W=-W),k=Ke(_,i.rect,L),k.x+=l,k.y+=W,k=i.mat.tf(k),k.x+=i.origin.x,k.y+=i.origin.y,k);if(u&&u[Wn])return u.getPosition?u.getPosition(this,_,l,W,L,p):{x:(N.x+G.x)/2,y:(N.y+G.y)/2};if(x){var k,z=x.size();if(Df[_]){if(z){var O=z%2;if(0===O)return Co(x.get(z/2-1),x.get(z/2),_,l,W,L,p);k=x.get((z-O)/2)}else k={x:(N.x+G.x)/2,y:(N.y+G.y)/2};return k=Ke(_,{x:k.x,y:k.y,width:0,height:0},L),k.x+=l,k.y+=W,k}return op[_]?Co(N,z?x.get(0):G,_,l,W,L,p):Co(z?x.get(z-1):N,G,_,l,W,L,p)}if(u){var c=u.points,z=c.size();if(Df[_]){var O=z%2;return 0===O?Co(c.get(z/2-1),c.get(z/2),_,l,W,L,p):(k=c.get((z-O)/2),k=Ke(_,{x:k.x,y:k.y,width:0,height:0},L),k.x+=l,k.y+=W,k)}return op[_]?Co(c.get(0),c.get(1),_,l,W,L,p):Co(c.get(z-2),c.get(z-1),_,l,W,L,p)}}return Xq},_42:function(K){this._78o&&Gb.superClass._42.call(this,K)},drawPath:function(i,q){i.beginPath();var x=q.type,f=q.points,V=q.segments,p=q.edgeTypeInfo;if(!x||f){var y=q.sourcePoint,j=y.x,o=y.y,A=q.targetPoint,T=A.x,t=A.y;if(x)if(V){var l=new up({x:j,y:o});l.addAll(f),l.add({x:T,y:t}),Hg(i,l,V)}else i.moveTo(j,o),f.each(function(v){i.lineTo(v.x,v.y)}),i.lineTo(T,t);else q.looped?i.arc(j,o,q.radius,0,E,!0):q.center?(i.moveTo(q.c1.x,q.c1.y),i.lineTo(j,o),i.lineTo(T,t),i.lineTo(q.c2.x,q.c2.y)):(i.moveTo(j,o),i.lineTo(T,t))}else p&&(p.points?Hg(i,p.points,p.segments):p[Wn]&&p[Wn](i,p))},_80o:function(u){var n=this,j=n.s,G=n._78o,H=G.width,m=G.selectWidth,_=G.borderWidth,U=u.lineJoin,P=u.lineCap,c=G.gray,h=G.pattern;u.lineJoin=G.join,u.lineCap=G.cap,n.drawPath(Zl(u,h),G);var Y=j("edge.width.absolute");Y&&(u.save(),u.setTransform(1,0,0,1,0,0)),m&&(u.strokeStyle=G._97o,u.lineWidth=H+2*(_+m),u.stroke()),_&&(u.strokeStyle=c?t.toGrayColor(G.borderColor):G.borderColor,u.lineWidth=H+2*_,u.stroke());var f=c?t.toGrayColor(G.color):G.color,y=c?t.toGrayColor(G._67o):G._67o;if(u.strokeStyle=f,u.lineWidth=H,u.stroke(),G.is3d&&Qo(u,f,y,H,n.gv._zoom,G._66o),ol(u,h),j("edge.dash")){h=j("edge.dash.pattern");var D=Zl(u,h,n._2Q("edge.dash.offset"));D!==u&&n.drawPath(D,G),n._1Q(u,"edge",j("edge.dash.width")||H,h)}Y&&u.restore(),u.lineJoin=U,u.lineCap=P},_48O:function(){},_47O:function(){}});var al=function(i,I){mj(al,this,[i,I])};Rq(al,Vn,{_3O:function(){var b,q,M=this,R=M.s,c=M._data,F=M.gv;if(M._88I=I,c.isExpanded()&&c.eachChild(function(e){if(Fg(e)){var f=F.getBoundsForGroup(e);f&&(q||(q=[]),q.push(f),b=Jq(b,f))}}),b){var J=F.getLabel(c),N=R("group.type"),a=R("group.border.width")||0,G=R("group.border.width.absolute"),U=a/2;G&&(a/=F._zoom),b=zo(N,q,b),Wr(b,c,"group.padding",1),tb(b,a);var E=M._88I={type:N,rect:b,_64o:b};if(!N&&J!=I){var k,t=M.labelInfo={label:J,color:R("group.title.color"),font:R("group.title.font"),align:R("group.title.align")},W=fo(t,J),u=W.width+a,A=W.height+a,$=R("group.title.align"),v=R("group.title.orientation");if(v===hq||v===Ce?(b.height+=a,u>b.width&&(b.width=u)):(v===Hd||v===Np)&&(b.width+=a,u>b.height&&(b.height=u)),k=$===Hd?b.x:$===Np?b.x+b.width-u:b.x+b.width/2-u/2,v===Ce)E.titleRect={x:b.x,y:b.y+b.height,width:b.width,height:A},E.rect={x:b.x,y:b.y,width:b.width,height:b.height+A},t.rect={x:k,y:b.y+b.height,width:u,height:A};else if(v===Hd){var p=E.titleRect={x:b.x-A,y:b.y,width:A,height:b.height};E.rect={x:b.x-A,y:b.y,width:b.width+A,height:b.height},t.rect={x:p.x+A/2-b.height/2,y:p.y+b.height/2-A/2,width:b.height,height:A},t.rotation=-Math.PI/2}else if(v===Np){var p=E.titleRect={x:b.x+b.width,y:b.y,width:A,height:b.height};E.rect={x:b.x,y:b.y,width:b.width+A,height:b.height},t.rect={x:p.x+A/2-b.height/2,y:p.y+b.height/2-A/2,width:b.height,height:A},t.rotation=Math.PI/2}else E.titleRect={x:b.x,y:b.y-A,width:b.width,height:A},E.rect={x:b.x,y:b.y-A,width:b.width,height:b.height+A},t.rect={x:k,y:b.y-A-U,width:u,height:A+a}}M._40O(E,R("group.border.width")/2)}else al.superClass._3O.call(M)},getPosition:function(_,G,P,s){var E=this._88I;if(E){var y=Ke(_,E.rect,s);return y.x+=G,y.y+=P,y}return al.superClass.getPosition.apply(this,arguments)},_24O:function(B,f){var K=this._88I;(!K||K.type||"label2"===B)&&al.superClass._24O.call(this,B,f)},_80o:function(L){var M=this,$=M._88I;if($){var Y=M._data,N=M.s,w=M.gv,c=$.type,O=$.rect,X=$._64o,E=$.titleRect,f=M.getBodyColor(),R=Bn(N("group.image"),f),n=N("group.image.stretch"),U=M.getBodyColor("group.background"),D=Bn(N("group.repeat.image"),f),a=N("group.gradient.pack"),C=N("group.gradient"),W=N("group.gradient.color"),e=N("group.border.width"),Q=N("group.border.color"),S=N("group.border.pattern"),z=N("group.title.orientation"),h=N("group.depth"),p=N("group.border.radius"),H=N("group.border.join"),I=N("group.border.cap"),d=N("group.border.width.absolute");
if(d&&(e/=w._zoom),c){var A=L.lineJoin,o=L.lineCap;if(L.lineJoin=H,L.lineCap=I,R){if(L.save(),Fr(L,c,O,p),L.clip(),ck(L,R,n,O.x,O.y,O.width,O.height,Y,w,f),L.restore(),e>0){var j=Zl(L,S);Fr(j,c,O,p),L.lineWidth=e,L.strokeStyle=Q,L.stroke(),ol(L,S)}}else{var j=Zl(L,S);U||D||a?(Fr(L,c,O,p),a?Wo(L,a):D?ko(L,D,f,null,Y,w):yh(L,U,C,W,O),L.fill(),a&&L.restore(),L!==j&&Fr(j,c,O,p)):Fr(j,c,O,p),e>0&&(L.lineWidth=e,L.strokeStyle=N("group.border.color"),L.stroke()),ol(L,S),c===qn&&Zq(L,U,h,O)}L.lineJoin=A,L.lineCap=o}else{var K=N("group.title.background");if((!p||0>p)&&(p=0),R)ck(L,R,n,X.x,X.y,X.width,X.height,Y,w,M.getBodyColor());else if(U||D)if(D?ko(L,D,f,null,Y,w):yh(L,U,C,W,X),0===e)Fr(L,qn,X),L.fill(),Zq(L,U,h,X);else{switch(L.beginPath(),z){case Ce:nf(L,X.x,X.y,X.width,X.height,p,p,0,0);break;case Hd:nf(L,X.x,X.y,X.width,X.height,0,p,0,p);break;case Np:nf(L,X.x,X.y,X.width,X.height,p,0,p,0);break;case hq:nf(L,X.x,X.y,X.width,X.height,0,0,p,p)}L.fill()}if(E&&K)if(0===e)Xl(L,E.x,E.y,E.width,E.height,K),Zq(L,K,h,E);else{switch(L.beginPath(),L.fillStyle=K,z){case Ce:nf(L,E.x,E.y,E.width,E.height,0,0,p,p);break;case Hd:nf(L,E.x,E.y,E.width,E.height,p,0,p,0);break;case Np:nf(L,E.x,E.y,E.width,E.height,0,p,0,p);break;case hq:nf(L,E.x,E.y,E.width,E.height,p,p,0,0)}L.fill()}if(e>0){var j=Zl(L,S);if(Fr(j,"roundRect",O,p),L.save(),L.lineWidth=e,L.strokeStyle=Q,L.lineJoin=H,L.lineCap=I,L.closePath(),L.stroke(),E&&N("group.splitLine")){var u=E.x,t=E.y,P=E.width,J=E.height;L.beginPath(),z===Ce?(L.moveTo(u,t),L.lineTo(u+P,t)):z===Hd?(L.moveTo(u+P,t),L.lineTo(u+P,t+J)):z===Np?(L.moveTo(u,t),L.lineTo(u,t+J)):(L.moveTo(u,t+J),L.lineTo(u+P,t+J))}L.stroke(),L.restore(),ol(j,S)}}M._39O(L,$)}else al.superClass._80o.call(M,L)}});var Vp=function(k,A){mj(Vp,this,[k,A])};Rq(Vp,Vn,{_80o:function(i){this._39O(i,this._83o)}});var Al=function(a,L){mj(Al,this,[a,L])};Rq(Al,Vn,{_3O:function(){var k=this,i=k._data,N=k.s,G=k.gv,V=i.getPoints(),Z=G.getBorderColor(i),y=Z?N("border.width"):0,f=k.getSelectWidth(),p=N("shape.border.width"),h=i.getRect(),t=i.getAnchorRect(),u=G.getBodyColor(i),s=k._99o=V.isEmpty()?I:{rect:h,rotation:i.getRotation(),fillRule:N("shape.fill.rule"),scale:i.getScale(),position:i.p(),points:V,segments:i.getSegments(),bodyColor:u,borderColor:Z,borderWidth:y,_94o:N("shape.border.3d"),_95o:N("shape.border.3d.color"),_96o:N("shape.border.3d.accuracy"),_97o:f?k.getSelectColor():I,selectWidth:f,_53o:N("shape.background"),_27Q:Bn(N("shape.repeat.image"),u),shapeGradientPack:N("shape.gradient.pack"),_54o:p,_55o:N("shape.border.color"),shapeGradient:N("shape.gradient"),_59o:N("shape.gradient.color"),_60o:N("shape.border.pattern"),_61o:N("shape.border.cap"),_62o:N("shape.border.join"),shapeForeground:N("shape.foreground"),gray:N("2d.gray")};if(s){t.x+=s.position.x,t.y+=s.position.y,s.gradientRect=t;var F=i.getScale(),r=P(1,P(H(F.x),H(F.y)));N("shape.dash")&&N("shape.dash.width")>p&&(p=N("shape.dash.width"));var B,x=N("shape.border.width.absolute");B=x?(p+y+f)/k.gv._zoom/r:p*("square"===s._61o?.71:.5)+y+f/k.gv._zoom/r,B&&(B*=r,h=Gk(h),en(h,B,s._62o)),k._68o(h);var z=N("clip.percentage");1>z&&(0>z&&(z=0),s.clipRect=ir(i.getAnchorRect(),N("clip.direction"),z));var K=N("shape.fill.clip.percentage");1>K&&(0>K&&(K=0),s.shapeClipRect=ir(i.getAnchorRect(),N("shape.fill.clip.direction"),K));var T=N("shape.foreground.clip.percentage");1>T&&(0>T&&(T=0),s.shapeForegroundClipRect=ir(i.getAnchorRect(),N("shape.foreground.clip.direction"),T))}},getPosition:function(O,s,J,I){var R=this._99o;if(R){var p=Ke(O,R.rect,I);return p.x+=s,p.y+=J,p}return Xq},_42:function(X){this._99o&&Al.superClass._42.call(this,X)},_80o:function(v){var _,y=this,b=y.s,o=y._99o,l=o.position,Z=o.scale,O=o.rotation,p=o.borderWidth,J=o.selectWidth/y.gv._zoom,c=o._27Q,F=o.shapeGradientPack,h=o._54o,x=o.clipRect,E=o.shapeClipRect,m=o.points,g=o.segments,k=y._data.isClosePath(),I=o.fillRule,Q=o.gray,W=function(R){return Q?t.toGrayColor(R):R},M=W(o._53o),z=M||c||F;v.save(),nc(v,l.x,l.y),Ur(v,O),Rl(v,Z.x,Z.y),x&&(v.beginPath(),v.rect(x.x,x.y,x.width,x.height),v.clip()),z&&E&&(v.save(),v.beginPath(),v.rect(E.x,E.y,E.width,E.height),v.clip()),nc(v,-l.x,-l.y);var a=o._60o,H=Zl(v,a),K=v.lineJoin,n=v.lineCap;v.lineJoin=o._62o,v.lineCap=o._61o;var R=W(o.bodyColor);z?(Hg(v,m,g,k),F?Wo(v,F):c?ko(v,c,R,null,y._data,y.gv):(_=R?R:M,yh(v,_,o.shapeGradient,W(o._59o),o.gradientRect)),v.fill(I),E&&(v.restore(),nc(v,-l.x,-l.y)),F&&v.restore(),H!==v&&Hg(H,m,g,k)):Hg(H,m,g,k);var w=o.shapeForeground;if(w){v.save();var u=o.shapeForegroundClipRect;u&&(nc(v,l.x,l.y),v.beginPath(),v.rect(u.x,u.y,u.width,u.height),v.clip(),nc(v,-l.x,-l.y)),Hg(v,m,g,k),yh(v,w,b("shape.foreground.gradient"),W(b("shape.foreground.gradient.color")),o.gradientRect),v.fill(I),v.restore()}var e=b("shape.border.width.absolute");if(e&&(v.save(),v.setTransform(1,0,0,1,0,0)),J&&(v.strokeStyle=o._97o,v.lineWidth=h+2*(p+J),v.stroke()),p&&(v.strokeStyle=W(o.borderColor),v.lineWidth=h+2*p,v.stroke()),h&&(_=W(o._55o),!M&&R&&(_=R),v.strokeStyle=_,v.lineWidth=h,v.stroke(),o._94o&&Qo(v,_,W(o._95o),h,y.gv._zoom,o._96o)),ol(v,a),b("shape.dash")){var Y=b("shape.dash.width")||h;if(Y>0){a=b("shape.dash.pattern");var H=Zl(v,a,y._2Q("shape.dash.offset"));H!==v&&Hg(H,m,g,k),y._1Q(v,"shape",Y,a)}}e&&v.restore(),v.lineJoin=K,v.lineCap=n,v.restore()},_48O:function(){},_47O:function(){}});var tc=function(E,Z){mj(tc,this,[E,Z])};Rq(tc,Al,{getRotation:function(d,K,F){d=d||0;var I=this._data.getPoints(),x=I.size();return x>1?Df[F]?x&&0===x%2?Wl(I.get(x/2-1),I.get(x/2),K,d):d:op[F]?Wl(I.get(0),I.get(1),K,d):Wl(I.get(x-2),I.get(x-1),K,d):d},getPosition:function(h,c,D,u,m){var y=this._data.getPoints(),z=y.size();if(z>1){if(Df[h]){var p=z%2;if(0===p)return Co(y.get(z/2-1),y.get(z/2),h,c,D,u,m);var e=y.get((z-p)/2),n={x:e.x,y:e.y,width:0,height:0};return e=Ke(h,n,u),e.x+=c,e.y+=D,e}return op[h]?Co(y.get(0),y.get(1),h,c,D,u,m):Co(y.get(z-2),y.get(z-1),h,c,D,u,m)}return Xq}});var Lh=function(u,i){mj(Lh,this,[u,i])};Rq(Lh,Vn,{_3O:function(){var B=this;Lh.superClass._3O.call(B);var P=B.s,d=B._83o;B._82o=d.img||d.shape?I:{background:B.getBodyColor("grid.background"),depth:P("grid.depth"),rect:d.rect,_88o:P("grid.cell.depth"),cellBorderColor:P("grid.cell.border.color"),_89o:P("grid.row.count"),_90o:P("grid.column.count"),block:P("grid.block"),_91o:P("grid.block.color"),_92o:P("grid.block.padding"),_93o:P("grid.block.width")}},_80o:function(r){var Y=this,k=Y._82o;if(!k)return Lh.superClass._80o.call(Y,r),void 0;var G,f,e=Y._data,o=k.background,_=k.rect,V=k.block,A=k._91o,N=k._92o,i=k._93o,D=k._88o,X=k.cellBorderColor,w=k._89o,x=k._90o;if(o)if(Xl(r,_.x,_.y,_.width,_.height,o),Zq(r,o,k.depth,_),D)for(G=0;w>G;G++)for(f=0;x>f;f++)_=e.getCellRect(G,f),_&&Zq(r,o,D,_);else if(X){for(r.beginPath(),G=0;w>G;G++)for(f=0;x>f;f++)_=e.getCellRect(G,f),_&&r.rect(_.x,_.y,_.width,_.height);r.strokeStyle=X,r.lineWidth=1,r.stroke()}if("h"===V)for(G=0;w>G;G++)_=Jq(e.getCellRect(G,0),e.getCellRect(G,x-1)),tb(_,N),_d(r,A,_.x,_.y,_.width,_.height,i);else if("v"===V)for(f=0;x>f;f++)_=Jq(e.getCellRect(0,f),e.getCellRect(w-1,f)),tb(_,N),_d(r,A,_.x,_.y,_.width,_.height,i);Y._39O(r,Y._83o)}});var Yj=function(K,$){mj(Yj,this,[K,$])};Rq(Yj,Vn,{_checkEmptyRect:!1,_81o:function(){var C=this._data,U=Yj.superClass._81o.call(this),L=C.s("text");if(L!=I){var y,h,T=C.s("text.font"),E=C.s("text.align"),v=C.s("text.vAlign"),M=Cg(T,L),d=M.width,J=M.height,n=C.getAnchor(),F=C.getWidth(),m=C.getHeight();"left"===E?y=-F*n.x:"center"===E?y=-F*n.x+(F-d)/2:"right"===E&&(y=F*(1-n.x)-M.width),"top"===v?h=-m*n.y:"middle"===v?h=-m*n.y+(m-J)/2:"bottom"===v&&(h=m*(1-n.y)-M.height);var A,K=C.getMatrix();if(A=Hj([K.tf(y,h),K.tf(y+d,h),K.tf(y+d,h+J),K.tf(y,h+J)]),U=Jq(U,A),U&&C.s("text.shadow")){var S=Gk(U);S.x+=C.s("text.shadow.offset.x"),S.y+=C.s("text.shadow.offset.y"),tb(S,C.s("text.shadow.blur")),U=Jq(U,S)}}return U}});var Sf=om.Interactor=function(b){this.gv=this._graphView=b};ad("Interactor",Y,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(C){this.gv.fi(C)},setCursor:function(G){Jm||this.gv.setCursor(G)},startDragging:function(l){var G=this;G._lastClientPoint=hb(l),G._lastLogicalPoint=G.gv.lp(l),_g(G,l)},clearDragging:function(){var r=this;r._lastClientPoint=r._lastLogicalPoint=r._logicalPoint=I},autoScroll:function(R){return this.gv.autoScroll(R,this._lastClientPoint)}});var Zg=I,Io=function(s){Zg.handleWindowTouchMove(s)},jh=function(P){Zg.handleWindowTouchEnd(P),i(B,_l,Io),i(B,rp,jh),Zg=I},Vr=function(i){Zg.handleWindowMouseMove(i)},gh=function(J){Zg.handleWindowMouseUp(J),i(B,hs,Vr),i(B,fl,gh),Zg=I},Mi=function(T,b){T!==Zg&&(Zg?Jm?Zg.handleWindowTouchEnd(b):Zg.handleWindowMouseUp(b):Jm?(J(B,_l,Io),J(B,rp,jh)):(J(B,hs,Vr),J(B,fl,gh)),Zg=T)},_q=function(i){var r=this;r.gv=i,r._is2d=i instanceof om.GraphView,r._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",uc,"wheel"].forEach(function(q){r.addListener(q)}),r.initImageResource()};Rq(_q,Sf,{enableVR:function(n){var v=this;if(!!v._vrEnable!==n)if(v._vrEnable=n,n)v.gv.vr.mp(v.onVRControllerChange,v);else if(v.gv.vr.ump(v.onVRControllerChange,v),v._vrRayPolyline){var y=v.gv.dm();y.remove(v._vrRayPolyline),y.remove(v._vrRayHitPoint),v._vrRayPolyline=Q,v._vrRayHitPoint=Q}},onVRControllerChange:function(x){var w=this,s=x.property,S=x.newValue,_=w.gv.vr.getController(S.id),I=_.getRay();I&&("gamepad.button.trigger"===s?"down"===S._62O?w.handle_mousedown(I):w.handleWindowMouseUp(I):"gamepad.pose"===s&&(w.handle_mousemove(I),w.handleWindowMouseMove(I)))},drawVRRay:function(o,c,Q){var T,m=this,N=m.gv,J=m._vrRayPolyline,V=!1;if(J)T=m._vrRayHitPoint;else{var P=N.dm();m._vrRayPolyline=J=new v.Polyline,m._vrRayHitPoint=T=new v.Node,T.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),T.setAnchor3d(.5,.5,.499);var L=.2/N.vr.measureOflength;T.s3(L,L,L),J.s("intersect",!1),T.s("intersect",!1),P.add(J),P.add(T),V=!0}if(c){var O=Q.world,$=Q.worldNormal,s=O.x,t=O.y,y=O.z;J.s("shape.border.color","red"),J.setPoints([{x:o.origin.x,y:o.origin.z,e:o.origin.y},{x:s,y:y,e:t}]),T.s("3d.visible",!0),T.p3(s,t,y),T.lookAtDirection([$.x,$.y,$.z],"front")}else{J.s("shape.border.color","blue");var g=new v.Math.Vector3;g.copy(o.direction).setLength(1e3/m.gv.vr.measureOflength).add(o.origin),J.setPoints([{x:o.origin.x,y:o.origin.z,e:o.origin.y},{x:g.x,y:g.z,e:g.y}]),T.s("3d.visible",!1)}N.fi({kind:"vrRayIntersect",ray:o,data:c,intersect:Q,polyline:J,hitNode:T,begin:V})},setPreventEventDefault:function(c,x){var Y=this,I=Y._eventListeners[c];I?I._prevent=x:Y._eventListeners[c]=I={_removal:Q,_prevent:x}},removeListener:function(u){var X=this,W=X._eventListeners[u];W&&W._removal&&(W._removal(),W._removal=Q)},addListener:function(o){var u=this,g=u._eventListeners[o];if(g||(u._eventListeners[o]=g={_removal:Q,_prevent:!0}),!g||!g._removal){var m=function(l){g._prevent&&t.preventDefault(l),u.disabled||("wheel"===o?Im(u,l):u["handle_"+o](l))};J(u.gv.getView(),o,m),g._removal=function(){i(u.gv.getView(),o,m)}}},handleWindowTouchMove:function(e){this.handleWindowMouseMove(e)},handleWindowMouseMove:function(s){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",s):(this.handleDownInfo("onBeginDrag",s),this.isDragging=!0))},handleWindowTouchEnd:function(N){this.handleWindowMouseUp(N)},handleWindowMouseUp:function(G){if(this.isDragging&&(this.handleDownInfo("onEndDrag",G),this.isDragging=!1),this.downInfo){var a=this.handle("onUp",G);if(a&&a.data===this.downInfo.data){this.handleMissingUp(G);var B=this,M=2===G.button?"onContextMenu":"onClick";if(!B._dbclickTimer)return B._dbclickTimer=V(function(){delete B._dbclickTimer,B.handleClick(G,M,a),this.downInfo=I},t.clickDelay),void 0;S(B._dbclickTimer),delete B._dbclickTimer,M="onDoubleClick",B.handleClick(G,M,a)}else this.handleDownInfo("onUp",G);this.downInfo=I}},handle_mouseleave:function(y){var N=this,x=N.gv,u=N.currentInfo?N.currentInfo.data:I;if(u){u.s("onLeave")&&u.s("onLeave")(y,u,x),N.fire("data","onLeave",y,u);var A=N.currentInfo?N.currentInfo.hits:I;if(A)for(var h in A)N.handleLeave(y,h);N.currentInfo=I}},handle_mousewheel:function(i){i.scrollDelta=i.wheelDelta/40,this.handle("onScroll",i)},handle_DOMMouseScroll:function(o){o.scrollDelta=2===o.axis?-o.detail:0,this.handle("onScroll",o)},handle_touchstart:function(z){this.handle_mousedown(z)},handle_touchmove:function(B){this.handle("onMove",B)},handle_mousedown:function(q){this.isDragging&&(this.handleDownInfo("onEndDrag",q),this.isDragging=!1),this.downInfo=this.handle("onDown",q),this.downInfo&&Mi(this,q)},handle_mousemove:function(E){var R=this,G=R.gv;R._hoverTimer&&(S(R._hoverTimer),delete R._hoverTimer);var M,$,l,i=R.handle("onMove",E),k=this.currentInfo?this.currentInfo.data:I,L=this.currentInfo?this.currentInfo.hits:I;if(i&&($=i.data,l=i.hits,R._hoverTimer=V(function(){S(R._hoverTimer),delete R._hoverTimer,R.handle("onHover",E,i)},G.getHoverDelay()||t.hoverDelay)),$!==k){if(k&&(k.s("onLeave")&&k.s("onLeave")(E,k,G),this.fire("data","onLeave",E,k)),$&&($.s("onEnter")&&$.s("onEnter")(E,$,G),this.fire("data","onEnter",E,$)),L)for(M in L)this.handleLeave(E,M);if(l)for(M in l){var W=l[M],f=$._interactPrefix=W.prefix,s=f&&$.a(f+"onEnter")||W.target.onEnter;s&&s.call(W.target,E,$,G,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),$._interactPrefix=null}}else{if(L)for(M in L)l&&l[M]||this.handleLeave(E,M);if(l)for(M in l)if(!L||!L[M]){var W=l[M],f=$._interactPrefix=W.prefix,s=f&&$.a(f+"onEnter")||W.target.onEnter;s&&s.call(W.target,E,$,G,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),$._interactPrefix=null}}this.currentInfo=i},handle:function(W,y,U){var k,g=this,J=g.gv;if(g._is2d){if(U=U||J.getDataInfoAt(y),!U||!J.isInteractive(U.data))return;if(k=U.ui.interactiveInfo){var u,H=U.data;if(H.s(W)&&H.s(W)(y,H,J),this.fire("data",W,y,H),"body"===U.part&&k.bodyInfo)u="body",U.hits=this.handleImage(u,J.getImage(H),W,y,H,U.point,k.bodyInfo);else if("icons"===U.part&&k._38o){var V=k._38o[U.name];V&&V[U.index]&&(u="icons|"+U.name+"|"+U.index,U.hits=this.handleImage(u,U.icon,W,y,H,U.point,V[U.index]))}}return U}var H,p;if(!U)if(y&&y instanceof v.Math.Ray){var M=J.vr.intersectWorld(y);if(H=M.data,p=M.intersect,g.drawVRRay(y,H,p),!H)return;var D=J.getData3dUI(H);if(k=D.interactiveInfo,!k)return;U={data:H,part:p.part,ui:D}}else{if(U=J.getDataInfoAt(y),!U)return;U&&(U={data:U.data,part:U.part})}if(J.isInteractive(U.data)){if(!p){H=U.data;var D=J.getData3dUI(H);if(U.ui=D,k=D.interactiveInfo,!k)return U;if(p=J.intersectObject(y,H),!p)return}H.s(W)&&H.s(W)(y,H,J),this.fire("data",W,y,H);var s,R=p.part;return"body"!==R&&(s=H.s(R+".image")||H.s("shape3d."+R+".image")),s||(s=H.s("all.image")||H.s("shape3d.image")),k="object"==typeof s?k[s.uuid]:k[s],k&&k.bodyInfo?(U.part="body",U.interactiveInfo=k,U.point=this._convertUVToPoint(p.uv,k),U.image=s,U.hits=this.handleImage("body",s,W,y,H,U.point,k.bodyInfo),U):U}},_handleLeaveOrMissing:function(h,q,$){var G="leave"===h?this.currentInfo:this.downInfo;if(G){var w=G.interactiveInfo||G.ui.interactiveInfo;if(w){var k,E,v=G.data;if(this._is2d){if(E=this.gv.lp(q),"body"===G.part&&w.bodyInfo)k="body","leave"===h?this.handleLeaveImage($,k,this.gv.getImage(v),q,v,E,w.bodyInfo):this.handleMissingUpImage(k,this.gv.getImage(v),q,v,E,w.bodyInfo);else if("icons"===G.part&&w._38o){var K=w._38o[G.name];K&&K[G.index]&&(k="icons|"+G.name+"|"+G.index,"leave"===h?this.handleLeaveImage($,k,G.icon,q,v,E,K[G.index]):this.handleMissingUpImage(k,G.icon,q,v,E,K[G.index]))}}else{if(!w.bodyInfo)return;var J=this.gv.intersectObject(q,v);E=J&&J.uv?this._convertUVToPoint(J.uv,w):{x:1/0,y:1/0},"leave"===h?this.handleLeaveImage($,"body",G.image,q,v,E,w.bodyInfo):this.handleMissingUpImage("body",G.image,q,v,E,w.bodyInfo)}}}},handleClick:function(o,w,G){var r=this,I=this.downInfo;if(I&&G){var L,O=G.interactiveInfo||G.ui.interactiveInfo,V=G.data,N=this.gv;if(V.s(w)&&V.s(w)(o,V,N),r.fire("data",w,o,V),O)if(this._is2d){if(I.part===G.part){var t=N.lp(o);"body"===G.part&&O.bodyInfo&&(L="body",this.handleClickImage(L,N.getImage(V),w,o,V,t,O.bodyInfo,G))}}else{if(!O.bodyInfo)return;var R=N.intersectObject(o,V);if(!R)return;t=this._convertUVToPoint(R.uv,O),this.handleClickImage("body",I.image,w,o,V,t,O.bodyInfo,G)}}},handleDownInfo:function(x,m){if(this.downInfo){var d=this.downInfo,$=this.gv,u=d.interactiveInfo||d.ui.interactiveInfo;if(u){var l,G=d.data;if(G.s(x)&&G.s(x)(m,G,$),this.fire("data",x,m,G),this._is2d){var V=$.lp(m);if("body"===d.part&&u.bodyInfo)l="body",this.handleDownInfoImage(l,$.getImage(G),x,m,G,V,u.bodyInfo);else if("icons"===d.part&&u._38o){var J=u._38o[d.name];J&&J[d.index]&&(l="icons|"+d.name+"|"+d.index,this.handleDownInfoImage(l,d.icon,x,m,G,V,J[d.index]))}}else{if(!u.bodyInfo)return;var g=$.intersectObject(m,G);if(!g)return;V=this._convertUVToPoint(g.uv,u),this.handleDownInfoImage("body",d.image,x,m,G,V,u.bodyInfo)}}}},fire:function(G,h,p,V,D,b,d,J){this.gv.fi({kind:h,type:G,event:p,data:V,image:D,comp:b,view:this.gv,point:d,width:J?J.width:Q,height:J?J.height:Q})},handleImage:function(s,H,F,P,G,b,j){var N={};if(H&&(H=Bn(H))){var C=this.gv,L=j.rect,x=this.convertPoint(b,j);x.inRect&&(H[F]&&H[F](P,G,C,x,L.width,L.height),this.fire("image",F,P,G,H,Q,x,L),N[s+"|image"]={target:H,type:"image",image:H,data:G,event:P,point:x,width:L.width,height:L.height});for(var J=j.compInfos,X=H,l=J.length-1;l>=0;l--){var v=J[l],M=v.comp;if(x=this.convertPoint(b,v,X,M,C,G),x.inRect){L=v.rect;var p=G._interactPrefix=v.prefix,e=p&&G.a(p+F)||M[F];e&&e.call(M,P,G,C,x,L.width,L.height),this.fire("comp",F,P,G,H,M,x,L),(H=L.image)&&(H[F]&&H[F](P,G,C,x,L.width,L.height),this.fire("image",F,P,G,H,Q,x,L)),G._interactPrefix=null,N[s+"|"+l]={target:M,type:"comp",comp:M,image:H,data:G,event:P,point:x,width:L.width,height:L.height,prefix:p},H&&(N[s+"|"+l+"|image"]={target:H,type:"image",image:H,data:G,event:P,point:x,width:L.width,height:L.height,prefix:p})}}}return N},handleLeave:function(S,J){return this._handleLeaveOrMissing("leave",S,J)},handleMissingUp:function(I){return this._handleLeaveOrMissing("missing",I)},handleLeaveImage:function(d,G,_,f,I,H,m){if(_&&(_=Bn(_))){var k=this.gv,R=m.rect,B=this.convertPoint(H,m);d===G+"|image"&&(_.onLeave&&_.onLeave(f,I,k,B,R.width,R.height),this.fire("image","onLeave",f,I,_,Q,B,R));for(var e=m.compInfos,x=_,p=e.length-1;p>=0;p--){var q=e[p],T=q.comp;B=this.convertPoint(H,q,x,T,k,I),R=q.rect;var Z=I._interactPrefix=q.prefix;if(d===G+"|"+p){var L=Z&&I.a(Z+"onLeave")||T.onLeave;L&&L.call(T,f,I,k,B,R.width,R.height),this.fire("comp","onLeave",f,I,_,T,B,R)}(_=R.image)&&d===G+"|"+p+"|image"&&(_.onLeave&&_.onLeave(f,I,k,B,R.width,R.height),this.fire("image","onLeave",f,I,_,Q,B,R)),I._interactPrefix=null}}},handleMissingUpImage:function(x,j,n,K,z,V){var Y="onUp",L=this.downInfo.hits;if(L&&j&&(j=Bn(j))){var P=this.gv,y=V.rect,g=this.convertPoint(z,V);!g.inRect&&L[x+"|image"]&&(j[Y]&&j[Y](n,K,P,g,y.width,y.height),this.fire("image",Y,n,K,j,Q,g,y));for(var h=V.compInfos,l=j,U=h.length-1;U>=0;U--){var v=h[U],C=v.comp;if(g=this.convertPoint(z,v,l,C,P,K),!g.inRect){y=v.rect;var _=K._interactPrefix=v.prefix;if(L[x+"|"+U]){var R=_&&K.a(_+Y)||C[Y];R&&R.call(C,n,K,P,g,y.width,y.height),this.fire("comp",Y,n,K,j,C,g,y)}(j=y.image)&&L[x+"|"+U+"|image"]&&(j[Y]&&j[Y](n,K,P,g,y.width,y.height),this.fire("image",Y,n,K,j,Q,g,y)),K._interactPrefix=null}}}},handleDownInfoImage:function(J,M,D,p,h,H,T){var f=this.downInfo.hits;if(f&&M&&(M=Bn(M))){var c=this.gv,n=T.rect,z=this.convertPoint(H,T);f[J+"|image"]&&(M[D]&&M[D](p,h,c,z,n.width,n.height),this.fire("image",D,p,h,M,Q,z,n));for(var X=T.compInfos,V=M,u=X.length-1;u>=0;u--){var r=X[u],i=r.comp;z=this.convertPoint(H,r,V,i,c,h),n=r.rect;var Y=h._interactPrefix=r.prefix;if(f[J+"|"+u]){var s=Y&&h.a(Y+D)||i[D];s&&s.call(i,p,h,c,z,n.width,n.height),this.fire("comp",D,p,h,M,i,z,n)}(M=n.image)&&f[J+"|"+u+"|image"]&&(M[D]&&M[D](p,h,c,z,n.width,n.height),this.fire("image",D,p,h,M,Q,z,n)),h._interactPrefix=null}}},handleClickImage:function(w,Z,e,E,B,d,$,I){var U=this.downInfo.hits,G=I.hits;if(U&&Z&&(Z=Bn(Z))){var V=this.gv,l=$.rect,h=this.convertPoint(d,$);U[w+"|image"]&&(Z[e]&&Z[e](E,B,V,h,l.width,l.height),this.fire("image",e,E,B,Z,Q,h,l));for(var P=$.compInfos,K=Z,f=P.length-1;f>=0;f--){var W=P[f],N=W.comp;h=this.convertPoint(d,W,K,N,V,B),l=W.rect;var y=B._interactPrefix=W.prefix;if(U[w+"|"+f]&&G[w+"|"+f]){var b=y&&B.a(y+e)||N[e];b&&b.call(N,E,B,V,h,l.width,l.height),this.fire("comp",e,E,B,Z,N,h,l)}(Z=l.image)&&U[w+"|"+f+"|image"]&&(Z[e]&&Z[e](E,B,V,h,l.width,l.height),this.fire("image",e,E,B,Z,Q,h,l)),B._interactPrefix=null}}},initImageResource:function(){t.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(T,H){if(!T)return{x:1/0,y:1/0};var a=H.bodyInfo.rect,j=T.clone(),X=T.multiply({x:a.width,y:a.height});return X.local=j,X},convertPoint:function(m,P,w,o,_,b){var J=P.rect,E=P.matrix.applyInverse(m).sub(J),e=E.x>=0&&E.y>=0&&E.x<=J.width&&E.y<=J.height;if(!e)return E;if(o&&Nq(o.pixelPerfect,b,_)){var J,O=1;this._is2d?(O=_.getZoom(),J=Lk(m.x,m.y,Q,O)):J=Lk(m.x,m.y);var h=!1,f=J.x,i=J.y,j=J.width,Y=J.height,H=t.hitMaxArea,d=j*Y*O*O;if(d>H){var x=Math.sqrt(H/d);O*=x}j*=O,Y*=O,2>j&&(j=2),2>Y&&(Y=2),f*=O,i*=O;var R=qd(j,Y);if(_._drawForChecking=!0,nc(R,-f,-i),R.scale(O,O),this._is2d){var A=_.getDataUI(b),z=A.interactiveInfo;A.interactiveInfo=null;var U=w.comps;w.comps=[o],_.drawData(R,b),w.comps=U,A.interactiveInfo=z}else{var U=w.comps;w.comps=[o];var A=_.getData3dUI(b);Kk(R,w,0,0,m.x/m.local.x,m.y/m.local.y,b,_),w.comps=U}_._drawForChecking=!1;try{for(var V=0,c=R.getImageData(0,0,j,Y).data;V<c.length;V+=4)if(0!==c[V+3]){h=!0;break}R.restore()}catch(n){sm=I,h=!1}E.inRect=h}else E.inRect=!0;return E}});var fn=om.DefaultInteractor=function(t){mj(fn,this,[t])};ad("DefaultInteractor",Sf,{handle_mousedown:function(Q){Rg(Q);var p=this,m=p.gv,V=m.getDataAt(Q);if(m.setFocus(Q)&&!m._editing&&!m._scrolling){Mb(Q)?m.handleDoubleClick(Q,V):m.handleClick(Q,V);var G=Ei(Q);!vp()&&!G&&V&&(m.isMovable(V)||m._39Q(V))||!m.isPannable()||!Qn(Q)&&!G||Ic(Q)||(p._tx=m.tx(),p._ty=m.ty(),p.startDragging(Q))}},handleWindowMouseUp:function(b){var P=this,$=P.gv;$._panning&&(delete $._panning,$.onPanEnded(),P.fi({kind:"endPan",event:b})),delete P._tx,delete P._ty,P.clearDragging()},handle_mousemove:function(P){var E=this,o=E.gv;E._hoverTimer&&(S(E._hoverTimer),delete E._hoverTimer),E._hoverTimer=V(function(){E.fi({kind:"hover",event:P}),S(E._hoverTimer),delete E._hoverTimer},o.getHoverDelay()||t.hoverDelay)},handle_touchmove:function(h){this.handle_mousemove(h)},handleWindowMouseMove:function(T){var I=this,Z=I.gv;I.fi({kind:Z._panning?"betweenPan":"beginPan",event:T}),Z._panning=1;var j=Si(Z,T,I._lastClientPoint);Z.setTranslate(I._tx+j.x,I._ty+j.y)},handle_mousewheel:function(M){this.gv.handleScroll(M,M.wheelDelta)},handle_DOMMouseScroll:function(y){2===y.axis&&this.gv.handleScroll(y,-y.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)}});var Di=om.SelectInteractor=function(G){mj(Di,this,[G])};ad("SelectInteractor",Sf,{_42:function(){var y=this,Y=y.gv,M=Y.getZoom(),o=y.mark,$=y.div;$||($=y.div=Tj(),Ig(y.getView(),$));var _={};_.x=o.x*M+Y.tx(),_.y=o.y*M+Y.ty(),_.width=o.width*M,_.height=o.height*M,Op($,_),this.intersects()?($.style.border="",$.style.background=Y.getRectSelectBackground()):($.style.background="",$.style.border="1px solid "+Y.getRectSelectBorderColor())},handle_mousedown:function(u){var R=this,W=R.gv;if(R._57I=I,R.pendingClickThrough=I,!(W._editing||W._scrolling||vp()||Ei(u))){var m=W.getDataAt(u),M=W.sm();m?Ic(u)?M.co(m)?M.rs(m):M.as(m):M.co(m)?m instanceof Ml&&m.isClickThroughEnabled()&&Qn(u)&&(R.pendingClickThrough=hb(u)):M.ss(m):Ic(u)||!W.isPannable()?Qn(u)&&(Ic(u)||M.cs(),W.isRectSelectable()&&(R.startDragging(u),W._77O=1)):Qn(u)&&(R._57I=hb(u))}},handle_mouseup:function(N){var k=this,L=k.gv,f=k._57I;if(f&&(Oj(f,hb(N))<=1&&L.sm().cs(),k._57I=I),k.pendingClickThrough){if(Oj(k.pendingClickThrough,hb(N))<=1){var C=L.getDataAt(N);if(C instanceof Ml&&C.isClickThroughEnabled()){var W=L.getDataAt(N,function(b){var u=b.getParent()===C&&L.isSelectable(b,!0);return u});W&&(N.clickThrough=!0,L.sm().ss(W))}}k.pendingClickThrough=I}},handleWindowMouseUp:function(y){this.clear(y)},handleWindowMouseMove:function(L){var V=this,R=V.gv;V._logicalPoint=R.lp(L),V.mark?(V.fi({kind:"betweenRectSelect",event:L}),R.isPannable()&&V.autoScroll(L),V.redraw()):V.fi({kind:"beginRectSelect",event:L}),V.mark=Hj(V._lastLogicalPoint,V._logicalPoint),V.redraw()},intersects:function(){var U=this,Z=U._lastLogicalPoint,V=U._logicalPoint;return Z.x>V.x||Z.y>V.y},clear:function($){var z=this,J=z.gv,q=z.mark;if(z._57I=I,z.pendingClickThrough=I,z._lastLogicalPoint){if(q){if(0!==q.width&&0!==q.height){var i=J.getDatasInRect(q,z.intersects());if(!i.isEmpty()){var V=J.sm(),f=V.toSelection();i.each(function(p){V.co(p)?f.remove(p):f.add(p)}),V.ss(f)}}mo(z.div),delete z.div,delete z.mark,z.redraw(),z.fi({kind:"endRectSelect",event:$}),J.onRectSelectEnded()}z.clearDragging(),delete J._77O}},redraw:function(){var T=this;T._draw||(T._draw=1,V(function(){T.mark&&T._42(),delete T._draw},16))}});var Te=om.MoveInteractor=function(h){mj(Te,this,[h])};ad("MoveInteractor",Sf,{handle_mousedown:function(O){var a=this,A=a.gv;if(Qn(O)&&!A._editing&&!A._scrolling&&!vp()){var J=A.getSelectedDataAt(O);!J||A._39Q(J)&&!A.isMovable(J)?A._focusData=I:(a._data=J,A.handleMouseDown&&A.handleMouseDown(O,J),a.startDragging(O),A.isMovable(J)&&(A._moving=1))}},handleWindowMouseUp:function(J){var W=this,b=W.gv;b.handleMouseUp&&b.handleMouseUp(J,W._data),W.clear(J)},handleWindowMouseMove:function(t){var K=this,_=K._data,o=K.gv;if((!o._93O||!o._93O(t,_))&&o._moving){K._logicalPoint||K.fi({kind:"prepareMove",event:t});var F=K._logicalPoint?"betweenMove":"beginMove",c={kind:F,event:t},v=K._logicalPoint=o.lp(t);"beginMove"!==F||K._alreadyBeginTransaction||(K._alreadyBeginTransaction=!0,o.getDataModel().beginTransaction());var s=K._calcShift(F,t),V=s.x,G=s.y,b=K.gv.getMoveMode(t,_);b&&("x"===b?G=0:"y"===b?V=0:"xy"!==b&&(V=G=0)),o.moveSelection(V,G),K._lastLogicalPoint=v,K.autoScroll(t),K.fi(c)}},_calcShift:function(){var p=this,S=p._logicalPoint,J=p._lastLogicalPoint,a=S.x-J.x,r=S.y-J.y;return{x:a,y:r}},clear:function(r){var Z=this,O=Z.gv;Z._lastLogicalPoint&&(Z._lastLogicalPoint=Z._data=O._moving=I,Z._logicalPoint&&(Z.fi({kind:"endMove",event:r}),O.onMoveEnded()),Z.clearDragging()),Z._alreadyBeginTransaction&&(Z._alreadyBeginTransaction=!1,O.getDataModel().endTransaction())}});var ib=om.TextEditInteractor=function(E){mj(ib,this,[E]),this.init()};ad("TextEditInteractor",Sf,{init:function(){var j=this,g=this.input=M.createElement("input"),v=g.style;g.text="text",v.border="1px solid #d8d8d8",v.position="absolute",v.padding="2px 3px",v.outline="none",v.marginLeft="-90px",v.marginTop="-16px",v.backgroundColor="rgba(255,255,255, 0.9)",v.fontSize="14px",v.width="180px",v.height="32px",v.boxShadow="0 0 13px rgba(16,142,233, 0.5)",v.textAlign="center",v.boxSizing="border-box",J(g,"keyup",function(g){ih(g)&&j.endTextEdit()}),J(g,"focus",function(){g.select()});var t=this.textarea=M.createElement("textarea"),X=this.wrap=M.createElement("div");X.appendChild(t),v=t.style,v.margin=0,v.padding="4px",v.overflow="hidden",v.boxSizing="border-box",v.position="absolute",v.outline="none",v.backgroundColor="transparent",v.resize="none",v.textAlign="center",v.fontSize="14px",v.border="none",v.borderWidth=0,v.width="100%",v.top="50%",v=X.style,v.boxSizing="border-box",v.margin=0,v.padding=0,v.position="absolute",v.boxShadow="0 0 13px rgba(16,142,233, 0.5)",v.border="1px solid #d8d8d8",v.backgroundColor="rgba(255,255,255, 0.9)",v.width="180px",v.marginLeft="-90px",J(t,"keydown",function(B){return(Kh()||Ic())&&ih(B)?(j.endTextEdit(),void 0):(j.calculateTextareaHeight(String.fromCharCode(B.keyCode)),void 0)}),J(t,"focus",function(){t.select()});var L=function(R){R.stopPropagation()};J(g,"mousedown",L),J(g,"touchstart",L),J(t,"mousedown",L),J(t,"touchstart",L),j.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],j.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",j.handleWindowClick=function(x){var V=j._editingDOM;if(V){var n=V.getBoundingClientRect(),q=hb(x);Vl(n,q)||j.endTextEdit()}}},handle_mousedown:function(w){var y=this,A=y.gv;if(Mb(w)&&!A._editing){var d=A.getDataAt(w);if(d){var E=A.getTextEditInfo(d);E&&(this._editInfo=E,this._editTarget=d,A._editing=!0,E.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var _=this,l=_.gv,d=_._editTarget,x=_.getTargetValue(),C=_.textarea,G=_.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===x||x===Q)&&(x=""),C.value=x,_._editingDOM=C,l.getView().appendChild(G),this.layoutHTML(G,d),this.calculateTextareaHeight(),V(function(){C.focus(),J(B,"mousedown",_.handleWindowClick),J(B,"touchstart",_.handleWindowClick)},10)},handleTextEdit:function(){var O=this,L=O.gv,x=O._editTarget,s=O.getTargetValue(),i=O.input;(null===s||s===Q)&&(s=""),i.value=s,O._editingDOM=i,L.getView().appendChild(i),this.layoutHTML(i,x),V(function(){i.focus(),J(B,"mousedown",O.handleWindowClick),J(B,"touchstart",O.handleWindowClick)},10)},layoutHTML:function(k,z){var r=this.gv,f=r.getZoom();if(z instanceof v.Node){var R=z.getRect();k.style.left=(R.x+R.width/2)*f+r.tx()+"px",k.style.top=(R.y+R.height/2)*f+r.ty()+"px"}else if(z instanceof v.Edge){var P=r.getDataUI(z),R=P._6I;k.style.left=(R.x+R.width/2)*f+r.tx()+"px",k.style.top=(R.y+R.height/2)*f+r.ty()+"px"}},endTextEdit:function(){var z=this,c=z._editInfo.isMultiline?z.wrap:z.input,N=z._editInfo.isMultiline?z.textarea:z.input;z.setTargetValue(N.value),z.gv.getView().removeChild(c),z.gv._editing=!1,delete z._editingDOM,i(B,"mousedown",z.handlelick),i(B,"touchstart",z.handleWindowClick)},setTargetValue:function(l){var j=this,V=j._editTarget,f=j._editInfo,L=f.accessType,H=f.name;if(H&&L||(L="p",H="name"),"p"===L){var o=v.Default.setter(H);V[o](l)}else"a"===L?V.a(H,l):V.s(H,l)},getTargetValue:function(){var l=this,d=l._editTarget,T=l._editInfo,h=T.accessType,r=T.name;if(r&&h||(h="p",r="name"),"p"===h){var b=v.Default.getter(r);return d[b]()}return"a"===h?d.a(r):d.s(r)},createHiddenTextarea:function(){this.hiddenTextarea=M.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(x,j){if(j&&this.computedStyleCache)return this.computedStyleCache;var X=this,$=B.getComputedStyle(x),e=$.getPropertyValue("box-sizing")||$.getPropertyValue("-moz-box-sizing")||$.getPropertyValue("-webkit-box-sizing"),p=parseFloat($.getPropertyValue("padding-bottom"))+parseFloat($.getPropertyValue("padding-top")),P=parseFloat($.getPropertyValue("border-bottom-width"))+parseFloat($.getPropertyValue("border-top-width")),U=X.SIZING_STYLE.map(function(I){return I+":"+$.getPropertyValue(I)}).join(";"),Q={sizingStyle:U,paddingSize:p,borderSize:P,boxSizing:e};return j&&(this.computedStyleCache=Q),Q},calculateTextareaHeight:function(z){z=z||"";
var $=this,l=$.textarea,n=$.hiddenTextarea,w=$.wrap,s=32,W=$.calculateHTMLStyle(l,!1),H=W.paddingSize,U=W.borderSize,Y=W.boxSizing,j=W.sizingStyle;n.setAttribute("style",j+";"+$.HIDDEN_TEXTAREA_STYLE),n.value=l.value+z;var b=n.scrollHeight;"border-box"===Y?b+=U:"content-box"===Y&&(b-=H),l.style.height=b+"px",l.style.marginTop=0-.5*b+"px",w.style.height=Math.max(b,s)+"px",w.style.marginTop=b*-.5+"px"}});var ym=om.ScrollBarInteractor=function(W){mj(ym,this,[W])};ad("ScrollBarInteractor",Sf,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(P){var x=this.gv.getViewRect();return this._41o()&&(x.x+x.width-this.gv.lp(P).x)*this.gv.getZoom()<gr},isH:function(x){var Z=this.gv.getViewRect();return this._40o()&&(Z.y+Z.height-this.gv.lp(x).y)*this.gv.getZoom()<gr},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(P){if(!_k&&Qn(P)&&this.gv.isScrollBarVisible()){var O=this,G=O.isV(P),Y=O.isH(P);(G||Y)&&O.gv.showScrollBar(),O.gv._scrolling=G||Y}},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=I,this.fi({kind:"endScroll",event:q})},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(E){var H=this;if(H.gv.setFocus(E),Rg(E),H.handle_touchmove(E),!(Em(E)>1)&&H.gv._scrolling&&H.gv.isScrollBarVisible()){H._cp=hb(E),H._tx=H.gv.tx(),H._ty=H.gv.ty();var Y=H.isV(E);H._state=Y?"vScroll":"hScroll",_g(H,E),H.fi({kind:"beginScroll",event:E})}},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(W){var r=hb(W),i=this.gv.getViewRect(),M=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-r.y)*M.height/i.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-r.x)*M.width/i.width),this.fi({kind:"betweenScroll",event:W})}});var ef=om.TouchInteractor=function(A,R){R=R||{},R.selectable===Q&&(R.selectable=!0),R.movable===Q&&(R.movable=!0),R.pannable===Q&&(R.pannable=!0),R.pinchable===Q&&(R.pinchable=!0),R.editable===Q&&(R.editable=!0),this.params=R,mj(ef,this,[A])};ad("TouchInteractor",Sf,{ms_edit:1,setUp:function(){var q=this;ef.superClass.setUp.call(q),Jm&&q.params.editable&&q.gv.setEditInteractor(q)},tearDown:function(){var M=this;ef.superClass.tearDown.call(M),Jm&&M.params.editable&&M.gv.setEditInteractor(I)},clear:function(z){var n=this,R=n.gv;R._moving&&(n.fi({kind:"endMove",event:z}),delete R._moving,R.onMoveEnded(),R.dm().endTransaction()),R._panning&&(n.fi({kind:"endPan",event:z}),delete R._panning,R.onPanEnded()),R._pinching&&(n.fi({kind:"endPinch",event:z}),delete R._pinching,R.onPinchEnded()),R._editing&&(n._46O(z),n._77I=n._node=n._edge=n._shape=n._rect=n._89I=n._index=R._editing=I),n._moving=n._panning=n._pinching=n._editing=n._57I=n._data=n._beginHistory=I,n.clearDragging()},handle_touchstart:function(m){var M=this;if(!M.gv._editing){Rg(m),M._57I=I;var i=M.params,B=M.gv,x=B.sm(),U=B.getDataAt(m),b=Em(m);if(1===b){if(Mb(m))return B.handleDoubleClick(m,U),void 0;B.handleClick(m,U),U&&(B.handleMouseDown&&B.handleMouseDown(m,U),M._data=U),i.selectable||(U=I),U&&(x.co(U)||x.ss(U),i.editable&&B.isEditable(U)&&M._79I(m,U,!0)?(M._editing=1,M.startDragging(m)):i.movable&&B.isMovable(U)&&(M._moving=1,M.startDragging(m))),U&&B.isMovable(U)||(M._57I=hb(m),i.pannable&&B.isPannable()&&(M._panning=1,M.startDragging(m),M._translate={x:B.tx(),y:B.ty()}))}else if(i.pinchable&&2===b){if(U&&B._39Q(U))return;M._pinching=1,M.startDragging(m);var g=B.getView(),R=B.getZoom(),C=g.getBoundingClientRect(),z=m.touches[0],f=m.touches[1],r={x:(z.clientX+f.clientX)/2-C.left,y:(z.clientY+f.clientY)/2-C.top};r.x-=B.tx(),r.y-=B.ty(),r.x/=R,r.y/=R,M._p=r,M._d=Re(m)}}},handle_touchend:function(H){var W=this,t=W.gv,v=W._57I,x=W._data;v&&(Oj(v,hb(H))<=1&&!t.getDataAt(H)&&t.sm().cs(),W._57I=I),x&&t.handleMouseUp&&t.handleMouseUp(H,x)},handleWindowTouchEnd:function(V){this.clear(V)},handleWindowTouchMove:function(M){var F=this,g=F.gv,q=Em(M);if(1===q){if(F._editing&&(F._beginHistory||(F._beginHistory=1,g.dm().beginTransaction()),g._editing=1,F._78I(M)),F._moving)F._beginHistory||(F._beginHistory=1,g.dm().beginTransaction()),F.handleMove(M);else if(F._panning){var U=hb(M),K=Si(g,U,F._lastClientPoint);g.setTranslate(F._translate.x+K.x,F._translate.y+K.y),F.fi({kind:g._panning?"betweenPan":"beginPan",event:M}),g._panning=1}}else if(2===q&&F._pinching){var S=Re(M);g.handlePinch(F._p,S,F._d),F._d=S,F.fi({kind:g._pinching?"betweenPinch":"beginPinch",event:M}),g._pinching=1}},handleMove:function(W){var A=this,c=A.gv,m=c.lp(W);c._93O&&c._93O(W,A._data)||(c.moveSelection(m.x-A._lastLogicalPoint.x,m.y-A._lastLogicalPoint.y),A._lastLogicalPoint=m,A.autoScroll(W),A.fi({kind:c._moving?"betweenMove":"beginMove",event:W}),c._moving=1)}});var v=B.ht,lq=v.graph._editor={Math:v.Math,Guide:{}};lq.getStyle=function(J){var u,w=lq.StyleMap;return w&&(u=w[J],u!==Q)?u:lq.DefaultStyleMap[J]},lq.setStyle=function(L,p){var M=lq.StyleMap;M||(M=lq.StyleMap={}),M[L]=p},lq.inEdit=function(r){return r._inXEdit===!0},lq.startEdit=function(I){I._inXEdit=!0,lq.Inject.doInject(I)},lq._46O=function(l){l._inXEdit=!1,lq.Inject.undoInject(l)},lq.toScreenPosition=function(y,e){var U=y.tx(),W=y.ty(),o=y._zoom;return new lq.Math.Vector2(e.x*o+U,e.y*o+W)},lq.checkHit=function(g,J,T){return g.distanceTo(J)<T?!0:!1},lq.toWorldPosition=function(q,G){var Y=q.tx(),x=q.ty(),O=q._zoom;return{x:(G.x-Y)/O,y:(G.y-x)/O}},lq.setAntialias=function(x,S){for(var L,D=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],J=0,R=D.length;R>J&&(L=D[J],!(L in x));J++);x[L],x[L]=S},lq.getTargetCornersOnScreen=function(Q,h){if(!h)return null;var q,l=[];if(Uq(h,Q)){var R=Pb(Q,h);q=[{x:R.x,y:R.y},{x:R.x+R.width,y:R.y},{x:R.x+R.width,y:R.y+R.height},{x:R.x,y:R.y+R.height}]}else{if(!h.getCorners)return null;q=h.getCorners()}return q.forEach(function(G){var P=lq.toScreenPosition(Q,G);l.push(P.x,P.y)}),l},lq.log=function(){};var fg=lq.Inject={_modules:[]};fg.registAsModule=function(l,m){var O={},b={};for(var e in l){var G=m.prototype[e];O[e]=G}l.getBackup=function(m){return O[m]},l.getBackups=function(){return O},b.doInject=function(){for(var n in l)"getBackup"!==n&&(m.prototype[n]=l[n])},b.undoInject=function(){for(var I in l)"getBackup"!==I&&(m.prototype[I]=O[I])},fg._modules.push(b)},fg.doInject=function(r){for(var X,H=fg._modules,y=0,d=H.length;d>y;y++)X=H[y],X.doInject(r)},fg.undoInject=function(n){for(var r,v=fg._modules,M=0,C=v.length;C>M;M++)r=v[M],r.undoInject(n)};var Sf=v.graph.EditInteractor=function(Z){var h=this,W=M.createElement("canvas");W.className="editCanvas",W.style.position="absolute",h._styleMap={},h._canvas=W,h._context=W.getContext("2d"),Sf.superClass.constructor.call(h,Z),this._editDetail=!1,lq.setAntialias(h._context,!1),h._subModules=[new lq.Anchor(h),new lq.RotateX(h),new lq.MoveDummy(h),new lq.Rect(h),new lq.Curve(h),new lq.MoveHelper(h)],h._gridGuide=new lq.Guide.Grid(h),h._rectGuide=new lq.Guide.Rect(h),h._hoverGuide=new lq.Guide.Hover(h)},jp=Sf;v.Default.def(Sf,v.graph.Interactor,{ms_edit:1,ms_fire:1}),Y.defineProperties(Sf.prototype,{editDetail:{get:function(){var J=!!this._editDetail;return J},set:function(m){var h=this,$=h._editDetail;$!==m&&(h._editDetail=m,h.gv._editing=m,h.fp("editDetail",$,m),h.fp("pointsEditingMode",$,m),h.fi({kind:m?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(j){(!this._editDetail||j)&&(this.gv._editing=j,j||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(X){this._editing=X,this.gvEditing=X}},pointsEditingMode:{get:function(){return this.editDetail},set:function(B){var e=this;e.editDetail!==B&&(B?e._tryEnterEditDetailMode():e._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var L=this._gridEnabled;if(!L)return!1;var h=this.gv;return h?!0:!0},set:function(n){n!==this._gridEnabled&&(this._gridEnabled=n,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(s){s!==this._agEnabled&&(this._agEnabled=s,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Sf.prototype.getSubModule=function(J){var x,E,L,I=this._subModules;for(E=0,L=I.length;L>E;E++)if(x=I[E],x.catalog===J)return x},Sf.prototype.invokeSubModule=function(m,h){var A=this,U=A._subModules;if(U)for(var s,q,d,$=Array.prototype.slice.call(arguments,2),Y=0,D=U.length;D>Y;Y++)if(s=U[Y],q=s[m],q&&(d=q.apply(s,$),d!=Q&&h))return s},Sf.prototype.invokeSubModuleInverse=function(L,N){var l=this,B=l._subModules;if(B)for(var X,y,c,V=Array.prototype.slice.call(arguments,2),v=B.length-1;v>=0;v--)if(X=B[v],y=X[L],y&&(c=y.apply(X,V),c!=Q&&N))return X},Sf.prototype.setUp=function(){lq.log("setUp");var w=this,h=w.gv,n=h.getView(),a=w._canvas;Sf.superClass.setUp.call(w),h.setEditInteractor(w),h._79O?n.insertBefore(a,h._79O):n.appendChild(a),lq.startEdit(h),w.invokeSubModule("setUp"),h.dm().mm(w._onDataModelChanged,w),h.dm().md(w._onDataPropertyChanged,w)},Sf.prototype.tearDown=function(){lq.log("tearDown");var f=this,o=f.gv,Y=o.getView();f._resetCustomCursorStyle(),Sf.superClass.tearDown.call(f),o.dm().umm(f._onDataModelChanged,f),o.dm().umd(f._onDataPropertyChanged,f),o.setEditInteractor(null),Y.removeChild(f._canvas),f._drawTimer&&(S(f._drawTimer),f._drawTimer=null),lq._46O(o),f.invokeSubModule("tearDown")},Sf.prototype._onDataModelChanged=function(Z){var x=this;("clear"===Z.kind||"remove"===Z.kind&&x.editDetail&&Z.data===x.getSubModule("Curve").target)&&(x.editDetail=!1,x._42())},Sf.prototype._onDataPropertyChanged=function(P){var f=this;if(f.editDetail){var G=f.getSubModule("Curve"),x=P.data;x===G.target&&(x._writing||G._handleDataChanged(P))}},Sf.prototype.clear=function(){lq.log("clear")},Sf.prototype.redraw=function(){this._42()},Sf.prototype._42=function(){var M=this;M._drawTimer||(M._drawTimer=V(function(){M._drawTimer=null,M.drawImpl()},0))},Sf.prototype.drawImpl=function(){var s;for(s in{_42:!0})break;return function(){var H=this,X=H._canvas,$=H.gv,R=$.getWidth(),p=$.getHeight(),i=H._context,D=v.Default.getInternal(),o=B.devicePixelRatio;(X.width!==R||X.height!==p)&&D.setCanvas(X,R,p,o),i.clearRect(0,0,X.width,X.height);var l=H._getValidSelection();i.save(),i.scale(o,o),H._gridGuide._42(),H.invokeSubModuleInverse(s,!1,i,$,l),H._rectGuide._42(),H._hoverGuide._42(),i.restore()}}(),Sf.prototype._getValidSelection=function(){var m=this,P=m.gv,b=P.sm().getSelection(),v=[];return b.each(function(A){P.isVisible(A)&&P.isEditable(A)&&v.push(A)}),v},Sf.prototype.handle_touchmove=function(y){return this.handle_mousemove(y)},Sf.prototype.handle_mousemove=function(p){if(!v.Default.isDragging()){var k=this;if((k.editDetail||!vp()&&!Ei(p))&&!k.gv._externalEditing)if(k.gvEditing=!1,k._checkEdit(p))k.gvEditing=!0;else{if(!k.getStyle("hoverGuideVisible"))return;k.hoverData=k.gv.getDataAt(p),k._42()}}},Sf.prototype.handle_touchstart=function(L){return this.handle_mousedown(L)},Sf.prototype.handle_mousedown=function(i){Rg(i);var P=this;if((P.editDetail||!vp()&&!Ei(i))&&!P.gv._externalEditing){if(Mb(i)&&!i.clickThrough){if(P.editDetail){if(P._tryQuitEditDetailMode(i))return}else if(P._tryEnterEditDetailMode())return;P.gv.dm().beginTransaction();var _=P.invokeSubModule("handleDoubleClick",!0,i);if(P.gv.dm().endTransaction(),_)return}var G=P._checkEdit(i);G&&(P._downPosition=P._getLogicalPoint(i),P.gv.dm().beginTransaction(),G.startEdit(P,i),P.editing=!0)}},Sf.prototype._checkEdit=function(t){var q=this,D=q.gv,g=q._getLogicalPoint(t),K=q.invokeSubModule("check",!0,D,t,g)||null;return q._editMod=K,K},Sf.prototype.handleWindowTouchMove=function(y){return this.handleWindowMouseMove(y)},Sf.prototype.handleWindowMouseMove=function(T){var w=this,s=w._downPosition;if(s){var j=w._getLogicalPoint(T);if(j.distanceTo(s)<w.getStyle("moveSensitivity"))return;delete w._downPosition}var D=w._editMod;D&&D.handleEdit(w.gv,T)},Sf.prototype._getLogicalPoint=function(W){var c=this,a=v.Default.getLogicalPoint(W,c._canvas);return new lq.Math.Vector2(a)},Sf.prototype.handleWindowTouchEnd=function(e){return this.handleWindowMouseUp(e)},Sf.prototype.handleWindowMouseUp=function(){var O;for(O in{_46O:!0})break;return function(F){var x=this;x.editing=!1,x.setCursor("default"),x.invokeSubModule(O,!1,F),x._42(),x.gv.dm().endTransaction()}}(),Sf.prototype.handle_mousewheel=function(a){var T=this;Rg(a),T.invokeSubModule("preHandleScroll",!0)||T.gv.handleScroll(a,a.wheelDelta)},Sf.prototype.handleDelete=function(){var a=this;if(!a.editDetail){a.gv.dm().beginTransaction();var W=a.invokeSubModule("handleNormalStateDelete",!0);return a.gv.dm().endTransaction(),W||a.gv.removeSelection(),void 0}a.gv.dm().beginTransaction(),a.invokeSubModule("handleDelete",!0),a.gv.dm().endTransaction(),a._42()},Sf.prototype.handle_keydown=function(y){var h=this;if((y.metaKey||y.ctrlKey)&&h._42(),vp(y)&&!h.editing)return h.gvEditing=!1,h.setCursor("default"),h._42(),void 0;var u=ih(y);return h.editDetail?((u||uq(y))&&(h.editDetail=!1,h._42()),h.gv.dm().beginTransaction(),h.invokeSubModule("handle_keydown",!0,y),h.gv.dm().endTransaction(),void 0):(h.gv.dm().beginTransaction(),h.invokeSubModule("handleNormalStateKeyDown",!0,y),h.gv.dm().endTransaction(),u&&h._tryEnterEditDetailMode(),void 0)},Sf.prototype.handle_keyup=function(j){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,j),this.gv.dm().endTransaction()},Sf.prototype._tryEnterEditDetailMode=function(){var q=this;return!q.editDetail&&q.invokeSubModule("canEnterEditDetailMode",!0)&&1===q._getValidSelection().length?(q.editDetail=!0,q._42(),!0):void 0},Sf.prototype._tryQuitEditDetailMode=function(K){var g=this;return g.editDetail?!K||g.invokeSubModule("canQuitEditDetailMode",!0,K)?(g.editDetail=!1,g._42(),!0):!1:!1},Sf.prototype.setStyle=function(G,F,o){var j=this;o?lq.setStyle(G,F):j._styleMap[G]=F,"baseColor"===G&&(pn=F),j.fp("styleChanged",null,{key:G,value:F,base:o}),j._42()},Sf.prototype.getStyle=function(k){var K=this,q=K._styleMap[k];return q!==Q?q:lq.getStyle(k)},Sf.prototype.setCursor=function(h){this._resetCustomCursorStyle(),v.graph.EditInteractor.superClass.setCursor.call(this,h)},Sf.prototype._drawHostGuide=function(c){var W=this,f=W._context,O=W.gv;lq.Icons.DrawIcon(W,f,lq.Icons.NodeHoverGuide,c.corners);var _=c.host;if(_){var N=O.getAttachPoints(_);if(N&&N.length)for(var v=0,t=N.length;t>v;v++){var J=N[v],C=ik(O,_,0,J.offsetX||0,J.offsetY||0,J.x,J.y);C=lq.toScreenPosition(O,C),C.isAttach=c.attach===v,lq.Icons.DrawIcon(W,f,lq.Icons.AttachPoint,C)}}},Sf.prototype._resetCustomCursorStyle=function(){var s=this;if(s._customStyle){var A=this.gv.getView();A.classList&&A.classList.remove&&A.classList.remove(s._customStyle),s._customStyle=null}},Sf.prototype._setRotateCursor=function(S){var l=this,W=l._cursorFactory;W||(W=l._cursorFactory=new lq.CursorFactory(l));var J=W.getRotateCursor(S),g=l.gv.getView();l._resetCustomCursorStyle(),l._customStyle=J,g.classList&&g.classList.add&&g.classList.add(J)};var Lj=lq.Group=function(G){var V=this;V._entities=G,V._64O=0,V._position={x:0,y:0},V._scale={x:1,y:1},V._anchor={x:.5,y:.5},V._anchor2={x:.5,y:.5}};Lj.prototype={},Lj.prototype.constructor=Lj;var gc=null;Lj.findOrCreateGroup=function(z){if(gc&&gc.checkIsMe(z))return gc;var K=new lq.Group(z);return K.getKeyOb()?(gc=K,K):void 0},Lj.prototype.checkIsMe=function(P){var j=this._entities;if(j.length!==P.length)return!1;var h,v={},E=P.length;for(h=0;E>h;h++)v[P[h]._id]=!0;for(h=0;E>h;h++)if(!v[j[h]._id])return!1;return!0},Lj.prototype.getRotation=function(){return this._64O},Lj.prototype.getPosition=function(){return this._position},Lj.prototype.getAnchor=function(){return this._anchor},Lj.prototype.getWidth=function(){return this._width},Lj.prototype.getScale=function(){return this._scale},Lj.prototype.getSize=function(){return{width:this._width,height:this._height}},Lj.prototype.getHeight=function(){return this._height},Lj.prototype.getKeyOb=function(){for(var q=this._entities,W=q.length-1;W>=0;W--){var T=q[W];if(this.isNode(T))return T}},Lj.prototype.getAnchor2=function(){var E=this,N=E.rotateCenter;if(N)return N;var s=E.getKeyOb();if(!s)return E._anchor;var P=E._anchor2,D=s.getMatrix();return D.tf({x:s.getWidth()*(P.x-s.getAnchor().x),y:s.getHeight()*(P.y-s.getAnchor().y)})},Lj.prototype.setAnchor2=function(R,u){var q=this,a=q.getKeyOb();if(a){var A,U=a.getMatrix();A="number"==typeof R?{x:R,y:u}:R;var o=U.tfi(A);q._anchor2={x:a.getAnchor().x+o.x/a.getWidth(),y:a.getAnchor().y+o.y/a.getHeight()}}},Lj.prototype.setRotation=function(){},Lj.prototype.beginRotate=function(K){this.rotateCenter=K.pos,this.rotateMode=K.groupRotateMode},Lj.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Lj.prototype.addRotation=function(Y,B,R){return"batch"===B?this._addRotationInBatchMode(Y,R):"block"===B?this._addRotationInBlockMode(Y,R):void 0},Lj.prototype._addRotationInBlockMode=function(m,B){var p=this,u=p.rotateCenter||p.getPosition();p._entities.forEach(function(U){if(p.isNode(U)&&(!B||B(U))){var M=U.getMatrix();M.translate(-u.x,-u.y),M.rotate(m),M.translate(u.x,u.y);var j=Math.sign(U.getScale().x);U.setRotation($(M.b*j,M.a*j)),U.setPosition(M.tx,M.ty)}})},Lj.prototype._addRotationInBatchMode=function(Q){var S=this,U=S._anchor2;S._entities.forEach(function(v){if(S.isNode(v)&&(!filter||filter(v))){var i=v.getAnchor(),y=v.getMatrix(),o=y.tf({x:v.getWidth()*(U.x-i.x),y:v.getHeight()*(U.y-i.y)}),P=new lq.Math.Matrix2d;P.set(y.a,y.b,y.c,y.d,y.tx,y.ty),P.translate(-o.x,-o.y),P.rotate(Q),P.translate(o.x,o.y);var H=Math.sign(v.getScale().x);v.setRotation($(P.b*H,P.a*H)),v.setPosition(P.tx,P.ty)}})},Lj.prototype.setPosition=function(f){var T,g,C,S,X=this,A=X._position,d=f.x-A.x,Q=f.y-A.y,l=X._entities;for(g=0,C=l.length;C>g;g++)T=l[g],Fg(T)&&(S=T.getPosition(),T.setPosition(S.x+d,S.y+Q));X._position=f},Lj.prototype.setScale=function(h,v){var k=this,L=h/k._scale.x,O=v/k._scale.y;k._adjustChildScaleOrSize(L,O,"size"),k._scale={x:h,y:v}},Lj.prototype.getRect=function(){var q=this,u=q._position,$=q._width,B=q._height;return{x:u.x-$/2,y:u.y-B/2,width:$,height:B}},Lj.prototype.setSize=function(a,u){var A=this,a=Math.max(1,a),u=Math.max(1,u),h=a/A._width,$=u/A._height;A._adjustChildScaleOrSize(h,$,"size"),A._width=a,A._height=u},Lj.prototype._adjustChildScaleOrSize=function(v,B,_){var A,u,H,g,O,n,b,s,z,q,p,t,X,o,r=this,I=r._position,W=r._entities,i=new lq.Math.Matrix2d;for(u=0,H=W.length;H>u;u++)if(A=W[u],r.isNode(A)){if(g=A.getPosition(),O=A.getRotation(),n=A.getWidth(),b=A.getHeight(),s=A.getScale(),p=s.x*n,t=s.y*b,i.identity().scale(p,t).rotate(O).translate(g.x,g.y).translate(-I.x,-I.y).rotate(-r._64O),O=$(i.b*Math.sign(p),i.a*Math.sign(p)),i.scale(v,B),z=Math.cos(O),q=Math.sin(O),Math.abs(z)<.001?(X=i.b/q,o=-i.c/q):(X=i.a/z,o=i.d/z),"scale"===_)A.setScale(X/n,o/b);else if("size"===_){var N=X/s.x,J=o/s.y;A.setScale(jg(X)*Math.abs(s.x),jg(o)*Math.abs(s.y)),A.setSize(Math.max(.1,Math.abs(N)),Math.max(.1,Math.abs(J)))}i.rotate(r._64O).translate(I.x,I.y),A.setPosition(i.tx,i.ty)}},Lj.prototype.getMatrix=function(){var x=this,X=x._position,O=v.Default.getInternal(),p=x._scale;return new O.Mat(x._64O,X.x,X.y,p.x,p.y)},Lj.prototype.toGlobal=function(R){return this.getMatrix().tf(R)},Lj.prototype.getCorners=function(){var y=this,J=y._width,T=y._height,I=y._anchor,b=-J*I.x,E=-T*I.y,s=y.getMatrix();return[s.tf(b,E),s.tf(b,E+T),s.tf(b+J,E+T),s.tf(b+J,E)]},Lj.prototype.calcInfo=function(){var c,W,g,A,y,h,M=this,$=[],o=M._entities,k=M._64O;for(A=0,y=o.length;y>A;A++)h=o[A],M.isNode(h)&&h.getCorners&&$.push.apply($,h.getCorners());if($.length){var F=Math.cos(-k),I=Math.sin(-k),s=1/0,L=-1/0,q=1/0,p=-1/0;for(A=0,y=$.length;y>A;A++)g=$[A],c=g.x,W=g.y,g.x=F*c-I*W,g.y=I*c+F*W,s=Math.min(s,g.x),L=Math.max(L,g.x),q=Math.min(q,g.y),p=Math.max(p,g.y);M._width=(L-s)/M._scale.x,M._height=(p-q)/M._scale.y,F=Math.cos(k),I=Math.sin(k);var R=M._anchor;c=s+(L-s)*R.x,W=q+(p-q)*R.y,M._position={x:F*c-I*W,y:I*c+F*W}}},Lj.prototype.isNode=function(N){return Fg(N)?Uq(N)?N.size()?!1:!0:!0:!1},Lj.prototype._42=function(b,N,e){var j,m,Z,F,n,g,Q,r,S=this,a=S._entities,W=S.rotateMode;for("batch"===W&&(r=S.getKeyOb()),j=0,m=a.length;m>j;j++)Z=a[j],S.isNode(Z)&&(g=Z.getRect(),F=lq.toScreenPosition(e,{x:g.x,y:g.y}),n=lq.toScreenPosition(e,{x:g.x+g.width,y:g.y+g.height}),Q={min:F,max:n},Z===r&&(Q.isKeyOb=!0),lq.Icons.DrawIcon(b,N,lq.Icons.GroupSubEntityRect,Q))};var Ec=lq.CurveActiving=function(b,p){this._curve=b,this._interactor=b._interactor,this.silent=!0;for(var s in p)this[s]=p[s];delete this.silent};Ec.prototype={},Ec.prototype.constructor=Ec,Y.defineProperties(Ec.prototype,{point:{get:function(){return this._point},set:function(H){var V=this;V._point=H,V.editingCtrl||V.silent||V._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(v){var l=this;l._pairs=v,l.editingCtrl&&!l.silent&&l._firePointChange()}}}),Ec.prototype._firePointChange=function(){var m=this,A=m.getCurrentEditingPoint(),L=m._interactor;if(!A)return L.fi({kind:"selectPoint"}),void 0;var e=this._curve.target;if(e){var X=lq.getDataMatrix(e).invert(),q=A.e;A=X.apply(lq.toWorldPosition(L.gv,A)),A.e=q;var $=m._lastFirePoint;$&&Math.abs(A.x-$.x)<1e-5&&Math.abs(A.y-$.y)<1e-5&&(A.e==Q&&$.e==Q||Math.abs(A.e-$.e)<1e-5)||(m._lastFirePoint=A,L.fi({kind:"selectPoint",x:A.x,y:A.y,e:A.e}))}},Ec.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Ec.prototype.getCurrentEditingPoint=function(){var T=this,B=T.editingCtrl;if(B){var G=T.pairs;if(G){var R=G[B.pairId];if(R){var Y=R[B.type];if(Y)return Y}}}return T._point};var Rd=lq.CursorFactory=function(X){var c=this;c._interactor=X,c._rotateCursorStyles={}};Rd.prototype={},Rd.prototype.constructor=Rd,Rd.prototype.getRotateCursor=function(j){var f=this;0>j&&(j+=2*Math.PI);var W=f._interactor,G=W.getStyle("rotateCursorSize"),r=W.getStyle("rotateCursorRound"),T=Math.round(180*(j/Math.PI)/r);T*r>=360&&(T=0);var V=f._rotateCursorStyles,h="htCustomRotateStyle_"+G+"_"+r+"_"+T;return V[h]||(f._produceRotateCursor(h,G,r,T),V[h]=!0),h},Rd.prototype._produceRotateCursor=function(J,T,$,P){var y=this;y._interactor;var z=y._canvas;z||(z=y._canvas=M.createElement("canvas")),z.width=z.height=T*devicePixelRatio,z.style.width=z.style.height=T+" px";var x=z.getContext("2d");lq.setAntialias(x,!1),x.scale(devicePixelRatio,devicePixelRatio);var e,t,R,c,D,u=Math.round(T/2),A=""+u+" "+u+",auto !important;",S=4;e=Math.PI/180*P*$,x.clearRect(0,0,T,T),x.save(),x.scale(T/32,T/32),x.translate(16,15),x.rotate(e+Math.PI/2),x.beginPath(),x.moveTo(-8,0),x.lineTo(-8,S),x.lineTo(-8+S,S),x.moveTo(8,0),x.lineTo(8,S),x.lineTo(8-S,S),x.moveTo(-8,S),x.quadraticCurveTo(0,-6,8,S),x.restore(),x.lineCap="round",x.lineJoin="miter",x.strokeStyle="white",x.lineWidth=4,x.stroke(),x.strokeStyle="black",x.lineWidth=2,x.stroke(),t=JSON.stringify(z.toDataURL()),c="cursor:url("+t+")"+A,1!==devicePixelRatio&&(R='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+T+'px" height="'+T+'px"><image xlink:href='+t+' width="'+T+'" height="'+T+'"/></svg>',c+="cursor:url(data:image/svg+xml;base64,"+btoa(R)+")"+A,c+="cursor:-webkit-image-set(url("+t+")"+devicePixelRatio+"x,url("+t+")1x)"+A),D=M.createElement("style"),D.textContent="body."+J+" *, ."+J+"{"+c+"}",M.head.appendChild(D)};var hp=lq.Guide.Grid=function(X){var I=this;I._interactor=X,I._alignmentGuideId=0,I._xAlignmentGuide=[],I._yAlignmentGuide=[]};hp.prototype={},hp.prototype.constructor=hp,Y.defineProperties(hp.prototype,{gridBlockSize:{get:function(){var W=this;return W._gridBlockSize||W._interactor.getStyle("gridBlockSize")},set:function(z){this._gridBlockSize=z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Y=this;return Y._gridThickLinesEvery||Y._interactor.getStyle("gridThickLinesEvery")},set:function(B){this._gridThickLinesEvery=B,this._interactor._42()}},gridEnabled:{get:function(){var $=this,h=$._interactor;return h.gridEnabled&&$.isValidGrid()}}}),hp.prototype._42=function(){var D=this,W=D._interactor;D.gridEnabled&&D.drawGrid(),W.alignmentGuideEnabled&&D.drawAlignmentGuide()},hp.prototype.makeMatrix=function(){var P=this,w=P._interactor.getStyle("gridAngle"),m=P._interactor.getStyle("gridRotation"),I=new lq.Math.Matrix2d,e=Math.sin(w),z=Math.cos(w);return I.set(1,0,z,e,0,0),I.rotate(m),I},hp.prototype.isValidGrid=function(){var X=this,v=Math.PI,E=X._interactor,V=E.gv;if(V._zoom<E.getStyle("gridZoomThreshold"))return!1;var M=E.getStyle("gridAngle"),d=Math.abs(180*(M%v/v)),B=1-1e-8;return B>d||d>180-B?!1:!0},hp.prototype.drawAlignmentGuide=function(){var $=this,X=$._interactor,g=X.gv,j=X._canvas,M=X._context,_=j.width,I=j.height,e=g.tx(),K=g.ty(),c=g._zoom;M.beginPath(),M.strokeStyle=X.getStyle("gridAlignmentGuideColor"),M.lineWidth=1,$._xAlignmentGuide.forEach(function(A){var h=A.p*c+e;M.moveTo(h,0),M.lineTo(h,I)}),$._yAlignmentGuide.forEach(function(I){var W=I.p*c+K;M.moveTo(0,W),M.lineTo(_,W)}),M.stroke()},hp.prototype.drawGrid=function(){function h(q,a,m,h){var Y=lq.toScreenPosition(E,g.apply({x:q,y:a})),w=lq.toScreenPosition(E,g.apply({x:m,y:h}));u.moveTo(Y.x,Y.y),u.lineTo(w.x,w.y)}var w=this,o=w._interactor,C=w.gridBlockSize,t=w.gridThickLinesEvery,F=o.getStyle("gridThickColor"),M=o.getStyle("gridLightColor"),E=o.gv,H=o._canvas,u=o._context,v=H.width,V=H.height,g=w.makeMatrix(),D=g.applyInverse(lq.toWorldPosition(E,{x:0,y:0})),S=g.applyInverse(lq.toWorldPosition(E,{x:v,y:0})),b=g.applyInverse(lq.toWorldPosition(E,{x:0,y:V})),Y=g.applyInverse(lq.toWorldPosition(E,{x:v,y:V})),L=Math.min(D.x,S.x,b.x,Y.x),U=Math.max(D.x,S.x,b.x,Y.x),K=Math.min(D.y,S.y,b.y,Y.y),X=Math.max(D.y,S.y,b.y,Y.y);v=U-L,V=X-K;var $=Math.ceil(L/C),P=Math.floor(U/C),i=Math.ceil(K/C),d=Math.floor(X/C);E.tx(),E.ty(),E._zoom;var O,e,J;for(u.save(),u.lineWidth=1,u.beginPath(),u.strokeStyle=F,J=Math.ceil($/t)*t;P>=J;J+=t)O=J*C,h(O,K,O,X);for(J=Math.ceil(i/t)*t;d>=J;J+=t)e=J*C,h(L,e,U,e);for(u.stroke(),u.beginPath(),u.strokeStyle=M,J=$;P>=J;J++)0!==J%t&&(O=J*C,h(O,K,O,X));for(J=i;d>=J;J++)0!==J%t&&(e=J*C,h(L,e,U,e));u.stroke(),u.restore()},hp.prototype.getAlignmentGuides=function(){var P=this;return{x:P._xAlignmentGuide,y:P._yAlignmentGuide}},hp.prototype.addAlignmentGuide=function(V,R,H){var v=this,a="x"===V?v._xAlignmentGuide:v._yAlignmentGuide,H=H?H:++v._alignmentGuideId,Y={p:R,id:H};if(a.length){var y=v._findClosestAlignmentGuide(Y.p,a);y.dis<0?a.splice(y.index+1,0,Y):a.splice(y.index,0,Y)}else a.push(Y);return v._interactor._42(),H},hp.prototype.findClosest=function(x,z,k){var N=this,m=N._interactor,D=m.gv;k&&(x=lq.toWorldPosition(D,x));var P,d,O,C=1/0,Y=1/0,f=x.x,S=x.y;if(N.gridEnabled){var U=N.gridBlockSize,n=N.makeMatrix(),h=n.applyInverse(x);h=n.apply({x:Math.round(h.x/U)*U,y:Math.round(h.y/U)*U}),C=h.x-f,Y=h.y-S,O=!0}if(m.alignmentGuideEnabled&&(P=N._findClosestAlignmentGuide(f,N._xAlignmentGuide).dis,d=N._findClosestAlignmentGuide(S,N._yAlignmentGuide).dis,Math.abs(P)<Math.abs(C)&&(C=P,O=!0),Math.abs(d)<Math.abs(Y)&&(Y=d,O=!0)),O){O=!1;var M=D._zoom,R=m.getStyle("smartGuideThreshold")/M,$={};if(Math.abs(C)<R&&"y"!==z&&($.x=k?C*M:C,O=!0),Math.abs(Y)<R&&"x"!==z&&($.y=k?Y*M:Y,O=!0),O)return $}},hp.prototype._findClosestAlignmentGuide=function(N,g){if(!g.length)return{dis:1/0};for(var f,e=0,_=g.length-1;_-e>1;)f=Math.floor((e+_)/2),g[f].p<N?e=f:_=f;var E=g[e].p-N,b=g[_].p-N;return Math.abs(E)<=Math.abs(b)?{line:g[e],dis:E,index:e}:{line:g[_],dis:b,index:_}},hp.prototype.removeAllAlignmentGuide=function(h){var Q=this;"y"!==h&&(Q._xAlignmentGuide=[]),"x"!==h&&(Q._yAlignmentGuide=[]),Q._interactor._42()},hp.prototype.removeAlignmentGuide=function(u){for(var I,y,m,W=this,b=W._xAlignmentGuide,S=0;2>S;S++)for(b=0===S?W._xAlignmentGuide:W._yAlignmentGuide,I=0,y=b.length;y>I;I++)if(m=b[I],m.id===u)return b.splice(I,1),W._interactor._42(),{axis:0===S?"x":"y",position:m.p};return!1},hp.prototype.adjustAlignmentGuide=function(M,g){var D=this,n=D.removeAlignmentGuide(M);return n?(D.addAlignmentGuide(n.axis,g,M),!0):!1};var he=lq.Guide.Rect=function($){var J=this;J._interactor=$};he.prototype={},he.prototype.constructor=he,he.prototype.gatherRects=function(){var W,h,L,g,r=this,p=r._interactor.gv,b=[],Z=[],I={x:b,y:Z},X={},m=p.getDataModel(),K=m.a("width"),n=m.a("height");K&&n&&(W=0,h=0,L=K,g=n,b.push({node:m,type:0,p:W},{node:m,type:1,p:W+L/2},{node:m,type:2,p:W+L}),Z.push({node:m,type:0,p:h},{node:m,type:1,p:h+g/2},{node:m,type:2,p:h+g}),X[m._id||0]={x:W,y:h,width:L,height:g}),m.each(function(F){if(Fg(F)&&!p.isSelected(F)&&p.isVisible(F)&&p.isValidGuideLineSource(F)){var f=!1;if(p.sm().getSelection().each(function(L){f||(F.isHostOn(L)?f=!0:F.isDescendantOf(L)&&(f=!0))}),!f){var z=F.getRect();W=z.x,h=z.y,L=z.width,g=z.height,b.push({node:F,type:0,p:W},{node:F,type:1,p:W+L/2},{node:F,type:2,p:W+L}),Z.push({node:F,type:0,p:h},{node:F,type:1,p:h+g/2},{node:F,type:2,p:h+g}),X[F._id]=z}}}),b.sort(function(B,G){return B.p-G.p}),Z.sort(function(Q,h){return Q.p-h.p}),r._grid=I,r._87I=X},he.prototype.gatherLines=function(c,H,E){var X,l,T,C,V,e,G,I,N,p,y,J,u=this,$=[u.findClosest({x:c.x,y:c.y},H),u.findClosest({x:c.x+c.w/2,y:c.y+c.h/2},H),u.findClosest({x:c.x+c.w,y:c.y+c.h},H)],k={},s=u._87I;E=E||255;var S,Y;for(u._guideLine=[],X=0;2>X;X++)for(k={},0===X?(C="y",I=c.x,N=I+c.w):(C="x",I=c.y,N=I+c.h),l=0;3>l;l++)V=$[l],V&&isFinite(V[C])&&(S=1<<3*X+l,E&S&&(e=V[C+"Line"],G=e.node,Y=G._id||0,k[Y]||(k[Y]=!0,J=s[Y],"y"===C?(p=J.x,y=J.x+J.width):(p=J.y,y=J.y+J.height),T=e.p,u._guideLine.push({type:C,a:I,b:N,c:p,d:y,p:T,center:1===e.type}))))},he.prototype._binarySearchClosest=function(r,h){if(!h.length)return{dis:1/0};for(var S,o=0,f=h.length-1;f-o>1;)S=Math.floor((o+f)/2),h[S].p<r?o=S:f=S;var k=h[o].p-r,x=h[f].p-r;return Math.abs(k)<=Math.abs(x)?{line:h[o],dis:k}:{line:h[f],dis:x}},he.prototype.findClosest=function(m,c,R){var o=this,J=o._interactor,N=J.gv,C=o._grid;R&&(m=lq.toWorldPosition(N,m));var P,b=o._binarySearchClosest(m.x,C.x),p=o._binarySearchClosest(m.y,C.y),$=b.dis,d=p.dis,S=N._zoom,G=J.getStyle("smartGuideThreshold")/S,q={};return Math.abs($)<G&&"y"!==c&&(q.x=R?$*S:$,q.xLine=b.line,P=!0),Math.abs(d)<G&&"x"!==c&&(q.y=R?d*S:d,q.yLine=p.line,P=!0),P?q:void 0},he.prototype._42=function(){var O=this,P=O._guideLine;if(P&&!v.Default.isCtrlDown()){var D=O._interactor;if(D.getStyle("guideLineVisible")){var y,A,$,N,i,C,b,Q,d,f,c,e,q,l,o,G,w,W=D.gv,B=D._context,L=W.tx(),T=W.ty(),K=W._zoom,m=D.getStyle("guideLineTextSpacing");for(y=0,A=P.length;A>y;y++)$=P[y],Q=$.type,d=$.p,f=$.a,c=$.b,e=$.c,q=$.d,l=Math.min(f,e),o=Math.max(c,q),"x"===Q?(N=d*K+L,i=l*K+T,C=N,b=o*K+T):(N=l*K+L,i=d*K+T,C=o*K+L,b=i),lq.Icons.DrawIcon(D,B,lq.Icons.MoveLineGuide,{rect:[N,i,C,b],center:$.center}),q>=f&&c>=e||(l=f>q?q:c,o=f>q?f:e,w=o-l,"x"===Q?($.center2center||(N-=m,C=N),i=l*K+T,b=o*K+T,G=lq.Icons.MoveLineGuideDistanceV):"y"===Q&&($.center2center||(i-=m,b=i),N=l*K+L,C=o*K+L,G=lq.Icons.MoveLineGuideDistanceH),lq.Icons.DrawIcon(D,B,G,{x0:N,y0:i,x1:C,y1:b,dis:w}))}}},he.prototype.clear=function(){this._guideLine=null};var cc=lq.Guide.Hover=function(l){var u=this;u._interactor=l};cc.prototype={},cc.prototype.constructor=cc,Y.defineProperties(cc.prototype,{}),cc.prototype._42=function(){var C=this._interactor;if(C.getStyle("hoverGuideVisible")&&!C.gvEditing){var e=C.hoverData,m=C.gv;if(!Fg(e)||m.isSelected(e))return C.hoverData=null,void 0;var i=Pb(m,e),O=lq.toScreenPosition(m,{x:i.x,y:i.y}),W=lq.toScreenPosition(m,{x:i.x+i.width,y:i.y+i.height});lq.Icons.DrawIcon(C,C._context,lq.Icons.HoverDataRect,{min:O,max:W,color:C.getStyle("hoverGuideColor")||C.getStyle("baseColor")})}},lq.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};
var Nb=lq.Icons={},Nh=1e4,jc=null,pn=lq.DefaultStyleMap.baseColor,Ih="rgb(183,232,135)",Wd="rgb(255,204,153)",Qf=6;v.Default.setImage("Icons.RectPoint",{width:Qf,height:Qf,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pn}},rect:[0,0,Qf,Qf]}]}),Nb.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var L=Nb.GroupSubEntityRect.data;if(!L)return[];var q=L.min,J=L.max;return[q.x,q.y,q.x,J.y,J.x,J.y,J.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Nb.GroupSubEntityRect.data.isKeyOb?pn:pn}}}]};var eg=4;Nb.HoverDataRect={comps:[{type:"shape",points:{func:function(){var $=Nb.HoverDataRect.data;if(!$)return[];var B=$.min,O=$.max,x=eg;return B.x-=x,B.y-=x,O.x+=x,O.y+=x,[B.x,B.y,B.x,O.y,O.x,O.y,O.x,B.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Nb.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Nb.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nb.Line.data.P1.x,Nb.Line.data.P1.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nb.Line.data.P2.x,Nb.Line.data.P2.y],Qf,Qf]}}}]},Nb.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Nb.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Nb.Rect={comps:[{type:"shape",points:{func:function(){var k=Nb.Rect.data;if(!k)return[];var m=k.LT,L=k.LB,h=k.RB,o=k.RT;return[m.x,m.y,L.x,L.y,h.x,h.y,o.x,o.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return pn}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},rect:{func:function(){return[[Nb.Rect.data.LT.x,Nb.Rect.data.LT.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},rect:{func:function(){return[[Nb.Rect.data.LB.x,Nb.Rect.data.LB.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},rect:{func:function(){return[[Nb.Rect.data.RB.x,Nb.Rect.data.RB.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},rect:{func:function(){return[[Nb.Rect.data.RT.x,Nb.Rect.data.RT.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},visible:{func:function(){return Nb.Rect.data.L?!0:!1}},rect:{func:function(){return[[Nb.Rect.data.L.x,Nb.Rect.data.L.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},visible:{func:function(){return Nb.Rect.data.R?!0:!1}},rect:{func:function(){return[[Nb.Rect.data.R.x,Nb.Rect.data.R.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},visible:{func:function(){return Nb.Rect.data.T?!0:!1}},rect:{func:function(){return[[Nb.Rect.data.T.x,Nb.Rect.data.T.y],Qf,Qf]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nb.Rect.data.rotation}},visible:{func:function(){return Nb.Rect.data.B?!0:!1}},rect:{func:function(){return[[Nb.Rect.data.B.x,Nb.Rect.data.B.y],Qf,Qf]}}}]};var Ln=16;v.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return pn}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return pn}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Nb.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Nb.Anchor.data.POS.x,Nb.Anchor.data.POS.y],Ln,Ln]}}}]},Nb.TipShiftX=12,Nb.TipShiftY=12;var Gn=[8,28];Nb.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Nb.TipHelper.data.helperPos.x,Nb.TipHelper.data.helperPos.y,Gn[0]*Nb.TipHelper.data.size,Gn[1]]}},background:{func:function(){return jc.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Nb.TipHelper.data.text}},rect:{func:function(){return[Nb.TipHelper.data.helperPos.x,Nb.TipHelper.data.helperPos.y,Gn[0]*Nb.TipHelper.data.size,Gn[1]]}},color:{func:function(){return jc.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var $d=7;Nb.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Nb.ShapePoint.data.dynamicVisible}},rect:{func:function(){var N=Nb.ShapePoint.data.point,v=Nb.ShapePoint.data.size||$d;return[N,v+10,v+10]}},background:{func:function(){var K=Date.now(),G=Nb.ShapePoint.data.dynamicPeriod||1500,X=Math.sin(K%G/G*Math.PI);return"rgba(27,124,22,"+.5*X+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var p=Nb.ShapePoint.data.point,n=Nb.ShapePoint.data.size||$d;return[p,n,n]}},background:{func:function(){var d=Nb.ShapePoint.data.isEnd;return d?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Nb.ShapePoint.data.color||pn}}},{type:"rect",visible:{func:function(){return!!Nb.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return pn}},rect:{func:function(){var m=5;return[Nb.ShapePoint.data.point,m,m]}}}]},Nb.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Nb.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Nb.ShapeBgCurve.data.P}},segments:{func:function(){return Nb.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var e=Date.now(),D=Nb.ShapeBgCurve.data.dynamicPeriod||1500,K=Math.sin(e%D/D*Math.PI);return"rgba(27,124,22,"+.3*K+")"}}},{type:"shape",points:{func:function(){return Nb.ShapeBgCurve.data.P}},segments:{func:function(){return Nb.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Nb.ShapeBgCurve.data.color||pn}}}]};var gs=8;Nb.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var L=Nb.ShapeHighlighPoint.data;return[[L.x,L.y],gs,gs]}},background:{func:function(){return jc.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Fp=10;Nb.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var T=Nb.ShapeHighlighRealPoint.data;return[[T.x,T.y],Fp,Fp]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return pn}}}]};var ws=8;Nb.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var S=Nb.ShapeHighlighCtrlPoint.data,n=S.x,o=S.y,_=ws/2;return[n-_,o-_,n-_,o+_,n+_,o+_,n+_,o-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return jc.getStyle("shapeCtrlPointBorderColor")||pn}}}]};var Yg=3;Nb.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Nb.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Yg,borderColor:{func:function(){return jc.getStyle("curveHighlightColor")}}}]},Nb.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Nb.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Nb.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Nb.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Nb.MoveLineGuide.data.center?Ih:Wd}}}]};var Jc=5;Nb.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var M=Nb.MoveLineGuideDistanceH.data,V=M.x0,T=M.y0;return[V,T-Jc,V,T+Jc]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Wd},{type:"shape",points:{func:function(){var o=Nb.MoveLineGuideDistanceH.data,U=o.x1,e=o.y1;return[U,e-Jc,U,e+Jc]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Wd},{type:"text",text:{func:function(){return Math.round(Nb.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var b=Nb.MoveLineGuideDistanceH.data;return[[(b.x0+b.x1)/2,b.y0-10],20,20]}},color:Wd,font:"12px Arial",align:"center"}]},Nb.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var O=Nb.MoveLineGuideDistanceV.data,T=O.x0,k=O.y0;return[T-Jc,k,T+Jc,k]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Wd},{type:"shape",points:{func:function(){var U=Nb.MoveLineGuideDistanceV.data,s=U.x1,E=U.y1;return[s-Jc,E,s+Jc,E]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Wd},{type:"text",text:{func:function(){return Math.round(Nb.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var H=Nb.MoveLineGuideDistanceV.data;return[[H.x0-10,(H.y0+H.y1)/2],20,20]}},color:Wd,font:"12px Arial",align:"center"}]},v.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Nb.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var L=Nb.EdgeElevationGuide.data,S=L.x,v=L.y,w=jc.getStyle("curveElevationIntersectSize"),g=jc.getStyle("curveElevationGuideShift");return S+=g[0],v+=g[1],[S-w,v-w,2*w,2*w]}}}]},v.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),v.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Nb.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Nb.ConnectGuide.data.rotation}},rect:{func:function(){var N=Nb.ConnectGuide.data.connect;N.x,N.y;var b=jc.getStyle("connectGuideIntersectSize");return[[N.x,N.y],2*b,2*b]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var m=Nb.ConnectGuide.data.cursorPos||Nb.ConnectGuide.data.connect,A=jc.getStyle("connectGuideIntersectSize");return[[m.x,m.y],2*A-2,2*A-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var q=Nb.ConnectGuide.data.connect,k=Nb.ConnectGuide.data.cursorPos||q;return[q.x,q.y,q.x+.5*(k.x-q.x),q.y,k.x+.5*(q.x-k.x),k.y,k.x,k.y]}}}]},v.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),v.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Nb.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var x=Nb.ConnectGuideGarbage.data.hover;return x?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var t=Nb.ConnectGuideGarbage.data,I=jc.getStyle("connectGuideGarbageIntersectsize");return t.hover&&(I+=5),[[t.x,t.y],2*I,2*I]}}}]};var Xk=6;Nb.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Nb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var q=Nb.ShapeActivingCtrl.data;return[q.point.x,q.point.y,q.c1.x,q.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pn}}},{type:"shape",visible:{func:function(){return Nb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var X=Nb.ShapeActivingCtrl.data;return[X.point.x,X.point.y,X.c2.x,X.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pn}}},{type:"shape",visible:{func:function(){return Nb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var X=Nb.ShapeActivingCtrl.data.c1,L=X.x,W=X.y,D=Xk/2;return"c1"===Nb.ShapeActivingCtrl.data.hl&&(D+=.5),[L-D,W-D,L-D,W+D,L+D,W+D,L+D,W-D]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Nb.ShapeActivingCtrl.data.hl?jc.getStyle("shapeCtrlPointHighlightBorder")||pn:jc.getStyle("shapeCtrlPointBorderColor")||pn}}},{type:"shape",visible:{func:function(){return Nb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var G=Nb.ShapeActivingCtrl.data.c2,u=G.x,a=G.y,l=Xk/2;return"c2"===Nb.ShapeActivingCtrl.data.hl&&(l+=.5),[u-l,a-l,u-l,a+l,u+l,a+l,u+l,a-l]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Nb.ShapeActivingCtrl.data.hl?jc.getStyle("shapeCtrlPointHighlightBorder")||pn:jc.getStyle("shapeCtrlPointBorderColor")||pn}}}]},Nb.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pn}},rect:{func:function(){return[[Nb.RoundPoint.data.x,Nb.RoundPoint.data.y],Qf,Qf]}}}]},Nb.AttachPoint={comps:[{type:"rect",background:{func:function(){return Nb.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return pn}},rect:{func:function(){var c=Nb.AttachPoint.data.isAttach?Qf+4:Qf;return[[Nb.AttachPoint.data.x,Nb.AttachPoint.data.y],c,c]}}}]},Nb.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Nb.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Nb.SimpleRect.data.color||pn}},rect:{func:function(){var W=Nb.SimpleRect.data;return[W.x,W.y,W.width,W.height]}}}]},v.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Nb.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var F=Nb.MoveDummy.data;return[[F.pos.x,F.pos.y],2*F.size,2*F.size]}}}]},lq.Icons.DrawIcon=function(A,g,U,m){U.width=U.height=Nh,U.data=m,jc=A,v.Default.drawImage(g,U,0,0,Nh,Nh)},lq.Icons.MapPoints=function(X,Z){for(var $=0,R=X.length;R>$;$++)X[$]/=Z},lq.roundTo=function(I,m,B){var h=Math.abs(I%m);return B>h||B>m-h?m*Math.round(I/m):I},lq.toFixed=function(d){return Math.round(100*d)/100},lq.getDataMatrix=function(e){if(e instanceof v.Shape){var B=new v.Math.Matrix2d,u=e.getPosition();return B.translate(-u.x,-u.y).scale(e.getScale().x,e.getScale().y).rotate(e.getRotation()).translate(u.x,u.y),B}return e.getMatrix?e.getMatrix():new v.Math.Matrix2d};var wj=lq.Math.Curve=function(){this._curves=[]};wj.prototype={},wj.prototype.constructor=wj,wj.prototype.createFromHtShape=function(R,s,Y){s instanceof v.List&&(s=s.toArray());var X,l,o,j,i,M,e,g=this,U=null,c=null,F=0,S=lq.Math.Vector2,w=lq.Math.CubicBezier,d=function(m){return new S(R[m],R[m+1],Y?Y[m/2]:Q)};for(l=0,o=s.length;o>l;l++){switch(j=s[l],i=null,j){case 1:c=d(F),U=c,F+=2;break;case 2:X=d(F),F+=2,i=new w(c,c.clone(),X.clone(),X),c=X;break;case 3:M=d(F),X=d(F+2),F+=4,i=new w(c,M.clone().sub(c).multiplyScalar(2/3).add(c),M.clone().sub(X).multiplyScalar(2/3).add(X),X),c=X;break;case 4:M=d(F),e=d(F+2),X=d(F+4),F+=6,i=new w(c,M,e,X),c=X;break;case 5:if(!U)break;i=new w(c,c.clone(),U.clone(),U),c=null,U=null}i&&(i._index=g._curves.length,g._curves.push(i))}},wj.prototype.checkPoint=function($,G){var A,r,L,D,u,Q=this,I=Q._curves;for(A=0,r=I.length;r>A;A++)if(D=I[A],u=D.intersectRect($,G,G),u.length)return L=0,u.forEach(function(Q){L+=Q.t}),L/=u.length,$=D.getPointAt(L),$.t=L,{bezier:D,intersection:$}},wj.prototype.insertKnot=function(m,l){var Z=m.insertKnot(l),v=this,p=v._curves;p.splice(m._index,1,Z[0],Z[1])},wj.prototype._isCloseEnough=function(s,B){return Math.abs(s.x-B.x)<1e-6&&Math.abs(s.y-B.y)<1e-6},wj.prototype._isSamePoint=function(b,p){return b===p},wj.prototype.moveRealPoint=function(S,l){var k=this,w=k._curves,T=l.clone().sub(S);w.forEach(function(s){var H=s._p1;s._p2,s._p3;var M=s._p4;k._isSamePoint(H,S)&&(s._p2.add(T),s._p1=l),k._isSamePoint(M,S)&&(s._p3.add(T),s._p4=l)})},wj.prototype.moveCtrlDueToRealPointMovement=function(l,Z){var T=this,v=T._curves,V=function(W){W.add(Z),W.e&&Z.e&&(W.e+=Z.e)};v.forEach(function(i){var Y=i._p1;i._p2,i._p3;var N=i._p4;T._isSamePoint(Y,l)&&V(i._p2),T._isSamePoint(N,l)&&V(i._p3)})},wj.prototype.moveCtrlPoint=function(x,a,M){var P=x[M];if(P){P.e!==Q&&(a.e=P.e);var t=this,g=t._curves;a.clone().sub(P),g.forEach(function(U){var Y;"c2"===M?Y="_p2":"c1"===M&&(Y="_p3"),t._isSamePoint(U[Y],P)&&(U[Y]=a)}),x[M]=a}},wj.prototype.deleteRealPoint=function(q,V){var R,N,v,B,e,t,d,F=this,Y=F._curves,T={},L=[],D=lq.Math.CubicBezier;for(N=0,v=Y.length;v>N;N++)R=Y[N],B=R._p1,e=R._p2,t=R._p3,d=R._p4,(T[N]||!F._isSamePoint(B,q))&&(F._isSamePoint(d,q)?v>N+1&&F._isSamePoint(Y[N+1]._p1,q)&&(V||L.push(new D(B,e,Y[N+1]._p3,Y[N+1]._p4))):L.push(R));F._curves=L},wj.prototype.findPairs=function(B,Q){var p,h,F,q,k,u,a,t,e=this,E=e._curves,c={},v=[];for(h=0,F=E.length;F>h;h++)p=E[h],q=p._p1,k=p._p2,u=p._p3,a=p._p4,!c[h]&&e._isSamePoint(q,B)&&(Q?v.push({point:q,r2:a}):v.push({point:q,c2:k})),e._isSamePoint(a,B)&&(t=Q?{point:a,r1:q}:{point:a,c1:u},F>h+1&&e._isSamePoint(E[h+1]._p1,B)&&(Q?t.r2=E[h+1]._p4:t.c2=E[h+1]._p2,c[h+1]=!0),v.push(t));return v},wj.prototype.toHtShape=function(){var C=this,o=C._curves,V=[],Q=[],L={x:1/0,y:1/0};return o.forEach(function(j){var N=j._p1,w=j._p2,x=j._p3,b=j._p4;return C._isCloseEnough(N,L)||(V.push(1),Q.push(N.clone())),L=b,C._isCloseEnough(N,w)&&C._isCloseEnough(x,b)?(V.push(2),Q.push(b.clone()),void 0):(V.push(4),Q.push(w.clone(),x.clone(),b.clone()),void 0)}),{segments:V,points:Q}};var _o=lq.Math.CubicBezier=function(v,N,$,y){var A=this;A._id=lq.Math.CubicBezier._globalId++,A._p1=v,A._p2=N,A._p3=$,A._p4=y};_o._globalId=1,_o.prototype={},_o.prototype.constructor=_o,_o.prototype.toString=function(){return this._id},_o.prototype.intersectRect=function(N,Y,o){var L=Y/2,B=o/2,V=N.x,O=N.y,j=lq.Math.Vector2,c=new j(-L+V,-B+O),E=new j(L+V,B+O),J=new j(E.x,c.y),K=new j(c.x,E.y),g=this,F=g.intersectLine(c,J),h=g.intersectLine(J,E),s=g.intersectLine(E,K),I=g.intersectLine(K,c),z=F.concat(h).concat(s).concat(I);return z},_o.prototype.intersectLine=function(k,G){var l,A,p,j,W,d,N,J,T,x,b,q,S,I=this,E=k.clone().min(G),_=k.clone().max(G);j=I._p1,W=I._p2,d=I._p3,N=I._p4,l=j.clone().multiplyScalar(-1),A=W.clone().multiplyScalar(3),p=d.clone().multiplyScalar(-3),b=l.add(A).add(p).add(N),l=j.clone().multiplyScalar(3),A=W.clone().multiplyScalar(-6),p=d.clone().multiplyScalar(3),x=l.add(A).add(p),l=j.clone().multiplyScalar(-3),A=W.clone().multiplyScalar(3),T=l.add(A),J=j.clone(),S=new lq.Math.Vector2(k.y-G.y,G.x-k.x),q=k.x*G.y-G.x*k.y;for(var L=I.getRoots(S.dot(b),S.dot(x),S.dot(T),S.dot(J)+q),c=new Array,g=0,V=L.length;V>g;g++){var a=L[g];if(!(0>a||a>1)){var w=j.clone().lerp(W,a),C=W.clone().lerp(d,a),X=d.clone().lerp(N,a),B=w.lerp(C,a),r=C.lerp(X,a),Z=B.lerp(r,a);Z.t=a,k.x==G.x?E.y<=Z.y&&Z.y<=_.y&&c.push(Z):k.y==G.y?E.x<=Z.x&&Z.x<=_.x&&c.push(Z):Z.x>=E.x&&Z.y>=E.y&&Z.x<=_.x&&Z.y<=_.y&&c.push(Z)}}return c},_o.prototype.solveTForPoint=function(G){var l,P,A,f,J=this;l=J._p1.x-G.x,P=J._p2.x-G.x,A=J._p3.x-G.x,f=J._p4.x-G.x;for(var z=J.getRoots(f-3*A+3*P-l,3*A-6*P+3*l,3*P-3*l,l),b=Q,p=1/0,n=0,_=z.length;_>n;n++){var N=z[n];if(!(0>N||N>1)){var U=J._p1.clone().lerp(J._p2,N),R=J._p2.clone().lerp(J._p3,N),v=J._p3.clone().lerp(J._p4,N),g=U.lerp(R,N),s=R.lerp(v,N),D=g.lerp(s,N);D.t=N;var Y=Math.abs(D.y-G.y);p>Y&&(p=Y,b=D)}}return b},_o.prototype.getPointAt=function(F){var $=this,Y=$._p1,a=$._p2,_=$._p3,B=$._p4,U=Y.clone().lerp(a,F),Q=a.clone().lerp(_,F),l=_.clone().lerp(B,F),s=U.lerp(Q,F),k=Q.lerp(l,F);return s.lerp(k,F)},_o.prototype.getRoots=function(T,H,M,$){var P,s,Q,O,I,A=new Array;if(Math.abs(T)<1e-6){var P=H,s=M/P,Q=$/P,O=s*s-4*Q;if(O>0){var I=Math.sqrt(O);A.push(.5*(-s+I)),A.push(.5*(-s-I))}else 0==O&&A.push(.5*-s)}H/=T,M/=T,$/=T,P=(3*M-H*H)/3,s=(2*H*H*H-9*M*H+27*$)/27;var z=H/3,n=s*s/4+P*P*P/27,J=s/2;if(Math.abs(n)<=1e-6&&(n=0),n>0){var q,L,I=Math.sqrt(n);q=-J+I,L=q>=0?Math.pow(q,1/3):-Math.pow(-q,1/3),q=-J-I,q>=0?L+=Math.pow(q,1/3):L-=Math.pow(-q,1/3),A.push(L-z)}else if(0>n){var f=Math.sqrt(-P/3),y=Math.atan2(Math.sqrt(-n),-J)/3,o=Math.cos(y),r=Math.sin(y),x=Math.sqrt(3);A.push(2*f*o-z),A.push(-f*(o+x*r)-z),A.push(-f*(o-x*r)-z)}else{var q;q=J>=0?-Math.pow(J,1/3):Math.pow(-J,1/3),A.push(2*q-z),A.push(-q-z)}return A},_o.prototype._70I=function(){var c=this;return c._p1.distanceToSquared(c._p2)<1e-10&&c._p3.distanceToSquared(c._p4)<1e-10},_o.prototype.insertKnot=function(E){var R=this,p=R._p1,c=R._p2,d=R._p3,C=R._p4,T=p.clone().lerp(c,E),S=c.clone().lerp(d,E),h=d.clone().lerp(C,E),$=T.clone().lerp(S,E),X=S.clone().lerp(h,E),F=$.clone().lerp(X,E);return R._70I()?(p.clone().lerp(C,E),[new lq.Math.CubicBezier(p,p.clone(),F.clone(),F),new lq.Math.CubicBezier(F,F.clone(),C.clone(),C)]):[new lq.Math.CubicBezier(p,T,$,F),new lq.Math.CubicBezier(F,X,h,C)]};var Gb=v.Default.getInternal().ui().EdgeUI,Yd={_47O:function(z){var f=this,J=Yd.getBackups()._47O;lq.inEdit(f.gv)||J.call(f,z)}};lq.Inject.registAsModule(Yd,Gb);var Vn=v.Default.getInternal().ui().NodeUI,ok={_47O:function(A){var f=this,k=ok.getBackups()._47O;lq.inEdit(f.gv)||k.call(f,A)},getSelectWidth:function(){var u=this,M=u.gv,P=u._data;if(M.isEditable(P)&&lq.inEdit(M))return 0;var G=ok.getBackup("getSelectWidth");return G.call(u)}};lq.Inject.registAsModule(ok,Vn);var il=v.graph.GraphView,yj={_editPointSize:function(){var S=v.Default.isTouchable,G=lq.getStyle("pointSize");return G[S?0:1]}(),isPointEditable:function(S){var v=this;if(lq.inEdit(v))return v._pointEditableFunc?v._pointEditableFunc(S):!0;var M=yj.getBackup("isPointEditable");M.call(v,S)},isEditable:function(J){var B,l=this,E=yj.getBackup("isEditable");if(B=J instanceof lq.Group?!0:E.call(l,J),!lq.inEdit(l))return B;if(!(J instanceof v.Edge))return B;if(!J.s("2d.editable"))return!1;var y=l.getEditableFunc();return y?y(J):!0},_42:function(N,O){var Y=this,$=yj.getBackups()._42;if($.call(Y,N,O),lq.inEdit(Y)){var z=Y.getEditInteractor();z.drawImpl()}}};lq.Inject.registAsModule(yj,il);var Al=v.Default.getInternal().ui().ShapeUI,Mk={_47O:function(x){var D=this,K=Mk.getBackups()._47O;lq.inEdit(D.gv)||K.call(D,x)}};lq.Inject.registAsModule(Mk,Al);var fn=v.graph.DefaultInteractor,_f={handle_mousewheel:function(w){var n=this,x=_f.getBackup("handle_mousewheel");lq.inEdit(n.gv)||x.call(n,w)}};lq.Inject.registAsModule(_f,fn);var Te=v.graph.MoveInteractor,yr={_calcShift:function(D,c){var g=this,f=yr.getBackup("_calcShift"),$=g.gv;if(!lq.inEdit($))return f.call(g,D,c);var L=$.getEditInteractor(),B=L.getSubModule("Move").calcShift(D,c,g);return B||f.call(g,D,c)},clear:function(D){var l=this,C=yr.getBackup("clear");C.call(l,D);var d=l.gv;if(lq.inEdit(d)){var p=d.getEditInteractor();p.getSubModule("Move").clear(D)}}};lq.Inject.registAsModule(yr,Te);var he=lq.Rect=function(Z){this.catalog="Rect",this._interactor=Z};he.prototype={},he.prototype.constructor=he,he.prototype.gatherInfo=function(S,i){var I=this;if(1===i.length){var u=i[0];return u instanceof v.Shape&&u._70I()?I.gatherLine(S,u):Uq(u,S)?!1:I.gatherSingleTarget(S,u)}return i.length>1?I.gatherMultiTargets(S,i):!1},he.prototype.gatherSingleTarget=function(K,o){if(o.getCorners){var L,s=this,V=s.info;s.target=o,L=s.screenInfo={};var h=o.getCorners();V.LT=new lq.Math.Vector2(h[0]),V.LB=new lq.Math.Vector2(h[1]),V.RB=new lq.Math.Vector2(h[2]),V.RT=new lq.Math.Vector2(h[3]),V.T=V.LT.clone().add(V.RT).divideScalar(2),V.B=V.LB.clone().add(V.RB).divideScalar(2),V.L=V.LT.clone().add(V.LB).divideScalar(2),V.R=V.RT.clone().add(V.RB).divideScalar(2);for(var D in V)L[D]=lq.toScreenPosition(K,V[D]);var q=s._interactor,i=q.getStyle("checkSize"),U=function(f,Z,s){var N=Z.clone().sub(f).setLength(-i),d=s.clone().sub(f).setLength(-i),e=N.add(d).add(f);return e};return L.rotLT=U(L.LT,L.RT,L.LB),L.rotLB=U(L.LB,L.LT,L.RB),L.rotRB=U(L.RB,L.LB,L.RT),L.rotRT=U(L.RT,L.LT,L.RB),L.rotT=L.rotLT.clone().add(L.rotRT).divideScalar(2),L.rotB=L.rotLB.clone().add(L.rotRB).divideScalar(2),L.rotL=L.rotLT.clone().add(L.rotLB).divideScalar(2),L.rotR=L.rotRT.clone().add(L.rotRB).divideScalar(2),L.rotation=o.getRotation(),s.gatherConnectInfo(),!0}},he.prototype.gatherConnectInfo=function(){var a=this,k=a.target,q=a._interactor,F=a.screenInfo,C=q.gv;if(C.isConnectActionVisible(k)&&q.getStyle("connectGuideVisible")){var _;k.s&&(_=k.s("connectGuideShift")),_||(_=q.getStyle("connectGuideShift"));var X=k.getAnchor(),s=k.getSize(),f=k.toGlobal({x:s.width*(_[0]-X.x),y:s.height*(_[1]-X.y)});f=lq.toScreenPosition(C,f),F.P1?f.add(F.P2.clone().sub(F.P1).setLength(_[2])):(f.add(F.RT.clone().sub(F.LT).setLength(_[2])),f.add(F.LB.clone().sub(F.LT).setLength(_[3]))),F.connect=f}},he.prototype.gatherMultiTargets=function(_,P){var r=lq.Group.findOrCreateGroup(P);if(!r)return!1;var c=this;return c.editing&&"rotate"!==c.editing.mode||r.calcInfo(),c.gatherSingleTarget(_,r)},he.prototype.gatherLine=function(q,j){this.target=j;var R=this.screenInfo={},z=j.getPoints(),u=lq.getDataMatrix(j);return R.P1=lq.toScreenPosition(q,u.apply(z.get(0))),R.P2=lq.toScreenPosition(q,u.apply(z.get(1))),this.gatherConnectInfo(),!0},he.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],he.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],he.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],he.prototype.check=function(G,P,m){if(v.Default.isLeftButton(P)){var g=this;if(g.editing=null,g.tipInfo=null,g.screenInfo){var h=g.target,A=G.isEditable(h),$=g.screenInfo;if(A&&$.connect){var O=g._checkConnect(m);if(O)return O}if($.P1)return g._checkLine(m);var T,c,R,I=null,p=g._interactor,E=p.getStyle("checkSize");if(A&&G.isRectEditable(h))for(c=0;c<lq.Rect.ResizeKeys.length;c++)if(R=lq.Rect.ResizeKeys[c],lq.checkHit(m,$[R],E)){I=R,T="resize";break}if(!I&&A&&G.isRotationEditable(h)&&!p.getStyle("rotateAsClock")){var Y=p.getStyle("rotateCheckSize");for(c=0;c<lq.Rect.RotateKeys.length;c++)if(R=lq.Rect.RotateKeys[c],lq.checkHit(m,$[R],Y)){I=R,T="rotate";break}}if(!I)return p.setCursor("default"),void 0;if("rotate"===T){var i,r=G.lp(P);if(h instanceof lq.Group){var b=p.getStyle("groupRotateModeKey");"string"==typeof b&&(b=[b]);for(var S=!1,o=0,l=b.length;l>o;o++)if(P[b[o]]){S=!0;break}var B=p.getStyle("groupRotateModeDefault");i=S?"batch"===B?"block":"batch":B}var J="batch"===i?h.getAnchor2():h.getPosition(),C=Math.atan2(r.y-J.y,r.x-J.x);p._setRotateCursor(C),g.editing={mode:T,key:I,pos:J,flipY:h.getScale().y<0,rotation:h.getRotation(),hitRot:C},i&&(g.editing.groupRotateMode=i)}else{var q=lq.Rect.ResizeKeys.indexOf(I),D=lq.Rect.ResizeDirection[q],Q=Math.cos(h.getRotation()),u=Math.sin(h.getRotation()),X=D.x*Math.sign(h.getScale().x),t=D.y*Math.sign(h.getScale().y),z=Math.atan2(-u*X-Q*t,Q*X-u*t),s=(Math.round(z/(Math.PI/4))+8)%8,x=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][s];this._interactor.setCursor(x);var j=h.getWidth(),W=h.getHeight(),f=h.getAnchor();g.editing={mode:T,key:I,rect:{x:-j*f.x,y:-W*f.y,width:j,height:W},anchor:f,matrix:h.getMatrix()}}return I}}},he.prototype._checkLine=function(u){var $=this;$.screenInfo;var d,a=$._interactor.getStyle("checkSize");if(lq.checkHit(u,$.screenInfo.P1,a))d="P1";else{if(!lq.checkHit(u,$.screenInfo.P2,a))return this._interactor.setCursor("default"),void 0;d="P2"}return $.editing={mode:"line",key:d},d},he.prototype._checkConnect=function(w){var y=this,k=y.screenInfo,z=y._interactor,$=z.getStyle("connectGuideIntersectSize"),n=k.connect,r=w.x,m=n.x;if(m>r&&$>m-r&&Math.abs(n.y-w.y)<$||r>=m&&lq.checkHit(w,n,$)){var H="connect",J=t.getConnectAction(z.gv);
if(y.editing={mode:H},J&&J.delete)if(y.target instanceof lq.Group){var W=!0;z.gv.sm().getSelection().each(function(K){J.delete.visible.call(null,z.gv,K)||(W=!1)}),y.editing.hasDeleteAction=W}else J.delete.visible.call(null,z.gv,y.target)&&(y.editing.hasDeleteAction=!0);return z.setCursor("default"),H}},he.prototype._fireEditEvent=function(Z,b){var V=this._interactor,W=this.editing;if(W){var j=W.mode;j="rotate"===j?"Rotation":"connect"===j?"Connection":"resize"===j?"Rect":j[0].toUpperCase()+j.slice(1),V.fi({kind:Z+"Edit"+j,event:b})}},he.prototype.startEdit=function(R,Y){R.startDragging(Y);var j=this;j._interactor.fi({kind:"prepareEdit",event:Y});var i=j.editing,f=j.target;if(i){if(j._fireEditEvent("begin",Y),"rotate"===i.mode)return i.groupRotateMode&&f.beginRotate(i),void 0;if("connect"!==i.mode)("line"===i.mode||f&&0===f.getRotation())&&(j._inSmartGuide=!0,j._interactor.rectGuide.gatherRects());else if(i.hasDeleteAction){var h=R.gv,E=j._interactor.getStyle("connectGuideGarbageShift");i.garbageInfo={x:h.getWidth()*E[0]+E[2],y:h.getHeight()*E[1]+E[3],size:j._interactor.getStyle("connectGuideGarbageIntersectsize")},R._42()}}},he.prototype._46O=function(u){var s,R,y=this,c=y.editing,d=y.target;if(c){if("connect"===c.mode&&!c.canceled&&!c.deleted)try{c.garbageInfo&&c.garbageInfo.hover?t.doDeleteConnectionAction(y._interactor.gv,d):t.doConnectAction(y._interactor.gv,d,c.target)}catch(D){console.error(D)}R=c.freezeFlag,s=y.editing.groupRotateMode,y._fireEditEvent("end",u),y.editing=null}y.tipInfo=null,y._inSmartGuide&&(y._interactor.rectGuide.clear(),y._inSmartGuide=!1),s&&d&&d.endRotate(),d instanceof v.Block&&(R===Q?delete d._freezeSyncFromChildren:d._freezeSyncFromChildren=R,d.updateFromChildren())},he.prototype.handleNormalStateDelete=function(){var o=this,K=o.editing;if(K&&"connect"===K.mode&&!K.canceled&&!K.deleted){if(K.garbageInfo){try{t.doDeleteConnectionAction(o._interactor.gv,o.target)}catch(n){console.error(n)}K.garbageInfo=null}return K.cursorPos=null,K.targetCorners=null,K.deleted=!0,o._interactor._42(),!0}},he.prototype.handleNormalStateKeyDown=function(X){var U=this,u=U.editing;return!u||"connect"!==u.mode||u.canceled||u.deleted?void 0:v.Default.isEsc(X)?(u.cursorPos=null,u.targetCorners=null,u.canceled=!0,U._interactor._42(),!0):void 0},he.prototype.handleEdit=function(W,G){var I=this,f=I.editing;if(f){var $,z,l,L,k,q=I.target,h=f.key,F=f.mode,o=W.lp(G),V=I._interactor;if("connect"===F){if(f.canceled)return;if(f.deleted)return;f.cursorPos=V._getLogicalPoint(G);var T=f.garbageInfo;return T&&lq.checkHit(f.cursorPos,T,T.size)?(T.hover=!0,f.target=null,f.targetCorners=null):(T&&(T.hover=!1),f.target=W.getDataAt(o,function(_){return W.isSelectable(_)?Fg(_)?!0:!1:!1})||null,f.targetCorners=lq.getTargetCornersOnScreen(W,f.target)),V._42(),void 0}if("rotate"===F){var Q,n,c=f.pos,t=Math.atan2(o.y-c.y,o.x-c.x);if(f.groupRotateMode?n=t-f.hitRot:(Q=t-f.hitRot,n=f.rotation+Q),n%=2*Math.PI,0>n&&(n+=2*Math.PI),!v.Default.isCtrlDown(G)){var _,i;Kh(G)?(_=V.getStyle("shiftRotateRound"),i=_/2):(_=V.getStyle("rotateRound"),i=V.getStyle("rotateSensitivity")),n=lq.roundTo(n,_,i)}f.groupRotateMode?(Q=n-(f.lastRotation||0),0!==Q&&(q.addRotation(Q,f.groupRotateMode,function(s){return W.isRotationEditable(s)}),f.lastRotation=n)):q.setRotation(n),V._setRotateCursor(t),n>Math.PI&&(n-=2*Math.PI);var A=180*(n/Math.PI);A=A.toFixed(2),$=""+A+""}else if("resize"===F){var O=f.rect;l=O.x,L=O.y;var E,X=O.width,M=O.height,K=f.anchor,a=f.matrix,j=q.s&&q.s("keepAspectRatio")||V.getStyle("keepAspectRatio");Kh(G)&&(j=!j);var s=I._unionPointMode1,J=I._unionPointMode2;if(I._inSmartGuide&&!v.Default.isCtrlDown(G)&&!j){var R;"L"===h||"R"===h?R="x":("T"===h||"B"===h)&&(R="y"),I._adsorbedToClosest(o,R),k=!0}E=a.tfi(o);var Z;"LT"===h?(O=s(E,{x:l+X,y:L+M},X,M,j),Z=9):"T"===h?(O=J({x:l,y:E.y},{x:l+X,y:L+M},X,M,j,"v"),Z=1):"RT"===h?(O=s(E,{x:l,y:L+M},X,M,j),Z=33):"L"===h?(O=J({x:E.x,y:L},{x:l+X,y:L+M},X,M,j,"h"),Z=8):"R"===h?(O=J({x:l,y:L},{x:E.x,y:L+M},X,M,j,"h"),Z=32):"LB"===h?(O=s(E,{x:l+X,y:L},X,M,j),Z=12):"B"===h?(O=J({x:l,y:L},{x:l+X,y:E.y},X,M,j,"v"),Z=4):"RB"===h&&(O=s(E,{x:l,y:L},X,M,j),Z=36);var P=a.tf(O.x+O.width*K.x,O.y+O.height*K.y);q instanceof v.Block&&(f.hasOwnProperty("freezeFlag")||(f.freezeFlag=q._freezeSyncFromChildren,q._freezeSyncFromChildren=!0)),q.setPosition(P),q.setSize(O.width,O.height),k&&(z=q.getRect(),V.rectGuide.gatherLines({node:q,x:z.x,y:z.y,w:z.width,h:z.height},R,Z)),$=""+Math.round(O.width)+" * "+Math.round(O.height)}else if("line"===F){if(Kh(G)){var g=q.getPoints(),r="P1"===h?g.get(1):g.get(0),b={x:o.x-r.x,y:o.y-r.y},S=V.getStyle("shiftLineRotateRound"),w=I._shiftDirList;if(!w||I._shiftRotateRound!==S){I._shiftRotateRound=S,I._shiftDirList=w=[];for(var U=0;U<Math.PI;U+=S)w.push({x:C(U),y:x(U)})}for(var u,H=0,e=0,N=w.length;N>e;e++){var D=w[e],y=D.x*b.x+D.y*b.y;Math.abs(y)>Math.abs(H)&&(H=y,u=D)}o={x:r.x+u.x*H,y:r.y+u.y*H},V.rectGuide.clear()}else I._inSmartGuide&&!v.Default.isCtrlDown(G)&&(I._adsorbedToClosest(o),k=!0);var p=lq.getDataMatrix(q).applyInverse(o);q.setPoint("P1"===h?0:1,p,!0);var m=q.getPoints(),B=m.get(0),d=m.get(1);l=B.x-d.x,L=B.y-d.y,$=" "+Math.round(Math.sqrt(l*l+L*L))+" ",k&&(z=q.getRect(),V.rectGuide.gatherLines({node:q,x:z.x,y:z.y,w:z.width,h:z.height}))}if($){var Y=v.Default.getLogicalPoint(G,V._canvas);Y.x+=lq.Icons.TipShiftX,Y.y+=lq.Icons.TipShiftY,I.tipInfo={helperPos:Y,text:$,size:$.length}}I._fireEditEvent("between",G)}},he.prototype._unionPointMode1=function(p,u,A,h,Z){if(Z&&A&&h){var F=p.x-u.x,S=p.y-u.y;Math.abs(F*h)<Math.abs(S*A)?(S=Math.sign(S)*Math.abs(F*h/A),p.y=u.y+S):(F=Math.sign(F)*Math.abs(S*A/h),p.x=u.x+F)}return v.Default.unionPoint(p,u)},he.prototype._unionPointMode2=function(N,E,_,P,l,L){var C=v.Default.unionPoint(N,E);if(l&&_&&P){var H;"v"===L?(H=C.x+C.width/2,C.width=_*C.height/P,C.x=H-C.width/2):(H=C.y+C.height/2,C.height=P*C.width/_,C.y=H-C.height/2)}return C},he.prototype._adsorbedToClosest=function(O,n){var _=this,F=_._interactor,H=F.rectGuide.findClosest(O,n),i=F.gridGuide.findClosest(O,n),C=1/0,N=1/0;H&&(isFinite(H.x)&&(C=H.x),isFinite(H.y)&&(N=H.y)),i&&(isFinite(i.x)&&Math.abs(i.x)<Math.abs(C)&&(C=i.x),isFinite(i.y)&&Math.abs(i.y)<Math.abs(N)&&(N=i.y)),isFinite(C)&&(O.x+=C),isFinite(N)&&(O.y+=N)},he.prototype._42=function(n,p,Y){var e=this;e.info={},e.screenInfo=null;var h=e._interactor;if(!h.editDetail&&e.gatherInfo(p,Y)){var r=e.editing,E=r?r.groupRotateMode:null,F=e.screenInfo;if("block"!==E){if(F.P1?lq.Icons.DrawIcon(h,n,lq.Icons.Line,F):lq.Icons.DrawIcon(h,n,lq.Icons.Rect,F),F.connect&&(lq.Icons.DrawIcon(h,n,lq.Icons.ConnectGuide,{rotation:F.rotation,connect:F.connect,cursorPos:r?r.cursorPos:null}),r)){if(r.targetCorners){for(var H={x:1/0,y:1/0},C={x:-1/0,y:-1/0},P=0,N=r.targetCorners.length;N>P;P+=2)H.x=Math.min(H.x,r.targetCorners[P]),C.x=Math.max(C.x,r.targetCorners[P]),H.y=Math.min(H.y,r.targetCorners[P+1]),C.y=Math.max(C.y,r.targetCorners[P+1]);lq.Icons.DrawIcon(h,n,lq.Icons.HoverDataRect,{min:H,max:C,color:h.getStyle("hoverGuideColor")||h.getStyle("baseColor")})}r.garbageInfo&&lq.Icons.DrawIcon(h,n,lq.Icons.ConnectGuideGarbage,r.garbageInfo)}e.tipInfo&&lq.Icons.DrawIcon(h,n,lq.Icons.TipHelper,e.tipInfo)}e.target instanceof lq.Group&&e.target._42(h,n,p)}};var Fk=lq.Anchor=function(o){this.catalog="Anchor",this._interactor=o};Fk.prototype={},Fk.prototype.constructor=Fk,Fk.prototype.gatherInfo=function(m,w){var K=this;if(1===w.length){var d=w[0];if(!d.getAnchor)return;if(d instanceof v.Shape&&d._70I())return;if(Uq(d,m))return;return K.gatherSingleTarget(m,w[0])}return w.length>1?K.gatherMultiTargets(m,w):!1},Fk.prototype.gatherSingleTarget=function(C,Z){var p=this;return p.info.POS=Z.getPosition(),p.screenInfo.POS=lq.toScreenPosition(C,p.info.POS),p.target=Z,!0},Fk.prototype.gatherMultiTargets=function(o,J){var n=this,h=lq.Group.findOrCreateGroup(J);return h?(n.screenInfo.POS=lq.toScreenPosition(o,h.getAnchor2()),n.target=h,!0):!1},Fk.prototype.isVisible=function(){var R=this,s=R._interactor;if(s.getStyle("anchorVisible")===!1)return!1;var C=R.target;if(C){if(this.editing)return!0;var _=C.getAnchor(),l=s.getStyle("anchorOutsideVisibleThreshold");if(_.x<-l||_.x>1+l||_.y<-l||_.y>1+l)return!0;var U=C.getSize(),S=C.getScale(),P=Math.min(Math.abs(U.width*S.x),Math.abs(U.height*S.y));if(P*s.gv._zoom<s.getStyle("anchorHideThreshold"))return!1}return!0},Fk.prototype.check=function(D,E,C){if(v.Default.isLeftButton(E)){var I=this,y=I._interactor;if(I.isVisible()&&y.getStyle("anchorMovable")!==!1){I.editing=null,I.tipInfo=null;var H=I.target;if(H&&D.isAnchorEditable(H)&&D.isEditable(H)){var l;if(I.screenInfo&&(l=I.screenInfo.POS)&&lq.checkHit(C,new lq.Math.Vector2(l),y.getStyle("checkSize"))){if(H instanceof lq.Group)return I.editing={},!0;var X=H.getWidth(),T=H.getHeight(),F=H.getAnchor();return I.editing={rect:{x:-X*F.x,y:-T*F.y,width:X,height:T},anchor:F,matrix:H.getMatrix()},!0}}}}},Fk.prototype.startEdit=function(U,M){U.startDragging(M),U.fi({kind:"beginEditAnchor",event:M})},Fk.prototype._46O=function(l){var Y=this;Y.editing&&(Y.editing=null,Y._interactor.fi({kind:"endEditAnchor",event:l})),Y.tipInfo=null},Fk.prototype.handleEdit=function(K,k){var Q=this,G=Q.target;if(G){var o=Q.editing;if(o){var W=K.lp(k),M=Q._interactor;if(G instanceof lq.Group)return G.setAnchor2(W),M._42(),void 0;var F=o.matrix,b=F.tfi(W),u=o.rect,V=(b.x-u.x)/u.width,c=(b.y-u.y)/u.height;if(!v.Default.isCtrlDown(k)){var i=M.getStyle("anchorRound"),I=M.getStyle("anchorSensitivity");V=lq.roundTo(V,i,I),c=lq.roundTo(c,i,I)}G.setAnchor(V,c,!0);var L=v.Default.getLogicalPoint(k,M._canvas);L.x+=lq.Icons.TipShiftX,L.y+=lq.Icons.TipShiftY;var $=""+V.toFixed(2)+", "+c.toFixed(2);Q.tipInfo={helperPos:L,text:$,size:$.length},M.fi({kind:"betweenEditAnchor",event:k})}}},Fk.prototype._42=function(k,$,F){var L=this;L.info={},L.screenInfo={};var r=L._interactor;r.editDetail||L.gatherInfo($,F)&&L.isVisible()&&(lq.Icons.DrawIcon(r,k,lq.Icons.Anchor,L.screenInfo),L.tipInfo&&lq.Icons.DrawIcon(r,k,lq.Icons.TipHelper,L.tipInfo))};var Zd=lq.MoveDummy=function(J){this.catalog="MoveDummy",this._interactor=J};Zd.prototype={},Zd.prototype.constructor=Zd,Zd.prototype.gatherInfo=function(){var U=this,_=this._interactor.getSubModule("Rect");if(_){var B=_.screenInfo;if(B){var V=U._interactor,P=U.getMovableTarget(_.target);if(P){var y=V.getStyle("moveDummyThreshold");if(y!==!1){var S=B.LT||B.P1,T=B.RT||B.P2,$=B.LB||S;if(S){var b=B.P1,p=Math.min(S.distanceTo($),S.distanceTo(T));if(!(y!==!0&&p>y)){var d=V.getStyle("moveDummyPosition"),Y=T.clone().sub(S),i=$.clone().sub(S),w=d[2],r=d[3];if(b){var Q=V.getStyle("moveDummyLineExtraShift");Q&&(w+=Q[0],r+=Q[1])}var u=S.clone().add(Y.clone().multiplyScalar(d[0])).add(Y.setLength(w)).add(i.clone().multiplyScalar(d[1])).add(i.setLength(r));return U.screenInfo.pos=u,U.screenInfo.size=V.getStyle("moveDummySensitivity"),!0}}}}}}},Zd.prototype.getMovableTarget=function(U){var R=this._interactor.gv;if(Fg(U)){if(R.isMovable(U))return U}else if(U instanceof lq.Group)for(var t=U._entities,X=t.length-1;X>=0;X--){var e=t[X];if(Fg(e)&&R.isMovable(e))return e}return null},Zd.prototype.getMoveInteractor=function(){for(var s,m,E,A=this._interactor.gv,o=A.getInteractors(),s=0,m=o.length;m>s;s++)if(E=o.get(s),E instanceof Te)return E},Zd.prototype.startEdit=function(d,X){d.startDragging(X);var t=this.getMoveInteractor();if(t){var r=this.selectedTarget,G=d.gv;G._moving=1,t._data=r,G.handleMouseDown&&G.handleMouseDown(X,r)}},Zd.prototype._46O=function(u){var K=this,$=K.getMoveInteractor();$&&($.handleWindowMouseUp(u),K.selectedTarget=null)},Zd.prototype.handleEdit=function(f,r){var L=this.getMoveInteractor();L&&L.handleWindowMouseMove(r)},Zd.prototype.check=function(Y,F,x){if(this.selectedTarget=null,v.Default.isLeftButton(F)&&!Y._scrolling&&!vp()){var z=this;if(z.screenInfo){var m=z.screenInfo.pos;if(m&&!(x.distanceTo(m)>z.screenInfo.size)){var Q=z._interactor;return z.selectedTarget=z.getMovableTarget(Q.getSubModule("Rect").target),Q.setCursor("default"),!0}}}},Zd.prototype._42=function(m,$,i){var s=this;s.screenInfo={};var X=s._interactor;X.editDetail||s.gatherInfo($,i)&&(!X.editing||s.selectedTarget)&&lq.Icons.DrawIcon(X,m,lq.Icons.MoveDummy,s.screenInfo)};var dj=lq.RotateX=function(w){this.catalog="RotateX",this._interactor=w};dj.prototype={},dj.prototype.constructor=dj,dj.prototype.gatherInfo=function(p,j){var r=this;if(1===j.length){var f=j[0];return f instanceof v.Shape&&f._70I()||Uq(f,p)?!1:r.gatherSingleTarget(p,f)}return j.length>1?r.gatherMultiTargets(p,j):!1},dj.prototype.gatherSingleTarget=function(){var z=new v.Math.Vector2,g=new v.Math.Vector2,N=new v.Math.Vector2,x=new v.Math.Vector2,A=function(r,J){var E=r.x-J.x,l=r.y-J.y;return E*E+l*l};return function($,O){if(O.getCorners){var v=this,e=O.getCorners(),G=15,F=O.getPosition();z.copy(e[0]),N.copy(e[1]),x.copy(e[3]),g.copy(z).add(x).divideScalar(2).add(z.sub(N).setLength(G/$.getZoom()));var U=Math.max(A(F,e[0]),A(F,e[1]),A(F,e[2]),A(F,e[3]));return v.info.POS=g.clone(),v.screenInfo.POS=lq.toScreenPosition($,v.info.POS),v.screenInfo.LEN=Math.sqrt(U)*$.getZoom()+G,v.screenInfo.CENTER=lq.toScreenPosition($,F),v.target=O,!0}}}(),dj.prototype.gatherMultiTargets=function(p,k){var e=this,H=lq.Group.findOrCreateGroup(k);if(!H)return!1;var e=this;return e.gatherSingleTarget(p,H)},dj.prototype.isVisible=function(){var v=this._interactor;if(!v.getStyle("rotateAsClock"))return!1;var Y=this.target;if(!Y)return!0;var j=v.gv;return j.isEditable(Y)&&j.isRotationEditable(Y)?!0:!1},dj.prototype.check=function(C,l,q){var U=this,Q=U._checkImpl(C,l,q);return(Q||U._clockPainted)&&U._interactor._42(),Q},dj.prototype._checkImpl=function(f,w,F){if(v.Default.isLeftButton(w)){var y=this;y.editing=null,y.tipInfo=null;var x;if(y.screenInfo&&(x=y.screenInfo.POS)&&y.isVisible()){var q=y._interactor;if(lq.checkHit(F,x,q.getStyle("checkSize"))){var G=y.target,Q=f.lp(w),T=G.getPosition(),R=Math.atan2(Q.y-T.y,Q.x-T.x);return q._setRotateCursor(R),y.editing={pos:T,rotation:G.getRotation(),hitRot:R,groupRotateMode:"block",screenInfo:{CENTER:y.screenInfo.CENTER,LEN:y.screenInfo.LEN}},!0}}}},dj.prototype.startEdit=function(x,I){x.startDragging(I),x.fi({kind:"beginEditRotation",event:I}),this.target instanceof lq.Group&&this.target.beginRotate(this.editing)},dj.prototype._46O=function(l){var O=this;O.editing&&(O.editing=null,O._interactor.fi({kind:"endEditRotation",event:l})),O.target instanceof lq.Group&&O.target.endRotate(),O.tipInfo=null},dj.prototype.handleEdit=function(A,M){var o=this,U=o.editing;if(U){var l,q,N=o.target,r=A.lp(M),G=o._interactor,R=U.pos,d=Math.atan2(r.y-R.y,r.x-R.x),b=N instanceof lq.Group;if(b?q=d-U.hitRot:(l=d-U.hitRot,q=U.rotation+l),q%=2*Math.PI,0>q&&(q+=2*Math.PI),!v.Default.isCtrlDown(M)){var B,Z;Kh(M)?(B=G.getStyle("shiftRotateRound"),Z=B/2):(B=G.getStyle("rotateRound"),Z=G.getStyle("rotateSensitivity")),q=lq.roundTo(q,B,Z)}b?(l=q-(U.lastRotation||0),0!==l&&(N.addRotation(l,U.groupRotateMode,function(H){return A.isRotationEditable(H)}),U.lastRotation=q)):N.setRotation(q),G._setRotateCursor(d),q>Math.PI&&(q-=2*Math.PI);var W=180*(q/Math.PI),n=""+W.toFixed(2)+"",H=v.Default.getLogicalPoint(M,G._canvas);H.x+=lq.Icons.TipShiftX,H.y+=lq.Icons.TipShiftY,o.tipInfo={helperPos:H,text:n,size:n.length},G.fi({kind:"betweenEditRotation",event:M})}},dj.prototype._42=function(h,y,W){var U=this;U._clockPainted=!1,U.info={},U.screenInfo={};var l=U._interactor;l.editDetail||U.gatherInfo(y,W)&&U.isVisible()&&(lq.Icons.DrawIcon(l,h,lq.Icons.RoundPoint,U.screenInfo.POS),U.tipInfo&&lq.Icons.DrawIcon(l,h,lq.Icons.TipHelper,U.tipInfo),U.editing&&U.drawClock(h))},dj.prototype.drawClock=function(z){z.save();var X=this;X._clockPainted=!0;var P=X.editing||{},G=P.screenInfo||X.screenInfo,D=G.LEN,A=D+8,k=D+18;z.save(),z.translate(G.CENTER.x,G.CENTER.y),z.beginPath(),z.strokeStyle="rgb(150, 150, 150)";for(var a,g,Z,T,I,f=0;360>f;f++)a=f*Math.PI/180,0===f%5&&(g=x(a)*D,Z=C(a)*D,T=x(a)*A,I=C(a)*A,z.moveTo(g,Z),z.lineTo(T,I)),0===f%45&&(g=x(a)*D,Z=C(a)*D,T=x(a)*k,I=C(a)*k,z.moveTo(g,Z),z.lineTo(T,I));z.stroke(),z.rotate(-b);var r=P.lastRotation||X.target.getRotation();z.beginPath(),z.fillStyle="rgba(255, 0, 0, 0.1)",z.strokeStyle="rgb(157, 157, 157)",z.moveTo(0,0),z.arc(0,0,k,0,r,!1),z.fill(),z.beginPath(),z.moveTo(0+k,0),z.arc(0,0,k,0,r,!1),z.stroke(),z.restore()};var wj=lq.Curve=function(G){this.catalog="Curve",this._interactor=G};wj.prototype={},wj.prototype.constructor=wj,Y.defineProperties(wj.prototype,{activing:{get:function(){return this._activing},set:function(n){var P=this;if(n)P._activing=new lq.CurveActiving(this,n),P._activing._firePointChange();else{var e=P._activing;e&&e.dispose(),P._activing=null}}}}),wj.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},wj.prototype.setUp=function(){var G=this,U=G._interactor;U&&U.gv.mp(G._onGraphviewPropertyChanged,G)},wj.prototype._onGraphviewPropertyChanged=function(v){("zoom"===v.property||"translateX"===v.property||"translateY"===v.property)&&this._handleDataChanged()},wj.prototype.tearDown=function(){var p=this,j=p._interactor;j&&j.gv.ump(p._onGraphviewPropertyChanged,p)},wj.prototype.canEnterEditDetailMode=function(){var w=this,c=w._interactor,y=c._getValidSelection();if(1===y.length){var i=y[0],d=i instanceof v.Edge;if(i instanceof v.Shape||d){if(d){var e=i.s("edge.type");if(e&&"points"!==e)return}var J=c.gv;if(J.isPointEditable(i)&&J.isEditable(i))return w.target=i,!0}}},wj.prototype.canQuitEditDetailMode=function(_){var m=this,B=m._interactor._getLogicalPoint(_);return m._checkEditRealPoint(B)?void 0:m._interactor.gv.getDataAt(_)!==m.target?!0:void 0},wj.prototype.preHandleScroll=function(){var n=this.editing;return n&&n.inEdit?!0:void 0},wj.prototype.getCurrentSelectintStatus=function(){var q=this;if(q.activing&&!q.activing.selections){if(q.activing.status!=Q)return q.activing.status;var t=function(p){var i=q.activing.status;q.activing.status=p,q._interactor.fp("shapePointStatus",i,p)},A=lq.Curve.PointType,G=q.activing.point,n=q.activing.pairs;if(!n||1!==n.length)return t(A.Mirrored);var u=n[0],_=u.c1&&u.c1.isNearEnough(G),D=u.c2&&u.c2.isNearEnough(G);if(!u.c1||!u.c2)return _||D?t(A.Straight):t(A.Disconnected);if(_&&D)return t(A.Straight);if(_||D)return t(A.Asymmetric);var X=u.c1.clone().sub(G),o=u.c2.clone().sub(G);return Math.abs(X.x*o.y-X.y*o.x)>1e-5||X.x*o.x>0?t(A.Disconnected):Math.abs(X.length()-o.length())>1e-5?t(A.Asymmetric):t(A.Mirrored)}},wj.prototype.handle_keydown=function(M){var i=this;if(i._interactor.editDetail){var O=lq.Curve.PointType;"1"===M.key?i._setCurrentSelectionStatus(O.Straight):"2"===M.key?i._setCurrentSelectionStatus(O.Mirrored):"3"===M.key?i._setCurrentSelectionStatus(O.Disconnected):"4"===M.key&&i._setCurrentSelectionStatus(O.Asymmetric)}},wj.prototype.setCurrentSelectionStatus=function(g){var k=this,S=k._interactor;if(S){var J=S.gv;J.dm().beginTransaction(),this._setCurrentSelectionStatus(g),J.dm().endTransaction()}},wj.prototype._setCurrentSelectionStatus=function(z){var P=this,e=P.activing;if(e){var k=P.getCurrentSelectintStatus();if(null!==k&&k!==z){e.status=z;var l=P.activing.point,F=P.activing.pairs;if(F&&1===F.length){var R=F[0],Q=P.screenInfo.curve,i=lq.Curve.PointType,c=P._interactor,w=function(){P._writeToHt(),c.fp("shapePointStatus",k,z),P.check(c.gv,null,new lq.Math.Vector2(c._lastLogicalPoint))};if(z===i.Straight)return Q.moveCtrlPoint(R,l,"c1"),Q.moveCtrlPoint(R,l,"c2"),w(),void 0;if(k===i.Straight){var v=Q.findPairs(l,!0),K=v[0],x=K.r1||l,S=K.r2||l,y=S.clone().sub(x).multiplyScalar(.25);return Q.moveCtrlPoint(R,l.clone().sub(y),"c1"),Q.moveCtrlPoint(R,l.clone().add(y),"c2"),w(),void 0}var s=R.c1,M=R.c2;if(s&&M){if(z===i.Mirrored)return Q.moveCtrlPoint(R,l.clone().multiplyScalar(2).sub(M),"c1"),w(),void 0;if(z===i.Asymmetric&&k===i.Disconnected){var V=s.clone().sub(l).length(),y=l.clone().sub(M).setLength(V).add(l);return Q.moveCtrlPoint(R,y,"c1"),w(),void 0}}e._firePointChange(),c.fp("shapePointStatus",k,z),P.check(c.gv,null,new lq.Math.Vector2(c._lastLogicalPoint))}}}},wj.prototype._handleDataChanged=function(){var f="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(D){var C=this;if(C.screenInfo&&C.target){if(D&&f.indexOf(D.property)<0)return;var q=C._interactor;C.gatherSingleTarget(q.gv,C.target,!0),C.check(q.gv,null,new lq.Math.Vector2(q._lastLogicalPoint)),q._42()}}}(),wj.prototype.gatherSingleTarget=function($,M,V){var r,G,l=this;l.screenInfo&&l.screenInfo.curve&&(G=l.screenInfo.curve._curves);var h=l.editing;r=h?l.screenInfo:l.screenInfo={};var o,a,Y=M instanceof v.Edge;Y?(o=M.s("edge.segments"),a=M.s("edge.points")||new v.List):(o=M._58O,a=M._59O),r.S=o;var U,k=r.P=[],i=lq.getDataMatrix(M);if(M instanceof v.Polyline||M instanceof v.Edge&&l._interactor.getStyle("edgeElevationEditable"))U=M.getElevation&&M.getElevation()||0,r.E=[];else{var L=!1;a.each(function(Z){Z.e!==Q&&(L=!0)}),L&&(r.E=[])}if(a.each(function(A){r.E&&r.E.push(A.e!=Q?A.e:U),A=i.apply(A);var x=lq.toScreenPosition($,A);k.push(x.x,x.y)}),Y){var D=k.length,w=lq.toScreenPosition($,M._lastSourcePoint||(D?{x:k[0],y:k[1]}:{x:0,y:0})),p=lq.toScreenPosition($,M._lastTargetPoint||(D?{x:k[D-2],y:k[D-1]}:{x:0,y:0}));k.splice(0,0,w.x,w.y),k.push(p.x,p.y),r.E&&(r.E.splice(0,0,"head"),r.E.push("tail"))}if(!r.S||!r.S.size()){r.S=new v.List,r.S.add(1);for(var R=0;R<k.length/2-1;R++)r.S.add(2)}if((!h||V)&&l.convertToCubicBezier(G),l.activing&&(V||!l.editing||"realPoint"===l.editing.type)){var n=r.curve.findPairs(l.activing.point);l.activing.pairs=n}},wj.prototype._convertToNewPoint=function(p,w,f,E){var q,S,g;for(q=0,S=w.length;S>q;q++){if(g=w[q],g._p1.isNearEnough(p)&&(!E||E.indexOf(g._p1)<0))return g._p1;if(g._p4.isNearEnough(p)&&(!E||E.indexOf(g._p4)<0))return g._p4}if(f)for(q=0,S=Math.min(f.length,S);S>q;q++){if(g=f[q],g._p1===p&&(!E||E.indexOf(w[q]._p1)<0))return w[q]._p1;if(g._p4===p&&(!E||E.indexOf(w[q]._p4)<0))return w[q]._p4}},wj.prototype.convertToCubicBezier=function(h){var e,$,p=this,g=new lq.Math.Curve,N=p.screenInfo;if(g.createFromHtShape(N.P,N.S,N.E),N.curve=g,p.activing){var H=g._curves;e=p.activing.point,$=p._convertToNewPoint(e,H,h);var B=[];if($&&(p.activing.point=$,B.push($)),p.activing.selections){var n=-1,T=p.activing.selections;T.forEach(function(o){n++,$=p._convertToNewPoint(o,H,h,B),$&&(T[n]=$,B.push($))})}}},wj.prototype.check=function(o,j,v){if(!j||Qn(j)||Ei(j)){var P=this;if(P._interactor.setCursor("default"),P.editing=null,P.highlight=null,P.tipInfo=null,P.edgeEditResult=null,P.screenInfo){if(vp()||Ei(j))return P._interactor._42(),!0;if(P._checkEditCtrlPoint(v))return P._interactor._42(),!0;if(P._checkEditRealPoint(v))return P._interactor._42(),!0;if(P._checkEditElevation(v))return P._interactor._42(),!0;var I=P.screenInfo.curve,i=I.checkPoint(v,P._interactor.getStyle("curveIntersectSize"));if(i){var J=P.highlight={};J.type="insertKnot",J.bezier=i.bezier,J.point=i.intersection}return P._interactor._42(),!0}}},wj.prototype._checkEditRealPoint=function(f){var p,G,V,l,Y,P,K=this,z=K.screenInfo.curve._curves,_=K._interactor.getStyle("curvePointIntersectSize"),v=1/0;for(_*=_,V=0,l=z.length;l>V;V++)p=z[V],Y=p._p1,P=f.distanceToSquared(Y),v>P&&(v=P,G=Y),Y=p._p4,P=f.distanceToSquared(Y),v>P&&(v=P,G=Y);if(v>_)return!1;var Z=K.highlight={};return Z.type="changeRealPoint",Z.point=G,K.editing={type:"realPoint",point:G,shiftGuide:{point:G.clone(),dir:"x",limit:0}},K._interactor.setCursor("crosshair"),!0},wj.prototype._checkEditElevation=function(M){var f=this;if(!f._interactor.getStyle("curveElevationVisible"))return!1;var G=f.target;if(G instanceof v.Edge&&!f._interactor.getStyle("edgeElevationEditable"))return!1;var R=f.activing;if(!R)return!1;var w=R.getCurrentEditingPoint();if(!w)return!1;var k=f._interactor,d=k.getStyle("curveElevationGuideShift"),C=k.getStyle("curveElevationIntersectSize"),j=M.distanceToSquared({x:w.x+d[0],y:w.y+d[1]});if(!(j>C*C)){var u=f.highlight={};u.type="elevation";var y=new lq.Math.Vector2(M.x,M.y,w.e);return f.editing={type:"elevation",startPoint:y},f._interactor.setCursor("crosshair"),!0}},wj.prototype._checkEditCtrlPoint=function(h){var I=this;if(I.activing&&!I.activing.selections){var c=I.getCurrentSelectintStatus();if(c!==lq.Curve.PointType.Straight){var s=I.activing.pairs;if(s){var b=I._interactor.getStyle("curvePointIntersectSize");b*=b;var A,d,z,Y,v,$,N,U,f,r=1/0;for(N=0,f=s.length;f>N;N++)for(Y=s[N],U=0;2>U;U++)v=0===U?"c1":"c2",Y[v]&&($=h.distanceToSquared(Y[v]),r>$&&(r=$,A=Y,d=N,z=v));if(r>b)return!1;I.activing.hlpair=A,I.activing.hltype=z;var L=I.highlight={};return L.type="changeCtrlPoint",L.point=A[z],I.editing={type:"ctrlPoint",pair:A,pairId:d,ctrlType:z,direction:A[z].clone().sub(I.activing.point).normalize()},I._interactor.setCursor("crosshair"),!0}}}},wj.prototype.startEdit=function(P,b){P.startDragging(b);var x=this;x.highlight&&"insertKnot"===x.highlight.type&&(x.insertKnot(),x.gatherSingleTarget(x._interactor.gv,x.target),x.activing=null,x._checkEditRealPoint(x._interactor._getLogicalPoint(b)));var r=x._activing;if(r){var c=x.editing?x.editing.type:null;"ctrlPoint"===c?r.editingCtrl={pairId:x.editing.pairId,type:r.hltype}:"realPoint"===c&&(r.editingCtrl=!1)}var d=x.highlight,m=v.Default.isCtrlDown(b);if(!d||vp()||Ei(b)){var Y=x._interactor.gv;if(!Y.setFocus(b)||Y._scrolling)return;return m?x._multiSelect={startPoint:Y.lp(b)}:Y.isPannable()&&(Qn(b)||Ei(b))&&(x._pan={tx:Y.tx(),ty:Y.ty()},P.fi({kind:"beginPan",event:b})),void 0}if("changeRealPoint"===d.type){var s,G=x.activing?x.activing.point:null,j=x.activing?x.activing.selections:null;if(m&&x.activing)G===d.point?(j?(x.activing={point:j[0]},j.length>1&&(j.splice(0,1),x.activing.selections=j)):x.activing=null,x.editing=null):j&&(s=j.indexOf(d.point))>=0?(j.length>1?j.splice(s,1):delete x.activing.selections,x.editing=null):j?(j.push(G),x.activing={point:d.point,selections:j}):x.activing={point:d.point,selections:[G]};else if(j)G===d.point||((s=j.indexOf(d.point))>=0?(j.splice(s,1,G),x.activing={point:d.point,selections:j}):x.activing={point:d.point});else{var X;G===d.point&&(X=x.activing.status),x.activing={point:d.point},X&&(x.activing.status=X)}P.fi({kind:"beginEditPoint",event:b})}},wj.prototype.insertKnot=function(){var d=this,k=d.highlight,n=d.screenInfo.curve;n.insertKnot(k.bezier,k.point.t),d._writeToHt()},wj.prototype._writeToHt=function(){var k,Y,S=this,y=S.screenInfo.curve,w=y.toHtShape(),$=w.points,N=[],h=w.segments,K=S._interactor.gv;K.dm().beginTransaction();var s,Z,I=S.target,b=I instanceof v.Edge,e=lq.getDataMatrix(I).invert();Z=I instanceof v.Polyline||I instanceof v.Edge&&S._interactor.getStyle("edgeElevationEditable"),Z&&(s=I.getElevation&&I.getElevation()||0);for(var j=0,D=$.length;D>j;j++)k=$[j],Y=lq.toWorldPosition(K,k),Y=e.apply(Y),isFinite(k.e)&&k.e!==s&&(Y.e=k.e),N.push(Y);if(I._writing=!0,b){I.s("edge.type","points"),I.setStyle("edge.segments",h),I.setStyle("edge.points",N.slice(1,N.length-1)),I.setStyle("edge.source.offset.x",0),I.setStyle("edge.source.offset.y",0),I.setStyle("edge.target.offset.x",0),I.setStyle("edge.target.offset.y",0);var t=S._nextChangeEdgeHost;delete S._nextChangeEdgeHost,t&&("source"===t.type?I.setSource(t.host):I.setTarget(t.host)),S._writeEdgeHostAnchor("source",N[0]),S._writeEdgeHostAnchor("target",N[N.length-1])}else N.length?(I.setSegments(h),I.setPoints(N,!0)):I.removeFromDataModel();K.dm().endTransaction(),delete I._writing},wj.prototype._writeEdgeHostAnchor=function(r,D){var s=this,b=s.target,t=s._calcHostAnchor(b,r,D);t.index!==Q?(b.setStyle("edge."+r+".index",t.index),b.setStyle("edge."+r+".percent",Q),b.setStyle("edge."+r+".anchor.x",Q),b.setStyle("edge."+r+".anchor.y",Q)):t.percent!==Q?(b.setStyle("edge."+r+".percent",t.percent),b.setStyle("edge."+r+".index",Q),b.setStyle("edge."+r+".anchor.x",Q),b.setStyle("edge."+r+".anchor.y",Q)):(b.s("edge."+r+".anchor.x",t.x),b.s("edge."+r+".anchor.y",t.y),t.offsetX||t.offsetY?(b.s("edge."+r+".offset.x",t.offsetX),b.s("edge."+r+".offset.y",t.offsetY)):(b.s("edge."+r+".offset.x",0),b.s("edge."+r+".offset.y",0)))},wj.prototype._calcHostAnchor=function(L,w,Y,d){d||(d="source"===w?L.getSource():L.getTarget());var W=this._interactor.gv,m=W.calculateAttachPoint(d,Y);if(m)return m.info;if(Xm(d)){var o=W.calculateEdgePosition(d,Y);return o}var H=d.getRotation(),l=d.getAnchor();Uq(d,W)&&(H=0);var h=d.getScale();if(H||h.x<0||h.y<0){var I=d.getMatrix(),J=I.tfi(Y),K=d.getSize();return{x:J.x/K.width+l.x,y:J.y/K.height+l.y}}var D=Pb(W,d),u={x:(Y.x-D.x)/D.width,y:(Y.y-D.y)/D.height};return u},wj.prototype._handlePanning=function(u){var V=this,B=V._pan;if(B){B.started=!0;var w=V._interactor,h=w.gv,Y=w._lastClientPoint,o=hb(u),e=Si(h,o,Y);h.setTranslate(B.tx+e.x,B.ty+e.y),V.gatherSingleTarget(w.gv,V.target),w._42(),w.fi({kind:"betweenPan",event:u})}},wj.prototype.handleEdit=function(o,_){var K=this,d=K.editing;if(K._pan)return K._handlePanning(_),void 0;if(K._multiSelect)return K._multiSelect.endPoint=o.lp(_),K._interactor.redraw(),void 0;if(d){d.inEdit=!0;var u,n,Y,N=K._interactor._getLogicalPoint(_),Z=v.Default.isCtrlDown(_),m=v.Default.isShiftDown(_),U=d.type,s=K.activing;if(K._guideInfo=null,"ctrlPoint"===U&&m){var I=K.editing.direction.clone();u=s.point;var A=I.dot(N.clone().sub(u));N=I.setLength(A).add(u)}else if("ctrlPoint"===U||"realPoint"===U){var I;if("realPoint"===U&&m){var z=K.editing.shiftGuide;n=z.point;var j=Math.abs(N.x-n.x),P=Math.abs(N.y-n.y);j>P&&j>z.limit&&"y"===z.dir&&(z.dir="x"),P>j&&P>z.limit&&"x"===z.dir&&(z.dir="y"),I=z.dir,"x"===I?(N.y=n.y,z.limit=Math.max(z.limit,j)):"y"===I&&(N.x=n.x,z.limit=Math.max(z.limit,P))}var f=K._isEditEdgeSourceTarget();if(f){var $=K._editEdgeSourceTarget(f,N,Z);$&&(K.edgeEditResult=$,Y=$.tipText)}else if(!Z){var G=K._guidingToEdit(N,I),B="realPoint"===U?K._interactor.gridGuide.findClosest(N,I,!0):null,D=1/0,l=1/0;B&&(B.x&&(D=B.x),B.y&&(l=B.y));var p=!1;G&&(G.xList&&(Math.abs(G.x)<=Math.abs(D)?(p=!0,D=G.x):delete G.xList),G.yList&&(Math.abs(G.y)<=Math.abs(l)?(p=!0,l=G.y):delete G.yList),p&&(K._guideInfo=G)),isFinite(D)&&(N.x+=D),isFinite(l)&&(N.y+=l),p&&(G.v=N)}}var r=K.screenInfo.curve;if("realPoint"===d.type){u=d.point,u.e!==Q&&(N.e=u.e),r.moveRealPoint(u,N),d.point=N,K.highlight.point=N;var i=s.status,F=s.selections;if(K.activing={point:N,status:i},F){var O=N.clone().sub(u),J=0;F.forEach(function(i){var V=i.clone().add(O);r.moveRealPoint(i,V),F[J++]=V}),K.activing.selections=F}}else if("ctrlPoint"===d.type){var k=s.pairs,b=k[d.pairId];r.moveCtrlPoint(b,N,d.ctrlType);var T=s.status,W=lq.Curve.PointType;if((T===W.Mirrored||T===W.Asymmetric)&&b.c1&&b.c2){var u=new lq.Math.Vector2(s.point),H="c1"===d.ctrlType?"c2":"c1";if(T===lq.Curve.PointType.Mirrored)r.moveCtrlPoint(b,u.clone().multiplyScalar(2).sub(N),H);else if(T===W.Asymmetric){var A=b[H].clone().sub(u).length(),L=u.clone().sub(b[d.ctrlType]).setLength(A).add(u);isNaN(L.x)||r.moveCtrlPoint(b,L,H)}}s._firePointChange()}else if("elevation"===d.type){n=d.startPoint;var e=n.e+(n.y-N.y)/o._zoom;K._setCurrentPointImpl("e",e),s._firePointChange(),Y="E: "+lq.toFixed(e)}var h=v.Default.getLogicalPoint(_,K._interactor._canvas);if(h.x+=lq.Icons.TipShiftX,h.y+=lq.Icons.TipShiftY,!Y){var t=lq.toWorldPosition(o,N);Y=""+lq.toFixed(t.x)+", "+lq.toFixed(t.y)}K.tipInfo={helperPos:h,text:Y,size:Y.length},K._writeToHt(),K._interactor.fi({kind:"betweenEditPoint",event:_})}},wj.prototype._setCurrentPointImpl=function(C,R){var B=this,h=B._activing;if(!h)return!1;var Y=B.target;if(!Y)return!1;var j=h.getCurrentEditingPoint();if(!j)return!1;var t=h.editingCtrl;if(!t)var u=j.clone();if("e"===C)j.e=R;else{var r;if("x"===C||"y"===C){var x=h._lastFirePoint;r="x"===C?{x:R,y:x?x.y:0}:{x:x?x.x:0,y:R}}else"object"==typeof C?(r=C,C.e!==Q&&(j.e=C.e)):(r={x:arguments[0],y:arguments[1]},arguments[2]!==Q&&(j.e=arguments[2]));var v=lq.getDataMatrix(Y);r=lq.toScreenPosition(B._interactor.gv,v.apply(r)),j.x=r.x,j.y=r.y}if(!t){var I=u.multiplyScalar(-1).add(j);j.e&&u.e&&(I.e=j.e-u.e);var W=B.screenInfo.curve;W.moveCtrlDueToRealPointMovement(j,I);var G=h.selections;
if(G){var A=0;G.forEach(function(X){var s=X.clone().add(I);isFinite(I.e)&&(s.e=(isFinite(X.e)?X.e:Y.getElevation()||0)+I.e),W.moveRealPoint(X,s),G[A++]=s}),h.selections=G}}return!0},wj.prototype.setCurrentPoint=function(g,F){return this._setCurrentPointImpl(g,F)?(this._writeToHt(),!0):!1},wj.prototype._isEditEdgeSourceTarget=function(){var w=this,t=w.target;if(!(t instanceof v.Edge))return!1;var K=w.editing.point,A=w.screenInfo.curve._curves;return K===A[0]._p1?"source":K===A[A.length-1]._p4?"target":!1},wj.prototype._editEdgeSourceTarget=function(t,y,j){var z,o=this,$=o.target;if(z="source"===t?$.getSource():$.getTarget()){var T,Z=o._interactor.gv,p=lq.toWorldPosition(Z,y),I=o._calcHostAnchor($,t,p,z);if(T=I.index!==Q||I.percent!==Q?I.distance*Z.getZoom()>o._interactor.getStyle("edgeHostEdgeMaxDistance"):o._interactor.getStyle("edgeHostDetectPerFrame")?!0:I.x<0||I.x>1||I.y<0||I.y>1?!0:!1){var m=Z.getDataAt(p,function(Q){return Z.isSelectable(Q)?Z.isSourceTargetEditable($,Q,t)?$.canSetSourceTarget(Q,t)?!0:!1:!1:!1});if(m){var A=o._calcHostAnchor($,t,p,m);z=m,o._nextChangeEdgeHost={type:t,host:m},I=A}}var c,l,q;if(j||I.x===Q)(I.percent!==Q||I.index!==Q)&&(l=I.point);else{var M=o._interactor.getStyle("anchorRound"),S=o._interactor.getStyle("anchorSensitivity");c=Z.calculateAttachPoint(z,p),c?I=c.info:(I.x=lq.roundTo(I.x,M,S),I.y=lq.roundTo(I.y,M,S)),l=ik(Z,z,0,I.offsetX||0,I.offsetY||0,I.x,I.y)}l&&(q=lq.toScreenPosition(Z,l),y.x=q.x,y.y=q.y),o._edgeHostGuideInfo={corners:lq.getTargetCornersOnScreen(Z,z),attach:c?c.index:-1,host:z};var b;return I.percent!==Q?b="percent: "+I.percent.toFixed(2):I.index!==Q?b="index: "+I.index:(b=""+I.x.toFixed(2)+", "+I.y.toFixed(2),(I.offsetX||I.offsetY)&&(b+=" offset: "+I.offsetX.toFixed(2)+", "+I.offsetY.toFixed(2))),{host:z,anchor:I,tipText:b}}},wj.prototype._guidingToEdit=function(A,g){var Q,U,G=this;if(Q=G.screenInfo.curve){U=Q._curves;var x,v,k,K,q,W,S,n,b=1/0,P=1/0,V=[];for(G.editing&&"realPoint"===G.editing.type&&(n=G.editing.point),q=0,W=2*U.length;W>q;q++)S=U[Math.floor(q/2)][q%2?"_p4":"_p1"],V.indexOf(S)>=0||(V.push(S),n&&n===S||(k=S.x-A.x,K=S.y-A.y,Math.abs(k)<Math.abs(b)?(b=k,x=[S]):k===b&&x.push(S),Math.abs(K)<Math.abs(P)?(P=K,v=[S]):K===P&&v.push(S)));var r=G._interactor.getStyle("smartGuideThreshold");if((Math.abs(b)>r||"y"===g)&&(x=null),(Math.abs(P)>r||"x"===g)&&(v=null),x||v){var L=!1,I={};if(x&&(L=!0,I.xList=x,I.x=b),v&&(L=!0,I.yList=v,I.y=P),L)return I}}},wj.prototype._46O=function(l){var L=this;L.editing&&(L.editing=null,L._interactor.fi({kind:"endEditPoint",event:l})),L._guideInfo=null,L._edgeHostGuideInfo=null,L._pan&&(L._pan=null,L._interactor.fi({kind:"endPan",event:l})),L._multiSelect&&(L._handleMultiSelect(L._multiSelect),L._multiSelect=null),L.tipInfo=null,L.edgeEditResult=null},wj.prototype._handleMultiSelect=function(b){if(b.startPoint&&b.endPoint){var F,J,x,$,P,d=this,E=d._interactor,n=E.gv,c=lq.toScreenPosition(n,b.startPoint),q=lq.toScreenPosition(n,b.endPoint),V=v.Default.unionPoint(c,q),O=d.screenInfo.curve._curves,y=[],B=function(T){T.x>=V.x&&T.y>=V.y&&T.x<=V.x+V.width&&T.y<=V.y+V.height&&y.indexOf(T)<0&&y.push(T)};for(F=0,J=O.length;J>F;F++)P=O[F],B(P._p1),B(P._p4);if(y.length){var U=d.activing||{},p=U.selections||[];for(U.point&&p.push(U.point),F=0,J=p.length;J>F;F++)x=p[F],$=y.indexOf(x),$>=0?y[$]=Q:y.push(x);var f=y;for(y=[],F=0,J=f.length;J>F;F++)f[F]&&y.push(f[F]);J=y.length,0===J?d.activing=null:1===J?d.activing={point:y[0]}:(x=y[J-1],d.activing={point:x,selections:y.splice(0,J-1)}),E.redraw()}}},wj.prototype._canDeletePoint=function(j,y){var N=this.target;if(!(N instanceof v.Edge))return!0;var b=j._curves[0],r=j._curves[j._curves.length-1];return b._p1===y||r._p4===y?!1:!0},wj.prototype.handleDelete=function(){var R=this;if(R.activing&&R.screenInfo){var E=v.Default.isShiftDown(),P=R.screenInfo.curve;R._canDeletePoint(P,R.activing.point)&&P.deleteRealPoint(R.activing.point,E),R.activing.selections&&R.activing.selections.forEach(function(z){R._canDeletePoint(P,z)&&P.deleteRealPoint(z,E)}),R.activing=null,delete R.editing,delete R.tipInfo,delete R.edgeEditResult,delete R._pan,delete R._multiSelect,R._writeToHt(),R._interactor.fp("deleteShapePoint",!1,!0)}},wj.prototype.handleDoubleClick=function(O){var P=this,d=P._interactor._getLogicalPoint(O);if(P.screenInfo&&P._checkEditRealPoint(d)){var u=P.getCurrentSelectintStatus(),h=lq.Curve.PointType;return u=u===h.Mirrored?h.Straight:h.Mirrored,P._setCurrentSelectionStatus(u),P._interactor._42(),!0}},wj.prototype._drawHighlight=function(o){var J=this,M=J.highlight;if(M){var q=M.bezier,Z=J._interactor;q&&lq.Icons.DrawIcon(Z,o,lq.Icons.ShapeHighlightCurve,[q._p1.x,q._p1.y,q._p2.x,q._p2.y,q._p3.x,q._p3.y,q._p4.x,q._p4.y]);var s=M.point;s&&"insertKnot"===M.type&&lq.Icons.DrawIcon(Z,o,lq.Icons.ShapeHighlighPoint,s)}},wj.prototype._drawGuide=function(s){var I=this,j=I._guideInfo;if(j){var l,E,B,o,P=j.v;for(l=0;2>l;l++)if(o=0===l?j.xList:j.yList)for(E=0,B=o.length;B>E;E++)lq.Icons.DrawIcon(I._interactor,s,lq.Icons.ShapeGuideLine,[P.x,P.y,o[E].x,o[E].y])}},wj.prototype._drawCurrentPoint=function(q){var P=this;if(P.activing){var R=P.activing,c=P.getCurrentSelectintStatus(),M=P._interactor;if(c!==lq.Curve.PointType.Straight){var T=R.pairs;R.hlpair,R.hltype;var v=R.selections,J=R.editingCtrl;if(T&&!v){var A,t,p;for(t=0,p=T.length;p>t;t++)A=T[t],J&&t===J.pairId&&A[J.type]?lq.Icons.DrawIcon(M,q,lq.Icons.ShapeActivingCtrl,{point:A.point,c1:A.c1,c2:A.c2,hl:J.type}):lq.Icons.DrawIcon(M,q,lq.Icons.ShapeActivingCtrl,A)}}lq.Icons.DrawIcon(M,q,lq.Icons.ShapeHighlighRealPoint,P.activing.point),v&&v.forEach(function(C){lq.Icons.DrawIcon(M,q,lq.Icons.ShapeHighlighRealPoint,C)})}},wj.prototype.clear=function(){var X=this;X.editing=null,X._guideInfo=null,X.activing=null,X.highlight=null},wj.prototype._42=function(S){var o=this;o.info={},o.editing||(o.screenInfo=null);var e=o._interactor;if(!e.editDetail)return o.clear(),void 0;var t=e.gv;if(!o.target||!t.isSelected(o.target)||!t.isVisible(o.target))return e.editDetail=!1,o.clear(),void 0;if(o.gatherSingleTarget(t,o.target),lq.Icons.DrawIcon(e,S,lq.Icons.ShapeBgCurve,o.screenInfo),o._interactor.getStyle("curveElevationVisible")&&(o.target instanceof v.Polyline||o.target instanceof v.Edge&&o._interactor.getStyle("edgeElevationEditable"))&&o.activing){var A=o.activing.getCurrentEditingPoint();A&&"string"!=typeof A.e&&lq.Icons.DrawIcon(e,S,lq.Icons.EdgeElevationGuide,A)}if(o._drawHighlight(S),o._drawCurrentPoint(S),o._getRealPoint().forEach(function(K){lq.Icons.DrawIcon(e,S,lq.Icons.ShapePoint,K)}),o._drawGuide(S),o.tipInfo&&o._interactor.getStyle("curveTipVisible")&&lq.Icons.DrawIcon(e,S,lq.Icons.TipHelper,o.tipInfo),o._edgeHostGuideInfo&&e._drawHostGuide(o._edgeHostGuideInfo),o.edgeEditResult&&o._drawEdgeHostHighlight(S,o.edgeEditResult.host,o.edgeEditResult.anchor),o._multiSelect&&o._multiSelect.endPoint){var I=v.Default.unionPoint(lq.toScreenPosition(t,o._multiSelect.startPoint),lq.toScreenPosition(t,o._multiSelect.endPoint));I.color=t.getRectSelectBorderColor(),S.save(),S.setTransform(1,0,0,1,0,0);var Y=B.devicePixelRatio,c=I.borderWidth=Math.round(Y);c/=2,I.x=Math.round(I.x*Y)+c,I.y=Math.round(I.y*Y)+c,I.width=Math.round(I.width*Y),I.height=Math.round(I.height*Y),lq.Icons.DrawIcon(e,S,lq.Icons.SimpleRect,I),S.restore()}},wj.prototype._drawEdgeHostHighlight=function(A,M,Y){this.drawEdgeHostHighlight(A,M,Y),this._interactor.redraw()},wj.prototype.drawEdgeHostHighlight=function(t,S,U){if(Xm(S)){var q,T,_,Z,s=this,B=s._interactor,y=B.gv,O=y.getDataUI(S),o=Nn(O),L=[];for(_=0,Z=o.points.length;Z>_;_++)T=lq.toScreenPosition(y,o.points.get(_)),L.push(T.x,T.y);o.segments&&(q=o.segments.toArray());var m=B.getStyle("edgeHostHighlighPeriod"),e=B.getStyle("edgeHostEdgeHighlighColor");lq.Icons.DrawIcon(B,t,lq.Icons.ShapeBgCurve,{P:L,S:q,color:e,dynamicVisible:U.index===Q,dynamicPeriod:m}),e=B.getStyle("edgeHostPointHighlighColor");var g=Cc(O);for(_=0,Z=g.length;Z>_;_++){var M=g[_],Y=lq.toScreenPosition(y,M);lq.Icons.DrawIcon(B,t,lq.Icons.ShapePoint,{point:{x:Y.x,y:Y.y},color:e,size:12,dynamicVisible:_===U.index,dynamicPeriod:m})}}},wj.prototype._getRealPoint=function(){var v,Z=this.screenInfo,V=Z.P,k=Z.S,W=-1,y=[],N=-1,n=k.length;return k.each(function(R){N++;var z=1;if(3===R)z=2;else if(4===R)z=3;else if(5===R)return;W+=z,v=N+1>=n?!0:1===k.get(N+1)?!0:!1,y.push({point:{x:V[2*W],y:V[2*W+1]},segmentIndex:N,pointIndex:W,isEnd:v})}),y},wj.prototype.getEditingPointsInfo=function(M){var F=this,C=F.activing;if(!C)return!1;var c=C.point;if(!c)return!1;var t=this._getRealPoint(),B=[{screen:c}];C.selections&&C.selections.forEach(function(y){B.push({screen:y})});var y,j,n=t.length;return B.forEach(function(I){for(y=0;n>y;y++)if(j=t[y],I.screen.isNearEnough(j.point)){I.segmentIndex=j.segmentIndex,I.pointIndex=j.pointIndex,I.point=F.target.getPoints().get(j.pointIndex);break}}),M&&B.sort(function(n,x){return n.segmentIndex-x.segmentIndex}),B};var Fj=lq.MoveHelper=function($){var B=this;B.catalog="Move",B._interactor=$};Fj.prototype={},Fj.prototype.constructor=Fj,Fj.prototype.calcShift=function(B,S,l){var J,G,$=this,j=$._interactor.gv,g=j.lp(S);if("beginMove"===B&&$._gatherGridInfo(l._lastLogicalPoint||g),J=$._target){var L=J.downPosition;if(L){var t=$._interactor.getStyle("moveSensitivity")/j._zoom;if(L.distanceTo(g)<t)return{x:0,y:0};delete J.downPosition}var O;G=v.Default.isShiftDown(S),G&&(g=$._dealShiftDown(g),O=J.shiftGuide.dir);var U,Z=J.rawPos={x:J.pos.x+g.x-J.lp.x,y:J.pos.y+g.y-J.lp.y};if(v.Default.isCtrlDown(S)){if(U=$._calcShiftByAddon(),$._target.node instanceof lq.Group){var d=$._target.node;d._position.x+=U.x,d._position.y+=U.y}return U}var x=$._interactor.rectGuide;if(J.node instanceof v.Data&&J.node.s("2d.attachable")){var _=$._calcAttachNodeShift(J.node,Z);if(x.clear(),_)return _}for(var I,H=J.x+Z.x,M=J.y+Z.y,P={x:H,y:M},Y={x:H+J.w/2,y:M+J.h/2},N={x:H+J.w,y:M+J.h},k=$._interactor.gridGuide,E=[x.findClosest(P,O),x.findClosest(Y,O),x.findClosest(N,O),k.findClosest(P,O),k.findClosest(Y,O),k.findClosest(N,O)],T=1/0,z=1/0,C=0,K=E.length;K>C;C++)I=E[C],I&&(H=I.x,M=I.y,isFinite(H)&&Math.abs(H)<Math.abs(T)&&(T=H),isFinite(M)&&Math.abs(M)<Math.abs(z)&&(z=M));if(isFinite(T)||(T=0),isFinite(z)||(z=0),U=$._calcShiftByAddon(T,z),$._target.node instanceof lq.Group){var d=$._target.node;d._position.x+=U.x,d._position.y+=U.y}var W=J.node;if(!Uq(W,j)){var F=Z.x+T,m=Z.y+z;$._interactor.rectGuide.gatherLines({node:W,x:J.x+F,y:J.y+m,w:J.w,h:J.h},O)}return U}},Fj.prototype._calcShiftByAddon=function(c,r){var Q=this._target,e=Q.rawPos,D=Q.node.getPosition();return c=c||0,r=r||0,{x:e.x-D.x+c,y:e.y-D.y+r}},Fj.prototype._dealShiftDown=function(F){var t=this,N=t._target.shiftGuide,$=t._target.lp,E=Math.abs(F.x-$.x),h=Math.abs(F.y-$.y);E>h&&E>N.limit&&"y"===N.dir&&(N.dir="x"),h>E&&h>N.limit&&"x"===N.dir&&(N.dir="y");var D=N.dir;return"x"===D?(F.y=$.y,N.limit=Math.max(N.limit,E)):"y"===D&&(F.x=$.x,N.limit=Math.max(N.limit,h)),F},Fj.prototype._isAttachableLineShape=function(e){if(!e.getSegments)return!1;var G=e.getSegments();if(!G)return!0;G instanceof v.List&&(G=G.getArray());for(var T=1,d=G.length;d>T;T++)if(2!==G[T])return!1;return!0},Fj.prototype._calcAttachNodeShift=function(){var B=new xi,D=new xi,L=new xi,K=new xi;return function(p,$){var H=this._interactor.gv,X=p.getHost(),y=H.getDataAt($,function(u){return u.s("2d.hostable")?!0:!1});if(y&&X!==y&&p.setHost(y),!y)return this._edgeHostGuideInfo=null,p.setHost(null);var x=this._edgeHostGuideInfo={corners:lq.getTargetCornersOnScreen(H,y),host:y,attach:-1};if(this._isAttachableLineShape(y)){for(var A,W,M,I,u,m,h=y.getPoints(),Q=h.size(),F=y.getPointsMatrix2d(),f=1/0,e=0;Q>e&&(e!==Q-1||y.isClosePath());e++)0!==e?D.copy(L):F.apply(h.get(e),D),F.apply(e===Q-1?h.get(0):h.get(e+1),L),B.copy($).sub(D),K.copy(L).sub(D),A=K.length(),K.divideScalar(A),W=B.dot(K),0>W?W=0:W>A&&(W=A),K.multiplyScalar(W).add(D),M=B.copy($).sub(K).lengthSq(),f>M&&(f=M,m=e,I=W,u=A);return Math.sqrt(f)*H.getZoom()>this._interactor.getStyle("attachThreshold")?(p.s({"attach.index":-1}),p.setHost(null),void 0):(p.s("attach.offset.opposite")&&(I=u-I),p.s({"attach.index":m,"attach.offset":p.s("attach.offset.relative")?I/u:I}),{x:0,y:0})}var P=H.calculateAttachPoint(y,$);if(P){var Z=P.point;return x.attach=P.index,this._calcShiftByAddon(Z.x-$.x,Z.y-$.y)}}}(),Fj.prototype._gatherGridInfo=function(O){var D,F=this,j=F._interactor,f=j._getValidSelection();if(f.length){if(1===f.length){if(D=f[0],!D.getRect)return F._target=null,void 0}else if(D=lq.Group.findOrCreateGroup(f),!D)return F._target=null,void 0}else{var f=j.gv.sm().getSelection();if(f.length&&(D=f.get(0),!D.getRect))return F._target=null,void 0}if(D){var k=D.getPosition(),$=D.getRect();F._target={node:D,x:$.x-k.x,y:$.y-k.y,w:$.width,h:$.height,lp:{x:O.x,y:O.y},pos:{x:k.x,y:k.y},shiftGuide:{dir:"x",limit:0},downPosition:new lq.Math.Vector2(O)},j.rectGuide.gatherRects()}},Fj.prototype.clear=function(){var x=this;x._edgeHostGuideInfo=null,x._interactor.rectGuide.clear(),x._interactor._42()},Fj.prototype._42=function(){var I=this._edgeHostGuideInfo;I&&this._interactor._drawHostGuide(I)};var bg="directional",ro="point",xb="spot",dd="light.color",ue={},Xj=function(F,y){fh(y)&&Mr.test(y)?Pn(F,y):nd(y)&&y.modelType?Xf(F,y):Qr[F]=y},Lp=function(s){return s},bf=function(l){l=t.convertShape3dModelName(l);var J;if(nd(l)){if(l.modelType){if(l.uuid){if(J=Qr[l.uuid])return J}else l.uuid=v.Math.generateUUID();return Xf(l.uuid,l),Q}return l}return J=Qr[l],l&&J===Q&&Mr.test(l)&&(Am&&Am[l]||Pn(l,l)),J},pf=function(v,s){v.frameStack?v.frameStack.push(s):v.frameStack=[s],v.bindFramebuffer(v.FRAMEBUFFER,s)},Sj=function(r){var D=r.frameStack;if(D){if(D.pop(),D.length)return r.bindFramebuffer(r.FRAMEBUFFER,D[D.length-1]),void 0;r.frameStack=null}r.bindFramebuffer(r.FRAMEBUFFER,null)};Fd(t,{graph3dViewAttributes:I,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:k/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:qf,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:k,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:k/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:Xj,getShape3dModel:bf,convertShape3dModelName:Lp,getShape3dModelMap:function(){return Qr},getCachedShape3dModelMap:function(){return Nr},createMatrix:function(U,t){Ad(U)||(U=[U]);for(var v=U.length-1;v>=0;v--){var D=U[v];t=ph(D.mat,D.s3,D.r3,D.rotationMode,D.t3,t)}return t},transformVec:function(z,x){return Tl(z,x)},glBindFrame:pf,glUnbindFrame:Sj,createBoxModel:function(){return{vs:ob,ns:Kb,uv:Eh,is:gk}},createRoundRectModel:function(C,U){return mk.roundRect(C,U)},createStarModel:function(M,F){return mk.star(M,F)},createRectModel:function(P,m){return mk.rect(P,m)},createTriangleModel:function(T,l){return mk.triangle(T,l)},createRightTriangleModel:function(X,j){return mk.rightTriangle(X,j)},createParallelogramModel:function($,r){return mk.parallelogram($,r)},createTrapezoidModel:function(h,U){return mk.trapezoid(h,U)},createSmoothSphereModel:function(q,I,j,Z,b,i,r){return Sq(new yg(q,I,j,Z,b,i,r))},createSphereModel:function(f,x,q,D,X,Q,L){return f?bb(f,x,q,D,X,Q,L):t.createSmoothSphereModel()},createSmoothConeModel:function(F,z,W,K,m){return tl(F,z,W,K,m)},createConeModel:function(b,r,F,d,K,E){return b?di(b,r,F,d,K,E):tl(E)},createSmoothCylinderModel:function(v,c,S,g,Y,e,m,u){return Sq(new io(v,c,S,g,Y,e,m,u))},createCylinderModel:function(i,h,X,U,G,F,a,q){return i?Fe(i,h,X,U,G,F,a,q):Pr(F,a)},createSmoothTorusModel:function(J,$,D,e,m,d){return Sq(new cr(J,$,D,e,m,d))},createTorusModel:function(L,A,C,a,X,U,n,P){return L?qe(L,A,C,a,X,U,n,P):Jd(U,n)},createExtrusionModel:function(o,C,U,x,I,r,L,J){return dc(o,C,U,x,I,r,L,J)},createSmoothRingModel:function(l,D,w,o,v,c){for(var U=[],P=0;P<l.length-1;P+=2)U.push({x:l[P],y:l[P+1]});for(l=wn(U,D,w)[0],U=[],P=0;P<l.length;P++){var I=l[P];U.push(new bo(I.x,0,I.y))}return Sq(new rd(U,c,o,v))},createTextGeometry:function(_,I){return Sq(new Rh(_,I))},loadFontFace:function(S,X){t.xhrLoad(S,function(I){if(!I)return X();var x;try{x=JSON.parse(I)}catch(q){x=JSON.parse(I.substring(65,I.length-2))}em.loadFace(x),X&&X(x.familyName.toLowerCase())},X?null:{sync:!0})},createRingModel:function(a,G,H,j,F,w,u,o,V,$){for(var Z=[],q=0;q<a.length-1;q+=2)Z.push({x:a[q],y:a[q+1]});w=w||t.shapeSide,u=u||0,o=o||w;var z,E,r,v,P,K,T,l,m,Y,q,L,_,e,A,p,W,M,U=[],g=[],J=V?[]:I,h=V?[]:I,y=$?[]:I,S=$?[]:I,n=j?[]:I,O=j?[]:I,Q=F?[]:I,k=F?[]:I,a=wn(Z,G,H),f=Jg(a),c=0,b=2*Math.PI/w;return a.forEach(function(a){if(r=a.length,r>1){if(v=a[0],j)for(K=v.x,l=v.y,q=u;o>q;q++)L=q+1,_=q*b,e=L*b,A=x(_),p=C(_),W=x(e),M=C(e),n.push(A*K,l,-p*K,W*K,l,-M*K,0,l,0),O.push(.5-.5*A,.5-.5*p,.5-.5*W,.5-.5*M,.5,.5);for(Y=0;r>Y;Y++){for(P=a[Y],K=v.x,T=P.x,l=v.y,m=P.y,z=c/f,c+=Oj(v,P),E=c/f,q=u;o>q;q++)L=q+1,_=q*b,e=L*b,A=x(_),p=C(_),W=x(e),M=C(e),U.push(A*T,m,-p*T,W*T,m,-M*T,A*K,l,-p*K,W*T,m,-M*T,W*K,l,-M*K,A*K,l,-p*K),g.push(q/w,E,L/w,E,q/w,z,L/w,E,L/w,z,q/w,z),V&&q===u&&(J.push(0,l,0,0,m,0,A*T,m,-p*T,A*T,m,-p*T,A*K,l,-p*K,0,l,0),h.push(0,.5-l,0,.5-m,2*T,.5-m,2*T,.5-m,2*K,.5-l,0,.5-l)),$&&L===o&&(y.push(0,l,0,W*T,m,-M*T,0,m,0,W*T,m,-M*T,0,l,0,W*K,l,-M*K),S.push(1,.5-l,1-2*T,.5-m,1,.5-m,1-2*T,.5-m,1,.5-l,1-2*K,.5-l));v=P}if(F)for(K=v.x,l=v.y,q=u;o>q;q++)L=q+1,_=q*b,e=L*b,A=x(_),p=C(_),W=x(e),M=C(e),Q.push(W*K,l,-M*K,A*K,l,-p*K,0,l,0),k.push(.5-.5*W,.5+.5*M,.5-.5*A,.5+.5*p,.5,.5)}}),{vs:U,uv:g,bottom_vs:Q,bottom_uv:k,top_vs:n,top_uv:O,from_vs:J,from_uv:h,to_vs:y,to_uv:S}}},!0),Fd(q,{"3d.move.mode":Q,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":Q,"edge.gradient.color":Q,"edge.source.t3":Q,"edge.target.t3":Q,"light.type":ro,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":k/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":ps,"wf.short":!1,"wf.mat":Q,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:Q,"transparent.mask":!1,brightness:Q,"select.brightness":.7,"repeat.uv.length":Q,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":Q,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Tk,"label.t3":Q,"label.r3":Q,"label.texture.scale":2,"label.rotationMode":pm,"label.light":!1,"label.blend":Q,"label.reverse.flip":!1,"label.reverse.color":fk,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Tk,"label2.t3":Q,"label2.r3":Q,"label2.texture.scale":2,"label2.rotationMode":pm,"label2.light":!1,"label2.blend":Q,"label2.reverse.flip":!1,"label2.reverse.color":fk,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Tk,"note.t3":Q,"note.r3":Q,"note.texture.scale":2,"note.rotationMode":pm,"note.light":!1,"note.blend":Q,"note.reverse.flip":!1,"note.reverse.color":fk,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Tk,"note2.t3":Q,"note2.r3":Q,"note2.texture.scale":2,"note2.rotationMode":pm,"note2.light":!1,"note2.blend":Q,"note2.reverse.flip":!1,"note2.reverse.color":fk,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Q,"shape3d.color":Yc,"shape3d.top.color":Q,"shape3d.bottom.color":Q,"shape3d.from.color":Q,"shape3d.to.color":Q,"shape3d.image":Q,"shape3d.top.image":Q,"shape3d.bottom.image":Q,"shape3d.from.image":Q,"shape3d.to.image":Q,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Q,"shape3d.side.to":Q,"shape3d.smooth":Q,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Q,"shape3d.opacity":Q,"shape3d.reverse.flip":!1,"shape3d.reverse.color":fk,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Q,"shape3d.uv.scale":Q,"shape3d.top.uv.offset":Q,"shape3d.top.uv.scale":Q,"shape3d.bottom.uv.offset":Q,"shape3d.bottom.uv.scale":Q,"shape3d.from.uv.offset":Q,"shape3d.from.uv.scale":Q,"shape3d.to.uv.offset":Q,"shape3d.to.uv.scale":Q,"shape3d.top.cap":Q,"shape3d.bottom.cap":Q,"shape3d.start.angle":0,"shape3d.sweep.angle":E,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.clip":.003,"texture.mipmap.max":Q,"texture.filter":Q,"texture.filter.min":Q,"texture.filter.mag":Q,"all.light":!0,"all.visible":!0,"all.color":Yc,"all.image":Q,"all.blend":Q,"all.opacity":Q,"all.reverse.flip":!1,"all.reverse.color":fk,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Q,"all.uv.offset":Q,"all.uv.scale":Q,"all.discard.selectable":!0,mat:Q,"left.mat":Q,"right.mat":Q,"top.mat":Q,"bottom.mat":Q,"front.mat":Q,"back.mat":Q},!0);var Nl,sb=!1,Yq=[0,0,0,0],qk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Hd,2:Np,3:hq,4:Ce,5:Tk,6:Mn}},Zi=function(z,l,S,b){if(l.getFaceVisible(z,S)){var A=vh(z,l.getFaceMat(z,S)||l.getMat(z));z.appendAnchorMatrix3d(A),sf(l,A);var D=l._26I;l.getFaceReverseCull(z,S)?D.enable(D.CULL_FACE):D.disable(D.CULL_FACE),ac(D,l._prg.uFixPickReverseColor,qk[S]),vq(D),Hn(D,b,6),jl(D),bj(l)}},Nk=function(I){return I instanceof lh},kc=function(R){return[R.x,R.e||0,R.y]},wi=function(C,X,G){for(var X=An(X),L=X[0],k=X[1],b=X[2];G--;)C.push(L,k,b)},cd=function(j,o,S){for(var o=An(o),B=o[0],b=o[1],K=o[2],A=o[3];S--;)j.push(B,b,K,A)},pg=function(d,j,r){if(j)for(var c,q,$,o=j[0],x=j[1],O=j[2],E=j[4],C=j[5],R=j[6],i=j[8],p=j[9],Y=j[10],m=j[12],Q=j[13],b=j[14],S=r.length,A=0,A=0;S>A;A+=3)c=r[A],q=r[A+1],$=r[A+2],d.push(o*c+E*q+i*$+m,x*c+C*q+p*$+Q,O*c+R*q+Y*$+b);else Se(d,r)},Bc=function(z,N){var M=N.s("light.intensity"),I=An(N.s(dd)),r=I[0],R=I[1],G=I[2];1!==M&&(r*=M,R*=M,G*=M),z.push(r,R,G,N.s("light.disabled")?1:0)},tq=function(u,J,e){ac(J,e.uHeadlightRange,u._headlightRange),ac(J,e.uHeadlightAmbientIntensity,u._headlightAmbientIntensity);var b=u._headlightIntensity,d=An(u._headlightColor);1!==b&&(d=[d[0]*b,d[1]*b,d[2]*b]),ac(J,e.uHeadlightColor,[d[0],d[1],d[2],u._headlightDisabled?1:0]);var D=u._59O,y=u._spots,F=u._dirs;if(D.length){var v=[],j=[],M=[];D.forEach(function(J){Bc(v,J),Se(j,u._transformPointToViewSpace(J.p3())),M.push(J.s("light.range"))}),J.uniform4fv(e.uPointColor,v),J.uniform1fv(e.uPointRange,M),J.uniform3fv(e.uPointPosition,j)}if(y.length){var P=[],H=[],g=[],l=[],W=[],U=[];y.forEach(function(h){Bc(P,h),Se(H,u._transformPointToViewSpace(h.p3())),Se(W,u._transformDirectionToViewSpace(h.p3(),h.s("light.center"))),g.push(h.s("light.range")),l.push(x(h.s("light.angle")/2)),U.push(h.s("light.exponent"))}),J.uniform4fv(e.uSpotColor,P),J.uniform1fv(e.uSpotRange,g),J.uniform1fv(e.uSpotAngle,l),J.uniform1fv(e.uSpotExponent,U),J.uniform3fv(e.uSpotPosition,H),J.uniform3fv(e.uSpotDirection,W)}if(F.length){var $=[],f=[];F.forEach(function(m){Bc($,m),Se(f,u._transformDirectionToViewSpace(m.p3()))}),J.uniform4fv(e.uDirColor,$),J.uniform3fv(e.uDirDirection,f)}},vg=function(c){return Math.max(t.graph3dViewMinPhi+Qq,Math.min(t.graph3dViewMaxPhi-Qq,c))},Yh=function(){return.05+s()/2},Mm=function(M,u,b,P){var Z,g=M.getEye();return M.isOrtho()?(Z=Ti(M.getCenter(),g),Z[0]+=P[0],Z[1]+=P[1],Z[2]+=P[2]):Z=g,sl(u,b,P,Z)},sl=function(n,C,m,M){var B=nn(n,C),P=Ti(M,m,!0),y=nn(P,C);if(H(y)<Qq)return I;var h=(B-nn(m,C))/y;return[m[0]+P[0]*h,m[1]+P[1]*h,m[2]+P[2]*h]},ee=function(c,k){return{x:2*c.x-k.x,y:2*c.y-k.y}},jk=function(M,y,L,u){var D,U;if(!M)return D=$(y.y-L.y,L.x-y.x),{x:y.x+u*C(D),y:y.y+u*x(D)};if(!L)return D=$(M.y-y.y,y.x-M.x),{x:y.x+u*C(D),y:y.y+u*x(D)};var i=Ti([M.x,M.y,0],[y.x,y.y,0],!0),z=Ti([L.x,L.y,0],[y.x,y.y,0],!0),f=-(i[0]+z[0])/2,c=-(i[1]+z[1])/2,F=K(f*f+c*c);if(Qq>F)return D=$(M.y-y.y,y.x-M.x),{x:y.x+u*C(D),y:y.y+u*x(D)};var Y=M.x-y.x,r=M.y-y.y,g=L.x-y.x,m=L.y-y.y,p=K(Y*Y+r*r),W=K(g*g+m*m);D=w(nn(i,z))/2,U=i[1]*z[0]-i[0]*z[1]>0?-1:1,f/=F,c/=F;var n=u/C(D),b=P(p,W)/x(D);F=Math.min(n,b);var d={x:y.x+U*F*f,y:y.y+U*F*c};return L.b&&n>W/x(D)&&(d.adjust=!0),d},Fl=function(i){var j=i[1],m=i[2],y=i[3],M=i[6],s=i[7],Q=i[11];i[1]=i[4],i[2]=i[8],i[3]=i[12],i[4]=j,i[6]=i[9],i[7]=i[13],i[8]=m,i[9]=M,i[11]=i[14],i[12]=y,i[13]=s,i[14]=Q},Ve=function($){var L=$[0],P=$[1],w=$[2],Q=$[3],e=$[4],p=$[5],r=$[6],h=$[7],m=$[8],g=$[9],D=$[10],M=$[11],y=$[12],T=$[13],s=$[14],K=$[15],q=L*p-P*e,k=L*r-w*e,n=L*h-Q*e,F=P*r-w*p,a=P*h-Q*p,i=w*h-Q*r,v=m*T-g*y,b=m*s-D*y,V=m*K-M*y,t=g*s-D*T,l=g*K-M*T,C=D*K-M*s,f=q*C-k*l+n*t+F*V-a*b+i*v;return f?(f=1/f,$[0]=(p*C-r*l+h*t)*f,$[1]=(w*l-P*C-Q*t)*f,$[2]=(T*i-s*a+K*F)*f,$[3]=(D*a-g*i-M*F)*f,$[4]=(r*V-e*C-h*b)*f,$[5]=(L*C-w*V+Q*b)*f,$[6]=(s*n-y*i-K*k)*f,$[7]=(m*i-D*n+M*k)*f,$[8]=(e*l-p*V+h*v)*f,$[9]=(P*V-L*l-Q*v)*f,$[10]=(y*a-T*n+K*q)*f,$[11]=(g*n-m*a-M*q)*f,$[12]=(p*b-e*t-r*v)*f,$[13]=(L*t-P*b+w*v)*f,$[14]=(T*k-y*F-s*q)*f,$[15]=(m*F-g*k+D*q)*f,void 0):I},kl=function(c,M){if(M){var $=M[0],P=M[1],y=M[2];c[12]=c[0]*$+c[4]*P+c[8]*y+c[12],c[13]=c[1]*$+c[5]*P+c[9]*y+c[13],c[14]=c[2]*$+c[6]*P+c[10]*y+c[14],c[15]=c[3]*$+c[7]*P+c[11]*y+c[15]}},Ff=function(X,m){if(m){var i=m[0],t=m[1],f=m[2];X[0]=X[0]*i,X[1]=X[1]*i,X[2]=X[2]*i,X[3]=X[3]*i,X[4]=X[4]*t,X[5]=X[5]*t,X[6]=X[6]*t,X[7]=X[7]*t,X[8]=X[8]*f,X[9]=X[9]*f,X[10]=X[10]*f,X[11]=X[11]*f}},Xb=function(Y,s,G){var M=s[0],V=s[1],b=s[2],X=s[3],m=s[4],q=s[5],o=s[6],c=s[7],d=s[8],i=s[9],j=s[10],N=s[11],u=s[12],I=s[13],r=s[14],P=s[15],$=G[0],O=G[1],v=G[2],K=G[3];return Y[0]=$*M+O*m+v*d+K*u,Y[1]=$*V+O*q+v*i+K*I,Y[2]=$*b+O*o+v*j+K*r,Y[3]=$*X+O*c+v*N+K*P,$=G[4],O=G[5],v=G[6],K=G[7],Y[4]=$*M+O*m+v*d+K*u,Y[5]=$*V+O*q+v*i+K*I,Y[6]=$*b+O*o+v*j+K*r,Y[7]=$*X+O*c+v*N+K*P,$=G[8],O=G[9],v=G[10],K=G[11],Y[8]=$*M+O*m+v*d+K*u,Y[9]=$*V+O*q+v*i+K*I,Y[10]=$*b+O*o+v*j+K*r,Y[11]=$*X+O*c+v*N+K*P,$=G[12],O=G[13],v=G[14],K=G[15],Y[12]=$*M+O*m+v*d+K*u,Y[13]=$*V+O*q+v*i+K*I,Y[14]=$*b+O*o+v*j+K*r,Y[15]=$*X+O*c+v*N+K*P,Y},ri=function(m,z,Q,J){var M,$,b,O,c,n,Y,L,g,t,B=z[0],V=z[1],h=z[2],U=J[0],d=J[1],_=J[2],q=Q[0],o=Q[1],C=Q[2];return H(B-q)<Qq&&H(V-o)<Qq&&H(h-C)<Qq?rs(m):(Y=B-q,L=V-o,g=h-C,t=1/K(Y*Y+L*L+g*g),Y*=t,L*=t,g*=t,M=d*g-_*L,$=_*Y-U*g,b=U*L-d*Y,t=K(M*M+$*$+b*b),t?(t=1/t,M*=t,$*=t,b*=t):(M=0,$=0,b=0),O=L*b-g*$,c=g*M-Y*b,n=Y*$-L*M,t=K(O*O+c*c+n*n),t?(t=1/t,O*=t,c*=t,n*=t):(O=0,c=0,n=0),m[0]=M,m[1]=O,m[2]=Y,m[3]=0,m[4]=$,m[5]=c,m[6]=L,m[7]=0,m[8]=b,m[9]=n,m[10]=g,m[11]=0,m[12]=-(M*B+$*V+b*h),m[13]=-(O*B+c*V+n*h),m[14]=-(Y*B+L*V+g*h),m[15]=1,m)},Pj=function(u,d,T,z,M){var Q=1/_(d/2),q=1/(z-M);return u[0]=Q/T,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=Q,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=(M+z)*q,u[11]=-1,u[12]=0,u[13]=0,u[14]=2*M*z*q,u[15]=0,u},kk=function(C,X,H,s,x,N,i){var y=1/(X-H),r=1/(s-x),t=1/(N-i);return C[0]=-2*y,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*r,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*t,C[11]=0,C[12]=(X+H)*y,C[13]=(x+s)*r,C[14]=(i+N)*t,C[15]=1,C},bi=function(i,R){var C=R[0],P=R[1],U=R[2],G=R[3],Q=C*C+P*P+U*U+G*G,e=Q?1/Q:0;return i[0]=-C*e,i[1]=-P*e,i[2]=-U*e,i[3]=G*e,i},fm=function(n,R){var e=R[0]+R[5]+R[10],w=0;return e>0?(w=2*Math.sqrt(e+1),n[3]=.25*w,n[0]=(R[6]-R[9])/w,n[1]=(R[8]-R[2])/w,n[2]=(R[1]-R[4])/w):R[0]>R[5]&R[0]>R[10]?(w=2*Math.sqrt(1+R[0]-R[5]-R[10]),n[3]=(R[6]-R[9])/w,n[0]=.25*w,n[1]=(R[1]+R[4])/w,n[2]=(R[8]+R[2])/w):R[5]>R[10]?(w=2*Math.sqrt(1+R[5]-R[0]-R[10]),n[3]=(R[8]-R[2])/w,n[0]=(R[1]+R[4])/w,n[1]=.25*w,n[2]=(R[6]+R[9])/w):(w=2*Math.sqrt(1+R[10]-R[0]-R[5]),n[3]=(R[1]-R[4])/w,n[0]=(R[8]+R[2])/w,n[1]=(R[6]+R[9])/w,n[2]=.25*w),n},Aq=function(r,W,e){var d=W[0],n=W[1],c=W[2],b=W[3],B=d+d,i=n+n,P=c+c,M=d*B,U=d*i,g=d*P,_=n*i,N=n*P,I=c*P,m=b*B,Z=b*i,F=b*P;return r[0]=1-(_+I),r[1]=U+F,r[2]=g-Z,r[3]=0,r[4]=U-F,r[5]=1-(M+I),r[6]=N+m,r[7]=0,r[8]=g+Z,r[9]=N-m,r[10]=1-(M+_),r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},Gq=function(K,O){if(K.vr.enable){var w=K.vr.getViewMatrix(O);if(w)return w}return ri(O?O:Tf(),K._eye,K._center,K._up)},jb=function(d,j){if(d.vr.enable){var M=d.vr.getProjectMatrix();if(M)return M}if(!j&&d._computedProjectMatrix)return no(d._computedProjectMatrix);var o=d.getAspect(),P=d._near,w=d._far,F=Tf();if(d._ortho){var Q=d._orthoWidth/2,f=Q/o;kk(F,-Q,Q,-f,f,P,w)}else Pj(F,d._fovy,o,P,w);return F},tg=function(m,V){if(!m)return I;var j=0,s=1,F=2,X=[],z=0,w=m.length,l=w/3;if(V){for(;w>z;z++)X[z]=0;for(z=0;z<V.length;z+=3){var T=[],i=[],H=[];T[j]=m[3*V[z+1]+j]-m[3*V[z]+j],T[s]=m[3*V[z+1]+s]-m[3*V[z]+s],T[F]=m[3*V[z+1]+F]-m[3*V[z]+F],i[j]=m[3*V[z+2]+j]-m[3*V[z+1]+j],i[s]=m[3*V[z+2]+s]-m[3*V[z+1]+s],i[F]=m[3*V[z+2]+F]-m[3*V[z+1]+F],H[j]=T[s]*i[F]-T[F]*i[s],H[s]=T[F]*i[j]-T[j]*i[F],H[F]=T[j]*i[s]-T[s]*i[j];for(var W=0;3>W;W++)X[3*V[z+W]+j]+=H[j],X[3*V[z+W]+s]+=H[s],X[3*V[z+W]+F]+=H[F]}}else for(z=0;l>z;z+=3){var T=[],i=[],H=[];T[j]=m[3*(z+1)+j]-m[3*z+j],T[s]=m[3*(z+1)+s]-m[3*z+s],T[F]=m[3*(z+1)+F]-m[3*z+F],i[j]=m[3*(z+2)+j]-m[3*(z+1)+j],i[s]=m[3*(z+2)+s]-m[3*(z+1)+s],i[F]=m[3*(z+2)+F]-m[3*(z+1)+F],H[j]=T[s]*i[F]-T[F]*i[s],H[s]=T[F]*i[j]-T[j]*i[F],H[F]=T[j]*i[s]-T[s]*i[j];for(var W=0;3>W;W++)X[3*(z+W)+j]=H[j],X[3*(z+W)+s]=H[s],X[3*(z+W)+F]=H[F]}for(z=0;w>z;z+=3){var _=[];_[j]=X[z+j],_[s]=X[z+s],_[F]=X[z+F];var L=K(_[j]*_[j]+_[s]*_[s]+_[F]*_[F]);0===L&&(L=Qq),_[j]=_[j]/L,_[s]=_[s]/L,_[F]=_[F]/L,X[z+j]=_[j],X[z+s]=_[s],X[z+F]=_[F]}return new Ko(X)},Vj=function(L,m,i,J){if(i||(i=L.createTexture()),m){var D=L.TEXTURE_2D,V=L.REPEAT,l=L.CLAMP_TO_EDGE,H=L.TEXTURE_MIN_FILTER;J=J||Bp;var Y=J.minFilter||J.filter||L.LINEAR,O=J.magFilter||J.filter||L.LINEAR;Ej(L,i),L.texImage2D(D,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,m),Qp(L,L.TEXTURE_MAG_FILTER,O);var U=m.naturalWidth||m.width,G=m.naturalHeight||m.height;Qg.isPOT(U)&&Qg.isPOT(G)&&!m.clampToEdge?(Qp(L,L.TEXTURE_WRAP_S,V),Qp(L,L.TEXTURE_WRAP_T,V),Qp(L,H,Y===L.NEAREST?L.NEAREST_MIPMAP_NEAREST:L.LINEAR_MIPMAP_LINEAR),J.mipmapMaxLevel!==Q&&Qp(L,L.TEXTURE_MAX_LEVEL,J.mipmapMaxLevel),L.generateMipmap(D)):(Qp(L,L.TEXTURE_WRAP_S,l),Qp(L,L.TEXTURE_WRAP_T,l),Qp(L,H,Y)),Ej(L,I)}return i},Wb=function(M,r){var J=new Uint8Array(4);return r=r||M.createTexture(),Ej(M,r),Qp(M,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,J),r},Bf=function(K){K._26I&&K._prg&&(K._26I.deleteProgram(K._prg),K._prg=I)},Ro=function(Z,F,T,V){var b=Z.createShader(T);return Z.shaderSource(b,V),Z.compileShader(b),Z.attachShader(F,b),b},zd=function(b){return b.createBuffer()},Ej=function(h,Z){h.bindTexture(h.TEXTURE_2D,Z)},Qp=function(h,y,j){h.texParameteri(h.TEXTURE_2D,y,j)},we=function(L,K){L.enable(L.POLYGON_OFFSET_FILL),L.polygonOffset(K[0],K[1])},Sp=function(W){W.disable(W.POLYGON_OFFSET_FILL)
},md=function(A,v){if(v){var v=An(v);A.clearColor(v[0],v[1],v[2],v[3])}},zl=function(z,k){ac(z,k.uFix,!0),Fo(z,k.aNormal)},ml=function(r,q){ac(r,q.uFix,!1),mc(r,q.aNormal)},jf=function(l,E,R,U,D,H,S,q){l._picking||(R?(ac(l,E.uBlend,!0),ac(l,E.uBlendColor,R)):ac(l,E.uBlend,!1),ac(l,E.uLight,U==I?!0:U),mm(D)&&1!==D&&ac(l,E.uPartOpacity,D),ac(l,E.uReverseFlip,H==I?!1:H),ac(l,E.uFixPickReverseColor,S||fk)),q?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE)},or=function(C,q){C._picking||ac(C,q.uPartOpacity,1)},vq=function(){var B=[0,0,1,1];return function(v,P,C,N,X,h,I,c,S){return C?(ac(v,P.uTexture,!0),ac(v,P.uDiscardSelectable,gj(N)?N:!0),mc(v,P.aUv),ap(v,X,h,P.aUv,2),S?(ac(v,P.uBlendTexture,!0),v.activeTexture(v.TEXTURE1),Ej(v,S),v.uniform1i(P.uBlendSampler,1)):(ac(v,P.uBlendTexture,!1),v.activeTexture(v.TEXTURE1),Ej(v,v._emptyBlendTexture)),v.activeTexture(v.TEXTURE0),Ej(v,C),v.uniform1i(P.uSampler,0),I?(B[0]=I[0],B[1]=I[1]):(B[0]=0,B[1]=0),c?(B[2]=c[0],B[3]=c[1]):(B[2]=1,B[3]=1),ac(v,P.uOffsetScale,B),void 0):(v.activeTexture(v.TEXTURE0),Ej(v,v._emptyTexture),v.activeTexture(v.TEXTURE1),Ej(v,v._emptyBlendTexture),void 0)}}(),jl=function(u,y,$){u.activeTexture(u.TEXTURE0),Ej(u,I),u.activeTexture(u.TEXTURE1),Ej(u,I),$&&(Fo(u,y.aUv),ac(u,y.uTexture,!1),ac(u,y.uBlendTexture,!1))},So=function(E,t,N,d,C,V){!N||kf||Km||E.lineWidth(N),d&&!E._picking&&ac(E,t.uFixPickReverseColor,d),C&&ap(E,C,V,t.aPosition)},ke=function(W,l,P,u){Nl&&(u=W[Nl]),W.drawArrays(u==I?W.TRIANGLES:u,l,P);var j=W._renderInfo;j&&(j.calls++,j.vertices+=P,(u==I||u===W.TRIANGLES)&&(j.faces+=P/3),u===W.LINES&&(j.lines+=P/2))},Hn=function(O,c,s,W){Nl&&(W=O[Nl]),O.drawElements(W==I?O.TRIANGLES:W,s,O.UNSIGNED_SHORT,c==I?0:2*c);var g=O._renderInfo;g&&(g.calls++,g.vertices+=s,(W==I||W===O.TRIANGLES)&&(g.faces+=s/3),W===O.LINES&&(g.lines+=s/2))},dh=function(F,w,g,P,l){var M=F.ARRAY_BUFFER;F.bindBuffer(M,w),g&&F.bufferData(M,g,F.STATIC_DRAW),P!=I&&F.vertexAttribPointer(P,l?l:3,F.FLOAT,!1,0,0)},ap=function(E,M,F,T,l){return F?(Tq(E,E.ARRAY_BUFFER,M,F),T!=I&&E.vertexAttribPointer(T,l?l:3,E.FLOAT,!1,0,0),void 0):dh(E,M,F,T,l)},Zn=function(O,S,M){var A=O.ELEMENT_ARRAY_BUFFER;O.bindBuffer(A,S),M&&O.bufferData(A,M,O.STATIC_DRAW)},Qe=function(y,P,b){Tq(y,y.ELEMENT_ARRAY_BUFFER,P,b)},Tq=function(W,V,U,Z){var Q=Z._bufId;Q||(Q=Z._bufId=v.Math.generateIncreasingID());var U,d=W._bufPool;(U=d[Q])&&U._buf?W.bindBuffer(V,U._buf):(U=d[Q]={_buf:zd(W)},W.bindBuffer(V,U._buf),W.bufferData(V,Z,W.STATIC_DRAW)),U._fid=W._renderInfo.frame},ac=function(O,e,S){if(S!=I&&e!=I){S=An(S);var Q=S.length;3===Q?O.uniform3fv(e,S):4===Q?O.uniform4fv(e,S):16===Q?O.uniformMatrix4fv(e,!1,S):gj(S)?O.uniform1i(e,S?1:0):2===Q?O.uniform2fv(e,S):O.uniform1f(e,S)}},mc=function(d,c){c!=I&&c>=0&&d.enableVertexAttribArray(c)},Fo=function(J,f){f!=I&&f>=0&&J.disableVertexAttribArray(f)},bj=function(L,W){var Y=L.getGL(),U=L._prg;L._7O=L._8O.pop(),W&&(ac(Y,U.uMVMatrix,L._7O),L._6O=W,ac(Y,U.uNMatrix,W))},ye=function(S,A){return A||(A=Tf()),Er(A,S),Ve(A),Fl(A),A},sf=function(H,g){var F=H.getGL(),p=H._prg,e=H._7O;g&&(H._8O.push(no(e)),ac(F,p.uMMatrix,g),Xb(e,e,g),H._7O=e),ac(F,p.uMVMatrix,e),ac(F,p.uNMatrix,ye(e,H._6O))},ud=function(l,O,z,x,N,j){if(z){if(x){var K=z.value++,U=2147483648|K,s=[(255&U>>16)/255,(255&U>>8)/255,(255&U)/255,(255&U>>24)/255];z[K]={data:N,part:j}}else s=Yq;return ac(l,O.uFixPickReverseColor,s),s}},zf=function(d,F,a){"target"!==a&&(a="source");var A="target"===a?F.getTargetAgent():F.getSourceAgent(),x="edge."+a+".";if(Fg(A)){var f=F.s(x+"anchor.x"),k=F.s(x+"anchor.elevation"),i=F.s(x+"anchor.y"),M=vh(A,d.getMat(A)),t=A.getAnchor3d();return Tl([(f===Q?.5:f)-t.x,(k===Q?.5:k)-t.y,(i===Q?.5:i)-t.z],M)}var s=F.s(x+"index"),N=d.getData3dUI(A);if(!N.info||!N.info.list)return!1;if(s>=0){var y,m,e,J,P,U=N.info._lastPointsSegments,X=U.points,G=U.segments,n=-1,I=-1;for(e=0,J=G?G.length:X.length;J>e;e++){if(m=G?G.get(e):1,3===m)P=2;else if(4===m)P=3;else{if(5===m)continue;P=1}if(n+=P,I++,I===s){y=X.get(n);break}}return y||(y=X.get(X.length-1)),[y.x,y.e||0,y.y]}var Y=F.s(x+"percent")||.5;if(Y=Math.max(0,Math.min(Y,1)),!N||!N.getCache)return!1;var b=N.getCache(),J=b[b.length-1].length,U=d.getLineOffset(A,Y*J),D=U.point;return[D.x,D.y,D.z]},ei=function(){var k={center:function(I,i,G,a,d){var O=-i[1]/2,k={x:-i[0]/2,y:O,width:i[0],height:i[1]},l=Ke(I,k,G);return[l.x+a,-l.y-d,Yh()]},front:function(T,N,D,i,z){var V=-N[1]/2,r={x:-N[0]/2,y:V,width:N[0],height:N[1]},J=Ke(T,r,D);return[J.x+i,-J.y-z,N[2]/2+Yh()]},back:function(Y,c,u,E,U){var Q=-c[0]/2,f=-c[1]/2,S={x:Q,y:f,width:c[0],height:c[1]},s=Ke(Y,S,u);return[-s.x-E,-s.y-U,-c[2]/2-Yh()]},left:function(p,z,V,D,g){var o=-z[1]/2,w={x:-z[2]/2,y:o,width:z[2],height:z[1]},$=Ke(p,w,V);return[-z[0]/2-Yh(),-$.y-g,$.x+D]},right:function(M,G,Y,P,s){var g=-G[2]/2,E=-G[1]/2,A={x:g,y:E,width:G[2],height:G[1]},$=Ke(M,A,Y);return[G[0]/2+Yh(),-$.y-s,-$.x-P]},top:function(s,n,q,e,S){var P={x:-n[0]/2,y:-n[2]/2,width:n[0],height:n[2]},m=Ke(s,P,q);return[m.x+e,n[1]/2+Yh(),m.y+S]},bottom:function(d,M,A,W,P){var x=-M[2]/2,s={x:-M[0]/2,y:x,width:M[0],height:M[2]},C=Ke(d,s,A);return[C.x+W,-M[1]/2-Yh(),-C.y-P]}};return function(G,L,I,b,g,o){return k[b](G,L,I,g||0,o||0)}}(),on=function(i,D,P,T,u,l,z,y,K,n){if(u&&(D[0]+=u[0],D[1]+=u[1],D[2]+=u[2]),kl(i,P),y){var M=Tf();if(Dn(M,K,n),Tl(D,M),kl(i,D),i.auto=y,i.pos=Tl([0,0,0],i),l){var G=i.mat2=Tf();Dn(G,l,z)}}else Dn(i,K,n),kl(i,D),T===Hd?Rb(i,-b):T===Np?Rb(i,b):T===hq?os(i,-b):T===Ce?os(i,b):T===Mn&&Rb(i,k),Dn(i,l,z);return i},Qj=function(u,e){var g=e.auto,p=e.mat2,O=u.gv;if(g){var K,R=Tf(),f=[0,0,0,0];K="string"==typeof g?[g.indexOf("x")<0?O._eye[0]:O._center[0],g.indexOf("y")<0?O._eye[1]:O._center[1],g.indexOf("z")<0?O._eye[2]:O._center[2]]:O._eye,fm(f,ri(Tf(),K,O._center,O._up)),Aq(R,bi(f,f),e.pos),p&&Xb(R,R,p),sf(O,R)}else sf(O,e)},Hc=function(k,g,H,p,d){var v=k.s,O=k.gv,E=O.getGL(),K=O._prg,j=O._buffer,P=O._1O;Vj(E,sm,P),Qj(k,H),jf(E,K,v(g+".blend"),v(g+".light"),v(g+".opacity"),v(g+".reverse.flip"),v(g+".reverse.color"),v(g+".reverse.cull")),vq(E,K,P,d,j.uv,Af),ap(E,j.vs,p,K.aPosition),ap(E,j.ns,$m,K.aNormal),Qe(E,j.is,oi),Hn(E,0,oi.length),jl(E,K,P),or(E,K),bj(O)},cn=function(_,b,s){var f=_.gv,B=_.data,L=_[b]={blend:f.getBodyColor(B)||f.getFaceBlend(B,b),light:f.getFaceLight(B,b),color:f.getFaceColor(B,b),opacity:f.getFaceOpacity(B,b),transparent:f.getFaceTransparent(B,b),reverseFlip:f.getFaceReverseFlip(B,b),reverseColor:f.getFaceReverseColor(B,b),reverseCull:f.getFaceReverseCull(B,b),texture:f.getFaceImage(B,b),blendTexture:f.getFaceBlendImage(B,b),discardSelectable:f.getFaceDiscardSelectable(B,b)};if("csg"!==b){L.uv=f.getFaceUv(B,b)||s&&s[b+"Uv"],L.uvScale=f.getFaceUvScale(B,b)||s&&s[b+"UvScale"],L.uvOffset=f.getFaceUvOffset(B,b)||s&&s[b+"UvOffset"];var z=f.getFaceMat(B,b);if(z){var h=vh(B,z);B.appendAnchorMatrix3d(h),L.mat=h}}return L},Sd=function($,O,F,v,e){var H=$[v];if(H){if(!e(H.transparent))return;var X=$.data,t=$.gv,K=t._buffer,J=t.getTexture(H.texture,X,v),S=t.getTexture(H.blendTexture,X);vq(O,F,J,H.discardSelectable,K.uv,H.tuv,H.uvOffset,H.uvScale,S),jf(O,F,H.blend,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),ac(O,F.uDiffuse,H.color||q["color.empty"]),ap(O,K.vs,H.vs,F.aPosition),ap(O,K.ns,H.ns,F.aNormal),ke(O,0,H.vs.length/3),or(O,F),jl(O,F,J)}},Lg=function(L,V,E,H,X,G){var O,g,$,U,N,l,S,I,r,C,n,z=[H-V,X-E],B=L?L.length:0;for($=0;B>$;$++){for(U=2,O=L[$],N=O[0],l=O[1];U+1<O.length;){if(S=O[U],I=O[U+1],g=Lr(V,E,H,X,N,l,S,I,!0)){r=[S-N,I-l],C=Oj(r),r[0]/=C,r[1]/=C,C=nn(z,r),C=C>0?G:-G,n=[r[0]*C,r[1]*C];break}N=S,l=I,U+=2}if(n)break}if(n)for(H=V+n[0],X=E+n[1],$=0;B>$;$++)for(U=2,O=L[$],N=O[0],l=O[1];U+1<O.length;){if(S=O[U],I=O[U+1],g=Lr(V,E,H,X,N,l,S,I,!0))return[0,0];N=S,l=I,U+=2}return n?n:[H-V,X-E]},Pm=v.graph3d={},Ne=function(V,g,l){Rq(Z+".graph3d."+V,g,l)},rf="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ep="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Fd(t,{setBatchInfo:function(y,K){oo[y]=K},getBatchInfo:function(Q){return oo[Q]}},!0);var Kp=[1,1,1],uk=[1,0,0,0,0,1,0,1,1,1,1,0],wm=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Jr=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Ql=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Bq=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Uc=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],rk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],dr=function(I,O){jj(I,O,"_batchModelMap","_batchIndexMap"),Lb(I,O,"_wireframeModelMap","_wireframeIndexMap"),Lb(I,O,"_polylineModelMap","_polylineIndexMap"),Lb(I,O,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Lb(I,O,"_polylineModelMapSwap","_polylineIndexMapSwap")},jj=function(T,k,V,h){if(!k)return T[V]={},T[h]={},void 0;var e=k._id,_=T[h],p=_[e];if(p){var g=T[V],m=p.batch,B=g[m],O=B.ds,G=p.index;if(B.invalidate=!0,delete _[e],O.splice(G,1),rl(O))return delete g[m],void 0;for(var K=p.begin,Y=p.size,P=3*K,f=3*Y,d=4*K,w=4*Y,n=B.vs,l=B.ps,C=B.uv,F=B.cs,D=B.bs,o=B.rs,t=B.ns,M=B.ls;G<O.length;G++)p=_[O[G]._id],p.index--,p.begin-=Y;n.splice(P,f),l.splice(d,w),C&&C.splice(2*K,2*Y),F&&F.splice(d,w),D&&D.splice(P,f),o&&o.splice(K,Y),t&&t.splice(P,f),M&&M.splice(K,Y)}},Lb=jj,gl=function(U,E,C,n){if(!n)return I;var R=E[n];if(!R){var h=oo[n]||Bp,p=h.image?[]:I;R=E[n]={vs:[],ns:[],uv:p,cs:p?I:h.color?I:[],bs:h.blend?[]:I,ps:[],rs:h.brightness?[]:I,ds:[]}}return R.invalidate=!0,U[C._id]={index:R.ds.length,begin:R.vs.length/3,batch:n},R.ds.push(C),R},xc=function(P,f){return f!=I&&1!==f?[P[0]*f,P[1]*f,P[2]*f,P[3]]:P},ii=function(){var u;return function(p,i,f){var C=p.getData3dUI(i),V=C.shapeModel;V||(V=zb(C));var e,S=i.s("wf.combineTriangle");if(f.geometry){if(!V&&(i instanceof v.Node&&!(i instanceof v.Shape)?(u||(u={vs:ob,is:gk,uv:Eh}),V=u):V=[C.left,C.front,C.right,C.back,C.top,C.bottom],!V))return Q;if(S?(S=0|Math.min(3,Math.max(1,isNaN(S)?1:S)),e=ul[S-1](V)):e=Uo(V),!e||0===e.length)return}else e=f.short?kq:ah;var P=p.getBrightness(i),y=An(f.color||"white"),t=y[3]<1,Y=Math.ceil(f.width)||1,M=(t?"T":"O")+Y,X=p._wireframeIndexMap,r=p._wireframeModelMap,E=r[M];E||(E=r[M]={vs:[],cs:[],ps:[],ds:[],T:t,W:Y}),E.invalidate=!0;var l=E.vs,A=E.cs,s=E.ds,W=X[i._id]={index:s.length,begin:l.length/3,batch:M};s.push(i);var N=C.mat;(!N&&!i instanceof v.Edge||!f.geometry&&i instanceof v.Shape)&&(N=vh(i,f.mat),i.appendAnchorMatrix3d(N)),pg(l,N,e);var w=W.size=l.length/3-W.begin;cd(A,xc(y,P),w)}}(),kj=function(k,C,H,j,n,S,F,X,r){var y=k.getBrightness(C);y==I&&(y=1);var p=xc(An(j),y),Y=p[3]<1;S=Math.ceil(S)||1;var e=(Y?"T":"O")+S;if(F){var Q=F[0],D=(F[1]||Q)+Q;e+="-"+Q+"-"+D,r&&(e+="-"+Up(r)+"-"+y,r=xc(An(r),y))}var U=k._polylineIndexMap,o=k._polylineModelMap,T=o[e];T||(T=o[e]={vs:[],cs:[],ps:[],ds:[],ls:F?[]:I,T:Y,W:S},F&&(T.D=Q,T.G=D,T.A=r)),T.invalidate=!0;var W,m=T.vs,_=T.cs,z=T.ds,s=T.ls,b=U[C._id]={index:z.length,begin:m.length/3,batch:e};z.push(C),Se(m,H);var M,A=b.size=m.length/3-b.begin,q=H.length,d=0,R=[];if(F||n)for(W=0;q>W;W+=6)M=Oj([H[W],H[W+1],H[W+2]],[H[W+3],H[W+4],H[W+5]]),R.push(M),d+=M;if(d&&n){var h,L=xc(An(n),y),N=[L[0]-p[0],L[1]-p[1],L[2]-p[2],L[3]-p[3]],x=0;for(W=0;q>W;W+=6)h=x/d,cd(_,[p[0]+N[0]*h,p[1]+N[1]*h,p[2]+N[2]*h,p[3]+N[3]*h],1),x+=R[W/6],h=x/d,cd(_,[p[0]+N[0]*h,p[1]+N[1]*h,p[2]+N[2]*h,p[3]+N[3]*h],1)}else cd(_,p,A);if(F)for(x=X||0,W=0;q>W;W+=6)s.push(x),x+=R[W/6],s.push(x)},hk=function(o,H,J){if(H)for(var E=4*H.begin,h=J[H.batch].ps,R=0;R<H.size;R++)h[E++]=o[0],h[E++]=o[1],h[E++]=o[2],h[E++]=o[3]},Pp=function(x,_){var C=_+["32"],V=x[_],$=x[C];V?$&&$.length===V.length?($.set(V),$._bufId=null):x[C]=new Ko(V):delete x[C]},Gm=function(s,z,B,Y,r,u,i,h,y){if(Ad(B))B.forEach(function(x){Gm(s,z,x,Y,r,u,i,h,y)});else if(fh(B))Gm(s,z,zb(Y,B),Y,r,u,i,h,y);else if(nd(B)){var x,G=Nq(B.mat,z,s),H=Nq(B.s3,z,s),f=Nq(B.t3,z,s),C=Nq(B.r3,z,s);if((H||C||f||G)&&(x=ph(G,H,C,Nq(B.rotationMode,z,s),f),u.push(x)),B.shape3d)Gm(s,z,B.shape3d,Y,r,u,i,h,B);else{var a=Y.s;y=y||Bp;var j=u[0],K=u.length,L=a("shape3d.color",B.color,y.color);if(r||(r=a("shape3d.blend",B.blend,y.blend)),K>1){j=no(j);for(var g=1;K>g;g++)Xb(j,j,u[g])}B.vs&&a(ij,B.visible,y.visible)&&Zb(j,i,h,B.vs,B.uv,B.is,r,L),B.top_vs&&a(Mp,B.topVisible,y.topVisible)&&Zb(j,i,h,B.top_vs,B.top_uv,B.top_is,r,a("shape3d.top.color",B.topColor,y.topColor)||L),B.bottom_vs&&a(sr,B.bottomVisible,y.bottomVisible)&&Zb(j,i,h,B.bottom_vs,B.bottom_uv,B.bottom_is,r,a("shape3d.bottom.color",B.bottomColor,y.bottomColor)||L),B.from_vs&&a(ss,B.fromVisible,y.fromVisible)&&Zb(j,i,h,B.from_vs,B.from_uv,B.from_is,r,a("shape3d.from.color",B.fromColor,y.fromColor)||L),B.to_vs&&a(zg,B.toVisible,y.toVisible)&&Zb(j,i,h,B.to_vs,B.to_uv,B.to_is,r,a("shape3d.to.color",B.toColor,y.toColor)||L)}x&&u.pop()}},Zb=function(T,r,v,Y,H,I,o,e){var R,V=r.cs,Q=r.uv,a=r.bs;if(I){R=I.length;for(var $=0;R>$;$++){var c=I[$];pg(v,T,[Y[3*c],Y[3*c+1],Y[3*c+2]]),Q&&Se(Q,[H[2*c],H[2*c+1]])}}else R=Y.length/3,pg(v,T,Y),Q&&Se(Q,H);V&&cd(V,e,R),a&&(o?wi(a,o,R):Se(a,Kp,R))},Jf=function(P,J,Q,V){var a=[];V?Gm(P.gv,P.data,V,P,P.getBodyColor(),[J],Q,a):(dg(P,Hd,J,Q,a),dg(P,Np,J,Q,a),dg(P,Tk,J,Q,a),dg(P,Mn,J,Q,a),dg(P,hq,J,Q,a),dg(P,Ce,J,Q,a),dg(P,"csg",J,Q,a)),a.length&&(Se(Q.vs,a),Se(Q.ns,tg(a)))},dg=function(V,t,F,e,S){var c=V[t];if(c){var C=c.tuv;if(C){var z,T,N,v,f=c.uvScale,x=c.uvOffset;if(f)for(z=C.length,T=f[0],N=f[1],v=0;z>v;v+=2)C[v]*=T,C[v+1]*=N;if(x)for(z=C.length,T=x[0],N=x[1],v=0;z>v;v+=2)C[v]+=T,C[v+1]+=N}Zb(F,e,S,c.vs,C,I,c.blend,c.color)}},Wm=function(t,e,_,d,h,O,i,c){var r,L=_.cs,T=_.uv,Y=_.bs;if(t.getFaceVisible(e,O)){var B=t.getFaceMat(e,O);if(B&&(h=vh(e,B)),pg(i,h,c),L&&cd(L,t.getFaceColor(e,O),6),T){var l=t.getFaceUv(e,O)||d[O+"Uv"],H=t.getFaceUvScale(e,O)||d[O+"UvScale"],g=t.getFaceUvOffset(e,O)||d[O+"UvOffset"];l=l?[l[6],l[7],l[0],l[1],l[2],l[3],l[2],l[3],l[4],l[5],l[6],l[7]]:uk;var j=l[0],P=l[1],b=l[2],m=l[3],s=l[4],A=l[5],G=l[6],k=l[7],x=l[8],v=l[9],n=l[10],Q=l[11];if(H){var I=H[0],V=H[1];j*=I,P*=V,b*=I,m*=V,s*=I,A*=V,G*=I,k*=V,x*=I,v*=V,n*=I,Q*=V}if(g){var y=g[0],M=g[1];j+=y,P+=M,b+=y,m+=M,s+=y,A+=M,G+=y,k+=M,x+=y,v+=M,n+=y,Q+=M}T.push(j,P,b,m,s,A,G,k,x,v,n,Q)}Y&&(r=t.getBodyColor(e)||t.getFaceBlend(e,O),r?wi(Y,r,6):Se(Y,Kp,6))}},ge=function(r,S,X,e){var m=r.getGL(),x=r._prg,j=r._buffer;if(!r.drawFilter&&!Gi(S)){sf(r),zl(m,x);for(var W in S){var i=S[W];if(!(e&&!i.T||!e&&i.T)){i.invalidate?(i.invalidate=!1,Pp(i,"vs"),Pp(i,"cs"),Pp(i,"ls"),Pp(i,"ps")):X&&Pp(i,"ps");var t=i.vs32,l=X?i.ps32:i.cs32;So(m,x,i.W,I,j.vs,t);var a=i.D,A=!r._dashDisabled&&a;ac(m,x.uAlphaTest,q.alphaTest),A&&(ac(m,x.uDash,!0),ac(m,x.uDashDistance,a),ac(m,x.uDashGapDistance,i.G),mc(m,x.aLineDistance),ap(m,j.lineDistance,i.ls32,x.aLineDistance,1),ac(m,x.uDiffuse,i.A||q["color.empty"]));var c=!r._batchColorDisabled;c&&(ac(m,x.uBatchColor,!0),mc(m,x.aBatchColor),ap(m,j.batchColor,l,x.aBatchColor,4)),vq(m),ke(m,0,t.length/3,m.LINES),jl(m),c&&(ac(m,x.uBatchColor,!1),Fo(m,x.aBatchColor)),A&&(ac(m,x.uDash,!1),Fo(m,x.aLineDistance))}}ml(m,x)}},Ek=function(E,K,h){var d,W,T,G,N,l,t,O,A,X,U,z=E.getGL(),w=E._prg,g=E._buffer,p=E._batchModelMap;if(!Gi(p)&&!E.drawFilter){sf(E);for(d in p)if(W=oo[d]||Bp,!(h&&!W.transparent||!h&&W.transparent)&&(T=p[d],K||!W.transparentMask)){var e=h&&W.autoSort!==!1&&(E._33Q||T.invalidate);if(T.invalidate?(T.invalidate=!1,Pp(T,"vs"),Pp(T,"ns"),Pp(T,"cs"),Pp(T,"rs"),Pp(T,"ps"),Pp(T,"bs"),Pp(T,"uv")):K&&Pp(T,"ps"),N=T.vs32,l=K?T.ps32:T.cs32,A=T.uv32,t=T.bs32,O=T.rs32,U=N.length/3,e&&(T.is=Ri(N,E.getEye())),U){G=W.light,X=E.getTexture(W.image),jf(z,w,I,W.light,W.opacity,W.reverseFlip,W.reverseColor,W.reverseCull),l?E._batchColorDisabled||(ac(z,w.uBatchColor,!0),mc(z,w.aBatchColor),ap(z,g.batchColor,l,w.aBatchColor,4)):ac(z,w.uDiffuse,W.color||q["color.empty"]);var $=W.alphaTest;ac(z,w.uAlphaTest,$===Q?q.alphaTest:$),W.envmap!==Q?(ac(z,w.uUseEnvMap,!0),ac(z,w.uReflectivity,W.envmap)):(ac(z,w.uUseEnvMap,!1),ac(z,w.uReflectivity,0));var v=t&&!E._batchBlendDisabled;v&&(ac(z,w.uBatchBlend,!0),mc(z,w.aBatchBlend),ap(z,g.batchBlend,t,w.aBatchBlend));var P=O&&!E._batchBrightnessDisabled;P&&(ac(z,w.uBatchBrightness,!0),mc(z,w.aBatchBrightness),ap(z,g.batchBrightness,O,w.aBatchBrightness,1)),A?vq(z,w,X,W.discardSelectable,g.uv,A,W.uvOffset,W.uvScale):vq(z),ap(z,g.vs,N,w.aPosition),ap(z,g.ns,T.ns32,w.aNormal),T.is?(Zn(z,g.is,T.is),Hn(z,0,U)):ke(z,0,U),A?jl(z,w,X):jl(z),l&&!E._batchColorDisabled&&(ac(z,w.uBatchColor,!1),Fo(z,w.aBatchColor)),v&&(ac(z,w.uBatchBlend,!1),Fo(z,w.aBatchBlend)),P&&(ac(z,w.uBatchBrightness,!1),Fo(z,w.aBatchBrightness)),or(z,w)}}}},Ri=function(D,q){for(var J=D.length/3,_=new Array(J),T=J/3,c=new Array(T),h=0;T>h;h++)c[h]=h;c.sort(function(k,t){var x=9*k,g=[(D[x]+D[x+3]+2*D[x+6])/4,(D[x+1]+D[x+4]+2*D[x+7])/4,(D[x+2]+D[x+5]+2*D[x+8])/4];x=9*t;var z=[(D[x]+D[x+3]+2*D[x+6])/4,(D[x+1]+D[x+4]+2*D[x+7])/4,(D[x+2]+D[x+5]+2*D[x+8])/4],K=Oj(q,g)-Oj(q,z);return K>0?-1:0>K?1:0});for(var h=0;T>h;h++){var $=3*h,G=3*c[h];_[$]=G,_[$+1]=G+1,_[$+2]=G+2}return new oh(_)},qj={obj:function(J,j){var y={mat:J.mat,s3:J.s3,r3:J.r3,rotationMode:J.rotationMode,t3:J.t3,cube:J.cube==I?!0:J.cube,center:J.center==I?!0:J.center,ignoreMtls:J.ignoreMtls,ignoreTransparent:J.ignoreTransparent,ignoreColor:J.ignoreColor,ignoreImage:J.ignoreImage,ignoreNormal:J.ignoreNormal,prefix:J.prefix,flipY:J.flipY,flipFace:J.flipFace,reverseFlipMtls:J.reverseFlipMtls,finishFunc:function(W,n){if(W){var n=[];for(var Q in W){var P=W[Q];n.rawS3=P.rawS3,n.push(P),J.eachModel&&J.eachModel(Q,P)}n.json=J,j(n)}else j()}};t.loadObj(J.obj,J.mtl,y)}};t.getModelTypeHandlers=function(){return qj},t.setModelTypeHandler=function(L,C){qj[L]=C},t.getModelTypeHandler=function(A){return qj[A]},t.handleModelLoaded=function(){},t.handleUnfoundModel=function(){};var Am=I,_p=I,kd=function(B){Am&&!B._loadingModelView_&&(_p||(_p={}),_p[B._loadingModelView_=um()]=B)},Pn=function(W,N){Am||(Am={});var F=Am[W];if(F){if(F.url===N)return;F.request.onload=rm,F.request.onerror=rm}var A=new Mc;if(Am[W]={request:A,url:N},N=t.beforeLoadURL(N),N.data){var c=t.parse(N.data);Xf(W,c,N)}else{A.onload=function(){if(200===this.status||0===this.status){delete Am[W];var G=t.parse(A.getResponseText());Xf(W,G,N)}else Jb(W,t.handleUnfoundModel(W,N)||I)},A.onerror=function(){Jb(W,t.handleUnfoundModel(W,N)||I)};var r={};r.url=encodeURI(N),r.sync=!1,A.send(r)}},Xf=function(f,z,A){var k=z.modelType;if(!k)return Jb(f,z),t.handleModelLoaded(f,z),void 0;var g=t.getModelTypeHandler(k);if(g){if(Am||(Am={}),Am[f])return;Am[f]=!0;var u=function(L){L?(Jb(f,L),t.handleModelLoaded(f,L)):Jb(f,t.handleUnfoundModel(f,A)||I)};g(z,u)}else Jb(f,t.handleUnfoundModel(f,A)||I)},Jb=function(Y,E){if(Qr[Y]=E,delete Am[Y],Gi(Am)&&(Am=I,_p)){for(var z in _p){var X=_p[z];X.invalidateAll&&X.invalidateAll(Q,"modelLoaded",Y),X.redraw&&X.redraw(),X.iv(),delete X._loadingModelView_}_p=I}if(E&&_p)for(var z in _p){var X=_p[z];X.invalidateAll&&X.invalidateAll(Q,"modelLoading",Y),X.redraw&&X.redraw(),X.iv()}},Af=new Ko([0,0,0,1,1,1,1,0]),$m=new Ko([0,0,1,0,0,1,0,0,1,0,0,1]),oi=new oh([0,1,2,2,3,0]),ob=new Ko([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),gk=new oh([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Eh=new Ko([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Kb=tg(ob,gk),Ph=(new Ko([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new oh([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Hd,Tk,Np,Mn,hq,Ce]),ah=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],kq=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],bb=function(G,F,e,D,O,f,M){f=f||16,G=G||16,F=F||0,e=e||G;var a,P,v,S,W,y,o,T,m,Q=.5,Z=[],q=[],c=E/G,U=k/f;for(a=0;f>a;a++)for(y=a+1,S=a*U,m=y*U,P=F;e>P;P++)o=P+1,v=P*c,T=o*c,Z.push(Q*C(S)*x(v),Q*x(S),-Q*C(S)*C(v),Q*C(m)*x(T),Q*x(m),-Q*C(m)*C(T),Q*C(S)*x(T),Q*x(S),-Q*C(S)*C(T),Q*C(S)*x(v),Q*x(S),-Q*C(S)*C(v),Q*C(m)*x(v),Q*x(m),-Q*C(m)*C(v),Q*C(m)*x(T),Q*x(m),-Q*C(m)*C(T)),q.push(P/G,a/f,o/G,y/f,o/G,a/f,P/G,a/f,P/G,y/f,o/G,y/f);if(M){var V=[];for(a=0,W=Z.length;W>a;a+=3)V.push(2*Z[a],2*Z[a+1],2*Z[a+2])}if(D){var j=[],R=[];for(v=F*c,a=0;f>a;a++)y=a+1,S=a*U,m=y*U,j.push(0,0,0,Q*C(m)*x(v),Q*x(m),-Q*C(m)*C(v),Q*C(S)*x(v),Q*x(S),-Q*C(S)*C(v)),R.push(0,.5,F/G,y/f,F/G,a/f)}if(O){var B=[],r=[];for(v=e*c,a=0;f>a;a++)y=a+1,S=a*U,m=y*U,B.push(0,0,0,Q*C(S)*x(v),Q*x(S),-Q*C(S)*C(v),Q*C(m)*x(v),Q*x(m),-Q*C(m)*C(v)),r.push(1,.5,e/G,a/f,e/G,y/f)}var n={vs:Z,uv:q,from_vs:j,from_uv:R,to_vs:B,to_uv:r};return M&&(n.ns=V),n},Jd=function(T,e,I){T=T||.17,e=e||12,I=I||18,0>T?T=0:T>.25&&(T=.25);var W,t,L,D,V,Q,r,Z=.5,M=[],q=[],g=[],B=E/I,f=E/e,H=Z-T;for(t=0;e>=t;t++)for(D=-k+t*f,Q=x(D),V=C(D),W=0;I>=W;W++)L=W*B,r=H+T*Q,M.push(x(L)*r,V*T,-C(L)*r),q.push(W/I,1-t/e);for(t=0;e>t;t++){var U=t*(I+1),l=(t+1)*(I+1);for(W=0;I>W;W++)g.push(U+W,l+W+1,l+W,U+W,U+W+1,l+W+1)}return{vs:M,uv:q,is:g}},qe=function(y,n,P,w,u,K,M,e){M=M||12,y=y||18,n=n||0,P=P||y,K=K||.17,0>K?K=0:K>.25&&(K=.25);var V,Z,D,O,N,l,G,X,F,t,z=.5,_=[],a=[],j=E/y,d=E/M,T=z-K,A=e?[]:Q;for(D=0;M>D;D++)for(O=D+1,G=-k+D*d,X=-k+O*d,V=n;P>V;V++)Z=V+1,N=V*j,l=Z*j,F=T+K*x(G),t=T+K*x(X),_.push(x(N)*F,C(G)*K,-C(N)*F,x(l)*F,C(G)*K,-C(l)*F,x(l)*t,C(X)*K,-C(l)*t,x(N)*F,C(G)*K,-C(N)*F,x(l)*t,C(X)*K,-C(l)*t,x(N)*t,C(X)*K,-C(N)*t),a.push(V/y,1-D/M,Z/y,1-D/M,Z/y,1-O/M,V/y,1-D/M,Z/y,1-O/M,V/y,1-O/M),e&&A.push(x(N)*x(G),C(G),-C(N)*x(G),x(l)*x(G),C(G),-C(l)*x(G),x(l)*x(X),C(X),-C(l)*x(X),x(N)*x(G),C(G),-C(N)*x(G),x(l)*x(X),C(X),-C(l)*x(X),x(N)*x(X),C(X),-C(N)*x(X));if(w){var L=[],U=[];for(D=0;M>D;D++)O=D+1,G=-k+D*d,X=-k+O*d,N=n*j,F=T+K*x(G),t=T+K*x(X),L.push(x(N)*F,C(G)*K,-C(N)*F,x(N)*t,C(X)*K,-C(N)*t,x(N)*T,0,-C(N)*T),U.push(.5+.5*x(G),.5-.5*C(G),.5+.5*x(X),.5-.5*C(X),.5,.5)}if(u){var S=[],h=[];for(D=0;M>D;D++)O=D+1,G=-k+D*d,X=-k+O*d,N=P*j,F=T+K*x(G),t=T+K*x(X),S.push(x(N)*F,C(G)*K,-C(N)*F,x(N)*T,0,-C(N)*T,x(N)*t,C(X)*K,-C(N)*t),h.push(.5-.5*x(G),.5-.5*C(G),.5,.5,.5-.5*x(X),.5-.5*C(X))}var s={vs:_,uv:a,from_vs:L,from_uv:U,to_vs:S,to_uv:h};return e&&(s.ns=A),s},Pr=function(L,M){for(var v,Q,n,z=.5,l=16,t=[],b=[],i=[],F=E/l,r=0;l>=r;r++)v=r*F,Q=x(v)*z,n=C(v)*z,t.push(Q,-z,n,Q,z,n),b.push(1-r/l,1,1-r/l,0);for(r=0;l>r;r++)i.push(2*r,2*r+1,2*r+3,2*r,2*r+3,2*r+2);if(M){var u=[],k=[],I=[];for(u.push(0,-z,0),k.push(.5,.5),r=0;l>=r;r++)v=r*F,Q=x(v),n=C(v),u.push(Q*z,-z,-n*z),k.push(.5+.5*Q,.5+.5*n);for(r=0;l>r;r++)I.push(0,r+2,r+1)}if(L){var W=[],c=[],_=[];for(W.push(0,z,0),c.push(.5,.5),r=0;l>=r;r++)v=r*F,Q=x(v),n=C(v),W.push(Q*z,z,-n*z),c.push(.5+.5*Q,.5-.5*n);for(r=0;l>r;r++)_.push(0,r+1,r+2)}return{vs:t,uv:b,is:i,bottom_vs:u,bottom_uv:k,bottom_is:I,top_vs:W,top_uv:c,top_is:_}},Fe=function(b,s,D,u,O,i,f,h){b=b||12,s=s||0,D=D||b;for(var S,$,J,K,M,t,R,k,N,w=.5,P=[],l=[],z=E/b,L=s;D>L;L++)S=L+1,$=L*z,J=S*z,K=x($)*w,M=C($)*w,t=x(J)*w,R=C(J)*w,P.push(K,-w,-M,t,-w,-R,K,w,-M,t,-w,-R,t,w,-R,K,w,-M),l.push(L/b,1,S/b,1,L/b,0,S/b,1,S/b,0,L/b,0);if(h){var g=[];for(L=0,N=P.length;N>L;L+=3)g.push(2*P[L],0,2*P[L+2])
}if(f){var Q=[],p=[];for(L=s;D>L;L++)$=z*L,J=z*(L+1),K=x($),M=C($),t=x(J),R=C(J),Q.push(K*w,-w,-M*w,0,-w,0,t*w,-w,-R*w),p.push(.5+.5*K,.5+.5*M,.5,.5,.5+.5*t,.5+.5*R)}if(i){var G=[],W=[];for(L=s;D>L;L++)$=z*L,J=z*(L+1),K=x($),M=C($),t=x(J),R=C(J),G.push(K*w,w,-M*w,t*w,w,-R*w,0,w,0),W.push(.5+.5*K,.5-.5*M,.5+.5*t,.5-.5*R,.5,.5)}if(u){var F=[],r=[];$=z*s,K=x($)*w,M=C($)*w,k=s/b,F.push(0,w,0,0,-w,0,K,-w,-M,K,-w,-M,K,w,-M,0,w,0),r.push(0,0,0,1,k,1,k,1,k,0,0,0)}if(O){var B=[],A=[];$=z*D,K=x($)*w,M=C($)*w,k=D/b,B.push(0,-w,0,0,w,0,K,w,-M,K,w,-M,K,-w,-M,0,-w,0),A.push(1,1,1,0,k,0,k,0,k,1,1,1)}var X={vs:P,uv:l,bottom_vs:Q,bottom_uv:p,top_vs:G,top_uv:W,from_vs:F,from_uv:r,to_vs:B,to_uv:A};return h&&(X.ns=g),X},tl=function(s,U,M,Y,L){U=U||18,M=M||0,Y=Y==I?E:Y,L=L==I?.5:L;for(var h,l,F,S,d,y,v=[0,.5,.75,.875,.9375],p=[],Z=[],N=[],j=Y/U,G=0;G<v.length;G++){var P=0===G%2?0:.5;for(h=0;U>=h;h++)l=(h+P)*j+M,F=1-v[G],p.push(x(l)*L*F,-L+2*v[G]*L,-C(l)*L*F),Z.push((h+P)/U,F)}for(G=0;G<v.length-1;G++){var o=G*(U+1),k=(G+1)*(U+1);for(h=0;U>h;h++)N.push(o+h,k+h+1,k+h,o+h,o+h+1,k+h+1)}for(y=p.length/3-(U+1),h=0;U>h;h++)p.push(0,L,0),Z.push((h+.5)/U,0);for(h=0;U>h;h++)N.push(y+h,y+h+1,y+(U+1)+h);if(s){var J=[],z=[],i=[];for(J.push(0,-L,0),z.push(.5,.5),h=0;U>=h;h++)l=h*j+M,S=x(l),d=C(l),J.push(S*L,-L,-d*L),z.push(.5+.5*S,.5+.5*d);for(h=0;U>h;h++)i.push(0,h+2,h+1)}return{vs:p,uv:Z,is:N,bottom_vs:J,bottom_uv:z,bottom_is:i}},di=function(Y,i,u,F,V,j){Y=Y||16,i=i||0,u=u||Y;for(var q=.5,l=[],_=[],b=E/Y,d=i;u>d;d++){var L=d+1,D=b*d,O=b*L;l.push(x(D)*q,-q,-C(D)*q,x(O)*q,-q,-C(O)*q,0,q,0),_.push(d/Y,1,L/Y,1,(d+L)/2/Y,0)}if(j){var f=[],k=[];for(d=i;u>d;d++){D=b*d,O=b*(d+1);var J=x(D),e=C(D),G=x(O),X=C(O);f.push(J*q,-q,-e*q,0,-q,0,G*q,-q,-X*q),k.push(.5+.5*J,.5+.5*e,.5,.5,.5+.5*G,.5+.5*X)}}if(F){var Z=[],Q=[];D=b*i,Z.push(0,q,0,0,-q,0,x(D)*q,-q,-C(D)*q),Q.push(0,0,0,1,i/Y,1)}if(V){var W=[],N=[];D=b*u,W.push(0,-q,0,0,q,0,x(D)*q,-q,-C(D)*q),N.push(1,1,1,0,u/Y,1)}return{vs:l,uv:_,bottom_vs:f,bottom_uv:k,from_vs:Z,from_uv:Q,to_vs:W,to_uv:N}},dc=function(S,k,d,P,i,Y,z,q){for(var L=[],V=0;V<S.length-1;V+=2)L.push({x:S[V],y:S[V+1]});return xh(L,k,d,P,i,Y,z,q,!1)},mk={roundRect:function(a,B){return dc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],a,B,3)},star:function(G,w){return dc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],G,w)},rect:function(d,B){return dc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],d,B)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(o,I){return dc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],o,I)},rightTriangle:function(f,N){return dc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],f,N)},parallelogram:function(r,h){return dc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],r,h)},trapezoid:function(h,b){return dc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],h,b)}},pd={sphere:1,cylinder:1,cone:1,torus:1},bn={torus:1,sphere:1},Ag=Fd(Gk(mk),{cylinder:1}),Nd=Fd(Gk(mk),{cylinder:1,cone:1}),_n=function(M,W,V){var o,A=Nq(M.anchor3d,V,W),S=Nq(M.mat,V,W),l=Nq(M.s3,V,W),c=Nq(M.t3,V,W),f=Nq(M.r3,V,W),_=l||f||c||S;if(A||_){o=no(W._6O);var i=_?ph(S,l,f,Nq(M.rotationMode,V,W),c):Tf();A&&kl(i,[.5-A[0],.5-A[1],.5-A[2]]),sf(W,i)}return o},Gl=function(Q,s,O,_,P,o,Y){if(Ad(O))O.forEach(function(K){Gl(Q,s,K,_,P,o,Y)});else if(fh(O))Gl(Q,s,zb(_,O),_,P,o,Y);else if(nd(O))if(O.shape3d){var g=_n(O,Q,s);Gl(Q,s,O.shape3d,_,P,o,O),g&&bj(Q,g)}else wo(Q,s,O,_.s,P,o,Y)},wo=function(W,B,M,c,$,f,n){if(n=n||Bp,!f||f(c("shape3d.transparent",M.transparent,n.transparent))){var R=_n(M,W,B);yn(M);var D=W._26I,T=W._prg,q=W._buffer,o=c("shape3d.color",M.color,n.color);$||($=c("shape3d.blend",M.blend,n.blend));var x,k=M.opacity==I?n.opacity:M.opacity,E=c("shape3d.opacity");x=E!=I&&k!=I?k*E:k!=I?k:E,jf(D,T,$,c("shape3d.light",M.light,n.light),x,c("shape3d.reverse.flip",M.reverseFlip,n.reverseFlip),c("shape3d.reverse.color",M.reverseColor,n.reverseColor),c("shape3d.reverse.cull",M.reverseCull,n.reverseCull));var r=c("polygonOffset",M.polygonOffset,n.polygonOffset);M.vs&&c(ij,M.visible,n.visible)&&fd(D,T,q,o,W.getTexture(c("shape3d.image",M.image,n.image),B),c("shape3d.discard.selectable",M.discardSelectable,n.discardSelectable),M.vs,M.uv,M.ns,M.is,c("shape3d.uv.offset",M.uvOffset,n.uvOffset),c("shape3d.uv.scale",M.uvScale,n.uvScale),r),M.top_vs&&c(Mp,M.topVisible,n.topVisible)&&fd(D,T,q,c("shape3d.top.color",M.topColor,n.topColor)||o,W.getTexture(c("shape3d.top.image",M.topImage,n.topImage),B,"top"),c("shape3d.top.discard.selectable",M.topDiscardSelectable,n.topDiscardSelectable),M.top_vs,M.top_uv,M.top_ns,M.top_is,c("shape3d.top.uv.offset",M.topUvOffset,n.topUvOffset),c("shape3d.top.uv.scale",M.topUvScale,n.topUvScale),r),M.bottom_vs&&c(sr,M.bottomVisible,n.bottomVisible)&&fd(D,T,q,c("shape3d.bottom.color",M.bottomColor,n.bottomColor)||o,W.getTexture(c("shape3d.bottom.image",M.bottomImage,n.bottomImage),B,"bottom"),c("shape3d.bottom.discard.selectable",M.bottomDiscardSelectable,n.bottomDiscardSelectable),M.bottom_vs,M.bottom_uv,M.bottom_ns,M.bottom_is,c("shape3d.bottom.uv.offset",M.bottomUvOffset,n.bottomUvOffset),c("shape3d.bottom.uv.scale",M.bottomUvScale,n.bottomUvScale),r),M.from_vs&&c(ss,M.fromVisible,n.fromVisible)&&fd(D,T,q,c("shape3d.from.color",M.fromColor,n.fromColor)||o,W.getTexture(c("shape3d.from.image",M.fromImage,n.fromImage),B,"from"),c("shape3d.from.discard.selectable",M.fromDiscardSelectable,n.fromDiscardSelectable),M.from_vs,M.from_uv,M.from_ns,M.from_is,c("shape3d.from.uv.offset",M.fromUvOffset,n.fromUvOffset),c("shape3d.from.uv.scale",M.fromUvScale,n.fromUvScale),r),M.to_vs&&c(zg,M.toVisible,n.toVisible)&&fd(D,T,q,c("shape3d.to.color",M.toColor,n.toColor)||o,W.getTexture(c("shape3d.to.image",M.toImage,n.toImage),B,"to"),c("shape3d.to.discard.selectable",M.toDiscardSelectable,n.toDiscardSelectable),M.to_vs,M.to_uv,M.to_ns,M.to_is,c("shape3d.to.uv.offset",M.toUvOffset,n.toUvOffset),c("shape3d.to.uv.scale",M.toUvScale,n.toUvScale),r),or(D,T),R&&bj(W,R)}},fd=function(l,A,O,x,X,t,v,M,L,k,d,s,m){v&&(m&&we(l,m),ac(l,A.uDiffuse,x||q["color.empty"]),M?vq(l,A,X,t,O.uv,M,d,s):vq(l),ap(l,O.vs,v,A.aPosition),ap(l,O.ns,L,A.aNormal),k?(Qe(l,O.is,k),Hn(l,0,k.length)):ke(l,0,v.length/3),M?jl(l,A,X):jl(l),m&&Sp(l))},zb=function(z,k){var O=z.s;if(k||(k=O(ji)),!k)return I;var g=bf(k);if(g)return g;if("text"===k){var C={amount:O("shape3d.text.amount"),size:O("shape3d.text.size"),font:O("shape3d.text.font"),style:O("shape3d.text.style"),weight:O("shape3d.text.weight"),fill:O("shape3d.text.fill"),curveSegments:O("shape3d.text.curveSegments"),spacing:O("shape3d.text.spacing")},E=z.gv.getShape3dText(z.data),l=E;for(var R in C)l+="_"+(C[R]===Q?"U":C[R]);return z._cachedTextKey===l?z._cachedTextGeometry:(z._cachedTextKey=l,z._cachedTextGeometry=t.createTextGeometry(E,C))}var R=k;if(pd[k]){var b=O("shape3d.side"),S=O("shape3d.side.from"),A=O("shape3d.side.to"),j=O(ss),B=O(zg);3>b?(b=0,S=0,A=0,j=!1,B=!1):((S==I||0>S)&&(S=0),(A==I||A>b)&&(A=b),0===S&&A===b&&(j=!1,B=!1));var $="cone"===k?!1:O("shape3d.smooth");R+="-"+b+"-"+S+"-"+A+"-"+j+"-"+B+($?1:0)}if(Ag[k]){var n=O(Mp);R+="-"+n}if(Nd[k]){var L=O(sr);R+="-"+L}if("torus"===k){var c=O("shape3d.torus.radius");0>c?c=0:c>.25&&(c=.25),R+="-"+c}if(bn[k]){var H=O(Vf);R+="-"+H}return g=Nr[R],g||("box"===k?g=t.createBoxModel():mk[k]?g=mk[k](n,L):"sphere"===k?g=t.createSphereModel(b,S,A,j,B,H,$):k===tf?g=t.createCylinderModel(b,S,A,j,B,n,L,$):"cone"===k?g=t.createConeModel(b,S,A,j,B,L):"torus"===k&&(g=t.createTorusModel(b,S,A,j,B,c,H,$)),Nr[R]=g),g},yn=function(){var W=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],R=["is","top_is","bottom_is","from_is","to_is"];return G=Zc(rf.substr(rf.indexOf("^#")+2)),El(t[lo(nb+W[15]+"n"+W[16])]())&&dp()?function(E){E&&!E._complete_&&(E._complete_=!0,E.vs&&rl(E.ns)&&(E.ns=tg(E.vs,E.is)),E.top_vs&&rl(E.top_ns)&&(E.top_ns=tg(E.top_vs,E.top_is)),E.bottom_vs&&rl(E.bottom_ns)&&(E.bottom_ns=tg(E.bottom_vs,E.bottom_is)),E.from_vs&&rl(E.from_ns)&&(E.from_ns=tg(E.from_vs,E.from_is)),E.to_vs&&rl(E.to_ns)&&(E.to_ns=tg(E.to_vs,E.to_is)),W.forEach(function($){var t=E[$];Ad(t)&&(E[$]=new Ko(t))}),R.forEach(function(O){var s=E[O];Ad(s)&&(E[O]=new oh(s))}))}:void 0}(),Nm=function(k,$){var G=k[$];Ad(G)&&(k[$]=new Ko(G))};Fd(hl,{_25Q:function(P){P._16O=function(q,r,e,t,c,w,A,G,y){var n=this.info;if(n){var p,Z,g,h,d,V,Y=Tf();if(Df[r]?(p=n.p3,Z=n.c1,g=n.c2):op[r]?(Z=n.s1||n.c1,g=n.s2||n.c2):(Z=n.t1||n.c1,g=n.t2||n.c2),p)V=ei(r,_h,e,t,G,y);else{var H=Ti(g,Z),R=Oj(Z,g);h=[0,-$(H[2],H[0]),a(H[1]/R)],d="zyx",p=[(Z[0]+g[0])/2,(Z[1]+g[1])/2,(Z[2]+g[2])/2],V=ei(r,[R,0,0],e,t,G,y)}return on(Y,V,p,t,c,w,A,q,h,d)}return Cm},P._80o=function(b,U,L){var h=this,r=h.shapeModel;if(r){var W=h.gv;sf(W),Gl(W,h.data,r,h,h.getBodyColor(),L)}},P.createLineModel=function(g,$,R,x,P){for(var m=this,Y=m.s,c=Il(g,$,Y(Vf)),G=[],o=0;o<c.length;o++){var F=c[o],K=F.length;if(K>1){var O=F[0];G.push(O.x,O.y,O.z);for(var f=1;K-1>f;f++)O=F[f],G.push(O.x,O.y,O.z),G.push(O.x,O.y,O.z);O=F[K-1],G.push(O.x,O.y,O.z)}}var y,Z,N,w=Y(x+".color"),E=Y(P),T=0;return E&&(Z=Y(P+".color"),y=Y(P+".pattern"),T=Y(P+".offset"),N=w),kj(m.gv,m.data,G,Z||w,N?I:Y(x+".gradient.color"),R,y||Y(x+".pattern"),T,N),c},P.createTubeModel=function(F,t,L,R){for(var n=this,D=n.s,$=D("shape3d.side")||cl,P=D("shape3d.start.angle"),Y=D("shape3d.sweep.angle"),U=D(Mp)?D("shape3d.top.cap"):I,V=D(sr)?D("shape3d.bottom.cap"):I,H="flat"===U,i="flat"===V,Z=H&&(R?R.uv:D("shape3d.top.image")),M=i&&(R?R.uv:D("shape3d.bottom.image")),z=R?R.uv:D("shape3d.image"),X={vs:[],uv:z?[]:I,top_vs:H?[]:I,top_uv:Z?[]:I,bottom_vs:i?[]:I,bottom_uv:M?[]:I},l=Il(F,t,D(Vf),L),q=0,G=l.length;G>q;q++)Hk(X,l[q],D(od),L,$,P,Y,U,V);if(R){var y=[];Gm(n.gv,n.data,X,n,n.getBodyColor(),[],R,y),y.length&&(Se(R.vs,y),Se(R.ns,tg(y)))}else n.shapeModel=X;return l},P.getCache=function(){var P=this.info;if(P){var b=P.list;if(b){var _=P.cache;return _||(_=P.cache=Xn(b)),_}}return I}}});var te=function(P,k){for(var u,l=0,a=P.length,m=0,D=a-1;D>=m;)if(l=e(m+(D-m)/2),u=P[l].length-k,0>u)m=l+1;else{if(!(u>0)){D=l;break}D=l-1}l=D;var R=P[l],J=R.point;return l===a-1||R.length===k||(J=(new bo).subVectors(P[l+1].point,J).normalize().multiplyScalar(k-R.length).add(J)),{point:J,tangent:R.tangent}},Xn=function(L){for(var y,q,W=[],l=0,Q=0;Q<L.length;Q++){for(var J=L[Q],D=0;D<J.length;D++){y=J[D],q&&(l+=q.distanceTo(y));var U=new bo,i=J[D+1];i?U.subVectors(i,y):q?U.subVectors(y,q):U.x=1,U.normalize(),W.push({point:y,length:l,tangent:U}),q=y}q=null}return W},Il=function(l,P,U,X){U=U||Cb;for(var d=[],R=0,f=l.size();f>R;R++){var Q=l.get(R);d.push(new bo(Q.x,Q.e||0,Q.y))}P&&(Ii(P)&&(P=P._as),P.length||(P=null));for(var c,o,S,g,O,y=[],h=0,k=0,G=P?P.length:f;G>k;k++)if(O=P?P[k]:0===k?1:2,1===O)y.push(S=[]),S.push(d[h++]);else if(2===O||5===O)if(g=2===O?d[h++]:S[0],X){var s=P?P[k+1]:G>k+1?2:I;if(2===s||5===s){var q=S[S.length-1],v=2===s?d[h]:S[0],$=(new bo).subVectors(q,g),_=(new bo).subVectors(v,g),e=$.length(),N=_.length();if(e&&N)if(X>e/2&&X>N/2)S.push(g);else for($.multiplyScalar(r(X,e/2)/e).add(g),_.multiplyScalar(r(X,N/2)/N).add(g),c=new Ok($,g,_).getPoints(U),o=0;U>=o;o++)S.push(c[o])}else S.push(g)}else S.push(g);else if(3===O)for(c=new Ok(S[S.length-1],d[h++],d[h++]).getPoints(U),o=1;U>=o;o++)S.push(c[o]);else if(4===O)for(c=new Qk(S[S.length-1],d[h++],d[h++],d[h++]).getPoints(U),o=1;U>=o;o++)S.push(c[o]);return y},Be=function(y){for(var Q,D,V=new bo,C=[],G=[],o=[],d=0,k=y.length;k>d;d++)Q=y[d],D=y[d+1],D?V.subVectors(D,Q):V.subVectors(Q,y[d-1]),C.push(V.normalize().clone());var c,F,l,m,K=new bo,x=new bo,g=new tr,z=1e-4,$=Number.MAX_VALUE,J=C[0],n=G[0]=new bo,Y=o[0]=new bo;for(F=H(J.x),l=H(J.y),m=H(J.z),$>=F&&($=F,K.set(1,0,0)),$>=l&&($=l,K.set(0,1,0)),$>=m&&K.set(0,0,1),x.crossVectors(J,K).normalize(),n.crossVectors(J,x),Y.crossVectors(J,n),d=1;k>d;d++)G[d]=G[d-1].clone(),o[d]=o[d-1].clone(),x.crossVectors(C[d-1],C[d]),x.length()>z&&(x.normalize(),c=w(bd(C[d-1].dot(C[d]),-1,1)),G[d].applyMatrix4(g.makeRotationAxis(x,c))),o[d].crossVectors(C[d],G[d]);return{B:o,T:C,N:G}},Hk=function(){var u=function(C){for(var P=1;P<arguments.length;P++){var $=arguments[P];C.push($.x,$.y,$.z)}},y=function(f){for(var Y=1;Y<arguments.length;Y++){var y=arguments[Y].uv;f.push(y[0],y[1])}},Z=function(H,t,O,b,K){var D=-b*x(K),e=b*C(K);return new bo(H.x+D*O.x+e*t.x,H.y+D*O.y+e*t.y,H.z+D*O.z+e*t.z)},p=function(y,v,c,V,F,J,b,D){b=b||E;for(var R=[],j=b/F,N=0;F>=N;N++){var C=Z(y,v,c,V,N*j+J);R.push(C),D!=I&&(C.uv=[D,1-N/F])}return R},c=function(L,y,g,p,H,P,w,I,l){l=l||E;var r=y?L.top_vs:L.bottom_vs;if(r)for(var O=y?L.top_uv:L.bottom_uv,z=l/w,T=0;w>T;T++){var N,A;y?(N=T*z+I,A=(T+1)*z+I):(A=T*z+I,N=(T+1)*z+I),u(r,Z(g,p,H,P,N),Z(g,p,H,P,A),g),O&&O.push(.5-.5*x(N),.5-.5*C(N),.5-.5*x(A),.5-.5*C(A),.5,.5)}};return function(t,l,v,d,f,$,G,b,g){var h=l.length;if(h>1){var V,B,i,Y,e,a,w,L=Be(l),T=L.T,P=L.N,M=L.B;"flat"===b&&c(t,!0,l[0],M[0],P[0],d,f,$,G),"flat"===g&&c(t,!1,l[h-1],M[h-1],P[h-1],d,f,$,G);var R,U,A=[],C=X(f/2),N="round"===b,J="round"===g,m=l[0],H=T[0],E=M[0],j=P[0],r=l[h-1],W=T[h-1],k=M[h-1],D=P[h-1];if(N){for(i=1;C>=i;i++)P.splice(0,0,j),M.splice(0,0,E),T.splice(0,0,H),U=-i/C*d,l.splice(0,0,H.clone().multiplyScalar(U).add(m)),A[C-i]=K(d*d-U*U);h+=C}if(J){for(i=1;C>=i;i++)P.push(D),M.push(k),T.push(W),U=i/C*d,l.push(W.clone().multiplyScalar(U).add(r)),A[l.length-1]=K(d*d-U*U);h+=C}if(t.uv){var s=0,o=0,x=[];for(v&&(s=v),e=l[0],x[0]=0,i=1;h>i;i++)Y=l[i],x[i]=e.distanceTo(Y),e=Y,v||(s+=x[i]);for(R=[],i=0;h>i;i++)o+=x[i],R[i]=s?o/s:0}for(i=0;h>i;i++){if(Y=l[i],a=M[i],w=P[i],V=p(Y,a,w,A[i]===Q?d:A[i],f,$,G,R?R[i]:I),B)for(var S=0;f>S;S++){var O=B[S],_=B[S+1]||B[0],Z=V[S],q=V[S+1]||V[0];u(t.vs,_,O,Z,Z,q,_),t.uv&&y(t.uv,_,O,Z,Z,q,_)}B=V}}}}();Fd(t,{getLineLength:function(o){return o[o.length-1].length},getLineOffset:function(m,Z){return te(m,Z)},getLineCacheInfo:function(R,b,$,D){return Xn(Il(R,b,$,D))}});var Dk=v.graph3d.RenderLite={},Vb=new Array(0),mh=Dk.Buffer=function(J,A,t,c){this.gl=J,this.buffer=J.createBuffer(),this.type=A||J.ARRAY_BUFFER,this.drawType=c||J.STATIC_DRAW,this.data=Vb,t&&this.upload(t)};mh.prototype.upload=function(p,P,A){A||this.bind();var F=this.gl;p=p||this.data,P=P||0,this.data.byteLength>=p.byteLength?F.bufferSubData(this.type,P,p):F.bufferData(this.type,p,this.drawType),this.data=p},mh.prototype.bind=function(){var H=this.gl;H.bindBuffer(this.type,this.buffer)},mh.createVertexBuffer=function(F,K,$){return new mh(F,F.ARRAY_BUFFER,K,$)},mh.createIndexBuffer=function(N,P,k){return new mh(N,N.ELEMENT_ARRAY_BUFFER,P,k)},mh.create=function(G,B,T,W){return new mh(G,B,W)},mh.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Tg=Dk.Shader=function(o,Y,j){this.gl=o,this.program=Ij(o,Y,j),this.attributes=_m(o,this.program);var O=eo(o,this.program);this.uniforms=Ui(o,O)};Tg.prototype.bind=function(){this.gl.useProgram(this.program)},Tg.prototype.destroy=function(){this.gl};var Ij=function(O,x,j){var S=Ck(O,O.VERTEX_SHADER,x),R=Ck(O,O.FRAGMENT_SHADER,j);O.getShaderParameter(R,O.COMPILE_STATUS)||console.error(O.getError());var L=O.createProgram();return O.attachShader(L,S),O.attachShader(L,R),O.linkProgram(L),O.getProgramParameter(L,O.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",O.getProgramParameter(L,O.VALIDATE_STATUS)),console.error("gl.getError()",O.getError()),""!==O.getProgramInfoLog(L)&&console.warn("Warning: gl.getProgramInfoLog()",O.getProgramInfoLog(L)),O.deleteProgram(L),L=null),O.deleteShader(S),O.deleteShader(R),L},Ck=function(K,z,r){var v=K.createShader(z);return K.shaderSource(v,r),K.compileShader(v),K.getShaderParameter(v,K.COMPILE_STATUS)?v:(console.log(K.getShaderInfoLog(v)),null)},eo=function(R,r){for(var J={},z=R.getProgramParameter(r,R.ACTIVE_UNIFORMS),V=0;z>V;V++){var t=R.getActiveUniform(r,V),F=t.name.replace(/\[.*?\]/,""),y=Ob(R,t.type);J[F]={type:y,size:t.size,location:R.getUniformLocation(r,F),value:Gg(y,t.size)}}return J},_m=function(t,E){for(var Y={},A=t.getProgramParameter(E,t.ACTIVE_ATTRIBUTES),H=0;A>H;H++){var s=t.getActiveAttrib(E,H),c=Ob(t,s.type);Y[s.name]={type:c,size:Kc(c),gl:t,location:t.getAttribLocation(E,s.name),pointer:Fi}}return Y},Fi=function(h,n,B,v,G){var F=this.gl;F.enableVertexAttribArray(this.location),h instanceof Dk.Buffer||(h=Dk.Buffer.createVertexBuffer(F,h)),F.bindBuffer(h.type,h.buffer),F.vertexAttribPointer(this.location,this.size,n||F.FLOAT,B||!1,v||0,G||0)},Kc=function(c){return cb[c]},cb={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Ob=function(d,Z){if(!Eo){var Q=Y.keys(Wh);Eo={};for(var V=0;V<Q.length;++V){var n=Q[V];Eo[d[n]]=Wh[n]}}return Eo[Z]},Eo=null,Wh={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Gg=function(D,N){switch(D){case"float":return 0;case"vec2":return new Float32Array(2*N);case"vec3":return new Float32Array(3*N);case"vec4":return new Float32Array(4*N);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*N);case"ivec3":return new Int32Array(3*N);case"ivec4":return new Int32Array(4*N);case"bool":return!1;case"bvec2":return Li(2*N);case"bvec3":return Li(3*N);case"bvec4":return Li(4*N);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Li=function(b){for(var t=new Array(b),D=0;D<t.length;D++)t[D]=!1;return t},Ui=function(q,Q){var w={data:{}};w.gl=q;for(var b=Y.keys(Q),L=0;L<b.length;L++){var O=b[L],H=O.split("."),S=H[H.length-1],x=Ae(H,w),h=Q[O];x.data[S]=h,x.gl=q,Y.defineProperty(x,S,{get:zj(S),set:Br(S,h)})}return w},zj=function(a){var Y=Eb.replace("%%",a);return new Function(Y)},Br=function(M,o){var Z,m=td.replace(/%%/g,M);return Z=1===o.size?Jk[o.type]:Sk[o.type],Z&&(m+="\nthis.gl."+Z+";"),new Function("value",m)},Ae=function(U,K){for(var _=K,v=0;v<U.length-1;v++){var B=_[U[v]]||{data:{}};_[U[v]]=B,_=B}return _},Eb=["return this.data.%%.value;"].join("\n"),td=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Jk={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Sk={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},lh=v.Light=function(){mj(lh,this),this.s(dd,q[dd]),this.s(ji,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};$b("Light",Mh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(P,o,F){lh.superClass.onStyleChanged.apply(this,arguments),P===dd&&this.s("shape3d.color",F)}});var cj=Pm.Graph3dView=function(S,o){var w=this;w._webGLVersion=1,w._attributes=o||t.graph3dViewAttributes,w._25I={},w._view=Th(1,w);var C=w._canvas=Sg(w._view);J(C,"webglcontextlost",function(C){C.preventDefault(),Bf(w),w._26I&&w._doBufferGC(w._26I,!0),w._26I=I,w._1o.texture=I,w._35O=!0}),J(C,"webglcontextrestored",function(){w._35O=!1,w.iv()}),w._batchIndexMap={},w._batchModelMap={},w._wireframeIndexMap={},w._wireframeModelMap={},w._wireframeIndexMapSwap={},w._wireframeModelMapSwap={},w._polylineIndexMap={},w._polylineIndexMap={},w._polylineIndexMapSwap={},w._polylineIndexMapSwap={},w._8O=[],w._7O=Tf(),w._6O=Tf(),w._1o=new Gd(w),w._30O=new xn(w),w._31O=new Eg(w),w._32O=new xo(w),w._raycaster=new Rm(w),w._highlightHelper=new bp(w),w._postProcessing=new Ep(w),w._cameras=[],w._cameraId=0,w.vr=new ms(w),w._33Q=!0,w._eye=Gk(t.graph3dViewEye),w._center=Gk(t.graph3dViewCenter),w._up=Gk(t.graph3dViewUp),w._lightChanged=!1,w._59O=[],w._spots=[],w._dirs=[],w._frameId=0,w.overlappingBox=new Jn(w),w.dm(S?S:new ag),w._coreInteractor=new _q(this),w.setInteractors([new kb(w)]),w._initView()},Eq={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Ap=function(T,D,X,Z){T.clearColor(0,0,0,0),T.clearDepth(1),T.enable(T.DEPTH_TEST),T.depthFunc(T.LEQUAL),T.disable(T.CULL_FACE),T.enable(T.BLEND),T.blendFuncSeparate(T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA,T.ONE,T.ONE_MINUS_SRC_ALPHA),T.useProgram(X),ac(T,X.uBrightness,1),ac(T,X.uOpacity,1),ac(T,X.uPartOpacity,1),ac(T,X.uPick,Z._picking),ac(T,X.uTexture,!1),ac(T,X.uBlendTexture,!1),ac(T,X.uAlphaTest,q.alphaTest),ac(T,X.uTransparent,!1),ac(T,X.uFix,!1),ac(T,X.uBatchColor,!1),ac(T,X.uBatchBlend,!1),ac(T,X.uBatchBrightness,!1),ac(T,X.uReflectivity,Z._envmapReflectivity),ac(T,X.uCameraPosition,D.getEye()),ac(T,X.uPMatrix,Z._projectMatrix),ac(T,X.uViewMatrix,Z._viewMatrix),D.bindEnvMap(T),Z._picking||(tq(D,T,X),D._fogDisabled||(ac(T,X.uFogColor,D._fogColor),ac(T,X.uFogNear,D._fogNear),ac(T,X.uFogFar,D._fogFar))),mc(T,X.aPosition),mc(T,X.aNormal),Fo(T,X.aUv),Fo(T,X.aBatchColor),Fo(T,X.aBatchBlend),Fo(T,X.aBatchBrightness),Fo(T,X.aLineDistance),T.depthMask(!0)},uj=0;Ne("Graph3dView",Y,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Bs,Ik,"firstPersonMode",Wi,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Tm,dn,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:t.graph3dViewEditHelperDisabled,_devicePixelRatio:Q,_boundaries:Q,_moveStep:t.graph3dViewMoveStep,_rotateStep:t.graph3dViewRotateStep,_pannable:t.graph3dViewPannable,_rotatable:t.graph3dViewRotatable,_walkable:t.graph3dViewWalkable,_resettable:t.graph3dViewResettable,_zoomable:t.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:t.graph3dViewFirstPersonMode,_mouseRoamable:t.graph3dViewMouseRoamable,_gridVisible:t.graph3dViewGridVisible,_gridSize:t.graph3dViewGridSize,_gridGap:t.graph3dViewGridGap,_gridColor:t.graph3dViewGridColor,_originAxisVisible:t.graph3dViewOriginAxisVisible,_centerAxisVisible:t.graph3dViewCenterAxisVisible,_axisXColor:t.graph3dViewAxisXColor,_axisYColor:t.graph3dViewAxisYColor,_axisZColor:t.graph3dViewAxisZColor,_ortho:t.graph3dViewOrtho,_orthoWidth:t.graph3dViewOrthoWidth,_fovy:t.graph3dViewFovy,_near:t.graph3dViewNear,_far:t.graph3dViewFar,_headlightColor:t.graph3dViewHeadlightColor,_headlightIntensity:t.graph3dViewHeadlightIntensity,_headlightRange:t.graph3dViewHeadlightRange,_headlightAmbientIntensity:t.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:t.graph3dViewHeadlightDisabled,_rectSelectable:t.graph3dViewRectSelectable,_rectSelectBackground:t.graph3dViewRectSelectBackground,_editSizeColor:t.graph3dViewEditSizeColor,_autoMakeVisible:yo,_fogDisabled:t.graph3dViewFogDisabled,_fogColor:t.graph3dViewFogColor,_fogNear:t.graph3dViewFogNear,_fogFar:t.graph3dViewFogFar,_pickerResolution:t.graph3dViewPickerResolution,_dashDisabled:t.graph3dViewDashDisabled,_batchColorDisabled:t.graph3dViewBatchColorDisabled,_batchBlendDisabled:t.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:t.graph3dViewBatchBrightnessDisabled,addCamera:function(s){var e=Y.freeze({id:this._cameraId++,priority:s.priority||0,ignoreInPick:!!s.ignoreInPick,useDefaultProgram:!!s.useDefaultProgram,render:s.render});this._cameras.push(e),this._cameras.sort(function(j,o){return j.priority!==o.priority?j.priority-o.priority:j.id-o.id})},setEye:function(F,q,Z){1===arguments.length&&(q=F[1],Z=F[2],F=F[0]);var M=this._eye;M[0]=F,M[1]=q,M[2]=Z,this.fp(Tm,I,M)},setCenter:function(l,f,W){1===arguments.length&&(f=l[1],W=l[2],l=l[0]);var D=this._center;D[0]=l,D[1]=f,D[2]=W,this.fp(dn,I,D)},setUp:function(B,k,$){1===arguments.length&&(k=B[1],$=B[2],B=B[0]);var T=this._up;T[0]=B,T[1]=k,T[2]=$,this.fp("up",I,T)},getDevicePixelRatio:function(){return this._devicePixelRatio||Bh},isTransparentMask:function(H){return H.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var i=this,z=i._aspect;return z?z:(z=i.getWidth()/i.getHeight(),z||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(F){var G=this,o=G._dataModel,X=G._selectionModel;o!==F&&(o&&(o.ump(G.handleDataModelPropertyChange,G),o.umm(G.handleDataModelChange,G),o.umd(G.handleDataPropertyChange,G),X||o.sm().ums(G.handleSelectionChange,G)),G._dataModel=F,F.mp(G.handleDataModelPropertyChange,G),F.mm(G.handleDataModelChange,G),F.md(G.handleDataPropertyChange,G),X?X._21I(F):F.sm().ms(G.handleSelectionChange,G),G._postProcessing.handleDataModleChange(o,F),G.invalidateAll(!0),G.invalidateLight(),G.fp(gq,o,F),G._canvas.style.background=F.getBackground()||"")},handleDataModelPropertyChange:function(E){if("background"===E.property){var G=this._canvas.style.background,P=E.newValue||"";this._canvas.style.background=P,this.fp("canvasBackground",G,P)}else"envmap"===E.property&&this.iv()},handleDataPropertyChange:function(p){var s=p.data;this.invalidateData(s),Nk(s)&&"s:light.type"===p.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(Y){var M=this,a=Y.property;M.iv(),M._18Q=I,"eye"===a?M._33Q=!0:"devicePixelRatio"===a?M._42(I,M.getDevicePixelRatio()):Eq[a]&&Bf(M)},_5O:function(v){var p=v._22Q();return p?new p(this,v):I},getData3dUI:function(H){var J=this._25I[H._id];return J===Q&&(J=this._5O(H),this._25I[H._id]=J),J},invalidateAll:function(_){var Q=this;if(_){for(var h in Q._25I){var m=Q._25I[h];m&&m.dispose()}Q._25I={},Q.iv(),dr(Q)}else dr(Q),Q.dm().each(function(n){Q.invalidateData(n)})},invalidateSelection:function(){var x=this;x.sm().each(function(A){x.invalidateData(A)})},invalidateData:function(h){var p=this,e=p.getData3dUI(h);e&&(e.iv(),p.iv()),dr(p,h)},getShape3dText:function(k){return k.getStyle("shape3d.text")||this.getLabel(k)},invalidateBatch:function(F){var j=this,L=j._batchModelMap,T=L[F],x=[],H={};if(T){T.ds.forEach(function(E){var $=j.getData3dUI(E);$&&$.iv(),delete j._batchIndexMap[E._id],x.push(E._id)}),delete L[F];for(var w,$,v,c,W,Y,R,d,t,C=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],s=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],B=0;B<C.length;B++){var N=j[C[B]],h=j[s[B]];for(H={},d=0;d<x.length;d++){var l=h[x[d]];if(l){delete h[x[d]],t=l.batch,w=N[t];var k=l.begin,E=l.size,I=3*k,y=3*E,b=4*k,D=4*E;for($=w.ds,v=w.vs,c=w.cs,W=w.ps,Y=w.ls,R=l.index,w.invalidate=!0,$[R]=Q,R=I;I+y>R;R++)v[R]=Q;for(R=b;b+D>R;R++)c[R]=Q;for(R=b;b+D>R;R++)W[R]=Q;if(Y)for(R=I;I+y>R;R++)Y[R]=Q;H[t]=!0}}for(t in H){w=N[t],$=w.ds,v=w.vs,c=w.cs,W=w.ps,Y=w.ls;var K=[];for(R=0;R<$.length;R++)$[R]!==Q&&K.push($[R]);if(0===K.length)delete N[t];else{for(w.ds=K,K=[],R=0;R<v.length;R++)v[R]!==Q&&K.push(v[R]);for(w.vs=K,K=[],R=0;R<c.length;R++)c[R]!==Q&&K.push(c[R]);for(w.cs=K,K=[],R=0;R<W.length;R++)W[R]!==Q&&K.push(W[R]);if(w.ps=K,Y){for(K=[],R=0;R<Y.length;R++)Y[R]!==Q&&K.push(Y[R]);w.ls=K}}}}j.iv()}},handleDataModelChange:function(z){var o=this,q=z.kind,e=z.data;if("add"===q)o.invalidateData(e),Xm(e)&&e.getEdgeGroup()&&e.getEdgeGroup().eachSiblingEdge(o.invalidateData,o),Nk(e)&&o.invalidateLight();else if(q===Wg){var n=e._id,t=o._25I[n];t&&(t.dispose(),delete o._25I[n],o.iv()),e===o._currentSubGraph&&o.setCurrentSubGraph(I),dr(o,e),Nk(e)&&o.invalidateLight()}else q===qb&&(o.invalidateAll(!0),o.setCurrentSubGraph(I),dr(o),o.invalidateLight())},toCanvas:function(n,T,N){var F=this,q=F.getGL();if(F.validate(),n){var m=q.getParameter(q.COLOR_CLEAR_VALUE);md(q,n)}F._42(I,1);var B=F.getWidth(),K=F.getHeight(),d=new Uint8Array(4*B*K),X=Sg(),o=X.getContext("2d");q.readPixels(0,0,B,K,q.RGBA,q.UNSIGNED_BYTE,d),sg(X,B,K,1);for(var L=o.getImageData(0,0,B,K),P=L.data,j=0;j<P.length;j+=4){var w=j/4,k=e(w/B),l=w-k*B;w=4*((K-1-k)*B+l),P[w]=d[j],P[w+1]=d[j+1],P[w+2]=d[j+2],P[w+3]=d[j+3]}if(o.putImageData(L,0,0),n&&md(q,m),F._42(I,F.getDevicePixelRatio()),T&&N){var c=Sg(),Z=c.getContext("2d");return T=T,N=N,sg(c,T,N,1),t.drawImage(Z,X,0,0,T,N),c}return X},toDataURL:function(J,A){var K=this,c=K.getGL();if(K.validate(),J){var q=c.getParameter(c.COLOR_CLEAR_VALUE);md(c,J)}K._42(I,1);var D=K._canvas.toDataURL(A||"image/png",1);return J&&md(c,q),K._42(I,K.getDevicePixelRatio()),D},getGL:function(){var x=this._26I;if(x)return this.acquireProgram(),x;var q=this,o=q._canvas,D=q._attributes;try{x=o.getContext("webgl2",D)||o.getContext("experimental-webgl2",D),x&&(q._webGLVersion=2,q._26I=x)}catch(M){}if(!x)try{x=o.getContext("webgl",D)||o.getContext("experimental-webgl",D)}catch(M){throw new Error("WebGL not supported")}if(!x)throw new Error("WebGL not supported");q._26I=x,q._glExtensions=new F(x),q._glCapabilities=new h(x,q._glExtensions),q._2O={},x._compiledShader={},x._emptyTexture=Wb(x),x._emptyBlendTexture=Wb(x),x._bufPool={},x._id=++uj,q._buffer={vs:zd(x),ns:zd(x),is:zd(x),uv:zd(x),batchColor:zd(x),batchBlend:zd(x),batchBrightness:zd(x),lineDistance:zd(x)},q._1O=Vj(x);var u=q._cube={vs:zd(x),ns:zd(x),is:zd(x),uv:zd(x)};return dh(x,u.vs,ob),dh(x,u.ns,Kb),dh(x,u.uv,Eh),Zn(x,u.is,gk),q.acquireProgram(),x},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var j=this,m=j._26I;if(m){var g=t.getImage(j.getEnvmap()),b=g&&g.tagName?!0:!1,P=j._prg&&j._prg.envMapFlag?!0:!1;if(!j._prg||b!==P){var q=j._prg=m.createProgram();if(!q)return I;q.envMapFlag=b;var A=j._dirs.length,G=j._spots.length,z=j._59O.length,u=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];
A&&u.push("uDirColor","uDirDirection"),G&&u.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),z&&u.push("uPointColor","uPointRange","uPointPosition"),md(m,[0,0,0,0]),m.clearDepth(1),m.enable(m.DEPTH_TEST),m.depthFunc(m.LEQUAL),m.enable(m.BLEND),m.blendFuncSeparate(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.ONE,m.ONE_MINUS_SRC_ALPHA),sb||(rf=Zc(rf.substring(0,rf.indexOf("^#"))),ep=Zc(ep),sb=!0);var E=["#define MAX_DIR "+A,"#define MAX_SPOT "+G,"#define MAX_POINT "+z,j._fogDisabled?"":"#define FOG",j._dashDisabled?"":"#define DASH",b?"#define USE_ENVMAP":"",j.isOrtho()?"#define ORTHOGRAPHIC":"",j._batchColorDisabled?"":"#define BATCHCOLOR",j._batchBlendDisabled?"":"#define BATCHBLEND",j._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),v=Ro(m,q,m.VERTEX_SHADER,rf.replace("PREFIX",E));m.getShaderParameter(v,m.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",m.getShaderInfoLog(v));var X=Ro(m,q,m.FRAGMENT_SHADER,ep.replace("PREFIX",E));m.getShaderParameter(X,m.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",m.getShaderInfoLog(X)),kf?u.push("aPosition"):(q.aPosition=0,m.bindAttribLocation(q,0,"aPosition")),m.linkProgram(q),u.forEach(function(f){q[f]=/^u/.test(f)?m.getUniformLocation(q,f):m.getAttribLocation(q,f)}),m.useProgram(q),m.deleteShader(v),m.deleteShader(X)}}},getBrightness:function(d){var v=d.s("brightness"),x=this.isSelected(d)?d.s("select.brightness"):I;return v==I?x:x==I?v:v*x},setHighlightMode:function(J){var q;q="selection"===J||"selected"===J?bp.Mode.Selection:"mouseover"===J||"hover"===J?bp.Mode.MouseOver:"style"===J?bp.Mode.Style:bp.Mode.Disable;var t=this._highlightHelper.mode;this._highlightHelper.mode=q,this.firePropertyChange("highlightMode",t,q)},getHighlightMode:function(){var W=this._highlightHelper.mode;return W===bp.Mode.Selection?"selected":W===bp.Mode.MouseOver?"hover":W===bp.Mode.Style?"style":"disabled"},getHighlightColor:function(){return this._highlightHelper.color||q["highlight.color"]},setHighlightColor:function(G){var r=this._highlightHelper.color;this._highlightHelper.color=G,this.firePropertyChange("highlightColor",r,G)},getHighlightWidth:function(){return this._highlightHelper.width||q["highlight.width"]},setHighlightWidth:function(E){var e=this._highlightHelper.width;this._highlightHelper.width=E,this.firePropertyChange("highlightWidth",e,E)},bindEnvMap:function(x){var L=this,g=L._prg,B=5,s=L.getEnvmap(),J=t.getImage(s);if(J&&J.tagName){if(s!==L._lastEnvMap){J=t.resizeImagePOT(J,!0),L._envMapTexture&&x.deleteTexture(L._envMapTexture);var w=L._envMapTexture=x.createTexture();x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_CUBE_MAP,w),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,J),x.bindTexture(x.TEXTURE_CUBE_MAP,null),L._lastEnvMap=s}x.activeTexture(x.TEXTURE0+B),x.bindTexture(x.TEXTURE_CUBE_MAP,L._envMapTexture),x.uniform1i(g.uEnvMap,B)}},getWireframe:function(q){var K=q.s("wf.visible"),s=q.s("wf.width");return K===!0||s>0&&"selected"===K&&this.isSelected(q)?{color:q.s("wf.color"),width:s,"short":q.s("wf.short"),mat:q.s("wf.mat")}:void 0},_transformPointToViewSpace:function(t){var U=[t[0],t[1],t[2]];return Tl(U,this._viewMatrix),U},_transformDirectionToViewSpace:function(E,i){var S=[E[0],E[1],E[2]];Tl(S,this._viewMatrix);var W=i?[i[0],i[1],i[2]]:[0,0,0];Tl(W,this._viewMatrix);var f=W[0]-S[0],t=W[1]-S[1],r=W[2]-S[2],G=Math.sqrt(f*f+t*t+r*r);return G?[f/G,t/G,r/G]:[f,t,r]},getWireframeGeometry:function(x){return x.s("wf.geometry")?{color:x.s("wf.color"),width:x.s("wf.width"),mat:x.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(P){return P.s("body.color")},getMat:function(n){return n.getMat?n.getMat():n.s("mat")},getFaceMat:function(q,t){return q.getFaceMat?q.getFaceMat(t):q.s(t+".mat")},getFaceBlend:function(r,o){return r.s(o+".blend")||r.s("all.blend")},getFaceColor:function(s,O){return s.s(O+".color")||s.s("all.color")},getFaceImage:function(j,v){return j.s(v+".image")||j.s("all.image")},getFaceBlendImage:function(E,W){return E.s(W+".blend.image")||E.s("all.blend.image")},getFaceDiscardSelectable:function(b,D){var _=b.s(D+".discard.selectable");return _==I?b.s("all.discard.selectable"):_},getFaceUv:function(C,Z){return C.s(Z+".uv")||C.s("all.uv")},getFaceUvOffset:function(q,K){return q.s(K+".uv.offset")||q.s("all.uv.offset")},getFaceUvScale:function(M,q){return M.s(q+".uv.scale")||M.s("all.uv.scale")},getFaceLight:function(K,W){var X=K.s(W+".light");return X==I?K.s("all.light"):X},getFaceVisible:function(C,Z){var O=C.s(Z+".visible");return O==I?C.s("all.visible"):O},getFaceOpacity:function(d,E){var W=d.s(E+".opacity");return W==I?d.s("all.opacity"):W},getFaceTransparent:function(l,c){var t=l.s(c+".transparent");return t==I?l.s("all.transparent"):t},getFaceReverseColor:function(T,X){return T.s(X+".reverse.color")||T.s("all.reverse.color")},getFaceReverseFlip:function(L,$){var f=L.s($+".reverse.flip");return f==I?L.s("all.reverse.flip"):f},getFaceReverseCull:function(O,p){var M=O.s(p+".reverse.cull");return M==I?O.s("all.reverse.cull"):M},getTextureMap:function(){return this._2O},deleteTexture:function(s){var d=this,k=d._2O[s];k&&(delete d._2O[s],d.getGL().deleteTexture(k))},invalidateCachedTexture:function(r){var x=this.getData3dUI(r);x.invalidateCachedTexture(this.getGL()),this.invalidateData(r)},invalidateShape3dCachedImage:function(Z){this.invalidateCachedTexture(Z)},invalidateCachedGeometry:function(q){var z=this.getData3dUI(q);z.invalidateCachedGeometry(),this.invalidateData(q)},isInteractive:function(I){return I.s("interactive")},getTexture:function(B,k,J){if(!B)return I;var P=this,K=P.getGL(),$=P._2O[B];if(!$){var L=Bn(B),O={mipmapMaxLevel:k?k.s("texture.mipmap.max"):Q};if(!L)return K._emptyTexture;if(L.uuid||(L.uuid=v.Math.generateUUID()),L.tagName){if(L.dynamic)return Vj(K,L,P._1O,O);$=P._2O[B]=Vj(K,L,Q,O)}else{var b,G=k&&(k.s("texture.cache")||k.s("shape3d.image.cache")||L.textureCache),q=P.vr.isPresenting();if(q&&(k._textureUpdateFrame===K._renderInfo.frame?G=!0:k._textureUpdateFrame=K._renderInfo.frame),G&&(b=P.getData3dUI(k),$=b.getCachedTexture(J)),!$){var w=K._renderInfo.textureCache;if(G){if(w.time>t.graph3dMaxVectorCacheTime)return P.redraw(),K._emptyTexture;if(!Kn(L,k))return K._emptyTexture}var N;k&&(1!==k.s("texture.scale")?N=k.s("texture.scale"):1!==k.s("shape3d.texture.scale")&&(N=k.s("shape3d.texture.scale"))),N||(N=1);var S=k&&(k.s("fixSizeOnScreen")||k.s("shape3d.fixSizeOnScreen"));S?"number"==typeof S&&(N*=0>S?1:S):k&&(k.s("vector.dynamic")||k.s("shape3d.vector.dynamic"))&&(b||(b=P.getData3dUI(k)),S=b.getVectorDynamicSize());var l,Y,y,d=k&&k.s("shape3d");"billboard"===d?y=k.getTall()/k.getWidth():"plane"===d&&(y=k.getHeight()/k.getWidth());var f=vk(L,k);if(S){var D=P.getDevicePixelRatio();l=S[0]>0?S[0]*D:N*f*D,Y=S[1]>0?S[1]*D:N*(y?ns(L,k,P,Math.min(4096,f*y)):ns(L,k))*D}else l=N*f,Y=N*(y?ns(L,k,P,Math.min(4096,f*y)):ns(L,k));if(l>=1&&Y>=1){var W=0;(G||q)&&(W=Date.now());var g=qd(l,Y);if(!b&&k&&(b=P.getData3dUI(k)),b&&b.interactiveInfo){var U=B;"object"==typeof U&&(U=U.uuid||(U.uuid=v.Math.generateUUID()));var C=b.interactiveInfo[U]={};g.interactiveInfo=C.bodyInfo={compInfos:[],matrix:new As,rect:{x:0,y:0,width:l,height:Y}}}Kk(g,L,0,0,l,Y,k,P),g.interactiveInfo&&(g.interactiveInfo=null),g.restore(),w.count++,w.pixels+=l*Y;var p=S?K.NEAREST:K.LINEAR;O.minFilter=k.s("texture.filter.min")||k.s("texture.filter")||p,O.magFilter=k.s("texture.filter.mag")||k.s("texture.filter")||p,G||q?($=Vj(K,sm,null,O),b.setCachedTexture($,J),w.time+=Date.now()-W,sm=null):$=Vj(K,sm,P._1O,O)}}}}return $},redraw:function(){this.iv()},validateImpl:function(){var w=this;if(w._lightChanged){w._lightChanged=!1;var a=[],U=[],E=[];w.dm().each(function(V){if(Nk(V)){var D=V.s("light.type");D===ro?a.push(V):D===xb?U.push(V):D===bg&&E.push(V)}}),(a.length!==w._59O.length||U.length!==w._spots.length||E.length!==w._dirs.length)&&Bf(w),w._59O=a,w._spots=U,w._dirs=E}w._42(),w._1o.iv()},getRenderInfo:function(){var W=this.getGL();return W?W._renderInfo:void 0},getDebugTip:function(){var n=this,s=n.getRenderInfo();if(s){var p=n.getGL()._validBufCount||0,$="Draw Calls: "+s.calls+"<br/>"+"Vertices: "+s.vertices+"<br/>"+"Faces: "+s.faces+"<br/>"+"Lines: "+s.lines+"<br/>"+"Buffers: "+p+"<br/>"+"Cache Models: "+Y.keys(Nr).length+"<br/>"+"Shape3d Models: "+Y.keys(Qr).length;n.vr.isPresenting()&&($+="<br/>VR fps: "+n.vr.getFps());var y=s.textureCache.count;if($+="<br/>2D Dynamic Textures: "+s.textureCache.count,y>0){var q,t=s.textureCache.pixels;q=t>1e6?Math.round(t/1e6)+"M":t>1e3?Math.round(t/1e3)+"K":Math.round(t),$+="<br/>2D Dynamic pixels: "+q}return $}},_42:function(z,n){var P=this;if(!P._35O&&(!Cd||wd(Cd))){var c,b;z&&(z instanceof Mh?b=z:c=z);var O=P._canvas,w=P.getGL(),y=P._prg;if(w){var i=P.getWidth(),a=P.getHeight();if(i&&a){n?z||sg(O,i,a,n):(n=P.getDevicePixelRatio(),z||i===O.clientWidth&&a===O.clientHeight||(sg(O,i,a,n),i&&Math.abs(w.drawingBufferWidth-i*n)>1&&(P.setDevicePixelRatio(n=w.drawingBufferWidth/i),sg(O,i,a,n)))),w.clear(w.COLOR_BUFFER_BIT),P.drawFilter||(w._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:z?P._frameId:++P._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var Y,W=this._cameras,j=0,U=W.length,C=!1,l=v.Default.cameraPriority.skybox,f=v.Default.cameraPriority.main,J=v.Default.cameraPriority.top,H=i*n,K=a*n,g=function(){P.overlappingBox.clear(),P._81O=I,w.clear(w.DEPTH_BUFFER_BIT),w._picking=!!z;var O={_picking:!!z,_envmapReflectivity:P._envmapReflectivity||.5,_projectMatrix:P._projectMatrix=jb(P),_viewMatrix:Gq(P,P._7O)};if(P._viewMatrix=no(P._7O),b){Ap(w,P,y,O);var X=w.getParameter(w.COLOR_CLEAR_VALUE);w.clearColor(0,0,0,0),w.disable(w.BLEND),Fo(w,y.aNormal),dh(w,P._cube.vs,I,y.aPosition),Zn(w,P._cube.is),Zi(b,P,Hd,0),Zi(b,P,Tk,6),Zi(b,P,Np,12),Zi(b,P,Mn,18),Zi(b,P,hq,24),Zi(b,P,Ce,30),mc(w,y.aNormal),md(w,X)}else if(c){for(c.value=2;U>j;j++)if(Y=W[j],!Y.ignoreInPick){if(Y.priority>=f)break;Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P,c)}Ap(w,P,y,O);var X=w.getParameter(w.COLOR_CLEAR_VALUE);for(w.clearColor(0,0,0,0),w.disable(w.BLEND),P._95I(w,y,c),Ek(P,c),ge(P,P._polylineModelMap,c),ge(P,P._wireframeModelMap,c),ac(w,y.uTransparent,!0),P._95I(w,y,c,!0),Ek(P,c,!0),ge(P,P._polylineModelMap,c,!0),ge(P,P._wireframeModelMap,c,!0),ac(w,y.uTransparent,!1);U>j;j++)if(Y=W[j],!Y.ignoreInPick){if(Y.priority>=J)break;Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P,c),C=!0}for(C&&(Ap(w,P,y,O),C=!1),w.clear(w.DEPTH_BUFFER_BIT),P._swapLineMap(),P._95I(w,y,c,!1,!0),ge(P,P._polylineModelMap,c),ge(P,P._wireframeModelMap,c),P._swapLineMap(),P._swapLineMap(),P._95I(w,y,c,!1,!0),ge(P,P._polylineModelMap,c),ge(P,P._wireframeModelMap,c),ac(w,y.uTransparent,!0),P._95I(w,y,c,!0,!0),ge(P,P._polylineModelMap,c,!0),ge(P,P._wireframeModelMap,c,!0),ac(w,y.uTransparent,!1),P._swapLineMap(),w.disable(w.DEPTH_TEST),P.drawFilter||P._30O._42(w,y,c),w.enable(w.DEPTH_TEST);U>j;j++)Y=W[j],Y.ignoreInPick||(Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P,c));md(w,X)}else{for(;U>j&&(Y=W[j],!(Y.priority>=l));j++)Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P);for(Ap(w,P,y,O),w.disable(w.BLEND),P.drawSky(w,y),P.drawReflectors(w,H,K,g,z)&&(O._projectMatrix=P._projectMatrix=jb(P),O._viewMatrix=Gq(P,P._7O),P._viewMatrix=no(P._7O),Ap(w,P,y,O));U>j&&(Y=W[j],!(Y.priority>=f));j++)Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P),C=!0;for(C&&(Ap(w,P,y,O),C=!1),P._31O._42(w,y),P._95I(w,y),Ek(P),ge(P,P._polylineModelMap),ge(P,P._wireframeModelMap),w.enable(w.BLEND),w.depthMask(!1),ac(w,y.uTransparent,!0),P._95I(w,y,I,!0),Ek(P,I,!0),ge(P,P._polylineModelMap,I,!0),ge(P,P._wireframeModelMap,I,!0),w.depthMask(!0),ac(w,y.uTransparent,!1);U>j&&(Y=W[j],!(Y.priority>=J));j++)Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P),C=!0;for(C&&(Ap(w,P,y,O),C=!1),w.clear(w.DEPTH_BUFFER_BIT),P._swapLineMap(),w.disable(w.BLEND),P._95I(w,y,I,!1,!0),ge(P,P._polylineModelMap),ge(P,P._wireframeModelMap),w.enable(w.BLEND),ac(w,y.uTransparent,!0),w.depthMask(!1),P._95I(w,y,I,!0,!0),ge(P,P._polylineModelMap,I,!0),ge(P,P._wireframeModelMap,I,!0),w.depthMask(!0),ac(w,y.uTransparent,!1),P._swapLineMap(),w.disable(w.DEPTH_TEST),w.disable(w.BLEND),P._32O._42(w,y),P._30O._42(w,y),P._highlightHelper._42(w,y),w.enable(w.DEPTH_TEST);U>j;j++)Y=W[j],Y.useDefaultProgram&&Ap(w,P,y,O),Y.render(w,P)}dh(w,I),Zn(w,I)},r=!1,x=P.vr;x.enable&&x._42(w,H,K,g)&&(r=!0);var T=P.envRenderer;T&&T.enable&&T._42(w,H,K,g)&&(r=!0);var s=P._postProcessing;s._42(w,H,K,g,z)&&(r=!0),r||(P.setViewport(w,0,0,i*n,a*n),g()),P._33Q=!1,P.drawFilter||P.countFrame(),P._doBufferGC(w)}}}},drawReflectors:function(L,d,x,h,Q){L._renderInfo.reflectDepth++;var k,j,b,y=this,N=y._dataModel.getReflectors(),D=!1;for(k in N)j=N[k],y.isVisible(j)&&(b=y.getData3dUI(j),b&&b.drawReflector(L,d,x,h,Q)&&(D=!0));return L._renderInfo.reflectDepth--,D},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(F,f){return this._postProcessing.enableModule(F,f)},getPostProcessingModule:function(s){return this._postProcessing.getModule(s)},getPostProcessingValue:function(M,l){var n=this._postProcessing.getModule(M);return n?n[l]:Q},setPostProcessingValue:function(s,j,i){var g=this.getPostProcessingValue(s),Q=this._postProcessing.getModule(s,j);Q&&g!==i&&("enable"===j?this.enablePostProcessing(s,i):Q[j]=i,this.firePropertyChange("postProcessing."+s+"."+j,g,i))},setViewport:function(p,m,K,o,d){this._viewport=[m,K,o,d],p.viewport(m,K,o,d)},getViewport:function(){return this._viewport},setBufferGCInterval:function(L){this._bufferGCInterval=L},_doBufferGC:function(n,g){var k,N,G=n._bufPool,B=0,U=0,P=n._renderInfo.frame,Q=this._bufferGCInterval||10;for(k in G)B++,N=G[k],N&&(g||P-N._fid>Q?(n.deleteBuffer(N._buf),N._buf=null,G[k]=null):U++);if(B/2>U&&B>128){var X={};for(k in G)G[k]&&(X[k]=G[k]);n._bufPool=X}n._validBufCount=U},_swapLineMap:function(){var M=this;je=M._polylineModelMap,M._polylineModelMap=M._polylineModelMapSwap,M._polylineModelMapSwap=je,je=M._wireframeModelMap,M._wireframeModelMap=M._wireframeModelMapSwap,M._wireframeModelMapSwap=je,je=M._polylineIndexMap,M._polylineIndexMap=M._polylineIndexMapSwap,M._polylineIndexMapSwap=je,je=M._wireframeIndexMap,M._wireframeIndexMap=M._wireframeIndexMapSwap,M._wireframeIndexMapSwap=je},_updateSkyBox:function(N){if(this._skyBox&&N){var L=N.property,z=!1,e=this._skyBox;if("eye"===L||"forceUpdate"===L){var m=this._eye;e.p3(m[0],m[1],m[2]),z=!0}if("near"===L||"far"===L||"forceUpdate"===L){var $=this._near,k=this._far,h=e.getFinalScale3d();if(h[0]/=2,h[1]/=2,h[2]/=2,h[0]<=$||h[0]>=k||h[1]<=$||h[1]>=k||h[2]<=$||h[2]>=k){var W=2*$*k/($+k),u=Math.min(h[0],h[1],h[2]),r=W/u,Y=e.getScale3d();e.setScale3d(Y[0]*r,Y[1]*r,Y[2]*r),z=!0}}z&&this.invalidateData(e)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(n){var t=this._skyBox;t&&(this._skyBoxStyleMap&&t.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&t.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&t.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=n,this.ump(this._updateSkyBox,this),n&&(n.dm()&&n.dm().remove(n),this._skyBoxStyleMap=v.Default.clone(n.getStyleMap()),this._skyBoxAnchor3d=n.getAnchor3d(),n.setAnchor3d(.5,.5,.5),this._skyBoxP3=n.p3().slice(0),n.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",t,n)},drawSky:function(v,_,H){var z=this,f=z._skyBox;if(f){var h=z._headlightIntensity,Z=An(z._headlightColor),_=z._prg;1!==h&&(Z=[Z[0]*h,Z[1]*h,Z[2]*h]),ac(v,_.uHeadlightColor,[Z[0],Z[1],Z[2],1]);var e=z.getData3dUI(f);if(e){var t,j=z.isOrtho(),Q=j||this._computedProjectMatrix;Q&&(t=z._projectMatrix,j&&(z._ortho=!1),ac(v,_.uPMatrix,z._projectMatrix=jb(z,!0)));var W=f.p3(),C=this._eye;(W[0]!==C[0]||W[1]!==C[1]||W[2]!==C[2])&&(f._position.x=C[0],f._54O=C[1],f._position.y=C[2]),e._42(v,_,H,function(){return!0}),Q&&(j&&(z._ortho=!0),ac(v,_.uPMatrix,z._projectMatrix=t))}v.clear(v.DEPTH_BUFFER_BIT),ac(v,_.uHeadlightColor,[Z[0],Z[1],Z[2],z._headlightDisabled?1:0])}},_95I:function(r,w,K,V,z){function Y(N){if(!(!N.s("alwaysOnTop")&&!N.s("shape3d.alwaysOnTop"))==!!z&&f.isVisible(N)&&(!d||u)){if(!K&&f.isTransparentMask(N))return;var x=f.getData3dUI(N);x&&x._42(r,w,K,q)}}var f=this,q=function(t){return V?t:!t};f.sky&&r.clear(r.DEPTH_BUFFER_BIT);var j=f.drawFilter;j?f.dm().each(function(L){j(L)||Y(L)}):f.dm().each(function(N){Y(N)})},getLogicalPoint:function(D){return pq(D,this._canvas)},isRectOverlapping:function(B){var S=this.getData3dUI(B);return S._rectOverlapping},getHitFaceInfo:function(l){l.target&&(l=this.lp(l));var m=this.getDataInfoAt(l);if(m){var z=this._1o.face(m.data,Lk(l.x,l.y));if(z)return{data:m.data,face:z}}return I},unproject:function(D,w){var L=this,f=L.getWidth(),G=L.getHeight(),s=D.target?L.lp(D):D,c=s.x-f/2,B=s.y-G/2,o=2*(c/f),U=2*(-1*B/G);w=w||0;var E=Tf(),i=jb(L),K=Gq(L);Xb(E,i,K),Ve(E);var q=Nc([o,U,w,1],E);return[q[0]/q[3],q[1]/q[3],q[2]/q[3]]},getDataAt:function(x){var f=this.getDataInfoAt(x);return f?f.data:I},getDataInfoAt:function(o,W){return o.target&&(o=this.lp(o)),this._1o.get(Lk(o.x,o.y,W),!0)},getDatasInRect:function($){return this._1o.get($)},setEditable:function(E){var S=this,q=S._editable;S._editable=E,this.fp(Jo,q,E)},isEditable:function(D){var g=this;return g._editable?Fg(D)?D.s("3d.editable")?g._editableFunc?g._editableFunc(D):!0:!1:!1:!1},isSelectable:function(T){return T.s("3d.selectable")&&this.sm().isSelectable(T)},isMovable:function(O){var y=this;return Xm(O)&&O.getStyle(Cr)!==Ar?!1:O.s("3d.movable")?y._movableFunc?y._movableFunc(O):!0:!1},isSizeEditable:function(I){return Fg(I)?this._sizeEditableFunc?this._sizeEditableFunc(I):!0:!1},isRotationEditable:function(w){return Fg(w)&&w.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(w):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(Z){this.setZoom(uh,Z)},zoomOut:function(O){this.setZoom(1/uh,O)},setZoom:function(){var H=new He,s=new He,F=new He,b=new He;return function(e,v){if(1!==e){var x=this;x._14o&&x._14o.stop(!0);var S,O=1/e;H.copy(x.getCenter()),s.copy(x.getEye());var D=x._ortho;if(D){if(S=x._orthoWidth,S<x._moveStep&&e>1)return}else if(H.distanceTo(s)<x._moveStep&&1>O)return;var c=!1;return x._zoomToCenter===!1&&x._lastZoomLP&&(F.copy(s).sub(H).normalize(),x._81O=null,b.copy(x.getHitPosition(x._lastZoomLP,H.toArray(),F.toArray())),c=!0,x._lastZoomHit=b),(v=Rc(v))?(v.action=function(d){x.fi({kind:x._zooming?"betweenZoom":"beginZoom"}),x._zooming=1;var _=(O-1)*d+1;D&&x.setOrthoWidth(S*_),c?(x.setEye(F.lerpVectors(b,s,_).toArray()),x.setCenter(F.lerpVectors(b,H,_).toArray())):D||x.setEye(F.lerpVectors(H,s,_).toArray())},v._37o=function(){delete x._14o,delete x._zooming,x.fi({kind:"endZoom"}),x.onZoomEnded()},x._14o=qh(v)):(D&&x.setOrthoWidth(S*O),c?(x.setEye(F.lerpVectors(b,s,O).toArray()),x.setCenter(F.lerpVectors(b,H,O).toArray())):D||x.setEye(F.lerpVectors(H,s,O).toArray()),void 0)}}}(),setOrthoZoom:function(J,B){return this.setZoom(J,B)},getPositionInfo:function(i){var F=this,R=F._eye,s=F._center,p=F.getAspect(),W=i?nn(Ti(s,R,!0),Ti(i,R)):Oj(R,s);if(F._ortho){var G=F._orthoWidth;return{length:W,height:G/p,width:G}}var q=2*_(F._fovy/2)*W;return{length:W,height:q,width:q*p}},getCenterInfo:function(){var C=this;return C._81O||(C._81O=C.getPositionInfo()),Gk(C._81O)},rotate:function(s,H,T,n){var t=this;if(s||H){n==I&&(n=t._firstPersonMode),t._88O&&t._88O.stop(!0);var O=t._center,q=t._eye,h=t.getCenterInfo().length,X=n?O:q,Y=n?q:O,w=Ti(X,Y),F=$(w[0],w[2]),P=$(K(w[0]*w[0]+w[2]*w[2]),w[1]),S=n?dn:Tm;return n&&(H=-H),(T=Rc(T))?(T.action=function(d){t.fi({kind:t._rotating?"betweenRotate":"beginRotate"}),t._rotating=1;var u=F+s*d,V=P+H*d;V=n?k-vg(k-V):vg(V),w[0]=h*C(V)*C(u),w[1]=h*x(V),w[2]=h*C(V)*x(u),X[0]=Y[0]+w[0],X[1]=Y[1]+w[1],X[2]=Y[2]+w[2],t.fp(S,I,X)},T._37o=function(){delete t._88O,delete t._rotating,t.fi({kind:"endRotate"}),t.onRotateEnded()},t._88O=qh(T)):(F+=s,P+=H,P=n?k-vg(k-P):vg(P),w[0]=h*C(P)*C(F),w[1]=h*x(P),w[2]=h*C(P)*x(F),X[0]=Y[0]+w[0],X[1]=Y[1]+w[1],X[2]=Y[2]+w[2],t.fp(S,I,X),void 0)}},pan:function(S,h,T,p){if(S||h){var f=this;p==I&&(p=f._firstPersonMode),f._89O&&f._89O.stop(!0);var g=Gq(f),w=[g[0]*S,g[4]*S,g[8]*S],q=[g[1]*h,g[5]*h,g[9]*h],z=w[0]+q[0],M=w[1]+q[1],B=w[2]+q[2],_=f._center,b=f._eye;if(p){var k=Lg(f.getBoundaries(),b[0],b[2],b[0]+z,b[2]+B,K(z*z+B*B));z=k[0],B=k[1]}if(T=Rc(T)){var u=Gk(b),d=Gk(_);return T.action=function(g){f.fi({kind:f._panning?"betweenPan":"beginPan"}),f._panning=1,_[0]=d[0]+z*g,_[1]=d[1]+M*g,_[2]=d[2]+B*g,b[0]=u[0]+z*g,b[1]=u[1]+M*g,b[2]=u[2]+B*g,f.fp(Tm,I,b),f.fp(dn,I,_)},T._37o=function(){delete f._89O,delete f._panning,f.fi({kind:"endPan"}),f.onPanEnded()},f._89O=qh(T)}_[0]+=z,_[1]+=M,_[2]+=B,b[0]+=z,b[1]+=M,b[2]+=B,f.fp(Tm,I,b),f.fp(dn,I,_)}},walk:function(l,b,U){if(l){var X=this;U==I&&(U=X._firstPersonMode),X._90O&&X._90O.stop(!0);var P=X._center,d=X._eye,u=Ti(P,d,!0);if(U){var W=Lg(X.getBoundaries(),d[0],d[2],d[0]+u[0]*l,d[2]+u[2]*l,H(l));if(l=Oj(W),!l)return;u=[W[0]/l,0,W[1]/l]}if(b=Rc(b)){var g=Gk(d),A=Gk(P);return b.action=function(j){X.fi({kind:X._walking?"betweenWalk":"beginWalk"}),X._walking=1;var Y=l*j;d[0]=g[0]+u[0]*Y,d[1]=g[1]+u[1]*Y,d[2]=g[2]+u[2]*Y,P[0]=A[0]+u[0]*Y,P[1]=A[1]+u[1]*Y,P[2]=A[2]+u[2]*Y,X.fp(Tm,I,d),X.fp(dn,I,P)},b._37o=function(){delete X._90O,delete X._walking,X.fi({kind:"endWalk"}),X.onWalkEnded()},X._90O=qh(b)}d[0]+=u[0]*l,d[1]+=u[1]*l,d[2]+=u[2]*l,P[0]+=u[0]*l,P[1]+=u[1]*l,P[2]+=u[2]*l,X.fp(Tm,I,d),X.fp(dn,I,P)}},handleScroll:function(T,p){T.preventDefault();var j=this,V=j._moveStep,f=j.getDataInfoAt(T);if(f){var e=f.data;if(e&&j.isInteractive(e)){var z=j.intersectObject(T,e);if(z){var u=z.part,Z=Bn(e.s(u+".image")||e.s("shape3d."+u+".image")||e.s("all.image")||e.s("shape3d.image"));if(Z&&Nq(Z.scrollable,e,j))return}}}return j.isFirstPersonMode()?(j.isPannable()&&j.pan(0,p>0?V:-V),void 0):(j.isZoomable()&&(j._lastZoomLP=j.lp(T),j.setZoom(0>p?1/zn:zn),j._lastZoomLP=j._lastZoomHit=null),void 0)},handlePinch:function(B,t){this.isZoomable()&&this.setZoom(t>B?1/Uh:Uh)},reset:function(){this.setCenter(t.graph3dViewCenter),this.setEye(t.graph3dViewEye),this.setUp(t.graph3dViewUp)},moveSelection:function($,h,R){var e=this;e.dm().beginTransaction(),Je(this.sm().toSelection(this.isMovable,this),$,h,R),e.dm().endTransaction()},getMoveMode:function(z,U){var a=U.s("3d.move.mode");if(a)return a;var R="88",i="89",p="90";return Kh(z)||Le[R]&&Le[i]&&Le[p]?"xyz":Le[R]&&Le[i]?"xy":Le[R]&&Le[p]?"xz":Le[i]&&Le[p]?"yz":Le[R]?"x":Le[i]?"y":Le[p]?"z":"xz"},handleTick:function(){var G=this,P=!1,L=G._moveStep,M=L,k=!1,z=!0,t=G._rotateStep*(z?-1:1);if(G.isWalkable()||(M=0),G.isPannable()||(L=0),G.isRotatable()||(t=0),G._32Q){var S=(Fc()-G._32Q)/50;M*=S,L*=S,t*=S}G._31Q&&(hr(G._31Q),delete G._31Q,delete G._32Q),Bi()&&(P=!0,G.pan(-L,0,k,z)),qc()&&(P=!0,G.pan(L,0,k,z)),Iq()&&(P=!0,Kh()?G.pan(0,L,k,z):G.walk(M,k,z)),Ud()&&(P=!0,Kh()?G.pan(0,-L,k,z):G.walk(-M,k,z)),Zo()&&(P=!0,G.rotate(-t,0,k,z)),ip()&&(P=!0,G.rotate(t,0,k,z)),dk()&&(P=!0,G.rotate(0,-t/2,k,z)),nr()&&(P=!0,G.rotate(0,t/2,k,z)),P&&(G._32Q=Fc(),G._31Q=ve(G.handleTick,G))},handleKeyDown:function(F){var j=this;!Ic(F)&&$e[F.keyCode]?j.handleTick():Fq(F)?j.selectAll():wq(F)?j.handleDelete(F):vp(F)&&this.isResettable()&&j.reset()},checkDoubleClickOnNote:function(i,j,d){var p=this;if(d===vd){if(j.s("note.toggleable"))return j.s(an,!j.s(an)),p.fi({kind:"toggleNote",event:i,data:j,part:d}),!0}else if(d===Lq&&j.s("note2.toggleable"))return j.s(ch,!j.s(ch)),p.fi({kind:"toggleNote2",event:i,data:j,part:d}),!0;return!1},checkDoubleClickOnRotation:function(u,j,d){return d===Cf?(j.setRotationX(0),!0):d===Wj?(j.setRotationY(0),!0):d===ar?(j.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(X){var b=this;if(b.isOrtho())return b.getWidth()/b.getOrthoWidth();var I=b.getCenter(),f=b.getHeight(),z=b.getEye(),w=[I[0]-z[0],I[1]-z[1],I[2]-z[2]],q=[X[0]-z[0],X[1]-z[1],X[2]-z[2]],s=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]),P=1/Math.tan(b.getFovy()/2);return f*s*P/(q[0]*w[0]+q[1]*w[1]+q[2]*w[2])},inViewSpace:function(Z){var h,P=this,v=P._transformPointToViewSpace(Z),y=P.getAspect(),m=P.getNear(),c=P.getFar();return-v[2]<m||-v[2]>c?!1:P.isOrtho()?(h=P.getOrthoWidth()/2,Math.abs(v[0])<=h&&Math.abs(v[1]*y)<=h):(h=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*Math.tan(P.getFovy()/2),Math.abs(v[1]<=h)&&Math.abs(v[0])<=h*y)},getPVMatrix:function(){var v=this,N=v.getWidth()/2,$=v.getHeight()/2,D=v._18Q;return D&&D._wh===N/$||(D=jb(v),v._18Q=Xb(D,D,Gq(v)),v._18Q._wh=N/$),D},getFrustum:function(){var C=new _i,P=new Kq,z=new Array(16);return function(){for(var $=this.getPVMatrix(),u=!1,Q=0;16>Q;Q++)$[Q]!==z[Q]&&(u=!0,z[Q]=$[Q]);return u&&P.setFromMatrix(C.fromArray($)),P}}(),toViewPosition:function(W){var K=this,Z=K.getWidth()/2,U=K.getHeight()/2,l=K.getPVMatrix();return W=Nc([W[0],W[1],W[2],1],l),{x:Z+Z*W[0]/W[3],y:U-U*W[1]/W[3],z:W[2]/W[3]}},getHitPosition:function(O,L,V){var i=this,X=i.getWidth(),s=i.getHeight(),k=O.target?i.lp(O):O,Q=k.x-X/2,$=k.y-s/2,M=i.getCenterInfo(),P=Gq(i);L=L?L:[0,0,0],V=V?V:[0,1,0],Q=Q/X*M.width,$=-1*$/s*M.height;var w=[P[0]*Q,P[4]*Q,P[8]*Q],H=[P[1]*$,P[5]*$,P[9]*$],f=[w[0]+H[0],w[1]+H[1],w[2]+H[2]],K=i.getCenter(),W=Mm(i,L,V,[f[0]+K[0],f[1]+K[1],f[2]+K[2]]);return W?W:[0,0,0]},intersectObject:function(G,h){return this._raycaster.intersectObject(G,h)},intersectObjects:function(s,$,b){return this._raycaster.intersectObjects(s,$,b)},getLineLength:function(L){this.validate();var w=this.getData3dUI(L);if(w&&w.getCache){var s=w.getCache();if(s)return s[s.length-1].length}return 0},getLineOffset:function(c,H){var h=this.getData3dUI(c);if(h&&h.getCache){var w=h.getCache();if(w){var s=te(w,H);if(!c.r3)return s;var F=c.r3();if(0===F[0]&&0===F[1]&&0===F[2])return s;var X=new He(c.p3()),x=new He(s.point).sub(X),T=new He(s.tangent).add(x),i=(new Bb).setFromEuler(new Sr(F,c.getRotationMode(),!0));return x.applyQuaternion(i),T.applyQuaternion(i),{point:x.add(X),tangent:T.sub(x).normalize()}}}return I},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(m,z,V){var v=this,X=v.getEye();X=[X[0],X[1],X[2]];var u=v.getCenter();if(u=[u[0],u[1],u[2]],m||(m=X),z||(z=u),v._flyAnim&&v._flyAnim.stop(!0),V=Rc(V),!V)return v.setEye(m[0],m[1],m[2]),v.setCenter(z[0],z[1],z[2]),delete v._flyAnim,!0;var p=[m[0]-X[0],m[1]-X[1],m[2]-X[2]],r=[z[0]-u[0],z[1]-u[1],z[2]-u[2]];return V.action=function(g){v.setCenter(u[0]+r[0]*g,u[1]+r[1]*g,u[2]+r[2]*g),v.setEye(X[0]+p[0]*g,X[1]+p[1]*g,X[2]+p[2]*g)},V._37o=function(){delete v._flyAnim},v._flyAnim=qh(V)},flyTo:function(){function C(D,p,E){if(E instanceof v.Node){i.fromArray(vh(E,p.getMat(E)));var u=E.getAnchor3d();D.push((new He).set(0-u.x,0-u.y,0-u.z).applyMatrix4(i)),D.push((new He).set(0-u.x,0-u.y,1-u.z).applyMatrix4(i)),D.push((new He).set(0-u.x,1-u.y,0-u.z).applyMatrix4(i)),D.push((new He).set(0-u.x,1-u.y,1-u.z).applyMatrix4(i)),D.push((new He).set(1-u.x,0-u.y,0-u.z).applyMatrix4(i)),D.push((new He).set(1-u.x,0-u.y,1-u.z).applyMatrix4(i)),D.push((new He).set(1-u.x,1-u.y,0-u.z).applyMatrix4(i)),D.push((new He).set(1-u.x,1-u.y,1-u.z).applyMatrix4(i))}}var O=new He,S=new He,a=new He,w=new He,i=new _i,G=new v.Math.Quaternion,A=new Sr;return function(p,R,m){var H=this;if(m!==Q)R={animation:R,ratio:m};else{var l=typeof R;("boolean"===l||"object"===l&&R.duration)&&(R={animation:R})}R=R||{},O.fromArray(H.getEye()),S.fromArray(H.getCenter());var b,u,T=[],V=R.center,y=R.distance===Q;if(V&&a.fromArray(V),p instanceof v.Node)V||a.fromArray(p.p3()),y&&(C(T,H,p),b=T.length);else{if(p||(p=H.dm().getDatas()),!p.length)return;if((y||!V)&&(T=[],p.forEach(function(j){C(T,H,j)}),b=T.length,!b))return;if(!V){for(a.set(0,0,0),u=0;b>u;u++)a.add(T[u]);a.multiplyScalar(1/b)}}if(H.setCenter(a.x,a.y,a.z),w.subVectors(O,S),R.direction||R.worldDirection){!R.worldDirection&&p instanceof v.Node?G.setFromEuler(A.set(p.r3(),p.getRotationMode(),!0)):G.set(0,0,0,1);var e=w.length();w.fromArray(R.worldDirection||R.direction).applyQuaternion(G).setLength(e)}var t=0;if(y){var J,r,q,m=R.ratio||.8,I=R.xRatio||m,P=R.yRatio||m;if(H.isOrtho()){var j=-1/0;for(H._eye[0]=w.x+a.x,H._eye[1]=w.y+a.y,H._eye[2]=w.z+a.z,J=jb(H),Xb(J,J,Gq(H)),u=0;b>u;u++)q=T[u],r=Nc([q.x,q.y,q.z,1],J),j=Math.max(j,Math.max(Math.abs(r[0])/I,Math.abs(r[1])/P));t=H.getOrthoWidth()*j,w.add(a)}else{for(var W,f,M=H.getNear(),Z=10;Z--;){for(H._eye[0]=w.x+a.x,H._eye[1]=w.y+a.y,H._eye[2]=w.z+a.z,J=jb(H),Xb(J,J,Gq(H)),W=!0,f=-1/0,u=0;b>u;u++){if(q=T[u],r=Nc([q.x,q.y,q.z,1],J),r[3]<M&&Z){w.multiplyScalar(2),W=!1;break}f=Math.max(f,Math.max(Math.abs(r[0])/I,Math.abs(r[1])/P)-r[3])}if(W)break}w.setLength(f+w.length()).add(a)}}else w.setLength(R.distance).add(a);H._flyAnim&&H._flyAnim.stop(!0);var d=Rc(R.animation);if(d){H.setEye(O.x,O.y,O.z),H.setCenter(S.x,S.y,S.z);var L=(new He).subVectors(w,O),k=(new He).subVectors(a,S);if(t)var c=H.getOrthoWidth();var D=new He,E=new He,U=d.action,B=d._37o;return d.action=function(g,y){D.copy(O).addScaledVector(L,g),E.copy(S).addScaledVector(k,g),H.setCenter(E.x,E.y,E.z),H.setEye(D.x,D.y,D.z),t&&H.setOrthoWidth((t-c)*g+c),U&&U(g,y)},d._37o=function(){delete H._flyAnim,B&&B()},{lastEye:O,lastCenter:S,eye:w,center:a,orthoWidth:t,animation:H._flyAnim=qh(d)}}return H.setEye(w.x,w.y,w.z),t&&H.setOrthoWidth(t),delete H._flyAnim,{lastEye:O,lastCenter:S,eye:w,center:a,orthoWidth:t}}}(),getBoundingBox:function(){function c(X,B,L){x.fromArray(vh(L,B.getMat(L)));var y=L.getAnchor3d();X.push((new He).set(0-y.x,0-y.y,0-y.z).applyMatrix4(x)),X.push((new He).set(0-y.x,0-y.y,1-y.z).applyMatrix4(x)),X.push((new He).set(0-y.x,1-y.y,0-y.z).applyMatrix4(x)),X.push((new He).set(0-y.x,1-y.y,1-y.z).applyMatrix4(x)),X.push((new He).set(1-y.x,0-y.y,0-y.z).applyMatrix4(x)),X.push((new He).set(1-y.x,0-y.y,1-y.z).applyMatrix4(x)),X.push((new He).set(1-y.x,1-y.y,0-y.z).applyMatrix4(x)),X.push((new He).set(1-y.x,1-y.y,1-y.z).applyMatrix4(x))}var x=new _i;return function(o){if(o=o||this.sm().getSelection(),o instanceof v.Node&&(o=[o]),0===o.length)return I;var z=[];o.forEach(function(N){c(z,this,N)},this);var l=[1/0,1/0,1/0],L=[-1/0,-1/0,-1/0];return z.forEach(function(F){l[0]=Math.min(F.x,l[0]),l[1]=Math.min(F.y,l[1]),l[2]=Math.min(F.z,l[2]),L[0]=Math.max(F.x,L[0]),L[1]=Math.max(F.y,L[1]),L[2]=Math.max(F.z,L[2])}),{min:l,max:L}}}()}),Pm.RenderEnv=function(H){this.gv=H,this.enable=!1},Y.defineProperties(Pm.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(d){this._debugOn=d,this.capture&&this.capture()}}}),Y.assign(Pm.RenderEnv.prototype,{renderEnvToCube:function(U,W,h,y){var c=this,n=c.gv;if(!U||!W||!h)return c.enable=!1,c._42=null,void 0;c.enable=!0;var S=Math.floor(y/U*W),A=n.getGL(),q=c._renderTargets;q?q.length<h&&(q=c._renderTargets=q.concat(new Array(h-q.length))):q=c._renderTargets=new Array(h);for(var V=0;h>V;V++)q[V]?q[V].setSize(A,y,S):q[V]=new Pm.RenderTarget(n,A,y,S);var t=!1;c.capture=function(){t=!0,n._42(),t=!1};var F=new He,v=new He,g=new He,o=new He,e=(new He).setY(0),B=2*Math.PI/h,J=U/2/Math.tan(Math.PI/h),K=2*Math.atan2(W/2,J),E=U/W;
c._42=function(A,V,i,y){var Z=c._debugOn;if(!t&&!Z)return!1;F.copy(n.getEye()),o.copy(n.getCenter()).sub(F);var S=Math.atan2(o.z,o.x),C=n.getNear(),L=n.getFovy(),O=n.getAspect();v.copy(n.getCenter());for(var M,I=0;h>I;I++)if(M=q[I],e.setZ(Math.cos(S)).setX(Math.sin(S)).multiplyScalar(J),S-=B,g.addVectors(F,e),n.setNear(J),n.setCenter([g.x,g.y,g.z]),n.setFovy(K),n.setAspect(E),Z){var X=Math.round(V/h);A.viewport(X*I,0,X,i),y()}else pf(A,M.frame),A.viewport(0,0,M.width,M.height),A.clear(A.COLOR_BUFFER_BIT),y(),Sj(A),M.assureTexture();return n.setNear(C),n.setCenter([v.x,v.y,v.z]),n.setFovy(L),n.setAspect(O),!0},c.capture()},getTextureInfo:function(v){var V=this._renderTargets;if(!V)return null;var K=this._renderTargets[v];return K?{index:v,texture:K.texture,textureName:K.uuid}:null}}),Y.assign(Pm.Graph3dView.prototype,{renderEnvToCube:function(u,f,S,y){var h=this;h.envRenderer||(h.envRenderer=new Pm.RenderEnv(h)),h.envRenderer.renderEnvToCube(u,f,S,y)}}),Pm.RenderTarget=function(k,x,S,U,T){var s=this;T=T||{},T.samples=Math.min(k._glCapabilities.maxSamples,T.samples&&T.samples>1&&2===k._webGLVersion?T.samples:0),s.options=T,s.uuid=v.Math.generateUUID(),s.gv=k,s.init(k,x,T),T.samples&&!k._glCapabilities._maxSamplesChecked?s.setSize(x,S||1,U||1):s.setSize(x,S,U)},Y.assign(Pm.RenderTarget.prototype,{bind:function(Y){pf(Y,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(n){Sj(n),this.options.samples&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,this._MSAAFbo),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.frame),n.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,n.COLOR_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null))},init:function(l,K,B){var X=this,U=X.texture=K.createTexture();K.activeTexture(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,U);var i=B.samples,n=i?K.NEAREST:K.LINEAR;K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,B.minFilter||n),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,B.magFilter||n),K.bindTexture(K.TEXTURE_2D,null),X.render=K.createRenderbuffer(),X.frame=K.createFramebuffer(),l._2O[X.uuid]=U},assureTexture:function(){var $=this,w=$.uuid,F=$.gv._2O;F[w]||(F[w]=$.texture)},setSize:function(Z,G,R){var d=this;if(G&&R&&(d.width!==G||d.height!==R)){var U=Z.RGBA,k=Z.TEXTURE_2D,q=Z.RENDERBUFFER,h=Z.FRAMEBUFFER,C=d.options.samples;if(Ej(Z,d.texture),Z.texImage2D(k,0,U,G,R,0,U,Z.UNSIGNED_BYTE,I),Qg.isPOT(G)&&Qg.isPOT(R)&&!d.options.clampToEdge?(Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.REPEAT),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.REPEAT)):(Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE)),Z.bindRenderbuffer(q,d.render),C){var P=d.gv._glCapabilities;if(P._maxSamplesChecked)Z.renderbufferStorageMultisample(q,C,Z.DEPTH_COMPONENT16,G,R);else{for(Z.getError();C>1&&(Z.renderbufferStorageMultisample(q,C,Z.DEPTH_COMPONENT16,G,R),Z.getError());)C=Math.floor(C>>1);1>=C&&(C=0,Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,d.options.minFilter||Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,d.options.magFilter||Z.LINEAR),Z.renderbufferStorage(q,Z.DEPTH_COMPONENT16,G,R)),P._maxSamplesChecked=!0,P.maxSamples=d.options.samples=C}}else Z.renderbufferStorage(q,Z.DEPTH_COMPONENT16,G,R);C&&!d._MSAAFbo&&(d._MSAAFbo=Z.createFramebuffer(),d._MSAARbO=Z.createRenderbuffer()),pf(Z,d.frame),Z.framebufferTexture2D(h,Z.COLOR_ATTACHMENT0,k,d.texture,0),C||Z.framebufferRenderbuffer(h,Z.DEPTH_ATTACHMENT,q,d.render),Sj(Z),C&&(Z.bindRenderbuffer(Z.RENDERBUFFER,d._MSAARbO),Z.renderbufferStorageMultisample(Z.RENDERBUFFER,C,Z.RGBA8,G,R),pf(Z,d._MSAAFbo),Z.framebufferRenderbuffer(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.RENDERBUFFER,d._MSAARbO),Z.framebufferRenderbuffer(h,Z.DEPTH_ATTACHMENT,q,d.render),Sj(Z)),Ej(Z,I),Z.bindRenderbuffer(q,I),d.width=G,d.height=R}},toCanvas:function(){var d=this,E=d.gv.getGL();pf(E,d.frame);var v=d.width,n=d.height,q=new Uint8Array(4*v*n);E.readPixels(0,0,v,n,E.RGBA,E.UNSIGNED_BYTE,q),Sj(E);var x=M.createElement("canvas");x.width=v,x.height=n;var m=x.getContext("2d"),G=m.createImageData(v,n);return G.data.set(q),m.putImageData(G,0,0),x}});var Yl=Pm.Interactor=function(A){this.gv=A};Ne("Interactor",Y,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var kb=Pm.DefaultInteractor=function(J){mj(kb,this,[J])};Ne("DefaultInteractor",Yl,{handle_contextmenu:function(o){Rg(o)},handle_mousewheel:function(M){this.gv.handleScroll(M,M.wheelDelta/40)},handle_DOMMouseScroll:function($){2===$.axis&&this.gv.handleScroll($,-$.detail)},handle_keydown:function(T){this.gv.handleKeyDown(T)},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(Z){Rg(Z);var P=this,l=P.gv,q=Qn(Z),N=l.getDataInfoAt(Z),c=N?N.data:I,r=N?N.part:I,Q=l.sm(),w=vc(Z),A=Em(Z);l.setFocus(Z)&&(P._62O=I,P._57I=I,c?Ic(Z)?Q.co(c)?Q.rs(c):Q.as(c):Q.co(c)||Q.ss(c):q&&(Ic(Z)?l.isRectSelectable()&&(P._62O=ks):P._57I=hb(Z)),P._31Q&&(hr(P._31Q),delete P._31Q,delete P._32Q),P._62O||(l.isFirstPersonMode()&&(Kh(Z)||Ei(Z)||A>2?P._62O="pan":l.isMouseRoamable()||Jm?(P._62O="roaming",P.foward=w&&Qn(Z),P._32Q=Fc(),P._31Q=ve(P.tick,P)):q||(P._62O="roaming")),P._62O||(q&&w&&ni[r]?(P._62O=r,P.p3=c.p3()):q&&w&&Fg(c)&&l.isSelected(c)?l.isMovable(c)?(P._62O="move",P.p3=c.p3(),P.movedata=c):l._39Q(c)&&(P._62O="none"):Jm&&(A>2?P._62O="pan":2===A&&(P.dist=Re(Z),P._62O="pinch")))),P.point=l.lp(Z),_g(P,Z),Mb(Z)?l.handleDoubleClick(Z,c,r):l.handleClick(Z,c,r))},tick:function(){var t=this,z=t.gv,I=z._moveStep;t.point&&z.isWalkable()&&(t._32Q&&(I*=(Fc()-t._32Q)/50),z.walk(t.foward?I:-I),t._32Q=Fc(),t._31Q=ve(t.tick,t))},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(n){var e=this._57I;e&&(Oj(e,hb(n))<=1&&this.gv.sm().cs(),this._57I=I)},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(i){var u,O,j=this,g=j.gv,K=j._62O,$=j.point,v=g.dm(),d=g.lp(i),o=d.x-$.x,J=d.y-$.y,N=g.getWidth(),T=g.getHeight();if(N&&T){var S=-E*o/N,w=-E*J/T;if("roaming"===K)j.rotate(i,S/2,w/2);else if(K===Cf||K===Wj||K===ar)g._86O||v.beginTransaction(),g.fi({kind:g._86O?"betweenEditRotation":"beginEditRotation",event:i}),g._86O=1,g.sm().each(function(z){if(Fg(z)&&g.isRotationEditable(z)){var f=H(S)>H(w)?S:w;K===Cf?z.setRotationX(z.getRotationX()+f):K===Wj?z.setRotationY(z.getRotationY()+f):K===ar&&z.setRotationZ(z.getRotationZ()+f)}});else if("move"===K||ni[K]){K===Xg||K===ak||K===qo?(g._87O||v.beginTransaction(),g.fi({kind:g._87O?"betweenEditScale":"beginEditScale",event:i}),g._87O=1):(g._moving||v.beginTransaction(),g.fi({kind:g._moving?"betweenMove":"beginMove",event:i}),g._moving=1);var f,c=j.p3,Q=g.getPositionInfo(c),z=Gq(g);f=K===Hm?"x":K===Ho?"y":K===br?"z":K===Xg?"sx":K===ak?"sy":K===qo?"sz":g.getMoveMode(i,j.movedata),o=o/N*Q.width,J=-1*J/T*Q.height;var L,G,x=[z[0]*o,z[4]*o,z[8]*o],R=[z[1]*J,z[5]*J,z[9]*J],_=x[0]+R[0],Z=x[1]+R[1],C=x[2]+R[2],D=[c[0]+_,c[1]+Z,c[2]+C],t=Ti(g.getEye(),D,!0);if("xyz"===f?(L=D,g.moveSelection(_,Z,C)):"xz"===f?(L=Mm(g,c,[0,1,0],D),L&&g.moveSelection(L[0]-c[0],0,L[2]-c[2])):"xy"===f?(L=Mm(g,c,[0,0,1],D),L&&g.moveSelection(L[0]-c[0],L[1]-c[1],0)):"yz"===f?(L=Mm(g,c,[1,0,0],D),L&&g.moveSelection(0,L[1]-c[1],L[2]-c[2])):"x"===f||"sx"===f?(t[0]=0,L=Mm(g,c,t,D),L&&(G=L[0]-c[0],"x"===f?g.moveSelection(G,0,0):g.sm().each(function(D){Fg(D)&&g.isSizeEditable(D)&&(u=D.getScaleX()+G/100,O=u/D.getScaleX(),D.setScaleX(u),Kh(i)&&(D.setScaleY(D.getScaleY()*O),D.setScaleTall(D.getScaleTall()*O)))}))):"y"===f||"sy"===f?(t[1]=0,L=Mm(g,c,t,D),L&&(G=L[1]-c[1],"y"===f?g.moveSelection(0,G,0):g.sm().each(function(a){Fg(a)&&g.isSizeEditable(a)&&(u=a.getScaleTall()+G/100,O=u/a.getScaleTall(),a.setScaleTall(u),Kh(i)&&(a.setScaleY(a.getScaleY()*O),a.setScaleX(a.getScaleX()*O)))}))):("z"===f||"sz"===f)&&(t[2]=0,L=Mm(g,c,t,D),L&&(G=L[2]-c[2],"z"===f?g.moveSelection(0,0,G):g.sm().each(function(c){Fg(c)&&g.isSizeEditable(c)&&(u=c.getScaleY()+G/100,O=u/c.getScaleY(),c.setScaleY(u),Kh(i)&&(c.setScaleX(c.getScaleX()*O),c.setScaleTall(c.getScaleTall()*O)))}))),!L)return;j.p3=L}else if(K===ks){var q=j.div;q||(q=j.div=Tj(),Ig(j.getView(),q),q.op=$,q.style.background=g.getRectSelectBackground()),g.fi({kind:g._rectSelecting?"betweenRectSelect":"beginRectSelect",event:i}),g._rectSelecting=1,q.rect=Hj(q.op,d),Op(q,q.rect)}else if("pinch"===K&&2===Em(i)){g.fi({kind:g._pinching?"betweenPinch":"beginPinch",event:i}),g._pinching=1;var G=Re(i);g._lastZoomLP||(g._lastZoomLP=Hr(i)),g.handlePinch(G,j.dist),j.dist=G}else"pan"===K||Kh(i)||Ei(i)?j.pan(i,o,J):"none"===K||g.isFirstPersonMode()||j.rotate(i,S,w);j.point=d}},pan:function(a,y,K){var L=this.gv;if(L.isPannable()){var r=L.getWidth(),e=L.getHeight();if(!r||!e)return;var c=L.getCenterInfo(),D=y/r*c.width,s=-1*K/e*c.height;L.fi({kind:L._panning?"betweenPan":"beginPan",event:a}),L._panning=1,L.pan(-D,-s)}},rotate:function(N,U,X){var c=this.gv;c.isRotatable()&&(c.fi({kind:c._rotating?"betweenRotate":"beginRotate",event:N}),c._rotating=1,c.rotate(U,X))},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(i){var C=this,N=C.gv,D=N.dm(),q=C.div;if(q){var l=N.getDatasInRect(q.rect);if(!l.isEmpty()){var d=N.sm(),U=d.toSelection();l.each(function(l){d.co(l)?U.remove(l):U.add(l)}),d.ss(U)}mo(q)}N._moving&&(delete N._moving,N.fi({kind:"endMove",event:i}),N.onMoveEnded(),D.endTransaction()),N._panning&&(delete N._panning,N.fi({kind:"endPan",event:i}),N.onPanEnded()),N._rotating&&(delete N._rotating,N.fi({kind:"endRotate",event:i}),N.onRotateEnded()),N._86O&&(delete N._86O,N.fi({kind:"endEditRotation",event:i}),D.endTransaction()),N._87O&&(delete N._87O,N.fi({kind:"endEditScale",event:i}),D.endTransaction()),N._pinching&&(delete N._pinching,N.fi({kind:"endPinch",event:i}),N.onPinchEnded()),N._rectSelecting&&(delete N._rectSelecting,N.fi({kind:"endRectSelect",event:i}),N.onRectSelectEnded()),N._walking&&(delete N._walking,N.fi({kind:"endWalk",event:i}),N.onWalkEnded()),N._lastZoomLP=N._lastZoomHit=null,C.dist=C.point=C._62O=C.p3=C.movedata=C.div=C._57I=C._32Q=C._31Q=C.foward=I}});var Db=Pm.MapInteractor=function(J){mj(Db,this,[J]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Ne("MapInteractor",Yl,{handle_contextmenu:function(J){Rg(J)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(C){2===C.axis&&this.gv.handleScroll(C,-C.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(O){Rg(O);var i=this,n=i.gv;if(n.setFocus(O)){var E=n.getDataInfoAt(O),X=E?E.data:I,U=E?E.part:I,s=i.editing={point:n.lp(O)};Jm?s.touch=!0:(s.touch=!1,s.clickLeft=Qn(O),s.pan=Ei(O)?!0:"left"===this.panButton===s.clickLeft),X&&n._39Q(X)&&(s.preventDefault=!0),_g(i,O),Mb(O)?n.handleDoubleClick(O,X,U):n.handleClick(O,X,U)}},handle_mouseup:function(F){this.handle_touchend(F)},handle_touchend:function(){},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(f){var H=this,W=H.gv,Z=H.editing;if(Z){var C=W.lp(f),P=Z.point,B=C.x-P.x,i=C.y-P.y;if(!Z.moved){if(Math.abs(B)<H.threshold&&Math.abs(i)<H.threshold&&!(f.touches&&f.touches.length>1))return;Z.moved=!0}if(!Z.preventDefault)if(Z.point=C,Z.touch){var n=f.touches.length;if(2!==n)H.pan(f,B,i);else{if(1>=n)return;var r=f.touches,b={x:r[0].clientX,y:r[0].clientY},m={x:r[1].clientX,y:r[1].clientY},d={x:m.x-b.x,y:m.y-b.y},J=Z.lastCenter,e=Math.atan2(d.y,d.x),t=Z.theta,w=0;t==I?t=Z.theta=e:(w=e-t,Z.thetaStarted||Math.abs(w)>H.touchRotateThreshold?(Z.thetaStarted=!0,Z.theta=e):w=0);var O=k*(b.y+m.y)/2/W.getHeight(),l=Z.phi,S=0;l==I?l=Z.phi=O:(S=O-l,Z.phiStarted||Math.abs(S)>H.touchRotateThreshold?(Z.phiStarted=!0,Z.phi=O):S=0);var q,s=Math.sqrt(d.x*d.x+d.y*d.y),o=Z.vlen;if(o){var x=b.x-J.x,G=b.y-J.y,Q=m.x-J.x,$=m.y-J.y,K=Math.sqrt(x*x+G*G),T=Math.sqrt(Q*Q+$*$),L=o/2,N=H._sign2(K-L),D=H._sign2(T-L);0>N*D||0===N&&0===D?(q=1,Z.vlen=s):(q||(q=s/o),Z.scaleStarted||Math.abs(q-1)>H.touchScaleThreshold?(Z.vlen=s,Z.scaleStarted=!0):q=1)}else o=Z.vlen=s,q=1;1!==q&&W.setZoom(q),(S||w)&&H.rotate(f,w,-S),Z.lastCenter={x:(m.x+b.x)/2,y:(m.y+b.y)/2}}}else if(Z.pan)H.pan(f,B,i);else{var c=W.getWidth(),j=W.getHeight();if(!c||!j)return;var X=-E*B/c,h=-E*i/j;H.rotate(f,X,h)}}},_sign2:function(G){return Math.abs(G)<this._touchScaleCheckAccuracy?0:G>0?1:-1},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},handleWindowTouchEnd:function(p){var u=this,x=u.editing;if(u.editing=null,x){var A=u.gv;if(x.moved||!x.clickLeft&&!x.touch)A._panning=null,A._rotating=null,A.fi({kind:x.pan?"endPan":"endRotate",event:p});else{var M=A.getDataAt(p);M?A.sm().setSelection([M]):A.sm().clearSelection()}}},pan:function(q,d,P){var J=this,z=J.gv;if(z.isPannable()){var A=z.getWidth(),Y=z.getHeight();if(A&&Y){var w=z.getCenterInfo(),n=-d/A*w.width,x=1*P/Y*w.height;z.fi({kind:z._panning?"betweenPan":"beginPan",event:q}),z._panning=1;var C=J.keepHorizon,R=J.editing.touch;if((R&&q.touches&&q.touches.length>1||!R&&Kh(q))&&(C=!C),!C)return z.pan(n,x);if(n||x){var l=Gq(z),v=[l[0]*n,l[4]*n,l[8]*n],g=[l[1],0,l[9]],O=Math.sqrt(g[0]*g[0]+g[2]*g[2]);O&&(g=[g[0]/O*x,0,g[2]/O*x]);var y=v[0]+g[0],V=v[1]+g[1],N=v[2]+g[2],u=z._center,S=z._eye;u[0]+=y,u[1]+=V,u[2]+=N,S[0]+=y,S[1]+=V,S[2]+=N,z.fp(Tm,I,S),z.fp(dn,I,u)}}}},rotate:function(Y,h,E){var e=this,p=e.gv;if(p.isRotatable()){var c=p._center,u=p._eye,o=Ti(u,c),U=$(K(o[0]*o[0]+o[2]*o[2]),o[1]),T=vg(U+E);E=T-U,p.fi({kind:p._rotating?"betweenRotate":"beginRotate",event:Y}),p._rotating=1,p.rotate(h,E)}}}),Y.defineProperties(Db.prototype,{panButton:{get:function(){return this._panButton},set:function(u){this._panButton=u}},minPhi:{get:function(){return t.graph3dViewMinPhi},set:function(P){t.graph3dViewMinPhi=P}},maxPhi:{get:function(){return t.graph3dViewMaxPhi},set:function(X){t.graph3dViewMaxPhi=X}},keepHorizon:{get:function(){return this._keepHorizon},set:function(s){this._keepHorizon=s}},threshold:{get:function(){return this._threshold},set:function(T){this._threshold=T}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(m){this._touchScaleThreshold=m}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(f){this._touchRotateThreshold=f}}});var og,Hp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",No=32,Vd=Pm.GlobeInteractor=function(z,c){mj(Vd,this,[z]);var M,T=c.radius||6378137,b=this,V=null;og||(og=Tj(),og.style.border="",og.style.backgroundImage="url("+Hp+")");var v=new Bb,q=new He,t=new He,o=new He,l=new Pl,p="number"==typeof T?{x:T,y:T,z:T}:T,B={center:new He(0,0,0),radius:p},n=function(o){z._81O=null;var i=z.getHitPosition(o,z.getCenter(),q.copy(z.getEye()).sub(t.copy(z.getCenter())).toArray());return l.origin.copy(z.getEye()),l.direction.copy(i).sub(l.origin).normalize(),l.intersectEllipsoid(B)},N=function(y,g){z._81O=null,l.origin.copy(z.getEye());for(var J,h,f=z.getCenter(),E=q.copy(z.getEye()).sub(t.copy(z.getCenter())).toArray(),N=1,C=16,U=0,V=1,i={x:0,y:0};C--;){if(i.x=g.x+(y.x-g.x)*N,i.y=g.y+(y.y-g.y)*N,J=z.getHitPosition(i,f,E),l.direction.copy(J).sub(l.origin).normalize(),h=l.intersectEllipsoid(B),h&&1===N)return{hit:h};h?U=N:V=N,N=(U+V)/2}return{hit:h,out:1>N}},g=function(T,m){if(V){var k=Date.now();V.deltaTime=V.lastTime?k-V.lastTime:1e3,V.lastTime=k,V.lastAxis=T,V.lastAngle=m}m&&(v.setFromAxisAngle(T,m),z.setEye(q.copy(z.getEye()).applyQuaternion(v).toArray()),z.setCenter(q.copy(z.getCenter()).applyQuaternion(v).toArray()),z.setUp(q.copy(z.getUp()).applyQuaternion(v).toArray()))};b._showCrossIcon=function(S){Ig(b.getView(),og),Op(og,{x:S.clientX-No/2,y:S.clientY-No/2,width:No,height:No})},b._hideCrossIcon=function(){mo(og)},b._scrollImpl=function(Y,m){V={point:z.lp(Y),screen:hb(Y),hit:n(Y),type:"right"},V.hitNormalize=V.hit?V.hit.clone().normalize():new He;var u={clientX:V.screen.x,clientY:V.screen.y+10*m};b._handleMoveImpl(u),b._endMoveImpl(u)},b._startMoveImpl=function(Q){M&&(M.stop(!0),M=null),V={point:z.lp(Q),screen:hb(Q),hit:n(Q)},V.hitNormalize=V.hit?V.hit.clone().normalize():new He,Jm?1===Q.touches.length?V.hit&&(V.type="left"):2===Q.touches.length&&(V.type="touch2"):(Qn(Q)?V.hit&&(V.type="left"):Wf(Q)?V.type="right":Ei(Q)&&V.hit&&(V.type="middle"),!V.hit||"right"!==V.type&&"middle"!==V.type||b._showCrossIcon(Q)),V.type&&_g(b,Q)},b._handleMoveImpl=function(c){if(V)switch(V.type){case"left":return b._handleLeft(c);case"right":return b._handleRight(c);case"middle":return b._handleMiddle(c);case"touch2":return b._handleTouch2(c)}},b._endMoveImpl=function(){if(V){if(this._hideCrossIcon(),"left"===V.type||"middle"===V.type){var n=1e3*(V.lastAngle/(V.deltaTime||30)),U=V.lastAxis,C=V.lastTime,W=function(){var l=Date.now(),c=(l-C)/1e3;return C=l,n*=Math.pow(Math.abs(b.decelerationRate),3*c),Math.abs(n)<.01?(n=0,M&&M.stop(),void 0):(g(U,n*c),void 0)};M=qh({action:function(){W(arguments)},duration:5e3})}V=null}},b._handleLeft=function(K){if(!V.finished){var j=hb(K),h=N(j,V.lastScreen||V.screen);if(V.lastScreen=j,!h.hit)return V.finished=!0,b._endMoveImpl(K),void 0;var u=h.hit;u.normalize();var Y=V.hitNormalize,d=Math.acos(u.dot(Y)),o=u.cross(Y).normalize();g(o,d),h.out&&(V.finished=!0,b._endMoveImpl(K))}},b._handleRight=function(_){var P=V.lastScreen||V.screen,l=P.y;P=V.lastScreen=hb(_);var F=P.y,a=F-l;if(a){var X=Math.min(.5,a*b.scaleSpeed);q.copy(z.getEye());var Q=V.hit;Q||(Q=q.clone().divide(p).normalize().multiply(p)),t.copy(q).lerp(Q,X),z.setEye(t.toArray()),q.copy(z.getUp()),t.normalize();var U=q.clone().cross(t).normalize();if(o.copy(z.getCenter()),o.sub(U.multiplyScalar(o.dot(U))),z.setCenter(o.toArray()),V.hit){var J=n(V.screen),x=V.hitNormalize;if(J){J.normalize();var Z=Math.acos(J.dot(x)),k=J.cross(x).normalize();Z&&g(k,Z)}}}};var Y=function(r){return Math.abs(r)<.01?0:r>0?1:-1};b._handleTouch2=function(W){var S=W.touches.length;if(2===S){var M=W.touches,C={x:M[0].clientX,y:M[0].clientY},A={x:M[1].clientX,y:M[1].clientY},s={x:A.x-C.x,y:A.y-C.y},B=V.lastCenter,b=Math.atan2(s.y,s.x),c=V.theta,J=0;c==I?c=V.theta=b:(J=b-c,V.thetaStarted||Math.abs(J)>.03?(V.thetaStarted=!0,V.theta=b):J=0);var i,u=Math.sqrt(s.x*s.x+s.y*s.y),k=V.vlen;if(k){var n=C.x-B.x,R=C.y-B.y,X=A.x-B.x,d=A.y-B.y,q=Math.sqrt(n*n+R*R),P=Math.sqrt(X*X+d*d),m=k/2,p=Y(q-m),L=Y(P-m);0>p*L||0===p&&0===L?(i=1,V.vlen=u):(i||(i=u/k),V.scaleStarted||Math.abs(i-1)>.05?(V.vlen=u,V.scaleStarted=!0):i=1)}else k=V.vlen=u,i=1;var s=t.copy(z.getEye()).clone();1!==i&&z.setEye(s.setLength((s.length()-T)/i+T).toArray()),J&&g(s.normalize(),J),V.lastCenter={x:(A.x+C.x)/2,y:(A.y+C.y)/2}}},b._handleMiddle=function(c){var r=hb(c),U=V.screen;V.screen=r;var B=(r.y-U.y)/180*Math.PI*b.rollSpeed;t.copy(z.getCenter()).sub(q.copy(z.getEye())).normalize(),q.copy(z.getUp()).cross(t).normalize(),t.copy(z.getEye()).sub(V.hit).applyAxisAngle(q,B).add(V.hit);var f=t.clone();t.copy(z.getCenter()).sub(V.hit).applyAxisAngle(q,B).add(V.hit);var N=t.clone(),M=t.copy(z.getUp()).applyAxisAngle(q,B).clone(),W=!1;B>0&&(o.copy(M),t.copy(N).sub(f).normalize(),q.copy(f).multiplyScalar(-1).normalize(),q.dot(o)-t.dot(o)>0&&(W=!0)),W||o.copy(V.hit).sub(f).dot(V.hitNormalize)>=0&&(W=!0),W||(z.setEye(f.toArray()),z.setCenter(N.toArray()),z.setUp(M.toArray()));var y=-(r.x-U.x)/180*Math.PI*b.rotateSpeed;g(V.hitNormalize,y)}};Ne("GlobeInteractor",Yl,{handle_contextmenu:function(I){Rg(I)},handle_mousewheel:function(d){this._scrollImpl(d,d.wheelDelta/40)},handle_DOMMouseScroll:function(X){2===X.axis&&this._scrollImpl(X,-X.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)},handle_mousedown:function(H){this.handle_touchstart(H)},handle_touchstart:function(s){Rg(s);var l=this.gv;if(l.setFocus(s)){var d=l.getDataInfoAt(s),K=d?d.data:I;K&&l.isInteractive(K)||this._startMoveImpl(s);var G=d?d.part:I;Mb(s)?l.handleDoubleClick(s,K,G):l.handleClick(s,K,G)}},handle_mouseup:function(U){this.handle_touchend(U)},handle_touchend:function(){},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(o){this._handleMoveImpl(o)},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(H){this._endMoveImpl(H)}}),Y.defineProperties(Vd.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(S){this._rotateSpeed=S}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(x){this._rollSpeed=x}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(v){this._scaleSpeed=v}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(J){this._decelerationRate=J}}});var Gd=function(c){this.gv=c};Rq(Gd,Y,{_iv:!0,iv:function(){this._iv=!0},face:function(x,w){var P=this,R=P.gv.getGL();if(!R||!Fg(x))return I;var B=P._resolution,q=Math.round(w.x*B),C=Math.ceil(w.width*B),Q=Math.ceil(w.height*B),c=P.height-Math.round(w.y*B)-Q,Z=e(C/2),r=new Uint8Array(4*C*Q),h=0;for(P.iv(),P.validate(x),pf(R,P.frame),R.readPixels(q,c,C,Q,R.RGBA,R.UNSIGNED_BYTE,r),Sj(R),P.iv();Z>=h;h++)for(var W=Z-h,J=Z+h,n=W;J>=n;n++)for(var D=W;J>=D;D++)if(n===W||n===J||D===W||D===J){var y=qk.m[r[4*(n*C+D)]];if(y)return y}},get:function(n,K){this.validate();var s=this,D=s.gv.getGL();if(!D)return I;var f,v,x=s._resolution,Z=Math.round(n.x*x),d=Math.ceil(n.width*x),G=Math.ceil(n.height*x),i=s.height-Math.round(n.y*x)-G,t=e(d/2),j=new Uint8Array(4*d*G),E=0,Q=j.length,T=K?I:new up,O=K?I:{};if(pf(D,s.frame),D.readPixels(Z,i,d,G,D.RGBA,D.UNSIGNED_BYTE,j),Sj(D),K){for(;t>=E;E++)for(var $=t-E,q=t+E,F=$;q>=F;F++)for(var z=$;q>=z;z++)if((F===$||F===q||z===$||z===q)&&(f=s.info(j,4*(F*d+z))))return f}else for(;Q>E;E+=4)f=s.info(j,E),f&&(v=f.data,O[v._id]||(T.add(v),O[v._id]=v));return T},info:function(R,K){return this.colorMap[(R[K]<<16)+(R[K+1]<<8)+R[K+2]+((127&R[K+3])<<24)]},validate:function(Y){var P=this,z=P.gv,j=z.getGL();if(j){var D=P._resolution=z._pickerResolution*z.getDevicePixelRatio(),y=Math.round(D*z.getWidth()),B=Math.round(D*z.getHeight()),i=j.RGBA,R=j.TEXTURE_2D,S=j.RENDERBUFFER,H=j.FRAMEBUFFER;P.texture||(P.texture=Vj(j),P.render=j.createRenderbuffer(),P.frame=j.createFramebuffer()),(P.width!==y||P.height!==B)&&(Ej(j,P.texture),j.texImage2D(R,0,i,y,B,0,i,j.UNSIGNED_BYTE,I),Qp(j,j.TEXTURE_MIN_FILTER,j.LINEAR),j.bindRenderbuffer(S,P.render),j.renderbufferStorage(S,j.DEPTH_COMPONENT16,y,B),pf(j,P.frame),j.framebufferTexture2D(H,j.COLOR_ATTACHMENT0,R,P.texture,0),j.framebufferRenderbuffer(H,j.DEPTH_ATTACHMENT,S,P.render),Ej(j,I),j.bindRenderbuffer(S,I),Sj(j),P.width=y,P.height=B),P._iv&&(P._iv=!1,pf(j,P.frame),z._42(Y||(P.colorMap={}),D),Sj(j))}}});var Eg=function(s){this.gv=s};Rq(Eg,Y,{gap:0,size:0,_42:function(J,e){var j=this,T=j.gv,l=T._gridGap,k=T._gridSize;if(T._gridVisible){if(j.gap!==l||j.size!==k){for(var M=[],O=T._gridSize/2,t=l*O,q=0;2*O+1>q;q++){var C=6*q,z=6*(2*O+1)+C;M[C]=-t,M[C+1]=0,M[C+2]=-t+q*l,M[C+3]=t,M[C+4]=0,M[C+5]=-t+q*l,M[z]=-t+q*l,M[z+1]=0,M[z+2]=-t,M[z+3]=-t+q*l,M[z+4]=0,M[z+5]=t}j.vs=new Ko(M),j.gap=l,j.size=k}sf(T),zl(J,e),vq(J),So(J,e,1,T._gridColor,T._buffer.vs,j.vs),ke(J,0,j.vs.length/3,J.LINES),jl(J),ml(J,e)}else j.vs=j.gap=j.size=I}});var xo=function(e){this.gv=e};Rq(xo,Y,{_42:function(P,f){var W=this.gv,D=W._buffer.vs,$=W._axisXColor,u=W._axisYColor,C=W._axisZColor,S=W._originAxisVisible,G=W._centerAxisVisible;if(S||G){var F=kf?P.TRIANGLES:P.TRIANGLE_FAN,x=P.LINES;if(sf(W),zl(P,f),vq(P),S){var B=W.getCenterInfo(),s=r(B.width,B.height)/5,y=.8*s,Y=.05*s;So(P,f,1.5,$,D,new Ko([0,0,0,s,0,0,y,Y,0,y,0,Y,y,-Y,0,y,0,-Y,y,Y,0,0,0,0,0,s,0,Y,y,0,0,y,Y,-Y,y,0,0,y,-Y,Y,y,0,0,0,0,0,0,s,Y,0,y,0,Y,y,-Y,0,y,0,-Y,y,Y,0,y])),ke(P,0,2,x),ke(P,1,6,F),So(P,f,I,u),ke(P,7,2,x),ke(P,8,6,F),So(P,f,I,C),ke(P,14,2,x),ke(P,15,6,F)}if(G){var c=W._center,E=c[0],p=c[1],N=c[2],B=W.getPositionInfo(c);s=r(B.width,B.height)/20,So(P,f,1.5,$,D,new Ko([E,p,N,E+s,p,N,E,p,N,E,p+s,N,E,p,N,E,p,N+s])),ke(P,0,2,x),So(P,f,I,u),ke(P,2,2,x),So(P,f,I,C),ke(P,4,2,x)}jl(P),ml(P,f)}}});var bp=function(e){this.gv=e,this.onMouseOver=this.onMouseOver.bind(this),this.mode=bp.Mode.Style,this.color=Q,this.width=Q};bp.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Rq(bp,Y,{onMouseOver:function(q){t.preventDefault(q);var k=this.gv.getDataAt(q);k!==this.mouseOverData&&(this.mouseOverData=k,this.gv.iv())},setFetchTargetFunc:function(z){this.fetchTargetFunc=z},_42:function(f,Y){var v,i,T=this,O=T._mode;if(!f._renderInfo.reflectDepth&&O!==bp.Mode.Disable){if(O===bp.Mode.Selection?v=T.gv.sm().getSelection().toArray(function(D){return D.s("highlight.visible")}):O===bp.Mode.MouseOver&&T.mouseOverData&&T.mouseOverData.s("highlight.visible")&&(v=[T.mouseOverData]),T.fetchTargetFunc&&(v=T.fetchTargetFunc(v)),O===bp.Mode.Style)v=v||[],i=function(I){if(v.indexOf(I)>=0)return!1;var q=I.s("highlight.mode");return q===!1?!0:q===!0?!1:"selected"===q?T.gv.isSelected(I)?!1:!0:"hover"===q?I===T.mouseOverData?!1:!0:!0};else{if(!v||!v.length)return;i=function(P){return v.indexOf(P)<0?!0:void 0}}var W=T.gv,A=W.vr.isPresenting(),t=W.getWidth();if(A){var l=W.getWidth;t/=2,W.getWidth=function(){return t};var e=W.getViewport()}var n,Q=W.getDevicePixelRatio(),c=t*Q,F=W.getHeight()*Q;(n=T._renderTarget)?n.setSize(f,c,F):T._renderTarget=n=new Pm.RenderTarget(W,f,c,F),pf(f,n.frame),W.drawFilter=i,W._42({}),W.drawFilter=null,Sj(f),kf&&Fo(f,Y.aPosition),Fo(f,Y.aNormal),A&&(W.getWidth=l,W.setViewport(f,e[0],e[1],e[2],e[3]));var P=f._compiledShader.highlight;P||(P=f._compiledShader.highlight=new Dk.Shader(f,zc.vs,zc.fs)),P.bind(),f.enable(f.BLEND),f.activeTexture(f.TEXTURE0+0),f.bindTexture(f.TEXTURE_2D,n.texture),P.uniforms.image=0,P.uniforms.textureSize=[c,F],P.uniforms.edgeWidth=W.getHighlightWidth();var s=W.getHighlightColor();if(T._lastHighlightColor!==s){var K=Up(T._lastHighlightColor=s);T._highlightColorData=[K[0]/255,K[1]/255,K[2]/255,K[3]/255]}P.uniforms.edgeColor=T._highlightColorData,T.ibuffer?(T.ibuffer.upload(),T.vbuffer.upload()):(T.ibuffer=Dk.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),T.vbuffer=Dk.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))),P.attributes.pos.pointer(T.vbuffer),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),f.disable(f.BLEND),f.bindTexture(f.TEXTURE_2D,null),f.useProgram(Y),kf&&mc(f,Y.aPosition)}}}),Y.defineProperties(bp.prototype,{mode:{get:function(){return this._mode},set:function(n){var y=this._mode;n!==y&&(this._mode=n,n===bp.Mode.MouseOver||n===bp.Mode.Style?J(this.gv.getView(),"mousemove",this.onMouseOver):(y===bp.Mode.MouseOver||y===bp.Mode.Style)&&i(this.gv.getView(),"mousemove",this.onMouseOver))}}});var zc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},xn=function(C){this.gv=C},Hm="edit_tx",Ho="edit_ty",br="edit_tz",Cf="edit_rx",Wj="edit_ry",ar="edit_rz",Xg="edit_sx",ak="edit_sy",qo="edit_sz",ni={};ni[Hm]=1,ni[Ho]=1,ni[br]=1,ni[Cf]=1,ni[Wj]=1,ni[ar]=1,ni[Xg]=1,ni[ak]=1,ni[qo]=1,Rq(xn,Y,{_42:function(E,c,o){var y=this,e=y.gv,U=e.sm().ld();if(U&&e.isEditable(U)&&!e.isEditHelperDisabled()&&Fg(U)&&(!e.isFirstPersonMode()||!e.isMouseRoamable()&&!Jm)){sf(e);var H,N,s=e.isMovable(U),d=e.isRotationEditable(U),T=e.isSizeEditable(U),L=e._axisXColor,v=e._axisYColor,i=e._axisZColor,w=e._editSizeColor,h=U.p3(),K=Oj(e.getEye(),h)/10,I=K/(o?5:10),Z=.7*K,q=.4*Z,$=h[0],n=h[1],J=h[2];H=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&y._17O(E,c,U,o,Hm,L,H,[$,n-I,J,$+Z,n-I,J,$+Z,n,J,$+Z,n,J,$,n,J,$,n-I,J,$,n-I,J+I,$+Z,n-I,J+I,$+Z,n-I,J,$+Z,n-I,J,$,n-I,J,$,n-I,J+I]),N=$+Z,T&&y._17O(E,c,U,o,Xg,w,H,[N,n-I,J,N+q,n-I,J,N+q,n,J,N+q,n,J,N,n,J,N,n-I,J,N,n-I,J+I,N+q,n-I,J+I,N+q,n-I,J,N+q,n-I,J,N,n-I,J,N,n-I,J+I]),N+=q,d&&y._17O(E,c,U,o,Cf,L,H,[N,n-I,J,N+q,n-I,J,N+q,n,J,N+q,n,J,N,n,J,N,n-I,J,N,n-I,J+I,N+q,n-I,J+I,N+q,n-I,J,N+q,n-I,J,N,n-I,J,N,n-I,J+I]),H=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],s&&y._17O(E,c,U,o,Ho,v,H,[$,n,J,$,n+Z,J,$-I,n+Z,J,$-I,n+Z,J,$-I,n,J,$,n,J,$,n,J,$,n,J-I,$,n+Z,J-I,$,n+Z,J-I,$,n+Z,J,$,n,J]),N=n+Z,T&&y._17O(E,c,U,o,ak,w,H,[$,N,J,$,N+q,J,$-I,N+q,J,$-I,N+q,J,$-I,N,J,$,N,J,$,N,J,$,N,J-I,$,N+q,J-I,$,N+q,J-I,$,N+q,J,$,N,J]),N+=q,d&&y._17O(E,c,U,o,Wj,v,H,[$,N,J,$,N+q,J,$-I,N+q,J,$-I,N+q,J,$-I,N,J,$,N,J,$,N,J,$,N,J-I,$,N+q,J-I,$,N+q,J-I,$,N+q,J,$,N,J]),H=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&y._17O(E,c,U,o,br,i,H,[$,n,J,$,n,J+Z,$,n-I,J+Z,$,n-I,J+Z,$,n-I,J,$,n,J,$,n-I,J,$-I,n-I,J,$-I,n-I,J+Z,$-I,n-I,J+Z,$,n-I,J+Z,$,n-I,J]),N=J+Z,T&&y._17O(E,c,U,o,qo,w,H,[$,n,N,$,n,N+q,$,n-I,N+q,$,n-I,N+q,$,n-I,N,$,n,N,$,n-I,N,$-I,n-I,N,$-I,n-I,N+q,$-I,n-I,N+q,$,n-I,N+q,$,n-I,N]),N+=q,d&&y._17O(E,c,U,o,ar,i,H,[$,n,N,$,n,N+q,$,n-I,N+q,$,n-I,N+q,$,n-I,N,$,n,N,$,n-I,N,$-I,n-I,N,$-I,n-I,N+q,$-I,n-I,N+q,$,n-I,N+q,$,n-I,N])}},_17O:function(d,M,H,J,r,C,V,s){var h=this.gv._buffer;ud(d,M,J,!0,H,r),jf(d,M,I,!0,I,!0,I,!1),ac(d,M.uDiffuse,C),dh(d,h.vs,new Ko(s),M.aPosition),dh(d,h.ns,new Ko(V),M.aNormal),vq(d),ke(d,0,12),jl(d),or(d,M)}});var Rm=v.Raycaster=function(v){this.gv=v,this.maxTriangleTest=1/0,this.backfaceCulling=!0
};$b("Raycaster",Y,{intersect:function(r){var N=this,V=N.gv,n=V.getDataAt(r);return n?N.intersectObject(r,n):null},intersectObjects:function(N,d,r){var O,J,Y,e,b=this,c=1/0,t=N.origin||(new He).fromArray(b.gv.getEye()),o=b.maxTriangleTest,y=[];return d.forEach(function(R){r&&r(R)===!1||R.s("intersect")!==!1&&y.push(R)}),y.sort(function(w,d){return t.distanceToSquared2(w.p3())-t.distanceToSquared2(d.p3())}),b.countTriangles=0,y.forEach(function(T){b.countTriangles>o||(O=b.intersectObject(N,T),O&&(J=t.distanceToSquared(O.world),c>J&&(Y=T,e=O,c=J)))}),b.countTriangles=0,{data:Y,intersect:e}},intersectObject:function(I,k){if(I instanceof Pl)return this._intersectObjectImpl(I,k);var t=this,x=t.gv,W=x.unproject(I),$=new He,b=x.getEye(),X=new He;if(x.isOrtho()){var c=new He(b);X.copy(x.getCenter()).sub(c).normalize();var M=$.copy(W).sub(c).dot(X);$.copy(X).setLength(-M).add(c.copy(W))}else $.copy(b),X.copy(W).sub($).normalize();var y=new v.Math.Ray($,X);return t._intersectObjectImpl(y,k)},_intersectObjectImpl:function(){function S(){var L=new He;return L.subVectors(C,$),s.subVectors(f,$),L.cross(s).normalize(),L}function i(K,Q,q,p,$,s,F){return xr.barycoordFromPoint(K,Q,q,p,E),$.multiplyScalar(E.x),s.multiplyScalar(E.y),F.multiplyScalar(E.z),$.add(s).add(F),$.clone()}function R(V,T,W){Ad(V)?V.forEach(function(d){R(d,T,W)}):fh(V)?R(zb(T,V),T,W):nd(V)&&(V.shape3d?R(V.shape3d,T,W):W.push(V))}var G=new _i,z=new _i,w=new Pl,Y=new He,I=new He,D=new He,O=new He,l=new He,f=new He,$=new He,C=new He,u=new xi,x=new xi,J=new xi,s=new He,o={vs:ob,is:gk,uv:Eh},E=new He;return function(A,L){var r=this.gv.getData3dUI(L),q=L.mat||r.mat;if(q){G.fromArray(q),z.getInverse(G),w.copy(A).applyMatrix4(z);var P,T,Q="body",N=r.shapeModel;if(N||(N=zb(r)),N||(L instanceof v.Node&&!(L instanceof v.Shape)?(P=!0,N=o):(T=!0,N=[r.left,r.front,r.right,r.back,r.top,r.bottom])),!N)return console.log("Can not find shape model."),null;Ad(N)||(N=[N]);var d,t,X,K,Z,b,h,V,a,k,p,c,B,n,y,W,F=1/0,g=["","top_","bottom_"],E=!1,j=this.backfaceCulling,s=[];for(R(N,r,s),d=0,t=s.length;t>d;d++)if(B=s[d])for(X=0,K=g.length;K>X;X++)if(n=g[X],h=B[n+"vs"],V=B[n+"is"],a=B[n+"uv"]||B[n+"tuv"],h){if(y=B[n+"boundingBox"]){var p=w.intersectBox(y);if(!p)continue;if(w.origin.distanceTo(p)>F)continue;W=!1}else B[n+"boundingBox"]=y=new v.Math.Box3,W=!0;for(Z=0,b=V?V.length:h.length/3;b>Z;Z+=3)this.countTriangles++,V?(I.fromArray(h,3*V[Z]),D.fromArray(h,3*V[Z+1]),O.fromArray(h,3*V[Z+2])):(I.fromArray(h,3*Z),D.fromArray(h,3*(Z+1)),O.fromArray(h,3*(Z+2))),W&&(y.expandByPoint(I),y.expandByPoint(D),y.expandByPoint(O)),k=w.intersectTriangle(I,D,O,j,Y),k&&(c=w.origin.distanceTo(k),F>c&&(F=c,l.copy(k),f.copy(I),$.copy(D),C.copy(O),""!==n?Q=n.slice(0,-1):P?Q=Ph[Math.floor(Z/6)]:T&&(Q=Ph[d]),a&&(E=!0,V?(u.fromArray(a,2*V[Z]),x.fromArray(a,2*V[Z+1]),J.fromArray(a,2*V[Z+2])):(u.fromArray(a,2*Z),x.fromArray(a,2*(Z+1)),J.fromArray(a,2*(Z+2))))))}if(!isFinite(F))return null;var H,U=l.clone().applyMatrix4(G);E&&(H=i(l,f,$,C,u,x,J));var M=S(f,$,C),e=S(f.applyMatrix4(G),$.applyMatrix4(G),C.applyMatrix4(G)),_=w.direction.dot(M);return _>0&&(M.multiplyScalar(-1),e.multiplyScalar(-1)),{world:U,local:l.clone(),worldNormal:e,normal:M,uv:H,part:Q}}}}()});var Dd=function(U,o){this.gv=U,this.s=function(D,u,v){return u==I&&(u=v),u==I?o.getStyle(D):Nq(u,o,U)},this.data=o};Rq(Dd,Y,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function($,o,R,N){var m=this,C=m.data;if(!(C instanceof Ml)){var d,e,z,X,y,D,n,l=m.gv,V=C._id,W=m.s("alwaysOnTop")||m.s("shape3d.alwaysOnTop")?null:m.s("batch"),T=l._batchIndexMap,j=l._batchModelMap,f=l.isSelectable(C),s=l.getBrightness(C),E=s!=I&&1!==s;if(m.needValidate($)){z=gl(T,j,C,W);var B=m.validate(z,W?oo[W]||Bp:I);if(z&&(X=T[V],y=X.size=z.vs.length/3-X.begin,n=z.rs))for(s=E?s:1,D=0;y>D;D++)n.push(s);var P=l.getWireframeGeometry(C);if(P)ii(l,C,P);else if(Fg(C)){var F=l.getWireframe(C);F&&ii(l,C,F)}m.labelInfo=m.label2Info=m.noteInfo=m.note2Info=m._38o=I,m._24O(Ef,"getLabel"),m._24O(fj,"getLabel2"),m._26O(vd,"getNote"),m._26O(Lq,"getNote2"),m._15O(),m.interactiveInfo=l.isInteractive(C)?{}:I,B!==!1&&(m._iv=!1)}E&&ac($,o.uBrightness,s),ac($,o.uAlphaTest,m.s("alphaTest")),ac($,o.uUseEnvMap,C.s("envmap")?!0:!1),ac($,o.uReflectivity,C.s("envmap")||.01);var Z=m.s("3d.clip.direction"),S=!0;if(Z){var K=m.s("3d.clip.percentage");switch(0===K&&(S=!1),Z){case"left":Z=2;break;case"top":Z=3;break;case"bottom":Z=4;break;case"front":Z=5;break;case"back":Z=6;break;case"right":default:Z=1}if(0===Z%2&&(K=1-K),C instanceof v.Shape){var p=C.s3(),G=C.p3(),t=C.getAnchor3d();K=3>Z?(K-t.x)*p[0]+G[0]:5>Z?(K-t.y)*p[1]+G[1]:(K-t.z)*p[2]+G[2]}else K-=.5;ac($,o.uClipPercent,K)}$.uniform1i(o.uClipDirection,Z||0),e=ud($,o,R,f,C,Vk),e&&(hk(e,T[V],j),hk(e,l._polylineIndexMap[V],l._polylineModelMap),hk(e,l._wireframeIndexMap[V],l._wireframeModelMap)),!T[V]&&S&&m._80o($,o,N),l.isLabelVisible(C)&&((d=m.labelInfo)&&(ud($,o,R,f,C,Ef),m._28O(d,Ef,N)),(d=m.label2Info)&&(ud($,o,R,f,C,fj),m._28O(d,fj,N))),l.isNoteVisible(C)&&((d=m.noteInfo)&&(ud($,o,R,f,C,vd),m._29O(d,vd,N)),(d=m.note2Info)&&(ud($,o,R,f,C,Lq),m._29O(d,Lq,N))),(d=m._38o)&&m._99O($,o,d,R,f,N),E&&ac($,o.uBrightness,1),Z&&$.uniform1i(o.uClipDirection,0)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Cm},_80o:function(){},dispose:function(){},getBodyColor:function(R){var v=this.data,$=this.gv.getBodyColor(v);return $?$:R?v.getStyle(R):I},getCachedTexture:function(_){var V=this._cachedTextures;return V?V[_||"main"]:null},setCachedTexture:function(B,o){var z=this._cachedTextures;return z||(z=this._cachedTextures={}),z[o||"main"]=B,B},invalidateCachedTexture:function(i){var Z=this._cachedTextures;for(var A in Z)i.deleteTexture(Z[A]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(f,p){var s=this,C=s.data,d=s.gv,$=s.s,e=d[p](C);if(e!=I){var Q=$(f+".scale"),B=$(f+".max"),U=s[f+"Info"]={label:e,textureScale:$(f+".texture.scale"),color:d[p+"Color"](C),font:$(f+".font"),align:$(f+".align"),background:d[p+"Background"](C)},y=U.rect=fo(U,e);B>0&&B<y.width&&(U.labelWidth=y.width,y.width=B),y.x=y.y=0,y.width*=Q,y.height*=Q,U.mat=s._16O($(f+".autorotate"),$(f+".position"),y,$(f+".face"),$(f+".t3"),$(f+".r3"),$(f+".rotationMode"));var H=y.width/2,w=y.height/2;U.vs=new Ko([-H,w,0,-H,-w,0,H,-w,0,H,w,0]),y.width/=Q,y.height/=Q}},_26O:function(x,E){var M=this,a=M.data,n=M.gv,l=M.s,G=n[E](a);if(G!=I){var R=l(x+".scale"),V=this[x+"Info"]={note:G,textureScale:l(x+".texture.scale"),expanded:l(x+".expanded"),font:l(x+".font"),color:l(x+".color"),align:l(x+".align"),borderWidth:l(x+".border.width"),borderColor:l(x+".border.color"),background:n[E+"Background"](a)};if(V.expanded){var J=l(x+".max"),A=fo(V,G);A.width+=6,A.height+=2,J>0&&J<A.width&&(V.labelWidth=A.width,A.width=J);var i={x:-A.width/2,y:-8-A.height,width:A.width,height:A.height+8}}else i={x:-6,y:-18,width:12,height:18};V.mat=M._16O(l(x+".autorotate"),l(x+".position"),I,l(x+".face"),l(x+".t3"),l(x+".r3"),l(x+".rotationMode")),V.rect=i,1!==R&&(i=Gk(i),i.x*=R,i.height*=R,i.y=-i.height,i.width*=R);var p=i.x,F=i.y,P=i.width,K=i.height;V.vs=new Ko([p,-F,0,p,-F-K,0,p+P,-F-K,0,p+P,-F,0])}},_28O:function(u,o,U){if(U(this.s(o+".transparent"))){var $=u.rect,d=u.textureScale,W=$.width*d,g=$.height*d;if(W>=1&&g>=1){var I=qd(W,g);1!==d&&(I.translate(I,$.x,$.y),I.scale(d,d),I.translate(I,-$.x,-$.y)),Tc(I,u),I.restore(),Hc(this,o,u.mat,u.vs,!0)}}},_29O:function(E,P,m){if(m(this.s(P+".transparent"))){var R=E.rect,o=E.textureScale,n=R.x,r=R.y,g=R.width*o,V=R.height*o;if(g>=1&&V>=1){R.x=R.y=0;var z=qd(g,V);1!==o&&z.scale(o,o),af(z,E),z.restore(),R.x=n,R.y=r,Hc(this,P,E.mat,E.vs,!1)}}},_99O:function(g,l,S,N,p,w){if(S){var r=this,L=r.gv,Q=r.data,M=L._buffer,x=L._1O,U=S.icons;for(var D in U){var B=U[D],j=S.rects[D];if(j&&w(Nq(B.transparent,Q,L))){ud(g,l,N,p,Q,D);var f=Nq(B.shape3d,Q,L),O=f?[f]:Nq(B.names,Q,L),k=O?O.length:0,W=Nq(B.textureScale,Q,L)||1,h=Nq(B.light,Q,L);h==I&&(h=f?!0:!1),jf(g,l,Nq(B.blend,Q,L),h,Nq(B.opacity,Q,L),Nq(B.reverseFlip,Q,L),Nq(B.reverseColor,Q,L),Nq(B.reverseCull,Q,L));for(var T=0;k>T;T++){var E=O[T],c=j[T];if(Qj(r,c.mat),f)Gl(L,Q,zb(r,f),r);else{var $=Bn(E);if($){var _=c.width*W,o=c.height*W;if(_>=1&&o>=1){var H=qd(_,o);ck(H,$,Nq(B.stretch,Q,L),0,0,_,o,Q,L),H.restore(),Vj(g,sm,x),vq(g,l,x,Nq(B.discardSelectable,Q,L),M.uv,Af),dh(g,M.vs,c.vs,l.aPosition),ap(g,M.ns,$m,l.aNormal),Qe(g,M.is,oi),Hn(g,0,oi.length),jl(g,l,x)}}}bj(L)}or(g,l)}}}}});var Tp=function(n,P){mj(Tp,this,[n,P])};Rq(Tp,Dd,{_16O:function(q,E,v,L,s,i,m,f,b){var B=this.data,r=B.getFinalScale3d(),k=ei(E,r,v,L,f,b);if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var l=B.getAnchor3d();k[0]-=(l.x-.5)*r[0],k[1]-=(l.y-.5)*r[1],k[2]-=(l.z-.5)*r[2]}return on(Tf(),k,B.p3(),L,s,i,m,q,B.getFinalRotation3d(),B.getRotationMode())},clear:function(){var W=this;W.faceMat=W.mat=W.shapeModel=W.left=W.right=W.front=W.back=W.top=W.bottom=W.csg=I},needValidate:function(v){if(this._iv)return this._validateFrameId=v._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var n=v._renderInfo.frame;if(this._validateFrameId!==n)return this._validateFrameId=n,!0}return!1},validate:function(x,w){var e=this,W=e.gv,t=e.data,m=e.shapeName=e.s(ji),F=zb(e,m);e._updateAutoRotation(),e._updateFixSize2d(),e._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(Lb(W,t,"_wireframeModelMap","_wireframeIndexMap"),Lb(W,t,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var h=vh(t,W.getMat(t),F?e.s("shape3d.scaleable"):!0);if(t.appendAnchorMatrix3d(h),t.mat=h,e.clear(),F||!m)if(x){var R=[];F?Gm(W,t,F,e,e.getBodyColor(),[h],x,R):(Wm(W,t,x,w,h,Hd,R,wm),Wm(W,t,x,w,h,Np,R,Jr),Wm(W,t,x,w,h,hq,R,Ql),Wm(W,t,x,w,h,Ce,R,Bq),Wm(W,t,x,w,h,Tk,R,Uc),Wm(W,t,x,w,h,Mn,R,rk)),R.length&&(Se(x.vs,R),Se(x.ns,tg(R)))}else e.mat=h,(e.shapeModel=F)||(e._cubeUvs=null,e.vf(Hd,0),e.vf(Np,16),e.vf(Tk,8),e.vf(Mn,24),e.vf(hq,32),e.vf(Ce,40))},_updateAutoRotation:function(){var M=new Sr,T=new _i,k=new He,h=new He,p=new He;return function(){var $=this,t=$.data,H=$.s("autorotate")||$.s("shape3d.autorotate");if(!H)return t._dynamicRotation&&delete t._dynamicRotation,void 0;var D=$.gv;p.copy($.s("shape3d.autorotate.up")||D._up);var x;x="string"==typeof H?[H.indexOf("x")<0?D._eye[0]:D._center[0],H.indexOf("y")<0?D._eye[1]:D._center[1],H.indexOf("z")<0?D._eye[2]:D._center[2]]:D._eye;var c=D._center,B=t.p3();k.copy(B),h.set(x[0]-c[0],x[1]-c[1],x[2]-c[2]).add(k),T.lookAt(h,k,p),M.set(0,0,0,t.getRotationMode(),!0).setFromRotationMatrix(T);var z=t._dynamicRotation;z&&Math.abs(z[0]-M.x)<1e-5&&Math.abs(z[1]-M.y)<1e-5&&Math.abs(z[2]-M.z)<1e-5||(t._dynamicRotation=[M.x,M.y,M.z])}}(),_updateFixSize2d:function(){var K=this,p=K.data,s=K.s("fixSizeOnScreen")||K.s("shape3d.fixSizeOnScreen");if(!s)return p._dynamicScale3d&&delete p._dynamicScale3d,void 0;var t=K.gv,j=vh(p,t.getMat(p)),x=Tl([0,0,0],j),O=t.toViewPosition(x);if(!isNaN(O.x)&&!isNaN(O.y)){var X=Tl([1,0,0],j),I=t.toViewPosition(X),B=Tl([0,1,0],j),q=t.toViewPosition(B),V=I.x-O.x,m=q.y-O.y;if(V&&m){var e,w,h=p._dynamicScale3d||[1,1,1],k=Bn(p.s("shape3d.image"));if(s[0]>0&&(e=s[0]),s[1]>0&&(w=s[1]),!e||!w){var Y=s>0?s:1;e||(e=(vk(k,p)||p.getWidth())*Y),w||(w=(ns(k,p)||p.getTall())*Y)}var T=Math.abs(V/e),C=Math.abs(m/w);Math.abs(T-1)<.001&&Math.abs(C-1)<.001||(p._dynamicScale3d=[h[0]/T,h[1]/C,h[2]])}}},_updateOverlapping:function(){var e=this,x=e.s("hide.overlapping.group");if(!x)return e._rectOverlapping&&(e._rectOverlapping=Q),void 0;var M,p,$,C=e.gv,s=e.data,o=vh(s,C.getMat(s)),P=1/0,b=1/0,I=-1/0,E=-1/0,n=s.getAnchor3d(),q=n.x,H=n.y,u=n.z;for(M=0;8>M;M++){if(p=Tl([(M>>2)-q,(1&M>>1)-H,(1&M)-u],o),$=C.toViewPosition(p),isNaN($.x)||isNaN($.y))return;P=Math.min(P,$.x),I=Math.max(I,$.x),b=Math.min(b,$.y),E=Math.max(E,$.y)}var B={x:P,y:b,w:I-P,h:E-b};e._rectOverlapping=C.overlappingBox.isOverlapping(x,B)},getVectorDynamicSize:function(){var c,b=this,y=b.s("shape3d"),X=b.data;if("billboard"===y||"plane"===y||(c=X._currentCubeElementId)!=I){var M,B,R=b.gv,h=vh(X,R.getMat(X)),C=X.getAnchor3d(),q=.5-C.x,i=.5-C.y,J=.5-C.z,G=b.s("vector.dynamic.maxsize"),z=function(b,a){b[0]+=q,b[1]+=i,b[2]+=J,a[0]+=q,a[1]+=i,a[2]+=J;var E=R.toViewPosition(Tl(b,h)),Q=R.toViewPosition(Tl(a,h)),p=E.x-Q.x,Z=E.y-Q.y;return Math.min(G,Math.sqrt(p*p+Z*Z))};if("billboard"===y)M=z([-.5,0,0],[.5,0,0]),B=z([0,-.5,0],[0,.5,0]);else if("plane"===y)M=z([-.5,0,0],[.5,0,0]),B=z([0,0,-.5],[0,0,.5]);else if(X._currentCubeElementId!=I){var A=3*gk[c+1],Q=3*gk[c],W=3*gk[c+2];M=z([ob[A],ob[A+1],ob[A+2]],[ob[W],ob[W+1],ob[W+2]]),B=z([ob[A],ob[A+1],ob[A+2]],[ob[Q],ob[Q+1],ob[Q+2]])}return[M,B]}},vf:function(s,N){var r=this;if(r.gv.getFaceVisible(r.data,s)){var W=cn(r,s);W.mat&&(r.faceMat=!0);var U=W.uv;if(U){var J=r._cubeUvs;J||(J=r._cubeUvs=new Ko([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var A=0;8>A;A++)J[N+A]=U[A]}return W}},_billboardInView:function(){var r=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],K=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],E=new yi,U=new He,n=new _i;return function(B){var $=this;if(!$.mat)return!0;var X=$.gv.getFrustum(),W="billboard"===B?r:K;E.makeEmpty(),n.fromArray($.mat);for(var L=0,Y=W.length;Y>L;L+=3)E.expandByPoint(U.fromArray(W,L).applyMatrix4(n));return X.intersectsBox(E)}}(),_80o:function(Z,L,_){var B=this;if(B._rectOverlapping)return!0;var o=B.shapeModel;if(o||!B.shapeName){var H=B.s("shape3d");if(("billboard"===H||"plane"===H)&&!B._billboardInView(H))return!0;var h=B.gv,U=B.data,M=h._cube;sf(h,B.mat),B.s("shape3d.reflector")&&!Z._picking||(o?Gl(h,U,o,B,B.getBodyColor(),_):(dh(Z,M.vs,I,L.aPosition),dh(Z,M.ns,I,L.aNormal),Zn(Z,M.is),B._18O(Z,L,"left",0,_),B._18O(Z,L,"front",6,_),B._18O(Z,L,"right",12,_),B._18O(Z,L,"back",18,_),B._18O(Z,L,"top",24,_),B._18O(Z,L,"bottom",30,_))),bj(h),B.faceMat&&(B._18O(Z,L,"left",0,_,!0),B._18O(Z,L,"front",6,_,!0),B._18O(Z,L,"right",12,_,!0),B._18O(Z,L,"back",18,_,!0),B._18O(Z,L,"top",24,_,!0),B._18O(Z,L,"bottom",30,_,!0))}},_18O:function(g,H,E,f,Q,G){var R=this[E];if(R){if(!Q(R.transparent))return;if(G&&!R.mat||!G&&R.mat)return;var C=this.data.s("polygonOffset");C&&we(g,C),G&&sf(this.gv,R.mat);var l=this,D=l.data;D._currentCubeElementId=f;var y=l.gv,F=y.getTexture(R.texture,D,E),t=R.uv,p=R.uvScale,c=R.uvOffset,x=R.discardSelectable;F?t?vq(g,H,F,x,y._buffer.uv,l._cubeUvs,c,p):vq(g,H,F,x,y._cube.uv,I,c,p):vq(g),jf(g,H,R.blend,R.light,R.opacity,R.reverseFlip,R.reverseColor,R.reverseCull),ac(g,H.uDiffuse,R.color||q["color.empty"]),Hn(g,f,6),or(g,H),jl(g,H,F),G&&bj(y),C&&Sp(g),D._currentCubeElementId=null}},drawReflector:function(){var z=new He,R=new He,K=new Sr,t=new _i,o=new He,s=new He,m=new He,a=new He,d=new _i,$=new _i,G=new _c,X=new wp,A=new wp,E=function(q,L,C){q[C]=L[0],q[C+1]=L[1],q[C+2]=L[2]},H=function(s,D){E(s,D.getEye(),0),E(s,D.getCenter(),3),E(s,D.getUp(),6)},U=function(v,o){o._eye=[v[0],v[1],v[2]],o._center=[v[3],v[4],v[5]],o._up=[v[6],v[7],v[8]],o._18Q=I;var V=o._skyBox;V&&(V.p3([v[0],v[1],v[2]]),o.getData3dUI(V).iv())};return function(W,u,v,B,y){var x=this;x._reflectorInfo=null;var F=x.data;if(F._reflecting)return!1;var N=x.gv;if(y)return!1;var i=x._reflectorRenderTarget;i?i.setSize(W,u,v):i=x._reflectorRenderTarget=new Pm.RenderTarget(N,W,u,v),z.copy(F.p3()),R.copy(N.getEye()),t.makeRotationFromEuler(K.set(F.r3(),F.getRotationMode(),!0));var D;if(!x._reflectNormal){var D=zb(x,x.s("shape3d"));if(!D)return!1;if(!D.ns&&D.length&&(D=D[0]),!D.ns||!D.vs)return!1;x._reflectNormal=[D.ns[0],D.ns[1],D.ns[2]],x._reflectorVbuffer=Dk.Buffer.createVertexBuffer(W,new Float32Array(D.vs))}if(o.copy(x._reflectNormal),o.applyMatrix4(t),s.subVectors(z,R),s.dot(o)>0)return!1;s.reflect(o).negate(),s.add(z),m.copy(N.getCenter()).negate().add(z),m.reflect(o).negate(),m.add(z),a.copy(N.getUp()),a.reflect(o);var c=[0,0,0,0,0,0,0,0,0];H(c,N),N._eye=s.toArray(),N._center=m.toArray(),N._up=a.toArray(),N._18Q=I;var _=N._skyBox;_&&(_.p3(N._eye),N.getData3dUI(_).iv()),pf(W,i.frame),W.viewport(0,0,i.width,i.height),W.clearColor(0,0,0,1),W.clear(W.COLOR_BUFFER_BIT);var f=jb(N),j=Gq(N);G.setFromNormalAndCoplanarPoint(o,z),G.applyMatrix4($.fromArray(j)),X.set(G.normal.x,G.normal.y,G.normal.z,G.constant),A.x=(Math.sign(X.x)+f[8])/f[0],A.y=(Math.sign(X.y)+f[9])/f[5],A.z=-1,A.w=(1+f[10])/f[14],X.multiplyScalar(2/X.dot(A));var Z=F.s("shape3d.reflector.clip"),k=Z===Q?.003:Z;f[2]=X.x,f[6]=X.y,f[10]=X.z+1-k,f[14]=X.w;var n=N._computedProjectMatrix;N._computedProjectMatrix=f,F._reflecting=!0,B(),N._computedProjectMatrix=n,d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply($.fromArray(N._projectMatrix)),d.multiply($.fromArray(N._viewMatrix)),Sj(W),U(c,N);var l=W._compiledShader.reflector;return l||(l=W._compiledShader.reflector=new Dk.Shader(W,ue.Reflector.vs,ue.Reflector.fs)),l.bind(),W.activeTexture(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,i.texture),l.uniforms.tDiffuse=0,l.uniforms.color=An(F.s("shape3d.reflector.color")||"rgb(128,128,128)"),l.uniforms.textureMatrix=d.toArray(),l.uniforms.modelMatrix=vh(F),l.uniforms.viewMatrix=Gq(N),l.uniforms.projectionMatrix=jb(N),x._reflectorVbuffer.upload(),l.attributes.pos.pointer(x._reflectorVbuffer),W.drawArrays(W.TRIANGLES,0,6),F._reflecting=!1,W.useProgram(N._prg),!0}}()}),ue.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Gc=function(T,b){mj(Gc,this,[T,b])};Rq(Gc,Dd,{_25Q:1,validate:function(H){var Y=this;if(!Y.s("geometry.cache")||!Y.info){var d=Y.gv,M=Y.data,p=Y.s,A=p("edge.width"),n=M._40I,k=M._41I;if(Y.shapeModel=Y.info=I,n&&k){var c,a,J,z,b,V,$,D,R,u,G=M.isLooped(),l=p(Cr),v=t.getEdgeType(l);if(v){var j=v(M,Pc(Y,d,M,G,l),d,Y._19Q);if(!j.points||j.points.isEmpty())return;V=Y.info={},$=j.segments,b=j.points,D=b.size();for(var h=n.getElevation(),C=k.getElevation(),x=0;D>x;x++){var w=b.get(x);w.e==I&&(w.e=h+(C-h)*x/(D-1))}R=kc(b.get(0)),u=kc(b.get(D-1));var q=D%2;0===q?(V.c1=kc(b.get(D/2-1)),V.c2=kc(b.get(D/2))):V.p3=kc(b.get((D-q)/2)),V.s1=R,V.s2=kc(b.get(1)),V.t1=kc(b.get(D-2)),V.t2=u}else{b=new up,V=Y.info={};var W=p("edge.offset"),i=p("edge.center"),T=p("edge.source.t3"),K=p("edge.target.t3"),g=zf(d,M,"source"),e=zf(d,M,"target");if(!g||!e)return d.invalidateData(M),delete Y.info,!1;if(T&&(g[0]+=T[0],g[1]+=T[1],g[2]+=T[2]),K&&(e[0]+=K[0],e[1]+=K[1],e[2]+=K[2]),l===Ar){$=p("edge.segments");var O=V.points=p(Ie)||bc;if(D=O.size()){R=kc(O.get(0)),u=kc(O.get(D-1)),!i&&W&&(J=Ti(R,g,!0),W=r(W,Oj(g,R)),g=[g[0]+J[0]*W,g[1]+J[1]*W,g[2]+J[2]*W],J=Ti(e,u,!0),W=r(W,Oj(u,e)),e=[e[0]-J[0]*W,e[1]-J[1]*W,e[2]-J[2]*W]);var q=D%2;0===q?(c=kc(O.get(D/2-1)),a=kc(O.get(D/2))):V.p3=kc(O.get((D-q)/2)),V.s1=g,V.s2=R,V.t1=u,V.t2=e}else!i&&W&&(J=Ti(e,g,!0),z=Oj(g,e),W=id(W,z),g=[g[0]+J[0]*W,g[1]+J[1]*W,g[2]+J[2]*W],e=[e[0]-J[0]*W,e[1]-J[1]*W,e[2]-J[2]*W]),c=g,a=e;b.add({x:g[0],y:g[2],e:g[1]}),b.addAll(O),b.add({x:e[0],y:e[2],e:e[1]})}else{var S=Pc(Y,d,M,G,l);if(Y._19Q||(S=-S),G){var m=g[0],f=g[1],o=g[2],X=n.getTall()/2+S;c=[m-S,f+X,o],a=[m+S,f+X,o],b.add({x:m-S,y:o,e:f}),b.add({x:m-S,y:o,e:f+X}),b.add({x:m+S,y:o,e:f+X}),b.add({x:m+S,y:o,e:f})}else{J=Ti(e,g,!0),z=Oj(g,e);var F={x:g[0],y:g[2]},y={x:e[0],y:e[2]},E=jk(I,F,y,S),Q=E.x-F.x,P=E.y-F.y;W=id(W,z),J[0]*=W,J[1]*=W,J[2]*=W,c=[g[0]+J[0]+Q,g[1]+J[1],g[2]+J[2]+P],a=[e[0]-J[0]+Q,e[1]-J[1],e[2]-J[2]+P],i?(b.add({x:g[0],y:g[2],e:g[1]}),b.add({x:c[0],y:c[2],e:c[1]}),b.add({x:a[0],y:a[2],e:a[1]}),b.add({x:e[0],y:e[2],e:e[1]})):(b.add({x:c[0],y:c[2],e:c[1]}),b.add({x:a[0],y:a[2],e:a[1]}))}}V.c1=c,V.c2=a}V._lastPointsSegments={points:b,segments:$},V.list=p(ji)===tf?Y.createTubeModel(b,$,A/2,H):Y.createLineModel(b,$,A,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=I}});var oq=function(b,C){mj(oq,this,[b,C])};Rq(oq,Tp,{_80o:function(D,P,t){var V=this,Z=V.gv,G=V.shapeModel;sf(Z,V.mat),G?Gl(Z,V.data,G,V,V.getBodyColor(),t):(Sd(V,D,P,"left",t),Sd(V,D,P,"front",t),Sd(V,D,P,"right",t),Sd(V,D,P,"back",t),Sd(V,D,P,"top",t),Sd(V,D,P,"bottom",t)),bj(Z)},validate:function(j,G){var T,J,V=this,x=V.s,g=V.data,Y=(g.p3(),g._thickness/2),C=g.isClosePath(),Q=g.getPoints(),b=g.getSegments(),s=x(Vf),y=j&&j.uv;if(V.clear(),0>Y){try{J=V.shapeModel=xh(Q,b,x(Mp),x(sr),s,x(od),g.getTall(),g.getShapeElevation(),C)}catch(l){J=V.shapeModel={}}x(ij)?x("shape3d.image")||delete J.uv:(delete J.vs,delete J.ns,delete J.uv),x("shape3d.top.image")||delete J.top_uv,x("shape3d.bottom.image")||delete J.bottom_uv}else if(x(ji)===tf)T=wn(Q,b,s,C),J=V.shapeModel={vs:[]},x("shape3d.image")&&(J.uv=[],J.sum=x(od)||Jg(T)||1,J.len=0),x(Mp)&&!C&&(J.top_vs=[],x("shape3d.top.image")&&(J.top_uv=[])),x(sr)&&!C&&(J.bottom_vs=[],x("shape3d.bottom.image")&&(J.bottom_uv=[])),V._12O(T,Y);else{var H,L,$,w,S,k,E,t,_,D;if(T=wn(Q,b,s,C),S=V.vf(Tk,y,!1,G),Y&&(k=V.vf(Mn,y,!1,G),E=C?I:V.vf(Hd,y,!1,G),t=C?I:V.vf(Np,y,!1,G),_=V.vf(hq,y,!1,G),D=V.vf(Ce,y,!1,G)),Y){for(var W=0,q=T.length;q>W;W++)T[W]=V._tryRemoveBezierPoints(T[W],Y);V._12O(T,Y)}else S&&T.forEach(function(e){if(w=e.length,w>0)for(H=e[0],$=1;w>$;$++)L=e[$],V.addV(S.vs,H,L),H=L});V._20Q(T),j||(S&&(S.ns=tg(S.vs),Nm(S,"vs"),Nm(S,np)),Y&&(k&&(k.ns=tg(k.vs),Nm(k,"vs"),Nm(k,np)),E&&(E.ns=tg(E.vs),Nm(E,"vs"),Nm(E,np)),t&&(t.ns=tg(t.vs),Nm(t,"vs"),Nm(t,np)),_&&(_.ns=tg(_.vs),Nm(_,"vs"),Nm(_,np)),D&&(D.ns=tg(D.vs),Nm(D,"vs"),Nm(D,np))))}var P=V.mat=g.getPointsMatrix3d().getElements();j&&(Jf(V,P,j,J),V.clear())},_20Q:function(c){var J,$,X,n,y,H,k,m=this,x=m.front,Y=m.back,N=m.top,z=m.bottom,s=x?x.tuv:I,b=Y?Y.tuv:I,A=N?N.tuv:I,W=z?z.tuv:I,_=0;(s||b||A||W)&&(J=m.s(od)||Jg(c)||1,c.forEach(function(Z){if($=Z.length,$>0)for(H=Z[0],X=1;$>X;X++)k=Z[X],n=_/J,_+=Oj(H,k),y=_/J,m._14O(x,n,y),m._14O(Y,1-y,1-n),m._14O(N,n,y),m._14O(z,n,y),H=k}))},_14O:function(z,q,A){if(z){var P=z.uv,J=z.tuv;if(J){if(P)var r=P[0]+(P[6]-P[0])*q,l=P[1]+(P[7]-P[1])*q,E=P[2]+(P[4]-P[2])*q,G=P[3]+(P[5]-P[3])*q,X=P[2]+(P[4]-P[2])*A,L=P[3]+(P[5]-P[3])*A,x=P[0]+(P[6]-P[0])*A,h=P[1]+(P[7]-P[1])*A;else r=q,l=0,E=q,G=1,X=A,L=1,x=A,h=0;J.push(E,G,X,L,x,h,x,h,r,l,E,G)}}},_13O:function(i){var J=i.uv,O=i.tuv;O&&(J?O.push(J[2],J[3],J[4],J[5],J[6],J[7],J[6],J[7],J[0],J[1],J[2],J[3]):O.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(Q,y){var E=Q.length;if(4>E)return Q;var D,L,U,H,u,Y,F=!1,X=function(k){return Q[k]},p=function(h){return Q[E-1-h]};for(u=0;1>=u;u++)for(Y=u?p:X,L=Y(0),U=Y(1),D=2;E-1>D;D++)if(H=Y(D),!H.remove)if(H.b){var d=jk(L,U,H,y);d.adjust?(H.remove=!0,F=!0):(L=U,U=H)}else L=U,U=H;if(!F)return Q;var c=[];for(D=0;E>D;D++)Q[D].remove||c.push(Q[D]);return c},_12O:function(g,s){var Z,G,V,N,c,w=this.s("shape3d.point.epsilon"),x=this;g.forEach(function(h){if(c=h.length,c>0)for(Z={p:h[0],n:!0},N=1;c>N;N++)G=h[N],V=c-1>N?h[N+1]:I,V&&Math.abs(G.x-V.x)<w&&Math.abs(G.y-V.y)<w||x.addPoint(Z,G,V,s,h)})},addPoint:function(Y,m,H,p,P){var n,T,z,D,U,w,s,J,S,d=this,Q=Y.p,A=Y.f,G=Y.b,C=d.s("shape3d.side")||cl,t=d.s("shape3d.start.angle"),u=d.s("shape3d.sweep.angle"),j=d.shapeModel,_=d.data.isClosePath();if(Y.n&&(Y.n=!1,A=_&&P.length>2?jk(P[P.length-2],Q,m,p):jk(I,Q,m,p),G=ee(Q,A),j?j.top_vs&&d._10O(G,A,C,t,u,j.top_vs,j.top_uv):(n=d.left)&&(d.addV(n.vs,G,A),d._13O(n))),T=H?jk(Q,m,H,p):_&&P.length>2?jk(Q,m,P[1],p):jk(Q,m,I,p),z=ee(m,T),j){var O,k,y=j.vs,$=j.uv,Z=j.sum;for($&&(O=j.len/Z,j.len+=Oj(Q,m),k=j.len/Z),w=d._9O(G,A,C,t,u),s=d._9O(z,T,C,t,u),J=0;C>J;J++)S=J+1,Se(y,w[S]),Se(y,s[J]),Se(y,w[J]),Se(y,s[J]),Se(y,w[S]),Se(y,s[S]),$&&(D=J/C,U=S/C,$.push(O,U,k,D,O,D,k,D,O,U,k,U));!H&&j.bottom_vs&&d._10O(z,T,C,t,u,j.bottom_vs,j.bottom_uv,!0)}else!H&&(n=d.right)&&(d.addV(n.vs,T,z),d._13O(n)),(n=d.front)&&d.addV(n.vs,A,T),(n=d.back)&&d.addV(n.vs,z,G),(n=d.top)&&d.addH(n.vs,A,T,z,G,!0),(n=d.bottom)&&d.addH(n.vs,G,z,T,A);Y.p=m,Y.f=T,Y.b=z},_10O:function(T,Y,V,o,t,b,k,_){var p,G,F=this,h=F.data,W=F._9O(T,Y,V,o,t),d=(T.x+Y.x)/2,c=(T.y+Y.y)/2,a=h.getShapeElevation(),l=0;for(l=0;V>l;l++)_?(Se(b,W[l]),Se(b,W[l+1])):(Se(b,W[l+1]),Se(b,W[l])),Se(b,[d,a,c]),k&&(_?(p=E*(l+1)/V+o,G=E*l/V+o):(p=E*l/V+o,G=E*(l+1)/V+o),k.push(.5-.5*x(G),.5-.5*C(G),.5-.5*x(p),.5-.5*C(p),.5,.5))},_9O:function(D,J,z,O,d){var r,R,f=this,F=f.data,j=[],B=(D.x+J.x)/2,i=(D.y+J.y)/2,g=F.getTall()/2,_=F.getShapeElevation(),p=0;for(d==I&&(d=E);z>=p;p++)r=d*p/z+O,R=x(r),j.push([B+(D.x-B)*R,_+g*C(r),i+(D.y-i)*R]);return j},addV:function(b,K,T){var g=K.x,a=K.y,G=T.x,e=T.y,f=this.data,p=f.getShapeElevation(),m=f.getTall()/2;b.push(g,p-m,a,G,p-m,e,G,p+m,e,G,p+m,e,g,p+m,a,g,p-m,a)},addH:function(k,H,z,Y,Z,W){var E=this.data,X=E.getTall()/2,y=E.getShapeElevation()+(W?X:-X);k.push(H.x,y,H.y,z.x,y,z.y,Y.x,y,Y.y,Y.x,y,Y.y,Z.x,y,Z.y,H.x,y,H.y)},vf:function(K,x,c,T){var L,r=this,$=r.gv.getFaceVisible(r.data,K);return(c||$)&&(L=cn(r,K,T),L.vs=[],L.tuv=$&&(L.texture||x)?[]:I,L.visible=$),L}});var wg=function(u,Z){mj(wg,this,[u,Z])};Rq(wg,Dd,{_25Q:1,validate:function(P){var w=this,z=w.data,U=w.s,y=z.getPoints(),m=y.size();if((!w.s("geometry.cache")||!w.shapeModel)&&(w.shapeModel=w.info=I,m>1)){var B=w.info={},q=z.getSegments(),r=z.getThickness(),Z=kc(y.get(0)),J=kc(y.get(m-1)),u=m%2;0===u?(B.c1=kc(y.get(m/2-1)),B.c2=kc(y.get(m/2))):B.p3=kc(y.get((m-u)/2)),B.s1=Z,B.s2=kc(y.get(1)),B.t1=kc(y.get(m-2)),B.t2=J,B.list=U(ji)===tf?w.createTubeModel(y,q,r/2,P):w.createLineModel(y,q,r,"shape.border","shape.dash")}var t=z.p3(),g=w.mat=Tf();kl(g,t),Dn(g,z.getFinalRotation3d(),z.getRotationMode());var V=z.getScale3d(),F=z._dynamicScale3d;F&&(V[0]*=F[0],V[1]*=F[1],V[2]*=F[2]),Ff(g,V),kl(g,Mg(t))},invalidateCachedGeometry:function(){this.shapeModel=this.info=I},_80o:function(U,e,$){var y=this,X=y.shapeModel;if(X){var T=y.gv;sf(T,y.mat),Gl(T,y.data,X,y,y.getBodyColor(),$),bj(T)}}});var ms=v.graph3d.VR=function(o){var x=this;x.gv=o,x._controllers=[],x.switch=new mi(x),x._enable=!1,x._defaultCallLater=v.Default.callLater,x._defaultCancelLater=hr,"undefined"!=typeof B&&"VRFrameData"in B&&(x._frameData=new B.VRFrameData),x.measureOflength=1,x.eyesOffset=[0,0,0],x._orientation=new v.Math.Quaternion,x._lastHeadPose=[0,0,0],x._offsetToBeAdd=[0,0,0],x._fpsInfo={time:0,fps:0,frames:0}};Rq(ms,Y,{ms_fire:!0,_42:function(J,s,K,w){var P=this,a=P.gv;if(!a.drawFilter&&P._deviceInAction){var R=P._device;if(R){var d=P._measureOflength;R.depthNear=a.getNear()*d,R.depthFar=a.getFar()*d;var b=P._offsetToBeAdd;if(P.eyesOffset[0]+=b[0],P.eyesOffset[1]+=b[1],P.eyesOffset[2]+=b[2],b[0]=0,b[1]=0,b[2]=0,R.isPresenting===!1)return P._controllers.forEach(function(S){S&&S.update()}),a.iv(),!1;var X=P._frameData;R.getFrameData(X);var y=X.pose.position;if(y){var Q=P.toViewPosition(y);a.setEye(Q),P._orientation.fromArray(X.pose.orientation);var f=new v.Math.Vector3(0,0,-10*P._scaleFactor);f.applyQuaternion(P._orientation),a.setCenter([Q[0]+f.x,Q[1]+f.y,Q[2]+f.z])}P._controllers.forEach(function(N){N&&N.update()}),a.setViewport(J,0,0,s/2,K),P._viewMatrix=P._copyViewMatrix(X.leftViewMatrix),P._projectMatrix=P._copyProjectMatrix(X.leftProjectionMatrix),w(),a.setViewport(J,s/2,0,s/2,K),P._viewMatrix=P._copyViewMatrix(X.rightViewMatrix),P._projectMatrix=P._copyProjectMatrix(X.rightProjectionMatrix),w(),P._lastViewMatrix=P._viewMatrix,P._lastProjectMatrix=P._projectMatrix,P._viewMatrix=null,P._projectMatrix=null,P.submitFrame();var h=Date.now(),V=P._fpsInfo;return h-V.time>1e3?(V.fps=Math.round(1e3*(V.frames+1)/(h-V.time)),V.time=h,V.frames=0):V.frames++,!0}}},onVRDisplayPresentChange:function(){var j=this.isPresenting();this._injectGraphView(j),this.fp("present",!j,j)},getOrientation:function(){return this._orientation},addController:function(p){p=p||0;var n=this,X=n.getController(p);return X?X:(X=new kr(n,p),n._controllers.push(X),X)},getController:function(x){x=x||0;for(var P=this._controllers,A=0,G=P.length;G>A;A++)if(P[A]&&P[A].id===x)return P[A];return null},removeController:function(k){k=k||0;for(var h=this._controllers,z=0,c=h.length;c>z;z++)if(h[z]&&h[z].id===k)return h.splice(z,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(x,d){var H=this,e=H._scaleFactor,W=H._eyesOffset,$=H._lastHeadPose;return $[0]=x[0]*e,$[1]=x[1]*e,$[2]=x[2]*e,d?(d[0]=$[0]+W[0],d[1]=$[1]+W[1],d[2]=$[2]+W[2],d):[$[0]+W[0],$[1]+W[1],$[2]+W[2]]},addEyesOffset:function(z,E,v){var a=this._offsetToBeAdd;a[0]+=z,a[1]+=E,a[2]+=v},_copyViewMatrix:function(j){var w=this.dup(j),Y=this._scaleFactor;w[12]*=Y,w[13]*=Y,w[14]*=Y;var e=this._eyesOffset;if(e&&(e[0]||e[1]||e[2])){var S=e[0],r=e[1],p=e[2];w[12]-=w[0]*S+w[4]*r+w[8]*p,w[13]-=w[1]*S+w[5]*r+w[9]*p,w[14]-=w[2]*S+w[6]*r+w[10]*p}return w},shutdown:function(){var p=this._device;p&&p.isPresenting&&p.exitPresent()},isPresenting:function(){var v=this._device;return v&&v.isPresenting},_copyProjectMatrix:function(N){var e=this.dup(N),Q=this._scaleFactor;return e[14]*=Q,e},dup:function(z,q){for(var R=z.length,p=q||new Array(R);R--;)p[R]=z[R];return p},getViewMatrix:function(j){var k=this._viewMatrix;return k?this.dup(k,j):void 0},getProjectMatrix:function(){var E=this._projectMatrix;return E?this.dup(E):void 0},submitFrame:function(){var $=this;if($._enable&&$._deviceInAction){var o=$._device;o&&o.isPresenting&&(o.submitFrame(),$.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(k){var g=this.gv;return g.intersectObjects(k,g.dm().getDatas())},setDevice:function(r){var J=this;J._device=r},_injectGraphView:function(){var J,t,u;return function(q){var d=this.gv;if(!q)return J&&(d.getWidth=J,d.getHeight=t,d.getDevicePixelRatio=u),void 0;var W=this._device,f=W.getEyeParameters("left"),k=f.renderWidth,X=f.renderHeight;J=d.getWidth,t=d.getHeight,u=d.getDevicePixelRatio,d.getWidth=function(){return 2*k},d.getHeight=function(){return X},d.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(Q){var N=this;if(!Q)return ve=v.Default.callLater=N._defaultCallLater,hr=v.Default.cancelLater=N._defaultCancelLater,void 0;var N=this;ve=v.Default.callLater=function(C,i,s,c){var B=N._device;return B&&B.isPresenting?c?V(function(){ve(C,i,s)},c):B.requestAnimationFrame(function(){N._deviceInAction=!0,C.apply(i,s),N._deviceInAction=!1}):N._defaultCallLater(C,i,s,c)},hr=v.Default.cancelLater=function(J,b){var D=N._device;return D&&D.isPresenting?b?S(J):D.cancelAnimationFrame(J):N._defaultCancelLater(J,b)}}}),Y.defineProperties(ms.prototype,{enable:{get:function(){return this._enable},set:function($){var b=this;b._enable!==$&&(b._enable=$,$?(b.switch.showButton(),b._injectCallLaterFunc(!0)):(b.shutdown(),b.switch.hideButton(),b._injectCallLaterFunc(!1)),b.fp("enable",!$,$))}},measureOflength:{get:function(){return this._measureOflength},set:function(C){this._measureOflength=C;var E=this._scaleFactor=1/C;this._controllers.forEach(function(d){d&&d._setScaleFactor(E)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(y){this._eyesOffset=y}},controllerModel:{get:function(){return this._controllerModel},set:function(q){var W;"object"==typeof q?(W=q.mtl,q=q.obj):(W=q+".mtl",q+=".obj");var Q=this,j=Q._controllerModel;j&&j.obj===q&&j.mtl===W||(j=Q._controllerModel={obj:q,mtl:W},t.loadObj(q,W,{finishFunc:function(G,V){Q._controllerModel===j&&t.setShape3dModel("vrControllerModel",V)
}}))}},interactive:{get:function(){return!!this._interactive},set:function(e){!!e!=!!this._interactive&&(this._interactive=e,e&&this.addController(0),this.gv.getCoreInteractor().enableVR(e))}}});var kr=function(B,J){function r(W){var c=navigator.getGamepads&&navigator.getGamepads();if(c)for(var X=0,l=0,s=c.length;s>X;X++){var C=c[X];if(C){var x=C.id;if("OpenVR Gamepad"===x||0===x.indexOf("Oculus Touch")||x.indexOf("Controller")>=0){if(l===W)return C;l++}}}}function y(r,T,p){return Math.abs(r[0]-T[0])<p&&Math.abs(r[1]-T[1])<p&&Math.abs(r[2]-T[2])<p?!0:!1}var o=this;o.vr=B,o.id=J;var d,I,v=[0,0],L=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],e=new Mh;e.s("shape3d","vrControllerModel"),e.isController=!0,e.s("intersect",!1),o.getGamepad=function(){return I},o.isButtonPressed=function(U){for(var S,O=0,B=L.length;B>O;O++)if(S=L[O],S.id===U)return S.pressed;return!1},o.getNode=function(){return e};var l=.003;o.setRotationEpsilon=function(H){l=H};var i=5e-4,E=i;o.setPositionEpsilon=function(K){i=K,E=K*o.vr._scaleFactor},o._setScaleFactor=function(B){e.s3(B,B,B),E=i*B},o._setScaleFactor(o.vr._scaleFactor);var s,P=new Bb,w=new _i,S=[0,0,0],K=[0,0,0],b=new Sr,Z=new He,F=new Pl;o.getRay=function(){return s?(F.origin.fromArray(S),F.direction.copy(Z),s=!1,F):F},o.update=function(){if(d=I,I=r(J),d!=I&&console.log("gamepad changed",I),!I||I.pose===Q)return I=null,e.s("3d.visible",!1),void 0;if(t.getShape3dModel("vrControllerModel")){e.dm()||B.gv.dm().add(e),e.s("3d.visible",!0);var _=I.pose;if(null!==_){_.position&&(o.vr.toViewPosition(_.position,S),y(e.p3(),S,E)||(s=!0,e.p3(S))),_.orientation&&(P.fromArray(_.orientation),Z.set(0,0,-1).applyQuaternion(P).normalize(),w.makeRotationFromQuaternion(P),b.set(0,0,0,e.getRotationMode(),!0).setFromRotationMatrix(w),K[0]=b.x,K[1]=b.y,K[2]=b.z,y(e.r3(),K,l)||(s=!0,e.r3(K))),s&&B.fp("gamepad.pose",null,{position:S,rotation:K,id:J});var q=I.axes;(v[0]!==q[0]||v[1]!==q[1])&&(v=[q[0],q[1]],B.fp("gamepad.axes",null,{id:J,axes:v}));var D,x,p,M,Y=I.buttons;for(D=0,x=Y.length;x>D;D++)if(p=Y[D],p&&(M=p.pressed,L[D]||(L[D]={id:"button"+D,pressed:!1}),M!==L[D].pressed)){L[D].pressed=M;var V={id:J},j="state";V[j]=V._62O=M?"down":"up",B.fp("gamepad.button."+L[D].id,null,V)}}}}},mi=function(_){this.vr=_,this._button=null};Rq(mi,Y,{showButton:function(){var X=this.assureButton();if(!X.parentNode){var a=this.vr.gv,c=a.getView();a._79O?c.insertBefore(X,a._79O):c.appendChild(X)}},hideButton:function(){var s=this._button;s&&s.parentNode&&s.parentNode.removeChild(s)},assureButton:function(){var R=this._button;return R?R:this._button=this.createButton(this.vr.gv)},createButton:function(E){function p(I,C){I.textContent=C&&C.isPresenting?" VR ":" VR "}function T(w){m.style.display="",m.style.cursor="pointer",m.style.left="calc(50% - 50px)",m.style.width="100px",p(m,w),m.onmouseenter=function(){m.style.opacity="1.0"},m.onmouseleave=function(){m.style.opacity="0.5"},m.onclick=function(){w.isPresenting?w.exitPresent():w.requestPresent([{source:E.getCanvas()}])},E.vr.setDevice(w)}function L(){m.style.display="",m.style.cursor="auto",m.style.left="calc(50% - 75px)",m.style.width="150px",p(m,null),m.onmouseenter=null,m.onmouseleave=null,m.onclick=null,E.vr.setDevice(null)}function e(w){w.style.position="absolute",w.style.bottom="20px",w.style.padding="12px 6px",w.style.border="1px solid #fff",w.style.borderRadius="4px",w.style.color="#000",w.style.font="normal 13px sans-serif",w.style.textAlign="center",w.style.opacity="0.5",w.style.outline="none",w.style.zIndex="999"}if("getVRDisplays"in navigator){var m=this._button=M.createElement("button");return m.style.display="none",e(m),J(B,"vrdisplayconnect",function(_){T(_.display)}),J(B,"vrdisplaydisconnect",function(){L()}),J(B,"vrdisplaypresentchange",function(j){p(m,j.display),E.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(z){z.length>0?T(z[0]):L()}),m}var Q=M.createElement("a");return Q.href="https://webvr.info",Q.innerHTML=" webvr",Q.style.left="calc(50% - 90px)",Q.style.width="180px",Q.style.textDecoration="none",e(Q),Q}}),Y.defineProperties(mi.prototype,{});var Ep=v.graph3d.PostProcessing=function(o){function U(){if(!l){var z=o.getGL();l=new Pm.RenderTarget(o,z,null,null,{samples:q.renderTextureSamples||1}),L=new Dk.Shader(z,R.vs,R.fs),j=Dk.Buffer.createIndexBuffer(z,new Uint16Array([0,2,1,1,2,3])),c=Dk.Buffer.createVertexBuffer(z,new Float32Array([0,0,1,0,0,1,1,1]))}}var l,L,j,c,z=this,B={},x=!1;!function(){Y.keys(Ep).forEach(function(g){B[g]=new Ep[g](o)})}(),z.getModule=function(m){return m?B[m]:z},z.getModuleList=function(){return Y.keys(B)},z._serializable=!0,z.handleDataModleChange=function(h,S){h&&(z._serializable&&h.setPostProcessingData(z.serialize()),h.removeSerializeListener(z.onDataModelSerialize,z)),S&&(S.addSerializeListener(z.onDataModelSerialize,z),z._serializable&&z.deserialize(S.getPostProcessingData()))},z.onDataModelSerialize=function(E){z._serializable&&("serialize"===E.type?o.dm()._postProcessingData=z.serialize():"deserialize"===E.type&&z.deserialize(o.dm().getPostProcessingData()))},z.isSerializable=function(){return z._serializable},z.setSerializable=function(g){z._serializable=g,g||o.dm().setPostProcessingData(Q)},z.serialize=function(){var j,g,Q,J,b={};for(g in B)if(Q=B[g],J=Q.serializeProperties){j={},Q.enable&&(j.enable=!0);for(var T in J){var x=Q[T];x!=J[T]&&(j[T]=x)}Y.keys(j).length&&(b[g.toLowerCase()]=j)}return b},z.deserialize=function(r){var M,P,O,d,X,y={};if(r)for(P in r)if(P&&(M=P[0].toUpperCase()+P.slice(1),O=B[M])){y[M]=!0,d=r[P],z.enableModule(M,!!d.enable),O.resetProperties&&O.resetProperties();for(X in d)"enable"!==X&&(O[X]=d[X])}for(M in B)y[M]||(O=B[M],O.enable=!1,O.resetProperties&&O.resetProperties())},z.decodeShader=function(p){var x,z,y,$="",i="";for(y=0;y<p.length;y++)x=p[y],"%"===x?x="'":"a"===x?x='"':"]"===x&&(x="\\"),z=String.fromCharCode(x.charCodeAt(0)-1),y%2?i+=z:$=z+$;return i+$},z.createShader=function(O,g,B){var V=g.indexOf("^#"),$=z.decodeShader(g.substr(0,V)),r=z.decodeShader(g.substr(V+2));if(B){var l=B($,r);l&&l.vs&&($=l.vs),l&&l.fs&&(r=l.fs)}return new Dk.Shader(O,$,r)},z.enableModule=function(L,h){var X,K,S,y=L.split(",");for(X=0,K=y.length;K>X;X++)S=y[X].trim(),B[S]&&(B[S].enable=h);x=!1;for(S in B)if(B[S].enable){x=!0;break}x&&U()};var R={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};z._42=function(z,Y,Z,K,b){if(x&&!b){l.setSize(z,Y,Z),l.bind(z);var E=z.getParameter(z.COLOR_CLEAR_VALUE);E&&0===E[0]&&0===E[1]&&0===E[2]&&0===E[3]?E=null:md(z,[0,0,0,0]),z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),o.setViewport(z,0,0,Y,Z),K(),l.unbind(z);for(var q=0,S=o._glCapabilities.maxAttributes;S>q;q++)z.disableVertexAttribArray(q);var H,W=l;for(H in B)W=B[H]._42(z,W)||W;return o.setViewport(z,0,0,Y,Z),E&&md(z,E),z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),L.bind(),z.activeTexture(z.TEXTURE0+0),z.bindTexture(z.TEXTURE_2D,W.texture),L.uniforms.image=0,j.upload(),c.upload(),L.attributes.pos.pointer(c),z.drawElements(z.TRIANGLES,6,z.UNSIGNED_SHORT,0),z.bindTexture(z.TEXTURE_2D,null),z.useProgram(o._prg),!0}}},Wp=v.graph3d.PostProcessing.Bloom=function(a){function A(){var E=a.getGL();if(E)for(var B=a._postProcessing,y=0;j>y;y++)G[y]=B.createShader(E,Wp._35Q,function(J,N){return{fs:N.replace(/DEFINE_VALUE/g,X[y]).replace("%OVERRIDE_ALPHA_DEFINE%",p?"#define OVERRIDE_ALPHA":"")}})}function s(){var w=a.getWidth(),Y=a.getHeight();if(w&&Y){M=[w,Y],W=!0;var s,t=a.getGL(),e=Math.round(M[0]/2),X=Math.round(M[1]/2);for(z=new Pm.RenderTarget(a,t,e,X),s=0;j>s;s++)J.push(new Pm.RenderTarget(a,t,e,X)),v.push(new Pm.RenderTarget(a,t,e,X)),e=Math.round(e/2),X=Math.round(X/2);var r=a._postProcessing;T=r.createShader(t,Wp._34Q),A(),P=r.createShader(t,Wp._36Q,function(b,u){return{fs:u.replace(/NUM_MIPS/g,j)}}),$=r.createShader(t,Wp.finalShader),k=Dk.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),y=Dk.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1]))}}var I,R,l,p,k,y,g=this,K=!1,W=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var w=this.serializeProperties;for(var p in w)this[p]=w[p]},Y.defineProperties(g,{enable:{get:function(){return K},set:function(N){!!K!=!!N&&(K=N,N&&!W&&s(),a.iv())}},strength:{get:function(){return I},set:function(F){I!==F&&(I=F,a.iv())}},threshold:{get:function(){return R},set:function(M){R!==M&&(R=M,a.iv())}},radius:{get:function(){return l},set:function(b){l!==b&&(l=b,a.iv())}},overrideAlpha:{get:function(){return p},set:function(H){!!p!=!!H&&(p=H,W&&A(),a.iv())}}}),this.resetProperties();var z,T,P,$,M=[256,256],J=[],v=[],j=5,X=[3,5,7,9,11],G=[];g._42=function(Z,r){function B(u,M,B,G){pf(Z,M.frame),a.setViewport(Z,0,0,M.width,M.height),G?G(Z):Z.clear(Z.COLOR_BUFFER_BIT|Z.DEPTH_BUFFER_BIT),b!==u&&u.bind();var l=0;for(var i in B){var n=B[i];n instanceof WebGLTexture&&(Z.activeTexture(Z.TEXTURE0+l),Z.bindTexture(Z.TEXTURE_2D,n),n=l,l++),u.uniforms[i]=n}for(b!==u&&(k.upload(),y.upload(),u.attributes.pos.pointer(y),b=u),Z.drawElements(Z.TRIANGLES,6,Z.UNSIGNED_SHORT,0);l--;)Z.activeTexture(Z.TEXTURE0+l),Z.bindTexture(Z.TEXTURE_2D,null);Sj(Z)}if(K&&(W||(s(),W))){var b;B(T,z,{smoothWidth:.01,luminosityThreshold:R,tDiffuse:r.texture});var L,t=z,e=Math.round(M[0]/2),N=Math.round(M[1]/2);for(L=0;j>L;L++)B(G[L],J[L],{colorTexture:t.texture,direction:[1,0],texSize:[e,N]}),B(G[L],v[L],{colorTexture:J[L].texture,direction:[0,1],texSize:[e,N]}),e=Math.round(e/2),N=Math.round(N/2),t=v[L];return B(P,J[0],{blurTexture1:v[0].texture,blurTexture2:v[1].texture,blurTexture3:v[2].texture,blurTexture4:v[3].texture,blurTexture5:v[4].texture,bloomStrength:I,bloomRadius:l,bloomTintColor:[1,1,1]}),B($,r,{image:J[0].texture},function(T){T.enable(T.BLEND),T.blendEquation(T.FUNC_ADD),T.blendFunc(T.SRC_ALPHA,T.ONE)}),Z.blendEquationSeparate(Z.FUNC_ADD,Z.FUNC_ADD),Z.blendFuncSeparate(Z.SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA,Z.ONE,Z.ONE_MINUS_SRC_ALPHA),r}}};Wp._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Wp._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Wp._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Wp.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Id=v.graph3d.PostProcessing.Dof=function(t){function m(){C=!0;var Z=t.getGL();A=new Pm.RenderTarget(t,Z),M=t._postProcessing.createShader(Z,Id._38Q),h=Dk.Buffer.createIndexBuffer(Z,new Uint16Array([0,2,1,1,2,3])),e=Dk.Buffer.createVertexBuffer(Z,new Float32Array([0,0,1,0,0,1,1,1]))}var A,M,h,e,U,x,k,g,H=this,q=!1,C=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var e=this.serializeProperties;for(var s in e)this[s]=e[s]},Y.defineProperties(H,{enable:{get:function(){return q},set:function(y){!!q!=!!y&&(q=y,y&&!C&&m(),t.iv())}},image:{get:function(){return x},set:function(O){x!==O&&(x=O,U&&(t.getGL().deleteTexture(U),U=null),t.iv())}},maxblur:{get:function(){return k},set:function(u){k!==u&&(k=u,t.iv())}},aperture:{get:function(){return g},set:function(F){g!==F&&(g=F,t.iv())}}}),this.resetProperties(),H._42=function(R,b){function Y($,B,y,c){pf(R,B.frame),t.setViewport(R,0,0,B.width,B.height),c?c(R):R.clear(R.COLOR_BUFFER_BIT|R.DEPTH_BUFFER_BIT),j!==$&&$.bind();var H=0;for(var b in y){var f=y[b];f instanceof WebGLTexture&&(R.activeTexture(R.TEXTURE0+H),R.bindTexture(R.TEXTURE_2D,f),f=H,H++),$.uniforms[b]=f}for(j!==$&&(h.upload(),e.upload(),$.attributes.pos.pointer(e),j=$),R.drawElements(R.TRIANGLES,6,R.UNSIGNED_SHORT,0);H--;)R.activeTexture(R.TEXTURE0+H),R.bindTexture(R.TEXTURE_2D,null);Sj(R)}if(q){C||m();var j;if(!U){var y=Bn(this.image);if(!y||!y.tagName)return b;U=Vj(R,y)}var V=b.width,i=b.height;if(V&&i)return A.setSize(R,V,i),Y(M,A,{tColor:b.texture,tDepth:U,aspect:V/i,aperture:this.aperture,maxblur:this.maxblur}),A}}};Id._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Fd(t,{accordionViewExpandIcon:Hi(Ue),accordionViewCollapseIcon:Hi(Ue,!0),accordionViewLabelColor:Uk,accordionViewLabelFont:nk,accordionViewTitleBackground:Kl,accordionViewSelectBackground:ps,accordionViewSelectWidth:3,accordionViewSeparatorColor:Q,splitViewDividerSize:1,splitViewDividerBackground:Kl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Uf,rect:[2,2,12,12],background:Ue}]},propertyViewLabelColor:yl,propertyViewLabelSelectColor:Uk,propertyViewLabelFont:nk,propertyViewExpandIcon:Hi(ub),propertyViewCollapseIcon:Hi(ub,!0),propertyViewBackground:oe,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:uo,propertyViewColumnLineColor:uo,propertyViewSelectBackground:ps,listViewLabelColor:yl,listViewLabelSelectColor:Uk,listViewLabelFont:nk,listViewRowLineVisible:!1,listViewRowLineColor:uo,listViewSelectBackground:ps,treeViewLabelColor:yl,treeViewLabelSelectColor:Uk,treeViewLabelFont:nk,treeViewExpandIcon:Hi(fs),treeViewCollapseIcon:Hi(fs,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:uo,treeViewSelectBackground:ps,treeViewDoubleClickToToggle:!0,tableViewLabelColor:yl,tableViewLabelSelectColor:Uk,tableViewLabelFont:nk,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:uo,tableViewColumnLineColor:uo,tableViewSelectBackground:ps,treeTableViewLabelColor:yl,treeTableViewLabelSelectColor:Uk,treeTableViewLabelFont:nk,treeTableViewExpandIcon:Hi(fs),treeTableViewCollapseIcon:Hi(fs,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:uo,treeTableViewColumnLineColor:uo,treeTableViewSelectBackground:ps,tableHeaderLabelColor:yl,tableHeaderLabelFont:nk,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Jl,tableHeaderBackground:oe,tableHeaderMoveBackground:ci,tableHeaderInsertColor:ps,tableHeaderSortDescIcon:nm(ub,!0),tableHeaderSortAscIcon:nm(ub),tabViewTabGap:1,tabViewLabelColor:Uk,tabViewLabelFont:nk,tabViewTabBackground:Kl,tabViewSelectWidth:3,tabViewSelectBackground:ps,tabViewMoveBackground:ci,tabViewInsertColor:ps,toolbarLabelColor:yl,toolbarLabelSelectColor:Uk,toolbarLabelFont:nk,toolbarBackground:oe,toolbarSelectBackground:ps,toolbarItemGap:8,toolbarSeparatorColor:ao},!0);var $k={translateX:1,sortColumn:1},bl={sortable:1,sortOrder:1,sortFunc:1},Bd={focusData:1},Pg={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ch={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},lk=function(P,y){y.add(P),P.hasChildren()&&P.eachChild(function(f){lk(f,y)})},pb=function(E,q,W,_,V,r,e,c,G,L,K){var Y,k=W.getValueType(L),Q=W.getAlign(L);if(W.getEnumValues(L)){var S=W.toEnumLabel(q,L),s=Xh||0,A=0,v=r,C=t.getTextSize(_,S).width;return Y=Bn(W.toEnumIcon(q,L)),Y&&(A=r+Xh/2,"center"===Q?A+=(c-(s+C))/2:"right"===Q&&(A=A+c-(s+C)),Kd(E,Y,A,e+G/2,L,K),v=A+Xh/2),S!=I&&(Y?Ac(E,S,_,V,v,e,c-(v-r),G):Ac(E,S,_,V,r,e,c,G,Q)),void 0}return q=W.formatValue(q),q!=I?k===Fm?(Xl(E,r,e,c,G,q),void 0):k===mb||!k&&gj(q)?(Y=Bn(q?eb:Rp),Kd(E,Y,r+c/2,e+G/2,L,K),void 0):(Ac(E,q,_,V,r,e,c,G,Q),void 0):void 0},Ge=function(P,K){var r=K.view,C=mf(P),e=K.column||K.property;r.getDataModel().beginTransaction(),K.editor=P,P.info=K,r.setCurrentEditor(P),r.getView().insertBefore(C,r._79O),Op(P,K.editorRect),P.setFocus?P.setFocus():$f(P),P.commitValue=function($,p){P._17Q&&(P=P._17Q),p||r.setValue(K.data,e,P.getValue?P.getValue():P.value),P.close&&P.close(),mo(C)},e.onEditorCreated&&e.onEditorCreated(K)},vm=function(P,g,V,u,D){var r=sn(P,V),N=g.value,j=g.view,k=D.getValueType(g.data);return r.onblur=r.onchange=function(){j.endEditing()},"input"===P?(N=D.formatValue(N),N!=I&&(r.value=N),r.onkeydown=function(e){ih(e)?j.endEditing():uq(e)&&j.endEditing(!0)},(k===nb||k===hf)&&J(r,Po,t.numberListener)):P===ks&&u.forEach(function(w){var G=M.createElement("option");G.innerHTML=D.toEnumLabel(w),G.value=w,D.isEnumEqual(N,w)&&(G.selected=!0),Ig(r,G)}),Ge(r,g),r},xj=v.widget={},Oc=function(t,x,W){Rq(Z+".widget."+t,x,W)};Fd(hl,{ms_value:function(e){e.getValue=function(q){var W=this.getItemById(q),n=W.element;return fh(n)?n:n?n.getValue?n.getValue():n.value:W.selected},e.setValue=function(N,y){var A=this.getItemById(N);if(A){var R=A.element;R&&!fh(R)?R.setValue?R.setValue(y):R.value=y:gj(y)?(A.selected=y,this.iv()):(A.element=y,this.iv())}},e.v=function(C,v){var N=this;if(2===arguments.length)N.setValue(C,v);else{if(!nd(C))return N.getValue(C);for(var z in C)N.setValue(z,C[z])}return N}},_46o:function(E){E._icon=I,E._accessType=I,E._valueType=I,E._editable=!1,E._batchEditable=!0,E._align=Hd,E._nullable=!0,E._emptiable=!1,E.setParent=Xr,E.formatValue=function(u){var _=this,v=_._valueType;return _.getEnumValues()?_.toEnumLabel(u):v===mb?!!u:u!=I&&v===nb?U(u):u},E.setEnum=function(V,M,L,B,F,$,x){var P=this;V&&!Ad(V)&&V.values&&(B=V.editable,L=V.icons,M=V.labels,F=V.strict,$=V.maxHeight,x=V.dropDownWidth,V=V.values),Ii(V)&&(V=V._as),Ii(M)&&(M=M._as),Ii(L)&&(L=L._as),P._enumValues=V,P._enumLabels=M,P._enumIcons=L,P._enumEditable=B,P._enumStrict=F==I?!0:F,P._enumMaxHeight=$,P._enumDropDownWidth=x,V&&V.length&&mm(V[0])&&(P._valueType=hf),P.fp("enum",!1,!0)},E.getEnumDropDownWidth=function(){return this._enumDropDownWidth},E.getEnumMaxHeight=function(){return this._enumMaxHeight},E.isEnumEditable=function(){return this._enumEditable},E.getEnumValues=function(){return this._enumValues},E.getEnumLabels=function(){return this._enumLabels},E.getEnumIcons=function(){return this._enumIcons},E.isEnumStrict=function(){return this._enumStrict},E.isEnumEqual=function($,g){return this._enumStrict?$===g:$==g},E.toEnumLabel=function(m,C){var c=this,G=c.getEnumValues(C),q=c.getEnumLabels(C);if(G&&q)for(var B=0;B<G.length;B++)if(c.isEnumEqual(m,G[B]))return q[B];return m},E.toEnumIcon=function(R,u){var O=this,g=O.getEnumValues(u),I=O.getEnumIcons(u);if(g&&I)for(var E=0;E<g.length;E++)if(O.isEnumEqual(R,g[E]))return I[E];return Q}},_45o:function(w){w._87o=function(u,J,f,H,$,O){if(u){var s=this,I=s._90I,Q=Tj(1);s._columnLineVisible&&($-=1),s._rowLineVisible&&(O-=1),0>=$||0>=O||(s._90I||(I=s._90I={}),I[J]||(I[J]=new up),Op(Q,s.tx()+f,s.ty()+H,$,O),Ig(Q,u),s._view.insertBefore(Q,s._79O),u.onParentAdded&&u.onParentAdded(Q),I[J].add(Q))}},w._76o=function(){var p=this,W=p._90I;if(W){for(var E in W)W[E].each(function(T){mo(T)});delete p._90I}},w._77o=function(F){var m=this;if(m._90I){var p=m._90I[F];p&&(p.each(function(S){mo(S)}),delete m._90I[F])}}},_47o:function(j){j.getValue=function(W,t){return t.getValue?t.getValue(W,t,this):Lo(W,t.getAccessType(),t.getName())},j.setValue=function(J,K,n){if(K.isEmptiable(J)||""!==n||(n=Q),K.isNullable(J)||n!=I){var A=this,q=K.getName(J),p=K.getAccessType(J),k=K.getValueType(J);k===nb&&fh(n)?n=R(n):k===hf&&fh(n)?n=parseFloat(n):k===mb&&fh(n)&&(n="true"===n),A._batchEditable&&K._batchEditable&&A.isSelected(J)?A.sm().each(function($){K.setValue?K.setValue($,K,n,A):pc($,p,q,n)}):K.setValue?K.setValue(J,K,n,A):pc(J,p,q,n)}},j.setCurrentEditor=function(A){this.endEditing(),this._currentEditor=A,this.redraw()},j.isEditing=function(e,Q){var D=this,t=D._currentEditor;if(!t)return!1;if(Q){var G=t.info;return G?(G.column||G.property)===Q&&G.data===e:!1}return!0},j.endEditing=function(q){var Z=this,T=Z._currentEditor;T&&(delete Z._currentEditor,T.commitValue&&T.commitValue(T.info,q),Z.redraw(),Z.getDataModel().endTransaction())},j.beginEditing=function(V){this.endEditing();var y=this,r=V.column||V.property;if(r.beginEditing)r.beginEditing(V);else{var g=V.data,F=V.value,D=y.getSelectBackground(g),c=r.getEnumValues(g),j=r.getSlider(g),n=r.getColorPicker(g);if(j){var f=jq(xj.Slider,j);return f.setValue(F),f.getView().onblur=function(){y.endEditing()},f.isInstant()&&(f.onValueChanged=function(){y.setValue(g,r,f.getValue())}),Ge(f,V),void 0}if(n||r.getValueType(g)===Fm){var U=jq(xj.ColorPicker,n);return U.setValue(F),U.onClosed=function(){y.endEditing()},U.isInstant()&&(U.onValueChanged=function(F,V){y.setValue(g,r,V)}),Ge(U,V),U.open(),void 0}if(c){if(xj.ComboBox){var R=new xj.ComboBox;R.setValue(F),R.setValues(c),R.setLabels(r.getEnumLabels(g)),R.setIcons(r.getEnumIcons(g)),R.setEditable(r.isEnumEditable(g)),R.setStrict(r.isEnumStrict(g)),R.setMaxHeight(r.getEnumMaxHeight(g)),R.setDropDownWidth(r.getEnumDropDownWidth(g)),R.onClosed=function(){y.endEditing()},Ge(R,V),R.open()}else vm(ks,V,D,c,r);return}var h=r.getValueType(g);if(h===mb||gj(F))return y.setValue(g,r,!F),void 0;if(r.getItemEditor(g)){var $=Mj(r.getItemEditor(g)),G=new $(g,r,y,V),m=G.getView();return m._17Q=G,G.setValue(F),Fb(m),Ge(m,V),G.editBeginning&&G.editBeginning(),void 0}vm("input",V,D,I,r)}}},_44o:function(w){w.init=function($){var T=this,E=T.th=new Xi($),o=T._view=Th(1,T);T.tv=T._tableView=$,Ig(o,E.getView()),Ig(o,$.getView()),E.mp(function(P){P.property===Pe&&T.iv()}),T.iv()},w.getTableView=function(){return this.tv},w.getTableHeader=function(){return this.th},w.getDataModel=function(){return this.tv.dm()},w.getColumnModel=function(){return this.tv.getColumnModel()},w.setColumns=function(o){this.tv.setColumns(o)},w.addColumns=function(J){this.tv.addColumns(J)},w.endEditing=function(){this.tv.endEditing()},w.validateImpl=function(){var d=this,X=d.th,y=co(X),g={x:0,y:0,width:d.getWidth(),height:y};Op(X,g),g.y=y,g.height=P(0,d.getHeight()-y),Op(d.tv,g)}},ms_vs:function(g){g._41o=function(){return this._29I.height<this._59I},g._43o=function(){var y=this;y._41o()&&(y._58I||(V(function(){y._94O()},Ji),y.iv()),y._58I=new Date)},g._94O=function(){var D=this;if(D._58I){var R=new Date;R.getTime()-D._58I.getTime()>=Ji?(delete D._58I,D.iv()):V(function(){D._94O()},Ji)}},g._93I=function(){var L=this,U=L._27I;if(L._58I||!L._autoHideScrollBar){U||Ig(L._79O,U=L._27I=Tj());var F=L._29I,O=F.height,e=L._59I,Q=L.getScrollBarSize(),R=F.width-Q-2,o=O*(-L.ty()/e),D=O*(O/e),N=U.style;e>O?(ln>D&&(o=o+D/2-ln/2,0>o&&(o=0),o+ln>O&&(o=O-ln),D=ln),N.visibility=wr,N.background=L.getScrollBarColor(),N.borderRadius=Q/2+kh,Op(U,R,o,Q,D)):N.visibility=ui}else U&&(U.style.visibility=ui)}},ms_hs:function(A){A._40o=function(){return this._29I.width<this._91I},A._42o=function(){var R=this;R._40o()&&(R._95O||(V(function(){R._94I()},Ji),R.iv()),R._95O=new Date)},A._94I=function(){var T=this;if(T._95O){var o=new Date;o.getTime()-T._95O.getTime()>=Ji?(delete T._95O,T.iv()):V(function(){T._94I()},Ji)}},A._92I=function(){var K=this,$=K._28I;if(K._95O||!K._autoHideScrollBar){$||Ig(K._79O,$=K._28I=Tj());var u=K._29I,R=u.width,k=K._91I,M=K.getScrollBarSize(),N=u.height-M-2,E=R*(-K.tx()/k),V=R*(R/k),g=$.style;k>R?(ln>V&&(E=E+V/2-ln/2,0>E&&(E=0),E+ln>R&&(E=R-ln),V=ln),g.visibility=wr,g.background=K.getScrollBarColor(),g.borderRadius=M/2+kh,Op($,E,N,V,M)):g.visibility=ui}else $&&($.style.visibility=ui)}}}),_e(eb,hh(16,16,[{type:qn,rect:[1,1,14,14],background:ps},{type:Gj,rect:[1,1,14,14],width:1,color:lc},{type:Oe,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),_e(Rp,hh(16,16,{type:Gj,rect:[1,1,14,14],width:1,color:lc})),_e(Jp,hh(16,16,[{type:nj,rect:[2,2,12,12],borderWidth:1,borderColor:lc,background:"#FFF"},{type:nj,rect:[4,4,8,8],background:ps}])),_e(gf,hh(16,16,{type:nj,rect:[2,2,12,12],borderWidth:1,borderColor:lc})),hl._15Q=function(w){w._29I=Xq,w._59I=0,w._91I=0,w._5o=function(e){var B=this;B._30I=new up,B._rows=new up,B._rowMap={},B._31I=0,B._14I=0,B._view=Th(1,B),B._canvas=Sg(B._view),Ig(B._view,B._79O=Tj()),B.dm(e?e:new ag)},w.getCheckIcon=function(S){var m=this.sm(),i=m.co(S);return m.sg()?Bn(i?Jp:gf):Bn(i?eb:Rp)},w.checkData=function(V){var Q=this.sm(),r=Q.co(V);Q.sg()&&r||(this._32o=1,r?Q.rs(V):Q.as(V),delete this._32o)},w.getDataAt=function(R){R.target&&(R=this.lp(R));var O=e(R.y/this._rowHeight),$=this._rows;return 0>O||O>=$.size()?I:$.get(O)},w.onDataDoubleClicked=function(){},w.onDataClicked=function(){},w.adjustTranslateX=function(){return 0
},w.adjustTranslateY=function(g){var K=this.getHeight()-this._59I;return K>g&&(g=K),g>0?0:U(g)},w.onPropertyChanged=function($){var I=this,a=$.property;Pg[a]?I.ivm():Bd[a]||I.redraw(),a===to?I._42o():a===ai&&I._43o()},w.getLabel=function(j){return j.toLabel()},w.getLabelFont=function(){return this._labelFont},w.getLabelColor=function(M){var j=this;if(j.isCheckMode()){if(j._focusData===M)return j._labelSelectColor}else if(j.isSelected(M))return j._labelSelectColor;return j._labelColor},w.getStartRowIndex=function(){return this._31I},w.getEndRowIndex=function(){return this._14I},w.getRowDatas=function(){return this._rows},w.getRowIndex=function(O){return this._rowMap[O._id]},w.getRowSize=function(){return this._rows.size()},w.getViewRect=function(){return Gk(this._29I)},w.isVisible=function(R){return this._visibleFunc?this._visibleFunc(R):!0},w.getCurrentSortFunc=function(){return this._sortFunc},w.setDataModel=function(V){var o=this,T=o._dataModel,I=o._selectionModel;T!==V&&(T&&(T.umm(o.handleDataModelChange,o),T.umd(o.handleDataPropertyChange,o),T.umh(o.handleHierarchyChange,o),I||T.sm().ums(o.handleSelectionChange,o)),o._dataModel=V,V.mm(o.handleDataModelChange,o),V.md(o.handleDataPropertyChange,o),V.mh(o.handleHierarchyChange,o),I?I._21I(V):V.sm().ms(o.handleSelectionChange,o),o.fp("dataModel",T,V))},w.validateModel=function(){var _=this;_._rows.clear(),_._rowMap={},_.buildChildren(_._dataModel._roots);var j=_._rows=_._rows.toList(_.isVisible,_),F=0,T=_.getCurrentSortFunc(),d=j.size();for(T&&j.sort(T);d>F;F++)_._rowMap[j.get(F)._id]=F},w.buildChildren=function(E){var w=this;E.each(function(z){w._rows.add(z),w.buildChildren(z._children)})},w.handleDataModelChange=function(){this.ivm()},w.handleDataPropertyChange=function(E){"parent"===E.property?this.ivm():this.invalidateData(E.data)},w.handleHierarchyChange=function(){this.ivm()},w.handleSelectionChange=function(r){r.datas.each(this.invalidateData,this),this.onSelectionChanged(r)},w.onSelectionChanged=function(w){var P=this,_=P.sm();!P.isAutoMakeVisible()||1!==_.size()||"set"!==w.kind&&"append"!==w.kind||P._32o||P.makeVisible(_.ld())},w.handleBackgroundClick=function(q){Qn(q)&&!this.isCheckMode()&&this.sm().cs()},w.makeVisible=function(V){V&&(this._23I=V,this.iv())},w.scrollToIndex=function(P){var i=this,A=i._29I,N=A.height,K=i._rowHeight,x=K*P;P>=0&&P<i._rows.size()&&N>0&&(x+K>A.y+N?i.ty(-x+N-K):x<A.y&&i.ty(-x))},w.autoScroll=function(t,A){var c=this,q=c._rowHeight,r=q,z=q/4,b=c._29I,T=c.lp(t),g={x:c.tx(),y:c.ty()};return q>0&&b&&(T.x-b.x<r?c.translate(z,0):b.x+b.width-T.x<r&&c.translate(-z,0),T.y-b.y<r?c.translate(0,z):b.y+b.height-T.y<r&&c.translate(0,-z)),g.x=c.tx()-g.x,g.y=c.ty()-g.y,A&&(A.x+=g.x,A.y+=g.y),g},w.getTopRowOrderSelection=function(){var U=this.sm().getTopSelection(),r={},T=new up;return U.each(function(g){r[g._id]=g}),this._rows.each(function(Y){r[Y._id]&&T.add(Y)}),T},w.getRowOrderSelection=function(){var B=new up;return this._rows.each(function(n){this.isSelected(n)&&B.add(n)},this),B},w.ivm=function(){this.invalidateModel()},w.invalidateModel=function(){var u=this;u._96I||(u._96I=1,u._32I=1,delete u._24I),u.iv()},w.redraw=function(){var G=this;G._32I||(G._32I=1,delete G._24I,G.iv())},w.invalidateData=function(m){var Z=this;Vh?Z.redraw():Z._32I||(Z._24I||(Z._24I={}),Z._24I[m._id]=m,Z.iv())},w.getFocusData=function(){return this._focusData},w.setFocusDataById=function(U){this.setFocusData(this.dm().getDataById(U))},w.setFocusData=function(x){var O=this,S=O._focusData;S!==x&&(O._focusData=x,O.fp("focusData",S,x),S&&O.invalidateData(S),x&&(O.invalidateData(x),O.isAutoMakeVisible()&&O.makeVisible(x)))},w.drawRowBackground=function(I,A,n,H,N,e,U){var F=this,y=F.isCheckMode();(A===F._focusData&&y||n&&!y)&&Xl(I,H,N,e,U,F.getSelectBackground(A))},w.drawData=function(W,$,Y){var J=this,g=J._rowHeight,B=g*Y,Q=J._29I,F=Q.x,t=Q.width;W.save(),W.beginPath(),W.rect(F,B,t,g),W.clip(),J._87o(J.drawRow(W,$,J.isSelected($),F,B,t,g),Y,F,B,t,g),W.restore(),J._rowLineVisible&&Xl(W,F,B+g-1,t,1,J._rowLineColor)},w._12I=function(B){var E=this,y=E._31I,N=E._29I,V=N.x,w=N.y,v=N.width,A=N.height;for(B.beginPath(),B.rect(V,w,v,A),B.clip(),B.clearRect(V,w,v,A),E._76o(),E._93db(B);y<E._14I;y++)E.drawData(B,E._rows.get(y),y);E._92db(B)},w._13I=function(j){for(var e,R=this,A=R._rowHeight,K=R._29I,W=K.x,G=K.width,L=R._31I,V=R._30I;L<R._14I;L++)e=R._rows.get(L),R._24I[e._id]&&V.add({data:e,index:L});V.isEmpty()||(j.beginPath(),V.each(function(T){j.rect(W,T.index*A,G,A)}),j.clip(),V.each(function(w){j.clearRect(W,w.index*A,G,A)}),V.each(function(j){R._77o(j.index)}),R._93db(j),V.each(function(x){R.drawData(j,x.data,x.index)}),R._92db(j),V.clear())},w.preValidateModel=function(){this.endEditing&&this.endEditing()},w.validateImpl=function(){var S=this,$=S._canvas,J=S.getWidth(),E=S.getHeight(),y=S._rowHeight,m=S._32I;(J!==$.clientWidth||E!==$.clientHeight)&&(sg($,J,E),m=1);var v=d&&!u;S._96I&&!v&&(S.preValidateModel(),S.validateModel());var R=S._29I,U={x:-S.tx(),y:-S.ty(),width:J,height:E},L=S._rows.size(),A=Ye($),M=S._23I;m||Gr(U,R)||(m=1),S._29I=U,S._59I=L*y+S.getScrollBarSize(),S._31I=e(U.y/y),S._14I=X((U.y+U.height)/y),S._31I<0&&(S._31I=0),S._14I>L&&(S._14I=L),S._99I&&m&&S._99I(),Dj(A,S.tx(),S.ty(),1),m?S._12I(A):S._24I&&S._13I(A),S._93I(),S._92I(),A.restore(),S._32I=S._24I=S._96I=I,M&&(S.scrollToIndex(S.getRowIndex(M)),delete S._23I),S.tx(S.tx()),S.ty(S.ty())}},hl._48o=function(r){r._rootVisible=!0,r._rootData=I,r._35o=function(){this._expandMap={},this._levelMap={}},r.validateModel=function(){var d=this,i=d._rootData;d._rows.clear(),d._levelMap={},d._rowMap={},d._currentLevel=0,i?d._rootVisible?d.isVisible(i)&&d.buildData(i):d.buildChildren(i):d.buildChildren(),delete d._currentLevel},r.buildData=function(Y){var n=this,a=Y._id,M=n._rows;n._rowMap[a]=M.size(),M.add(Y),n._levelMap[a]=n._currentLevel,n.isExpanded(Y)&&(n._currentLevel++,n.buildChildren(Y),n._currentLevel--)},r.buildChildren=function(H){var u=this,l=H?H._children:u._dataModel._roots,r=u.getCurrentSortFunc();r&&u.isChildrenSortable(H)?l.toList(u.isVisible,u).sort(r).each(u.buildData,u):l.each(function(e){u.isVisible(e)&&u.buildData(e)})},r.getLevel=function(_){return this._levelMap[_._id]},r.getToggleIcon=function(E){var G=this,j=G._loader,u=G._collapseIcon;return j&&!j.isLoaded(E)?u:E.hasChildren()?G.isExpanded(E)?G._expandIcon:u:I},r.isCheckMode=function(){return this._checkMode!=I},r.isChildrenSortable=function(){return!0},r.handleDataModelChange=function(w){var W=this;w.kind===Wg?delete W._expandMap[w.data._id]:w.kind===qb&&(W._expandMap={}),W.ivm()},r.toggle=function(R){var f=this;f.isExpanded(R)?f.collapse(R):f.expand(R)},r.isExpanded=function($){return 1===this._expandMap[$._id]},r.expand=function(P){var N=this,J=N._loader;N.isExpanded(P)||(J&&!J.isLoaded(P)&&J.load(P),N._expandMap[P._id]=1,N.ivm(),N.onExpanded(P))},r.onExpanded=function(){},r.collapse=function(U){var Z=this;Z.isExpanded(U)&&(delete Z._expandMap[U._id],Z.ivm(),Z.onCollapsed(U))},r.onCollapsed=function(){},r.expandAll=function(R){if(R)this.expand(R),R.eachChild(function(K){this.expandAll(K)},this);else{var Y=this;Y._dataModel.each(function(O){O.hasChildren()&&(Y._expandMap[O._id]=1)}),Y.ivm()}},r.collapseAll=function(){this._expandMap={},this.ivm()},r.makeVisible=function(D){if(D){var _=this;if(!_._rootData||D.isDescendantOf(_._rootData)){for(var G=D._parent;G;)_.expand(G),G=G._parent;_._23I=D,_.iv()}}},r.checkData=function(g){var O,h=this,V=h._checkMode,Q=h.sm(),v=Q.co(g);if(!Q.sg()||!v){if(h._32o=1,V===ho)v?Q.rs(g):Q.as(g);else if(V===nq)O=new up(g),O.addAll(g._children);else if("descendant"===V)O=new up,lk(g,O);else if("all"===V&&(O=new up,lk(g,O),!v))for(var z=g._parent;z;)O.add(z),z=z._parent;O&&(v?Q.rs(O):Q.as(O)),delete h._32o}},r._97I=function(s,r,h,x,g,T,J){var m=this,n=m._indent,V=m._levelMap[r._id],l=m.getIconWidth(r),G=Bn(m.getToggleIcon(r));G?(x+=n*V,Kd(s,G,x+n/2,g+J/2,r,m),x+=n):x+=n*(V+1),m._checkMode&&(Kd(s,m.getCheckIcon(r),x+n/2,g+J/2,r,m),x+=n),m.drawIcon(s,r,x,g,l,J),m.drawLabel(s,r,x+l,g,J)}},hl._14Q=function(N){N.getIcon=function(M){return M.getIcon()},N.getIconWidth=function(U){return this.getIcon(U)?this._indent:0},N.drawIcon=function(H,W,m,b,Y,n){if(Y){var y=this,F=y.getBodyColor(W),E=Bn(y.getIcon(W),F);E&&(n-=y.isRowLineVisible()?1:0,ck(H,E,qp,m,b,Y,n,W,y,F),_d(H,y.getBorderColor(W),m,b,Y,n))}},N.drawLabel=function(W,N,B,O,C){var V=this;Ac(W,V.getLabel(N),V.getLabelFont(N),V.getLabelColor(N),B,O,0,C)}},hl._50o=function(Q){Q._98I=function(){var Y=this,$=Y._39o=new ag;Y._60I=new up,$.mm(Y._17o,Y),$.md(Y._18o,Y),$.mh(Y._19o,Y)},Q.setColumns=function(p){this._39o.clear(),this.addColumns(p)},Q.addColumns=function(I){var N=this._39o;I.forEach(function(k){if(!(k instanceof gb)){var i=Mj(k.className);k=jq(i?i:gb,k)}N.add(k)})},Q.onColumnClicked=function(){},Q.onCheckColumnClicked=function(){},Q._3Q=function(W){for(var c,b=0,l=this._60I,g=l.size();g>b;b++)if(c=l.get(b),c.column===W)return c;return I},Q.getColumnAt=function(Z){var H=this._4Q(Z);return H?H.column:I},Q._4Q=function(j){for(var w=this,n=j.target?w.lp(j).x:j.x,W=w._60I,K=0;K<W.size();K++){var g=W.get(K),Q=g.startX;if(n>=Q&&n<Q+g.column.getWidth())return g}return I},Q.getToolTip=function($){var W=this,Q=W.getDataAt($),k=W.getColumnAt($);return Q&&k?k.getToolTip(Q,W):I},Q.adjustTranslateX=function($){var s=this.getWidth()-this._91I;return s>$&&($=s),$>0?0:U($)},Q._99I=function(){var y=this,E=y._29I,C=y._60I;C.clear(),y._91I=0,y._39o._roots.each(function(v){if(v.isVisible()){var D=y._91I+v.getWidth();y._91I<=E.x+E.width&&D>=E.x&&C.add({column:v,startX:y._91I}),y._91I=D}}),y._91I+=y.getScrollBarSize()},Q.drawData=function(W,s,z){var F=this,b=F._rowHeight,M=b*z,D=F.isSelected(s),U=F._29I,c=U.x,g=U.width;F.drawRowBackground(W,s,D,c,M,g,b),F._60I.each(function(d){var n=d.column,k=d.startX,p=n.getWidth();p>0&&!F.isEditing(s,n)&&(W.save(),W.beginPath(),W.rect(k,M,p,b),W.clip(),F._87o(F.drawCell(W,s,D,n,k,M,p,b),z,k,M,p,b),F._columnLineVisible&&Xl(W,k+p-1,M,1,b,F._columnLineColor),W.restore())}),F._rowLineVisible&&Xl(W,c,M+b-1,g,1,F._rowLineColor)},Q.drawCell=function(L,K,n,s,l,j,X,y){var Q=this;if(s.drawCell)return s.drawCell(L,K,n,s,l,j,X,y,Q);var t=Q.getValue(K,s);pb(L,t,s,Q.getLabelFont(K,s,t),Q.getLabelColor(K,s,t),l,j,X,y,K,Q)},Q.getColumnModel=function(){return this._39o},Q._17o=function(){this.redraw()},Q._18o=function(n){var H=this;n.data===H._sortColumn&&bl[n.property]?H.ivm():(H._42o(),H.redraw())},Q._19o=function(){this.redraw()},Q.getCurrentSortFunc=function(){var Q=this,B=Q._sortColumn;if(B&&B.isSortable()){var g=B.getSortFunc(),J=jd===B.getSortOrder()?1:-1;return g||(g=es),function(u,R){return g.call(Q,Q.getValue(u,B),Q.getValue(R,B),u,R)*J}}return Q._sortFunc},Q.isCellEditable=function(A,X,Y){return X.isEditable()&&this.isEditable()?X.isCellEditable?X.isCellEditable(A,X,Y,this):!0:!1},Q._37O=function(I,H){if(Qn(H))for(var m=this,J=m.lp(H),R=m._60I,z=m._rowHeight,w=m._29I,L=w.x,Q=w.y,t=w.width,j=w.height,Y=0;Y<R.size();Y++){var T=R.get(Y),s=T.startX,C=T.column,B=C.getWidth();if(C!==m._31o&&C!==m._4o&&J.x>=s&&J.x<s+B&&m.isCellEditable(I,C,H)){var c={x:s,y:m.getRowIndex(I)*z,width:B,height:z},y={x:c.x+m.tx(),y:c.y+m.ty(),width:c.width,height:c.height},f=0,o=0;return c.x<L?f=c.x-L:c.x+c.width>L+t&&(f=c.x+c.width-L-t),f&&(m.tx(m.tx()-f),y.x-=f),c.y<Q?o=c.y-Q:c.y+z>Q+j&&(o=c.y+z-Q-j),o&&(m.ty(m.ty()-o),y.y-=o),m.beginEditing({data:I,column:C,value:m.getValue(I,C),event:H,rect:c,editorRect:y,view:m}),void 0}}}},xj.BaseItemEditor=function(k,G,T,u){this._data=k,this._column=G,this._master=T,this._editInfo=u},Oc("BaseItemEditor",Y,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Qi=v.Tab=function(){mj(Qi,this)};$b("Tab",Fh,{ms_ac:["view","closable","disabled","visible"],_icon:I,_closable:!1,_disabled:!1,_visible:!0,setParent:Xr});var gb=v.Column=function(){mj(gb,this)};$b("Column",Fh,{_46o:1,ms_ac:["accessType","valueType",wr,Jo,Hl,Or,"align",Fm,"sortOrder",yk,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:jd,_sortFunc:I,_sortable:!0,_clickable:!0,setWidth:function(p){16>p&&(p=16);var l=this._width;this._width=p,this.fp(Or,l,p)},getToolTip:function(A,a){return this.formatValue(a.getValue(A,this))}});var Dl=v.Property=function(){mj(Dl,this)};$b("Property",Fh,{_46o:1,ms_ac:["accessType","valueType",Jo,Hl,"categoryName",Fm,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:I,getToolTip:function(G,X,K){var H=this;return X?H.formatValue(K.getValue(G,H)):K.getPropertyName(H)}}),xj.AccordionView=function(){var F=this;F._20o={},F._21o=new up,F._10o=I,F._9o=I,F._11o=I,F._view=Th(0,F),F.iv()},Oc("AccordionView",Y,{ms_v:1,ms_fire:1,ms_ac:[Yb,eq,"titleHeight",xm,Xc,"titleBackground","selectWidth",Yo,"orientation","separatorColor"],_expandIcon:t.accordionViewExpandIcon,_collapseIcon:t.accordionViewCollapseIcon,_titleHeight:Ng,_labelColor:t.accordionViewLabelColor,_labelFont:t.accordionViewLabelFont,_titleBackground:t.accordionViewTitleBackground,_selectBackground:t.accordionViewSelectBackground,_selectWidth:t.accordionViewSelectWidth,_orientation:"v",_separatorColor:t.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(p,y,T,t){var e=this,r=Tj();if(e._20o[p])throw p+" already exists";r.onmousedown=Rg,r.style.cursor=im,J(r,Jm?xg:pj,function(E){Rg(E)}),J(r,Jm?rp:fl,function(S){Rg(S),Qn(S)&&(e._10o===p?e.collapse():e.expand(p))}),Ig(e._view,r),e._20o[p]={content:y,div:r,canvas:Sg(r),icon:t},e._21o.add(p),T&&e.expand(p),e.iv()},remove:function(D){var L=this,w=L._20o[D];w&&(mo(w.div),delete L._20o[D],L._21o.remove(D),L.iv())},clear:function(){var E=this;E._21o.toArray().forEach(E.remove,E),E._20o={},E._21o.clear(),E.iv()},isExpanded:function(S){return this._10o===S},expand:function(e){var O=this;O._20o[e]&&O._10o!==e&&(O._10o=e,O.onExpanded(e),O.iv())},onExpanded:function(){},collapse:function(){var u=this;u._10o&&(u.onCollapsed(u._10o),delete u._10o,u.iv())},onCollapsed:function(){},initCanvas:function(K,S,n){sg(K,S,n);var L=Ye(K);return Dj(L,0,0,1),L.clearRect(0,0,S,n),L},drawTitle:function(H,I,g,Z,f){var L=this,W=Bn(f.icon),w=L.isExpanded(I),m=L._titleHeight,K=L._titleBackground,M=L._selectWidth,R=L._separatorColor,u=Bn(w?L._expandIcon:L._collapseIcon),E=M+4;Xl(H,0,0,g,Z,K),w&&M&&Xl(H,0,0,M,Z,L._selectBackground),(w||L._21o.get(L._21o.size()-1)!==I)&&Xl(H,0,Z-1,g,1,R?R:Oo(K)),W&&(Kd(H,W,E+vk(W)/2,m/2),E+=vk(W)+2),Ac(H,I,L.getLabelFont(I),L.getLabelColor(I),E,0,0,m),u&&Kd(H,u,g-vk(u)/2-4,m/2)},validateImpl:function(){var F=this,G=F._view,Y=0,y=0,_=F.getWidth(),J=F.getHeight(),m=F._titleHeight,i=F._21o.size()*m,R=F._11o,n=F._9o;delete F._11o,delete F._9o,F._21o.each(function(k){var T,c,w=F._20o[k],s=w.content,U=F._10o===k;nl(F)?(Op(w.div,Y,0,m,J),T=F.initCanvas(w.canvas,m,J),nc(T,0,J),Ur(T,-b),F.drawTitle(T,k,J,m,w),T.restore(),U?(c=P(0,_-i),s&&(F._11o=s,F._9o=mf(s),Op(s,Y+m,0,c,J)),Y+=m+c):Y+=m):(Op(w.div,0,y,_,m),T=F.initCanvas(w.canvas,_,m),F.drawTitle(T,k,_,m,w),T.restore(),U?(c=P(0,J-i),s&&(F._11o=s,F._9o=mf(s),Op(s,0,y+m,_,c)),y+=m+c):y+=m)});var Z=F._9o;R&&R!==F._11o&&R.endEditing&&R.endEditing(),Z&&Z!==n&&Ig(G,Z),n&&n!==Z&&mo(n)}}),xj.SplitView=function(Y,b,q,X){var D=this,M=D._dividerDiv=Tj(),n=D._60O=Sg(),U=D._61O=Sg(),t=n.style,L=U.style;D._view=Th(1,D),Ig(D._view,M),t.msTouchAction=Tr,t.pointerEvents=Tr,t.cursor=im,L.msTouchAction=Tr,L.pointerEvents=Tr,L.cursor=im,Y&&D.setLeftView(Y),b&&D.setRightView(b),q&&D.setOrientation(q),X!=I&&D.setPosition(X),D.setStatus(En),new Bo(D)},Oc("SplitView",Y,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:t.splitViewDividerSize,_dividerBackground:t.splitViewDividerBackground,_dragOpacity:t.splitViewDragOpacity,_toggleIcon:t.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function($,r){var U=this,c=U._position;isNaN($)||(r||(U._82O=0>$?-1:$>1?1:0),U._position=$,U.fp(sp,c,$))},getLeftView:function(){return this._leftView},setLeftView:function(Y){var C=this,Z=C._leftView,R=C._view;if(C._leftView!==Y){if(Z&&Z!==C._rightView){var K=mf(Z);K.parentNode===R&&mo(K)}if(C._leftView=Y,Y){var B=mf(Y);B.parentNode!==R&&R.insertBefore(B,C._dividerDiv)}C.fp("leftView",Z,Y)}},getRightView:function(){return this._rightView},setRightView:function(G){var m=this,i=m._rightView,f=m._view;if(m._rightView!==G){if(i&&i!==m._leftView){var M=mf(i);M.parentNode===f&&mo(M)}if(m._rightView=G,G){var e=mf(G);e.parentNode!==f&&f.insertBefore(e,m._dividerDiv)}m.fp("rightView",i,G)}},validateImpl:function(){var X=this,i=X._draggable,$=X._position,Z=X.getWidth(),H=X.getHeight(),t=X._dividerSize,l=X._dividerBackground,m=Jm?18:8,F=X._dividerDiv,g=X._82O,C=X._60O,a=X._61O,s=X._toggleIcon,I=X._status,p=F.style,W=null,E=Jm?20:4,O=s.comps[0];t>=m||0===t?X._coverDiv&&(mo(X._coverDiv),delete X._coverDiv):X._coverDiv||(X._coverDiv=Tj(),kf&&(X._coverDiv.style.background=fp),Ig(F,X._coverDiv)),X._togglable?C.parentNode||(Ig(F,C),Ig(F,a)):(mo(C),mo(a));var J=X._coverDiv,y=X._leftView,j=X._rightView;if(nl(X)){if(t>Z&&(t=Z),I===En)if(1===g)var D=r($,Z),M=P(0,Z-t-D);else-1===g?(M=r(-$,Z),D=P(0,Z-t-M)):(D=U((Z-t)*$),M=P(0,Z-t-D));else"cl"===I?(D=0,M=P(0,Z-t)):"cr"===I&&(M=0,D=P(0,Z-t));y&&Op(y,0,0,D,H),j&&Op(j,D+t,0,M,H),Op(F,D,0,t,H),X._22o=D,J&&(Op(J,t/2-m/2,0,m,H),J.style.cursor=i?Cn:""),F.style.cursor=i?Cn:"";var q=F.clientHeight/2,T=F.clientWidth;sg(C,T,T),Op(C,0,q-T-E,T,T),W=Ye(C),Dj(W,0,0,1),O.rotation=-b,Kk(W,s,0,0,T,T),W.restore(),sg(a,T,T),Op(a,0,q+E,T,T),W=Ye(a),Dj(W,0,0,1),O.rotation=b,Kk(W,s,0,0,T,T),W.restore()}else{if(t>H&&(t=H),I===En)if(1===g)var V=r($,H),u=P(0,H-t-V);else-1===g?(u=r(-$,H),V=P(0,H-t-u)):(V=U((H-t)*$),u=P(0,H-t-V));else"cl"===I?(V=0,u=P(0,H-t)):"cr"===I&&(u=0,V=P(0,H-t));y&&Op(y,0,0,Z,V),j&&Op(j,0,V+t,Z,u),Op(F,0,V,Z,t),X._22o=V,J&&(Op(J,0,t/2-m/2,Z,m),J.style.cursor=i?sj:""),p.cursor=i?sj:"";var B=F.clientWidth/2,T=F.clientHeight;sg(C,T,T),Op(C,B-T-E,0,T,T),W=Ye(C),Dj(W,0,0,1),O.rotation=0,Kk(W,s,0,0,T,T),W.restore(),sg(a,T,T),Op(a,B+E,0,T,T),W=Ye(a),Dj(W,0,0,1),O.rotation=k,Kk(W,s,0,0,T,T),W.restore()}p.background=l}});var Bo=function(j){this.sv=j,this.addListeners()};Rq(Bo,Y,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(v){var G=this,a=G.sv,J=a._dividerDiv,b=a._60O,s=a._61O,y=a._status,q=v.target;if(q===b)y===En?a.setStatus("cl"):"cr"===y&&a.setStatus(En);else if(q===s)y===En?a.setStatus("cr"):"cl"===y&&a.setStatus(En);else if(vc(v)&&(q===J||q===a._coverDiv)&&(Rg(v),a.isDraggable())){a.getLeftView(),a.getRightView();var e=G.maskDiv=Tj();if(e.style.left=0,e.style.top=0,e.style.width=a.getWidth()+"px",e.style.height=a.getHeight()+"px",a.getView().appendChild(e),!a.isContinuousLayout()){var C=G.resizeDiv=Tj();C.style.left=J.style.left,C.style.top=J.style.top,C.style.width=J.style.width,C.style.height=J.style.height,C.style.opacity=a.getDragOpacity(),C.style.background=a.getDividerBackground(),Ig(G.getView(),C)}G._lastAbsPosition=a._22o,G._86o=nl(a)?hb(v).x:hb(v).y,_g(G,v)}},handleWindowTouchMove:function(H){vc(H)&&this.update(H,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(r){var g=this;g.update(r,!0),g.sv.setStatus(En),g.maskDiv&&mo(g.maskDiv),g.resizeDiv&&mo(g.resizeDiv),g.maskDiv=g.resizeDiv=I},handle_mousedown:function(Z){Qn(Z)&&this.handle_touchstart(Z)},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},update:function(Q,q){var C=this,h=C.sv,U=nl(h)?h.getWidth():h.getHeight(),V=h._dividerSize,c=C._lastAbsPosition-C._86o;nl(h)?(c+=hb(Q).x,c>U-V&&(c=U-V),0>c&&(c=0),C.resizeDiv&&(C.resizeDiv.style.left=c+kh)):(c+=hb(Q).y,c>U-V&&(c=U-V),0>c&&(c=0),C.resizeDiv&&(C.resizeDiv.style.top=c+kh)),q&&U!==V&&(1===h._82O?h.setPosition(c,1):-1===h._82O?h.setPosition(c-U+V,1):h.setPosition(c/(U-V),1))}}),xj.TabView=function(){var Y=this,S=Y._view=Th(1,Y),n=Y._91O=Tj(1),q=Y._tabModel=new ag,s=q.sm(),O=Y.invalidate;Y._7o=new up,Y._canvas=Sg(n),Ig(S,n),Ig(S,Y._92O=Tj(1)),s.setSelectionMode(Vo),s.ms(Y.handleSelectionChange,Y),q.mm(O,Y),q.mh(O,Y),q.md(O,Y),Y._interactor=new ce(Y),Y.iv()},Oc("TabView",Y,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",xm,Xc,"tabHPadding","tabBackground","selectWidth",Yo,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:hq,_tabHeight:Ng,_tabGap:t.tabViewTabGap,_labelColor:t.tabViewLabelColor,_labelFont:t.tabViewLabelFont,_tabBackground:t.tabViewTabBackground,_selectWidth:t.tabViewSelectWidth,_selectBackground:t.tabViewSelectBackground,_moveBackground:t.tabViewMoveBackground,_insertColor:t.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(F,u,P){var i,g=this._tabModel;return F instanceof Qi?(i=F,u&&i.setView(u)):(i=new Qi,i.setName(F),i.setView(u)),g.add(i),P&&g.sm().ss(i),i},getLabel:function(H){return H.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(K){this._23o=K,this.iv()},get:function(l){var U=this,r=U._tabModel;if(mm(l))return r._roots.get(l);if(fh(l)){var Q;return r.each(function(D){l===U.getLabel(D)&&(Q=D)}),Q}return l instanceof Qi?l:I},select:function(Z){this._tabModel.sm().ss(this.get(Z))},remove:function(l){var b=this;if(l=b.get(l)){var q=b._tabModel,T=q._roots.indexOf(l);b._tabModel.remove(l),b.selectByIndex(--T)}},getCurrentTab:function(){return this._8o},hideTabView:function(i,e){e.parentNode===this._92O&&(Lf(e)?(e.style.display=rn,e._tab_=i):mo(e),am())},showTabView:function(S,f){Lf(f)&&(f.style.display="block",f._tab_=S),f.parentNode!==this._92O&&(Ig(this._92O,f),am())},_24o:function(){var Y,A=this,z=A._8o,p=A._9o,N=A._tabModel.sm().ld();N&&(Y=mf(N.getView())),Y!==p&&(p&&(z.getView()&&z.getView().endEditing&&z.getView().endEditing(),A.hideTabView(z,p)),Y&&A.showTabView(N,Y)),A._8o=N,A._9o=Y,z!==N&&A.onTabChanged(z,N)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(M,H){this.selectByIndex(--H)},selectByIndex:function(Q){var N=this,y=N._tabModel,K=y.size();if(K&&!y.sm().ld()){Q==I&&(Q=0),Q>=K&&(Q=K-1),0>Q&&(Q=0);for(var X=Q;X>=0;X--){var x=N.get(X);if(!x.isDisabled())return N.select(x),x}for(X=Q+1;K>X;X++)if(x=N.get(X),!x.isDisabled())return N.select(x),x}},getTabWidth:function(h){var S=this.getTabHPadding(),n=4+2*S,Q=Bn(h.getIcon());Q&&(n+=vk(Q,h)+4);var j=this.getLabel(h);return j&&(n+=Cg(this.getLabelFont(h),j).width+4),h.isClosable()&&(n+=10),n},drawTab:function(i,f,U,D,n,w,B){var r,l=this,F=l._tabPosition,T=this.getTabHPadding(),H=U+4+T,x=l._selectWidth,K=Bn(f.getIcon()),_=f.isDisabled(),d=l.getLabelColor(f),c=l.getLabelFont(f),s=l.getLabel(f),a=l._selectBackground,v=F===Hd+"-vertical",O=F===Np+"-vertical";(v||O)&&(H=D+4+T),_&&(i.globalAlpha=ls),Xl(i,U,D,n,w,B),f===l._8o&&x&&(F===hq?Xl(i,U,D+w-x,n,x,a):F===Hd?Xl(i,U+n-x,D,x,w,a):F===Np?Xl(i,U,D,x,w,a):v?Xl(i,U+n-x,D,x,w,a):O?Xl(i,U,D,x,w,a):Xl(i,U,D,n,x,a));var u=n/2;if(v&&(nc(i,u,D+w/2),Ur(i,k),nc(i,-u,-D-w/2)),K){var q=ns(K,f),N=vk(K,f);if(v||O){var z=U+n/2,h=H+q/2;nc(i,z,h),Ur(i,b),nc(i,-z,-h),Kd(i,K,U+n/2,H+q/2,f,l),nc(i,z,h),Ur(i,-b),nc(i,-z,-h),H+=q+4}else Kd(i,K,H+N/2,D+w/2,f,l),H+=N+4}return v||O?(nc(i,n/2,H+n/2),Ur(i,b),nc(i,-n/2,-H-n/2),Ac(i,s,c,d,U,H,w,n),nc(i,n/2,H+n/2),Ur(i,-b),nc(i,-n/2,-H-n/2)):Ac(i,s,c,d,H,D,n,w),v&&(nc(i,u,D+w/2),Ur(i,-k),nc(i,-u,-D-w/2)),f.isClosable()&&(r=O?{x:U+n-12,y:D+w-12,width:12,height:12}:{x:U+n-12,y:D+2,width:12,height:12},this.drawCloseIcon(f,i,d,r)),_&&(i.globalAlpha=1),r},drawCloseIcon:function(o,r,t,B){var _=B.x,J=B.y;r.strokeStyle=t,r.lineWidth=1,r.beginPath(),r.moveTo(_+2,J+8),r.lineTo(_+8,J+2),r.moveTo(_+8,J+8),r.lineTo(_+2,J+2),r.stroke()},getTabAt:function(A){var u=this._interactor._8Q(A);return u?u.tab:null},validateImpl:function(){var z=this;z._24o();var d,n=z._canvas,A=z._tabPosition,F=z._91O,O=z._92O,o=z._tabModel,x=z.getWidth(),m=z.getHeight(),E=z._tabHeight,J=z._7o,j=z._tabGap,K=A===hq,Q=A===Hd,$=A===Np,H=A===Hd+"-vertical",I=A===Np+"-vertical",w=z._23o,Z=0;if((Q||$)&&o._roots.each(function(Y){Z=P(z.getTabWidth(Y),Z)}),K?(Op(F,0,0,x,E),d={x:0,y:E,width:x,height:P(0,m-E)}):Q?(Op(F,0,0,Z,m),d={x:Z,y:0,width:P(0,x-Z),height:m}):$?(Op(F,x-Z,0,Z,m),d={x:0,y:0,width:P(0,x-Z),height:m}):H?(Op(F,0,0,E,m),d={x:E,y:0,width:P(0,x-E),height:m}):I?(Op(F,x-E,0,E,m),d={x:0,y:0,width:P(0,x-E),height:m}):(Op(F,0,m-E,x,E),d={x:0,y:0,width:x,height:P(0,m-E)}),Op(O,d),H||I){z._9o&&(d.x=0,Op(z._8o.getView(),d)),sg(n,E,m);var N=Ye(n),B=0;if(Dj(N,0,z.ty(),1),N.clearRect(0,0,E,m),J.clear(),o._roots.each(function(R){if(R.isVisible()){var $,u=z.getTabWidth(R);w&&w.tab===R||($=z.drawTab(N,R,0,B,E,u,z._tabBackground)),J.add({_75o:$,tab:R,startY:B,endY:B+u,height:u}),B+=u+j}}),z._23Q=P(0,B-j),w){var C=w.position;z.drawTab(N,w.tab,0,w.startY,E,w.height,z._moveBackground),Xl(N,0,C,E,1,z._insertColor)}if(N.restore(),z._selectionChanged){z._selectionChanged=!1;for(var e=z.ty(),l=0;l<J.size();l++){var u=J.get(l);if(u.tab===z._8o){if(u.endY+e<0){z.ty(-u.startY);break}if(u.startY+e>m){z.ty(m-u.endY);break}}}}z.ty(z.ty())}else if(Q||$){z._9o&&(d.x=0,Op(z._8o.getView(),d)),sg(n,Z,m);var N=Ye(n),B=0;if(Dj(N,0,z.ty(),1),N.clearRect(0,0,Z,m),J.clear(),o._roots.each(function(Y){if(Y.isVisible()){var $;w&&w.tab===Y||($=z.drawTab(N,Y,0,B,Z,E,z._tabBackground)),J.add({_75o:$,tab:Y,startY:B,endY:B+E,height:E}),B+=E+j}}),z._23Q=P(0,B-j),w){var C=w.position;z.drawTab(N,w.tab,0,w.startY,Z,w.height,z._moveBackground),Xl(N,0,C,Z,1,z._insertColor)}if(N.restore(),z._selectionChanged){z._selectionChanged=!1;for(var e=z.ty(),l=0;l<J.size();l++){var u=J.get(l);if(u.tab===z._8o){if(u.endY+e<0){z.ty(-u.startY);break}if(u.startY+e>m){z.ty(m-u.endY);break}}}}z.ty(z.ty())}else{z._9o&&(d.y=0,Op(z._8o.getView(),d)),sg(n,x,E);var N=Ye(n),U=0;if(Dj(N,z.tx(),0,1),N.clearRect(0,0,x,E),J.clear(),o._roots.each(function(f){if(f.isVisible()){var e,D=z.getTabWidth(f);w&&w.tab===f||(e=z.drawTab(N,f,U,0,D,E,z._tabBackground)),J.add({_75o:e,tab:f,startX:U,endX:U+D,width:D}),U+=D+j}}),z._64I=P(0,U-j),w){var C=w.position;z.drawTab(N,w.tab,w.startX,0,w.width,E,z._moveBackground),tn(N,z._insertColor,C,0,E)}if(N.restore(),z._selectionChanged){z._selectionChanged=!1;for(var y=z.tx(),l=0;l<J.size();l++){var u=J.get(l);if(u.tab===z._8o){if(u.endX+y<0){z.tx(-u.startX);break}if(u.startX+y>x){z.tx(x-u.endX);break}}}}z.tx(z.tx())}for(var q=[],V=O.children,l=0;l<V.length;l++){var _=V[l],G=_._tab_;G&&!o.contains(G)&&q.push(_)}q.forEach(function($){O.removeChild($)})}});var ce=function(B){this.tv=B,this.addListeners()};Rq(ce,Y,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function($){this.handleScroll($,10*($.wheelDelta/40))},handle_DOMMouseScroll:function(F){this.handleScroll(F,10*-F.detail)},handleScroll:function(y,D){Rg(y);var E=this.tv,e=E._tabPosition;!E._40o()||e!==hq&&e!==Ce||E.tx(this.tv.tx()+D),!E._41o()||e!==Hd&&e!==Np&&e!==Hd+"-vertical"&&e!==Np+"-vertical"||E.ty(this.tv.ty()+D)},_8Q:function(p){var $,y,X=this.tv,f=X._tabPosition,g=X._7o;if(f===hq||f===Ce){var R=X.lp(p).x;for($=0;$<g.size();$++)if(y=g.get($),y.startX<=R&&R<=y.endX)return y}else if(f===Hd||f===Np||f===Hd+"-vertical"||f===Np+"-vertical"){var k=X.lp(p).y;for($=0;$<g.size();$++)if(y=g.get($),y.startY<=k&&k<=y.endY)return y}return I},isClickable:function(D){var t=this.tv,Z=t._tabPosition,z=this._73o=this._8Q(D);return!t._40o()||Z!==hq&&Z!==Ce?!t._41o()||Z!==Hd&&Z!==Np&&Z!==Hd+"-vertical"&&Z!==Np+"-vertical"?z&&(!z.tab.isDisabled()||t.isMovable()):!0:!0},handle_mousemove:function(x){var B=this;_k?B._74o=B._8Q(x):B.getView().style.cursor=B.isClickable(x)?im:""},handle_mousedown:function(z){this.handle_mousemove(z),this.handle_touchstart(z)},handle_touchstart:function(_){var H=this,q=H.tv,l=q._tabPosition;Rg(_),Qn(_)&&H.isClickable(_)&&(l===hq||l===Ce?(H.x=hb(_).x,H.lp=q.lp(_),H.tx=q.tx()):(H.y=hb(_).y,H.lp=q.lp(_),H.ty=q.ty()),_g(H,_))},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(Q){var v,S=this,Y=S.tv,Z=Y._tabPosition,p=S._73o;if(Z===hq||Z===Ce){if(v=hb(Q).x-S.x,!S._25o&&!S.moving&&H(v)>2&&(Y._40o()&&!Ic(Q)?S._25o=1:p&&Y.isMovable()&&(S.moving=1)),S._25o)Y.tx(S.tx+v);else if(S.moving){var I=S.lp.x+v,f=Y._tabGap/2;Y._7o.each(function(g){var d=g.endX,J=I-g.startX<d-I;I>=g.startX&&d>=I&&Y._7Q({tab:p.tab,startX:p.startX+v,width:p.width,front:J,insertTab:g.tab,position:J?P(0,g.startX-f):r(Y._64I,d+f)})})}}else if(v=hb(Q).y-S.y,!S._25o&&!S.moving&&H(v)>2&&(Y._41o()&&!Ic(Q)?S._25o=1:p&&Y.isMovable()&&(S.moving=1)),S._25o)Y.ty(S.ty+v);else if(S.moving){var g=S.lp.y+v,f=Y._tabGap/2;Y._7o.each(function(Z){var W=Z.endY,V=g-Z.startY<W-g;g>=Z.startY&&W>=g&&Y._7Q({tab:p.tab,startY:p.startY+v,height:p.height,front:V,insertTab:Z.tab,position:V?P(0,Z.startY-f):r(Y._23Q,W+f)})})}},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(){var X=this,T=X.tv,f=T._tabPosition,c=T.getTabModel(),U=c._roots,A=X._73o;if(X.moving){var M=T._23o;if(M&&M.insertTab!==M.tab){var l=M.tab,R=U.remove(l),u=U.indexOf(M.insertTab);u>=0&&(M.front||u++,u<=U.size()&&(U.add(l,u),c._38I(l,R,u)))}T._7Q(I),delete X.moving}else if(!X._25o&&A){l=A.tab;var N=X._74o;if(!N||N.tab===l)if(!l.isDisabled()&&Vl(A._75o,X.lp)){var Z=function(){var f=U.indexOf(l);c.remove(l),T.onTabClosed(l,f)};T.onTabClosing(l,Z)&&Z()}else l.isDisabled()||T._8o===l||c.sm().ss(l)}X._25o=X._73o=X._74o=f===hq||f===Ce?X.x=X.lp=X.tx=I:X.y=X.lp=X.ty=I}}),xj.PropertyView=function(m){var Y=this;Y._view=Th(1,Y),Y._canvas=Sg(Y._view),Ig(Y._view,Y._79O=Tj()),Y._rows=new up,Y._28o=new up,Y._26o={},Y._26Q={};var u=Y._propertyModel=new ag,j=Y.ivm;u.mm(j,Y),u.md(j,Y),u.mh(j,Y),Y.dm(m?m:new ag),new Vm(Y)},Oc("PropertyView",Y,{ms_ac:[xm,Mf,Xc,Jo,Hl,"categorizable",zm,yk,Wi,Yb,eq,Ab,yd,Ci,"selectRowIndex",Yo,"background",rg,jo,ig,Dh,uf],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Xq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Xh,_background:t.propertyViewBackground,_expandIcon:t.propertyViewExpandIcon,_collapseIcon:t.propertyViewCollapseIcon,_scrollBarColor:Ib,_scrollBarSize:js,_autoHideScrollBar:ed,_selectBackground:t.propertyViewSelectBackground,_rowHeight:$l,_rowLineVisible:t.propertyViewRowLineVisible,_rowLineColor:t.propertyViewRowLineColor,_10I:.5,_columnLineVisible:t.propertyViewColumnLineVisible,_columnLineColor:t.propertyViewColumnLineColor,_labelColor:t.propertyViewLabelColor,_labelSelectColor:t.propertyViewLabelSelectColor,_labelFont:t.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(X){0>X&&(X=0),X>1&&(X=1);var J=this,M=J._10I;J._10I=X,J.fp("columnPosition",M,X)},getPropertyName:function(z){return z.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(G,x,D){return D===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(M,B){return B===this._selectRowIndex?this._labelSelectColor:M.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(W){var k=this.getHeight()-this._59I;return k>W&&(W=k),W>0?0:U(W)},isExpanded:function(H){if(!H)return!0;var $=this._26o[H];
return $?$.isExpanded:!(this._26Q[H]===!1)},toggle:function(I){var K=this;K.isExpanded(I)?K.collapse(I):K.expand(I)},expandAll:function(){this.validate();for(var g in this._26o)this.expand(g)},expand:function(N){if(N&&N!==rn){var J=this,_=J._26o[N];_&&!_.isExpanded&&(_.isExpanded=!0,J.onExpanded(N),J.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var N in this._26o)this.collapse(N)},collapse:function(g){if(g&&g!==rn){var T=this,F=T._26o[g];F&&F.isExpanded&&(F.isExpanded=!1,T.onCollapsed(g),T.ivm())}},onCollapsed:function(){},getCategoryName:function(g){if(!this.isCategorizable())return rn;var y=g.getCategoryName();return y?y:rn},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(z){var v=this,d=v._dataModel;d!==z&&(d&&(d.umd(v.handlePropertyChange,v),v._selectionModel||d.sm().ums(v.handleSelectionChange,v)),v._dataModel=z,z.md(v.handlePropertyChange,v),v._selectionModel?v._selectionModel._21I(z):z.sm().ms(v.handleSelectionChange,v),v.fp(gq,d,z))},isVisible:function(v){return this._visibleFunc?this._visibleFunc(v):!0},onPropertyChanged:function(H){var _=this,O=H.property;Ch[O]?_.ivm():_.iv(),O===ai&&_._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:bc},handlePropertyChange:function(k){this._27o===k.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var n=this;n._96I||(n.setSelectRowIndex(-1),n._96I=1,n.iv())},redraw:function(){this.iv()},validateModel:function(){var V=this,W=V._rows,v=V._28o,g={},_=new up,f=V._27o;V.updateCurrentData(),f!==V._27o&&V.endEditing(),W.clear(),v.clear(),V.getRawProperties().each(function(d){if(V.isVisible(d)){_.add(d);var D=V.getCategoryName(d);g[D]||(v.add(D,D===rn?0:Q),g[D]={isExpanded:V.isExpanded(D),properties:new up})}}),V._sortFunc&&_.sort(V._sortFunc);for(var l in V._26o)V._26Q[l]=V.isExpanded(l);V._26o=g,v.each(function(c){c!==rn&&W.add(c);var R=g[c];R.isExpanded&&_.each(function(q){V.getCategoryName(q)===c&&(R.properties.add(q),W.add({property:q,data:V._27o}))},V)})},validateImpl:function(){var n=this;n._76o(),n._96I&&(n.validateModel(),delete n._96I);var k=n._canvas,U=n.getWidth(),q=n.getHeight(),s=-n.ty(),R=n._rowHeight,b=n._indent,_=U-b,G=n._rows,y=G.size(),S=n._9I=b+_*n._10I,u=n._59I=y*R;sg(k,U,q),n._29I={x:0,y:s,width:U,height:q},n._31I=e(s/R),n._14I=X((s+q)/R),n._31I<0&&(n._31I=0),n._14I>y&&(n._14I=y);var P,Y=Ye(k),L=n._background;Dj(Y,0,-s,1),Y.beginPath(),Y.rect(0,s,U,q),Y.clip(),Y.clearRect(0,s,U,q),n._93db(Y),L&&Xl(Y,0,0,b,u,L);for(var c=n._31I;c<n._14I;c++){var K=G.get(c),s=R*c;if(fh(K))L&&Xl(Y,b,s,_,R,L),P=Bn(n.isExpanded(K)?n._expandIcon:n._collapseIcon),P&&ck(Y,P,qp,0,s,b,R),Y.save(),Y.beginPath(),Y.rect(b,s,_,R),Y.clip(),n.drawCategoryName(Y,K,c,b,s,_,R),Y.restore();else{var B=K.property,Z=K.data,P=Bn(B.getIcon()),M=n._selectRowIndex===c?n.getSelectBackground():I;if(P&&ck(Y,P,qp,0,s,b,R),M&&Xl(Y,b,s,_,R,M),Y.save(),Y.beginPath(),Y.rect(b,s,S-b,R),Y.clip(),n.drawPropertyName(Y,B,c,b,s,S-b,R),Y.restore(),!n.isEditing(Z,B)){var l=S+1,x=U-S-1;Y.save(),Y.beginPath(),Y.rect(l,s,x,R),Y.clip(),n._87o(n.drawPropertyValue(Y,B,n.getValue(Z,B),c,l,s,x,R,Z),c,l,s,x,R),Y.restore()}}n._rowLineVisible&&Xl(Y,b,s+R-1,_,1,n._rowLineColor)}n._columnLineVisible&&(Xl(Y,S,0,1,u,n._columnLineColor),Xl(Y,U-1,0,1,u)),n._92db(Y),n._93I(),Y.restore(),n.ty(n.ty())},drawCategoryName:function(f,W,d,C,J,X,E){Ac(f,W,this.getCategoryFont(W),this.getCategoryColor(W),C,J,X,E)},drawPropertyName:function(D,N,m,C,p,q,K){return N.drawPropertyName?(N.drawPropertyName(D,N,m,C,p,q,K,this),void 0):(Ac(D,this.getPropertyName(N),this.getPropertyFont(N,m),this.getPropertyColor(N,m),C,p,q,K),void 0)},drawPropertyValue:function(K,V,Y,p,w,l,n,A,X){return V.drawPropertyValue?V.drawPropertyValue(K,V,Y,p,w,l,n,A,X,this):(pb(K,Y,V,this.getLabelFont(V,Y,p),this.getLabelColor(V,Y,p),w,l,n,A,X,this),void 0)},isPropertyEditable:function($){return $.isEditable()&&this.isEditable()},setProperties:function(T){this._propertyModel.clear(),this.addProperties(T)},addProperties:function(O){if(O){var W=this._propertyModel;O.forEach(function(j){if(!(j instanceof Dl)){var p=Mj(j.className);j=jq(p?p:Dl,j)}W.add(j)})}},getRowIndexAt:function(s){var G=this,F=e(G.lp(s).y/G._rowHeight);return F>=0&&F<G._rows.size()?F:-1},getPropertyAt:function(r){var $=this,c=$.getRowIndexAt(r);return c>=0?$._rows.get(c).property:I},getToolTip:function(o){var Y=this,w=Y.getPropertyAt(o),X=Y._27o;return w&&X?w.getToolTip(X,Y._9I<Y.lp(o).x,Y):I}});var Vm=function(_){this.pv=_,this.addListeners()};Rq(Vm,Y,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(B){this.getView().style.cursor=B},clear:function(){var x=this;x._62O=x.cp=x.ty=x.p=I,x.setCursor(ho)},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(C){var Y=this,I=Y.pv;Rg(C),I.setFocus(C)&&(Qn(C)?(Y.cp=hb(C),Y.ty=I.ty(),Y.p=I.getColumnPosition(),Y.handle_touchmove(C)):I.setSelectRowIndex(I.getRowIndexAt(C)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(a){var f=this;if(f.cp&&!f._62O){var p=f.pv,Q=p.lp(a),n=Q.x,g=Q.y,s=p._indent,B=p.getRowIndexAt(a),i=p._9I;if(B>=0){var G=p._rowHeight,x=G*B,K=p._rows.get(B),Y=K.property;if(fh(K))Bn(p.isExpanded(K)?p._expandIcon:p._collapseIcon)&&n>=0&&s>=n&&g>=x&&x+G>=g?p.toggle(K):Mb(a)&&p.toggle(K);else if(n>i&&p.isPropertyEditable(Y,a)){var I={x:i+1,y:x,width:p.getWidth()-i-1,height:G},N={x:I.x+p.tx(),y:I.y+p.ty(),width:I.width,height:I.height},w=0,u=p._29I;I.y<u.y?w=I.y-u.y:I.y+G>u.y+u.height&&(w=I.y+G-u.y-u.height),w&&(p.ty(p.ty()-w),N.y-=w),p.beginEditing({data:K.data,property:Y,value:p.getValue(K.data,Y),event:a,rect:I,editorRect:N,view:p})}}p.setSelectRowIndex(B)}f.clear()},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(m){var B=this,P=B.pv,L=B.ty,j=B.cp,e=hb(m),S=B._62O;if("p"===S)P.setTranslateY(L+e.y-j.y);else if("c"===S){var d=P.getWidth()-P._indent;if(d>16){var g=B.p-(j.x-e.x)/d,z=16/d;z>g&&(g=z),g>1-z&&(g=1-z),P.setColumnPosition(g)}}else"s"===S&&P.setTranslateY(L+(j.y-e.y)*P._59I/P._29I.height)},handle_mousemove:function(_){this.handle_touchmove(_)},handle_touchmove:function(Z){if(!_k&&Qn(Z)){var E=this,_=E.pv,h=H(_.lp(Z).x-_._9I)<=(Jm?8:3);E.cp?E._62O||(h?(E._62O="c",_g(E)):H(hb(Z).y-E.cp.y)>=2&&(E._62O=E.isV(Z)?"s":"p",_g(E))):(h?E.setCursor(Cn):E.setCursor(ho),E.isV(Z)&&_._43o())}},isV:function(n){var o=this.pv,H=o._29I;return o._41o()&&H.x+H.width-o.lp(n).x<gr},handle_mousewheel:function(z){this.handleScroll(z,z.wheelDelta/40)},handle_DOMMouseScroll:function(b){2===b.axis&&this.handleScroll(b,-b.detail)},handleScroll:function(D,_){var j=this.pv;Rg(D),j.endEditing(),j.translate(0,_*j.getRowHeight())},handle_keydown:function(n){var K=this.pv,$=K._rows.size(),w=K._selectRowIndex+(dk(n)?-1:1);(dk(n)||nr(n))&&(0>w&&(w=0),w>=$&&(w=$-1),K.setSelectRowIndex(w))}}),xj.ListView=function(C){this._5o(C),new sk(this)},Oc("ListView",Y,{ms_ac:[xm,Mf,Xc,rg,zm,jo,ig,yk,Wi,Ab,yd,Ci,Ik,Yo],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Xh,_rowHeight:$l,_rowLineVisible:t.listViewRowLineVisible,_rowLineColor:t.listViewRowLineColor,_scrollBarColor:Ib,_scrollBarSize:js,_autoMakeVisible:yo,_autoHideScrollBar:ed,_selectBackground:t.listViewSelectBackground,_labelColor:t.listViewLabelColor,_labelSelectColor:t.listViewLabelSelectColor,_labelFont:t.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(Z){var j=this,N=j._checkMode;j._checkMode=Z,j.fp(Oi,N,Z)},drawRow:function(V,n,u,Q,X,I,T){var W=this,b=0,j=W._indent,N=W.getIconWidth(n);W.drawRowBackground(V,n,u,Q,X,I,T),W._checkMode&&(Kd(V,Bn(W.getCheckIcon(n)),b+j/2,X+T/2,n,W),b+=j),W.drawIcon(V,n,b,X,N,T),W.drawLabel(V,n,b+N,X,T)}});var sk=function(u){this.list=u,this._lastSelectDataTime=Fc(),this.addListeners()};Rq(sk,Y,{ms_listener:1,getView:function(){return this.list._view},clear:function(y){var M=this,H=M.list;y&&"d"===M._62O&&!M.dragCancel&&H.handleDragAndDrop(y,"end"),H.draggingData&&(H.draggingData=null,H.redraw()),M.dragCancel=M._62O=M._isV=M._isH=M.cp=M.tx=M.ty=I},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(c){var u=this,V=u.list;if(Rg(c),V.setFocus(c)){var K=V.getDataAt(c);u.cp=hb(c),u.tx=V.tx(),u.ty=V.ty(),Qn(c)?K&&V.handleDragAndDrop&&!u.isV(c)&&!u.isH(c)&&(V.draggingData=K,V.redraw(),V.handleDragAndDrop(c,"prepare")):(K&&u._33o(c,K),u.clear(c))}},handleWindowMouseUp:function(s){this.clear(s)},handleWindowTouchEnd:function(k){this.clear(k)},handle_mouseup:function(b){this.handle_touchend(b)},handle_touchend:function(l){var g=this,F=g.list;if(!g._isV&&!g._isH&&g.cp&&!g._62O){var t=F.getDataAt(l);t?(F.isCheckMode()?g._34o(l,t):g._33o(l,t),Mb(l)?F.onDataDoubleClicked(t,l):F.onDataClicked(t,l)):F.handleBackgroundClick(l)}g.clear(l)},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowTouchMove:function(i){var N=this,w=N.list,v=N._62O,C=N.tx,o=N.ty,b=N.cp,y=hb(i),j=w._29I;"p"===v?w.setTranslate(C+y.x-b.x,o+y.y-b.y):"v"===v?w.ty(o+(b.y-y.y)*w._59I/j.height):"h"===v?w.tx(C+(b.x-y.x)*w._91I/j.width):"d"===v&&(N.dragCancel||w.handleDragAndDrop(i,"between"))},handle_mousemove:function(T){this.handle_touchmove(T)},handle_touchmove:function(g){if(!_k&&Qn(g)){var e=this,M=e.list;if(e._isV=e.isV(g),e._isH=e.isH(g),e.cp){if(!e._62O){if(Oj(hb(g),e.cp)<2)return;e._isV?e._62O="v":e._isH?e._62O="h":M.draggingData&&!this.dragCancel?(e._62O="d",M.handleDragAndDrop(g,"begin")):e._62O="p",e._62O&&"d"!==e._62O&&M.draggingData&&(M.draggingData=null,M.redraw()),_g(e)}}else e._isV&&M._43o(),e._isH&&M._42o()}},isV:function(H){var d=this.list,q=d._29I;return d._41o()&&q.x+q.width-d.lp(H).x<gr},isH:function(b){var z=this.list,u=z._29I;return z._40o()&&u.y+u.height-z.lp(b).y<gr},handle_mousewheel:function(k){this.handleScroll(k,k.wheelDelta/40,k.wheelDelta!==k.wheelDeltaX)},handle_DOMMouseScroll:function(J){this.handleScroll(J,-J.detail,1)},handleScroll:function(J,H,S){var C=this.list;Rg(J),C.endEditing&&C.endEditing(),S&&C._41o()?C.translate(0,H*C.getRowHeight()):C._40o()&&C.translate(10*H,0)},handle_keydown:function(v){if(!t.isInput(v.target)){var C,E=this.list,o=E.sm(),j=E._rows,R=j.size();if(Fq(v))E.selectAll();else if(wq(v))E.handleDelete&&E.handleDelete(v);else if(uq(v))"d"!==this._62O||this.dragCancel||(E.handleDragAndDrop(v,"cancel"),this.dragCancel=!0);else if(vp(v))E.isCheckMode()&&(C=E.getFocusData(),C&&E.checkData(C));else if(dk(v)||nr(v)){var B=E.isCheckMode();if(C=B?E.getFocusData():o.ld()){var z=E.getRowIndex(C);z>=0&&(dk(v)?0!==z&&(C=j.get(z-1),B?E.setFocusData(C):o.ss(C)):z!==R-1&&(C=j.get(z+1),B?E.setFocusData(C):o.ss(C)))}else R>0&&(C=j.get(0),B?E.setFocusData(C):o.ss(C))}}},_34o:function(j,M){var d=this.list,G=d.lp(j).x;return G>=0&&G<=d._indent?(d.checkData(M),void 0):(d.setFocusData(M),void 0)},_33o:function(D,o){var s=this.list,h=s.sm(),V=h.ld();if(Ic(D))s.isSelected(o)?h.rs(o):h.as(o);else if(Kh(D))if(V)for(var b=s.getRowIndex(V),e=s.getRowIndex(o);b!==e;)b+=e>b?1:-1,h.as(s._rows.get(b));else h.ss(o);else if(Qn(D)){var F=Fc();if(h.contains(o)){var Y=F-this._lastSelectDataTime;s.handleDataDoubleSelect&&Y>500&&1500>Y&&s.handleDataDoubleSelect(D,o)}h.ss(o),this._lastSelectDataTime=F}else h.contains(o)||h.ss(o)}}),xj.TreeView=function(L){var w=this;w._35o(),w._5o(L),new Ni(w)},Oc("TreeView",Y,{ms_ac:[xm,Mf,Xc,"rootVisible",Oi,"rootData",yk,Wi,Ab,yd,Ci,zm,rg,jo,ig,Yb,eq,Ik,Yo,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:I,_indent:Xh,_rowHeight:$l,_rowLineVisible:t.treeViewRowLineVisible,_rowLineColor:t.treeViewRowLineColor,_scrollBarColor:Ib,_scrollBarSize:js,_autoHideScrollBar:ed,_expandIcon:t.treeViewExpandIcon,_collapseIcon:t.treeViewCollapseIcon,_autoMakeVisible:yo,_selectBackground:t.treeViewSelectBackground,_labelColor:t.treeViewLabelColor,_labelSelectColor:t.treeViewLabelSelectColor,_labelFont:t.treeViewLabelFont,_doubleClickToToggle:t.treeViewDoubleClickToToggle,drawRow:function(B,L,c,G,P,Q,$){var J=this;J.drawRowBackground(B,L,c,G,P,Q,$),J._97I(B,L,c,0,P,Q,$)},isOnToggleIcon:function(J){var j=this.getDataAt(J);if(j){var P=this.getIndent(),y=this.lp(J).x;if(Bn(this.getToggleIcon(j))){var u=P*this.getLevel(j);if(y>=u&&u+P>=y)return!0}}return!1}});var Ni=function(a){mj(Ni,this,[a])};Rq(Ni,sk,{toggle:function(T,J,l,z){var D=this.list,w=D.lp(T).x;if(Bn(D.getToggleIcon(J))){var g=l*z;if(w>=g&&g+l>=w)return D.toggle(J),!0}return D.isDoubleClickToToggle()&&Mb(T)?(D.toggle(J),!0):!1},_34o:function(a,D){var G=this.list,O=G.lp(a).x,F=G._levelMap[D._id],c=G._indent,b=c*(F+1);return O>=b&&b+c>=O?(G.checkData(D),void 0):(this.toggle(a,D,c,F)||G.setFocusData(D),void 0)},_33o:function(j,c){var T=this,p=T.list;if(!T.toggle(j,c,p._indent,p.getLevel(c)))if(Kh(j)){var v=p.sm();if(v.size()>0){for(var a=p._rows,h=null,D=0,U=a.size();U>D;D++)if(p.isSelected(a.get(D))){h=D;break}for(var x=null,D=a.size()-1;D>=0;D--)if(p.isSelected(a.get(D))){x=D;break}var u,Y,B=p.getRowIndex(c);for(h>B?(u=B-1,Y=h):B>x?(u=x,Y=B):(u=h,Y=x);u!==Y;)u++,v.as(p._rows.get(u))}else v.ss(c)}else Ni.superClass._33o.call(T,j,c)},handle_keydown:function(e){if(Zo(e)||ip(e)){var U=this.list,L=U._rows,O=U.isCheckMode(),N=U.sm(),C=O?U.getFocusData():N.ld();C?C.hasChildren()&&(Zo(e)?U.collapse(C):U.expand(C)):L.size()>0&&(C=L.get(0),O?U.setFocusData(C):N.ss(C))}else Ni.superClass.handle_keydown.call(this,e)}});var iq=xj.TableView=function(M){this._98I(),this._5o(M),new Ym(this)};Oc("TableView",Y,{ms_ac:[xm,Mf,Xc,"sortMode",Jo,Hl,rg,jo,ig,Dh,uf,"sortColumn",yk,Wi,Ab,yd,Ci,Ik,Yo],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:xd,_editable:!0,_batchEditable:!1,_rowHeight:$l,_rowLineVisible:t.tableViewRowLineVisible,_rowLineColor:t.tableViewRowLineColor,_columnLineVisible:t.tableViewColumnLineVisible,_columnLineColor:t.tableViewColumnLineColor,_scrollBarColor:Ib,_scrollBarSize:js,_autoHideScrollBar:ed,_autoMakeVisible:yo,_selectBackground:t.tableViewSelectBackground,_labelColor:t.tableViewLabelColor,_labelSelectColor:t.tableViewLabelSelectColor,_labelFont:t.tableViewLabelFont,getCheckColumn:function(){var l=this;if(!l._31o){var s=l._31o=new gb;s.setEditable(!0),s.setWidth(40),s.getValue=l.getCheckColumValue,s.drawCell=l.drawCheckColumnCell}return l._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(f){var G=this,o=G._39o,K=G.getCheckColumn();f!==G.isCheckMode()&&(f?o.add(K,0):o.remove(K),G.fp(Oi,!f,f))},getCheckColumValue:function(W,X,p){return p.isSelected(W)},drawCheckColumnCell:function(X,M,N,Q,D,G,V,o,A){Kd(X,A.getCheckIcon(M),D+V/2,G+o/2,M,A)}});var Ym=function(v){mj(Ym,this,[v])};Rq(Ym,sk,{_34o:function(o,t){var j=this.list,y=j._31o;if(j.isCellEditable(t,y,o)){var T=j._3Q(y),P=j.lp(o).x;if(T&&P>=T.startX&&P<T.startX+y.getWidth())return j.checkData(t),void 0}j._37O(t,o),j.setFocusData(t)},_33o:function(e,q){this.list._37O(q,e),Ym.superClass._33o.apply(this,arguments)}});var Ed=xj.TreeTableView=function(V){var h=this,A=h._4o=new gb;h._35o(),h._98I(),h._5o(V),A.setDisplayName("Name"),A.setEditable(!0),A.setWidth(180),A.drawCell=ej,A.getValue=as,h._39o.add(A),new gi(h)},ej=function(f,X,m,y,c,S,I,t,Q){Q._97I(f,X,m,c,S,I,t)},as=function(i,Q,X){return X.getLabel(i)};Oc("TreeTableView",Y,{ms_ac:[xm,Mf,Xc,"sortMode",Jo,Hl,zm,Oi,"rootData","rootVisible",yk,Wi,"sortColumn",Yb,eq,Ab,yd,Ci,Ik,ig,rg,jo,Dh,uf,Yo,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:xd,_checkMode:I,_editable:!0,_batchEditable:!1,_indent:Xh,_rowHeight:$l,_rowLineVisible:t.treeTableViewRowLineVisible,_rowLineColor:t.treeTableViewRowLineColor,_columnLineVisible:t.treeTableViewColumnLineVisible,_columnLineColor:t.treeTableViewColumnLineColor,_expandIcon:t.treeTableViewExpandIcon,_collapseIcon:t.treeTableViewCollapseIcon,_scrollBarColor:Ib,_scrollBarSize:js,_autoHideScrollBar:ed,_autoMakeVisible:yo,_selectBackground:t.treeTableViewSelectBackground,_labelColor:t.treeTableViewLabelColor,_labelSelectColor:t.treeTableViewLabelSelectColor,_labelFont:t.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var gi=function($){mj(gi,this,[$])};Rq(gi,sk,{_34o:function(_,y){var W=this.list,b=W._4o,l=W._3Q(b),H=W.lp(_).x;if(l){var M=W._indent,t=l.startX+M*W.getLevel(y);if(Bn(W.getToggleIcon(y))&&H>=t&&t+M>=H)return W.toggle(y),void 0;if(W.isCellEditable(y,b)&&(t+=M,H>=t&&t+M>=H))return W.checkData(y),void 0}W._37O(y,_),W.setFocusData(y)},_33o:function(B,F){var C=this.list,J=C.lp(B).x;if(Bn(C.getToggleIcon(F))){var M=C._3Q(C._4o);if(M){var s=C._indent,Q=M.startX+s*C.getLevel(F);if(J>=Q&&Q+s>=J)return C.toggle(F),void 0}}C._37O(F,B),gi.superClass._33o.apply(this,arguments)}});var Xi=xj.TableHeader=function(H){var G=this,_=G._view=Th(1,G),z=G._39o=H.getColumnModel(),F=G.iv;G.tv=G._tableView=H,G._60I=new up,G._canvas=Sg(_),_.style.background=t.tableHeaderBackground||"",_.style.height=eh+kh,z.mm(F,G),z.md(F,G),z.mh(F,G),H.mp(function(t){$k[t.property]&&G.iv()},G),new hg(G),G.iv()};Oc("TableHeader",Y,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",xm,Xc,zm,"moveBackground","insertColor",Dh,uf,"resizable","movable"],_checkIcon:Rp,_movable:!0,_resizable:!0,_labelColor:t.tableHeaderLabelColor,_labelFont:t.tableHeaderLabelFont,_columnLineColor:t.tableHeaderColumnLineColor,_columnLineVisible:t.tableHeaderColumnLineVisible,_sortDescIcon:t.tableHeaderSortDescIcon,_sortAscIcon:t.tableHeaderSortAscIcon,_moveBackground:t.tableHeaderMoveBackground,_insertColor:t.tableHeaderInsertColor,_indent:Xh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(T){return T.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(d){return d.getColor()||this._labelColor},getLabelAlign:function(W){return W._align},onPropertyChanged:function(){this.iv()},_5Q:function($){this._61I=$,this.iv()},getLogicalPoint:function(k){return pq(k,this._canvas,this.tv.tx())},validateImpl:function(){var x=this,m=x._canvas,Q=x.getWidth(),Y=x.getHeight(),C=x.tv,U=x._60I,g=x._61I,T=-C.tx(),B=0;(Q!==m.clientWidth||Y!==m.clientHeight)&&sg(m,Q,Y),U.clear(),x._39o._roots.each(function(A){if(A.isVisible()){var Z=B+A.getWidth();T+Q>=B&&Z>=T&&U.add({column:A,startX:B}),B=Z}});var a=Ye(m);if(Dj(a,-T,0,1),a.beginPath(),a.rect(T,0,Q,Y),a.clip(),a.clearRect(T,0,Q,Y),U.each(function(W){var l=W.column,J=W.startX,O=l.getWidth();O>0&&(a.save(),a.beginPath(),a.rect(J,0,O,Y),a.clip(),g&&g.column===l||x.drawColumn(a,l,J,0,O,Y),x._columnLineVisible&&Xl(a,J+O-1,0,1,Y,x._columnLineColor),a.restore())}),g){var z=g.column,B=g.startX,L=g.position,R=z.getWidth();a.save(),a.beginPath(),a.rect(B,0,R,Y),a.clip(),a.fillStyle=x._moveBackground,a.fill(),x.drawColumn(a,z,B,0,R,Y),a.restore(),tn(a,x._insertColor,L,0,Y)}a.restore()},_6Q:function(b){var E=this.tv;return E._31o===b&&E.sm().getSelectionMode()===fq},drawColumn:function(y,B,t,T,x,w){var Q=this,O=Q.tv,r=Bn(B.getIcon()),l=Q.getLabelAlign(B);if(Q._6Q(B)){var X=Bn(Q._checkIcon);Kd(y,X,t+x/2,T+w/2,B,Q)}else{var M=Q.getLabel(B),j=Q.getLabelFont(B),Z=Q.getLabelColor(B),A=Cg(j,M).width,q=r?Q._indent:0;l===Hd?(r&&ck(y,r,qp,t,T,q,w),Ac(y,M,j,Z,t+q,T,x,w,Hd)):l===Np?(r&&ck(y,r,qp,t+x-A-q,T,q,w),Ac(y,M,j,Z,t,T,x,w,Np)):(r&&ck(y,r,qp,t+(x-A-q)/2,T,q,w),Ac(y,M,j,Z,t+(x-A+q)/2,T,0,w,Hd))}if(B.isSortable()&&O.getSortColumn()===B&&(r=Bn(B.getSortOrder()===jd?Q._sortAscIcon:Q._sortDescIcon))){var p=vk(r,B)/2+2;Kd(y,r,l===Np?t+p:t+x-p,T+w/2,B,O)}}});var hg=function(m){var U=this;U.th=m,U.tv=m._tableView,U.addListeners()};Rq(hg,Y,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(m){this.getView().style.cursor=m},handle_mousemove:function(w){if(!_k){var Y=this;delete Y._29o,Y.setCursor(ho);for(var m=Y.th,e=m._60I,S=m.lp(w).x,$=e.size()-1;$>=0;$--){var n=e.get($),b=n.column,h=n.startX+b.getWidth();if(m.isResizable()&&H(h-S)<=(Jm?10:3))return Y._29o=n,Y.setCursor(Cn),void 0;S>n.startX&&h>S&&(Y._29o=n),(b.isClickable()||b.isSortable()||m.isMovable()||Y.tv.getCheckColumn&&b===Y.tv.getCheckColumn())&&S>n.startX&&h>S&&Y.setCursor(im)}}},handle_mousedown:function(A){this.handle_touchstart(A)},handle_touchstart:function(s){var T=this;Rg(s),T.tv.endEditing(),T.handle_mousemove(s),T._29o&&(T.x=hb(s).x,T.lx=T.th.lp(s).x,T.w=T._29o.column.getWidth(),_g(T,s))},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(y){var r=this,s=r.th,U=r.getView().style.cursor,z=r._29o,E=hb(y).x-r.x;if(r.resizing||r.moving||(U===Cn?r.resizing=1:s.isMovable()&&U===im&&H(E)>2&&(r.moving=1)),r.resizing)z.column.setWidth(r.w+E);else if(r.moving){var l=r.lx+E;s._60I.each(function(d){var R=d.startX,M=R+d.column.getWidth();if(l>=R&&M>=l){var D={column:z.column,startX:z.startX+E,front:M-l>l-R,insertColumn:d.column};D.position=D.front?R:M,s._5Q(D)}})}},_16Q:function(g,H){var W=this,M=W.tv,u=W.th,t=u._checkIcon;if(u._6Q(g)){var y=Bn(t),C=W.lx,K=g.getWidth(),w=vk(y,g);if(C>=H+K/2-w&&H+K/2+w>=C){u.setCheckIcon(t===eb?Rp:eb);var m=M.sm(),a=M._rows;return t===eb?m.rs(a):m.ss(a),M.onCheckColumnClicked(g),!0}}return!1},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(m){var Y=this,E=Y.tv,b=Y.th,k=Y._29o;if(Y.moving){var r=b._61I;if(r&&r.insertColumn!==r.column){var B=r.column,G=E.getColumnModel()._roots,M=G.remove(B),O=G.indexOf(r.insertColumn);O>=0&&(r.front||O++,O<=G.size()&&(G.add(B,O),E.getColumnModel()._38I(B,M,O)))}b._5Q(I),delete Y.moving}else if(!Y.resizing&&k){B=k.column;var U=b.lp(m).x,o=k.startX,P=!0;if(b.onColumnClicked){var p=b.onColumnClicked(B,m,o);p===!1&&(P=!1)}if(P&&U>=o&&U<=o+B.getWidth()&&!Y._16Q(B,o)){if(B.isSortable()){var w=E.getSortMode(),V=B.getSortOrder();w===xd?E.getSortColumn()===B?(V===Un&&E.setSortColumn(I),B.setSortOrder(V===jd?Un:jd)):E.setSortColumn(B):"bistate"===w&&(E.getSortColumn()===B?B.setSortOrder(V===jd?Un:jd):E.setSortColumn(B))}E.onColumnClicked(B,m,o)}}Y._29o=Y.resizing=Y.x=Y.lx=Y.w=I}}),xj.TablePane=function(o){this.init(new iq(o))},Oc("TablePane",Y,{ms_v:1,_44o:1}),xj.TreeTablePane=function(F){this.init(new Ed(F))},Oc("TreeTablePane",Y,{ms_v:1,_44o:1}),xj.Toolbar=function(W){var O=this,l=O._view=Th(1,O),A=l.style;A.background=t.toolbarBackground||"",A.height=Ng+kh,O._canvas=Sg(l),O._30o=new up,O._90I=new up,O.setItems(W||[]),l.handleGroupSelectedChanged=function(h){if(h.isSelected()){var i=h.getGroupId();null!=i&&O._items.forEach(function(S){var j=S.element;j&&j!==h&&j.setSelected&&j.getGroupId&&j.getGroupId()===i&&j.setSelected(!1)})}},new ek(O)},Oc("Toolbar",Y,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Zh,xm,Xc,Mf,Yo,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:t.toolbarLabelColor,_labelSelectColor:t.toolbarLabelSelectColor,_labelFont:t.toolbarLabelFont,_selectBackground:t.toolbarSelectBackground,_itemGap:t.toolbarItemGap,_separatorColor:t.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(c){var o=this.getItemInfoAt(c);return o?o.item.toolTip:I},getLabelColor:function(m){return m&&m.selected&&m.type!==eb&&m.type!==df?this._labelSelectColor:this._labelColor},onPropertyChanged:function(r){this.iv(),r.property===Zh&&this._items.forEach(function(X){Zm(X)})},redraw:function(){this.iv()},addItem:function(F,Q){var C=this._items;Q==I?C.push(F):C.splice(Q,0,F),this.fp(Zh,I,C)},removeItem:function(x){if(x)for(var A=this._items,Z=0;Z<A.length;Z++)x===A[Z]&&(A.splice(Z,1),this.fp(Zh,I,A))},removeItemById:function(F){if(F!=I)for(var W=this._items,D=0;D<W.length;D++)if(F===W[D].id){var s=W.splice(D,1)[0];return this.fp(Zh,I,W),s}},getItemById:function(T){if(T!=I)for(var N=this._items,R=0;R<N.length;R++){var j=N[R];if(T===j.id)return j}},setItemVisible:function(y,Q){var q=this.getItemById(y);q&&(q.visible=Q)},getItemInfos:function(){return this._30o},getItemInfoAt:function(N){var z=this,j=0,g=z._30o,T=z.lp(N),y=T.x,d=T.y;if(d>=0&&d<=z.getHeight())for(;j<g.size();j++){var P=g.get(j);if(P.startX<=y&&y<=P.endX)return P}return I},drawItem:function(D,f,V,T,P){if(f.visible===!1)return 0;if(qi(f.visible)&&!f.visible())return 0;var Y=this,v=f.disabled;v&&(D.globalAlpha=ls);var I=Y.drawItemImpl(D,f,V,T,P),s=Y._itemGap;return v&&(D.globalAlpha=1),this._currentItem!==f||"separator"===f||f.separator===!0||f.unfocusable||_d(D,Y._separatorColor,V-s/2,0,I+s,T),I},drawItemImpl:function(s,j,e,W,n){var o=this,R=o._view,E=o._itemGap,l=W/2,h=j.type,Z=j.element,f=j.label;fh(Z)&&(f=Z,Z=I);var S,Y=o.getLabelFont(j),i=o.getLabelColor(j),q=j.selected,N=Bn(j.icon),C=vk(N,j),p=0,P=C+(f?Cg(Y,f).width:0);if("separator"===j||j.separator===!0)return tn(s,o._separatorColor,e,W/4,l),1;if(Z){N&&Kd(s,N,e+C/2,l,j,o),Ac(s,f,Y,i,e+C,0,0,W);var A=mf(Z);n||o._90I.add(A),A.parentNode!==R&&Ig(R,A),Z.iv&&Z.iv(),Z.validate&&Z.validate();var d=A.getBoundingClientRect(),D=d.width,L=A.style;return Fb(A),L.left=o.tx()+e+P+kh,L.top=(W-d.height)/2+kh,P+D}return h===df?S=Bn(q?Jp:gf):h===eb&&(S=Bn(q?eb:Rp)),S?(p=vk(S,j),Kd(s,S,e+p/2,l,j,o),e+=p,P+=p):q&&Xl(s,e-E/2,0,P+E,W,o.getSelectBackground(j)),N&&Kd(s,N,e+C/2,l,j,o),Ac(s,f,Y,i,e+C,0,0,W),P},validateImpl:function(){var q=this,f=q._canvas,S=q.getWidth(),N=q.getHeight(),L=q._30o,p=q._items;sg(f,S,N);var a=Ye(f),M=q._itemGap,Q=M/2;Dj(a,q.tx(),0,1),a.clearRect(0,0,S,N);var d=q._90I;q._90I=new up,L.clear(),p.forEach(function(p){var l=q.drawItem(a,p,Q,N);L.add({item:p,startX:Q,endX:Q+l,width:l}),l&&(Q+=l+M)}),d.each(function(G){q._90I.contains(G)||mo(G)});var t=q._64I;q._64I=P(0,Q),a.restore(),q._stickToRight?(q._65O=0,a=Ye(f),Q=S-q._64I+M,Dj(a,0,0,1),a.clearRect(0,0,S,N),L.clear(),p.forEach(function(m){var F=q.drawItem(a,m,Q,N,!0);L.add({item:m,startX:Q,endX:Q+F,width:F}),F&&(Q+=F+M)}),a.restore()):q.tx(q.tx()),t!==q._64I&&q.onSumWidthChanged(t,q._64I)},onSumWidthChanged:function(){},handleClick:function(E,b){var e=this,y=E.type,U=E.action,F=E.groupId,L=E.selected;E.disabled||(F!=I?L||(E.selected=!0,this._items.forEach(function(O){O.groupId===F&&E!==O&&(O.selected=!1)}),U&&E.action(E,e,b)):y===eb||"toggle"===y?(E.selected=!L,U&&E.action(E,e,b)):U&&E.action(E,e,b)),am(),e.iv()}});var ek=function(S){this.tb=S,this.addListeners()};Rq(ek,Y,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,10*-Z.detail)},handleScroll:function(g,S){Rg(g);var W=this.tb;W.isScrollable()&&!W._stickToRight&&(W.tx(W.tx()+S),lj())},handle_mousemove:function(K){var S=this;_k||S.setItem(K)},handle_mouseout:function(r){var f=this;r.target===f.getView()?f.tb.setCurrentItem(I):f.handle_mousemove(r)},handle_mousedown:function(G){this.handle_mousemove(G),this.handle_touchstart(G)},handle_touchstart:function(v){var a=this,I=a.tb,o=v.target;Qn(v)&&(o===a.getView()||o===I._canvas)&&(Rg(v),I.setFocus(v)&&(this.setItem(v,!0),(I.isScrollable()||a.info&&!a.info.item.disabled)&&(a.x=hb(v).x,a.tx=I.tx(),_g(a,v))))},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(O){var V=this,j=V.tb;if(!j._stickToRight){var Y=hb(O).x-V.x;!V._25o&&H(Y)>2&&j.isScrollable()&&(V._25o=1),V._25o&&j.tx(V.tx+Y)}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(T){var t=this,Y=t.tb,i=t.info,b=t.tb.getItemInfoAt(T);if(!t._25o&&i){var H=i.item;b&&b.item===H&&Y.handleClick(H,T)}t._25o=t.x=t.tx=I,t.setItem()},setItem:function(f,n){var k=this,X=k.tb,m=k.info=f?X.getItemInfoAt(f):I,F=m?m.item:I;X.setCurrentItem(F),n&&F&&qi(F.onDown)&&F.onDown(f)}}),xj.BorderPane=function(){this._view=Th(1,this),this.iv()},Oc("BorderPane",Y,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(K,H){this._12o("leftView",K),H!=I&&this.setLeftWidth(H)},getRightView:function(){return this._rightView},setRightView:function(Z,x){this._12o("rightView",Z),x!=I&&this.setRightWidth(x)},getTopView:function(){return this._topView},setTopView:function(T,$){this._12o("topView",T),$!=I&&this.setTopHeight($)},getBottomView:function(){return this._bottomView},setBottomView:function(h,Y){this._12o("bottomView",h),Y!=I&&this.setBottomHeight(Y)},getCenterView:function(){return this._centerView},setCenterView:function(k){this._12o("centerView",k)},_12o:function(C,Z){var z=this,T="_"+C,Y=z._view,u=z[T];u!==Z&&(u&&(u.getView?mo(u.getView()):mo(u)),z[T]=Z,Z&&(Z.getView?Ig(Y,Z.getView(),1):Ig(Y,Z,1)),z.fp(C,u,Z))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var X=this,J=X._topView,r=X._bottomView,k=X._leftView,H=X._rightView,Q=X._centerView,y=X.getWidth(),Z=X.getHeight(),f=0,b=0,x=y,d=Z,R=0,F=0,a=0,T=0;J&&(R=X._topHeight==I?co(J):X._topHeight,b=R),r&&(F=X._bottomHeight==I?co(r):X._bottomHeight,d=Z-F),k&&(a=X._leftWidth==I?de(k):X._leftWidth,f=a),H&&(T=X._rightWidth==I?de(H):X._rightWidth,x=y-T);var B=P(0,x-f),z=P(0,d-b);J&&Op(J,0,0,y,R),r&&Op(r,0,d,y,F),k&&Op(k,0,b,a,z),H&&Op(H,x,b,T,z),Q&&Op(Q,f,b,B,z)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);