!function(r,O,a){"use strict";var n="ht",I=r[n],F=I.Default,U=I.graph,L=F.getInternal(),K=L.ui(),J=K.NodeUI.prototype,y=K.ShapeUI.prototype,c=U.GraphView,P=c.prototype,Z=K.EdgeUI.prototype,Q=I.Node,g=I.Shape,$=I.Edge,z=I.Group,H=F.isTouchable,q=F.preventDefault,G=r.setTimeout,T=F.grow,o=F.isDragging,E=F.getDistance,D=null,N=I.List,v="undefined"!=typeof Float32Array?Float32Array:Array,u=Math,x=u.PI,X="Crossing",l="No Crossing",h=x/2,M=2*x,m=u.atan2,w=u.sqrt,d=u.pow,C=u.sin,k=u.cos,f=u.min,t=u.max,B=u.abs,A=u.ceil,i=u.round,Y=F.unionPoint,V=F.unionRect,R=F.containsPoint,e=F.clone,_="rgb(52, 152, 219)",p="red",S={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},b={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var s=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],K=0;K<s.length;K++){var B=s[K];B=0===K%2?B/400*b.width:B/100*b.height,s[K]=B}return b.width>120&&(s[4]=b.width-26,s[6]=b.width-40,s[10]=b.width-40,s[12]=b.width-26,s[18]=33),s}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},j={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:_,rotation:.61},{type:"circle",rect:[200,120,70,70],background:_,rotation:.61},{type:"circle",rect:[200,220,70,70],background:_,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:_},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:_}]},W={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:p,rotation:.61}]},s={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:_},{type:"circle",rect:[0,210,90,90],background:_},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:_}]},Kk={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:p},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:p}]},Bq={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:_}]},Mp={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:p}]},eq={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},jf={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Ed=function(X){var Z=X.touches[0];return Z?Z:X.changedTouches[0]},gr=function(C,h,i,$){return m($-h,i-C)},fp=function(Z,x){return{x:Z.x*x,y:Z.y*x}},ye=function(V,r){V.each(function(N){return V.isSelected(N)?r(N):void 0})},fj=function(W,j){W.reverseEach(function(v){return W.isSelected(v)?j(v):void 0})},Rm=function(F,y,C){var P,x,v,j,H,o=this,T=y,Z=o.gv;if(F instanceof g){v=F.getSegments();var Q=Z.getDataUI(F);H=Q._55O.$15l,v&&v.size()||(v=sj(H)),F.isClosePath()&&v.indexOf(5)<0&&(v=new N(v._as),v.add(5)),P=Il(F,Q,T),x=H[P]}else{var l=Z.getDataUI(F);H=gq(l,F.s("edge.points")),v=F.s("edge.segments"),v&&v.size()||(v=sj(H)),H=H._as,P=Il(F,l,T),x=H[P]}if(v&&(j=v.get(T)),2===j||1===j||5===j){var G=H[P+1];5===j&&(G=H[0]);var u=ag(x,C,G);return u}return C},th=function(V,y,$,l){var k=y/2,c=$/2,z=zc(V,-k,-c,l),x=zc(V,k,-c,l),R=zc(V,-k,c,l),E=zc(V,k,c,l),d=zc(V,0,-c,l),s=zc(V,k,0,l),Q=zc(V,0,c,l),M=zc(V,-k,0,l);return[z,x,R,E,d,s,Q,M]},ag=function(t,T,g){var F={x:T.x-t.x,y:T.y-t.y},G={x:g.x-t.x,y:g.y-t.y},L=w(d(g.x-t.x,2)+d(g.y-t.y,2)),e={x:G.x/L,y:G.y/L},o=F.x*e.x+F.y*e.y,J={x:e.x*o,y:e.y*o};return{x:t.x+J.x,y:t.y+J.y}},zc=function(c,$,_,x){var d=k(x)*$-C(x)*_,W=C(x)*$+k(x)*_;return c?{x:c.x+d,y:c.y+W}:{x:d,y:W}},fh=function(T,E){return E>2*T?T:E/2},An=function(j,r,D,Y){var A=E(j,r);return D=Y?f(D,A):fh(D,A),A?D/=A:D=0,{x:j.x+(r.x-j.x)*D,y:j.y+(r.y-j.y)*D}},lo=function(O,U){var n,M,T=O.gv,t=O._data,G=t._40I,Q=t._41I,i=t.s("edge.offset"),p=t.s("edge.source.position"),g=t.s("edge.target.position"),z=t.s("edge.source.offset.x"),B=t.s("edge.source.offset.y"),d=t.s("edge.target.offset.x"),u=t.s("edge.target.offset.y"),V=t.s("edge.source.anchor.x"),s=t.s("edge.source.anchor.y"),k=t.s("edge.target.anchor.x"),e=t.s("edge.target.anchor.y");if(U?(n=L.getEdgeAgentPosition(T,G,p,z,B,V,s),M=L.getEdgeAgentPosition(T,Q,g,d,u,k,e)):(n=L.getEdgeAgentPosition(T,G,p,0,0,V,s),M=L.getEdgeAgentPosition(T,Q,g,0,0,k,e)),"points"===t.s("edge.type")&&i&&!t.s("edge.center")&&n){var x=t.s("edge.points")||new N,I=x.size(),c=An(n,I?x.get(0):M,i,I),E=An(M,I?x.get(I-1):n,i,I);n=c,M=E}return[n,M]},gq=function(k,d,t){var c=k._78o,X=k._data,L=X.s("edge.type"),u=[c.sourcePoint,c.targetPoint];return"points"===L?t&&(u=lo(k)):u=c.center?L?t?lo(k):lo(k,!0):t?lo(k):[c.c1,c.c2]:t?lo(k):lo(k,!0),d=new N(d?d._as:D),d.add(u[0],0),d.add(u[1]),d},If=function(k){return k=new N(k._as),k.removeAt(0),k.removeAt(k.size()-1),k},sj=function(X){X._as||(X=new N(X));var f=new N;f.add(1);for(var $=1;$<X.size();$++)f.add(2);return f},hm=function(I,L){return{x:(I.x+L.x)/2,y:(I.y+L.y)/2}},Pe=function(C,R){return{x:C.x+1*(R.x-C.x)/4,y:C.y+1*(R.y-C.y)/4}},Oe=function(p,l){return{x:p.x+3*(l.x-p.x)/4,y:p.y+3*(l.y-p.y)/4}},un=function(z,a,y,t){var Q=a.x+a.width/2,U=a.y+a.height/2,S=w(Q*Q+U*U),Y=m(U,Q)+y;return{x:t.x+S*k(Y),y:t.y+S*C(Y)}},Kg=P.validateImpl,yp=P.isRectEditable,je=P.isPointEditable,jd=P._42,Eh=y._79o,wk=Z._79o,hp=y._48O,Ak=y._47O,mm=J._48O,Lq=J._80o,Kh=y._80o,Wk=J.getSelectWidth,Pr=J._47O,Hj=Z._47O,wq=P.isEditable,Yp=["northwest","north","northeast","east","southeast","south","southwest","west"],kn=function(R,W,C,q,p,Q,$,u,r,i){var V=R.x,g=R.y,B=R.width,z=R.height,E={x:V+B/2,y:g+z/2};q=q||0,W=zc(E,W.x-E.x,W.y-E.y,-q),$&&!u&&(W.x+=r,W.y+=i);var l=.01;if("northwest"===C?(W.x+p>V+B-l&&(W.x=V+B-p-l),W.y+p>g+z-l&&(W.y=g+z-p-l),R=Y(W,{x:V+B,y:g+z})):"north"===C?(W.y+p>g+z-l&&(W.y=g+z-p-l),R=Y({x:V,y:W.y},{x:V+B,y:g+z})):"northeast"===C?(W.x<V+p+l&&(W.x=V+p+l),W.y+p>g+z-l&&(W.y=g+z-p-l),R=Y({x:V,y:W.y},{x:W.x,y:g+z})):"west"===C?(W.x+p>V+B-l&&(W.x=V+B-p-l),R=Y({x:W.x,y:g},{x:V+B,y:g+z})):"east"===C?(W.x<V+p+l&&(W.x=V+p+l),R=Y({x:V,y:g},{x:W.x,y:g+z})):"southwest"===C?(W.x+p>V+B-l&&(W.x=V+B-p-l),W.y<g+p+l&&(W.y=g+p+l),R=Y({x:W.x,y:g},{x:V+B,y:W.y})):"south"===C?(W.y<g+p+l&&(W.y=g+p+l),R=Y({x:V,y:g},{x:V+B,y:W.y})):"southeast"===C&&(W.x<V+p+l&&(W.x=V+p+l),W.y<g+p+l&&(W.y=g+p+l),R=Y({x:V,y:g},W)),"keepRatio"===Q&&(!$&&u||$&&!u)&&("northeast"===C||"southeast"===C||"northwest"===C||"southwest"===C)){var A=R.width,v=R.height,o=A/B,F=v/z,e=f(o,F);R.width=B*e,R.height=z*e,"northeast"===C?R.y=g+(z-R.height):"northwest"===C?(R.y=g+(z-R.height),R.x=V+(B-R.width)):"southwest"===C&&(R.x=V+(B-R.width))}R.x-=E.x,R.y-=E.y;var j=un(D,R,q,E);return R.x=j.x-R.width/2,R.y=j.y-R.height/2,R},oe=function(X,e,a,E){var M=X.getRotation(),s=e,L=s.x,y=s.y,x=s.width,k=s.height,j={x:L+s.width/2,y:y+s.height/2};E=zc(j,E.x-j.x,E.y-j.y,-M),"northwest"===a?s=Y(E,{x:L+x,y:y+k}):"north"===a?s=Y({x:L,y:E.y},{x:L+x,y:y+k}):"northeast"===a?s=Y({x:L,y:E.y},{x:E.x,y:y+k}):"west"===a?s=Y({x:E.x,y:y},{x:L+x,y:y+k}):"east"===a?s=Y({x:L,y:y},{x:E.x,y:y+k}):"southwest"===a?s=Y({x:E.x,y:y},{x:L+x,y:E.y}):"south"===a?s=Y({x:L,y:y},{x:L+x,y:E.y}):"southeast"===a&&(s=Y({x:L,y:y},E)),X.setRect(s),s.x-=j.x,s.y-=j.y;var z=un(X,s,M,j);X.p(z.x,z.y)},oc=function(_,Z,j,K,Y,X,b,x){var u=D;X?(u=zc(D,Y.x-Z.x,Y.y-Z.y,-j),u.x-=b.x,u.y-=b.y):u=zc(D,Y.x-Z.x,Y.y-Z.y,0);var V={x:Z.x+u.x,y:Z.y+u.y};x&&(V=x(V.x,V.y)),V.e=_.getPoints().get(K).e,_.setPoint(K,V);var C=_.getWidth(),A=_.getHeight(),L=_.p().x-C/2,f=_.p().y-A/2;L-=Z.x,f-=Z.y;var E=un(_,{x:L,y:f,width:C,height:A},j,Z);_.p(E.x,E.y)},Il=function(A,Z,B){var W,O;if(A instanceof g?(W=A.getPoints(),O=A.getSegments()):A instanceof $&&"points"===A.s("edge.type")&&(W=A.s("edge.points"),O=A.s("edge.segments"),W=gq(Z,W)),O&&O.size()||(O=sj(W)),A instanceof g&&A.isClosePath()&&O.indexOf(5)<0&&(O=new N(O._as),O.add(5)),O)for(var n=-1,S=0;S<O.size();S++){if(S===B)return n;var b=O.get(S);1===b?n+=1:2===b?n+=1:3===b?n+=2:4===b&&(n+=3)}},Gp=function(O,R,w){var B,d;if(O instanceof g?(B=O.getPoints(),d=O.getSegments()):O instanceof $&&"points"===O.s("edge.type")&&(B=O.s("edge.points"),d=O.s("edge.segments"),B=gq(R,B)),d&&d.size()||(d=sj(B)),d)for(var _=-1,V=0;V<d.size();V++){var j=d.get(V);if(1===j?_+=1:2===j?_+=1:3===j?_+=2:4===j&&(_+=3),_===w)return V}},tb=function(w,m){var k=[w[0]-m[0],w[1]-m[1],w[2]-m[2]];return k},Im=function(){var K=new v(16);return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K},bo=function(x,y){var n=x[0],w=x[1],P=x[2];return x[0]=y[0]*n+y[4]*w+y[8]*P+y[12],x[1]=y[1]*n+y[5]*w+y[9]*P+y[13],x[2]=y[2]*n+y[6]*w+y[10]*P+y[14],x},Rg=function(F,T){if(T){var A=C(T),q=k(T),M=F[0],W=F[1],t=F[2],c=F[3],b=F[8],l=F[9],j=F[10],U=F[11];F[0]=M*q-b*A,F[1]=W*q-l*A,F[2]=t*q-j*A,F[3]=c*q-U*A,F[8]=M*A+b*q,F[9]=W*A+l*q,F[10]=t*A+j*q,F[11]=c*A+U*q}},rl=function(W,F){for(var Y=W.s("grid.row.count"),H=W.s("grid.column.count"),I=0;Y>I;I++)for(var t=0;H>t;t++){var T=W.getCellRect(I,t);if(R(T,F))return{rowIndex:I,columnIndex:t,rect:T,grid:W}}return null},Hc=function(O,B,A,p,k,o){var i={},J=A-O,W=p-B,a=u.sqrt(J*J+W*W),n=J/a,D=W/a,V=(-O+k)*n+(-B+o)*D;return 0>=V?(i.x=O,i.y=B):V>=a?(i.x=A,i.y=p):(i.x=O+V*n,i.y=B+V*D),J=k-i.x,W=o-i.y,i.z=u.sqrt(J*J+W*W),i},Ij=function(f,g){var L,d,A,h,B,l,n,r,Y=f.getPoints(),_=f.getSegments(),b=f.p(),$=f.getRotation();if(!_||!(_.indexOf(3)>0||_.indexOf(4)>0)){for(r=0;r<=Y.size()-1;r++)if(r===Y.size()-1?(B=Y.get(0),h=Y.get(r)):(h=Y.get(r),B=Y.get(r+1)),h=zc(b,h.x-b.x,h.y-b.y,$),B=zc(b,B.x-b.x,B.y-b.y,$),l=Hc(h.x,h.y,B.x,B.y,g.x,g.y),n=l.z,n<(f.s("shape.border.width")||10)){d=h,A=B,L=r;break}if(L!=D){var y=Hc(d.x,d.y,A.x,A.y,g.x,g.y),u=E(d,y);return{attachIndex:L,attachOffset:u}}}},Ii=function(v){for(var x=v._data,K=x.p(),s=x.getRotation(),T=x.getPoints(),w=D,O=[],i=0;i<T.size();i++)w=T.get(i),O.push(zc(K,w.x-K.x,w.y-K.y,s));v._55O.$15l=O};F.setImage("xeditinteractor_parentIcon",j),F.setImage("xeditinteractor_hostIcon",W),F.setImage("xeditinteractor_edgeIcon",s),F.setImage("xeditinteractor_removeIcon",Kk),F.setImage("xeditinteractor_sourceIcon",Bq),F.setImage("xeditinteractor_targetIcon",Mp),F.setImage("xeditinteractor_elevationIcon",eq),F.setImage("xeditinteractor_tallIcon",jf),P._editPointSize=H?24:9,P._edgeHelpers=["parent","remove","source","target"],P._leftTopHelpers=["parent"],P._rightTopHelpers=["host"],P._leftBottomHelpers=["edge"],P._rightBottomHelpers=["remove"],Yp=Yp.concat(Yp).concat(Yp),Z._79o=function(){var Z=this,y=Z.gv,d=y.getZoom(),s=y._editInteractor,B=wk.call(Z);if(!B)return null;var G=lo(Z,!0),o=G[0],A=G[1],$={x:B.x,y:B.y,width:B.width,height:B.height},a=Y(o,A);if(s instanceof U.XEditInteractor){$=V($,a);var u=Z._55O,S=y.getEditPointSize()/d+2,h=0;u&&u._43O&&(h+=S/2,T($,h))}return $},Z._47O=function(a){var I=this,g=I.gv,p=g._editInteractor;p instanceof U.XEditInteractor||Hj.call(I,a)},Z.rectIntersects=function(t){var u=this,g=u._data,Q=u.gv,s=Q.getZoom(),v=u._55O,F=Q._editInteractor;if(F instanceof U.XEditInteractor&&Q.isEditable(g)&&v&&v._43O&&"points"===g.s("edge.type")){var f=g.s("edge.points"),j=g.s("edge.segments");f=gq(u,f),j&&j.size()||(j=sj(f)),f=f._as;var y=!1,m=H?5:1,a=t.x+m,z=t.y+m,L={x:a,y:z};if(F._edge===g&&F._hoverSegmentIndex>=0){var K=Q._editInteractor._hoverSegmentIndex,w=j.get(K),d=Il(g,u,K),h=D;if(d!=D&&d>=0){var k=f[d],o=Q.getSegmentHoverWidth()/s;if(2===w||1===w){var i=f[d+1];h=Yg(new Lj(k.x,k.y),new Lj(i.x,i.y),new Lj(L.x-o,L.y-o),new Lj(L.x+2*o,L.y+2*o)),h.$62l===X&&(y=!0)}else if(3===w){var B=f[d+1],i=f[d+2];h=Id(new Lj(k.x,k.y),new Lj(B.x,B.y),new Lj(i.x,i.y),new Lj(L.x-o,L.y-o),new Lj(L.x+2*o,L.y+2*o)),h.$62l===X&&(y=!0)}else if(4===w){var x=f[d+1],Y=f[d+2];i=f[d+3],h=ar(new Lj(k.x,k.y),new Lj(x.x,x.y),new Lj(Y.x,Y.y),new Lj(i.x,i.y),new Lj(L.x-o,L.y-o),new Lj(L.x+2*o,L.y+2*o)),h.$62l===X&&(y=!0)}}}if(y)return!0}return D},y._47O=function(L){var B=this,I=B.gv,Q=I._editInteractor;Q instanceof U.XEditInteractor||Ak.call(B,L)},y.rectIntersects=function(A){var q=this,s=q._data,F=q.gv,C=F.getZoom(),p=q._55O,Q=F._editInteractor;if(Q instanceof U.XEditInteractor&&F.isEditable(s)&&p&&p._43O){var m=p.$15l,V=!1,M=H?5:1,b=A.x+M,h=A.y+M,O={x:b,y:h};if(m&&m.length===s.getPoints().size()||(Ii(q),m=p.$15l),Q._shape===s&&Q._hoverSegmentIndex>=0){var j=s.getSegments();j&&j.size()||(j=sj(m));var u=F._editInteractor._hoverSegmentIndex,S=j.get(u),k=Il(s,q,u),K=D;if(k!=D&&k>=0){var $=m[k],_=F.getSegmentHoverWidth()/C;if(2===S||1===S){var w=m[k+1];K=Yg(new Lj($.x,$.y),new Lj(w.x,w.y),new Lj(O.x-_,O.y-_),new Lj(O.x+2*_,O.y+2*_)),K.$62l===X&&(V=!0)}else if(3===S){var z=m[k+1],w=m[k+2];K=Id(new Lj($.x,$.y),new Lj(z.x,z.y),new Lj(w.x,w.y),new Lj(O.x-_,O.y-_),new Lj(O.x+2*_,O.y+2*_)),K.$62l===X&&(V=!0)}else if(4===S){var y=m[k+1],g=m[k+2];w=m[k+3],K=ar(new Lj($.x,$.y),new Lj(y.x,y.y),new Lj(g.x,g.y),new Lj(w.x,w.y),new Lj(O.x-_,O.y-_),new Lj(O.x+2*_,O.y+2*_)),K.$62l===X&&(V=!0)}}}if(V)return!0}return D},y._48O=function(){var j=this,f=j.gv,A=f._editInteractor;A instanceof U.XEditInteractor?(J._48O.call(j),j._55O._43O&&Ii(j)):hp.call(j)},y._79o=function(){var p=this,a=p.gv,l=a.getZoom(),g=a._editInteractor,q=Eh.call(p);if(q){var s={x:q.x,y:q.y,width:q.width,height:q.height};if(g instanceof U.XEditInteractor){var v=p._55O,C=a.getEditPointSize()/l+2,y=0;v&&v._43O&&(y+=C/2,T(s,y))}return s}},J._47O=function(B){var p=this,I=p.gv,y=I._editInteractor;if(y instanceof U.XEditInteractor);else{var o=p._55O;o&&o._98o&&Pr.call(p,B)}},J.getSelectWidth=function(){var M=this,I=M.gv,G=I._editInteractor,_=M._data;return I.isEditable(_)&&G instanceof U.XEditInteractor?0:Wk.call(M)},J._80o=function(J){var y=this,o=y.gv._editInteractor;if(Lq.call(y,J),o&&o._debug){J.save(),J.beginPath(),J.lineWidth=1,J.strokeStyle="green";var T=y._79o();T&&(J.rect(T.x,T.y,T.width,T.height),J.stroke()),J.restore()}},y._80o=function(n){var m=this,p=m.gv._editInteractor;if(Kh.call(m,n),p&&p._debug){n.save(),n.beginPath(),n.lineWidth=1,n.strokeStyle="green";var N=m._79o();n.rect(N.x,N.y,N.width,N.height),n.stroke(),n.restore()}},J._48O=function(){var g=this,n=g.gv,T=g._data,V=n._editInteractor,$=g._55O,E=T.p(),Z=T.getRotation();if(V instanceof U.XEditInteractor){if($._42O){var P=th(E,T.getWidth(),T.getHeight(),Z),t=P[0],z=P[1],I=P[2],r=P[3],o=P[4],J=P[5],Q=P[6],D=P[7];$.$45l=[t,o,z,J,r,Q,I,D]}}else mm.call(g)},P.getResizeMode=function(){return this.$25l||"normal"},P.setResizeMode=function(X){var s=this.$25l;this.$25l=X,this.fp("resizeMode",s,X)},P.getSnapAngle=function(){return this.$26l||Math.PI/36},P.setSnapAngle=function(p){var I=this.$26l;this.$26l=p,this.fp("snapAngle",I,p)},P.getSnapSpacing=function(){return this.$27l},P.setSnapSpacing=function(n){var I=this.$27l;this.$27l=n,this.fp("snapSpacing",I,n)},P.getPointSnapSpacing=function(){return this._pointSnapSpacing},P.setPointSnapSpacing=function(K){var S=this._pointSnapSpacing;this._pointSnapSpacing=K,this.fp("pointSnapSpacing",S,K)},P.setHelperEditableFunc=function(U){var p=this._helperEditableFunc;this._helperEditableFunc=U,this.fp("helperEditableFunc",p,U)},P.getHelperEditableFunc=function(){return this._helperEditableFunc},P.setLeftTopHelpers=function(f){var V=this._leftTopHelpers;this._leftTopHelpers=f,this.fp("leftTopHelpers",V,f)},P.getLeftTopHelpers=function(){return this._leftTopHelpers},P.setLeftTopHelpersAlign=function(e){var f=this._leftTopHelpersAlign;this._leftTopHelpersAlign=e,this.fp("leftTopHelpersAlign",f,e)},P.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},P.setRightTopHelpers=function(H){var P=this._rightTopHelpers;this._rightTopHelpers=H,this.fp("rightTopHelpers",P,H)},P.getRightTopHelpers=function(){return this._rightTopHelpers},P.setRightTopHelpersAlign=function(o){var u=this._rightTopHelpersAlign;this._rightTopHelpersAlign=o,this.fp("rightTopHelpersAlign",u,o)},P.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},P.setLeftBottomHelpers=function(J){var W=this._leftBottomHelpers;this._leftBottomHelpers=J,this.fp("leftBottomHelpers",W,J)},P.getLeftBottomHelpers=function(){return this._leftBottomHelpers},P.setLeftBottomHelpersAlign=function(z){var N=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=z,this.fp("leftBottomHelpersAlign",N,z)},P.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},P.setRightBottomHelpers=function(k){var r=this._rightBottomHelpers;this._rightBottomHelpers=k,this.fp("rightBottomHelpers",r,k)},P.getRightBottomHelpers=function(){return this._rightBottomHelpers},P.setRightBottomHelpersAlign=function(F){var k=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=F,this.fp("rightBottomHelpersAlign",k,F)},P.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},P.setEdgeHelpers=function(v){var T=this._edgeHelpers;this._edgeHelpers=v,this.fp("edgeHelpers",T,v)},P.getEdgeHelpers=function(){return this._edgeHelpers},P.isHelperEditable=function(K,x){return K instanceof $&&("host"===x||"edge"===x||"elevation"===x||"tall"===x)?!1:K instanceof Q&&("source"===x||"target"===x)?!1:"pointElevation"===x?this._helperEditableFunc?this._helperEditableFunc(K,x):!1:this._helperEditableFunc?this._helperEditableFunc(K,x):!0},P.getEditHelperSize=function(){return this._editHelperSize||(H?28:16)},P.setEditHelperSize=function(b){var F=this._editHelperSize;this._editHelperSize=b,this.fp("editHelperSize",F,b)},P.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},P.setEditRectBorderColor=function(J){var p=this.$28l;this.$28l=J,this.fp("editRectBorderColor",p,J)},P.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},P.setNodeBorderColor=function(a){var x=this.$29l;this.$29l=a,this.fp("nodeBorderColor",x,a)},P.getEditRectBorderStyle=function(){return this.$30l||"dashed"},P.setEditRectBorderStyle=function(F){var j=this.$30l;this.$30l=F,this.fp("editRectBorderStyle",j,F)},P.getControlPointBackground=function(){return this.$31l||"#ff0"},P.setControlPointBackground=function(u){var T=this.$31l;this.$31l=u,this.fp("controlPointBackground",T,u)},P.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},P.setControlPointBorderColor=function(y){var x=this.$32l;this.$32l=y,this.fp("controlPointBorderColor",x,y)},P.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},P.setJoinPointBackground=function(M){var H=this.$33l;this.$33l=M,this.fp("joinPointBackground",H,M)},P.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},P.setJoinPointBorderColor=function(X){var m=this.$34l;this.$34l=X,this.fp("joinPointBorderColor",m,X)},P.getDirectionLineColor=function(){return this.$35l||"#888"},P.setDirectionLineColor=function(x){var y=this.$35l;this.$35l=x,this.fp("directionLineColor",y,x)},P.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},P.setSegmentHoverColor=function(q){var E=this.$36l;this.$36l=q,this.fp("segmentHoverColor",E,q)},P.getSegmentHoverWidth=function(){return this.$22l||(H?16:8)},P.setSegmentHoverWidth=function(Z){var l=this.$22l;this.$22l=Z,this.fp("segmentHoverWidth",l,Z)},P.getSnapPointBorderColor=function(){return this.$38l||"#f00"},P.setSnapPointBorderColor=function(u){var R=this.$38l;this.$38l=u,this.fp("snapPointBorderColor",R,u)},P.getEditRectPadding=function(){return this.$39l!=D?this.$39l:6},P.setEditRectPadding=function($){var q=this.$39l;this.$39l=$,this.fp("editRectPading",q,$)},P.isRectEditable=function(y){var v=this,o=v._editInteractor;return o instanceof U.XEditInteractor?v._rectEditableFunc?v._rectEditableFunc(y):!0:yp.call(v,y)},P.isPointEditable=function(F){var u=this,j=u._editInteractor;return j instanceof U.XEditInteractor?u._pointEditableFunc?u._pointEditableFunc(F):!0:je.call(u,F)},P.validateImpl=function(){var M=this,i=M.$14l,X=M._editInteractor;if(i){var $=M.getWidth(),B=M.getHeight();($!==i.clientWidth||B!==i.clientHeight)&&(X&&(X._68I=1),L.setCanvas(i,$,B),M._32I=1)}Kg.call(this)},P.isEditable=function(x){var F=wq.call(this,x),s=this._editInteractor;if(s instanceof U.XEditInteractor&&x instanceof $){if(!x.s("2d.editable"))return!1;var L=this.getEditableFunc();F=L?L(x):!0}return F},P._42=function(r,V){var A=this,K=A._editInteractor;jd.call(A,r,V),K instanceof U.XEditInteractor&&K._68I&&K._42()},P.isSnapPoint=function(){return!0};var en=function(k){arguments.length>0&&this.$58l(k)},Ql=en.prototype;Ql.$58l=function(G){this.$62l=G,this.points=new Array},Ql.$56l=function(D){this.points.push(D)},Ql.$57l=function(B){this.points=this.points.concat(B)};var Lj=function(O,D){arguments.length>0&&this.$58l(O,D)},Fl=Lj.prototype;Fl.$58l=function(H,W){this.x=H,this.y=W},Fl.add=function(F){return new Lj(this.x+F.x,this.y+F.y)},Fl.addEquals=function(j){return this.x+=j.x,this.y+=j.y,this},Fl.$55l=function(T){return new Lj(this.x*T,this.y*T)},Fl.eq=function(W){return this.x==W.x&&this.y==W.y},Fl.lt=function(u){return this.x<u.x&&this.y<u.y},Fl.lte=function(n){return this.x<=n.x&&this.y<=n.y},Fl.gt=function(c){return this.x>c.x&&this.y>c.y},Fl.gte=function(v){return this.x>=v.x&&this.y>=v.y},Fl.lerp=function(I,f){return new Lj(this.x+(I.x-this.x)*f,this.y+(I.y-this.y)*f)},Fl.distanceFrom=function(O){var r=this.x-O.x,t=this.y-O.y;return w(r*r+t*t)},Fl.min=function(B){return new Lj(f(this.x,B.x),f(this.y,B.y))},Fl.max=function(R){return new Lj(t(this.x,R.x),t(this.y,R.y))},Fl.toString=function(){return this.x+","+this.y};var Fh=function(){this.$58l(arguments)},tm=Fh.prototype;Fh.TO=1e-6,Fh.AC=6,tm.$58l=function(o){this.co=new Array;for(var p=o.length-1;p>=0;p--)this.co.push(o[p])},tm.$55l=function(i){for(var u=new Fh,Y=0;Y<=this.$50l()+i.$50l();Y++)u.co.push(0);for(var Y=0;Y<=this.$50l();Y++)for(var X=0;X<=i.$50l();X++)u.co[Y+X]+=this.co[Y]*i.co[X];return u},tm.$59l=function(){for(var r=this.$50l();r>=0&&B(this.co[r])<=Fh.TO;r--)this.co.pop()},tm.$50l=function(){return this.co.length-1},tm.$51l=function(){var Y;switch(this.$59l(),this.$50l()){case 0:Y=new Array;break;case 1:Y=this.$52l();break;case 2:Y=this.$53l();break;case 3:Y=this.$54l();break;case 4:Y=this.$63l();break;default:Y=new Array}return Y},tm.$52l=function(){var e=new Array,B=this.co[1];return 0!=B&&e.push(-this.co[0]/B),e},tm.$53l=function(){var J=new Array;if(2==this.$50l()){var P=this.co[2],j=this.co[1]/P,M=this.co[0]/P,x=j*j-4*M;if(x>0){var o=w(x);J.push(.5*(-j+o)),J.push(.5*(-j-o))}else 0==x&&J.push(.5*-j)}return J},tm.$63l=function(){var O=new Array;if(4==this.$50l()){var W=this.co[4],t=this.co[3]/W,T=this.co[2]/W,$=this.co[1]/W,z=this.co[0]/W,G=new Fh(1,-T,t*$-4*z,-t*t*z+4*T*z-$*$).$54l(),o=G[0],j=t*t/4-T+o;if(B(j)<=Fh.TO&&(j=0),j>0){var v=w(j),m=3*t*t/4-v*v-2*T,l=(4*t*T-8*$-t*t*t)/(4*v),D=m+l,A=m-l;if(B(D)<=Fh.TO&&(D=0),B(A)<=Fh.TO&&(A=0),D>=0){var F=w(D);O.push(-t/4+(v+F)/2),O.push(-t/4+(v-F)/2)}if(A>=0){var F=w(A);O.push(-t/4+(F-v)/2),O.push(-t/4-(F+v)/2)}}else if(0>j);else{var l=o*o-4*z;if(l>=-Fh.TO){if(0>l&&(l=0),l=2*w(l),m=3*t*t/4-2*T,m+l>=Fh.TO){var h=w(m+l);O.push(-t/4+h/2),O.push(-t/4-h/2)}if(m-l>=Fh.TO){var h=w(m-l);O.push(-t/4+h/2),O.push(-t/4-h/2)}}}}return O},tm.$54l=function(){var e=new Array;if(3==this.$50l()){var r=this.co[3],H=this.co[2]/r,F=this.co[1]/r,z=this.co[0]/r,D=(3*F-H*H)/3,J=(2*H*H*H-9*F*H+27*z)/27,h=H/3,M=J*J/4+D*D*D/27,X=J/2;if(B(M)<=Fh.TO&&(M=0),M>0){var t,c,N=w(M);t=-X+N,c=t>=0?d(t,1/3):-d(-t,1/3),t=-X-N,t>=0?c+=d(t,1/3):c-=d(-t,1/3),e.push(c-h)}else if(0>M){var $=w(-D/3),K=m(w(-M),-X)/3,x=k(K),S=C(K),j=w(3);e.push(2*$*x-h),e.push(-$*(x+j*S)-h),e.push(-$*(x-j*S)-h)}else{var t;t=X>=0?-d(X,1/3):d(-X,1/3),e.push(2*t-h),e.push(-t-h)}}return e};var dm=function(I,f){arguments.length>0&&this.$58l(I,f)},He=dm.prototype;He.$58l=function(t,m){this.x=t,this.y=m},He.length=function(){return w(this.x*this.x+this.y*this.y)},He.$60l=function(Z){return this.x*Z.x+this.y*Z.y};var xg=function(m,O,F,R){var o,n=(R.x-F.x)*(m.y-F.y)-(R.y-F.y)*(m.x-F.x),B=(O.x-m.x)*(m.y-F.y)-(O.y-m.y)*(m.x-F.x),u=(R.y-F.y)*(O.x-m.x)-(R.x-F.x)*(O.y-m.y);if(0!=u){var U=n/u,b=B/u;U>=0&&1>=U&&b>=0&&1>=b?(o=new en(X),o.points.push(new Lj(m.x+U*(O.x-m.x),m.y+U*(O.y-m.y)))):o=new en(l)}else o=0==n||0==B?new en("C"):new en("P");return o},Fk=function(L,b,v,i,z){var U,c,M,w,n,R,u,T=i.min(z),S=i.max(z),A=new en(l);U=b.$55l(-2),M=L.add(U.add(v)),U=L.$55l(-2),c=b.$55l(2),w=U.add(c),n=new Lj(L.x,L.y),u=new dm(i.y-z.y,z.x-i.x),R=i.x*z.y-z.x*i.y;for(var O=new Fh(u.$60l(M),u.$60l(w),u.$60l(n)+R).$51l(),x=0;x<O.length;x++){var B=O[x];if(B>=0&&1>=B){var r=L.lerp(b,B),g=b.lerp(v,B),q=r.lerp(g,B);i.x==z.x?T.y<=q.y&&q.y<=S.y&&(A.$62l=X,A.$56l(q)):i.y==z.y?T.x<=q.x&&q.x<=S.x&&(A.$62l=X,A.$56l(q)):q.gte(T)&&q.lte(S)&&(A.$62l=X,A.$56l(q))}}return A},Id=function(H,g,_,Y,D){var W=Y.min(D),F=Y.max(D),k=new Lj(F.x,W.y),O=new Lj(W.x,F.y),y=Fk(H,g,_,W,k),C=Fk(H,g,_,k,F),R=Fk(H,g,_,F,O),m=Fk(H,g,_,O,W),e=new en(l);return e.$57l(y.points),e.$57l(C.points),e.$57l(R.points),e.$57l(m.points),e.points.length>0&&(e.$62l=X),e},Zk=function(x,W,z,q,C,S){var Y,o,d,J,v,s,u,n,L,r,e=C.min(S),P=C.max(S),y=new en(l);Y=x.$55l(-1),o=W.$55l(3),d=z.$55l(-3),J=Y.add(o.add(d.add(q))),v=new dm(J.x,J.y),Y=x.$55l(3),o=W.$55l(-6),d=z.$55l(3),J=Y.add(o.add(d)),s=new dm(J.x,J.y),Y=x.$55l(-3),o=W.$55l(3),d=Y.add(o),u=new dm(d.x,d.y),n=new dm(x.x,x.y),r=new dm(C.y-S.y,S.x-C.x),L=C.x*S.y-S.x*C.y;for(var E=new Fh(r.$60l(v),r.$60l(s),r.$60l(u),r.$60l(n)+L).$51l(),U=0;U<E.length;U++){var H=E[U];if(H>=0&&1>=H){var M=x.lerp(W,H),N=W.lerp(z,H),p=z.lerp(q,H),R=M.lerp(N,H),t=N.lerp(p,H),O=R.lerp(t,H);C.x==S.x?e.y<=O.y&&O.y<=P.y&&(y.$62l=X,y.$56l(O)):C.y==S.y?e.x<=O.x&&O.x<=P.x&&(y.$62l=X,y.$56l(O)):O.gte(e)&&O.lte(P)&&(y.$62l=X,y.$56l(O))}}return y},ar=function(i,q,E,n,Z,L){var c=Z.min(L),d=Z.max(L),I=new Lj(d.x,c.y),m=new Lj(c.x,d.y),v=Zk(i,q,E,n,c,I),$=Zk(i,q,E,n,I,d),B=Zk(i,q,E,n,d,m),N=Zk(i,q,E,n,m,c),C=new en(l);return C.$57l(v.points),C.$57l($.points),C.$57l(B.points),C.$57l(N.points),C.points.length>0&&(C.$62l=X),C},Yg=function(K,t,F,x){var N=F.min(x),v=F.max(x),O=new Lj(v.x,N.y),k=new Lj(N.x,v.y),T=xg(N,O,K,t),$=xg(O,v,K,t),w=xg(v,k,K,t),R=xg(k,N,K,t),r=new en(l);return r.$57l(T.points),r.$57l($.points),r.$57l(w.points),r.$57l(R.points),r.points.length>0&&(r.$62l=X),r},Ng=U.XEditInteractor=function(u){var G=this,B=G._view=document.createElement("canvas");B.className="editCanvas",B.style.position="absolute",Ng.superClass.constructor.call(G,u)};F.def(Ng,U.Interactor,{ms_edit:1,setUp:function(){var f=this,k=f.gv,m=k.getView(),Y=f._view;Ng.superClass.setUp.call(f),k.setEditInteractor(f),k.$14l=Y,k._79O?m.insertBefore(Y,k._79O):m.appendChild(Y);var e=f.$49l=f.$11l.bind(f);k.dm().md(e),k.sm().ms(e),k.mp(e)},tearDown:function(){var N=this,m=N.gv,O=m.getView(),o=N.$49l;Ng.superClass.tearDown.call(N),m.setEditInteractor(D),m.$14l=D,O.removeChild(N._view),m.dm().umd(o),m.sm().ums(o),m.ump(o)},clear:function(){var T=this,d=T.gv;delete T._hoverSegmentIndex,delete T._edge,delete T._shape,delete d._editing,delete T.$10l,delete T.$13l,delete T.$9l,delete T._removePointIndex,delete T._lp,T.$12l="",delete T.$40l,delete T.$67l,delete T.$72l,delete T.$73l,delete T.$75l,delete T.$1l,delete T.$3l,delete T.$2l,delete T.$92l,delete T.$93l,delete T.$94l,T.clearDragging()},handle_keydown:function(b){this.$48l!==b.shiftKey&&(this.$48l=b.shiftKey,this.handle_mousemove(b,a,!0))},handle_keyup:function(D){this.$48l!==D.shiftKey&&(this.$48l=D.shiftKey,this.handle_mousemove(D,a,!0))},handle_touchstart:function(D){this.handle_mousemove(D),this.handle_mousedown(D)},handle_mousedown:function(K){q(K);var j=this,H=j.$13l,v=j.gv,E=v.dm(),h=v.sm(),B=v.getZoom(),g=v.lp(K),i=F.isDoubleClick(K),x=F.isLeftButton(K),L=j.$7l,s=j._shape,R=j._hoverSegmentIndex,C=j._edge,_=j.$87l,X=j.$88l,y=function(){j._68I||_===j.$87l&&X===j.$88l||j.$43l()};if(7!==j.$67l&&(delete j.$87l,delete j.$88l),x&&(s||C)&&R>=0&&i&&(s&&h.contains(s)||C&&h.contains(C))){var n=Rm.call(j,s||C,R,g);return j.addShapePoint(s||C,R,n),G(function(){j.handle_mousemove(K)},40),void 0}if(x&&(s||C)&&j._removePointIndex>=0&&i)return j.removeShapePoint(),j.$5l=1,G(function(){j.handle_mousemove(K)},40),void 0;if(!x||!v._editing)return y(),void 0;if(s&&H>=0){var k=s.getPoints().get(H),c=s.p(),U=zc(c,k.x-c.x,k.y-c.y,-L+s.getRotation());u=zc(c,g.x-c.x,g.y-c.y,-L),j.$24l={x:u.x-U.x,y:u.y-U.y},j.startDragging(K),E.beginTransaction(),j.fi({kind:"beginEditPoint",event:K,data:s,index:H}),j.$88l=H,j.$87l=s}else if(j.$10l){var m=v.sm().getSelection(),Y=j.$6l,f=j.$1l={},W=j.$3l={},w=j.$16l[S[j.$10l]],N={x:Y.x,y:Y.y},J={x:Y.x+Y.width/2,y:Y.y+Y.height/2};j.$24l={x:g.x-w.x/B,y:g.y-w.y/B},j.$2l=e(j.$8l),j.$4l=e(Y),m.each(function(F){if(F instanceof Q){var x=F.p(),X=F.getWidth(),O=F.getHeight(),R=zc(J,x.x-J.x,x.y-J.y,-L);f[F.getId()]={x:x.x-X/2,y:x.y-O/2,width:X,height:O},W[F.getId()]={x:(R.x-N.x)/Y.width,y:(R.y-N.y)/Y.height}}}),j.startDragging(K),E.beginTransaction(),j.fi({kind:"beginEditRect",event:K,direction:j.$10l})}else if(C&&H>=0){var D=gq(v.getDataUI(C),C.s("edge.points")),k=D.get(H);j.$24l={x:g.x-k.x,y:g.y-k.y},j.startDragging(K),E.beginTransaction(),j.fi({kind:"beginEditPoint",event:K,data:C,index:H}),j.$88l=H,j.$87l=C}else if(j.$40l){var Y=j.$6l,J={x:Y.x+Y.width/2,y:Y.y+Y.height/2},z=e(j.$23l);z.x/=B,z.y/=B;var o=zc(J,z.x-J.x,z.y-J.y,-L),u=zc(J,g.x-J.x,g.y-J.y,-L);j.$24l={x:u.x-o.x,y:u.y-o.y},j.startDragging(K),E.beginTransaction(),j.fi({kind:"beginEditRotation",event:K,data:j._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(j.$67l)>=0){var T=j.$67l;(7===T||8===T||9===T)&&E.beginTransaction(),j.startDragging(K)}else if(j.$71l&&i&&j.$79l(j.$71l,g)){var p=h.toSelection();E.beginTransaction(),p.each(function(d){E.remove(d)}),E.endTransaction()}y()},$11l:function(){var R=this,U=R.gv;U._editing&&(R.$13l==D||R._shape==D&&R._edge==D)&&(R.$73l==D||1!==R.$67l&&5!==R.$67l&&6!==R.$67l)||(R.$5l=1),R._68I=1},$46l:function(U){var Q=this,q=Q.gv,T=q.lp(U),G=[];return fj(q,function(S){var A=q.getDataUI(S);if(A){var N=A._79o();R(N,T)&&G.push(S)}}),G},$47l:function(R){var c=this,q=c.$13l,P=c.gv.dm();c.$10l?(c.fi({kind:"endEditRect",event:R,direction:c.$10l}),P.endTransaction()):c._shape&&q>=0?(c.fi({kind:"endEditPoint",event:R,data:c._shape,index:q}),P.endTransaction()):c._edge&&q>=0?(c.fi({kind:"endEditPoint",event:R,data:c._edge,index:q}),P.endTransaction()):c.$23l&&c.$40l&&(c.fi({kind:"endEditRotation",event:R}),P.endTransaction())},handleWindowTouchEnd:function(Y){this.handleWindowMouseUp(Y)},handleWindowMouseUp:function(l){var s=this,A=s.gv,f=A.dm(),q=s._shape,i=s._edge,c=s.$13l,u=s.$40l,k=s.$9l,B=s.$10l,p=s.$67l;if((q||i)&&c>=0&&k>=0){var P,K;if(q){var C=q.p(),L=q.getRotation();P=q.getPoints(),K=P.get(k),oc(q,C,L,c,K,!1)}else if(P=gq(A.getDataUI(i),i.s("edge.points"),!0),K=P.get(k),0===c){var J=P.get(0);i.s("edge.source.offset.x",K.x-J.x),i.s("edge.source.offset.y",K.y-J.y)}else if(c===P.size()-1){var t=P.get(P.size()-1);i.s("edge.target.offset.x",K.x-t.x),i.s("edge.target.offset.y",K.y-t.y)}else"points"===i.s("edge.type")&&(P.set(c,K),i.s("edge.points",If(P)))}s.$47l(l);var w=s.$73l;1===p?(f.beginTransaction(),w?A.sm().each(function(v){if(v.setHost&&A.isHelperEditable(v,"host")){v.setHost(w);
var S=s.$75l,k=s.$74l;S&&(v.s("attach.row.index",S.rowIndex),v.s("attach.column.index",S.columnIndex)),k&&(v.s("attach.index",k.attachIndex),v.s("attach.offset",k.attachOffset),v.s("attach.offset.relative",!1),v.s("attach.offset.opposite",!1))}}):A.sm().each(function(_){_.setHost&&A.isHelperEditable(_,"host")&&(_.setHost(D),_.s("attach.row.index",a),_.s("attach.column.index",a),_.s("attach.index",a),_.s("attach.offset",a),_.s("attach.offset.relative",!1),_.s("attach.offset.opposite",!1))}),f.endTransaction()):2===p?(f.beginTransaction(),w?A.sm().each(function(C){C.setParent&&A.isHelperEditable(C,"parent")&&C.setParent(w)}):A.sm().each(function(H){H.setParent&&A.isHelperEditable(H,"parent")&&H.setParent(D)}),f.endTransaction()):3===p?w&&(f.beginTransaction(),A.sm().each(function(H){if(A.isHelperEditable(H,"edge")&&H instanceof Q&&w instanceof Q){var k=new I.Edge;f.add(k),k.setSource(H),k.setTarget(w),s.onEdgeCreated&&s.onEdgeCreated(l,k)}}),f.endTransaction()):5===p||6===p?w&&(f.beginTransaction(),A.sm().each(function(B){B instanceof $&&w instanceof Q&&(5===p&&A.isHelperEditable(B,"source")?B.setSource(w):6===p&&A.isHelperEditable(B,"source")&&B.setTarget(w))}),f.endTransaction()):(7===p||8===p||9===p)&&f.endTransaction(),(B||u)&&s.$43l(!0),H?(s.clear(),delete s.$64l,s._68I||s.$43l()):(s.handle_mousemove(l,!0),p&&!s._68I&&s.$43l())},handleWindowTouchMove:function(B){this.handleWindowMouseMove(B)},handleWindowMouseMove:function(O){this._78I(O)},handle_mousemove:function(d,U,g){if(!this._pause){if(!g){var k=H?Ed(d):d;this.$61l={clientX:k.clientX,clientY:k.clientY}}if(U===!0||!o()){var s=this,r=s.gv,L=!1,G=D;s.clear(),r.sm().size()>0&&(G=r.lp(g?s.$61l:d),L=s._79I(d,G)),L&&(r._editing=1),s.$12l!==s.$65l&&(s.$65l=s.$12l,s.setCursor(s.$12l)),s.$40l!==s.$64l&&(s.$64l=s.$40l,s._68I||s.$43l()),s._hoverSegmentIndex!==s.$66l&&(s.$66l=s._hoverSegmentIndex,s._68I||s.$43l())}}},_78I:function(z){this.autoScroll(z);var I=this,q=I.gv,a=q.lp(z),C=q.getZoom(),y=I.$13l;if((I._shape||I._edge)&&y>=0){var p,o,n,V=I._shape,s=I._edge,r=I.$24l,K=q.getPointSnapSpacing(),X=function(Z,F){return K==D||isNaN(K)?{x:Z,y:F}:{x:i(Z/K)*K,y:i(F/K)*K}};if(V){p=V.getPoints();var T=V.p(),Z=V.getRotation(),v=0;o=zc(T,a.x-T.x,a.y-T.y,-Z),oc(V,T,Z,y,a,!0,r,X),I.fi({kind:"betweenEditPoint",event:z,data:V,index:y})}else if(s){p=gq(q.getDataUI(s),s.s("edge.points"),!0),a.x-=r.x,a.y-=r.y,o=a;var j,R,l=s.s("edge.offset"),c=p.size(),U=c>2;if(0===y){var N=p.get(0);l&&(N=An(N,p.get(1),-l,U),a=An(a,p.get(1),-l,U)),j=a.x-N.x,R=a.y-N.y,n=X(j,R),s.s("edge.source.offset.x",n.x),s.s("edge.source.offset.y",n.y)}else if(y===c-1){var S=p.get(c-1);l&&(S=An(S,p.get(c-2),-l,U),a=An(a,p.get(c-2),-l,U)),j=a.x-S.x,R=a.y-S.y,n=X(j,R),s.s("edge.target.offset.x",n.x),s.s("edge.target.offset.y",n.y)}else"points"===s.s("edge.type")&&(n=X(a.x,a.y),n.e=p.get(y).e,p.set(y,n),s.s("edge.points",If(p)));I.fi({kind:"betweenEditPoint",event:z,data:s,index:y})}if(delete I.$9l,q.isSnapPoint(V)||q.isSnapPoint(s))for(v=0;v<p.size();v++)if(v!==y){var d=p.get(v);if(E(d,o)<q.getEditPointSize()/C){I.$9l=v;break}}}else if(I.$10l){var r=I.$24l;a.x-=r.x,a.y-=r.y;var H=q.sm().getSelection(),k=I.$1l,L=I.$7l,O=I.$10l,P=I.$4l,_=I.$2l,f=q.getEditRectPadding()/C,u=2*f,W=q.getSnapSpacing(),e=W!=D&&!isNaN(W),A=kn(_,a,O,L,2*f,q.getResizeMode(),e,!0),J=I.$6l;if(e){var t=A.width-u,Y=A.height-u,b=i(t/W)*W,hb=i(Y/W)*W,Un=b-t,rj=hb-Y;("west"===O||"northwest"===O||"southwest"===O)&&(Un=-Un),("north"===O||"northwest"===O||"northeast"===O)&&(rj=-rj),A=kn(_,a,O,L,2*f,q.getResizeMode(),e,!1,Un,rj)}I.$8l=A,J.x=A.x+f,J.y=A.y+f,J.width=A.width-u,J.height=A.height-u;var me=A.x+A.width/2,Rq=A.y+A.height/2,Lh=J.x,ej=J.y,Sb=J.width/P.width,ae=J.height/P.height;H.each(function(H){if(H instanceof Q&&q.isEditable(H)&&q.isRectEditable(H)){var N=k[H.getId()],a=I.$3l[H.getId()],$={x:N.x+N.width/2,y:N.y+N.height/2},S=0,b=0,d=O,e=180*B(L-H.getRotation())/x;"northeast"===O?e>=315||45>e?(S=N.width*Sb+N.x,b=N.height*(1-ae)+N.y,d="northeast"):e>=45&&135>e?(S=N.width*(1-ae)+N.x,b=N.height*(1-Sb)+N.y,d="northwest"):e>=135&&225>e?(S=N.width*(1-Sb)+N.x,b=N.height*ae+N.y,d="southwest"):(S=N.width*ae+N.x,b=N.height*Sb+N.y,d="southeast"):"north"===O?e>=315||45>e?(b=N.height*(1-ae)+N.y,d="north"):e>=45&&135>e?(S=N.width*(1-ae)+N.x,d="west"):e>=135&&225>e?(b=N.height*ae+N.y,d="south"):(S=N.width*ae+N.x,d="east"):"northwest"===O?e>=315||45>e?(S=N.width*(1-Sb)+N.x,b=N.height*(1-ae)+N.y,d="northwest"):e>=45&&135>e?(S=N.width*(1-ae)+N.x,b=N.height*Sb+N.y,d="southwest"):e>=135&&225>e?(S=N.width*Sb+N.x,b=N.height*ae+N.y,d="southeast"):(S=N.width*ae+N.x,b=N.height*(1-Sb)+N.y,d="northeast"):"west"===O?e>=315||45>e?(S=N.width*(1-Sb)+N.x,d="west"):e>=45&&135>e?(b=N.height*Sb+N.y,d="south"):e>=135&&225>e?(S=N.width*Sb+N.x,d="east"):(b=N.height*(1-Sb)+N.y,d="north"):"southwest"===O?e>=315||45>e?(S=N.width*(1-Sb)+N.x,b=N.height*ae+N.y,d="southwest"):e>=45&&135>e?(S=N.width*ae+N.x,b=N.height*Sb+N.y,d="southeast"):e>=135&&225>e?(S=N.width*Sb+N.x,b=N.height*(1-ae)+N.y,d="northeast"):(S=N.width*(1-ae)+N.x,b=N.height*(1-Sb)+N.y,d="northwest"):"east"===O?e>=315||45>e?(S=N.width*Sb+N.x,d="east"):e>=45&&135>e?(b=N.height*(1-Sb)+N.y,d="north"):e>=135&&225>e?(S=N.width*(1-Sb)+N.x,d="west"):(b=N.height*Sb+N.y,d="south"):"south"===O?e>=315||45>e?(b=N.height*ae+N.y,d="south"):e>=45&&135>e?(S=N.width*ae+N.x,d="east"):e>=135&&225>e?(b=N.height*(1-ae)+N.y,d="north"):(S=N.width*(1-ae)+N.x,d="west"):"southeast"===O&&(e>=315||45>e?(S=N.width*Sb+N.x,b=N.height*ae+N.y,d="southeast"):e>=45&&135>e?(S=N.width*ae+N.x,b=N.height*(1-Sb)+N.y,d="northeast"):e>=135&&225>e?(S=N.width*(1-Sb)+N.x,b=N.height*(1-ae)+N.y,d="northwest"):(S=N.width*(1-ae)+N.x,b=N.height*Sb+N.y,d="southwest"));var V=zc($,S-$.x,b-$.y,H.getRotation());oe(H,N,d,{x:V.x,y:V.y});var n=Lh+J.width*a.x,s=ej+J.height*a.y,r={x:n,y:s};r=zc({x:me,y:Rq},r.x-me,r.y-Rq,L),H.p(r.x,r.y)}}),I.fi({kind:"betweenEditRect",event:z,direction:O})}else if(I.$23l&&I.$40l){var Tf=I.$8l,Qj=Tf.width,Od=Tf.height,T={x:Tf.x+Qj/2,y:Tf.y+Od/2},r=I.$24l,jb=I.$23l,mj=jb.x/C-T.x,Rf=jb.y/C-T.y,Uf=w(mj*mj+Rf*Rf),Xp=Math.asin(r.x/Uf),Jn=q.sm().getSelection(),Xg=h+m(a.y-T.y,a.x-T.x)-Xp,wk=q.getSnapAngle(),Xg=i(Xg/wk)*wk;0>Xg&&(Xg+=M);var Dj=Xg-I.$7l,Cc=[T.x,0,T.y];Jn.each(function(L){if(q.isEditable(L)&&q.isRotationEditable(L)&&q.isVisible(L)){var D=tb(L.p3(),Cc),u=Im();Rg(u,-Dj),L.setRotation(L.getRotation()+Dj),bo(D,u),L.p3(Cc[0]+D[0],Cc[1]+D[1],Cc[2]+D[2])}}),I.$7l=Xg,I.fi({kind:"betweenEditRotation",event:z})}else if([1,2,3,5,6].indexOf(I.$67l)>=0)I.$72l=z,I.$78l||(I.$78l=1,G(function(){F.isDragging()&&I.$43l(),delete I.$78l},12));else if(7===I.$67l){if(I.$87l instanceof g){var V=I.$87l,dn=I.$88l,Li=F.clone(V.getPoints().get(dn)),Jr=a.y-Li.y;Li.e||(Li.e=0),I.$92l||(I.$92l=Li.e),Li.e=I.$92l-Jr,V.setPoint(dn,Li)}else if(I.$87l instanceof $){var s=I.$87l,dn=I.$88l,p=gq(q.getDataUI(s),s.s("edge.points")),Li=p.get(dn),Jr=a.y-Li.y;Li.e||(Li.e=0),I.$92l||(I.$92l=Li.e),Li.e=I.$92l-Jr,p.set(dn,Li),s.s("edge.points",If(p))}}else if(8===I.$67l){var Jn=q.sm().getSelection(),Bc=I.$93l;Bc||(Bc=I.$93l={}),Jn.each(function(z){if(z.p3){var P=z.p3(),R=Bc[z.getId()];R==D&&(R=Bc[z.getId()]=P[1]),z.p3([P[0],R-(a.y-I.$90l.y/C),P[2]])}})}else if(9===I.$67l){var Jn=q.sm().getSelection(),Rd=I.$94l;Rd||(Rd=I.$94l={}),Jn.each(function(H){if(H.s3){var O=H.s3(),o=Rd[H.getId()];o==D&&(o=Rd[H.getId()]=O[1]);var m=o-(a.y-I.$91l.y/C);0>m&&(m=.01),H.s3([O[0],m,O[2]])}})}},$79l:function(E,t){var x=this,G=x.gv,Z=G.getZoom(),I=G.getEditHelperSize(),W=E.x/Z,S=E.y/Z,B=I/Z,f=B/2;return R({x:W-f,y:S-f,width:B,height:B},t)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(o,s){for(var p=this,u=p.gv,M=u.getZoom(),l=u.getEditPointSize(),T=l/M,h=T/2,E=p.$46l(o),m=0;m<E.length;m++){var z,X,b=E[m],I=u.getDataUI(b);if(I&&I._55O){var y=I._55O;if(y._43O&&b instanceof $){if(z=b.s("edge.points"),z=gq(I,z),X=b.s("edge.segments"),X&&X.size()||(X=sj(z)),p.$42l(b,s,z._as,X,"edge"))return!0;if("points"===b.s("edge.type")&&p.$41l(b,s,z._as,X,"edge"))return}if(y._43O&&b instanceof g&&y.$15l&&y.$15l.length===b.getPoints().size()){if(z=y.$15l,X=b.getSegments(),X&&X.size()||(X=sj(z)),p.$42l(b,s,z,X,"shape"))return!0;if(p.$41l(b,s,z,X,"shape"))return}}}if(p.$16l){var z,B=p.$16l,H=B[3].x-B[7].x,Y=B[3].y-B[7].y,f=w(H*H+Y*Y),Q=B[1].x-B[5].x,S=B[1].y-B[5].y,L=w(Q*Q+S*S),e={x:s.x*M,y:s.y*M};if(p._80I(e,0,B[0],"northwest",f,L)||p._80I(e,1,B[1],"north",f,L)||p._80I(e,2,B[2],"northeast",f,L)||p._80I(e,7,B[7],"west",f,L)||p._80I(e,3,B[3],"east",f,L)||p._80I(e,6,B[6],"southwest",f,L)||p._80I(e,5,B[5],"south",f,L)||p._80I(e,4,B[4],"southeast",f,L))return!0}if(p.$23l){var W=p.$23l,j=W.x/M,V=W.y/M;if(R({x:j-h,y:V-h,width:T,height:T},s))return p.$40l=1,p.$12l=p.getHelperCursor("rotation")||"crosshair",!0}return p.$68l&&p.$79l(p.$68l,s)?(p.$67l=1,p.$12l=p.getHelperCursor("host")||"crosshair",!0):p.$69l&&p.$79l(p.$69l,s)?(p.$67l=2,p.$12l=p.getHelperCursor("parent")||"crosshair",!0):p.$70l&&p.$79l(p.$70l,s)?(p.$67l=3,p.$12l=p.getHelperCursor("edge")||"crosshair",!0):p.$71l&&p.$79l(p.$71l,s)?(p.$67l=4,p.$12l=p.getHelperCursor("remove")||"crosshair",!0):p.$82l&&p.$79l(p.$82l,s)?(p.$67l=5,p.$12l=p.getHelperCursor("source")||"crosshair",!0):p.$83l&&p.$79l(p.$83l,s)?(p.$67l=6,p.$12l=p.getHelperCursor("target")||"crosshair",!0):p._pointElevationHelperPoint&&p.$79l(p._pointElevationHelperPoint,s)?(p.$67l=7,p.$12l=p.getHelperCursor("pointElevation")||"crosshair",!0):p.$90l&&p.$79l(p.$90l,s)?(p.$67l=8,p.$12l=p.getHelperCursor("elevation")||"crosshair",!0):p.$91l&&p.$79l(p.$91l,s)?(p.$67l=9,p.$12l=p.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(O,P,u,w,I,s){var r=this,l=r.gv,k=l.getEditPointSize(),X=k/2,t=l.sm(),h=l.isDirectionEditable;if(h&&1===t.size()){var L=t.ld();if(h=h.bind(l),L instanceof Q){if(!h(L,w))return!1;if("east"===w){if(h(L,"northeast")&&h(L,"southeast")&&2*k>=s)return!1}else if("west"===w){if(h(L,"northwest")&&h(L,"southwest")&&2*k>=s)return!1}else if("north"===w){if(h(L,"northwest")&&h(L,"northeast")&&2*k>=I)return!1}else if("south"===w&&h(L,"southwest")&&h(L,"southeast")&&2*k>=I)return!1}}else{if(2*k>=I&&("north"===w||"south"===w))return!1;if(2*k>=s&&("east"===w||"west"===w))return!1}if(R({x:u.x-X,y:u.y-X,width:k,height:k},O)){if(r.$10l!==w){var C=180*r.$7l/x,J="";C>=337.5||22.5>C?J="north":C>=22.5&&67.5>C?J="northeast":C>=67.5&&112.5>C?J="east":C>=112.5&&157.5>C?J="southeast":C>=157.5&&202.5>C?J="south":C>=202.5&&247.5>C?J="southwest":C>=247.5&&292.5>C?J="west":C>=292.5&&337.5>C&&(J="northwest");var _=Yp.indexOf(J),J=Yp[P-(1-_)+8];switch(J){case"northwest":r.$12l="nwse-resize";break;case"northeast":r.$12l="nesw-resize";break;case"southwest":r.$12l="nesw-resize";break;case"southeast":r.$12l="nwse-resize";break;case"north":r.$12l="ns-resize";break;case"east":r.$12l="ew-resize";break;case"south":r.$12l="ns-resize";break;case"west":r.$12l="ew-resize"}r.$10l=w}return!0}return!1},$42l:function(L,d,E,X,n){var F,j=this,P=j.gv,k=P.getEditPointSize(),I=k/P.getZoom(),V=-1,w={x:d.x,y:d.y,width:0,height:0},O=function(a){"shape"===n?j._shape=L:j._edge=L,j._removePointIndex=a},N=function(T){"shape"===n?j._shape=L:j._edge=L,j.$13l=T,j.$12l="crosshair"};for(T(w,I/2),V=E.length-1,F=X.size()-1;F>=0;F--){var t=X.get(F);if(1===t||2===t)V-=1;else if(3===t){var Q=E[V-1];if(R(w,Q))return N(V-1),!0;V-=2}else if(4===t){var g=E[V-1],W=E[V-2];if(R(w,g))return N(V-1),!0;if(R(w,W))return N(V-2),!0;V-=3}}for(V=E.length-1,F=X.size()-1;F>=0;F--){var t=X.get(F),h=E[V];if(R(w,h))return O(V),N(V),!0;1===t||2===t?V-=1:3===t?V-=2:4===t&&(V-=3)}return!1},$41l:function(S,H,B,x,c){var G=this,$=G.gv,M=-1,k=0,R={x:H.x,y:H.y,width:0,height:0},U=function(U,z){G._hoverSegmentIndex=z,G._lp=H,"shape"===c?G._shape=S:G._edge=S};for(T(R,$.getSegmentHoverWidth()/2/$.getZoom()),S instanceof g&&S.isClosePath()&&x.indexOf(5)<0&&(x=new N(x._as),x.add(5));k<x.size();k++){var W=x.get(k);if(1===W){var J=B[M],K=B[M+1];if(J){var Z=Yg(new Lj(J.x,J.y),new Lj(K.x,K.y),new Lj(R.x,R.y),new Lj(R.x+R.width,R.y+R.height));if(Z.$62l===X&&Z.points.length>0)return U(Z,k),!0}M+=1}else if(2===W){var J=B[M],K=B[M+1],Z=Yg(new Lj(J.x,J.y),new Lj(K.x,K.y),new Lj(R.x,R.y),new Lj(R.x+R.width,R.y+R.height));if(Z.$62l===X&&Z.points.length>0)return U(Z,k),!0;M+=1}else if(3===W){var J=B[M],C=B[M+1],Q=B[M+2],Z=Id(new Lj(J.x,J.y),new Lj(C.x,C.y),new Lj(Q.x,Q.y),new Lj(R.x,R.y),new Lj(R.x+R.width,R.y+R.height));if(Z.$62l===X)return U(Z,k),!0;M+=2}else if(4===W){var J=B[M],p=B[M+1],F=B[M+2],Q=B[M+3],Z=ar(new Lj(J.x,J.y),new Lj(p.x,p.y),new Lj(F.x,F.y),new Lj(Q.x,Q.y),new Lj(R.x,R.y),new Lj(R.x+R.width,R.y+R.height));if(Z.$62l===X)return U(Z,k),!0;M+=3}else if(5===W){var J=B[M],K=B[0];if(J){var Z=Yg(new Lj(J.x,J.y),new Lj(K.x,K.y),new Lj(R.x,R.y),new Lj(R.x+R.width,R.y+R.height));if(Z.$62l===X&&Z.points.length>0)return U(Z,k),!0}}}return!1},addShapePoint:function(z,p,b){var D=this,s=D.gv,l=s.dm();if(l.beginTransaction(),0===arguments.length&&(z=D._shape||D._edge,p=D._hoverSegmentIndex,b=D._lp),z instanceof g||z instanceof $){var I=Il(z,s.getDataUI(z),p);if(!isNaN(p)&&b&&!isNaN(I)){var n=b;if(z instanceof g){var f=z.p(),T=z.getRotation(),M=z.toSegments();M&&M.size()||(M=sj(z.getPoints())),z.isClosePath()&&M.indexOf(5)<0&&(M=new N(M._as),M.add(5));var O=M.get(p),d="addPoint",i="removePointAt";if(2===O||1===O){var j={x:n.x,y:n.y};M.add(O,p),j=zc(f,j.x-f.x,j.y-f.y,-T),z[d](j,I+1)}else if(3===O){var P=z.getPoints(),m=P.get(I),Y=P.get(I+2),j={x:n.x,y:n.y};j=zc(f,j.x-f.x,j.y-f.y,-T);var C=hm(m,j),K=hm(j,Y);M.removeAt(p),M.add(3,p),M.add(3,p),z.setPoint(I+1,j),z[d](K,I+2),z[d](C,I+1)}else if(4===O){var P=z.getPoints(),m=P.get(I),Y=P.get(I+3),j={x:n.x,y:n.y};j=zc(f,j.x-f.x,j.y-f.y,-T);var C=Pe(m,j),K=Oe(m,j),F=Pe(j,Y),u=Oe(j,Y);M.removeAt(p),M.add(4,p),M.add(4,p),z[i](I+1),z[i](I+1),z[d](j,I+1),z[d](u,I+2),z[d](F,I+2),z[d](K,I+1),z[d](C,I+1)}else if(5===O){var j={x:n.x,y:n.y};M.add(2,p),j=zc(f,j.x-f.x,j.y-f.y,-T),z[d](j,I+1)}z.isClosePath()&&M.remove(5),z.setSegments(M);var L=z.getWidth(),V=z.getHeight(),y=z.p().x-L/2,t=z.p().y-V/2;y-=f.x,t-=f.y;var S=un(z,{x:y,y:t,width:L,height:V},T,f);z.p(S.x,S.y)}else if(z instanceof $){if("points"!==z.s("edge.type"))return l.endTransaction(),void 0;var P=z.s("edge.points");M=z.s("edge.segments"),P=gq(s.getDataUI(z),P),M&&M.size()||(M=sj(P)),M=new N(M._as.slice(0)),P=new N(P._as.slice(0));var O=M.get(p);if(2===O||1===O){var j={x:n.x,y:n.y};M.add(O,p),P.add(j,I+1)}else if(3===O){var m=P.get(I),Y=P.get(I+2),j={x:n.x,y:n.y},C=hm(m,j),K=hm(j,Y);M.removeAt(p),M.add(3,p),M.add(3,p),P.set(I+1,j),P.add(K,I+2),P.add(C,I+1)}else if(4===O){var m=P.get(I),Y=P.get(I+3),j={x:n.x,y:n.y},C=Pe(m,j),K=Oe(m,j),F=Pe(j,Y),u=Oe(j,Y);M.removeAt(p),M.add(4,p),M.add(4,p),P.removeAt(I+1),P.removeAt(I+1),P.add(j,I+1),P.add(u,I+2),P.add(F,I+2),P.add(K,I+1),P.add(C,I+1)}z.s("edge.points",If(P)),z.s("edge.segments",M)}}}l.endTransaction()},removeShapePoint:function(S,t){var b=this,M="removeAt",A=b.gv,p=A.dm();if(p.beginTransaction(),0===arguments.length&&(S=b._shape||b._edge,t=b._removePointIndex),t>=0&&(S instanceof g||S instanceof $)){var L=Gp(S,b.gv.getDataUI(S),t),Q=t;if(S instanceof g){var y=S.p(),z=S.toSegments();z&&z.size()||(z=sj(S.getPoints()));var H=z.get(L),F="removePointAt";if(1===H&&0===Q)if(S.getPoints().size()>1){var d=z.get(L+1);z[M](L+1),3===d?S[F](Q+1):4===d&&(S[F](Q+2),S[F](Q+1)),S[F](Q)}else S.dm().remove(S);else 2===H||1===H?(z[M](L),S[F](Q)):3===H?(z[M](L),S[F](Q),S[F](Q-1)):4===H&&(z[M](L),S[F](Q),S[F](Q-1),S[F](Q-2));S.setSegments(z);var r=S.getWidth(),e=S.getHeight(),h=S.p().x-r/2,v=S.p().y-e/2;h-=y.x,v-=y.y;var n=un(S,{x:h,y:v,width:r,height:e},S.getRotation(),y);S.p(n.x,n.y)}else if(S instanceof $){if("points"!==S.s("edge.type"))return p.endTransaction(),void 0;var l=S.s("edge.points");if(z=S.s("edge.segments"),l&&(l=gq(b.gv.getDataUI(S),l),z&&z.size()||(z=sj(l))),0===t||t===l.size()-1)return p.endTransaction(),void 0;z=new N(z._as.slice(0)),l=new N(l._as.slice(0));var H=z.get(L);2===H||1===H?(z[M](L),l[M](Q)):3===H?(z[M](L),l[M](Q),l[M](Q-1)):4===H&&(z[M](L),l[M](Q),l[M](Q-1),l[M](Q-2)),S.s("edge.segments",z),S.s("edge.points",If(l))}}p.endTransaction()},changeShapeSegment:function(w,z,K){var j=this,F=j.gv,H=F.dm();if(H.beginTransaction(),1!==arguments.length||isNaN(w)||(K=w,w=j._shape||j._edge,z=j._hoverSegmentIndex),w instanceof g||w instanceof $){var Y=Il(w,j.gv.getDataUI(w),z);if(!isNaN(z)&&!isNaN(Y))if(w instanceof g){var R=w.p(),y=w.toSegments();y&&y.size()||(y=sj(w.getPoints()));var u=y.get(z),W=w.toPoints();if(1===K||2===K)1===u||2===u?y.set(z,K):3===u?(y.set(z,K),W.removeAt(Y+1)):4===u&&(y.set(z,K),W.removeAt(Y+1),W.removeAt(Y+1));else if(3===K){var b=function(){var X=W.get(Y),Q=W.get(Y+1),D=hm(X,Q);y.set(z,3),W.add(D,Y+1)};2===u||1===u?b():4===u&&(W.removeAt(Y+1),W.removeAt(Y+1),b())}else if(4===K){var q=function(){var J=W.get(Y),s=W.get(Y+1),M=Pe(J,s),R=Oe(J,s);y.set(z,4),W.add(M,Y+1),W.add(R,Y+2)};2===u||1===u?q():3===u&&(W.removeAt(Y+1),q())}w.setSegments(y),w.setPoints(W);var _=w.getWidth(),s=w.getHeight(),t=w.p().x-_/2,d=w.p().y-s/2;t-=R.x,d-=R.y;var v=new un(w,{x:t,y:d,width:_,height:s},w.getRotation(),R);w.p(v.x,v.y)}else if(w instanceof $){if("points"!==w.s("edge.type"))return H.endTransaction(),void 0;var W=w.s("edge.points");y=w.s("edge.segments"),W&&(W=gq(j.gv.getDataUI(w),W),y&&y.size()||(y=sj(W))),y=new N(y._as.slice(0)),W=new N(W._as.slice(0));var u=y.get(z);if(1===K||2===K)1===u||2===u?y.set(z,K):3===u?(y.set(z,K),W.removeAt(Y+1)):4===u&&(y.set(z,K),W.removeAt(Y+1),W.removeAt(Y+1));else if(3===K){var b=function(){var g=W.get(Y),x=W.get(Y+1),f=hm(g,x);y.set(z,3),W.add(f,Y+1)};2===u||1===u?b():4===u&&(W.removeAt(Y+1),W.removeAt(Y+1),b())}else if(4===K){var q=function(){var Z=W.get(Y),F=W.get(Y+1),I=Pe(Z,F),C=Oe(Z,F);y.set(z,4),W.add(I,Y+1),W.add(C,Y+2)};2===u||1===u?q():3===u&&(W.removeAt(Y+1),q())}w.s("edge.points",If(W)),w.s("edge.segments",y)}}H.endTransaction()},getDefaultSegments:function(w){var K=this.gv,q=K.getDataUI(w);if(w instanceof $){var L=w.s("edge.points");return L=gq(q,L),sj(L)}if(w instanceof g){var L=w.getPoints(),p=w.getSegments();return p&&p.size()>0?p:sj(L)}},$43l:function(y){var p=this;y&&(p.$5l=1),p._68I=1,p._42()},_42:function(){var s=this;if(s._68I){delete s._68I;var d=s.gv,P=s.$5l,k=d.getZoom(),G=d.getEditPointSize(),S=G/2,Z=new N,f=s._view,u=s._edge,x=s._shape,q=f.getContext("2d"),R=d.tx(),E=d.ty(),r=D,B=d.getEditPointBackground(),U=d.getControlPointBackground(),H=d.getControlPointBorderColor(),m=d.getEditPointBorderColor(),C=d.getEditRectBorderColor(),c=d.getDirectionLineColor(),v=d.getSegmentHoverColor(),W=d.getSnapPointBorderColor(),i=d.getJoinPointBackground(),O=d.getJoinPointBorderColor(),y=d.getSegmentHoverWidth(),l=[5,5],j=d.getEditRectBorderStyle();ye(d,function(A){d.isSelected(A)&&d.isVisible(A)&&Z.add(A)}),q.clearRect(0,0,A(f.width),A(f.height)),q.save(),L.translateAndScale(q,R,E,1);var X=D,h={x:0,y:0,width:0,height:0},o=0,t=0,J=0,n=0,K=0,a=0,tn=0,Jn=0,ho=0,Xo=0,Qc=[];if(P?(delete s.$6l,delete s.$8l,delete s.$7l,delete s.$16l,delete s.$23l):(X=s.$6l,r=s.$7l),delete s.$68l,delete s.$69l,delete s.$71l,delete s.$70l,delete s.$82l,delete s.$83l,delete s._pointElevationHelperPoint,delete s.$90l,delete s.$91l,delete s.$75l,delete s.$74l,Z.each(function(N){var c=d.getDataUI(N);if(c){var h=c._55O;if(d.isEditable(N))h._56O&&N instanceof Q&&t++,Qc.push(N),h._42O&&N instanceof Q&&o++,d.isHelperEditable(N,"host")&&n++,d.isHelperEditable(N,"parent")&&J++,d.isHelperEditable(N,"remove")&&K++,d.isHelperEditable(N,"edge")&&a++,d.isHelperEditable(N,"source")&&tn++,d.isHelperEditable(N,"target")&&Jn++,d.isHelperEditable(N,"elevation")&&ho++,d.isHelperEditable(N,"tall")&&Xo++;else if(N instanceof z&&N.isExpanded()){var A=!0,b=d.getEditableFunc();b&&(A=b(N)),A&&(d.isHelperEditable(N,"host")&&n++,d.isHelperEditable(N,"parent")&&J++,d.isHelperEditable(N,"remove")&&K++,d.isHelperEditable(N,"edge")&&a++,d.isHelperEditable(N,"source")&&tn++,d.isHelperEditable(N,"target")&&Jn++,d.isHelperEditable(N,"elevation")&&ho++,d.isHelperEditable(N,"tall")&&Xo++,Qc.push(N))}}}),q.beginPath(),q.lineWidth=1,q.strokeStyle=d.getNodeBorderColor(),Qc.forEach(function(w){var C=d.getDataUI(w),b=C._55O;if(P)if(r==D&&(r=w instanceof $?0:w instanceof z&&w.isExpanded()?0:w.getRotation(),s.$7l=r),X==D){var g,f,e;if(w instanceof z&&w.isExpanded()||w instanceof $){var n=d.getDataUIBounds(w);f=n.width,e=n.height,g={x:n.x+f/2,y:n.y+e/2}}else g=w.p(),f=w.getWidth(),e=w.getHeight();X={x:g.x,y:g.y,width:0,height:0},h.x=g.x-f/2,h.y=g.y-e/2,h.width=f,h.height=e,X=V(X,h)}else{var g,f,e,E,T=X.x+X.width/2,B=X.y+X.height/2,G={x:T,y:B};if(w instanceof z&&w.isExpanded()||w instanceof $){E=0;var n=d.getDataUIBounds(w);f=n.width,e=n.height,g={x:n.x+f/2,y:n.y+e/2}}else g=w.p(),f=w.getWidth(),e=w.getHeight(),E=w.getRotation();var L={x:g.x-f/2,y:g.y-e/2,width:f,height:e},Z={x:L.x,y:L.y},c={x:L.x+L.width,y:L.y},x={x:L.x,y:L.y+L.height},N={x:L.x+L.width,y:L.y+L.height},Z=zc(g,Z.x-g.x,Z.y-g.y,E),x=zc(g,x.x-g.x,x.y-g.y,E),N=zc(g,N.x-g.x,N.y-g.y,E),c=zc(g,c.x-g.x,c.y-g.y,E),t=-r,A=zc(G,Z.x-G.x,Z.y-G.y,t),W=zc(G,c.x-G.x,c.y-G.y,t),S=zc(G,x.x-G.x,x.y-G.y,t),u=zc(G,N.x-G.x,N.y-G.y,t),l=Y([A,W,S,u]);X=V(X,l),X.x-=T,X.y-=B;var _=un(D,X,r,G);X.x=_.x-X.width/2,X.y=_.y-X.height/2}if(o>1&&d.isEditable(w)&&d.isRectEditable(w)&&w instanceof Q){var p=w.getRect(),F=b.$45l,I=fp(F[0],k),O=fp(F[2],k),R=fp(F[4],k),j=fp(F[6],k);w.getRotation()?(q.moveTo(I.x,I.y),q.lineTo(O.x,O.y),q.lineTo(R.x,R.y),q.lineTo(j.x,j.y),q.lineTo(I.x,I.y)):q.rect(p.x*k,p.y*k,p.width*k,p.height*k)}}),q.stroke(),X){s.$6l=e(X),T(X,d.getEditRectPadding()/k);var ui={x:X.x+X.width/2,y:X.y+X.height/2},uc=th(ui,X.width,X.height,r),Oh=uc[0],nj=uc[1],yj=uc[2],pj=uc[3],vj=uc[4],Zn=uc[5],Dc=uc[6],jg=uc[7];if(Oh=fp(uc[0],k),nj=fp(uc[1],k),yj=fp(uc[2],k),pj=fp(uc[3],k),vj=fp(uc[4],k),Zn=fp(uc[5],k),Dc=fp(uc[6],k),jg=fp(uc[7],k),s.$8l=X,o>0&&(s.$16l=[Oh,vj,nj,Zn,pj,Dc,yj,jg],q.beginPath(),q.lineWidth=1,q.strokeStyle=C,"dashed"===j&&q.setLineDash&&q.setLineDash(l),q.moveTo(Oh.x,Oh.y),q.lineTo(nj.x,nj.y),q.lineTo(pj.x,pj.y),q.lineTo(yj.x,yj.y),q.lineTo(Oh.x,Oh.y),q.stroke(),"dashed"===j&&q.setLineDash&&q.setLineDash([])),q.beginPath(),q.lineWidth=1,q.fillStyle=B,q.strokeStyle=m,o>0){var Tr=Zn.x-jg.x,Ao=Zn.y-jg.y,Fm=w(Tr*Tr+Ao*Ao),Qn=vj.x-Dc.x,Ak=vj.y-Dc.y,tj=w(Qn*Qn+Ak*Ak),we=2*G;if(d.isDirectionEditable&&1===Qc.length){var Ed=Qc[0],Iq=d.getDataUI(Ed),_f=Iq._55O,os=d.isDirectionEditable.bind(d);if(_f._42O){var ck,Cc,gb,Dk;os(Ed,"northwest")&&(ck=!0,q.rect(Oh.x-S,Oh.y-S,G,G)),os(Ed,"northeast")&&(Cc=!0,q.rect(nj.x-S,nj.y-S,G,G)),os(Ed,"southwest")&&(gb=!0,q.rect(yj.x-S,yj.y-S,G,G)),os(Ed,"southeast")&&(Dk=!0,q.rect(pj.x-S,pj.y-S,G,G)),os(Ed,"north")&&(ck&&Cc?Fm>we&&q.rect(vj.x-S,vj.y-S,G,G):q.rect(vj.x-S,vj.y-S,G,G)),os(Ed,"south")&&(Dk&&gb?Fm>we&&q.rect(Dc.x-S,Dc.y-S,G,G):q.rect(Dc.x-S,Dc.y-S,G,G)),os(Ed,"west")&&(gb&&ck?tj>we&&q.rect(jg.x-S,jg.y-S,G,G):q.rect(jg.x-S,jg.y-S,G,G)),os(Ed,"east")&&(Dk&&Cc?tj>we&&q.rect(Zn.x-S,Zn.y-S,G,G):q.rect(Zn.x-S,Zn.y-S,G,G))}}else Fm>we&&(q.rect(vj.x-S,vj.y-S,G,G),q.rect(Dc.x-S,Dc.y-S,G,G)),tj>we&&(q.rect(Zn.x-S,Zn.y-S,G,G),q.rect(jg.x-S,jg.y-S,G,G)),q.rect(Oh.x-S,Oh.y-S,G,G),q.rect(nj.x-S,nj.y-S,G,G),q.rect(yj.x-S,yj.y-S,G,G),q.rect(pj.x-S,pj.y-S,G,G)}if(t>0){var nc=s.$23l=zc(vj,0,2*-G,r);q.moveTo(nc.x+S,nc.y),q.arc(nc.x,nc.y,S,0,M,!1)}q.fill(),q.stroke(),s.$40l&&s.$44l(q,X,r);var Lq,as,xe=d.getLeftTopHelpers(),hq=d.getRightTopHelpers(),Wj=d.getLeftBottomHelpers(),Bb=d.getRightBottomHelpers(),Fd=d.getEdgeHelpers(),mj=d.getEditHelperSize(),jh=mj/2,rq=function(I,g,h,R){"leftTop"===g?(Lq=X.x*k-mj-S-("h"===R?h*(mj+S):0)-1,as=X.y*k-mj-S-("v"===R?h*(mj+S):0)-1):"rightTop"===g?(Lq=(X.x+X.width)*k+S+("h"===R?h*(mj+S):0)+1,as=X.y*k-mj-S-("v"===R?h*(mj+S):0)-1):"leftBottom"===g?(Lq=X.x*k-mj-S-("h"===R?h*(mj+S):0)-1,as=(X.y+X.height)*k+S+("v"===R?h*(mj+S):0)+1):"rightBottom"===g&&(Lq=(X.x+X.width)*k+S+("h"===R?h*(mj+S):0)+1,as=(X.y+X.height)*k+S+("v"===R?h*(mj+S):0)+1);var O=Lq+jh,N=as+jh,P=(X.x+X.width/2)*k,u=(X.y+X.height/2)*k,B=zc({x:P,y:u},O-P,N-u,r);if("host"===I){if(n>0)return s.$77l(q,r,B),!0}else if("edge"===I){if(a>0)return s.$80l(q,r,B),!0}else if("remove"===I){if(K>0)return Qc&&1===Qc.length&&Qc[0]instanceof $?s.$81l(q,r,{x:P+mj/2+5,y:u}):s.$81l(q,r,B),!0}else if("parent"===I){if(J>0)return Qc&&1===Qc.length&&Qc[0]instanceof $?s.$76l(q,r,{x:P-mj/2-5,y:u}):s.$76l(q,r,B),!0}else if("elevation"===I){if(ho>0)return s.$85l(q,r,B),!0}else if("tall"===I){if(Xo>0)return s.$86l(q,r,B),!0}else if("source"===I||"target"===I){var F=Qc[0],f=d.getDataUI(F),A=lo(f,!0),H=A[0],T=A[1];if(tn&&"source"===I)return s.$84l(q,X,H,!0,F.isLooped(),g,h,R),!0;if(Jn&&"target"===I)return s.$84l(q,X,T,!1,F.isLooped(),g,h,R),!0}};if(xe&&xe.length>0){var Gr=0;xe.forEach(function(p){rq(p,"leftTop",Gr,d.getLeftTopHelpersAlign()||"h")&&Gr++})}if(hq&&hq.length>0){var Gr=0;hq.forEach(function(g){rq(g,"rightTop",Gr,d.getRightTopHelpersAlign()||"h")&&Gr++})}if(Wj&&Wj.length>0){var Gr=0;Wj.forEach(function(i){rq(i,"leftBottom",Gr,d.getLeftBottomHelpersAlign()||"h")&&Gr++})}if(Bb&&Bb.length>0){var Gr=0;Bb.forEach(function(s){rq(s,"rightBottom",Gr,d.getRightBottomHelpersAlign()||"h")&&Gr++})}if(Fd&&Fd.length>0&&((tn||Jn)&&Qc&&1===Qc.length&&Qc[0]instanceof $?!0:!1)){var Gr=0;Fd.forEach(function(m){rq(m,"edge",Gr,"h")&&Gr++})}if(s.$72l){var Oo,_b=s.$67l,Sc=s.$68l,Ye=s.$69l,fs=(s.$71l,s.$70l),Rn=s.$82l,Xd=s.$83l;if(1===_b?Oo=Sc:2===_b?Oo=Ye:3===_b?Oo=fs:5===_b?Oo=Rn:6===_b&&(Oo=Xd),Oo){var Hn=d.lp(s.$72l),al=d.getDataAt(s.$72l);if(al&&al instanceof Q){var lf,hd,kb;if(s.$73l=al,1===_b)if(al instanceof I.Grid)lf=s.$75l=rl(al,Hn);else if(al instanceof I.Shape){kb=s.$74l=Ij(al,Hn);var Cb=al.getPoints();if(kb){var ce=kb.attachIndex,Ob=Il(al,d.getDataUI(al),ce)+1,Zk=Ob+1>=Cb.size()?0:Ob+1,Gf=Cb.get(Ob),lk=Cb.get(Zk),om=al.p(),$d=al.getRotation();Gf=zc(om,Gf.x-om.x,Gf.y-om.y,$d),lk=zc(om,lk.x-om.x,lk.y-om.y,$d),q.beginPath(),q.strokeStyle=v,q.lineWidth=y,q.moveTo(Gf.x*k,Gf.y*k),q.lineTo(lk.x*k,lk.y*k),q.stroke()}}lf?hd=lf.rect:(hd=F.clone(d.getDataUIBounds(al)),F.grow(hd,2)),q.beginPath(),q.rect(hd.x*k,hd.y*k,hd.width*k,hd.height*k),q.strokeStyle=1===_b||4===_b||6===_b?p:_,q.lineWidth=2,q.setLineDash&&q.setLineDash([8,8]),q.stroke()}else delete s.$73l;Hn.x=Hn.x*k,Hn.y=Hn.y*k;var sn=gr(Oo.x,Oo.y,Hn.x,Hn.y),ao=zc(Oo,Hn.x-Oo.x,Hn.y-Oo.y,-sn),Wo=ao.x-Oo.x;q.save(),q.translate(Oo.x,Oo.y),q.rotate(sn),b.width=Wo,b.height=40;var Vm=_;(1===_b||4===_b||6===_b)&&(Vm=p),b.comps[0].gradientColor=Vm,F.drawImage(q,b,0,-20,Wo,40),q.restore()}}}if(Z.each(function(e){var Y=d.getDataUI(e);if(Y){var f,F,L=Y._55O,w=Y._78o;if(L&&L._43O&&e instanceof g?(f=L.$15l,F=e.getSegments(),F&&F.size()||(F=sj(f)),e.isClosePath()&&F.indexOf(5)<0&&(F=new N(F._as),F.add(5))):L&&w&&L._43O&&(f=e.s("edge.points"),F=e.s("edge.segments"),f=gq(Y,f),F&&F.size()||(F=sj(f)),f&&(f=f._as)),f&&F){var Z=0,p=F.size(),R=s._hoverSegmentIndex;f=f.slice(0);for(var V=0;V<f.length;V++)f[V]=fp(f[V],k);q.beginPath(),q.strokeStyle=c,q.lineWidth=1,Z=0;for(var V=0;p>V;V++){var b=F.get(V);if(1===b||2===b)Z++;else if(3===b){var G=f[Z-1],P=f[Z],K=f[Z+1];q.moveTo(G.x,G.y),q.lineTo(P.x,P.y),q.lineTo(K.x,K.y),Z+=2}else if(4===b){var G=f[Z-1],t=f[Z],n=f[Z+1],K=f[Z+2];q.moveTo(G.x,G.y),q.lineTo(t.x,t.y),q.moveTo(n.x,n.y),q.lineTo(K.x,K.y),Z+=3}}if(q.stroke(),x===e||u===e&&"points"===u.s("edge.type")){q.beginPath(),Z=0,q.strokeStyle=v,q.lineWidth=y;for(var V=0;p>V;V++){var b=F.get(V);if(1===b||2===b){if(R===V){var G=f[Z-1],K=f[Z];q.moveTo(G.x,G.y),q.lineTo(K.x,K.y);break}Z++}else if(3===b){if(R===V){var G=f[Z-1],P=f[Z],K=f[Z+1];q.moveTo(G.x,G.y),q.quadraticCurveTo(P.x,P.y,K.x,K.y);break}Z+=2}else if(4===b){if(R===V){var G=f[Z-1],t=f[Z],n=f[Z+1],K=f[Z+2];q.moveTo(G.x,G.y),q.bezierCurveTo(t.x,t.y,n.x,n.y,K.x,K.y);break}Z+=3}else if(5===b&&R===V){var G=f[Z-1],K=f[0];q.moveTo(G.x,G.y),q.lineTo(K.x,K.y);break}}q.stroke()}q.beginPath(),Z=0,q.strokeStyle=O,q.lineWidth=1,q.fillStyle=i;for(var V=0;p>V;V++){var b=F.get(V);if(1===b||2===b){var K=f[Z];q.moveTo(K.x+S,K.y),q.arc(K.x,K.y,S,0,M,!0),Z++}else if(3===b){var K=f[Z+1];q.moveTo(K.x+S,K.y),q.arc(K.x,K.y,S,0,M,!0),Z+=2}else if(4===b){var K=f[Z+2];q.moveTo(K.x+S,K.y),q.arc(K.x,K.y,S,0,M,!0),Z+=3}}q.fill(),q.stroke(),q.beginPath(),Z=0,q.strokeStyle=H,q.lineWidth=1,q.fillStyle=U;for(var V=0;p>V;V++){var b=F.get(V);if(1===b||2===b)Z++;else if(3===b){var P=f[Z];q.moveTo(P.x+S,P.y),q.arc(P.x,P.y,S,0,M,!0),Z+=2}else if(4===b){var t=f[Z],n=f[Z+1];q.moveTo(t.x+S,t.y),q.arc(t.x,t.y,S,0,M,!0),q.moveTo(n.x+S,n.y),q.arc(n.x,n.y,S,0,M,!0),Z+=3}}if(q.fill(),q.stroke(),q.beginPath(),Z=0,q.strokeStyle=W,q.lineWidth=2,(x===e||u===e)&&s.$9l!=D){var K=f[s.$9l];q.moveTo(K.x+S,K.y),q.arc(K.x,K.y,S,0,M,!0),q.stroke()}}}}),s.$87l&&d.sm().contains(s.$87l)){var qf,Co=s.$87l,gn=s.$88l,mj=d.getEditHelperSize(),jh=mj/2;if(d.isHelperEditable(Co,"pointElevation"))if(Co instanceof g){var Hh=Co.getPosition();qf=F.clone(Co.getPoints().get(gn)),qf=zc({x:Hh.x,y:Hh.y},qf.x-Hh.x,qf.y-Hh.y,Co.getRotation()),qf.x*=k,qf.y*=k,q.translate(qf.x,qf.y),F.drawImage(q,F.getImage("xeditinteractor_elevationIcon"),jh,-jh,mj,mj),q.translate(-qf.x,-qf.y),s._pointElevationHelperPoint={x:qf.x+mj,y:qf.y}}else if(Co instanceof $){var gp=gq(d.getDataUI(Co),Co.s("edge.points")),qf=F.clone(gp.get(gn));qf.x*=k,qf.y*=k,q.translate(qf.x,qf.y),F.drawImage(q,F.getImage("xeditinteractor_elevationIcon"),jh,-jh,mj,mj),q.translate(-qf.x,-qf.y),s._pointElevationHelperPoint={x:qf.x+mj,y:qf.y}}}q.restore(),s.$5l=0}},$89l:function(e,U,q,k){e.save();var d=this,J=d.gv,i=J.getEditHelperSize(),f=i/2;e.beginPath(),e.translate(q.x,q.y),e.rotate(U),F.drawImage(e,k,-f,-f,i,i),e.restore()},$85l:function(X,d,u){var m=this;m.$90l=u,m.$89l(X,d,u,F.getImage("xeditinteractor_elevationIcon"))},$86l:function(K,r,v){var t=this;t.$91l=v,t.$89l(K,r,v,F.getImage("xeditinteractor_tallIcon"))},$77l:function(z,e,B){var Q=this;Q.$68l=B,Q.$89l(z,e,B,F.getImage("xeditinteractor_hostIcon"))},$80l:function(E,n,b){var z=this;z.$70l=b,z.$89l(E,n,b,F.getImage("xeditinteractor_edgeIcon"))},$81l:function(v,T,V){var D=this;D.$71l=V,D.$89l(v,T,V,F.getImage("xeditinteractor_removeIcon"))},$76l:function(J,Q,d){var g=this;g.$69l=d,g.$89l(J,Q,d,F.getImage("xeditinteractor_parentIcon"))},$84l:function(m,d,w,D,C){var o,K=this,B=K.gv,O=B.getZoom(),f=B.getEditHelperSize(),c=f/2;w.x*=O,w.y*=O,C&&(D?w.x-=c+5:w.x+=c+5),w.y-=f-2,D?(K.$82l=w,o=F.getImage("xeditinteractor_sourceIcon")):(K.$83l=w,o=F.getImage("xeditinteractor_targetIcon")),m.beginPath(),m.translate(w.x,w.y),F.drawImage(m,o,-c,-c,f,f),m.translate(-w.x,-w.y)},$44l:function(v,P,Z){v.save();var K=this.gv.getZoom(),l=w(d(P.width,2)+d(P.height,2))/2*K+10,Y=l,$=Y+8,H=Y+18,A=Z,r=P.x+P.width/2,J=P.y+P.height/2;v.translate(r*K,J*K),v.beginPath(),v.strokeStyle="rgb(150, 150, 150)";for(var n=0,m=0,e=0,I=0,q=0,g=0;360>g;g++)n=g*x/180,0===g%5&&(m=k(n)*Y,e=C(n)*Y,I=k(n)*$,q=C(n)*$,v.moveTo(m,e),v.lineTo(I,q)),0===g%45&&(m=k(n)*Y,e=C(n)*Y,I=k(n)*H,q=C(n)*H,v.moveTo(m,e),v.lineTo(I,q));v.stroke(),v.beginPath(),v.rotate(-h),v.beginPath(),v.fillStyle="rgba(255, 0, 0, 0.1)",v.strokeStyle="rgb(157, 157, 157)",v.moveTo(0,0),v.arc(0,0,H,0,Z,!1),v.fill(),v.beginPath(),v.moveTo(0+H,0),v.arc(0,0,H,0,Z,!1),v.stroke(),v.rotate(h),v.font="bold 12px Verdana, Arial";var o=20*C(A),O=20*k(A),Q=i(180*A/x)+"°";v.textAlign="center",v.textBaseline="middle",v.beginPath();var V=v.measureText("365.°").width;v.fillStyle="white",v.rect(o-V/2,-O-10,V,20),v.fill(),v.beginPath(),v.fillStyle="rgb(79,79,79)",v.fillText(Q,o,-O),v.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);