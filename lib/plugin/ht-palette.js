!function(V,k,P){"use strict";var x="px",U="0",l="innerHTML",h="className",L=ht.Default,c=ht.Color,R=ht.Node,X="position",G="top",F="left",N=L.animate,I=L.getInternal(),d="width",U="0",J="none",b="max-height",$="font",j="background",i="border-box",q="user-select",y="box-sizing",v="overflow",p=L.isTouchable,I=L.getInternal(),K=c.titleIconBackground,E=L.scrollBarInteractiveSize,Z=/msie 9/.test(V.navigator?V.navigator.userAgent.toLowerCase():""),u=null,a=function(){return document},_=function(o){return a().createElement(o)},t=function(){return _("div")},g=function(){var Y=t(),v=Y.style;return v.msTouchAction=J,v.cursor="default",p&&v.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",u),v.position="absolute",v.left=U,v.top=U,Y},M=function(){return _("canvas")},r=function(){return document.body},n=function(k,$,K){k.style.setProperty($,K,u)},z=function(g,o){g.style.removeProperty(o)},Q=function($,S,M){L.def(ht.widget[$],S,M)},f=function(m,p){m.appendChild(p)},H=function(U,B){U.removeChild(B)},T=I.addEventListener;I.removeEventListener,I.addMethod(L,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:K,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:K}]},paletteTitleLabelColor:L.labelSelectColor,paletteTitleLabelFont:L.labelFont,paletteContentLabelFont:L.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:L.widgetTitleHeight,paletteTitleBackground:c.titleBackground,paletteTitleHoverBackground:c.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:P,paletteItemHoverBorderColor:c.highlight,paletteItemSelectBackground:c.highlight},!0);var w=".palette-item:hover{border: 1px solid "+L.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+L.paletteTitleHoverBackground+" !important}",m=document.createElement("style");p||(m.styleSheet?m.styleSheet.cssText=w:m.appendChild(a().createTextNode(w))),a().getElementsByTagName("head")[0].appendChild(m);var A=function(I){var y=this;y.$22h=I,y.addListeners()};L.def(A,k,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var $=this;$.$36h&&r().removeChild($.$36h),$.$23h=$.$24h=$.$25h=$.$35h=$.$36h=u},handle_touchstart:function(D){for(var I,S=this,l=S.$22h,p=D.target,J=l.sm(),z=l.dm(),r="palette-header",s="palette-header-tool",v="palette-item",$=!1,A=!1,Z=!1;p&&(p[h]||"").indexOf(r)<0&&(p[h]||"").indexOf(v)<0;)p=p.parentNode;if(p&&p[h].indexOf(s)>=0?$=!0:p&&p[h].indexOf(r)>=0?Z=!0:p&&p[h].indexOf(v)>=0&&(A=!0),L.isLeftButton(D))if(S.$27h(D))S.$24h=L.getClientPoint(D),S.$25h=l.ty();else if($){L.preventDefault(D),I=p.parentNode.$11h;var V=z.getDataById(I),y=V.s("tools")[p.toolIndex];y.action&&y.action.call(l)}else if(Z){L.preventDefault(D),I=p.$11h;var V=z.getDataById(I);V.isExpanded()?V.setExpanded(!1):V.setExpanded(!0)}else if(A){I=p.$11h;var _=z.getDataById(I);J.ss(_),l.handleDragAndDrop&&(L.preventDefault(D),_.s("draggable")&&(l.handleDragAndDrop(D,"prepare"),S.$35h=0)),_.s("draggable")||(L.preventDefault(D),S.$24h=L.getClientPoint(D),S.$25h=l.ty())}else L.preventDefault(D),S.$24h=L.getClientPoint(D),S.$25h=l.ty();else S.$26h(D)},handle_mousedown:function(N){this.handle_touchstart(N)},handle_mousewheel:function(U){this.handleScroll(U,U.wheelDelta/40,U.wheelDelta!==U.wheelDeltaX)},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,-Z.detail,1)},handleScroll:function(M,o,R){var t=this.$22h;L.preventDefault(M),R&&t._41o()&&t.ty(t.ty()+20*o)},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(O){var Y=this;Y.$37h(O),Y.$26h(O)},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(n){var r=this;r.$37h(n),r.$26h(n)},$37h:function(u){var v=this,V=v.$22h;2===v.$35h&&(v.$35h=3,V.handleDragAndDrop(u,"end"))},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function($){var z=this,l=z.$22h,r=z.$23h,_=z.$24h,o=z.$25h,X=L.getClientPoint($),c=l._29I,I=z.$36h;if(1===z.$35h||2===z.$35h){if(z.$35h=2,l.handleDragAndDrop($,"between"),p){var f=$.touches[0];$=f?f:$.changedTouches[0]}I.style.left=$.pageX-parseInt(I.width)/2+x,I.style.top=$.pageY-parseInt(I.height)/2+x}else"p"===r?l.ty(o+X.y-_.y):"v"===r&&l.ty(o+(_.y-X.y)/c.height*l._59I)},handle_mousemove:function(E){this.handle_touchmove(E)},handle_touchmove:function(h){if(!L.isDragging()&&L.isLeftButton(h)){var E=this,b=E.$22h,n=E.$27h(h);if(E.$24h){if(!E.$23h){if(L.getDistance(L.getClientPoint(h),E.$24h)<2)return;E.$23h=n?"v":"p",L.startDragging(E)}}else if(n)b._43o();else if(0===E.$35h){if(E.$35h=1,b.handleDragAndDrop(h,"begin"),p){var I=h.touches[0];h=I?I:h.changedTouches[0]}var D=E.$36h=new Image,f=b.$10h[b.sm().ld().getId()].querySelector(".image-box"),e=parseInt(f.style.width),Y=parseInt(f.style.height);D.draggable=!1,D.src=f.toDataURL(),D.width=e,D.height=Y,D.style.position="absolute",D.style.left=h.pageX-e/2+x,D.style.top=h.pageY-Y/2+x,r().appendChild(D),L.startDragging(E)}}},$27h:function(u){var G=this.$22h,c=G.getView(),I=c.getBoundingClientRect(),h=G._29I,f=u.clientX-I.left+c.scrollLeft;return G._41o()&&h.x+h.width-f<E}}),ht.widget.Palette=function(O){var x=this,m=x._view=I.createView(null,x);x.$9h={},x.$10h={},x.$4h={},x._29I={x:0,y:0,width:0,height:0},x._59I=0,x.dm(O?O:new ht.DataModel),m[h]="ht-widget-palette",x.$29h=new A(x),n(m,j,L.paletteContentBackground),n(m,v,"auto"),n(m,y,i),n(m,"-moz-"+y,i),n(m,"-webkit-"+q,J),n(m,"-moz-"+q,J),n(m,"-ms-"+q,J),n(m,q,J),n(m,"position","absolute"),n(m,"overflow","hidden"),f(m,x._79O=g()),T(m,"dragstart",function(m){m.dataTransfer&&(m.dataTransfer.setData("Text","nodeid:"+m.target.$11h),m.dataTransfer.effectAllowed="all",x.$29h.$26h())})},Q("Palette",k,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:L.autoHideScrollBar,_scrollBarSize:L.scrollBarSize,_scrollBarColor:L.scrollBarColor,getViewRect:function(){return this._29I},ty:function(l){return l==u?this.getTranslateY():(this.setTranslateY(l),void 0)},setTranslateY:function(x){if(this.$32h==u){var k=this,U=k.$33h(x),J=k.$30h;k.$30h=U,k.fp("translateY",J,U)}},getTranslateY:function(){return this.$30h},setLayout:function(P){var n,i,a=this,o=a._layout;a._layout=P,"smallicons"===P?n=i=20:"iconsonly"===P?n=i=50:(n=70,i=50),a.setItemImageWidth(n),a.setItemImageHeight(i),a.setItemImagePadding(4),a.fp("layout",o,P)},getDataAt:function(P){for(var _=P.target;_&&_.$11h==u;)_=_.parentNode;return _&&_.$11h!=u?this.getDataModel().getDataById(_.$11h):void 0},$20h:function(){var A=16;return p&&(A*=1.2),A},$19h:function(){return L.paletteTitleHeight},$18h:function(){var j=L.paletteSeparatorWidth,i=L.paletteTitleBackground,m=L.paletteSeparatorColor||L.brighter(i);return j+x+" solid "+m},$17h:function(N){n(N,"cursor","pointer"),n(N,"display","inline-block"),n(N,"margin-right",(p?8:4)+x),n(N,"vertical-align",G)},$1h:function(R){var a=this,W=t(),F=t(),p=_("span");W[h]="palette-header",n(W,X,"relative"),n(W,j,L.paletteTitleBackground),n(W,"color",L.paletteTitleLabelColor),n(W,G,U),n(W,y,i),n(W,"-moz-"+y,i),n(W,"padding","0 5px 0 0"),n(W,"border-top",a.$18h()),n(W,d,"100%"),n(W,"cursor","pointer"),n(W,"white-space","nowrap"),n(W,v,"hidden"),n(W,$,L.paletteTitleLabelFont),n(W,"line-height",a.$19h()+x),W.$11h=R.getId();var D=M(),O=a.$19h(),o=a.$20h();a.$17h(D),I.setCanvas(D,o,O),f(W,D);var E=R.s("tools");if(E)for(var w=0;w<E.length;w++){var K=M();a.$17h(K),I.setCanvas(K,o,O),K[h]="palette-header-tool palette-header-tool"+R.getId()+"-"+w,K.style.position="absolute",K.style.right=(o+10)*w+"px",K.toolIndex=w,f(W,K)}return D[h]="palette-toggle-icon-"+R.getId(),F[h]="palette-content",n(F,"max-height",0+x),n(F,$,L.paletteContentLabelFont),n(F,v,"hidden"),F.$11h=R.getId(),a.$9h[R.getId()]=F,p[l]=R.getName(),n(p,$,L.paletteTitleLabelFont),f(W,D),f(W,p),[W,F]},$2h:function(a){var s=this,w=s._layout,p=Z&&a.s("draggable")?_("a"):t(),V=M(),z=t(),e=a.getName()||"",c=a.s("title")||a.getToolTip()||e,S=s._itemMargin;V[h]="image-box";var Y=s.getItemImageWidth(),H=s.getItemImageHeight();return I.setCanvas(V,Y,H),f(p,V),z[l]=e,z[h]="label-box","iconsonly"!==w&&f(p,z),p[h]="palette-item",n(p,"vertical-align",G),n(p,"cursor","pointer"),n(p,"border-radius",5+x),n(p,"border","1px solid transparent"),n(p,"text-align","center"),n(p,"display","inline-block"),n(p,"margin-left",S+x),n(p,"margin-top",S+x),n(p,"color",L.paletteContentLabelColor),"smallicons"===w?(n(V,"vertical-align","middle"),n(p,"margin-left",2+x),n(p,"margin-top",2+x),n(p,"padding",2+x),n(p,"text-align",F),n(z,"display","inline-block"),n(z,"min-width",s.$21h+s._itemMargin+x)):"largeicons"===w&&(n(z,"max-width",Y+x),n(z,"overflow","hidden")),p.$11h=a.getId(),c&&(p.title=c),a.s("draggable")&&!s.handleDragAndDrop&&(Z?(p.href="#",n(p,"text-decoration",J)):p.draggable="true"),p},$16h:function($,C,h,k){var b=I.initContext($);I.translateAndScale(b,0,0,1),b.clearRect(0,0,h,h);var n=(h-k)/2;L.drawStretchImage(b,L.getImage(C),"fill",0,n,k,k),b.restore()},$15h:function(c){var R=this,e=c.getId(),X=R._view.querySelector(".palette-toggle-icon-"+e),t=c.isExpanded()?L.paletteCollapseIcon:L.paletteExpandIcon;if(X&&t){var P=R.$19h(),U=R.$20h();R.$16h(X,t,P,U)}},_drawToolsIcon:function(C){var V=this,D=C.s("tools");if(D)for(var Q=0;Q<D.length;Q++){var c=V._view.querySelector(".palette-header-tool"+C.getId()+"-"+Q),b=D[Q].icon,J=V.$19h(),s=V.$20h();V.$16h(c,b,J,s)}},$14h:function(m){var Z=this,g=m.getId(),_=Z.$10h[g].querySelector(".image-box"),Y=m.getImage(),t=m.s("image.stretch");if(_&&Y){var C=I.initContext(_),b=Z.getItemImagePadding();b="smallicons"===Z._layout?b/2:b;var h=Z.getItemImageWidth()-2*b,P=Z.getItemImageHeight()-2*b;I.translateAndScale(C,0,0,1),C.clearRect(0,0,h,P),L.drawStretchImage(C,L.getImage(Y),t,b,b,h,P,m,Z),C.restore()}},validateImpl:function(){var W,w,Q,p=this,F=p.$9h,T=p._layout,o=p.$10h,c=p.$4h,n=p._view,a=p.dm();if(p.$13h&&(delete p.$13h,c={},a.each(function(A){c[A.getId()]=A})),"smallicons"===T)for(var X in c){var A=c[X];if(A instanceof R){var C=A.getName()||"",r=L.getTextSize(L.paletteContentLabelFont,C).width;p.$21h!=u&&p.$21h>r||(p.$21h=r)}}for(var X in c){Q=c[X];var e,I;if(a.contains(Q)){if(Q instanceof ht.Group){var v,d=p.$1h(Q),S=o[Q.getId()];S&&(v=S.nextSibling,H(n,v),H(n,S)),w=a.getSiblings(Q).indexOf(Q);var G=n.children[2*w]||p._79O;G&&G.parentNode?(n.insertBefore(d[0],G),n.insertBefore(v||d[1],G)):(n.appendChild(d[0]),n.appendChild(v||d[1])),o[Q.getId()]=d[0],W=F[Q.getId()]=v||d[1],I=Q.$12h;var D=Q.s("promptText");I||(Q.$12h=_("div"),Q.$12h[l]=D||"",I=Q.$12h),0===Q.getChildren().size()?W.contains(I)||f(W,I):W.contains(I)&&H(W,I)}else if(e=Q.getParent()){var i=p.$2h(Q),k=o[Q.getId()];W=F[e.getId()],k&&H(k.parentNode,k),w=a.getSiblings(Q).indexOf(Q);var s=W.children[w];s?W.insertBefore(i,s):f(W,i),o[Q.getId()]=i,p.$14h(Q)}}else{var M=o[Q.getId()],q=M.parentNode;if(Q instanceof ht.Group){var y=M.nextSibling;H(n,M),H(n,y),delete F[Q.getId()]}else H(q,M),0===q.children.length&&(e=a.getDataById(q.$11h),e&&(I=e.$12h,I&&!q.contains(I)&&f(q,I)));delete o[Q.getId()]}}p.$4h={};var Y=function(){var t=p._59I,M=0;p.$32h!=u&&(clearInterval(p.$32h),M=0,delete p.$32h),p.$32h=setInterval(function(){p.$31h(),t===p._59I?(M++,M>=2&&(clearInterval(p.$32h),delete p.$32h)):(M=0,t=p._59I)},30)};for(var V in F)if(W=F[V],Q=a.getDataById(F[V].$11h),p.$15h(Q),p._drawToolsIcon(Q),Q.isExpanded()){if(W.style.maxHeight===0+x){var h=W.scrollHeight+p._itemMargin+x;N(W).duration(200).set(b,h).set("padding-bottom",p._itemMargin+x).end(function(){return function(){Y()}}(h))}else W.style.maxHeight=W.scrollHeight+x;W.style.paddingBottom=p._itemMargin+x}else W.style.maxHeight!==0+x&&N(W).duration(200).set(b,U).set("padding-bottom",U).end(function(){return function(){Y()}}(W));p.$28h(),p.$31h()},$31h:function(){for(var r=this,S=r._view,l=0,X=S.children,e=0;e<X.length;e++){var L=X[e];L.className&&L.className.indexOf("palette-")>=0&&(l+=L.offsetHeight)}r._59I=l,r.$30h=r.$33h(r.ty());var E=r.ty();S.scrollTop=-E,r._29I={x:0,y:-E,width:S.clientWidth,height:S.clientHeight},n(r._79O,G,-E+x),r._93I()},$33h:function(a){var B=this,E=B._29I.height-B._59I;return E>a&&(a=E),a>0?0:Math.round(a)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(R){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(R.property)<0&&this.redraw(),"translateY"===R.property&&(this.iv(),this._43o())},findDataByName:function(Z){for(var v=this.dm().getDatas(),s=0;s<v.size();s++){var t=v.get(s);if(t.getName()===Z)return t}},setDataModel:function(P){var n=this,G=n._dataModel,x=n._selectionModel;G!==P&&(G&&(G.umm(n.$6h,n),G.umd(n.$8h,n),G.umh(n.$7h,n),x||G.sm().ums(n.$28h,n)),n._dataModel=P,P.mm(n.$6h,n),P.md(n.$8h,n),P.mh(n.$7h,n),x?x._21I(P):P.sm().ms(n.$28h,n),n.sm().setSelectionMode("single"),n.fp("dataModel",G,P))},$6h:function(h){var t=this,$=t._view,z=h.data,U=t.$4h;"add"===h.kind?U[z.getId()]=z:"remove"===h.kind?U[z.getId()]=z:"clear"===h.kind&&(t.$10h={},t.$9h={},t.$4h={},$[l]=""),t.iv()},$7h:function(k){var y=this,W=k.data;y.$4h[W.getId()]=W,y.iv()},$8h:function(i){var V=this,s=i.data,X=i.property;"expanded"===X?V.iv():(V.$4h[s.getId()]=s,V.iv())},$28h:function(){var V,l=this,s=l.sm(),F="palette-item",w=s.ld();this.dm().each(function(Y){V=l.$10h[Y.getId()],V&&V[h].indexOf(F)>=0&&(Y===w?n(V,j,L.paletteItemSelectBackground):z(V,j))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);