!function(W){"use strict";var d="ht",v=W[d],N=function(){return document},y=function(){return N().body},Y=function(k,L,V){k.style.setProperty(L,V,null)},u=function(r){return N().createElement(r)},U=function(){return u("div")},t=function(){var D=u("canvas");return D},s=function(D,A){Y(D,"-webkit-transform",A),Y(D,"-ms-transform",A),Y(D,"transform",A)},V=function(r,w){Y(r,"-webkit-transform-origin",w),Y(r,"-ms-transform-origin",w),Y(r,"transform-origin",w)},I=function(f,T){f.appendChild(T)},A=function(e,g){e.removeChild(g)},f=W.parseInt,p=v.Default,k=p.getInternal(),G=k.addEventListener,P=(k.removeEventListener,Math.PI),l="white-space",F="visibility",a="left",w="top",K="width",Q="height",O="position",i="display",J="z-index",R="px",H="0 0",o="absolute",r="visible",c="hidden",L="none",x="block",M="nowrap",Z="rgba(0, 0, 0, 0.005)";p.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var $=v.graph.GraphView.prototype,T=$._42;$.adjustHtmlNodeIndex=!0,$._42=function(a,Z){if(T.call(this,a,Z),this.adjustHtmlNodeIndex)for(var W=this.getDataModel()._datas._as,e=W.length,S=1,E=0;e>E;E++){var x=W[E];if(x instanceof j){var B=this.getDataUI(x);Y(B.$2f,J,S+""),Y(B.$3f,J,S+1+""),S+=2}}};var C=v.HtmlNodeUI=function(b,s){var w=this;C.superClass.constructor.call(w,b,s);var Q=w.$2f=U(),n=w.$3f=t();Y(Q,O,o),Y(Q,F,c),Y(Q,l,M),n.draggable=!1,Y(n,O,o),Y(n,i,L),V(n,H),G(Q,"change",function(v){var E=v.target,G=E.bind||E.getAttribute("bind"),Q=E.type&&"checkbox"===E.type?E.checked:E.value,g=s.getContext();G&&g&&(g[G]=Q,w.$4f=JSON.stringify(g))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(Y){G(Q,Y,this.$9f.bind(this))},w)};p.def(C,k.ui().NodeUI,{_visible:!0,$11f:function(){var t=this,g=t.$3f,S=t._data,r=S.getDraggerImageWidth(),s=S.getDraggerImageHeight(),M=S.getDraggerImage(),d=k.initContext(g);d.beginPath(),k.setCanvas(g,r,s),k.translateAndScale(d,0,0,1),d.clearRect(0,0,r,s),p.drawImage(d,p.getImage(M),0,0,r,s),d.restore()},_80o:function(n){C.superClass._80o.call(this,n);var E=this,T=E._data,z=T._padding,t=2*z,m=E.$2f,y=E.$3f,g=E.gv,p=g.getZoom(),H=g.getTranslateX(),h=g.getTranslateY(),G=g.getView(),j=E._83o,l=T._width,e=T._height,V=j.position,v=j.rotation,N=(l-t)/T.$5f*p,D=(e-t)/T.$6f*p,W=E._html,X=T._html,$=T.getHtmlType();if("html"===$){var M=T.getContext()||{},_=E.$4f,d=T.$10f,u=JSON.stringify(M);W&&_&&W===X&&_===u||(E.$4f=u,E._html=X,m.innerHTML=d?d(M):X)}else if(null!=$){var q=T.getHtml();"ht"===$&&(q=q.getView()),W&&W===q&&m.contains(W)||(E._html=q,m.innerHTML="",I(m,q))}if(!m.parentNode){var B=g.$1f;if(!B){var b=U();Y(b,O,o),Y(b,J,"0"),B=g.$1f=b;var k=g._canvas.nextSibling;k?G.insertBefore(b,k):I(G,b)}I(B,m),I(B,y),T.onContentInitialized&&T.onContentInitialized(m)}if(T._scalable){var S=T.$5f,A=T.$6f;s(m,"rotate("+180*(v/P)+"deg) scale("+N+","+D+")"),Y(m,K,""),Y(m,Q,""),Y(m,a,(V.x-S/p/2)*p+H+R),Y(m,w,(V.y-A/p/2)*p+h+R)}else{var Ch=f(m.style.width),mp=f(m.style.height),lo=f((l-t)*p),Db=f((e-t)*p),Bi="100%",Je=m.children[0];Y(Je,K,Bi),Y(Je,Q,Bi),(Ch!==lo||mp!==Db)&&(Y(m,K,lo+R),Y(m,Q,Db+R),"ht"===$&&X.invalidate()),s(m,"rotate("+180*(v/P)+"deg)"),Y(m,a,(V.x-lo/p/2)*p+H+R),Y(m,w,(V.y-Db/p/2)*p+h+R)}var Hm=E.dragRect;g.isMovable(T)&&g.isSelected(T)&&Hm?(n.save(),n.fillStyle=Z,n.fillRect(Hm.x,Hm.y,Hm.width,Hm.height),n.restore(),Y(y,a,Hm.x*p+H+R),Y(y,w,Hm.y*p+h+R),s(y,"scale("+p+","+p+")"),Y(y,i,x),E.$11f()):Y(y,i,L),Y(m,F,this._visible?r:c)},dispose:function(){var k=this.gv.$1f;this.$2f.parentNode===k&&k.removeChild(this.$2f),this.$3f.parentNode===k&&k.removeChild(this.$3f)},_84o:function(A){this._visible=A,Y(this.$2f,F,A?r:c),Y(this.$3f,i,A?x:L)},_3O:function(){var E=this,X=E.gv,e=E._data;C.superClass._3O.call(E);var u=e.getRect();X.isEditable(e)&&(E.dragRect={x:u.x+u.width+e._padding,y:u.y+10,width:e.getDraggerImageWidth(),height:e.getDraggerImageHeight()},E._68o(E.dragRect))},rectIntersects:function(b){var c=this._79o();return v.Default.intersection(c,b)?!0:void 0},$9f:function(p){var _=this.gv,P=this._data;_.sm().contains(P)&&p.stopPropagation()}});var j=v.HtmlNode=function(){j.superClass.constructor.call(this)};v.Default.def(j,v.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:v.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(s){var i=this,o=i._html;i._html=s,"html"===i.getHtmlType()&&"Handlebars"in W&&(i.$10f=Handlebars.compile(s)),i.$13f(),i.fp("html",o,s)},setContext:function(J){var f=this,$=f._context;f._context=J,f.fp("context",$,J),f.$13f()},setScalable:function(O){var V=this,i=V._scalable;V._scalable=O,V.fp("scalable",i,O),V.$13f()},getHtmlType:function(){var P=this._html;return P?"string"==typeof P?"html":P.getView?"ht":"dom":null},$13f:function(){var Q=this,C=Q._html,G=Q.$10f;if(C){var E=U(),z=!1,v=Q.getHtmlType();if(Y(E,O,o),Y(E,l,M),Y(E,F,c),"html"===v?(E.innerHTML=G?G(Q.getContext()||{}):C,z=!0):"ht"===v?(I(E,C.getView()),z=!0):"dom"===v&&(I(E,C),z=!0),z){var S=2*Q._padding;I(y(),E),Q.$5f=E.scrollWidth,Q.$6f=E.scrollHeight,Q._width=Q.$5f+S,Q._height=Q.$6f+S,Q._originWidth=Q._width,Q._originHeight=Q._height,A(y(),E)}}},getUIClass:function(){return v.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);