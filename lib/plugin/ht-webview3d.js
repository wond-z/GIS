!function(m){"use strict";function u(b){var v,W,H,P,Z,S,m,V=[],u=0;v=r.createDiv(),v.style.overflow="hidden";var J=b.getView();J.insertBefore(v,b.getCanvas()),W=y.Default.createDiv(),W.style.WebkitTransformStyle="preserve-3d",W.style.MozTransformStyle="preserve-3d",W.style.transformStyle="preserve-3d",v.appendChild(W),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(H){var E=H.style;s.addEventListener(J,H.event,function(){v.style.pointerEvents=E})}),this.updateWebView=function(){if(b.getWidth()&&b.getHeight()){var o=b.getCanvas(),B=1*o.style.width.slice(0,-2),r=1*o.style.height.slice(0,-2);(V[0]!==B||V[1]!==r)&&(V[0]=B,V[1]=r,v.style.width=B+"px",v.style.height=r+"px",W.style.width=B+"px",W.style.height=r+"px");var U=b._projectMatrix[5]*V[1]/2;U!==H&&(H=U,v.style.WebkitPerspective=H+"px",v.style.MozPerspective=H+"px",v.style.perspective=H+"px"),S="translateZ("+H+"px)"+h(b._viewMatrix);var X=S+"translate("+V[0]/2+"px,"+V[1]/2+"px)";P===X||Z||(W.style.WebkitTransform=X,W.style.MozTransform=X,W.style.transform=X,P=X),u++,m=!1,b.dm().each(function(o){o.isWebView&&x(o)});for(var a,z=W.children,e=[],C=0,O=z.length;O>C;C++)a=z[C],a._isHtWebView&&a._renderCookie!==u&&e.push(a);e.length&&e.forEach(function(e){W.removeChild(e)})}};var g=new Array(16),x=function(v){var P=v.getAttach();if(P){P.parentElement!==W&&W.appendChild(P),P._renderCookie=u,m=!0;var D=v.getFinalScale3d(),Q=v._prefrenceSize;Q&&Q[0]?Q[1]||(Q[1]=Q[0]/D[0]*D[1]):Q=[D[0],D[1]],P.style.width=Q[0]+"px",P.style.height=Q[1]+"px";var Y=1/Q[0],R=1/Q[1],L=1,e=v.mat;g[0]=e[0]*Y,g[1]=e[1]*Y,g[2]=e[2]*Y,g[3]=e[3]*Y,g[4]=e[4]*R,g[5]=e[5]*R,g[6]=e[6]*R,g[7]=e[7]*R,g[8]=e[8]*L,g[9]=e[9]*L,g[10]=e[10]*L,g[11]=e[11]*L,g[12]=e[12],g[13]=e[13],g[14]=e[14],g[15]=e[15];var a=O(g,Z?"translate("+V[0]/2+"px,"+V[1]/2+"px)"+S:""),o=P.$a2;o!==a&&(P.$a2=a,P.style.WebkitTransform=a,P.style.MozTransform=a,P.style.transform=a)}}}function e(F){return Math.abs(F)<1e-10?0:F}function h(u){var $=u;return"matrix3d("+e($[0])+","+e(-$[1])+","+e($[2])+","+e($[3])+","+e($[4])+","+e(-$[5])+","+e($[6])+","+e($[7])+","+e($[8])+","+e(-$[9])+","+e($[10])+","+e($[11])+","+e($[12])+","+e(-$[13])+","+e($[14])+","+e($[15])+")"}function O(Y,V){var $=Y,Q="matrix3d("+e($[0])+","+e($[1])+","+e($[2])+","+e($[3])+","+e(-$[4])+","+e(-$[5])+","+e(-$[6])+","+e(-$[7])+","+e($[8])+","+e($[9])+","+e($[10])+","+e($[11])+","+e($[12])+","+e($[13])+","+e($[14])+","+e($[15])+")";return"translate(-50%,-50%)"+(V||"")+Q}var x="ht",y=m[x],r=y.Default,s=r.getInternal(),w=s.superCall,V=y.graph3d.Graph3dView,S=V.prototype.validateImpl;V.prototype.validateImpl=function(){S.call(this);var Y=this._webViewRenderer;Y||(Y=this._webViewRenderer=new u(this)),Y.updateWebView()};var l=y.WebView3d=function(){var H=this;w(l,H),H.s({shape3d:"billboard","shape3d.reverse.flip":!0})},d=[1,1,1,1],R=[0,0,0,0];r.def(x+"."+"WebView3d",y.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(q,V,m){if(!q)return this.detachDOM();if("string"==typeof q){var L=document.createElement("iframe");L.src=q,q=L}var i=q.style;i.position="absolute",i.border=0,i.outline=0,i.padding=0,i.margin=0,q._isHtWebView=!0,this.setAttach(q),this._prefrenceSize=[V,m],this.s("shape3d.blend",R)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(k){this.a("defaultBgColor",k),this.getAttach()||this.s("shape3d.blend",k)},getBgColor:function(){return this.a("defaultBgColor")||d}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);